BUG REPORT COMMENTS:
Thanks, this test was highly valuable in that it revealed a hidden but wrong assumption in the inference: I used checks "expressionContext == VANILLA_CONTEXT" to test for contexts not providing a target type. This missed the case of cast contexts, which, too, don't strictly provide a target type.
As a result the inference in this example was never finished, because it fell in neither bucket: neither having a target type, nor being a vanilla context.

The bulk of my change is a refactoring of interface ExpressionContext into an enum (plus corresponding "import static" instead of "implements") - hurray, long live Java 5! :)

The payload is the introduction and usage of a new function ExpressionContext.definesTargetType().

One test now shows two more errors (javac only shows one of them but I hold that both are valid indeed).

Released via http://git.eclipse.org/c/jdt/eclipse.jdt.core.git/commit/?h=BETA_JAVA8&id=1d1b85ba11568f78a124441d6eb86af75fb135ca

