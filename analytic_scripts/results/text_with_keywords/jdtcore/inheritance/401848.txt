BUG REPORT COMMENTS:
Comment 20 has been released with bug 427622.

(In reply to Markus Keller from comment #24)
> The only "hack" is that this
> doesn't fix the complete problem, but just works around the visible effects.

Just to spell this out: The snippet puts the type into a method parameter, and since the default code formatter setting for insert_new_line_after_annotation_on_parameter is "do not insert", we don't get a new line any more.

Remaining problems:

1) If *_annotation_on_parameter is set to "insert", then we again get a new line for the type annotation, even if *_type_annotation is "do not insert".

2) If *_annotation_on_parameter is set to "do not insert", and *_type_annotation is "insert", then we don't get a new line.

The first problem can be fixed by changing the snippet in ASTRewriteFormatter to
    prefix= "void m(final "; //$NON-NLS-1$

The second problem can be fixed with an improved fix for bug 425040 comment 13. However, I now think we should only treat method parameters specially, i.e. assume type annotations if there are no other keywords in the modifier list.

A common usage pattern is to have @SuppressWarnings("...") on a local variable, and we should not start treating these as type annotations.

Fixed this bug and the modified version of bug 425040 comment 13 with
http://git.eclipse.org/c/jdt/eclipse.jdt.core.git/commit/?id=cd140389e1d0cdca9f232f9b33d1b09e90034b22

