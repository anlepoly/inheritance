BUG REPORT COMMENTS:
Fixed via http://git.eclipse.org/c/jdt/eclipse.jdt.core.git/commit/?h=BETA_JAVA8&id=e1bb62a6f97249ff77a2f0164d289109644f1d09

Tests added here: http://git.eclipse.org/c/jdt/eclipse.jdt.core.git/commit/?h=BETA_JAVA8&id=f0f1d42036089cdc450ad38e200db5fad2a1d087

I refactored the class LocationCollector significantly to promote reuse,
take advantage of inheritance etc.

Looking at the classes involved in code generation of type annotations, there
is much more opportunities for clean up and restructuring. I think the 
classes AnnotationContext, AnnotationCollector and LocationCollector should
all be folded into one: AnnotationContext. In particular, making one AST traversal
to discover annotations and another to compute their path entries is wasteful.
This is a project for another day through: https://bugs.eclipse.org/bugs/show_bug.cgi?id=418490


This fixes bug 404719 too.

