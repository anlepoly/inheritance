BUG REPORT COMMENTS:
The relative classpath changes made as part of 3.5M3 resolve classpath entries relative to the workspace directory.  This is most likely not the desired root for a relative entry.

Library entries should be resolved relative to the project location.  They will currently only resolve relative to the project if it is contained in the workspace.  For projects residing outside the workspace, the library entries are still resolved relative to the workspace root.

Example Workspace Location: /home/myhome/workspace1
Project location: /home/myhome/development/project1
Classpath Library entry: ../third_party/some.jar.
Expected resolution: /home/myhome/development/third_party/some.jar
Actual resolution: /home/myhome/workspace1/third_party/some.jar

Variable entries defined relative to a Classpath Variable can't be resolved at all.  The path of a variable entry has the variable name as the first segment.  The extension of the variable is appended to the variable name to complete the path.  If the extension  begins with a relative reference (../), the canonicalization of the Path for the ClasspathEntry removes the variable name completely from the path.  This prevents the ClasspathEntry from being resolved.

Example:  Classpath Variable: EXTERNAL_LOCATION = /home/myhome/development/lib
Classpath Variable Extension: ../third_party/some.jar
Expected resolution: /home/myhome/development/third_party/some.jar

When the JavaProject reads this from the .classpath file, it calls ClasspathEntry.elementDecode() to create a ClasspathEntry with a path of EXTERNAL_LOCATION/../third_party/some.jar.  As part of the decode process, ClasspathEntry creates a Path instance.  As part of the Path constructor, the path is canonicalized.  This results in a path of /third_party/some.jar.  Subsequent attempts by the JavaModelManager to resolve the variable entry fail because the ClasspathEntry no longer includes the variable name as the first segment of the path.
Created an attachment (id=134162)
Resolve relative library entries based on project instead of workspace


Created an attachment (id=134163)
mylyn/context/zip

Jay,

Please investigate what happens with the variable entries.

