BUG REPORT COMMENTS:
User Agent: Mozilla/5.0 (Macintosh; Intel Mac OS X 10_6_8) AppleWebKit/535.7 (KHTML, like Gecko) Chrome/16.0.912.63 Safari/535.7

Steps to reproduce:

function F(var_args) {
  [this.x, this.y] = arguments;
}



Actual results:

java.lang.IllegalStateException "unexpected token THIS"


Expected results:

Should have the same semantics as

function F(var_args) {
  var t = this;
  [t.x, t.y] = arguments;
}
var f = new F(1,2);
// f.x === 1, f.y === 2

which works fine.

In order to pass the initial test case of the bug reporter, a simple patch for "IRFactory#decompile(AstNode)" is necessary:
---
--- a/src/org/mozilla/javascript/IRFactory.java
+++ b/src/org/mozilla/javascript/IRFactory.java
@@ -2182,6 +2182,9 @@ public final class IRFactory extends Parser
           case Token.GETELEM:
               decompileElementGet((ElementGet) node);
               break;
+          case Token.THIS:
+              decompiler.addToken(node.getType());
+              break;
           default:
               Kit.codeBug("unexpected token: "
                           + Token.typeToName(node.getType()));
---

But that change won't be sufficient to cover the other tests of the JUnit test case.

PS: The bug subject should be changed to mention "Destructuring Assignment" instead of "Array comprehension"
Subject changed.
The following patch for "Parser#destructuringAssignmentHelper(int, Node, Node, String)" should make the other tests pass:
---
--- a/src/org/mozilla/javascript/Parser.java
+++ b/src/org/mozilla/javascript/Parser.java
@@ -3514,6 +3514,12 @@ public class Parser
               break;
           case Token.GETPROP:
           case Token.GETELEM:
+              switch (variableType) {
+                case Token.CONST:
+                case Token.LET:
+                case Token.VAR:
+                    reportError("msg.bad.assign.left");
+              }
               comma.addChildToBack(simpleAssignment(left, createName(tempName)));
               break;
           default:
---
Thanks for both the report and the fix! Pushed to git master:

https://github.com/mozilla/rhino/commit/b515ff81c327aaa68861ffb2abb1653aa91921b7

