BUG TITLE:
Allow JavaAdapter to extend Scriptable objects directly, without additional wrapping as NativeJavaObject

BUG REPORT COMMENTS:
User-Agent:       Mozilla/5.0 (Macintosh; U; Intel Mac OS X 10_5_5; en-us) AppleWebKit/525.18 (KHTML, like Gecko) Version/3.1.2 Safari/525.20.1
Build Identifier: 

JavaAdapter.createAdapterWrapper is responsible for wrapping of the created JavaAdapter instance in a Scriptable wrapper. Right now it always wraps it in a NativeJavaObject. But by adding an additional instanceof check and avoiding wrapping of instances of classes that already inherit from Scriptable, we could allow JavaScript to define new Scriptable objects directly from JavaScript, and therefore offer more flexible ways of wrapping Java and JavaScript objects.

Reproducible: Always

I really like this idea. It takes two things already present in Rhino (JavaAdapters and not wrapping instances of Scriptable) and what comes out is simple and powerful metaprogramming. As we found out on IRC there's a problem with your patch, so I'm uploading a revised patch and a test script.
createAdapterWrapper() is called by the JavaAdapter constructor to set up 

