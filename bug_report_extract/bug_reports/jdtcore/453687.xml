<?xml version="1.0" encoding="UTF-8" standalone="yes" ?>
<!DOCTYPE bugzilla SYSTEM "https://bugs.eclipse.org/bugs/page.cgi?id=bugzilla.dtd">

<bugzilla version="4.4.7"
          urlbase="https://bugs.eclipse.org/bugs/"
          
          maintainer="webmaster@eclipse.org"
>

    <bug>
          <bug_id>453687</bug_id>
          
          <creation_ts>2014-12-01 00:33:00 -0500</creation_ts>
          <short_desc>[1.8][compiler]Incorrect errors when compiling code with Method References</short_desc>
          <delta_ts>2014-12-10 00:13:08 -0500</delta_ts>
          <reporter_accessible>1</reporter_accessible>
          <cclist_accessible>1</cclist_accessible>
          <classification_id>2</classification_id>
          <classification>Eclipse</classification>
          <product>JDT</product>
          <component>Core</component>
          <version>4.5</version>
          <rep_platform>PC</rep_platform>
          <op_sys>Windows 7</op_sys>
          <bug_status>VERIFIED</bug_status>
          <resolution>FIXED</resolution>
          
          
          <bug_file_loc></bug_file_loc>
          <status_whiteboard></status_whiteboard>
          <keywords></keywords>
          <priority>P3</priority>
          <bug_severity>normal</bug_severity>
          <target_milestone>4.5 M4</target_milestone>
          
          
          <everconfirmed>1</everconfirmed>
          <reporter name="Kiran Mohan">mohan.kiran</reporter>
          <assigned_to name="Sasikanth Bharadwaj">saammana</assigned_to>
          <cc>jarthana</cc>
    
    <cc>stephan.herrmann</cc>
          
          <votes>0</votes>

      

      

      <flag name="review"
          id="63848"
          type_id="1"
          status="+"
          setter="jarthana"
    />

          <comment_sort_order>oldest_to_newest</comment_sort_order>  
          <long_desc isprivate="0" >
    <commentid>2490759</commentid>
    <comment_count>0</comment_count>
    <who name="Kiran Mohan">mohan.kiran</who>
    <bug_when>2014-12-01 00:33:23 -0500</bug_when>
    <thetext>In Eclipse 4.5.0M3, the following code

----------------------
import static java.util.stream.Collectors.*;
...
...
        Map&lt;String, Set&lt;String&gt;&gt; countryLanguagesMap = Stream.of(Locale.getAvailableLocales())
                .collect(
                        groupingBy(Locale::getDisplayCountry,
                           mapping(Locale::getDisplayLanguage, 
                               toSet())
                        )
                );
----------------------
Gives errors  

&quot;The type Locale does not define getDisplayCountry(Object) that is applicable here&quot; and &quot;The type Locale does not define getDisplayLanguage(Object) that is applicable here&quot;

It compiles and runs fine in maven.</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>2490760</commentid>
    <comment_count>1</comment_count>
    <who name="Sasikanth Bharadwaj">saammana</who>
    <bug_when>2014-12-01 00:48:04 -0500</bug_when>
    <thetext>Please post a complete snippet that demonstrates the error so that we can take a look. Thanks</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>2490765</commentid>
    <comment_count>2</comment_count>
    <who name="Jay Arthanareeswaran">jarthana</who>
    <bug_when>2014-12-01 01:15:34 -0500</bug_when>
    <thetext>Copy/Paste + import rewrite produces this:

import static java.util.stream.Collectors.groupingBy;
import static java.util.stream.Collectors.mapping;
import static java.util.stream.Collectors.toSet;

import java.util.Locale;
import java.util.Map;
import java.util.Set;
import java.util.stream.Stream;

public class Snippet {
	public static void main(String[] args) {
		Map&lt;String, Set&lt;String&gt;&gt; countryLanguagesMap = Stream.of(Locale.getAvailableLocales()).collect(
				groupingBy(Locale::getDisplayCountry, mapping(Locale::getDisplayLanguage, toSet())));

	}
} 

I can see this on master/HEAD. Looks like it&apos;s been this way since bug 437444 got fixed.</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>2493017</commentid>
    <comment_count>3</comment_count>
    <who name="Sasikanth Bharadwaj">saammana</who>
    <bug_when>2014-12-05 00:31:05 -0500</bug_when>
    <thetext>This happens as a result of using a half cooked poly PGMB for compatibility checks. Patch coming up shortly.</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>2493077</commentid>
    <comment_count>4</comment_count>
      <attachid>249185</attachid>
    <who name="Sasikanth Bharadwaj">saammana</who>
    <bug_when>2014-12-05 04:16:38 -0500</bug_when>
    <thetext>Created attachment 249185
patch</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>2493081</commentid>
    <comment_count>5</comment_count>
    <who name="Sasikanth Bharadwaj">saammana</who>
    <bug_when>2014-12-05 04:25:02 -0500</bug_when>
    <thetext>When resolving the inner invocations, we create a PolyParameterizedGenericMethodBinding when we see that only applicability can be inferred at that time. But this half cooked binding is used to perform compatibility checks of arguments, resulting in the conclusion that the method references are not compatible with the expected argument types. Solution is to not do this for PPGMB and let inference do the job. Jay, please review. All tests pass.</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>2493163</commentid>
    <comment_count>6</comment_count>
    <who name="Jay Arthanareeswaran">jarthana</who>
    <bug_when>2014-12-05 06:37:54 -0500</bug_when>
    <thetext>+1 for the patch.</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>2493170</commentid>
    <comment_count>7</comment_count>
    <who name="Sasikanth Bharadwaj">saammana</who>
    <bug_when>2014-12-05 06:56:08 -0500</bug_when>
    <thetext>Fix and test released via http://git.eclipse.org/c/jdt/eclipse.jdt.core.git/commit/?id=57f884c272281a5aa1631c056927fac25c267ffd</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>2494938</commentid>
    <comment_count>8</comment_count>
    <who name="Jay Arthanareeswaran">jarthana</who>
    <bug_when>2014-12-10 00:13:08 -0500</bug_when>
    <thetext>Verified for 4.5 M4 with build I20141209-2000</thetext>
  </long_desc>
      
          <attachment
              isobsolete="0"
              ispatch="1"
              isprivate="0"
          >
            <attachid>249185</attachid>
            <date>2014-12-05 04:16:00 -0500</date>
            <delta_ts>2014-12-05 04:16:38 -0500</delta_ts>
            <desc>patch</desc>
            <filename>Fix-and-test-for-bug453687.patch</filename>
            <type>text/plain</type>
            <size>2303</size>
            <attacher name="Sasikanth Bharadwaj">saammana</attacher>
            
              <data encoding="base64">ZGlmZiAtLWdpdCBhL29yZy5lY2xpcHNlLmpkdC5jb3JlLnRlc3RzLmNvbXBpbGVyL3NyYy9vcmcv
ZWNsaXBzZS9qZHQvY29yZS90ZXN0cy9jb21waWxlci9yZWdyZXNzaW9uL0xhbWJkYVJlZ3Jlc3Np
b25UZXN0LmphdmEgYi9vcmcuZWNsaXBzZS5qZHQuY29yZS50ZXN0cy5jb21waWxlci9zcmMvb3Jn
L2VjbGlwc2UvamR0L2NvcmUvdGVzdHMvY29tcGlsZXIvcmVncmVzc2lvbi9MYW1iZGFSZWdyZXNz
aW9uVGVzdC5qYXZhCmluZGV4IDE0NWM0NWIuLjAzYjhkZmYgMTAwNjQ0Ci0tLSBhL29yZy5lY2xp
cHNlLmpkdC5jb3JlLnRlc3RzLmNvbXBpbGVyL3NyYy9vcmcvZWNsaXBzZS9qZHQvY29yZS90ZXN0
cy9jb21waWxlci9yZWdyZXNzaW9uL0xhbWJkYVJlZ3Jlc3Npb25UZXN0LmphdmEKKysrIGIvb3Jn
LmVjbGlwc2UuamR0LmNvcmUudGVzdHMuY29tcGlsZXIvc3JjL29yZy9lY2xpcHNlL2pkdC9jb3Jl
L3Rlc3RzL2NvbXBpbGVyL3JlZ3Jlc3Npb24vTGFtYmRhUmVncmVzc2lvblRlc3QuamF2YQpAQCAt
NTc4LDYgKzU3OCwyNyBAQAogCX0sCiAJIlZhbHVlIDEgYWNjZXB0IHRydWUiKTsKIH0KKy8vIGh0
dHBzOi8vYnVncy5lY2xpcHNlLm9yZy9idWdzL3Nob3dfYnVnLmNnaT9pZD00NTM2ODcKKy8vIFsx
LjhdW2NvbXBpbGVyXUluY29ycmVjdCBlcnJvcnMgd2hlbiBjb21waWxpbmcgY29kZSB3aXRoIE1l
dGhvZCBSZWZlcmVuY2VzCitwdWJsaWMgdm9pZCB0ZXN0QnVnNDUzNjg3KCkgeworCXRoaXMucnVu
Q29uZm9ybVRlc3QobmV3IFN0cmluZyBbXSB7CisJCSJYLmphdmEiLAorCQkiaW1wb3J0IHN0YXRp
YyBqYXZhLnV0aWwuc3RyZWFtLkNvbGxlY3RvcnMuZ3JvdXBpbmdCeTtcbiIgKyAKKwkJImltcG9y
dCBzdGF0aWMgamF2YS51dGlsLnN0cmVhbS5Db2xsZWN0b3JzLm1hcHBpbmc7XG4iICsgCisJCSJp
bXBvcnQgc3RhdGljIGphdmEudXRpbC5zdHJlYW0uQ29sbGVjdG9ycy50b1NldDtcbiIgKyAKKwkJ
ImltcG9ydCBqYXZhLnV0aWwuTG9jYWxlO1xuIiArIAorCQkiaW1wb3J0IGphdmEudXRpbC5NYXA7
XG4iICsgCisJCSJpbXBvcnQgamF2YS51dGlsLlNldDtcbiIgKyAKKwkJImltcG9ydCBqYXZhLnV0
aWwuc3RyZWFtLlN0cmVhbTtcbiIgKyAKKwkJInB1YmxpYyBjbGFzcyBYIHtcbiIgKyAKKwkJIglw
dWJsaWMgc3RhdGljIHZvaWQgbWFpbihTdHJpbmdbXSBhcmdzKSB7XG4iICsgCisJCSIJCU1hcDxT
dHJpbmcsIFNldDxTdHJpbmc+PiBjb3VudHJ5TGFuZ3VhZ2VzTWFwID0gU3RyZWFtLm9mKExvY2Fs
ZS5nZXRBdmFpbGFibGVMb2NhbGVzKCkpLmNvbGxlY3QoXG4iICsgCisJCSIJCQkJZ3JvdXBpbmdC
eShMb2NhbGU6OmdldERpc3BsYXlDb3VudHJ5LCBtYXBwaW5nKExvY2FsZTo6Z2V0RGlzcGxheUxh
bmd1YWdlLCB0b1NldCgpKSkpO1xuIiArIAorCQkiCX1cbiIgKyAKKwkJIn0gIgorCX0sCisJIiIp
OworfQogcHVibGljIHN0YXRpYyBDbGFzcyB0ZXN0Q2xhc3MoKSB7CiAJcmV0dXJuIExhbWJkYVJl
Z3Jlc3Npb25UZXN0LmNsYXNzOwogfQpkaWZmIC0tZ2l0IGEvb3JnLmVjbGlwc2UuamR0LmNvcmUv
Y29tcGlsZXIvb3JnL2VjbGlwc2UvamR0L2ludGVybmFsL2NvbXBpbGVyL2xvb2t1cC9TY29wZS5q
YXZhIGIvb3JnLmVjbGlwc2UuamR0LmNvcmUvY29tcGlsZXIvb3JnL2VjbGlwc2UvamR0L2ludGVy
bmFsL2NvbXBpbGVyL2xvb2t1cC9TY29wZS5qYXZhCmluZGV4IGE0NDUyYTQuLjY0NzRjNjIgMTAw
NjQ0Ci0tLSBhL29yZy5lY2xpcHNlLmpkdC5jb3JlL2NvbXBpbGVyL29yZy9lY2xpcHNlL2pkdC9p
bnRlcm5hbC9jb21waWxlci9sb29rdXAvU2NvcGUuamF2YQorKysgYi9vcmcuZWNsaXBzZS5qZHQu
Y29yZS9jb21waWxlci9vcmcvZWNsaXBzZS9qZHQvaW50ZXJuYWwvY29tcGlsZXIvbG9va3VwL1Nj
b3BlLmphdmEKQEAgLTc0Niw2ICs3NDYsOCBAQAogCQkJfSBlbHNlIGlmICghbWV0aG9kLmlzT3Zl
cnJpZGluZygpIHx8ICFpc092ZXJyaWRkZW5NZXRob2RHZW5lcmljKG1ldGhvZCkpIHsKIAkJCQly
ZXR1cm4gbmV3IFByb2JsZW1NZXRob2RCaW5kaW5nKG1ldGhvZCwgbWV0aG9kLnNlbGVjdG9yLCBn
ZW5lcmljVHlwZUFyZ3VtZW50cywgUHJvYmxlbVJlYXNvbnMuVHlwZVBhcmFtZXRlckFyaXR5TWlz
bWF0Y2gpOwogCQkJfQorCQl9IGVsc2UgaWYgKHR5cGVWYXJpYWJsZXMgPT0gQmluZGluZy5OT19U
WVBFX1ZBUklBQkxFUyAmJiBtZXRob2QgaW5zdGFuY2VvZiBQb2x5UGFyYW1ldGVyaXplZEdlbmVy
aWNNZXRob2RCaW5kaW5nKSB7CisJCQlyZXR1cm4gbWV0aG9kOwogCQl9CiAKIAkJaWYgKHRpZWJy
ZWFraW5nVmFyYXJnc01ldGhvZHMpIHs=
</data>

          </attachment>
      

    </bug>

</bugzilla>