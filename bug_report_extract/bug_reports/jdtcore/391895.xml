<?xml version="1.0" encoding="UTF-8" standalone="yes" ?>
<!DOCTYPE bugzilla SYSTEM "https://bugs.eclipse.org/bugs/page.cgi?id=bugzilla.dtd">

<bugzilla version="4.4.7"
          urlbase="https://bugs.eclipse.org/bugs/"
          
          maintainer="webmaster@eclipse.org"
>

    <bug>
          <bug_id>391895</bug_id>
          
          <creation_ts>2012-10-15 02:58:00 -0400</creation_ts>
          <short_desc>[1.8][dom ast] Annotation support for extended dimensions</short_desc>
          <delta_ts>2013-02-03 12:07:00 -0500</delta_ts>
          <reporter_accessible>1</reporter_accessible>
          <cclist_accessible>1</cclist_accessible>
          <classification_id>2</classification_id>
          <classification>Eclipse</classification>
          <product>JDT</product>
          <component>Core</component>
          <version>3.8</version>
          <rep_platform>All</rep_platform>
          <op_sys>All</op_sys>
          <bug_status>RESOLVED</bug_status>
          <resolution>FIXED</resolution>
          
          
          <bug_file_loc></bug_file_loc>
          <status_whiteboard></status_whiteboard>
          <keywords></keywords>
          <priority>P3</priority>
          <bug_severity>enhancement</bug_severity>
          <target_milestone>BETA J8</target_milestone>
          
          <blocked>391847</blocked>
    
    <blocked>396576</blocked>
          <everconfirmed>1</everconfirmed>
          <reporter name="Srikanth Sankaran">srikanth_sankaran</reporter>
          <assigned_to name="Jay Arthanareeswaran">jarthana</assigned_to>
          <cc>daniel_megert</cc>
    
    <cc>markus_keller</cc>
          
          <votes>0</votes>

      

      

      

          <comment_sort_order>oldest_to_newest</comment_sort_order>  
          <long_desc isprivate="0" >
    <commentid>2171597</commentid>
    <comment_count>0</comment_count>
    <who name="Srikanth Sankaran">srikanth_sankaran</who>
    <bug_when>2012-10-15 02:58:49 -0400</bug_when>
    <thetext>BETA_JAVA8:

    Internally, the compiler splits the declarations with multiple field/local
variables into multiple declarations. On the DOM side, these are managed via
fragments with possible extra dimensions property. The extra dimensions may
carry type annotations and we need to add support for that.</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>2171599</commentid>
    <comment_count>1</comment_count>
    <who name="Srikanth Sankaran">srikanth_sankaran</who>
    <bug_when>2012-10-15 03:02:15 -0400</bug_when>
    <thetext>The following node types have extra dimensions:

MethodDeclaration
SingleVariableDeclaration
VariableDeclarationFragment</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>2175355</commentid>
    <comment_count>2</comment_count>
    <who name="Srikanth Sankaran">srikanth_sankaran</who>
    <bug_when>2012-10-24 02:44:37 -0400</bug_when>
    <thetext>This is an interesting case: - The child list property descriptor will
need to be specified as Annotion[].class. I don&apos;t know if there are
precedents to this.</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>2179340</commentid>
    <comment_count>3</comment_count>
    <who name="Jay Arthanareeswaran">jarthana</who>
    <bug_when>2012-11-05 04:43:50 -0500</bug_when>
    <thetext>(In reply to comment #2)
&gt; This is an interesting case: - The child list property descriptor will
&gt; need to be specified as Annotion[].class. I don&apos;t know if there are
&gt; precedents to this.

This won&apos;t work since the children need to be of type ASTNode - they can&apos; be of array type. The other alternatives I am considering are:

1. Use the ArrayType itself to capture the annotations on dimensions. In fact, as part of the earlier work for JSR 308, we have added annotations property to the ArrayType. So, we could just leverage that.

2. Create a new ASTNode, let&apos;s say Dimension to represent dimensions. The nodes specified in comment #1 can have new property (let&apos;s say extraDimensionsList), which is a list of Dimension. And Dimension will have a list of Annotation. This is not much different from 1st approach. Only advantage I see is that we represent the dimensions and their annotations in a flat structure instead of a nested structure. This approach will make the existing extraDimensions property redundant. Perhaps we can make it deprecated? Otherwise, we will have to deal with the situations when both the extraDimensions and extraDimensionsList properties are modified in a conflicting way.

Markus/Srikanth, do you have any suggestions?</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>2185904</commentid>
    <comment_count>4</comment_count>
      <attachid>223782</attachid>
    <who name="Jay Arthanareeswaran">jarthana</who>
    <bug_when>2012-11-20 23:22:10 -0500</bug_when>
    <thetext>Created attachment 223782
work in progress

(In reply to comment #3)
&gt; 1. Use the ArrayType itself to capture the annotations on dimensions. In
&gt; fact, as part of the earlier work for JSR 308, we have added annotations
&gt; property to the ArrayType. So, we could just leverage that.

I am proceeding with this approach. Except in the case of VariableDeclarationFragment, the ArrayType with annotations is already fully constructed and could be used as the value for the new field, which I am calling extra dimensions type. This is a WIP - I will be making bit more changes and add tests.</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>2185955</commentid>
    <comment_count>5</comment_count>
    <who name="Jay Arthanareeswaran">jarthana</who>
    <bug_when>2012-11-21 03:33:42 -0500</bug_when>
    <thetext>(In reply to comment #4)
&gt; I am proceeding with this approach. Except in the case of
&gt; VariableDeclarationFragment, the ArrayType with annotations is already fully
&gt; constructed and could be used as the value for the new field, which I am
&gt; calling extra dimensions type. This is a WIP - I will be making bit more
&gt; changes and add tests.

There is a problem with this approach when the client may have altered both the extraDimensions (old) and the new extra dimensions type (new) property. Surely we can&apos;t give preference to one over the other, can we? That&apos;s why I see an advantage with the other approach of coming up with a new node type. With this approach, we can make the extraDimensions deprecated and get that property from the size of the dimensions array. 

Srikanth, do you have some suggestions for this problem?</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>2186716</commentid>
    <comment_count>6</comment_count>
    <who name="Markus Keller">markus_keller</who>
    <bug_when>2012-11-22 11:16:50 -0500</bug_when>
    <thetext>Sorry for not answering earlier. I somehow missed the dynamite berried here.

We should take a step back and think a bit more about the spec. JLS7 8.4 already tells that the extra dimensions on a MethodDeclaration are just for compatibility and should not be used for new code.

Therefore, it doesn&apos;t make sense to add support for annotations on these extra dimensions. Why should the spec add more functionality to a construct that should not be used in new code? The changes in jsr308 for MethodDeclaratorRest and InterfaceMethodDeclaratorRest should be removed in the spec.


For SingleVariableDeclaration, the MODIFIERS_PROPERTY is a precedent of a similar problem. In JLS8 level, the AST should just support a single way to store extra dimensions. getExtraDimensions() can stay, but the implementation should defer to the new property. setExtraDimensions(..) should be deprecated and throw an UnsupportedOperationException in the JLS8 API.

In the WIP patch, the ArrayType is problematic, since the COMPONENT_TYPE_PROPERTY would either be null (illegal), or it would point to some other type, which would eventually violate the &quot;Source ranges nest properly&quot; rule in the Javadoc of ASTParser#setKind(int).

I think Jay&apos;s proposal #2 is a better solution. Dimension (or may be better DimensionType) could extend the AnnotatedType from bug 391890 comment 7, adding just the ANNOTATIONS_PROPERTY as API.</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>2187809</commentid>
    <comment_count>7</comment_count>
      <attachid>223996</attachid>
    <who name="Jay Arthanareeswaran">jarthana</who>
    <bug_when>2012-11-27 00:57:58 -0500</bug_when>
    <thetext>Created attachment 223996
Updated patch

With the alternate approach I was talking about. This patch still has some way to go, just updating the patch here before I can come back to this after couple of M4 items. Here is the list of tasks still pending:

1. Make DimensionType as AnnotableType as Markus mentioned.
2. Update documentations
3. Tests

The updated ASTView is good and helped me test the implementation better (Thanks Markus!) Also note that I intend to put the rewrite part in a separate patch so that we can move forward with the DOM/AST portion.</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>2194445</commentid>
    <comment_count>8</comment_count>
      <attachid>224706</attachid>
    <who name="Jay Arthanareeswaran">jarthana</who>
    <bug_when>2012-12-14 01:11:56 -0500</bug_when>
    <thetext>Created attachment 224706
Updated patch

This patch needs to be applied on top of the patch from bug 391890, comment #15  (attachment 224705) since it uses the new AnnotatableType.</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>2194448</commentid>
    <comment_count>9</comment_count>
    <who name="Jay Arthanareeswaran">jarthana</who>
    <bug_when>2012-12-14 01:19:17 -0500</bug_when>
    <thetext>Raised bug 396576 to track the AST rewrite part.</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>2200987</commentid>
    <comment_count>10</comment_count>
      <attachid>225413</attachid>
    <who name="Jay Arthanareeswaran">jarthana</who>
    <bug_when>2013-01-10 02:23:21 -0500</bug_when>
    <thetext>Created attachment 225413
Latest patch

Cleaned up few things, updated the documentation and copyright.

Might be adding new tests too.</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>2201283</commentid>
    <comment_count>11</comment_count>
      <attachid>225453</attachid>
    <who name="Jay Arthanareeswaran">jarthana</who>
    <bug_when>2013-01-10 10:51:22 -0500</bug_when>
    <thetext>Created attachment 225453
Updated patch

Actually, I didn&apos;t realize I had a more recent version of the patch and here is it.</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>2202494</commentid>
    <comment_count>12</comment_count>
      <attachid>225573</attachid>
    <who name="Jay Arthanareeswaran">jarthana</who>
    <bug_when>2013-01-14 11:02:49 -0500</bug_when>
    <thetext>Created attachment 225573
Updated patch

Patch had to be adjusted after the recent commits.

Srikanth, a note on the patch:
The API additions in VariableDeclaration forced me to add a API filter. Please let me know that shouldn&apos;t be the case.</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>2206874</commentid>
    <comment_count>13</comment_count>
    <who name="Srikanth Sankaran">srikanth_sankaran</who>
    <bug_when>2013-01-24 02:20:29 -0500</bug_when>
    <thetext>Jay, this patch no longer applies. Could you refresh so I can do a first cut review ? I think Markus is in a better position to review this though.</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>2206875</commentid>
    <comment_count>14</comment_count>
    <who name="Srikanth Sankaran">srikanth_sankaran</who>
    <bug_when>2013-01-24 02:21:14 -0500</bug_when>
    <thetext>(In reply to comment #6)

&gt; Therefore, it doesn&apos;t make sense to add support for annotations on these
&gt; extra dimensions. Why should the spec add more functionality to a construct
&gt; that should not be used in new code? The changes in jsr308 for
&gt; MethodDeclaratorRest and InterfaceMethodDeclaratorRest should be removed in
&gt; the spec.

Sorry, I missed this comment, I&apos;ll take it up with the EG.</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>2207465</commentid>
    <comment_count>15</comment_count>
      <attachid>226075</attachid>
    <who name="Jay Arthanareeswaran">jarthana</who>
    <bug_when>2013-01-25 01:07:07 -0500</bug_when>
    <thetext>Created attachment 226075
Updated patch

Patch after resolving the merge conflicts.

Also note that I have left out a TODO to address the annotations on extra dimension on method declarations.</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>2207491</commentid>
    <comment_count>16</comment_count>
    <who name="Srikanth Sankaran">srikanth_sankaran</who>
    <bug_when>2013-01-25 03:39:33 -0500</bug_when>
    <thetext>(In reply to comment #15)
&gt; Created attachment 226075 [details]
&gt; Updated patch
&gt; 
&gt; Patch after resolving the merge conflicts.

I released some clean up changes not related to the present bug via
http://git.eclipse.org/c/jdt/eclipse.jdt.core.git/commit/?h=BETA_JAVA8&amp;id=caf64c6ca6cb6ffdc91f9978b4ee34c5d2fad461</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>2207514</commentid>
    <comment_count>17</comment_count>
    <who name="Srikanth Sankaran">srikanth_sankaran</who>
    <bug_when>2013-01-25 04:35:55 -0500</bug_when>
    <thetext>Review comments:

(1) Javadoc of org.eclipse.jdt.core.dom.ASTNode.DIMENSION_TYPE links to
java.awt.Dimension. I don&apos;t think you wanted that.

(2) org.eclipse.jdt.core.dom.ASTNode.nodeClassForType(int) is missing the
new node type.

(3) I think the new node type is better named DimensionInfo rather than
DimensionType. It should NOT also be a subtype of AnnotatableType. It is
better derived directly from ASTNode with annotations property locally declared.

(4) We need to change all occurrences of dimension type (in code, javadoc, other
comments ...) to dimension info.

(5) javadoc of org.eclipse.jdt.core.dom.DimensionType.EXPRESSION_PROPERTY 
mentions &quot;The &quot;dimensions&quot; structural property of this node type&quot; - this
looks incorrect.

(6) Javadoc for org.eclipse.jdt.core.dom.DimensionType.expression mentions
expression*s* ? 

Also says: Defaults to an empty list. ???

(7) ASTVisitor.java is missing JCP disclaimer.

(8) Remove the TODO comment in ASTConverter for now. We will follow up
with a separate bug if there is a spec change.

(9) Should methodDecl.setExtraDimensions(extraDimensions); be invoked for
JLS8 ? 

(10) Is the statement in org.eclipse.jdt.core.dom.MethodDeclaration.clone0(AST):
			result.extraDimensionTypes = new ASTNode.NodeList(EXTRA_DIMENSION_TYPES_PROPERTY);

needed ? Does not the constructor already create it ?

(11) Does the call to result.setExtraDimensions(getExtraDimensions());
happen in &lt; JLS8 ?

(12) Could you separate the ASTrewrite changes into a different bug ?
Are the changes in ASTRewriteFlattener integral to the DOM/AST side
of work ? 

(13) org.eclipse.jdt.core.dom.MethodDeclaration.EXTRA_DIMENSIONS_PROPERTY&apos;s
javadoc should mention it is not to be used at JLS8+ ? 

(14) org.eclipse.jdt.core.dom.MethodDeclaration.getExtraDimensions() should
thrown an exception at JLS8+ ? Likewise setExtra* ? 

(15) SingleVariableDeclaration memSize () treeSize() don&apos;t have to change ?

(16) Not sure of the change in VariableDeclaration and the resultant API
error.

I&apos;ll review once more after these changes are made and tested before 
asking Markus.</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>2207833</commentid>
    <comment_count>18</comment_count>
      <attachid>226117</attachid>
    <who name="Jay Arthanareeswaran">jarthana</who>
    <bug_when>2013-01-25 11:44:16 -0500</bug_when>
    <thetext>Created attachment 226117
Updated patch

(In reply to comment #17)
&gt; Review comments:

All review suggestions included except (3) and (4).

Before we can rename DimensionType, I think we need to answer the question posted here: bug 39189, comment #1. If we were to include an expression as part of a DimensionType or whatever it is called, it&apos;ll be more than just an info, right? As far as I can see, Type is pretty much an abstract node and most sub types of Type don&apos;t seem to use more than one method from Type. In a way, DimensionType is like UnionType, which itself doesn&apos;t represent any single Type.</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>2208228</commentid>
    <comment_count>19</comment_count>
    <who name="Srikanth Sankaran">srikanth_sankaran</who>
    <bug_when>2013-01-27 01:04:42 -0500</bug_when>
    <thetext>(In reply to comment #18)

&gt; All review suggestions included except (3) and (4).
&gt; 
&gt; Before we can rename DimensionType, I think we need to answer the question
&gt; posted here: bug 39189, comment #1. If we were to include an expression as
&gt; part of a DimensionType or whatever it is called, it&apos;ll be more than just an
&gt; info, right? 

I think the question link is bad. I don&apos;t see why DimensionInfo can&apos;t capture
expressions. It is just another property. That said, I haven&apos;t studied the
other patch dealing with ArrayCreation. I will take look and see. 

&gt;As far as I can see, Type is pretty much an abstract node and
&gt; most sub types of Type don&apos;t seem to use more than one method from Type. In
&gt; a way, DimensionType is like UnionType, which itself doesn&apos;t represent any
&gt; single Type.

The thing is variables can be declared to be of Type&apos;s. DimensionType cannot
be the Type of any variable. There is an abstraction breakdown here.</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>2208232</commentid>
    <comment_count>20</comment_count>
    <who name="Jay Arthanareeswaran">jarthana</who>
    <bug_when>2013-01-27 03:48:59 -0500</bug_when>
    <thetext>(In reply to comment #19)
&gt; I think the question link is bad. I don&apos;t see why DimensionInfo can&apos;t capture
&gt; expressions. It is just another property. That said, I haven&apos;t studied the
&gt; other patch dealing with ArrayCreation. I will take look and see. 

https://bugs.eclipse.org/bugs/show_bug.cgi?id=391894#c1

&gt; The thing is variables can be declared to be of Type&apos;s. DimensionType cannot
&gt; be the Type of any variable. There is an abstraction breakdown here.

Makes sense, thanks for pointing out.</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>2208367</commentid>
    <comment_count>21</comment_count>
      <attachid>226179</attachid>
    <who name="Jay Arthanareeswaran">jarthana</who>
    <bug_when>2013-01-28 01:34:07 -0500</bug_when>
    <thetext>Created attachment 226179
Updated patch

Patch with suggestions discussed in the previous commit.</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>2208411</commentid>
    <comment_count>22</comment_count>
    <who name="Srikanth Sankaran">srikanth_sankaran</who>
    <bug_when>2013-01-28 04:27:26 -0500</bug_when>
    <thetext>Review comments: I apologize that some of these comments should have been
given earlier and slipped through the first pass:

(1) org.eclipse.jdt.core.dom.AST.newDimensionInfo(Annotation[]): I think
factory method is better design to NOT take arguments that may only be
occassionally used as otherwise clients will be inconvenienced in having
to manufacture and pass null arguments needlessly.

(2) If you fix this (please :)) remember to adjust the javadoc accordingly.

(3) DimensionInfo - copyright does not look right - should it mention 
2000 - 2013 ?

(4) Javadoc of DimensionInfo: Should it enclose SingleVariableDeclaration
and friends in &lt;code&gt; &lt;/code&gt; ?

(5) Same Javadoc, Need a line break before For JLS8:

(6) Javadoc for DimensionInfo.annotations(): @exception section is wrong.

(7)  DimensionInfo constructor&apos;s javadoc should have @exception section 
instead ?

(8) I would remove the javadoc from org.eclipse.jdt.core.dom.DimensionInfo.expression. It mentions element type
incorrectly, as it is valid only for containers.

(9) org.eclipse.jdt.core.dom.DimensionInfo.setExpression(Expression)&apos;s javadoc
mentions &quot;@param expression the new array type&quot; - does not read right.

(10) Javadoc of org.eclipse.jdt.core.dom.MethodDeclaration.EXTRA_DIMENSIONS_PROPERTY
mentions non-existent EXTRA_DIMENSION_TYPES_PROPERTY.

(11) Javadoc of org.eclipse.jdt.core.dom.MethodDeclaration.extraDimensionInfos
mentions dimension types. Should be infos.

(12) Should org.eclipse.jdt.core.dom.MethodDeclaration.internalGetChildListProperty(ChildListPropertyDescriptor) directly return the extraDimensionInfos ? Or should it call
the properties accessor method ? The latter would check JLS levels ? Same
comment for SVD.

(13) RecoveredVariableBinding is missing JCP disclaimer.

(14) org.eclipse.jdt.core.dom.SingleVariableDeclaration.EXTRA_DIMENSIONS_PROPERTY 
mentions the non-existent EXTRA_DIMENSION_TYPES_PROPERTY.

(15) Did you mean to add setExtraDimension to the javadoc of org.eclipse.jdt.core.dom.SingleVariableDeclaration.setExtraDimensions(int)
instead of getExtraDimension ? 

(16) VariableDeclarationFragment references the non-existent EXTRA_DIMENSION_TYPES_PROPERTY.

Please do a self review one more time after these changes and I&apos;ll also
review once more.</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>2209032</commentid>
    <comment_count>23</comment_count>
    <who name="Markus Keller">markus_keller</who>
    <bug_when>2013-01-28 20:28:33 -0500</bug_when>
    <thetext>(1) The DimensionInfo solution looks good to me.

(2) Getters and setters and properties that are not supported any more in JLS8 should be deprecated. See e.g. MethodDeclaration#getReturnType(). (I just saw that we missed to deprecate MethodDeclaration#MODIFIERS_PROPERTY.)

(3) For MethodDeclaration#getExtraDimensions(), it would be nice to keep the getter, but compute the value from the new slot (extraDimensionInfos.size()). The setter should be deprecated. See BodyDeclaration#getModifiers() for a precedent. (BTW: I still hope the jsr308 expert group fixes this mistake and doesn&apos;t touch the method declaration&apos;s extra dimensions at all).</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>2209079</commentid>
    <comment_count>24</comment_count>
    <who name="Jay Arthanareeswaran">jarthana</who>
    <bug_when>2013-01-29 02:36:10 -0500</bug_when>
    <thetext>(In reply to comment #23)
&gt; (2) Getters and setters and properties that are not supported any more in
&gt; JLS8 should be deprecated. See e.g. MethodDeclaration#getReturnType(). (I
&gt; just saw that we missed to deprecate MethodDeclaration#MODIFIERS_PROPERTY.)

I don&apos;t have a problem with this. But this means we would get more warnings in our code since we will continue to call setExtraDimensions() for AST4 and below in ASTConverter.</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>2209092</commentid>
    <comment_count>25</comment_count>
    <who name="Jay Arthanareeswaran">jarthana</who>
    <bug_when>2013-01-29 03:21:55 -0500</bug_when>
    <thetext>(In reply to comment #23)
&gt; (2) Getters and setters and properties that are not supported any more in
&gt; JLS8 should be deprecated. See e.g. MethodDeclaration#getReturnType(). (I
&gt; just saw that we missed to deprecate MethodDeclaration#MODIFIERS_PROPERTY.)

I have another question here: Shouldn&apos;t we deprecate AST#JLS4 also at this point?</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>2209144</commentid>
    <comment_count>26</comment_count>
    <who name="Markus Keller">markus_keller</who>
    <bug_when>2013-01-29 05:51:12 -0500</bug_when>
    <thetext>(In reply to comment #25)
&gt; I have another question here: Shouldn&apos;t we deprecate AST#JLS4 also at this
&gt; point?

Yes, we should deprecate it. To avoid internal deprecation warnings, we should use techniques similar to AST#JLS3_INTERNAL and BodyDeclaration#internalSetModifiers(int).</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>2209183</commentid>
    <comment_count>27</comment_count>
      <attachid>226254</attachid>
    <who name="Jay Arthanareeswaran">jarthana</who>
    <bug_when>2013-01-29 07:09:09 -0500</bug_when>
    <thetext>Created attachment 226254
Updated patch

Patch incorporates review comments from Srikanth and Markus and also includes few other documentation changes.

Note that the patch produces lot of new deprecated warnings.</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>2209597</commentid>
    <comment_count>28</comment_count>
    <who name="Srikanth Sankaran">srikanth_sankaran</who>
    <bug_when>2013-01-29 20:14:09 -0500</bug_when>
    <thetext>(In reply to comment #27)

&gt; Note that the patch produces lot of new deprecated warnings.

The usual trick to avoid these warnings is to rely on two behaviors: (a) Deprecated code referencing deprecated fields does not produce a warning out
of the box (b) deprecated warnings are issued only for client code and not 
for the class it.

Have you tried these ?</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>2210011</commentid>
    <comment_count>29</comment_count>
    <who name="Srikanth Sankaran">srikanth_sankaran</who>
    <bug_when>2013-01-30 12:50:43 -0500</bug_when>
    <thetext>Review comments: 

(1) For future work: (no need to change now)

    DimensionInfo result = new DimensionInfo(this);
    return result;

could have been clutter free as &quot;return new DimensionInfo(this);&quot;

(2) DimensionInfo top level javadoc needs reformatting with &lt;pre&gt; tags.

(3) The phrase &quot;dimension type&quot; still shows up in 10 places per text
search and needs to be replaced with &quot;dimension info&quot;

(4) org.eclipse.jdt.core.dom.MethodDeclaration.getExtraDimensionInfos()&apos;s
javadoc mentions element type as {@link DimensionInfo}[] - this is incorrect.

(5) Same problem as (4) in SVD.

(6) Please get rid of the change in RecoveredVariableBinding as it is no 
longer relevant.

(7) Javadoc on org.eclipse.jdt.core.dom.VariableDeclarationFragment.extraDimensionInfos reads:
&quot;The extra dimensions this node has with annotations if any&quot; - I think
you meant to say &quot;The extra dimensions this node has with optional annotations&quot;

:)

(8) org.eclipse.jdt.core.dom.VariableDeclarationFragment.accept0(ASTVisitor):
The comment reads: // visit children in normal left to right reading order
So extra dimensions should be handled before initializer.

(9) Same problem as (4) in VDF

(10) Flattener: for (int i = 0; i &lt; dimensions.size(); i++) , extract the loop
invariant size() into local. (3 places)

(11) ASTStructuralPropertyTest is missing copyright update and JCP disclaimer.

(12) The *existing* method ASTConverter#retrieveEndOfRightParenthesisPosition 
is totally bogus and will fail for a test case like:

public class X {
 	static void foo(@ReadOnly(&quot;Blah&quot;) int z) { 
 		
 	} 
}

@interface ReadOnly {
	String value() default &quot;Blah&quot;;
}

The method must discount balanced parentheses. Please raise a follow up
(low priority) defect for that.

(13) Please get rid of all changes of the form:
(this.ast.apiLevel &lt; AST.JLS8) ? variableDeclarationFragment.getExtraDimensions() 
						: variableDeclarationFragment.getExtraDimensionInfos().size());
as they are just cluttering the code and are not required.

(14) This patch generates many compiler warnings - all of which must be
cleaned up. See comment #28.

Finally, you ought to set up an appointment with an optometrist to get
checked out for Saleswaram :)

---

If these are the only changes you are making, please proceed to release.
Thanks.</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>2210361</commentid>
    <comment_count>30</comment_count>
    <who name="Jay Arthanareeswaran">jarthana</who>
    <bug_when>2013-01-31 05:59:10 -0500</bug_when>
    <thetext>(In reply to comment #29)
&gt; (12) The *existing* method
&gt; ASTConverter#retrieveEndOfRightParenthesisPosition 
&gt; is totally bogus and will fail for a test case like:
&gt; ... 
&gt; The method must discount balanced parentheses. Please raise a follow up
&gt; (low priority) defect for that.

Logged bug 399600 for this.
 
&gt; If these are the only changes you are making, please proceed to release.
&gt; Thanks.

Yes, and released here the fix via commit:

http://git.eclipse.org/c/jdt/eclipse.jdt.core.git/commit/?h=BETA_JAVA8&amp;id=ebf5deb17f462a2a1a50c9b4076f1d52394081e1</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>2210362</commentid>
    <comment_count>31</comment_count>
    <who name="Jay Arthanareeswaran">jarthana</who>
    <bug_when>2013-01-31 05:59:41 -0500</bug_when>
    <thetext>Marking as resolved.</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>2210391</commentid>
    <comment_count>32</comment_count>
    <who name="Jay Arthanareeswaran">jarthana</who>
    <bug_when>2013-01-31 06:55:13 -0500</bug_when>
    <thetext>(In reply to comment #30)
&gt; http://git.eclipse.org/c/jdt/eclipse.jdt.core.git/commit/
&gt; ?h=BETA_JAVA8&amp;id=ebf5deb17f462a2a1a50c9b4076f1d52394081e1

In the last commit, one file got left out due to a staging error. I have pushed it here:

http://git.eclipse.org/c/jdt/eclipse.jdt.core.git/commit/?h=BETA_JAVA8&amp;id=a6672627189e3721a2c066ce225fd09afe979f63</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>2211470</commentid>
    <comment_count>33</comment_count>
    <who name="Jay Arthanareeswaran">jarthana</who>
    <bug_when>2013-02-03 12:07:00 -0500</bug_when>
    <thetext>Refer to bug 391894, comment #2 through 5 - this commit removes expression from DimensionInfo after renaming the same to ExtraDimension.

http://git.eclipse.org/c/jdt/eclipse.jdt.core.git/commit/?h=BETA_JAVA8&amp;id=7df061f9da0ab96be87e5851cb157a28c5f5bca0</thetext>
  </long_desc>
      
          <attachment
              isobsolete="1"
              ispatch="1"
              isprivate="0"
          >
            <attachid>223782</attachid>
            <date>2012-11-20 23:22:00 -0500</date>
            <delta_ts>2012-11-27 00:57:58 -0500</delta_ts>
            <desc>work in progress</desc>
            <filename>Fix-for-bug-391895_final.patch</filename>
            <type>text/plain</type>
            <size>23459</size>
            <attacher name="Jay Arthanareeswaran">jarthana</attacher>
            
              <data encoding="base64">ZGlmZiAtLWdpdCBhL29yZy5lY2xpcHNlLmpkdC5jb3JlLnRlc3RzLm1vZGVsL3NyYy9vcmcvZWNs
aXBzZS9qZHQvY29yZS90ZXN0cy9yZXdyaXRlL2Rlc2NyaWJpbmcvQVNUUmV3cml0aW5nVHlwZURl
Y2xUZXN0LmphdmEgYi9vcmcuZWNsaXBzZS5qZHQuY29yZS50ZXN0cy5tb2RlbC9zcmMvb3JnL2Vj
bGlwc2UvamR0L2NvcmUvdGVzdHMvcmV3cml0ZS9kZXNjcmliaW5nL0FTVFJld3JpdGluZ1R5cGVE
ZWNsVGVzdC5qYXZhCmluZGV4IDdmOWExOTIuLjYwNWExZTYgMTAwNjQ0Ci0tLSBhL29yZy5lY2xp
cHNlLmpkdC5jb3JlLnRlc3RzLm1vZGVsL3NyYy9vcmcvZWNsaXBzZS9qZHQvY29yZS90ZXN0cy9y
ZXdyaXRlL2Rlc2NyaWJpbmcvQVNUUmV3cml0aW5nVHlwZURlY2xUZXN0LmphdmEKKysrIGIvb3Jn
LmVjbGlwc2UuamR0LmNvcmUudGVzdHMubW9kZWwvc3JjL29yZy9lY2xpcHNlL2pkdC9jb3JlL3Rl
c3RzL3Jld3JpdGUvZGVzY3JpYmluZy9BU1RSZXdyaXRpbmdUeXBlRGVjbFRlc3QuamF2YQpAQCAt
MTgsNCArMTgsNSBAQAogaW1wb3J0IG9yZy5lY2xpcHNlLmpkdC5jb3JlLklQYWNrYWdlRnJhZ21l
bnQ7CiBpbXBvcnQgb3JnLmVjbGlwc2UuamR0LmNvcmUuSmF2YUNvcmU7CitpbXBvcnQgb3JnLmVj
bGlwc2UuamR0LmNvcmUuSmF2YU1vZGVsRXhjZXB0aW9uOwogCiBpbXBvcnQgb3JnLmVjbGlwc2Uu
amR0LmNvcmUuZG9tLio7CkBAIC0xMDM2LDQgKzEwMzcsMjAgQEAKIAl9CiAKKwlwdWJsaWMgdm9p
ZCB0ZXN0RGltZW5zaW9uc1dpdGhBbm5vdGF0aW9ucygpIHRocm93cyBKYXZhTW9kZWxFeGNlcHRp
b24geworCQlJUGFja2FnZUZyYWdtZW50IHBhY2sxPSB0aGlzLnNvdXJjZUZvbGRlci5jcmVhdGVQ
YWNrYWdlRnJhZ21lbnQoInAiLCBmYWxzZSwgbnVsbCk7CisJCVN0cmluZ0J1ZmZlciBidWY9IG5l
dyBTdHJpbmdCdWZmZXIoKTsKKwkJYnVmLmFwcGVuZCgicGFja2FnZSB0ZXN0MTtcbiIpOworCQli
dWYuYXBwZW5kKCJwdWJsaWMgY2xhc3MgRSB7XG4iKTsKKwkJYnVmLmFwcGVuZCgiICAgIHB1Ymxp
YyB2b2lkIGZvbygpIHtcbiIpOworCQlidWYuYXBwZW5kKCIgICAgICAgIGludCBpLCBqLCBrPSAw
LCB4W11bXSwgeVtdPSB7MCwgMX07XG4iKTsKKwkJYnVmLmFwcGVuZCgiICAgIH1cbiIpOworCQli
dWYuYXBwZW5kKCJ9XG4iKTsKKwkJSUNvbXBpbGF0aW9uVW5pdCBjdT0gcGFjazEuY3JlYXRlQ29t
cGlsYXRpb25Vbml0KCJYLmphdmEiLCBidWYudG9TdHJpbmcoKSwgZmFsc2UsIG51bGwpOworCQlD
b21waWxhdGlvblVuaXQgYXN0Um9vdD0gY3JlYXRlQVNUKGN1KTsKKwkJQVNUUmV3cml0ZSByZXdy
aXRlPSBBU1RSZXdyaXRlLmNyZWF0ZShhc3RSb290LmdldEFTVCgpKTsKKworCQlBU1QgYXN0PSBh
c3RSb290LmdldEFTVCgpOworCX0KKwogCXB1YmxpYyB2b2lkIHRlc3RWYXJpYWJsZURlY2xhcmF0
aW9uRnJhZ21lbnQoKSB0aHJvd3MgRXhjZXB0aW9uIHsKIAkJSVBhY2thZ2VGcmFnbWVudCBwYWNr
MT0gdGhpcy5zb3VyY2VGb2xkZXIuY3JlYXRlUGFja2FnZUZyYWdtZW50KCJ0ZXN0MSIsIGZhbHNl
LCBudWxsKTsKZGlmZiAtLWdpdCBhL29yZy5lY2xpcHNlLmpkdC5jb3JlL2RvbS9vcmcvZWNsaXBz
ZS9qZHQvY29yZS9kb20vQVNUQ29udmVydGVyLmphdmEgYi9vcmcuZWNsaXBzZS5qZHQuY29yZS9k
b20vb3JnL2VjbGlwc2UvamR0L2NvcmUvZG9tL0FTVENvbnZlcnRlci5qYXZhCmluZGV4IDI3YTE2
YzQuLjY1NGI0MjQgMTAwNjQ0Ci0tLSBhL29yZy5lY2xpcHNlLmpkdC5jb3JlL2RvbS9vcmcvZWNs
aXBzZS9qZHQvY29yZS9kb20vQVNUQ29udmVydGVyLmphdmEKKysrIGIvb3JnLmVjbGlwc2UuamR0
LmNvcmUvZG9tL29yZy9lY2xpcHNlL2pkdC9jb3JlL2RvbS9BU1RDb252ZXJ0ZXIuamF2YQpAQCAt
Mjk2OSw0ICsyOTY5LDggQEAKIAkJaW50IGV4dHJhRGltZW5zaW9ucyA9IHJldHJpZXZlRXh0cmFE
aW1lbnNpb24oZmllbGREZWNsYXJhdGlvbi5zb3VyY2VFbmQgKyAxLCBmaWVsZERlY2xhcmF0aW9u
LmRlY2xhcmF0aW9uU291cmNlRW5kICk7CiAJCXZhcmlhYmxlRGVjbGFyYXRpb25GcmFnbWVudC5z
ZXRFeHRyYURpbWVuc2lvbnMoZXh0cmFEaW1lbnNpb25zKTsKKwkJaWYgKGV4dHJhRGltZW5zaW9u
cyA+IDAgJiYgdGhpcy5hc3QuYXBpTGV2ZWwgPj0gQVNULkpMUzgpIHsKKwkJCVR5cGUgdHlwZSA9
IGNvbnZlcnRUeXBlKGZpZWxkRGVjbGFyYXRpb24udHlwZSk7CisJCQl2YXJpYWJsZURlY2xhcmF0
aW9uRnJhZ21lbnQuc2V0RXh0cmFEaW1lbnNpb25zVHlwZSgoQXJyYXlUeXBlKSB0eXBlKTsKKwkJ
fQogCQlpZiAoZmllbGREZWNsYXJhdGlvbi5pbml0aWFsaXphdGlvbiAhPSBudWxsKSB7CiAJCQlm
aW5hbCBFeHByZXNzaW9uIGV4cHJlc3Npb24gPSBjb252ZXJ0KGZpZWxkRGVjbGFyYXRpb24uaW5p
dGlhbGl6YXRpb24pOwpAQCAtMzAwNyw0ICszMDExLDggQEAKIAkJaW50IGV4dHJhRGltZW5zaW9u
ID0gcmV0cmlldmVFeHRyYURpbWVuc2lvbihsb2NhbERlY2xhcmF0aW9uLnNvdXJjZUVuZCArIDEs
IHRoaXMuY29tcGlsYXRpb25Vbml0U291cmNlTGVuZ3RoKTsKIAkJdmFyaWFibGVEZWNsYXJhdGlv
bkZyYWdtZW50LnNldEV4dHJhRGltZW5zaW9ucyhleHRyYURpbWVuc2lvbik7CisJCWlmIChleHRy
YURpbWVuc2lvbiA+IDAgJiYgdGhpcy5hc3QuYXBpTGV2ZWwgPj0gQVNULkpMUzgpIHsKKwkJCVR5
cGUgdHlwZSA9IGNvbnZlcnRUeXBlKGxvY2FsRGVjbGFyYXRpb24udHlwZSk7CisJCQl2YXJpYWJs
ZURlY2xhcmF0aW9uRnJhZ21lbnQuc2V0RXh0cmFEaW1lbnNpb25zVHlwZSgoQXJyYXlUeXBlKSB0
eXBlKTsKKwkJfQogCQlib29sZWFuIGhhc0luaXRpYWxpemF0aW9uID0gaW5pdGlhbGl6YXRpb24g
IT0gbnVsbDsKIAkJaW50IGVuZDsKQEAgLTQyMjYsNCArNDIzNCw1IEBACiAJCXRyeSB7CiAJCQlp
bnQgdG9rZW47CisJCQlib29sZWFuIGlzQW5ub3RhdGlvbiA9IGZhbHNlOwogCQkJd2hpbGUgKCh0
b2tlbiA9IHRoaXMuc2Nhbm5lci5nZXROZXh0VG9rZW4oKSkgIT0gVGVybWluYWxUb2tlbnMuVG9r
ZW5OYW1lRU9GKSB7CiAJCQkJc3dpdGNoKHRva2VuKSB7CkBAIC00MjMyLDYgKzQyNDEsMTcgQEAK
IAkJCQkJY2FzZSBUZXJtaW5hbFRva2Vucy5Ub2tlbk5hbWVDT01NRU5UX0pBVkFET0M6CiAJCQkJ
CWNhc2UgVGVybWluYWxUb2tlbnMuVG9rZW5OYW1lQ09NTUVOVF9MSU5FOgorCQkJCQkJaXNBbm5v
dGF0aW9uID0gZmFsc2U7CisJCQkJCQlicmVhazsKKwkJCQkJY2FzZSBUZXJtaW5hbFRva2Vucy5U
b2tlbk5hbWVBVDoKKwkJCQkJCWlzQW5ub3RhdGlvbiA9IHRydWU7CisJCQkJCQlicmVhazsKKwkJ
CQkJY2FzZSBUZXJtaW5hbFRva2Vucy5Ub2tlbk5hbWVJZGVudGlmaWVyOgorCQkJCQkJaWYgKCFp
c0Fubm90YXRpb24pIHsKKwkJCQkJCQlyZXR1cm4gZGltZW5zaW9uczsKKwkJCQkJCX0KKwkJCQkJ
CWlzQW5ub3RhdGlvbiA9IGZhbHNlOwogCQkJCQkJYnJlYWs7CiAJCQkJCWNhc2UgVGVybWluYWxU
b2tlbnMuVG9rZW5OYW1lUkJSQUNLRVQ6Ly8xNjYKKwkJCQkJCWlzQW5ub3RhdGlvbiA9IGZhbHNl
OwogCQkJCQkJZGltZW5zaW9ucysrOwogCQkJCQkJYnJlYWs7CkBAIC01MTgxLDcgKzUyMDEsMTAg
QEAKIAkJCQkJCQltZXRob2REZWNsYXJhdGlvbi5pbnRlcm5hbFNldFJldHVyblR5cGUoc3ViYXJy
YXlUeXBlKTsKIAkJCQkJCQlicmVhazsKKwkJCQkJCWNhc2UgQVNULkpMUzggOgorCQkJCQkJCW1l
dGhvZERlY2xhcmF0aW9uLnNldEV4dHJhRGltZW5zaW9uc1R5cGUoKEFycmF5VHlwZSkgdHlwZSk7
CisJCQkJCQkJLy8kRkFMTC1USFJPVUdIJAogCQkJCQkJZGVmYXVsdCA6CiAJCQkJCQkJbWV0aG9k
RGVjbGFyYXRpb24uc2V0UmV0dXJuVHlwZTIoc3ViYXJyYXlUeXBlKTsKLQkJCQkJCWJyZWFrOwor
CQkJCQkJCWJyZWFrOwogCQkJCQl9CiAJCQkJCXRoaXMuYXN0LmdldEJpbmRpbmdSZXNvbHZlcigp
LnVwZGF0ZUtleSh0eXBlLCBzdWJhcnJheVR5cGUpOwpAQCAtNTIzOSw0ICs1MjYyLDcgQEAKIAkJ
CQkJdXBkYXRlSW5uZXJQb3NpdGlvbnMoc3ViYXJyYXlUeXBlLCByZW1haW5pbmdEaW1lbnNpb25z
KTsKIAkJCQkJc2luZ2xlVmFyaWFibGVEZWNsYXJhdGlvbi5zZXRUeXBlKHN1YmFycmF5VHlwZSk7
CisJCQkJCWlmICh0aGlzLmFzdC5hcGlMZXZlbCA+PSBBU1QuSkxTOCkgeworCQkJCQkJc2luZ2xl
VmFyaWFibGVEZWNsYXJhdGlvbi5zZXRFeHRyYURpbWVuc2lvbnNUeXBlKChBcnJheVR5cGUpIHR5
cGUpOworCQkJCQl9CiAJCQkJCXRoaXMuYXN0LmdldEJpbmRpbmdSZXNvbHZlcigpLnVwZGF0ZUtl
eSh0eXBlLCBzdWJhcnJheVR5cGUpOwogCQkJCX0KZGlmZiAtLWdpdCBhL29yZy5lY2xpcHNlLmpk
dC5jb3JlL2RvbS9vcmcvZWNsaXBzZS9qZHQvY29yZS9kb20vQVNUTWF0Y2hlci5qYXZhIGIvb3Jn
LmVjbGlwc2UuamR0LmNvcmUvZG9tL29yZy9lY2xpcHNlL2pkdC9jb3JlL2RvbS9BU1RNYXRjaGVy
LmphdmEKaW5kZXggMTY3MTQ4Ny4uZGI5YWM2MCAxMDA2NDQKLS0tIGEvb3JnLmVjbGlwc2UuamR0
LmNvcmUvZG9tL29yZy9lY2xpcHNlL2pkdC9jb3JlL2RvbS9BU1RNYXRjaGVyLmphdmEKKysrIGIv
b3JnLmVjbGlwc2UuamR0LmNvcmUvZG9tL29yZy9lY2xpcHNlL2pkdC9jb3JlL2RvbS9BU1RNYXRj
aGVyLmphdmEKQEAgLTEzOTgsNCArMTM5OCw1IEBACiAJCQkJJiYgc2FmZVN1YnRyZWVMaXN0TWF0
Y2gobm9kZS5wYXJhbWV0ZXJzKCksIG8ucGFyYW1ldGVycygpKQogCSAJCQkmJiBub2RlLmdldEV4
dHJhRGltZW5zaW9ucygpID09IG8uZ2V0RXh0cmFEaW1lbnNpb25zKCkKKwkgCQkJJiYgKG5vZGUu
Z2V0QVNUKCkuYXBpTGV2ZWwgPCBBU1QuSkxTOCB8fCBzYWZlU3VidHJlZU1hdGNoKG5vZGUuZ2V0
RXh0cmFEaW1lbnNpb25zVHlwZSgpLCBvLmdldEV4dHJhRGltZW5zaW9uc1R5cGUoKSkpCiAJCQkJ
JiYgc2FmZVN1YnRyZWVMaXN0TWF0Y2gobm9kZS50aHJvd25FeGNlcHRpb25zKCksIG8udGhyb3du
RXhjZXB0aW9ucygpKQogCQkJCSYmIHNhZmVTdWJ0cmVlTWF0Y2gobm9kZS5nZXRCb2R5KCksIG8u
Z2V0Qm9keSgpKSk7CkBAIC0xODkxLDQgKzE4OTIsNSBAQAogCQkJCSYmIHNhZmVTdWJ0cmVlTWF0
Y2gobm9kZS5nZXROYW1lKCksIG8uZ2V0TmFtZSgpKQogCSAJCQkmJiBub2RlLmdldEV4dHJhRGlt
ZW5zaW9ucygpID09IG8uZ2V0RXh0cmFEaW1lbnNpb25zKCkKKwkgCQkgCSYmIChub2RlLmdldEFT
VCgpLmFwaUxldmVsIDwgQVNULkpMUzggfHwgc2FmZVN1YnRyZWVNYXRjaChub2RlLmdldEV4dHJh
RGltZW5zaW9uc1R5cGUoKSwgby5nZXRFeHRyYURpbWVuc2lvbnNUeXBlKCkpKQogCQkJCSYmIHNh
ZmVTdWJ0cmVlTWF0Y2gobm9kZS5nZXRJbml0aWFsaXplcigpLCBvLmdldEluaXRpYWxpemVyKCkp
OwogCX0KQEAgLTIzODMsNCArMjM4NSw1IEBACiAJCXJldHVybiBzYWZlU3VidHJlZU1hdGNoKG5v
ZGUuZ2V0TmFtZSgpLCBvLmdldE5hbWUoKSkKIAkJCSYmIG5vZGUuZ2V0RXh0cmFEaW1lbnNpb25z
KCkgPT0gby5nZXRFeHRyYURpbWVuc2lvbnMoKQorCQkJJiYgKG5vZGUuZ2V0QVNUKCkuYXBpTGV2
ZWwgPCBBU1QuSkxTOCB8fCBzYWZlU3VidHJlZU1hdGNoKG5vZGUuZ2V0RXh0cmFEaW1lbnNpb25z
VHlwZSgpLCBvLmdldEV4dHJhRGltZW5zaW9uc1R5cGUoKSkpCiAJCQkmJiBzYWZlU3VidHJlZU1h
dGNoKG5vZGUuZ2V0SW5pdGlhbGl6ZXIoKSwgby5nZXRJbml0aWFsaXplcigpKTsKIAl9CmRpZmYg
LS1naXQgYS9vcmcuZWNsaXBzZS5qZHQuY29yZS9kb20vb3JnL2VjbGlwc2UvamR0L2NvcmUvZG9t
L0FTVE5vZGUuamF2YSBiL29yZy5lY2xpcHNlLmpkdC5jb3JlL2RvbS9vcmcvZWNsaXBzZS9qZHQv
Y29yZS9kb20vQVNUTm9kZS5qYXZhCmluZGV4IDY3YTY0MWEuLmQ0OThiM2IgMTAwNjQ0Ci0tLSBh
L29yZy5lY2xpcHNlLmpkdC5jb3JlL2RvbS9vcmcvZWNsaXBzZS9qZHQvY29yZS9kb20vQVNUTm9k
ZS5qYXZhCisrKyBiL29yZy5lY2xpcHNlLmpkdC5jb3JlL2RvbS9vcmcvZWNsaXBzZS9qZHQvY29y
ZS9kb20vQVNUTm9kZS5qYXZhCkBAIC03NzIsNCArNzcyLDEzIEBACiAJICovCiAJcHVibGljIHN0
YXRpYyBmaW5hbCBpbnQgVU5JT05fVFlQRSA9IDg0OworCQorCS8qKgorCSAqIE5vZGUgdHlwZSBj
b25zdGFudCBpbmRpY2F0aW5nIGEgbm9kZSBvZiB0eXBlCisJICogPGNvZGU+RGltZW5zaW9uPC9j
b2RlPi4KKwkgKiAKKwkgKiBAc2VlIERpbWVuc2lvbgorCSAqIEBzaW5jZSAzLjkKKwkgKi8KKwlw
dWJsaWMgc3RhdGljIGZpbmFsIGludCBESU1FTlNJT04gPSA4NTsKIAogCS8qKgpkaWZmIC0tZ2l0
IGEvb3JnLmVjbGlwc2UuamR0LmNvcmUvZG9tL29yZy9lY2xpcHNlL2pkdC9jb3JlL2RvbS9NZXRo
b2REZWNsYXJhdGlvbi5qYXZhIGIvb3JnLmVjbGlwc2UuamR0LmNvcmUvZG9tL29yZy9lY2xpcHNl
L2pkdC9jb3JlL2RvbS9NZXRob2REZWNsYXJhdGlvbi5qYXZhCmluZGV4IDk5NWJkZTAuLjhlMjM0
NDggMTAwNjQ0Ci0tLSBhL29yZy5lY2xpcHNlLmpkdC5jb3JlL2RvbS9vcmcvZWNsaXBzZS9qZHQv
Y29yZS9kb20vTWV0aG9kRGVjbGFyYXRpb24uamF2YQorKysgYi9vcmcuZWNsaXBzZS5qZHQuY29y
ZS9kb20vb3JnL2VjbGlwc2UvamR0L2NvcmUvZG9tL01ldGhvZERlY2xhcmF0aW9uLmphdmEKQEAg
LTE0Niw0ICsxNDYsMTEgQEAKIAogCS8qKgorCSAqIFRoZSAiZXh0cmFEaW1lbnNpb25zVHlwZSIg
c3RydWN0dXJhbCBwcm9wZXJ0eSBvZiB0aGlzIG5vZGUgdHlwZSAoY2hpbGQgdHlwZToge0BsaW5r
IEFycmF5VHlwZX0pLgorCSAqIEBzaW5jZSAzLjkKKwkgKi8KKwlwdWJsaWMgc3RhdGljIGZpbmFs
IENoaWxkUHJvcGVydHlEZXNjcmlwdG9yIEVYVFJBX0RJTUVOU0lPTlNfVFlQRV9QUk9QRVJUWSA9
CisJCQluZXcgQ2hpbGRQcm9wZXJ0eURlc2NyaXB0b3IoTWV0aG9kRGVjbGFyYXRpb24uY2xhc3Ms
ICJleHRyYURpbWVuc2lvbnNUeXBlIiwgQXJyYXlUeXBlLmNsYXNzLCBPUFRJT05BTCwgTk9fQ1lD
TEVfUklTSyk7IC8vJE5PTi1OTFMtMSQKKworCS8qKgogCSAqIFRoZSAidHlwZVBhcmFtZXRlcnMi
IHN0cnVjdHVyYWwgcHJvcGVydHkgb2YgdGhpcyBub2RlIHR5cGUgKGVsZW1lbnQgdHlwZToge0Bs
aW5rIFR5cGVQYXJhbWV0ZXJ9KSAoYWRkZWQgaW4gSkxTMyBBUEkpLgogCSAqIEBzaW5jZSAzLjEK
QEAgLTIyOCw0ICsyMzUsNSBAQAogCQlhZGRKTFMzUHJvcGVydGllcyhwcm9wZXJ0eUxpc3QpOwog
CQlhZGRQcm9wZXJ0eShSRUNFSVZFUl9QUk9QRVJUWSwgcHJvcGVydHlMaXN0KTsKKwkJYWRkUHJv
cGVydHkoRVhUUkFfRElNRU5TSU9OU19UWVBFX1BST1BFUlRZLCBwcm9wZXJ0eUxpc3QpOwogCQlQ
Uk9QRVJUWV9ERVNDUklQVE9SU184XzAgPSByZWFwUHJvcGVydHlMaXN0KHByb3BlcnR5TGlzdCk7
CiAJfQpAQCAtMzE5LDQgKzMyNywxMiBAQAogCSAqLwogCXByaXZhdGUgaW50IGV4dHJhQXJyYXlE
aW1lbnNpb25zID0gMDsKKworCS8qKgorCSAqIFRoZSBhbm5vdGF0aW9ucyBvbiB0aGUgZXh0cmEg
ZGltZW5zaW9ucyB0aGF0IHRoaXMgdmFyaWFibGUgaGFzOyAKKwkgKiBkZWZhdWx0IHRvIG51bGwu
CisJICogCisJICogQHNpbmNlIDMuOQorCSAqLworCXByb3RlY3RlZCBBcnJheVR5cGUgZXh0cmFE
aW1lbnNpb25zVHlwZSA9IG51bGw7CiAKIAkvKioKQEAgLTUzMSw0ICs1NDcsNyBAQAogCQlyZXN1
bHQuc2V0Q29uc3RydWN0b3IoaXNDb25zdHJ1Y3RvcigpKTsKIAkJcmVzdWx0LnNldEV4dHJhRGlt
ZW5zaW9ucyhnZXRFeHRyYURpbWVuc2lvbnMoKSk7CisJCWlmICh0aGlzLmFzdC5hcGlMZXZlbCA+
PSBBU1QuSkxTOCkgeworCQkJcmVzdWx0LmV4dHJhRGltZW5zaW9uc1R5cGUgPSAoQXJyYXlUeXBl
KSB0aGlzLmV4dHJhRGltZW5zaW9uc1R5cGUuY2xvbmUodGFyZ2V0KTsKKwkJfQogCQlyZXN1bHQu
c2V0TmFtZSgoU2ltcGxlTmFtZSkgZ2V0TmFtZSgpLmNsb25lKHRhcmdldCkpOwogCQlyZXN1bHQu
cGFyYW1ldGVycygpLmFkZEFsbCgKQEAgLTU3MCw0ICs1ODksNyBAQAogCQkJfQogCQkJYWNjZXB0
Q2hpbGRyZW4odmlzaXRvciwgdGhpcy5wYXJhbWV0ZXJzKTsKKwkJCWlmICh0aGlzLmFzdC5hcGlM
ZXZlbCA+PSBBU1QuSkxTOCkgeworCQkJCWFjY2VwdENoaWxkKHZpc2l0b3IsIHRoaXMuZXh0cmFE
aW1lbnNpb25zVHlwZSk7CisJCQl9CiAJCQlhY2NlcHRDaGlsZHJlbih2aXNpdG9yLCB0aGlzLnRo
cm93bkV4Y2VwdGlvbnMpOwogCQkJYWNjZXB0Q2hpbGQodmlzaXRvciwgZ2V0Qm9keSgpKTsKQEAg
LTY3OCw1ICs3MDAsNSBAQAogCSAqCiAJICogQHNpbmNlIDMuOQotCSAqIEBwYXJhbSByZWMgZXhw
bGljaXQgcmVjZWl2ZXIgcGFyYW1ldGVyIHRvIGJlIGFkZGVkIHRvIHRoZSBtZXRob2QgZGVjbGFy
YXRpb24KKwkgKiBAcGFyYW0gcmVjZWl2ZXIgZXhwbGljaXQgcmVjZWl2ZXIgcGFyYW1ldGVyIHRv
IGJlIGFkZGVkIHRvIHRoZSBtZXRob2QgZGVjbGFyYXRpb24KIAkgKi8KIAlwdWJsaWMgdm9pZCBz
ZXRSZWNlaXZlcihTaW5nbGVWYXJpYWJsZURlY2xhcmF0aW9uIHJlY2VpdmVyKSB7CkBAIC05Mjcs
NCArOTQ5LDIzIEBACiAKIAkvKioKKwkgKiBSZXR1cm5zIHRoZSBsaXZlIG9yZGVyZWQgbGlzdCBv
ZiBhbm5vdGF0aW9ucyBvbiBleHRyYSBkaW1lbnNpb25zLgorCSAqIAorCSAqIEByZXR1cm4gdGhl
IGxpdmUgbGlzdCBvZiBhbm5vdGF0aW9ucyBvbiBkaW1lbnNpb25zIChlbGVtZW50IHR5cGU6IHtA
bGluayBBbm5vdGF0aW9ufVtdKQorCSAqIEBzaW5jZSAzLjkKKwkgKi8KKwlwdWJsaWMgQXJyYXlU
eXBlIGdldEV4dHJhRGltZW5zaW9uc1R5cGUoKSB7CisJCXVuc3VwcG9ydGVkSW4yXzNfNCgpOwor
CQlyZXR1cm4gdGhpcy5leHRyYURpbWVuc2lvbnNUeXBlOworCX0KKwkKKwkvKioKKwkgKiBAc2lu
Y2UgMy45CisJICovCisJcHVibGljIHZvaWQgc2V0RXh0cmFEaW1lbnNpb25zVHlwZShBcnJheVR5
cGUgdHlwZSkgeworCQl1bnN1cHBvcnRlZEluMl8zXzQoKTsKKwkJdGhpcy5leHRyYURpbWVuc2lv
bnNUeXBlID0gdHlwZTsKKwl9CisKKwkvKioKIAkgKiBSZXR1cm5zIHRoZSBib2R5IG9mIHRoaXMg
bWV0aG9kIGRlY2xhcmF0aW9uLCBvciA8Y29kZT5udWxsPC9jb2RlPiBpZgogCSAqIHRoaXMgbWV0
aG9kIGhhcyA8Yj5ubzwvYj4gYm9keS4KZGlmZiAtLWdpdCBhL29yZy5lY2xpcHNlLmpkdC5jb3Jl
L2RvbS9vcmcvZWNsaXBzZS9qZHQvY29yZS9kb20vU2luZ2xlVmFyaWFibGVEZWNsYXJhdGlvbi5q
YXZhIGIvb3JnLmVjbGlwc2UuamR0LmNvcmUvZG9tL29yZy9lY2xpcHNlL2pkdC9jb3JlL2RvbS9T
aW5nbGVWYXJpYWJsZURlY2xhcmF0aW9uLmphdmEKaW5kZXggNDM2YWYyMS4uYzEyNTc1ZSAxMDA2
NDQKLS0tIGEvb3JnLmVjbGlwc2UuamR0LmNvcmUvZG9tL29yZy9lY2xpcHNlL2pkdC9jb3JlL2Rv
bS9TaW5nbGVWYXJpYWJsZURlY2xhcmF0aW9uLmphdmEKKysrIGIvb3JnLmVjbGlwc2UuamR0LmNv
cmUvZG9tL29yZy9lY2xpcHNlL2pkdC9jb3JlL2RvbS9TaW5nbGVWYXJpYWJsZURlY2xhcmF0aW9u
LmphdmEKQEAgLTgyLDQgKzgyLDExIEBACiAKIAkvKioKKwkgKiBUaGUgImV4dHJhRGltZW5zaW9u
c1R5cGUiIHN0cnVjdHVyYWwgcHJvcGVydHkgb2YgdGhpcyBub2RlIHR5cGUgKGNoaWxkIHR5cGU6
IHtAbGluayBBcnJheVR5cGV9KS4KKwkgKiBAc2luY2UgMy45CisJICovCisJcHVibGljIHN0YXRp
YyBmaW5hbCBDaGlsZFByb3BlcnR5RGVzY3JpcHRvciBFWFRSQV9ESU1FTlNJT05TX1RZUEVfUFJP
UEVSVFkgPQorCQkJbmV3IENoaWxkUHJvcGVydHlEZXNjcmlwdG9yKFNpbmdsZVZhcmlhYmxlRGVj
bGFyYXRpb24uY2xhc3MsICJleHRyYURpbWVuc2lvbnNUeXBlIiwgQXJyYXlUeXBlLmNsYXNzLCBP
UFRJT05BTCwgTk9fQ1lDTEVfUklTSyk7IC8vJE5PTi1OTFMtMSQKKworCS8qKgogCSAqIFRoZSAi
aW5pdGlhbGl6ZXIiIHN0cnVjdHVyYWwgcHJvcGVydHkgb2YgdGhpcyBub2RlIHR5cGUgKGNoaWxk
IHR5cGU6IHtAbGluayBFeHByZXNzaW9ufSkuCiAJICogQHNpbmNlIDMuMApAQCAtMTAzLDQgKzEx
MCwxMiBAQAogCSAqLwogCXByaXZhdGUgc3RhdGljIGZpbmFsIExpc3QgUFJPUEVSVFlfREVTQ1JJ
UFRPUlNfM18wOworCQorCS8qKgorCSAqIEEgbGlzdCBvZiBwcm9wZXJ0eSBkZXNjcmlwdG9ycyAo
ZWxlbWVudCB0eXBlOgorCSAqIHtAbGluayBTdHJ1Y3R1cmFsUHJvcGVydHlEZXNjcmlwdG9yfSks
CisJICogb3IgbnVsbCBpZiB1bmluaXRpYWxpemVkLgorCSAqIEBzaW5jZSAzLjkKKwkgKi8KKwlw
cml2YXRlIHN0YXRpYyBmaW5hbCBMaXN0IFBST1BFUlRZX0RFU0NSSVBUT1JTXzhfMDsKIAogCXN0
YXRpYyB7CkBAIC0xMTYsNCArMTMxLDE1IEBACiAJCXByb3BlcnR5TGlzdCA9IG5ldyBBcnJheUxp
c3QoNyk7CiAJCWNyZWF0ZVByb3BlcnR5TGlzdChTaW5nbGVWYXJpYWJsZURlY2xhcmF0aW9uLmNs
YXNzLCBwcm9wZXJ0eUxpc3QpOworCQlhZGRKTFMzUHJvcGVydGllcyhwcm9wZXJ0eUxpc3QpOwor
CQlQUk9QRVJUWV9ERVNDUklQVE9SU18zXzAgPSByZWFwUHJvcGVydHlMaXN0KHByb3BlcnR5TGlz
dCk7CisJCQorCQlwcm9wZXJ0eUxpc3QgPSBuZXcgQXJyYXlMaXN0KDgpOworCQljcmVhdGVQcm9w
ZXJ0eUxpc3QoU2luZ2xlVmFyaWFibGVEZWNsYXJhdGlvbi5jbGFzcywgcHJvcGVydHlMaXN0KTsK
KwkJYWRkSkxTM1Byb3BlcnRpZXMocHJvcGVydHlMaXN0KTsKKwkJYWRkUHJvcGVydHkoRVhUUkFf
RElNRU5TSU9OU19UWVBFX1BST1BFUlRZLCBwcm9wZXJ0eUxpc3QpOworCQlQUk9QRVJUWV9ERVND
UklQVE9SU184XzAgPSByZWFwUHJvcGVydHlMaXN0KHByb3BlcnR5TGlzdCk7CisJfQorCisJcHJp
dmF0ZSBzdGF0aWMgdm9pZCBhZGRKTFMzUHJvcGVydGllcyhMaXN0IHByb3BlcnR5TGlzdCkgewog
CQlhZGRQcm9wZXJ0eShNT0RJRklFUlMyX1BST1BFUlRZLCBwcm9wZXJ0eUxpc3QpOwogCQlhZGRQ
cm9wZXJ0eShUWVBFX1BST1BFUlRZLCBwcm9wZXJ0eUxpc3QpOwpAQCAtMTIyLDUgKzE0OCw0IEBA
CiAJCWFkZFByb3BlcnR5KEVYVFJBX0RJTUVOU0lPTlNfUFJPUEVSVFksIHByb3BlcnR5TGlzdCk7
CiAJCWFkZFByb3BlcnR5KElOSVRJQUxJWkVSX1BST1BFUlRZLCBwcm9wZXJ0eUxpc3QpOwotCQlQ
Uk9QRVJUWV9ERVNDUklQVE9SU18zXzAgPSByZWFwUHJvcGVydHlMaXN0KHByb3BlcnR5TGlzdCk7
CiAJfQogCkBAIC0xMzYsOCArMTYxLDEyIEBACiAJICovCiAJcHVibGljIHN0YXRpYyBMaXN0IHBy
b3BlcnR5RGVzY3JpcHRvcnMoaW50IGFwaUxldmVsKSB7Ci0JCWlmIChhcGlMZXZlbCA9PSBBU1Qu
SkxTMl9JTlRFUk5BTCkgewotCQkJcmV0dXJuIFBST1BFUlRZX0RFU0NSSVBUT1JTXzJfMDsKLQkJ
fSBlbHNlIHsKLQkJCXJldHVybiBQUk9QRVJUWV9ERVNDUklQVE9SU18zXzA7CisJCXN3aXRjaCAo
YXBpTGV2ZWwpIHsKKwkJCWNhc2UgQVNULkpMUzJfSU5URVJOQUw6CisJCQkJCXJldHVybiBQUk9Q
RVJUWV9ERVNDUklQVE9SU18yXzA7CisJCQljYXNlIEFTVC5KTFMzX0lOVEVSTkFMOgorCQkJY2Fz
ZSBBU1QuSkxTNDoKKwkJCQkJcmV0dXJuIFBST1BFUlRZX0RFU0NSSVBUT1JTXzNfMDsKKwkJCWRl
ZmF1bHQ6CisJCQkJCXJldHVybiBQUk9QRVJUWV9ERVNDUklQVE9SU184XzA7CiAJCX0KIAl9CkBA
IC0xODUsNCArMjE0LDEyIEBACiAJICovCiAJcHJpdmF0ZSBpbnQgZXh0cmFBcnJheURpbWVuc2lv
bnMgPSAwOworCisJLyoqCisJICogVGhlIGFubm90YXRpb25zIG9uIHRoZSBleHRyYSBkaW1lbnNp
b25zIHRoYXQgdGhpcyB2YXJpYWJsZSBoYXM7IAorCSAqIGRlZmF1bHQgdG8gbnVsbC4KKwkgKiAK
KwkgKiBAc2luY2UgMy45CisJICovCisJcHJvdGVjdGVkIEFycmF5VHlwZSBleHRyYURpbWVuc2lv
bnNUeXBlID0gbnVsbDsKIAogCS8qKgpAQCAtMzA5LDQgKzM0NiwxMiBAQAogCQkJfQogCQl9CisJ
CWlmKHByb3BlcnR5ID09IEVYVFJBX0RJTUVOU0lPTlNfVFlQRV9QUk9QRVJUWSkgeworCQkJaWYg
KGdldCkgeworCQkJCXJldHVybiBnZXRFeHRyYURpbWVuc2lvbnNUeXBlKCk7CisJCQl9IGVsc2Ug
eworCQkJCXNldEV4dHJhRGltZW5zaW9uc1R5cGUoKEFycmF5VHlwZSkgY2hpbGQpOworCQkJCXJl
dHVybiBudWxsOworCQkJfQorCQl9CiAJCS8vIGFsbG93IGRlZmF1bHQgaW1wbGVtZW50YXRpb24g
dG8gZmxhZyB0aGUgZXJyb3IKIAkJcmV0dXJuIHN1cGVyLmludGVybmFsR2V0U2V0Q2hpbGRQcm9w
ZXJ0eShwcm9wZXJ0eSwgZ2V0LCBjaGlsZCk7CkBAIC0zNDUsNCArMzkwLDcgQEAKIAkJcmVzdWx0
LnNldFR5cGUoKFR5cGUpIGdldFR5cGUoKS5jbG9uZSh0YXJnZXQpKTsKIAkJcmVzdWx0LnNldEV4
dHJhRGltZW5zaW9ucyhnZXRFeHRyYURpbWVuc2lvbnMoKSk7CisJCWlmICh0aGlzLmFzdC5hcGlM
ZXZlbCA+PSBBU1QuSkxTOCkgeworCQkJcmVzdWx0LmV4dHJhRGltZW5zaW9uc1R5cGUgPSAoQXJy
YXlUeXBlKSB0aGlzLmV4dHJhRGltZW5zaW9uc1R5cGUuY2xvbmUodGFyZ2V0KTsKKwkJfQogCQly
ZXN1bHQuc2V0TmFtZSgoU2ltcGxlTmFtZSkgZ2V0TmFtZSgpLmNsb25lKHRhcmdldCkpOwogCQly
ZXN1bHQuc2V0SW5pdGlhbGl6ZXIoCkBAIC0zNzEsNCArNDE5LDcgQEAKIAkJCWFjY2VwdENoaWxk
KHZpc2l0b3IsIGdldFR5cGUoKSk7CiAJCQlhY2NlcHRDaGlsZCh2aXNpdG9yLCBnZXROYW1lKCkp
OworCQkJaWYgKHRoaXMuYXN0LmFwaUxldmVsID49IEFTVC5KTFM4KSB7CisJCQkJYWNjZXB0Q2hp
bGQodmlzaXRvciwgdGhpcy5leHRyYURpbWVuc2lvbnNUeXBlKTsKKwkJCX0KIAkJCWFjY2VwdENo
aWxkKHZpc2l0b3IsIGdldEluaXRpYWxpemVyKCkpOwogCQl9CkBAIC01OTYsNCArNjQ3LDIzIEBA
CiAJfQogCisJLyoqCisJICogUmV0dXJucyB0aGUgbGl2ZSBvcmRlcmVkIGxpc3Qgb2YgYW5ub3Rh
dGlvbnMgb24gZXh0cmEgZGltZW5zaW9ucy4KKwkgKiAKKwkgKiBAcmV0dXJuIHRoZSBsaXZlIGxp
c3Qgb2YgYW5ub3RhdGlvbnMgb24gZGltZW5zaW9ucyAoZWxlbWVudCB0eXBlOiB7QGxpbmsgQW5u
b3RhdGlvbn1bXSkKKwkgKiBAc2luY2UgMy45CisJICovCisJcHVibGljIEFycmF5VHlwZSBnZXRF
eHRyYURpbWVuc2lvbnNUeXBlKCkgeworCQl1bnN1cHBvcnRlZEluMl8zXzQoKTsKKwkJcmV0dXJu
IHRoaXMuZXh0cmFEaW1lbnNpb25zVHlwZTsKKwl9CisJCisJLyoqCisJICogQHNpbmNlIDMuOQor
CSAqLworCXB1YmxpYyB2b2lkIHNldEV4dHJhRGltZW5zaW9uc1R5cGUoQXJyYXlUeXBlIHR5cGUp
IHsKKwkJdW5zdXBwb3J0ZWRJbjJfM180KCk7CisJCXRoaXMuZXh0cmFEaW1lbnNpb25zVHlwZSA9
IHR5cGU7CisJfQorCQogCS8qIChvbWl0IGphdmFkb2MgZm9yIHRoaXMgbWV0aG9kKQogCSAqIE1l
dGhvZCBkZWNsYXJlZCBvbiBWYXJpYWJsZURlY2xhcmF0aW9uLgpkaWZmIC0tZ2l0IGEvb3JnLmVj
bGlwc2UuamR0LmNvcmUvZG9tL29yZy9lY2xpcHNlL2pkdC9jb3JlL2RvbS9WYXJpYWJsZURlY2xh
cmF0aW9uRnJhZ21lbnQuamF2YSBiL29yZy5lY2xpcHNlLmpkdC5jb3JlL2RvbS9vcmcvZWNsaXBz
ZS9qZHQvY29yZS9kb20vVmFyaWFibGVEZWNsYXJhdGlvbkZyYWdtZW50LmphdmEKaW5kZXggZTlk
ZTdjOC4uOGE0NjhiNCAxMDA2NDQKLS0tIGEvb3JnLmVjbGlwc2UuamR0LmNvcmUvZG9tL29yZy9l
Y2xpcHNlL2pkdC9jb3JlL2RvbS9WYXJpYWJsZURlY2xhcmF0aW9uRnJhZ21lbnQuamF2YQorKysg
Yi9vcmcuZWNsaXBzZS5qZHQuY29yZS9kb20vb3JnL2VjbGlwc2UvamR0L2NvcmUvZG9tL1Zhcmlh
YmxlRGVjbGFyYXRpb25GcmFnbWVudC5qYXZhCkBAIC00Nyw0ICs0NywxMSBAQAogCiAJLyoqCisJ
ICogVGhlICJleHRyYURpbWVuc2lvbnNUeXBlIiBzdHJ1Y3R1cmFsIHByb3BlcnR5IG9mIHRoaXMg
bm9kZSB0eXBlIChjaGlsZCB0eXBlOiB7QGxpbmsgQXJyYXlUeXBlfSkuCisJICogQHNpbmNlIDMu
OQorCSAqLworCXB1YmxpYyBzdGF0aWMgZmluYWwgQ2hpbGRQcm9wZXJ0eURlc2NyaXB0b3IgRVhU
UkFfRElNRU5TSU9OU19UWVBFX1BST1BFUlRZID0KKwkJCW5ldyBDaGlsZFByb3BlcnR5RGVzY3Jp
cHRvcihWYXJpYWJsZURlY2xhcmF0aW9uRnJhZ21lbnQuY2xhc3MsICJleHRyYURpbWVuc2lvbnNU
eXBlIiwgQXJyYXlUeXBlLmNsYXNzLCBPUFRJT05BTCwgTk9fQ1lDTEVfUklTSyk7IC8vJE5PTi1O
TFMtMSQKKworCS8qKgogCSAqIFRoZSAiaW5pdGlhbGl6ZXIiIHN0cnVjdHVyYWwgcHJvcGVydHkg
b2YgdGhpcyBub2RlIHR5cGUgKGNoaWxkIHR5cGU6IHtAbGluayBFeHByZXNzaW9ufSkuCiAJICog
QHNpbmNlIDMuMApAQCAtNjAsMTIgKzY3LDMwIEBACiAJICovCiAJcHJpdmF0ZSBzdGF0aWMgZmlu
YWwgTGlzdCBQUk9QRVJUWV9ERVNDUklQVE9SUzsKKwkKKwkvKioKKwkgKiBBIGxpc3Qgb2YgcHJv
cGVydHkgZGVzY3JpcHRvcnMgKGVsZW1lbnQgdHlwZToKKwkgKiB7QGxpbmsgU3RydWN0dXJhbFBy
b3BlcnR5RGVzY3JpcHRvcn0pLAorCSAqIG9yIG51bGwgaWYgdW5pbml0aWFsaXplZC4KKwkgKiBA
c2luY2UgMy45CisJICovCisJcHJpdmF0ZSBzdGF0aWMgZmluYWwgTGlzdCBQUk9QRVJUWV9ERVND
UklQVE9SU184XzA7CiAKIAlzdGF0aWMgewogCQlMaXN0IHByb3BlcnR5TGlzdCA9IG5ldyBBcnJh
eUxpc3QoNCk7CiAJCWNyZWF0ZVByb3BlcnR5TGlzdChWYXJpYWJsZURlY2xhcmF0aW9uRnJhZ21l
bnQuY2xhc3MsIHByb3BlcnR5TGlzdCk7CisJCWFkZEpMUzNQcm9wZXJ0aWVzKHByb3BlcnR5TGlz
dCk7CisJCVBST1BFUlRZX0RFU0NSSVBUT1JTID0gcmVhcFByb3BlcnR5TGlzdChwcm9wZXJ0eUxp
c3QpOworCQkKKwkJcHJvcGVydHlMaXN0ID0gbmV3IEFycmF5TGlzdCg1KTsKKwkJY3JlYXRlUHJv
cGVydHlMaXN0KFZhcmlhYmxlRGVjbGFyYXRpb25GcmFnbWVudC5jbGFzcywgcHJvcGVydHlMaXN0
KTsKKwkJYWRkSkxTM1Byb3BlcnRpZXMocHJvcGVydHlMaXN0KTsKKwkJYWRkUHJvcGVydHkoRVhU
UkFfRElNRU5TSU9OU19UWVBFX1BST1BFUlRZLCBwcm9wZXJ0eUxpc3QpOworCQlQUk9QRVJUWV9E
RVNDUklQVE9SU184XzAgPSByZWFwUHJvcGVydHlMaXN0KHByb3BlcnR5TGlzdCk7CisJfQorCisJ
cHJpdmF0ZSBzdGF0aWMgdm9pZCBhZGRKTFMzUHJvcGVydGllcyhMaXN0IHByb3BlcnR5TGlzdCkg
ewogCQlhZGRQcm9wZXJ0eShOQU1FX1BST1BFUlRZLCBwcm9wZXJ0eUxpc3QpOwogCQlhZGRQcm9w
ZXJ0eShFWFRSQV9ESU1FTlNJT05TX1BST1BFUlRZLCBwcm9wZXJ0eUxpc3QpOwogCQlhZGRQcm9w
ZXJ0eShJTklUSUFMSVpFUl9QUk9QRVJUWSwgcHJvcGVydHlMaXN0KTsKLQkJUFJPUEVSVFlfREVT
Q1JJUFRPUlMgPSByZWFwUHJvcGVydHlMaXN0KHByb3BlcnR5TGlzdCk7CiAJfQogCkBAIC04MSw1
ICsxMDYsOSBAQAogCSAqLwogCXB1YmxpYyBzdGF0aWMgTGlzdCBwcm9wZXJ0eURlc2NyaXB0b3Jz
KGludCBhcGlMZXZlbCkgewotCQlyZXR1cm4gUFJPUEVSVFlfREVTQ1JJUFRPUlM7CisJCWlmIChh
cGlMZXZlbCA+PSBBU1QuSkxTOCkgeworCQkJcmV0dXJuIFBST1BFUlRZX0RFU0NSSVBUT1JTXzhf
MDsKKwkJfSBlbHNlIHsKKwkJCXJldHVybiBQUk9QRVJUWV9ERVNDUklQVE9SUzsKKwkJfQogCX0K
IApAQCAtOTUsNCArMTI0LDEyIEBACiAJICovCiAJcHJpdmF0ZSBpbnQgZXh0cmFBcnJheURpbWVu
c2lvbnMgPSAwOworCQorCS8qKgorCSAqIFRoZSBhbm5vdGF0aW9ucyBvbiB0aGUgZXh0cmEgZGlt
ZW5zaW9ucyB0aGF0IHRoaXMgdmFyaWFibGUgaGFzOyAKKwkgKiBkZWZhdWx0IHRvIG51bGwuCisJ
ICogCisJICogQHNpbmNlIDMuOQorCSAqLworCXByb3RlY3RlZCBBcnJheVR5cGUgZXh0cmFEaW1l
bnNpb25zVHlwZSA9IG51bGw7CiAKIAkvKioKQEAgLTE3NCw1ICsyMTEsNSBAQAogCQkJCXJldHVy
biBudWxsOwogCQkJfQotCQl9CisJCX0gCiAJCWlmIChwcm9wZXJ0eSA9PSBJTklUSUFMSVpFUl9Q
Uk9QRVJUWSkgewogCQkJaWYgKGdldCkgewpAQCAtMTgyLDUgKzIxOSwxNCBAQAogCQkJCXJldHVy
biBudWxsOwogCQkJfQorCQl9IAorCQlpZihwcm9wZXJ0eSA9PSBFWFRSQV9ESU1FTlNJT05TX1RZ
UEVfUFJPUEVSVFkpIHsKKwkJCWlmIChnZXQpIHsKKwkJCQlyZXR1cm4gZ2V0RXh0cmFEaW1lbnNp
b25zVHlwZSgpOworCQkJfSBlbHNlIHsKKwkJCQlzZXRFeHRyYURpbWVuc2lvbnNUeXBlKChBcnJh
eVR5cGUpIGNoaWxkKTsKKwkJCQlyZXR1cm4gbnVsbDsKKwkJCX0KIAkJfQorCQkKIAkJLy8gYWxs
b3cgZGVmYXVsdCBpbXBsZW1lbnRhdGlvbiB0byBmbGFnIHRoZSBlcnJvcgogCQlyZXR1cm4gc3Vw
ZXIuaW50ZXJuYWxHZXRTZXRDaGlsZFByb3BlcnR5KHByb3BlcnR5LCBnZXQsIGNoaWxkKTsKQEAg
LTIwMiw0ICsyNDgsNyBAQAogCQlyZXN1bHQuc2V0TmFtZSgoU2ltcGxlTmFtZSkgZ2V0TmFtZSgp
LmNsb25lKHRhcmdldCkpOwogCQlyZXN1bHQuc2V0RXh0cmFEaW1lbnNpb25zKGdldEV4dHJhRGlt
ZW5zaW9ucygpKTsKKwkJaWYgKHRoaXMuYXN0LmFwaUxldmVsID49IEFTVC5KTFM4KSB7CisJCQly
ZXN1bHQuZXh0cmFEaW1lbnNpb25zVHlwZSA9IChBcnJheVR5cGUpIHRoaXMuZXh0cmFEaW1lbnNp
b25zVHlwZS5jbG9uZSh0YXJnZXQpOworCQl9CiAJCXJlc3VsdC5zZXRJbml0aWFsaXplcigKIAkJ
CShFeHByZXNzaW9uKSBBU1ROb2RlLmNvcHlTdWJ0cmVlKHRhcmdldCwgZ2V0SW5pdGlhbGl6ZXIo
KSkpOwpAQCAtMjI0LDQgKzI3Myw4IEBACiAJCQlhY2NlcHRDaGlsZCh2aXNpdG9yLCBnZXROYW1l
KCkpOwogCQkJYWNjZXB0Q2hpbGQodmlzaXRvciwgZ2V0SW5pdGlhbGl6ZXIoKSk7CisJCQkKKwkJ
CWlmICh0aGlzLmFzdC5hcGlMZXZlbCA+PSBBU1QuSkxTOCkgeworCQkJCWFjY2VwdENoaWxkKHZp
c2l0b3IsIHRoaXMuZXh0cmFEaW1lbnNpb25zVHlwZSk7CisJCQl9CiAJCX0KIAkJdmlzaXRvci5l
bmRWaXNpdCh0aGlzKTsKQEAgLTI5NSw2ICszNDgsNDMgQEAKIAkJcHJlVmFsdWVDaGFuZ2UoRVhU
UkFfRElNRU5TSU9OU19QUk9QRVJUWSk7CiAJCXRoaXMuZXh0cmFBcnJheURpbWVuc2lvbnMgPSBk
aW1lbnNpb25zOworCQlpZiAodGhpcy5hc3QuYXBpTGV2ZWwgPj0gQVNULkpMUzgpCisJCQlhZGp1
c3REaW1lbnNpb25zTGlzdFByb3BlcnRpZXMoKTsKIAkJcG9zdFZhbHVlQ2hhbmdlKEVYVFJBX0RJ
TUVOU0lPTlNfUFJPUEVSVFkpOwogCX0KKwkKKwkvKioKKwkgKiBSZXR1cm5zIHRoZSBsaXZlIG9y
ZGVyZWQgbGlzdCBvZiBhbm5vdGF0aW9ucyBvbiBleHRyYSBkaW1lbnNpb25zLgorCSAqIAorCSAq
IEByZXR1cm4gdGhlIGxpdmUgbGlzdCBvZiBhbm5vdGF0aW9ucyBvbiBkaW1lbnNpb25zIChlbGVt
ZW50IHR5cGU6IHtAbGluayBBbm5vdGF0aW9ufVtdKQorCSAqIEBzaW5jZSAzLjkKKwkgKi8KKwlw
dWJsaWMgQXJyYXlUeXBlIGdldEV4dHJhRGltZW5zaW9uc1R5cGUoKSB7CisJCXVuc3VwcG9ydGVk
SW4yXzNfNCgpOworCQlyZXR1cm4gdGhpcy5leHRyYURpbWVuc2lvbnNUeXBlOworCX0KKwkKKwkv
KioKKwkgKiBAc2luY2UgMy45CisJICovCisJcHVibGljIHZvaWQgc2V0RXh0cmFEaW1lbnNpb25z
VHlwZShBcnJheVR5cGUgdHlwZSkgeworCQl1bnN1cHBvcnRlZEluMl8zXzQoKTsKKwkJdGhpcy5l
eHRyYURpbWVuc2lvbnNUeXBlID0gdHlwZTsKKwl9CisKKwlwcml2YXRlIHZvaWQgYWRqdXN0RGlt
ZW5zaW9uc0xpc3RQcm9wZXJ0aWVzKCkgeworLy8JCWludCBsZW5ndGggPSB0aGlzLmV4dHJhRGlt
ZW5zaW9uc1R5cGUuc2l6ZSgpOworLy8JCWludCBhZGRpdGlvbmFsRGltcyA9IHRoaXMuZXh0cmFB
cnJheURpbWVuc2lvbnMgLSBsZW5ndGg7CisvLwkJaWYobGVuZ3RoID09IHRoaXMuZXh0cmFBcnJh
eURpbWVuc2lvbnMpIHJldHVybjsKKy8vCQlpZiAoYWRkaXRpb25hbERpbXMgPiAwKSB7CisvLwkJ
CWZvciAoaW50IGkgPSAwOyBpIDwgYWRkaXRpb25hbERpbXM7IGkrKykgeworLy8JCQkJdGhpcy5l
eHRyYURpbWVuc2lvbnNUeXBlLmFkZCh0aGlzLmFzdC5uZXdEaW1lbnNpb24obnVsbCkpOworLy8J
CQl9CisvLwkJfSBlbHNlIHsKKy8vCQkJYWRkaXRpb25hbERpbXMgKj0gLTE7CisvLwkJCWZvciAo
aW50IGkgPSBhZGRpdGlvbmFsRGltczsgaSA+IDA7IGktLSkgeworLy8JCQkJdGhpcy5leHRyYURp
bWVuc2lvbnNUeXBlLnJlbW92ZShsZW5ndGggLSBpKTsKKy8vCQkJfQorLy8JCX0KKwl9CiAKIAkv
KiAob21pdCBqYXZhZG9jIGZvciB0aGlzIG1ldGhvZCkKZGlmZiAtLWdpdCBhL29yZy5lY2xpcHNl
LmpkdC5jb3JlL2RvbS9vcmcvZWNsaXBzZS9qZHQvaW50ZXJuYWwvY29yZS9kb20vTmFpdmVBU1RG
bGF0dGVuZXIuamF2YSBiL29yZy5lY2xpcHNlLmpkdC5jb3JlL2RvbS9vcmcvZWNsaXBzZS9qZHQv
aW50ZXJuYWwvY29yZS9kb20vTmFpdmVBU1RGbGF0dGVuZXIuamF2YQppbmRleCAzNjAzNGU4Li40
OTg0ZTY1IDEwMDY0NAotLS0gYS9vcmcuZWNsaXBzZS5qZHQuY29yZS9kb20vb3JnL2VjbGlwc2Uv
amR0L2ludGVybmFsL2NvcmUvZG9tL05haXZlQVNURmxhdHRlbmVyLmphdmEKKysrIGIvb3JnLmVj
bGlwc2UuamR0LmNvcmUvZG9tL29yZy9lY2xpcHNlL2pkdC9pbnRlcm5hbC9jb3JlL2RvbS9OYWl2
ZUFTVEZsYXR0ZW5lci5qYXZhCkBAIC0xMDMwLDYgKzEwMzAsOCBAQAogCQl9CiAJCXRoaXMuYnVm
ZmVyLmFwcGVuZCgiKSIpOy8vJE5PTi1OTFMtMSQKLQkJZm9yIChpbnQgaSA9IDA7IGkgPCBub2Rl
LmdldEV4dHJhRGltZW5zaW9ucygpOyBpKyspIHsKLQkJCXRoaXMuYnVmZmVyLmFwcGVuZCgiW10i
KTsgLy8kTk9OLU5MUy0xJAorCQlpbnQgZXh0cmFEaW1lbnNpb25zID0gbm9kZS5nZXRFeHRyYURp
bWVuc2lvbnMoKTsKKwkJaWYgKGV4dHJhRGltZW5zaW9ucyA+IDApIHsKKwkJCUFycmF5VHlwZSBz
dWJhcnJheVR5cGUgPSBub2RlLmdldEV4dHJhRGltZW5zaW9uc1R5cGUoKTsKKwkJCXZpc2l0RXh0
cmFEaW1lbnNpb25zVHlwZShzdWJhcnJheVR5cGUsIGV4dHJhRGltZW5zaW9ucyk7CiAJCX0KIAkJ
aWYgKCFub2RlLnRocm93bkV4Y2VwdGlvbnMoKS5pc0VtcHR5KCkpIHsKQEAgLTEzMzMsNiArMTMz
NSw4IEBACiAJCXRoaXMuYnVmZmVyLmFwcGVuZCgiICIpOy8vJE5PTi1OTFMtMSQKIAkJbm9kZS5n
ZXROYW1lKCkuYWNjZXB0KHRoaXMpOwotCQlmb3IgKGludCBpID0gMDsgaSA8IG5vZGUuZ2V0RXh0
cmFEaW1lbnNpb25zKCk7IGkrKykgewotCQkJdGhpcy5idWZmZXIuYXBwZW5kKCJbXSIpOyAvLyRO
T04tTkxTLTEkCisJCWludCBleHRyYURpbWVuc2lvbnMgPSBub2RlLmdldEV4dHJhRGltZW5zaW9u
cygpOworCQlpZiAoZXh0cmFEaW1lbnNpb25zID4gMCkgeworCQkJQXJyYXlUeXBlIHN1YmFycmF5
VHlwZSA9IG5vZGUuZ2V0RXh0cmFEaW1lbnNpb25zVHlwZSgpOworCQkJdmlzaXRFeHRyYURpbWVu
c2lvbnNUeXBlKHN1YmFycmF5VHlwZSwgZXh0cmFEaW1lbnNpb25zKTsKIAkJfQogCQlpZiAobm9k
ZS5nZXRJbml0aWFsaXplcigpICE9IG51bGwpIHsKQEAgLTE3NTQsNiArMTc1OCw4IEBACiAJcHVi
bGljIGJvb2xlYW4gdmlzaXQoVmFyaWFibGVEZWNsYXJhdGlvbkZyYWdtZW50IG5vZGUpIHsKIAkJ
bm9kZS5nZXROYW1lKCkuYWNjZXB0KHRoaXMpOwotCQlmb3IgKGludCBpID0gMDsgaSA8IG5vZGUu
Z2V0RXh0cmFEaW1lbnNpb25zKCk7IGkrKykgewotCQkJdGhpcy5idWZmZXIuYXBwZW5kKCJbXSIp
Oy8vJE5PTi1OTFMtMSQKKwkJaW50IGV4dHJhRGltZW5zaW9ucyA9IG5vZGUuZ2V0RXh0cmFEaW1l
bnNpb25zKCk7CisJCWlmIChleHRyYURpbWVuc2lvbnMgPiAwKSB7CisJCQlBcnJheVR5cGUgc3Vi
YXJyYXlUeXBlID0gbm9kZS5nZXRFeHRyYURpbWVuc2lvbnNUeXBlKCk7CisJCQl2aXNpdEV4dHJh
RGltZW5zaW9uc1R5cGUoc3ViYXJyYXlUeXBlLCBleHRyYURpbWVuc2lvbnMpOwogCQl9CiAJCWlm
IChub2RlLmdldEluaXRpYWxpemVyKCkgIT0gbnVsbCkgewpAQCAtMTc2Miw0ICsxNzY4LDE0IEBA
CiAJCX0KIAkJcmV0dXJuIGZhbHNlOworCX0KKworCXByaXZhdGUgdm9pZCB2aXNpdEV4dHJhRGlt
ZW5zaW9uc1R5cGUoQXJyYXlUeXBlIHR5cGUsIGludCBkaW1lbnNpb25zTGVmdCkgeworCQlpZiAo
ZGltZW5zaW9uc0xlZnQgPT0gMCkgcmV0dXJuOworCQlBcnJheVR5cGUgc3ViYXJyYXlUeXBlID0g
KEFycmF5VHlwZSkgdHlwZS5nZXRDb21wb25lbnRUeXBlKCk7CisJCXZpc2l0RXh0cmFEaW1lbnNp
b25zVHlwZShzdWJhcnJheVR5cGUsIC0tZGltZW5zaW9uc0xlZnQpOworCQlpZiAodHlwZS5nZXRB
U1QoKS5hcGlMZXZlbCgpID49IEFTVC5KTFM4KSB7CisJCQl2aXNpdFR5cGVBbm5vdGF0aW9ucyh0
eXBlKTsKKwkJfQorCQl0aGlzLmJ1ZmZlci5hcHBlbmQoIltdIik7Ly8kTk9OLU5MUy0xJAogCX0K
IApAQCAtMTgyMiw0ICsxODM4LDcgQEAKIAkJCUxpc3QgYW5ub3RhdGlvbnMgPSBub2RlLmFubm90
YXRpb25zKCk7CiAJCQlpZiAoYW5ub3RhdGlvbnMgIT0gbnVsbCkgeworCQkJCWlmIChhbm5vdGF0
aW9ucy5zaXplKCkgPiAwKSB7CisJCQkJCXRoaXMuYnVmZmVyLmFwcGVuZCgnICcpOworCQkJCX0K
IAkJCQlmb3IgKEl0ZXJhdG9yIGl0ID0gYW5ub3RhdGlvbnMuaXRlcmF0b3IoKTsgaXQuaGFzTmV4
dCgpOyApIHsKIAkJCQkJQW5ub3RhdGlvbiBhbm5vdGF0aW9uID0gKEFubm90YXRpb24pIGl0Lm5l
eHQoKTsKQEAgLTE4MzQsNCArMTg1Myw3IEBACiAJCQlMaXN0IGFubm90YXRpb25zID0gbm9kZS5h
bm5vdGF0aW9ucygpOwogCQkJaWYgKGFubm90YXRpb25zICE9IG51bGwpIHsKKwkJCQlpZiAoYW5u
b3RhdGlvbnMuc2l6ZSgpID4gMCkgeworCQkJCQl0aGlzLmJ1ZmZlci5hcHBlbmQoJyAnKTsKKwkJ
CQl9CiAJCQkJZm9yIChJdGVyYXRvciBpdCA9IGFubm90YXRpb25zLml0ZXJhdG9yKCk7IGl0Lmhh
c05leHQoKTsgKSB7CiAJCQkJCUFubm90YXRpb24gYW5ub3RhdGlvbiA9IChBbm5vdGF0aW9uKSBp
dC5uZXh0KCk7CmRpZmYgLS1naXQgYS9vcmcuZWNsaXBzZS5qZHQuY29yZS9kb20vb3JnL2VjbGlw
c2UvamR0L2ludGVybmFsL2NvcmUvZG9tL3Jld3JpdGUvQVNUUmV3cml0ZUZsYXR0ZW5lci5qYXZh
IGIvb3JnLmVjbGlwc2UuamR0LmNvcmUvZG9tL29yZy9lY2xpcHNlL2pkdC9pbnRlcm5hbC9jb3Jl
L2RvbS9yZXdyaXRlL0FTVFJld3JpdGVGbGF0dGVuZXIuamF2YQppbmRleCBjYjI5ZDUwLi42NTA4
MmE0IDEwMDY0NAotLS0gYS9vcmcuZWNsaXBzZS5qZHQuY29yZS9kb20vb3JnL2VjbGlwc2UvamR0
L2ludGVybmFsL2NvcmUvZG9tL3Jld3JpdGUvQVNUUmV3cml0ZUZsYXR0ZW5lci5qYXZhCisrKyBi
L29yZy5lY2xpcHNlLmpkdC5jb3JlL2RvbS9vcmcvZWNsaXBzZS9qZHQvaW50ZXJuYWwvY29yZS9k
b20vcmV3cml0ZS9BU1RSZXdyaXRlRmxhdHRlbmVyLmphdmEKQEAgLTYzMyw2ICs2MzMsNyBAQAog
CQl0aGlzLnJlc3VsdC5hcHBlbmQoJyknKTsKIAkJaW50IGV4dHJhRGltcz0gZ2V0SW50QXR0cmli
dXRlKG5vZGUsIE1ldGhvZERlY2xhcmF0aW9uLkVYVFJBX0RJTUVOU0lPTlNfUFJPUEVSVFkpOwot
CQlmb3IgKGludCBpID0gMDsgaSA8IGV4dHJhRGltczsgaSsrKSB7Ci0JCQl0aGlzLnJlc3VsdC5h
cHBlbmQoIltdIik7IC8vJE5PTi1OTFMtMSQKKwkJaWYgKGV4dHJhRGltcyA+IDApIHsKKwkJCUFy
cmF5VHlwZSBleHRyYURpbXNUeXBlID0gKEFycmF5VHlwZSkgZ2V0Q2hpbGROb2RlKG5vZGUsIFZh
cmlhYmxlRGVjbGFyYXRpb25GcmFnbWVudC5FWFRSQV9ESU1FTlNJT05TX1RZUEVfUFJPUEVSVFkp
OworCQkJdmlzaXRFeHRyYURpbWVuc2lvbnNUeXBlKGV4dHJhRGltc1R5cGUsIGV4dHJhRGltcyk7
CiAJCX0KIAkJdmlzaXRMaXN0KG5vZGUsIE1ldGhvZERlY2xhcmF0aW9uLlRIUk9XTl9FWENFUFRJ
T05TX1BST1BFUlRZLCBTdHJpbmcudmFsdWVPZignLCcpLCAiIHRocm93cyAiLCBVdGlsLkVNUFRZ
X1NUUklORyk7IC8vJE5PTi1OTFMtMSQKQEAgLTgwNSw2ICs4MDYsNyBAQAogCQlnZXRDaGlsZE5v
ZGUobm9kZSwgU2luZ2xlVmFyaWFibGVEZWNsYXJhdGlvbi5OQU1FX1BST1BFUlRZKS5hY2NlcHQo
dGhpcyk7CiAJCWludCBleHRyYURpbWVuc2lvbnM9IGdldEludEF0dHJpYnV0ZShub2RlLCBTaW5n
bGVWYXJpYWJsZURlY2xhcmF0aW9uLkVYVFJBX0RJTUVOU0lPTlNfUFJPUEVSVFkpOwotCQlmb3Ig
KGludCBpID0gMDsgaSA8IGV4dHJhRGltZW5zaW9uczsgaSsrKSB7Ci0JCQl0aGlzLnJlc3VsdC5h
cHBlbmQoIltdIik7IC8vJE5PTi1OTFMtMSQKKwkJaWYgKGV4dHJhRGltZW5zaW9ucyA+IDApIHsK
KwkJCUFycmF5VHlwZSBleHRyYURpbXNUeXBlID0gKEFycmF5VHlwZSkgZ2V0Q2hpbGROb2RlKG5v
ZGUsIFZhcmlhYmxlRGVjbGFyYXRpb25GcmFnbWVudC5FWFRSQV9ESU1FTlNJT05TX1RZUEVfUFJP
UEVSVFkpOworCQkJdmlzaXRFeHRyYURpbWVuc2lvbnNUeXBlKGV4dHJhRGltc1R5cGUsIGV4dHJh
RGltZW5zaW9ucyk7CiAJCX0KIAkJQVNUTm9kZSBpbml0aWFsaXplcj0gZ2V0Q2hpbGROb2RlKG5v
ZGUsIFNpbmdsZVZhcmlhYmxlRGVjbGFyYXRpb24uSU5JVElBTElaRVJfUFJPUEVSVFkpOwpAQCAt
MTA1MCw2ICsxMDUyLDcgQEAKIAkJZ2V0Q2hpbGROb2RlKG5vZGUsIFZhcmlhYmxlRGVjbGFyYXRp
b25GcmFnbWVudC5OQU1FX1BST1BFUlRZKS5hY2NlcHQodGhpcyk7CiAJCWludCBleHRyYURpbWVu
c2lvbnM9IGdldEludEF0dHJpYnV0ZShub2RlLCBWYXJpYWJsZURlY2xhcmF0aW9uRnJhZ21lbnQu
RVhUUkFfRElNRU5TSU9OU19QUk9QRVJUWSk7Ci0JCWZvciAoaW50IGkgPSAwOyBpIDwgZXh0cmFE
aW1lbnNpb25zOyBpKyspIHsKLQkJCXRoaXMucmVzdWx0LmFwcGVuZCgiW10iKTsgLy8kTk9OLU5M
Uy0xJAorCQlpZiAoZXh0cmFEaW1lbnNpb25zID4gMCkgeworCQkJQXJyYXlUeXBlIGV4dHJhRGlt
c1R5cGUgPSAoQXJyYXlUeXBlKSBnZXRDaGlsZE5vZGUobm9kZSwgVmFyaWFibGVEZWNsYXJhdGlv
bkZyYWdtZW50LkVYVFJBX0RJTUVOU0lPTlNfVFlQRV9QUk9QRVJUWSk7CisJCQl2aXNpdEV4dHJh
RGltZW5zaW9uc1R5cGUoZXh0cmFEaW1zVHlwZSwgZXh0cmFEaW1lbnNpb25zKTsKIAkJfQogCQlB
U1ROb2RlIGluaXRpYWxpemVyPSBnZXRDaGlsZE5vZGUobm9kZSwgVmFyaWFibGVEZWNsYXJhdGlv
bkZyYWdtZW50LklOSVRJQUxJWkVSX1BST1BFUlRZKTsKQEAgLTEwNjAsNCArMTA2MywxMiBAQAog
CQlyZXR1cm4gZmFsc2U7CiAJfQorCQorCXByaXZhdGUgdm9pZCB2aXNpdEV4dHJhRGltZW5zaW9u
c1R5cGUoQXJyYXlUeXBlIHR5cGUsIGludCBkaW1lbnNpb25zTGVmdCkgeworCQlpZiAoZGltZW5z
aW9uc0xlZnQgPT0gMCkgcmV0dXJuOworCQlBcnJheVR5cGUgc3ViYXJyYXlUeXBlID0gKEFycmF5
VHlwZSkgdHlwZS5nZXRDb21wb25lbnRUeXBlKCk7CisJCXZpc2l0RXh0cmFEaW1lbnNpb25zVHlw
ZShzdWJhcnJheVR5cGUsIC0tZGltZW5zaW9uc0xlZnQpOworCQl2aXNpdExpc3QodHlwZSwgV2ls
ZGNhcmRUeXBlLkFOTk9UQVRJT05TX1BST1BFUlRZLCBTdHJpbmcudmFsdWVPZignICcpLCBVdGls
LkVNUFRZX1NUUklORywgU3RyaW5nLnZhbHVlT2YoJyAnKSk7CisJCXRoaXMucmVzdWx0LmFwcGVu
ZCgiW10iKTsvLyROT04tTkxTLTEkCisJfQogCiAJLyo=
</data>

          </attachment>
          <attachment
              isobsolete="1"
              ispatch="1"
              isprivate="0"
          >
            <attachid>223996</attachid>
            <date>2012-11-27 00:57:00 -0500</date>
            <delta_ts>2012-12-14 01:11:56 -0500</delta_ts>
            <desc>Updated patch</desc>
            <filename>Fix-for-bug-391895-approach2.patch</filename>
            <type>text/plain</type>
            <size>52548</size>
            <attacher name="Jay Arthanareeswaran">jarthana</attacher>
            
              <data encoding="base64">ZGlmZiAtLWdpdCBhL29yZy5lY2xpcHNlLmpkdC5jb3JlLnRlc3RzLm1vZGVsL3NyYy9vcmcvZWNs
aXBzZS9qZHQvY29yZS90ZXN0cy9kb20vQVNUQ29udmVydGVyMThUZXN0LmphdmEgYi9vcmcuZWNs
aXBzZS5qZHQuY29yZS50ZXN0cy5tb2RlbC9zcmMvb3JnL2VjbGlwc2UvamR0L2NvcmUvdGVzdHMv
ZG9tL0FTVENvbnZlcnRlcjE4VGVzdC5qYXZhCmluZGV4IDk1ZmUxOTcuLjk3YjUzZmMgMTAwNjQ0
Ci0tLSBhL29yZy5lY2xpcHNlLmpkdC5jb3JlLnRlc3RzLm1vZGVsL3NyYy9vcmcvZWNsaXBzZS9q
ZHQvY29yZS90ZXN0cy9kb20vQVNUQ29udmVydGVyMThUZXN0LmphdmEKKysrIGIvb3JnLmVjbGlw
c2UuamR0LmNvcmUudGVzdHMubW9kZWwvc3JjL29yZy9lY2xpcHNlL2pkdC9jb3JlL3Rlc3RzL2Rv
bS9BU1RDb252ZXJ0ZXIxOFRlc3QuamF2YQpAQCAtMTUsNCArMTUsNiBAQAogcGFja2FnZSBvcmcu
ZWNsaXBzZS5qZHQuY29yZS50ZXN0cy5kb207CiAKK2ltcG9ydCBqYXZhLnV0aWwuTGlzdDsKKwog
aW1wb3J0IGp1bml0LmZyYW1ld29yay5UZXN0OwogCkBAIC0yMiw3ICsyNCw5IEBACiBpbXBvcnQg
b3JnLmVjbGlwc2UuamR0LmNvcmUuZG9tLkFTVE5vZGU7CiBpbXBvcnQgb3JnLmVjbGlwc2UuamR0
LmNvcmUuZG9tLkNvbXBpbGF0aW9uVW5pdDsKK2ltcG9ydCBvcmcuZWNsaXBzZS5qZHQuY29yZS5k
b20uRmllbGREZWNsYXJhdGlvbjsKIGltcG9ydCBvcmcuZWNsaXBzZS5qZHQuY29yZS5kb20uTWV0
aG9kRGVjbGFyYXRpb247CiBpbXBvcnQgb3JnLmVjbGlwc2UuamR0LmNvcmUuZG9tLlNpbXBsZVR5
cGU7CiBpbXBvcnQgb3JnLmVjbGlwc2UuamR0LmNvcmUuZG9tLlNpbmdsZVZhcmlhYmxlRGVjbGFy
YXRpb247CitpbXBvcnQgb3JnLmVjbGlwc2UuamR0LmNvcmUuZG9tLlZhcmlhYmxlRGVjbGFyYXRp
b25GcmFnbWVudDsKIAogcHVibGljIGNsYXNzIEFTVENvbnZlcnRlcjE4VGVzdCBleHRlbmRzIENv
bnZlcnRlclRlc3RTZXR1cCB7CkBAIC01MSw0ICs1NSw1IEBACiAJfQogCisJCiAJcHVibGljIHZv
aWQgdGVzdDAwMDEoKSB0aHJvd3MgSmF2YU1vZGVsRXhjZXB0aW9uIHsKIAkJU3RyaW5nIGNvbnRl
bnRzID0KQEAgLTY4LDMgKzczLDg5IEBACiAJCWFzc2VydEVxdWFscygiSW5jb3JyZWN0IHJlY2Vp
dmVyIGlkZW50aWZpZXIiLCAidGhpcyIsIHJlY2VpdmVyLmdldE5hbWUoKS50b1N0cmluZygpKTsK
IAl9CisKKwlwdWJsaWMgdm9pZCB0ZXN0MDAwMigpIHRocm93cyBKYXZhTW9kZWxFeGNlcHRpb24g
eworCQlTdHJpbmcgY29udGVudHMgPQorCQkJCSJpbXBvcnQgamF2YS5sYW5nLmFubm90YXRpb24u
RWxlbWVudFR5cGU7XG4iICsKKwkJCQkiaW1wb3J0IGphdmEubGFuZy5hbm5vdGF0aW9uLlRhcmdl
dDtcbiIgKworCQkJCSJwdWJsaWMgY2xhc3MgWCB7XG4iICsKKwkJCQkiCXB1YmxpYyBATWFya2Vy
IGludCBATWFya2VyMSBbXSBmb28oKSBATWFya2VyMiBbXXsgcmV0dXJuIG51bGw7IH1cbiIgKwor
CQkJCSJ9XG4iICsKKwkJCQkiQFRhcmdldCh2YWx1ZSA9IHsgRWxlbWVudFR5cGUuVFlQRV9VU0V9
KVxuIiArCisJCQkJIkBpbnRlcmZhY2UgTWFya2VyIHt9XG4iICsKKwkJCQkiQFRhcmdldCh2YWx1
ZSA9IHsgRWxlbWVudFR5cGUuVFlQRV9VU0V9KVxuIiArCisJCQkJIkBpbnRlcmZhY2UgTWFya2Vy
MSB7fVxuIiArCisJCQkJIkBUYXJnZXQodmFsdWUgPSB7IEVsZW1lbnRUeXBlLlRZUEVfVVNFfSlc
biIgKworCQkJCSJAaW50ZXJmYWNlIE1hcmtlcjIge30iOworCQl0aGlzLndvcmtpbmdDb3B5ID0g
Z2V0V29ya2luZ0NvcHkoIi9Db252ZXJ0ZXIxOC9zcmMvWC5qYXZhIiwgdHJ1ZSk7CisJCUFTVE5v
ZGUgbm9kZSA9IGJ1aWxkQVNUKGNvbnRlbnRzLCB0aGlzLndvcmtpbmdDb3B5KTsKKwkJYXNzZXJ0
RXF1YWxzKCJOb3QgYSBjb21waWxhdGlvbiB1bml0IiwgQVNUTm9kZS5DT01QSUxBVElPTl9VTklU
LCBub2RlLmdldE5vZGVUeXBlKCkpOworCQlDb21waWxhdGlvblVuaXQgdW5pdCA9IChDb21waWxh
dGlvblVuaXQpIG5vZGU7CisJCW5vZGUgPSBnZXRBU1ROb2RlKHVuaXQsIDAsIDApOworCQlhc3Nl
cnRFcXVhbHMoIk5vdCBhIG1ldGhvZCBEZWNsYXJhdGlvbiIsIEFTVE5vZGUuTUVUSE9EX0RFQ0xB
UkFUSU9OLCBub2RlLmdldE5vZGVUeXBlKCkpOworCQlNZXRob2REZWNsYXJhdGlvbiBtZXRob2Qg
PSAoTWV0aG9kRGVjbGFyYXRpb24pIG5vZGU7CisJCUxpc3QgZXh0cmFEaW1lbnNpb25zID0gbWV0
aG9kLmdldEV4dHJhQW5ub3RhdGVkRGltZW5zaW9ucygpOworCQlhc3NlcnRFeHRyYURpbWVuc2lv
bnNFcXVhbCgiV3JvbmcgZXh0cmEgZGltZW5zaW9uIGluZm8iLCBleHRyYURpbWVuc2lvbnMsICJA
TWFya2VyMiBbXSAiKTsKKwl9CisJCisJcHVibGljIHZvaWQgdGVzdDAwMDMoKSB0aHJvd3MgSmF2
YU1vZGVsRXhjZXB0aW9uIHsKKwkJU3RyaW5nIGNvbnRlbnRzID0KKwkJCQkiaW1wb3J0IGphdmEu
bGFuZy5hbm5vdGF0aW9uLkVsZW1lbnRUeXBlO1xuIiArCisJCQkJImltcG9ydCBqYXZhLmxhbmcu
YW5ub3RhdGlvbi5UYXJnZXQ7XG4iICsKKwkJCQkicHVibGljIGNsYXNzIFgge1xuIiArCisJCQkJ
IglwdWJsaWMgdm9pZCBmb28oQE1hcmtlciBpbnQgQE1hcmtlcjEgW10gaSBATWFya2VyMiBbXSkg
e31cbiIgKworCQkJCSJ9XG4iICsKKwkJCQkiQFRhcmdldCh2YWx1ZSA9IHsgRWxlbWVudFR5cGUu
VFlQRV9VU0V9KVxuIiArCisJCQkJIkBpbnRlcmZhY2UgTWFya2VyIHt9XG4iICsKKwkJCQkiQFRh
cmdldCh2YWx1ZSA9IHsgRWxlbWVudFR5cGUuVFlQRV9VU0V9KVxuIiArCisJCQkJIkBpbnRlcmZh
Y2UgTWFya2VyMSB7fVxuIiArCisJCQkJIkBUYXJnZXQodmFsdWUgPSB7IEVsZW1lbnRUeXBlLlRZ
UEVfVVNFfSlcbiIgKworCQkJCSJAaW50ZXJmYWNlIE1hcmtlcjIge30iOworCQl0aGlzLndvcmtp
bmdDb3B5ID0gZ2V0V29ya2luZ0NvcHkoIi9Db252ZXJ0ZXIxOC9zcmMvWC5qYXZhIiwgdHJ1ZSk7
CisJCUFTVE5vZGUgbm9kZSA9IGJ1aWxkQVNUKGNvbnRlbnRzLCB0aGlzLndvcmtpbmdDb3B5KTsK
KwkJYXNzZXJ0RXF1YWxzKCJOb3QgYSBjb21waWxhdGlvbiB1bml0IiwgQVNUTm9kZS5DT01QSUxB
VElPTl9VTklULCBub2RlLmdldE5vZGVUeXBlKCkpOworCQlDb21waWxhdGlvblVuaXQgdW5pdCA9
IChDb21waWxhdGlvblVuaXQpIG5vZGU7CisJCW5vZGUgPSBnZXRBU1ROb2RlKHVuaXQsIDAsIDAp
OworCQlhc3NlcnRFcXVhbHMoIk5vdCBhIG1ldGhvZCBEZWNsYXJhdGlvbiIsIEFTVE5vZGUuTUVU
SE9EX0RFQ0xBUkFUSU9OLCBub2RlLmdldE5vZGVUeXBlKCkpOworCQlTaW5nbGVWYXJpYWJsZURl
Y2xhcmF0aW9uIHNpbmdsZVZhcmlhYmxlID0gKFNpbmdsZVZhcmlhYmxlRGVjbGFyYXRpb24pICgo
TWV0aG9kRGVjbGFyYXRpb24pIG5vZGUpLnBhcmFtZXRlcnMoKS5nZXQoMCk7CisJCWFzc2VydE5v
dE51bGwoIldyb25nIHBhcmFtZXRlciIsIHNpbmdsZVZhcmlhYmxlKTsKKwkJTGlzdCBleHRyYURp
bWVuc2lvbnMgPSBzaW5nbGVWYXJpYWJsZS5nZXRFeHRyYUFubm90YXRlZERpbWVuc2lvbnMoKTsK
KwkJYXNzZXJ0RXh0cmFEaW1lbnNpb25zRXF1YWwoIldyb25nIGV4dHJhIGRpbWVuc2lvbiBpbmZv
IiwgZXh0cmFEaW1lbnNpb25zLCAiQE1hcmtlcjIgW10gIik7CisJfQorCQorCXB1YmxpYyB2b2lk
IHRlc3QwMDA0KCkgdGhyb3dzIEphdmFNb2RlbEV4Y2VwdGlvbiB7CisJCVN0cmluZyBjb250ZW50
cyA9CisJCQkJImltcG9ydCBqYXZhLmxhbmcuYW5ub3RhdGlvbi5FbGVtZW50VHlwZTtcbiIgKwor
CQkJCSJpbXBvcnQgamF2YS5sYW5nLmFubm90YXRpb24uVGFyZ2V0O1xuIiArCisJCQkJInB1Ymxp
YyBjbGFzcyBYIHtcbiIgKworCQkJCSIJQE1hcmtlciBpbnQgQE1hcmtlcjEgW10gYSBATWFya2Vy
MiBbXSBATWFya2VyMyBbXSBATWFya2VyNCBbXSwgYiBATWFya2VyMiBATWFya2VyMyBbXSBATWFy
a2VyNCBbXSwgYyBbXVtdW107XG4iICsKKwkJCQkifVxuIiArCisJCQkJIkBUYXJnZXQodmFsdWUg
PSB7IEVsZW1lbnRUeXBlLlRZUEVfVVNFfSlcbiIgKworCQkJCSJAaW50ZXJmYWNlIE1hcmtlciB7
fVxuIiArCisJCQkJIkBUYXJnZXQodmFsdWUgPSB7IEVsZW1lbnRUeXBlLlRZUEVfVVNFfSlcbiIg
KworCQkJCSJAaW50ZXJmYWNlIE1hcmtlcjEge31cbiIgKworCQkJCSJAVGFyZ2V0KHZhbHVlID0g
eyBFbGVtZW50VHlwZS5UWVBFX1VTRX0pXG4iICsKKwkJCQkiQGludGVyZmFjZSBNYXJrZXIyIHt9
XG4iICsKKwkJCQkiQFRhcmdldCh2YWx1ZSA9IHsgRWxlbWVudFR5cGUuVFlQRV9VU0V9KVxuIiAr
CisJCQkJIkBpbnRlcmZhY2UgTWFya2VyMyB7fVxuIiArCisJCQkJIkBUYXJnZXQodmFsdWUgPSB7
IEVsZW1lbnRUeXBlLlRZUEVfVVNFfSlcbiIgKworCQkJCSJAaW50ZXJmYWNlIE1hcmtlcjQge30i
OworCQlTeXN0ZW0ub3V0LnByaW50bG4oY29udGVudHMpOworCQl0aGlzLndvcmtpbmdDb3B5ID0g
Z2V0V29ya2luZ0NvcHkoIi9Db252ZXJ0ZXIxOC9zcmMvWC5qYXZhIiwgdHJ1ZSk7CisJCUFTVE5v
ZGUgbm9kZSA9IGJ1aWxkQVNUKGNvbnRlbnRzLCB0aGlzLndvcmtpbmdDb3B5KTsKKwkJYXNzZXJ0
RXF1YWxzKCJOb3QgYSBjb21waWxhdGlvbiB1bml0IiwgQVNUTm9kZS5DT01QSUxBVElPTl9VTklU
LCBub2RlLmdldE5vZGVUeXBlKCkpOworCQlDb21waWxhdGlvblVuaXQgdW5pdCA9IChDb21waWxh
dGlvblVuaXQpIG5vZGU7CisJCW5vZGUgPSBnZXRBU1ROb2RlKHVuaXQsIDAsIDApOworCQlhc3Nl
cnRFcXVhbHMoIk5vdCBhIG1ldGhvZCBEZWNsYXJhdGlvbiIsIEFTVE5vZGUuRklFTERfREVDTEFS
QVRJT04sIG5vZGUuZ2V0Tm9kZVR5cGUoKSk7CisJCUZpZWxkRGVjbGFyYXRpb24gZmllbGQgPSAo
RmllbGREZWNsYXJhdGlvbikgbm9kZTsKKwkJYXNzZXJ0RXF1YWxzKCJ3cm9uZyBubyBvZiB2YXJp
YWJsZSBmcmFnbWVudHMiLCAzLCBmaWVsZC5mcmFnbWVudHMoKS5zaXplKCkpOworCQlWYXJpYWJs
ZURlY2xhcmF0aW9uRnJhZ21lbnQgZnJhZ21lbnQgPSAoVmFyaWFibGVEZWNsYXJhdGlvbkZyYWdt
ZW50KSBmaWVsZC5mcmFnbWVudHMoKS5nZXQoMCk7CisJCUxpc3QgZXh0cmFEaW1lbnNpb25zID0g
ZnJhZ21lbnQuZ2V0RXh0cmFBbm5vdGF0ZWREaW1lbnNpb25zKCk7CisJCWFzc2VydEV4dHJhRGlt
ZW5zaW9uc0VxdWFsKCJXcm9uZyBleHRyYSBkaW1lbnNpb24gaW5mbyIsIGV4dHJhRGltZW5zaW9u
cywgIkBNYXJrZXIyIFtdIEBNYXJrZXIzIFtdIEBNYXJrZXI0IFtdICIpOworCQlmcmFnbWVudCA9
IChWYXJpYWJsZURlY2xhcmF0aW9uRnJhZ21lbnQpIGZpZWxkLmZyYWdtZW50cygpLmdldCgxKTsK
KwkJZXh0cmFEaW1lbnNpb25zID0gZnJhZ21lbnQuZ2V0RXh0cmFBbm5vdGF0ZWREaW1lbnNpb25z
KCk7CisJCWFzc2VydEV4dHJhRGltZW5zaW9uc0VxdWFsKCJXcm9uZyBleHRyYSBkaW1lbnNpb24g
aW5mbyIsIGV4dHJhRGltZW5zaW9ucywgIkBNYXJrZXIyIEBNYXJrZXIzIFtdIEBNYXJrZXI0IFtd
ICIpOworCQlmcmFnbWVudCA9IChWYXJpYWJsZURlY2xhcmF0aW9uRnJhZ21lbnQpIGZpZWxkLmZy
YWdtZW50cygpLmdldCgyKTsKKwkJZXh0cmFEaW1lbnNpb25zID0gZnJhZ21lbnQuZ2V0RXh0cmFB
bm5vdGF0ZWREaW1lbnNpb25zKCk7CisJCWFzc2VydEV4dHJhRGltZW5zaW9uc0VxdWFsKCJXcm9u
ZyBleHRyYSBkaW1lbnNpb24gaW5mbyIsIGV4dHJhRGltZW5zaW9ucywgIltdIFtdIFtdICIpOwor
CX0KIH0KZGlmZiAtLWdpdCBhL29yZy5lY2xpcHNlLmpkdC5jb3JlLnRlc3RzLm1vZGVsL3NyYy9v
cmcvZWNsaXBzZS9qZHQvY29yZS90ZXN0cy9kb20vQVNUQ29udmVydGVyQVNUOFRlc3QuamF2YSBi
L29yZy5lY2xpcHNlLmpkdC5jb3JlLnRlc3RzLm1vZGVsL3NyYy9vcmcvZWNsaXBzZS9qZHQvY29y
ZS90ZXN0cy9kb20vQVNUQ29udmVydGVyQVNUOFRlc3QuamF2YQppbmRleCBhNzIxNDBjLi5iMTRl
NjFhIDEwMDY0NAotLS0gYS9vcmcuZWNsaXBzZS5qZHQuY29yZS50ZXN0cy5tb2RlbC9zcmMvb3Jn
L2VjbGlwc2UvamR0L2NvcmUvdGVzdHMvZG9tL0FTVENvbnZlcnRlckFTVDhUZXN0LmphdmEKKysr
IGIvb3JnLmVjbGlwc2UuamR0LmNvcmUudGVzdHMubW9kZWwvc3JjL29yZy9lY2xpcHNlL2pkdC9j
b3JlL3Rlc3RzL2RvbS9BU1RDb252ZXJ0ZXJBU1Q4VGVzdC5qYXZhCkBAIC0zOCw0ICszOCw1IEBA
CiAJc3RhdGljIHsKIC8vCQlURVNUU19OVU1CRVJTID0gbmV3IGludFtdIHsgMzU2IH07CisvLwkJ
VEVTVFNfTkFNRVMgPSBuZXcgU3RyaW5nW117ICJ0ZXN0MDM5MyIgfTsKIAl9CiAJcHVibGljIHN0
YXRpYyBUZXN0IHN1aXRlKCkgewpAQCAtMjcxOSwxOCArMjcyMCwyMSBAQAogCQlsaXRlcmFsLnNl
dFRva2VuKCIxMCIpOy8vJE5PTi1OTFMtMSQKIAkJZnJhZ21lbnQuc2V0SW5pdGlhbGl6ZXIobGl0
ZXJhbCk7Ci0JCWZyYWdtZW50LnNldEV4dHJhRGltZW5zaW9ucygwKTsKKwkJZnJhZ21lbnQuZ2V0
RXh0cmFBbm5vdGF0ZWREaW1lbnNpb25zKCkuY2xlYXIoKTsKIAkJVmFyaWFibGVEZWNsYXJhdGlv
blN0YXRlbWVudCBzdGF0ZW1lbnQgPSB0aGlzLmFzdC5uZXdWYXJpYWJsZURlY2xhcmF0aW9uU3Rh
dGVtZW50KGZyYWdtZW50KTsKIAkJZnJhZ21lbnQgPSB0aGlzLmFzdC5uZXdWYXJpYWJsZURlY2xh
cmF0aW9uRnJhZ21lbnQoKTsKIAkJZnJhZ21lbnQuc2V0TmFtZSh0aGlzLmFzdC5uZXdTaW1wbGVO
YW1lKCJ6IikpOy8vJE5PTi1OTFMtMSQKIAkJZnJhZ21lbnQuc2V0SW5pdGlhbGl6ZXIodGhpcy5h
c3QubmV3TnVsbExpdGVyYWwoKSk7Ci0JCWZyYWdtZW50LnNldEV4dHJhRGltZW5zaW9ucygxKTsK
KwkJZnJhZ21lbnQuZ2V0RXh0cmFBbm5vdGF0ZWREaW1lbnNpb25zKCkuY2xlYXIoKTsKKwkJZnJh
Z21lbnQuZ2V0RXh0cmFBbm5vdGF0ZWREaW1lbnNpb25zKCkuYWRkKHRoaXMuYXN0Lm5ld0RpbWVu
c2lvbihudWxsKSk7CiAJCXN0YXRlbWVudC5mcmFnbWVudHMoKS5hZGQoZnJhZ21lbnQpOwogCQlm
cmFnbWVudCA9IHRoaXMuYXN0Lm5ld1ZhcmlhYmxlRGVjbGFyYXRpb25GcmFnbWVudCgpOwogCQlm
cmFnbWVudC5zZXROYW1lKHRoaXMuYXN0Lm5ld1NpbXBsZU5hbWUoImkiKSk7Ly8kTk9OLU5MUy0x
JAotCQlmcmFnbWVudC5zZXRFeHRyYURpbWVuc2lvbnMoMCk7CisJCWZyYWdtZW50LmdldEV4dHJh
QW5ub3RhdGVkRGltZW5zaW9ucygpLmNsZWFyKCk7CiAJCXN0YXRlbWVudC5mcmFnbWVudHMoKS5h
ZGQoZnJhZ21lbnQpOwogCQlmcmFnbWVudCA9IHRoaXMuYXN0Lm5ld1ZhcmlhYmxlRGVjbGFyYXRp
b25GcmFnbWVudCgpOwogCQlmcmFnbWVudC5zZXROYW1lKHRoaXMuYXN0Lm5ld1NpbXBsZU5hbWUo
ImoiKSk7Ly8kTk9OLU5MUy0xJAotCQlmcmFnbWVudC5zZXRFeHRyYURpbWVuc2lvbnMoMik7CisJ
CWZyYWdtZW50LmdldEV4dHJhQW5ub3RhdGVkRGltZW5zaW9ucygpLmNsZWFyKCk7CisJCWZyYWdt
ZW50LmdldEV4dHJhQW5ub3RhdGVkRGltZW5zaW9ucygpLmFkZCh0aGlzLmFzdC5uZXdEaW1lbnNp
b24obnVsbCkpOworCQlmcmFnbWVudC5nZXRFeHRyYUFubm90YXRlZERpbWVuc2lvbnMoKS5hZGQo
dGhpcy5hc3QubmV3RGltZW5zaW9uKG51bGwpKTsKIAkJc3RhdGVtZW50LmZyYWdtZW50cygpLmFk
ZChmcmFnbWVudCk7CiAJCXN0YXRlbWVudC5zZXRUeXBlKHRoaXMuYXN0Lm5ld1ByaW1pdGl2ZVR5
cGUoUHJpbWl0aXZlVHlwZS5JTlQpKTsKQEAgLTI3NTksMTggKzI3NjMsMjEgQEAKIAkJbGl0ZXJh
bC5zZXRUb2tlbigiMTAiKTsvLyROT04tTkxTLTEkCiAJCWZyYWdtZW50LnNldEluaXRpYWxpemVy
KGxpdGVyYWwpOwotCQlmcmFnbWVudC5zZXRFeHRyYURpbWVuc2lvbnMoMCk7CisJCWZyYWdtZW50
LmdldEV4dHJhQW5ub3RhdGVkRGltZW5zaW9ucygpLmNsZWFyKCk7CiAJCVZhcmlhYmxlRGVjbGFy
YXRpb25TdGF0ZW1lbnQgc3RhdGVtZW50ID0gdGhpcy5hc3QubmV3VmFyaWFibGVEZWNsYXJhdGlv
blN0YXRlbWVudChmcmFnbWVudCk7CiAJCWZyYWdtZW50ID0gdGhpcy5hc3QubmV3VmFyaWFibGVE
ZWNsYXJhdGlvbkZyYWdtZW50KCk7CiAJCWZyYWdtZW50LnNldE5hbWUodGhpcy5hc3QubmV3U2lt
cGxlTmFtZSgieiIpKTsvLyROT04tTkxTLTEkCiAJCWZyYWdtZW50LnNldEluaXRpYWxpemVyKHRo
aXMuYXN0Lm5ld051bGxMaXRlcmFsKCkpOwotCQlmcmFnbWVudC5zZXRFeHRyYURpbWVuc2lvbnMo
MSk7CisJCWZyYWdtZW50LmdldEV4dHJhQW5ub3RhdGVkRGltZW5zaW9ucygpLmNsZWFyKCk7CisJ
CWZyYWdtZW50LmdldEV4dHJhQW5ub3RhdGVkRGltZW5zaW9ucygpLmFkZCh0aGlzLmFzdC5uZXdE
aW1lbnNpb24obnVsbCkpOwogCQlzdGF0ZW1lbnQuZnJhZ21lbnRzKCkuYWRkKGZyYWdtZW50KTsK
IAkJZnJhZ21lbnQgPSB0aGlzLmFzdC5uZXdWYXJpYWJsZURlY2xhcmF0aW9uRnJhZ21lbnQoKTsK
IAkJZnJhZ21lbnQuc2V0TmFtZSh0aGlzLmFzdC5uZXdTaW1wbGVOYW1lKCJpIikpOy8vJE5PTi1O
TFMtMSQKLQkJZnJhZ21lbnQuc2V0RXh0cmFEaW1lbnNpb25zKDApOworCQlmcmFnbWVudC5nZXRF
eHRyYUFubm90YXRlZERpbWVuc2lvbnMoKS5jbGVhcigpOwogCQlzdGF0ZW1lbnQuZnJhZ21lbnRz
KCkuYWRkKGZyYWdtZW50KTsKIAkJZnJhZ21lbnQgPSB0aGlzLmFzdC5uZXdWYXJpYWJsZURlY2xh
cmF0aW9uRnJhZ21lbnQoKTsKIAkJZnJhZ21lbnQuc2V0TmFtZSh0aGlzLmFzdC5uZXdTaW1wbGVO
YW1lKCJqIikpOy8vJE5PTi1OTFMtMSQKLQkJZnJhZ21lbnQuc2V0RXh0cmFEaW1lbnNpb25zKDIp
OworCQlmcmFnbWVudC5nZXRFeHRyYUFubm90YXRlZERpbWVuc2lvbnMoKS5jbGVhcigpOworCQlm
cmFnbWVudC5nZXRFeHRyYUFubm90YXRlZERpbWVuc2lvbnMoKS5hZGQodGhpcy5hc3QubmV3RGlt
ZW5zaW9uKG51bGwpKTsKKwkJZnJhZ21lbnQuZ2V0RXh0cmFBbm5vdGF0ZWREaW1lbnNpb25zKCku
YWRkKHRoaXMuYXN0Lm5ld0RpbWVuc2lvbihudWxsKSk7CiAJCXN0YXRlbWVudC5mcmFnbWVudHMo
KS5hZGQoZnJhZ21lbnQpOwogCQlzdGF0ZW1lbnQuc2V0VHlwZSh0aGlzLmFzdC5uZXdBcnJheVR5
cGUodGhpcy5hc3QubmV3UHJpbWl0aXZlVHlwZShQcmltaXRpdmVUeXBlLklOVCksIDEpKTsKQEAg
LTI3OTgsNSArMjgwNSw2IEBACiAJCXZhcmlhYmxlRGVjbGFyYXRpb25GcmFnbWVudC5zZXROYW1l
KHRoaXMuYXN0Lm5ld1NpbXBsZU5hbWUoInRhYiIpKTsgLy8kTk9OLU5MUy0xJAogCQl2YXJpYWJs
ZURlY2xhcmF0aW9uRnJhZ21lbnQuc2V0SW5pdGlhbGl6ZXIodGhpcy5hc3QubmV3TnVsbExpdGVy
YWwoKSk7Ly8kTk9OLU5MUy0xJAotCQl2YXJpYWJsZURlY2xhcmF0aW9uRnJhZ21lbnQuc2V0RXh0
cmFEaW1lbnNpb25zKDEpOworCQl2YXJpYWJsZURlY2xhcmF0aW9uRnJhZ21lbnQuZ2V0RXh0cmFB
bm5vdGF0ZWREaW1lbnNpb25zKCkuY2xlYXIoKTsKKwkJdmFyaWFibGVEZWNsYXJhdGlvbkZyYWdt
ZW50LmdldEV4dHJhQW5ub3RhdGVkRGltZW5zaW9ucygpLmFkZCh0aGlzLmFzdC5uZXdEaW1lbnNp
b24obnVsbCkpOwogCQlWYXJpYWJsZURlY2xhcmF0aW9uRXhwcmVzc2lvbiB2YXJpYWJsZURlY2xh
cmF0aW9uRXhwcmVzc2lvbiA9IHRoaXMuYXN0Lm5ld1ZhcmlhYmxlRGVjbGFyYXRpb25FeHByZXNz
aW9uKHZhcmlhYmxlRGVjbGFyYXRpb25GcmFnbWVudCk7CiAJCXZhcmlhYmxlRGVjbGFyYXRpb25F
eHByZXNzaW9uLnNldFR5cGUodGhpcy5hc3QubmV3QXJyYXlUeXBlKHRoaXMuYXN0Lm5ld1NpbXBs
ZVR5cGUodGhpcy5hc3QubmV3U2ltcGxlTmFtZSgiU3RyaW5nIikpLCAxKSk7Ly8kTk9OLU5MUy0x
JApAQCAtMjgyNiw1ICsyODM0LDYgQEAKIAkJdmFyaWFibGVEZWNsYXJhdGlvbkZyYWdtZW50LnNl
dE5hbWUodGhpcy5hc3QubmV3U2ltcGxlTmFtZSgidGFiIikpOyAvLyROT04tTkxTLTEkCiAJCXZh
cmlhYmxlRGVjbGFyYXRpb25GcmFnbWVudC5zZXRJbml0aWFsaXplcih0aGlzLmFzdC5uZXdOdWxs
TGl0ZXJhbCgpKTsvLyROT04tTkxTLTEkCi0JCXZhcmlhYmxlRGVjbGFyYXRpb25GcmFnbWVudC5z
ZXRFeHRyYURpbWVuc2lvbnMoMSk7CisJCXZhcmlhYmxlRGVjbGFyYXRpb25GcmFnbWVudC5nZXRF
eHRyYUFubm90YXRlZERpbWVuc2lvbnMoKS5jbGVhcigpOworCQl2YXJpYWJsZURlY2xhcmF0aW9u
RnJhZ21lbnQuZ2V0RXh0cmFBbm5vdGF0ZWREaW1lbnNpb25zKCkuYWRkKHRoaXMuYXN0Lm5ld0Rp
bWVuc2lvbihudWxsKSk7CiAJCVZhcmlhYmxlRGVjbGFyYXRpb25FeHByZXNzaW9uIHZhcmlhYmxl
RGVjbGFyYXRpb25FeHByZXNzaW9uID0gdGhpcy5hc3QubmV3VmFyaWFibGVEZWNsYXJhdGlvbkV4
cHJlc3Npb24odmFyaWFibGVEZWNsYXJhdGlvbkZyYWdtZW50KTsKIAkJdmFyaWFibGVEZWNsYXJh
dGlvbkV4cHJlc3Npb24uc2V0VHlwZSh0aGlzLmFzdC5uZXdTaW1wbGVUeXBlKHRoaXMuYXN0Lm5l
d1NpbXBsZU5hbWUoIlN0cmluZyIpKSk7Ly8kTk9OLU5MUy0xJApAQCAtMjg1NCw1ICsyODYzLDYg
QEAKIAkJdmFyaWFibGVEZWNsYXJhdGlvbkZyYWdtZW50LnNldE5hbWUodGhpcy5hc3QubmV3U2lt
cGxlTmFtZSgidGFiIikpOyAvLyROT04tTkxTLTEkCiAJCXZhcmlhYmxlRGVjbGFyYXRpb25GcmFn
bWVudC5zZXRJbml0aWFsaXplcih0aGlzLmFzdC5uZXdOdWxsTGl0ZXJhbCgpKTsvLyROT04tTkxT
LTEkCi0JCXZhcmlhYmxlRGVjbGFyYXRpb25GcmFnbWVudC5zZXRFeHRyYURpbWVuc2lvbnMoMSk7
CisJCXZhcmlhYmxlRGVjbGFyYXRpb25GcmFnbWVudC5nZXRFeHRyYUFubm90YXRlZERpbWVuc2lv
bnMoKS5jbGVhcigpOworCQl2YXJpYWJsZURlY2xhcmF0aW9uRnJhZ21lbnQuZ2V0RXh0cmFBbm5v
dGF0ZWREaW1lbnNpb25zKCkuYWRkKHRoaXMuYXN0Lm5ld0RpbWVuc2lvbihudWxsKSk7CiAJCVZh
cmlhYmxlRGVjbGFyYXRpb25FeHByZXNzaW9uIHZhcmlhYmxlRGVjbGFyYXRpb25FeHByZXNzaW9u
ID0gdGhpcy5hc3QubmV3VmFyaWFibGVEZWNsYXJhdGlvbkV4cHJlc3Npb24odmFyaWFibGVEZWNs
YXJhdGlvbkZyYWdtZW50KTsKIAkJdmFyaWFibGVEZWNsYXJhdGlvbkV4cHJlc3Npb24uc2V0VHlw
ZSh0aGlzLmFzdC5uZXdTaW1wbGVUeXBlKHRoaXMuYXN0Lm5ld1NpbXBsZU5hbWUoIlN0cmluZyIp
KSk7Ly8kTk9OLU5MUy0xJApAQCAtMjg4Myw1ICsyODkzLDUgQEAKIAkJVmFyaWFibGVEZWNsYXJh
dGlvbkZyYWdtZW50IGZyYWdtZW50ID0gdGhpcy5hc3QubmV3VmFyaWFibGVEZWNsYXJhdGlvbkZy
YWdtZW50KCk7CiAJCWZyYWdtZW50LnNldE5hbWUodGhpcy5hc3QubmV3U2ltcGxlTmFtZSgiaSIp
KTsgLy8kTk9OLU5MUy0xJAotCQlmcmFnbWVudC5zZXRFeHRyYURpbWVuc2lvbnMoMCk7CisJCWZy
YWdtZW50LmdldEV4dHJhQW5ub3RhdGVkRGltZW5zaW9ucygpLmNsZWFyKCk7CiAJCUZpZWxkRGVj
bGFyYXRpb24gZmllbGREZWNsYXJhdGlvbiA9IHRoaXMuYXN0Lm5ld0ZpZWxkRGVjbGFyYXRpb24o
ZnJhZ21lbnQpOwogCQlmaWVsZERlY2xhcmF0aW9uLnNldFR5cGUodGhpcy5hc3QubmV3UHJpbWl0
aXZlVHlwZShQcmltaXRpdmVUeXBlLklOVCkpOwpAQCAtMjkwNSw1ICsyOTE1LDUgQEAKIAkJbGl0
ZXJhbC5zZXRUb2tlbigiMTAiKTsgLy8kTk9OLU5MUy0xJAogCQlmcmFnbWVudC5zZXRJbml0aWFs
aXplcihsaXRlcmFsKTsKLQkJZnJhZ21lbnQuc2V0RXh0cmFEaW1lbnNpb25zKDApOworCQlmcmFn
bWVudC5nZXRFeHRyYUFubm90YXRlZERpbWVuc2lvbnMoKS5jbGVhcigpOwogCQlGaWVsZERlY2xh
cmF0aW9uIGZpZWxkRGVjbGFyYXRpb24gPSB0aGlzLmFzdC5uZXdGaWVsZERlY2xhcmF0aW9uKGZy
YWdtZW50KTsKIAkJZmllbGREZWNsYXJhdGlvbi5tb2RpZmllcnMoKS5hZGQodGhpcy5hc3QubmV3
TW9kaWZpZXIoTW9kaWZpZXIuTW9kaWZpZXJLZXl3b3JkLlBVQkxJQ19LRVlXT1JEKSk7CkBAIC0y
OTExLDE0ICsyOTIxLDE3IEBACiAJCWZyYWdtZW50ID0gdGhpcy5hc3QubmV3VmFyaWFibGVEZWNs
YXJhdGlvbkZyYWdtZW50KCk7CiAJCWZyYWdtZW50LnNldE5hbWUodGhpcy5hc3QubmV3U2ltcGxl
TmFtZSgieSIpKTsvLyROT04tTkxTLTEkCi0JCWZyYWdtZW50LnNldEV4dHJhRGltZW5zaW9ucygx
KTsKKwkJZnJhZ21lbnQuZ2V0RXh0cmFBbm5vdGF0ZWREaW1lbnNpb25zKCkuY2xlYXIoKTsKKwkJ
ZnJhZ21lbnQuZ2V0RXh0cmFBbm5vdGF0ZWREaW1lbnNpb25zKCkuYWRkKHRoaXMuYXN0Lm5ld0Rp
bWVuc2lvbihudWxsKSk7CiAJCWZyYWdtZW50LnNldEluaXRpYWxpemVyKHRoaXMuYXN0Lm5ld051
bGxMaXRlcmFsKCkpOwogCQlmaWVsZERlY2xhcmF0aW9uLmZyYWdtZW50cygpLmFkZChmcmFnbWVu
dCk7CiAJCWZyYWdtZW50ID0gdGhpcy5hc3QubmV3VmFyaWFibGVEZWNsYXJhdGlvbkZyYWdtZW50
KCk7CiAJCWZyYWdtZW50LnNldE5hbWUodGhpcy5hc3QubmV3U2ltcGxlTmFtZSgiaSIpKTsvLyRO
T04tTkxTLTEkCi0JCWZyYWdtZW50LnNldEV4dHJhRGltZW5zaW9ucygwKTsKKwkJZnJhZ21lbnQu
Z2V0RXh0cmFBbm5vdGF0ZWREaW1lbnNpb25zKCkuY2xlYXIoKTsKIAkJZmllbGREZWNsYXJhdGlv
bi5mcmFnbWVudHMoKS5hZGQoZnJhZ21lbnQpOwogCQlmcmFnbWVudCA9IHRoaXMuYXN0Lm5ld1Zh
cmlhYmxlRGVjbGFyYXRpb25GcmFnbWVudCgpOwogCQlmcmFnbWVudC5zZXROYW1lKHRoaXMuYXN0
Lm5ld1NpbXBsZU5hbWUoImoiKSk7Ly8kTk9OLU5MUy0xJAotCQlmcmFnbWVudC5zZXRFeHRyYURp
bWVuc2lvbnMoMik7CisJCWZyYWdtZW50LmdldEV4dHJhQW5ub3RhdGVkRGltZW5zaW9ucygpLmNs
ZWFyKCk7CisJCWZyYWdtZW50LmdldEV4dHJhQW5ub3RhdGVkRGltZW5zaW9ucygpLmFkZCh0aGlz
LmFzdC5uZXdEaW1lbnNpb24obnVsbCkpOworCQlmcmFnbWVudC5nZXRFeHRyYUFubm90YXRlZERp
bWVuc2lvbnMoKS5hZGQodGhpcy5hc3QubmV3RGltZW5zaW9uKG51bGwpKTsKIAkJZmllbGREZWNs
YXJhdGlvbi5mcmFnbWVudHMoKS5hZGQoZnJhZ21lbnQpOwogCQlhc3NlcnRUcnVlKCJCb3RoIEFT
VCB0cmVlcyBzaG91bGQgYmUgaWRlbnRpY2FsIiwgZmllbGREZWNsYXJhdGlvbi5zdWJ0cmVlTWF0
Y2gobmV3IEFTVE1hdGNoZXIoKSwgbm9kZSkpOwkJLy8kTk9OLU5MUy0xJApAQCAtOTU4NCw0ICs5
NTk3LDYgQEAKIAkJYXNzZXJ0RXF1YWxzKCJXcm9uZyBxdWFsaWZpZWQgbmFtZSIsICJqYXZhLmxh
bmcuU3RyaW5nW10iLCB0eXBlQmluZGluZzIuZ2V0UXVhbGlmaWVkTmFtZSgpKTsgLy8kTk9OLU5M
Uy0xJCAvLyROT04tTkxTLTIkCiAJCWFzc2VydEVxdWFscygiV3JvbmcgZGltZW5zaW9uIiwgMSwg
dHlwZUJpbmRpbmcyLmdldERpbWVuc2lvbnMoKSk7IC8vJE5PTi1OTFMtMSQKKwkJTGlzdCBleHRy
YURpbWVuc2lvbnMgPSBtZXRob2REZWNsYXJhdGlvbi5nZXRFeHRyYUFubm90YXRlZERpbWVuc2lv
bnMoKTsKKwkJYXNzZXJ0RXh0cmFEaW1lbnNpb25zRXF1YWwoIldyb25nIGV4dHJhIGRpbWVuc2lv
biBpbmZvIiwgZXh0cmFEaW1lbnNpb25zLCAiW10gIik7CiAJfQogCkBAIC05NjcwLDQgKzk2ODUs
NiBAQAogCQlhc3NlcnRFcXVhbHMoIldyb25nIGRpbWVuc2lvbiIsIDEsIHR5cGVCaW5kaW5nMi5n
ZXREaW1lbnNpb25zKCkpOyAvLyROT04tTkxTLTEkCiAJCWFzc2VydEVxdWFscygid3JvbmcgZnVs
bHkgcXVhbGlmaWVkIG5hbWUiLCAiamF2YS5sYW5nLlN0cmluZ1tdIiwgdHlwZUJpbmRpbmcyLmdl
dFF1YWxpZmllZE5hbWUoKSk7IC8vJE5PTi1OTFMtMSQgLy8kTk9OLU5MUy0yJAorCQlMaXN0IGV4
dHJhRGltZW5zaW9ucyA9IHNpbmdsZVZhcmlhYmxlRGVjbGFyYXRpb24uZ2V0RXh0cmFBbm5vdGF0
ZWREaW1lbnNpb25zKCk7CisJCWFzc2VydEV4dHJhRGltZW5zaW9uc0VxdWFsKCJXcm9uZyBleHRy
YSBkaW1lbnNpb24gaW5mbyIsIGV4dHJhRGltZW5zaW9ucywgIltdICIpOwogCX0KIApkaWZmIC0t
Z2l0IGEvb3JnLmVjbGlwc2UuamR0LmNvcmUudGVzdHMubW9kZWwvc3JjL29yZy9lY2xpcHNlL2pk
dC9jb3JlL3Rlc3RzL2RvbS9Db252ZXJ0ZXJUZXN0U2V0dXAuamF2YSBiL29yZy5lY2xpcHNlLmpk
dC5jb3JlLnRlc3RzLm1vZGVsL3NyYy9vcmcvZWNsaXBzZS9qZHQvY29yZS90ZXN0cy9kb20vQ29u
dmVydGVyVGVzdFNldHVwLmphdmEKaW5kZXggY2RiYzRhMC4uYmYzYjk1MyAxMDA2NDQKLS0tIGEv
b3JnLmVjbGlwc2UuamR0LmNvcmUudGVzdHMubW9kZWwvc3JjL29yZy9lY2xpcHNlL2pkdC9jb3Jl
L3Rlc3RzL2RvbS9Db252ZXJ0ZXJUZXN0U2V0dXAuamF2YQorKysgYi9vcmcuZWNsaXBzZS5qZHQu
Y29yZS50ZXN0cy5tb2RlbC9zcmMvb3JnL2VjbGlwc2UvamR0L2NvcmUvdGVzdHMvZG9tL0NvbnZl
cnRlclRlc3RTZXR1cC5qYXZhCkBAIC0xNiw0ICsxNiw1IEBACiAKIGltcG9ydCBqYXZhLmlvLklP
RXhjZXB0aW9uOworaW1wb3J0IGphdmEudXRpbC5JdGVyYXRvcjsKIGltcG9ydCBqYXZhLnV0aWwu
TGlzdDsKIGltcG9ydCBqYXZhLnV0aWwuTWFwOwpAQCAtMTQyLDQgKzE0MywyMCBAQAogCX0KIAor
CXByb3RlY3RlZCB2b2lkIGFzc2VydEV4dHJhRGltZW5zaW9uc0VxdWFsKFN0cmluZyBtZXNzYWdl
LCBMaXN0IGRpbWVuc2lvbnMsIFN0cmluZyBleHBlY3RlZCkgeworCQlTdHJpbmdCdWZmZXIgYnVm
ZmVyID0gbmV3IFN0cmluZ0J1ZmZlcigpOworCQlJdGVyYXRvciBpdGVyID0gZGltZW5zaW9ucy5p
dGVyYXRvcigpOworCQl3aGlsZShpdGVyLmhhc05leHQoKSkgeworCQkJRGltZW5zaW9uVHlwZSBk
aW0gPSAoRGltZW5zaW9uVHlwZSkgaXRlci5uZXh0KCk7CisJCQlJdGVyYXRvciBhbm5vdGF0aW9u
cyA9IGRpbS5hbm5vdGF0aW9ucygpLml0ZXJhdG9yKCk7CisJCQl3aGlsZSAoYW5ub3RhdGlvbnMu
aGFzTmV4dCgpKSB7CisJCQkJYnVmZmVyLmFwcGVuZCgnQCcpOworCQkJCWJ1ZmZlci5hcHBlbmQo
KChBbm5vdGF0aW9uKSBhbm5vdGF0aW9ucy5uZXh0KCkpLmdldFR5cGVOYW1lKCkuZ2V0RnVsbHlR
dWFsaWZpZWROYW1lKCkpOworCQkJCWJ1ZmZlci5hcHBlbmQoJyAnKTsKKwkJCX0KKwkJCWJ1ZmZl
ci5hcHBlbmQoIltdICIpOworCQl9CisJCWFzc2VydEVxdWFscyhtZXNzYWdlLCBleHBlY3RlZCwg
YnVmZmVyLnRvU3RyaW5nKCkpOworCX0KKwogCXB1YmxpYyBBU1ROb2RlIHJ1bkNvbnZlcnNpb24o
SUNvbXBpbGF0aW9uVW5pdCB1bml0LCBib29sZWFuIHJlc29sdmVCaW5kaW5ncywKIAkJCWJvb2xl
YW4gYmluZGluZ3NSZWNvdmVyeSkgewpkaWZmIC0tZ2l0IGEvb3JnLmVjbGlwc2UuamR0LmNvcmUu
dGVzdHMubW9kZWwvc3JjL29yZy9lY2xpcHNlL2pkdC9jb3JlL3Rlc3RzL3Jld3JpdGUvZGVzY3Jp
YmluZy9BU1RSZXdyaXRpbmdNZXRob2REZWNsVGVzdC5qYXZhIGIvb3JnLmVjbGlwc2UuamR0LmNv
cmUudGVzdHMubW9kZWwvc3JjL29yZy9lY2xpcHNlL2pkdC9jb3JlL3Rlc3RzL3Jld3JpdGUvZGVz
Y3JpYmluZy9BU1RSZXdyaXRpbmdNZXRob2REZWNsVGVzdC5qYXZhCmluZGV4IGUzMzBhZjkuLjIz
MzFhOGEgMTAwNjQ0Ci0tLSBhL29yZy5lY2xpcHNlLmpkdC5jb3JlLnRlc3RzLm1vZGVsL3NyYy9v
cmcvZWNsaXBzZS9qZHQvY29yZS90ZXN0cy9yZXdyaXRlL2Rlc2NyaWJpbmcvQVNUUmV3cml0aW5n
TWV0aG9kRGVjbFRlc3QuamF2YQorKysgYi9vcmcuZWNsaXBzZS5qZHQuY29yZS50ZXN0cy5tb2Rl
bC9zcmMvb3JnL2VjbGlwc2UvamR0L2NvcmUvdGVzdHMvcmV3cml0ZS9kZXNjcmliaW5nL0FTVFJl
d3JpdGluZ01ldGhvZERlY2xUZXN0LmphdmEKQEAgLTI5NDEsNCArMjk0MSwxNyBAQAogCQlhc3Nl
cnRFcXVhbFN0cmluZyhwcmV2aWV3LCBidWYudG9TdHJpbmcoKSk7CiAJfQorCXB1YmxpYyB2b2lk
IF90ZXN0RXh0cmFEaW1lbnNpb25zMSgpIHRocm93cyBFeGNlcHRpb24geworCQlJUGFja2FnZUZy
YWdtZW50IHBhY2sxID0gdGhpcy5zb3VyY2VGb2xkZXIuY3JlYXRlUGFja2FnZUZyYWdtZW50KCJ0
ZXN0MSIsIGZhbHNlLCBudWxsKTsKKwkJU3RyaW5nQnVmZmVyIGJ1ZiA9IG5ldyBTdHJpbmdCdWZm
ZXIoKTsKKwkJYnVmLmFwcGVuZCgicGFja2FnZSB0ZXN0MTtcbiIpOworCQlidWYuYXBwZW5kKCJj
bGFzcyBYIHtcbiIpOworCQlidWYuYXBwZW5kKCIgICAgIEBBbm5vdCBpbnQgQEFubm90MSBbXSBh
IEBBbm5vdDIgW10gQEFubm90MyBbXSBAQW5ub3Q0IFtdLCBiIEBBbm5vdDIgQEFubm90MyBbXSBA
QW5ub3Q0IFtdO1xuIik7CisJCWJ1Zi5hcHBlbmQoIn1cbiIpOworCQlJQ29tcGlsYXRpb25Vbml0
IGN1PSBwYWNrMS5jcmVhdGVDb21waWxhdGlvblVuaXQoIlguamF2YSIsIGJ1Zi50b1N0cmluZygp
LCBmYWxzZSwgbnVsbCk7CisJCUNvbXBpbGF0aW9uVW5pdCBhc3RSb290ID0gY3JlYXRlQVNUOChj
dSk7CisJCUFTVCBhc3QgPSBhc3RSb290LmdldEFTVCgpOworCQlBU1RSZXdyaXRlIHJld3JpdGUg
PSBBU1RSZXdyaXRlLmNyZWF0ZShhc3RSb290LmdldEFTVCgpKTsKKwkJVHlwZURlY2xhcmF0aW9u
IHR5cGUgPSBmaW5kVHlwZURlY2xhcmF0aW9uKGFzdFJvb3QsICJYIik7CisJfQogCXB1YmxpYyB2
b2lkIHRlc3RSZWNlaXZlcjMoKSB0aHJvd3MgRXhjZXB0aW9uIHsKIAkJSVBhY2thZ2VGcmFnbWVu
dCBwYWNrMSA9IHRoaXMuc291cmNlRm9sZGVyLmNyZWF0ZVBhY2thZ2VGcmFnbWVudCgidGVzdDEi
LCBmYWxzZSwgbnVsbCk7CmRpZmYgLS1naXQgYS9vcmcuZWNsaXBzZS5qZHQuY29yZS50ZXN0cy5t
b2RlbC9zcmMvb3JnL2VjbGlwc2UvamR0L2NvcmUvdGVzdHMvcmV3cml0ZS9kZXNjcmliaW5nL0FT
VFJld3JpdGluZ1R5cGVEZWNsVGVzdC5qYXZhIGIvb3JnLmVjbGlwc2UuamR0LmNvcmUudGVzdHMu
bW9kZWwvc3JjL29yZy9lY2xpcHNlL2pkdC9jb3JlL3Rlc3RzL3Jld3JpdGUvZGVzY3JpYmluZy9B
U1RSZXdyaXRpbmdUeXBlRGVjbFRlc3QuamF2YQppbmRleCA3ZjlhMTkyLi42MDVhMWU2IDEwMDY0
NAotLS0gYS9vcmcuZWNsaXBzZS5qZHQuY29yZS50ZXN0cy5tb2RlbC9zcmMvb3JnL2VjbGlwc2Uv
amR0L2NvcmUvdGVzdHMvcmV3cml0ZS9kZXNjcmliaW5nL0FTVFJld3JpdGluZ1R5cGVEZWNsVGVz
dC5qYXZhCisrKyBiL29yZy5lY2xpcHNlLmpkdC5jb3JlLnRlc3RzLm1vZGVsL3NyYy9vcmcvZWNs
aXBzZS9qZHQvY29yZS90ZXN0cy9yZXdyaXRlL2Rlc2NyaWJpbmcvQVNUUmV3cml0aW5nVHlwZURl
Y2xUZXN0LmphdmEKQEAgLTE4LDQgKzE4LDUgQEAKIGltcG9ydCBvcmcuZWNsaXBzZS5qZHQuY29y
ZS5JUGFja2FnZUZyYWdtZW50OwogaW1wb3J0IG9yZy5lY2xpcHNlLmpkdC5jb3JlLkphdmFDb3Jl
OworaW1wb3J0IG9yZy5lY2xpcHNlLmpkdC5jb3JlLkphdmFNb2RlbEV4Y2VwdGlvbjsKIAogaW1w
b3J0IG9yZy5lY2xpcHNlLmpkdC5jb3JlLmRvbS4qOwpAQCAtMTAzNiw0ICsxMDM3LDIwIEBACiAJ
fQogCisJcHVibGljIHZvaWQgdGVzdERpbWVuc2lvbnNXaXRoQW5ub3RhdGlvbnMoKSB0aHJvd3Mg
SmF2YU1vZGVsRXhjZXB0aW9uIHsKKwkJSVBhY2thZ2VGcmFnbWVudCBwYWNrMT0gdGhpcy5zb3Vy
Y2VGb2xkZXIuY3JlYXRlUGFja2FnZUZyYWdtZW50KCJwIiwgZmFsc2UsIG51bGwpOworCQlTdHJp
bmdCdWZmZXIgYnVmPSBuZXcgU3RyaW5nQnVmZmVyKCk7CisJCWJ1Zi5hcHBlbmQoInBhY2thZ2Ug
dGVzdDE7XG4iKTsKKwkJYnVmLmFwcGVuZCgicHVibGljIGNsYXNzIEUge1xuIik7CisJCWJ1Zi5h
cHBlbmQoIiAgICBwdWJsaWMgdm9pZCBmb28oKSB7XG4iKTsKKwkJYnVmLmFwcGVuZCgiICAgICAg
ICBpbnQgaSwgaiwgaz0gMCwgeFtdW10sIHlbXT0gezAsIDF9O1xuIik7CisJCWJ1Zi5hcHBlbmQo
IiAgICB9XG4iKTsKKwkJYnVmLmFwcGVuZCgifVxuIik7CisJCUlDb21waWxhdGlvblVuaXQgY3U9
IHBhY2sxLmNyZWF0ZUNvbXBpbGF0aW9uVW5pdCgiWC5qYXZhIiwgYnVmLnRvU3RyaW5nKCksIGZh
bHNlLCBudWxsKTsKKwkJQ29tcGlsYXRpb25Vbml0IGFzdFJvb3Q9IGNyZWF0ZUFTVChjdSk7CisJ
CUFTVFJld3JpdGUgcmV3cml0ZT0gQVNUUmV3cml0ZS5jcmVhdGUoYXN0Um9vdC5nZXRBU1QoKSk7
CisKKwkJQVNUIGFzdD0gYXN0Um9vdC5nZXRBU1QoKTsKKwl9CisKIAlwdWJsaWMgdm9pZCB0ZXN0
VmFyaWFibGVEZWNsYXJhdGlvbkZyYWdtZW50KCkgdGhyb3dzIEV4Y2VwdGlvbiB7CiAJCUlQYWNr
YWdlRnJhZ21lbnQgcGFjazE9IHRoaXMuc291cmNlRm9sZGVyLmNyZWF0ZVBhY2thZ2VGcmFnbWVu
dCgidGVzdDEiLCBmYWxzZSwgbnVsbCk7CmRpZmYgLS1naXQgYS9vcmcuZWNsaXBzZS5qZHQuY29y
ZS9kb20vb3JnL2VjbGlwc2UvamR0L2NvcmUvZG9tL0FTVC5qYXZhIGIvb3JnLmVjbGlwc2UuamR0
LmNvcmUvZG9tL29yZy9lY2xpcHNlL2pkdC9jb3JlL2RvbS9BU1QuamF2YQppbmRleCAwZDVhZWQ1
Li5kYzY3NDVlIDEwMDY0NAotLS0gYS9vcmcuZWNsaXBzZS5qZHQuY29yZS9kb20vb3JnL2VjbGlw
c2UvamR0L2NvcmUvZG9tL0FTVC5qYXZhCisrKyBiL29yZy5lY2xpcHNlLmpkdC5jb3JlL2RvbS9v
cmcvZWNsaXBzZS9qZHQvY29yZS9kb20vQVNULmphdmEKQEAgLTExMTUsNCArMTExNSwxNiBAQAog
CQlyZXR1cm4gcmVzdWx0OwogCX0KKwkKKwkvKioKKwkgKiBAc2luY2UgMy45CisJICovCisJcHVi
bGljIERpbWVuc2lvblR5cGUgbmV3RGltZW5zaW9uKEFubm90YXRpb25bXSBhbm5vdGF0aW9ucykg
eworCQlEaW1lbnNpb25UeXBlIHJlc3VsdCA9IG5ldyBEaW1lbnNpb25UeXBlKHRoaXMpOworCQlp
bnQgbGVuZ3RoID0gKGFubm90YXRpb25zID09IG51bGwpID8gMCA6IGFubm90YXRpb25zLmxlbmd0
aDsKKwkJZm9yIChpbnQgaSA9IDA7IGkgPCBsZW5ndGg7IGkrKykgeworCQkJcmVzdWx0LmFubm90
YXRpb25zLmFkZChhbm5vdGF0aW9uc1tpXSk7CisJCX0KKwkJcmV0dXJuIHJlc3VsdDsKKwl9CiAK
IAkvKioKZGlmZiAtLWdpdCBhL29yZy5lY2xpcHNlLmpkdC5jb3JlL2RvbS9vcmcvZWNsaXBzZS9q
ZHQvY29yZS9kb20vQVNUQ29udmVydGVyLmphdmEgYi9vcmcuZWNsaXBzZS5qZHQuY29yZS9kb20v
b3JnL2VjbGlwc2UvamR0L2NvcmUvZG9tL0FTVENvbnZlcnRlci5qYXZhCmluZGV4IDI3YTE2YzQu
Ljg4NGU4N2QgMTAwNjQ0Ci0tLSBhL29yZy5lY2xpcHNlLmpkdC5jb3JlL2RvbS9vcmcvZWNsaXBz
ZS9qZHQvY29yZS9kb20vQVNUQ29udmVydGVyLmphdmEKKysrIGIvb3JnLmVjbGlwc2UuamR0LmNv
cmUvZG9tL29yZy9lY2xpcHNlL2pkdC9jb3JlL2RvbS9BU1RDb252ZXJ0ZXIuamF2YQpAQCAtNDk2
LDQgKzQ5Niw3IEBACiAJCQkJaW50IGV4dHJhRGltZW5zaW9ucyA9IHJldHJpZXZlRXh0cmFEaW1l
bnNpb24ocmlnaHRQYXJlbnRoZXNpc1Bvc2l0aW9uLCBtZXRob2QuYm9keUVuZCk7CiAJCQkJbWV0
aG9kRGVjbC5zZXRFeHRyYURpbWVuc2lvbnMoZXh0cmFEaW1lbnNpb25zKTsKKwkJCQlpZiAodGhp
cy5hc3QuYXBpTGV2ZWwgPj0gQVNULkpMUzgpIHsKKwkJCQkJc2V0RXh0cmFBbm5vdGF0ZWREaW1l
bnNpb25zKHJpZ2h0UGFyZW50aGVzaXNQb3NpdGlvbiwgdGhpcy5zY2FubmVyLmN1cnJlbnRQb3Np
dGlvbiwgIHR5cGVSZWZlcmVuY2UsIG1ldGhvZERlY2wuZXh0cmFBbm5vdGF0ZWREaW1lbnNpb25z
LCBleHRyYURpbWVuc2lvbnMpOworCQkJCX0KIAkJCQlzZXRUeXBlRm9yTWV0aG9kRGVjbGFyYXRp
b24obWV0aG9kRGVjbCwgcmV0dXJuVHlwZSwgZXh0cmFEaW1lbnNpb25zKTsKIAkJCX0gZWxzZSB7
CkBAIC03ODcsNCArNzkwLDcgQEAKIAkJZmluYWwgaW50IGV4dHJhRGltZW5zaW9ucyA9IHJldHJp
ZXZlRXh0cmFEaW1lbnNpb24obmFtZUVuZCArIDEsIHR5cGVTb3VyY2VFbmQpOwogCQl2YXJpYWJs
ZURlY2wuc2V0RXh0cmFEaW1lbnNpb25zKGV4dHJhRGltZW5zaW9ucyk7CisJCWlmICh0aGlzLmFz
dC5hcGlMZXZlbCA+PSBBU1QuSkxTOCkgeworCQkJc2V0RXh0cmFBbm5vdGF0ZWREaW1lbnNpb25z
KG5hbWVFbmQgKyAxLCB0aGlzLnNjYW5uZXIuY3VycmVudFBvc2l0aW9uLCAgYXJndW1lbnQudHlw
ZSwgdmFyaWFibGVEZWNsLmV4dHJhQW5ub3RhdGVkRGltZW5zaW9ucywgZXh0cmFEaW1lbnNpb25z
KTsKKwkJfQogCQlmaW5hbCBib29sZWFuIGlzVmFyQXJncyA9IGFyZ3VtZW50LmlzVmFyQXJncygp
OwogCQlpZiAoaXNWYXJBcmdzICYmIGV4dHJhRGltZW5zaW9ucyA9PSAwKSB7CkBAIC04MDcsNCAr
ODEzLDUgQEAKIAkJCXNldFR5cGVGb3JTaW5nbGVWYXJpYWJsZURlY2xhcmF0aW9uKHZhcmlhYmxl
RGVjbCwgdHlwZSwgZXh0cmFEaW1lbnNpb25zKTsKIAkJfQorCQkKIAkJdmFyaWFibGVEZWNsLnNl
dFNvdXJjZVJhbmdlKGFyZ3VtZW50LmRlY2xhcmF0aW9uU291cmNlU3RhcnQsIHJpZ2h0RW5kIC0g
YXJndW1lbnQuZGVjbGFyYXRpb25Tb3VyY2VTdGFydCArIDEpOwogCkBAIC0yOTQyLDQgKzI5NDks
NyBAQAogCQlmaW5hbCBpbnQgZXh0cmFEaW1lbnNpb25zID0gcmV0cmlldmVFeHRyYURpbWVuc2lv
bihuYW1lRW5kICsgMSwgbG9jYWxEZWNsYXJhdGlvbi50eXBlLnNvdXJjZUVuZCk7CiAJCXZhcmlh
YmxlRGVjbC5zZXRFeHRyYURpbWVuc2lvbnMoZXh0cmFEaW1lbnNpb25zKTsKKwkJaWYgKHRoaXMu
YXN0LmFwaUxldmVsID49IEFTVC5KTFM4KSB7CisJCQlzZXRFeHRyYUFubm90YXRlZERpbWVuc2lv
bnMobmFtZUVuZCArIDEsIHRoaXMuc2Nhbm5lci5jdXJyZW50UG9zaXRpb24sICBsb2NhbERlY2xh
cmF0aW9uLnR5cGUsIHZhcmlhYmxlRGVjbC5leHRyYUFubm90YXRlZERpbWVuc2lvbnMsIGV4dHJh
RGltZW5zaW9ucyk7CisJCX0KIAkJVHlwZSB0eXBlID0gY29udmVydFR5cGUobG9jYWxEZWNsYXJh
dGlvbi50eXBlKTsKIAkJaW50IHR5cGVFbmQgPSB0eXBlLmdldFN0YXJ0UG9zaXRpb24oKSArIHR5
cGUuZ2V0TGVuZ3RoKCkgLSAxOwpAQCAtMjk1MCw0ICsyOTYwLDUgQEAKIAkJICovCiAJCXNldFR5
cGVGb3JTaW5nbGVWYXJpYWJsZURlY2xhcmF0aW9uKHZhcmlhYmxlRGVjbCwgdHlwZSwgZXh0cmFE
aW1lbnNpb25zKTsKKwogCQl2YXJpYWJsZURlY2wuc2V0U291cmNlUmFuZ2UobG9jYWxEZWNsYXJh
dGlvbi5kZWNsYXJhdGlvblNvdXJjZVN0YXJ0LCByaWdodEVuZCAtIGxvY2FsRGVjbGFyYXRpb24u
ZGVjbGFyYXRpb25Tb3VyY2VTdGFydCArIDEpOwogCQlpZiAodGhpcy5yZXNvbHZlQmluZGluZ3Mp
IHsKQEAgLTI5NTcsNCArMjk2OCwxNSBAQAogCQl9CiAJCXJldHVybiB2YXJpYWJsZURlY2w7CisJ
fQorCisJcHJpdmF0ZSBEaW1lbnNpb25UeXBlIGNvbnZlcnRUb0RpbWVuc2lvbihpbnQgc3RhcnQs
IGludCBlbmQsIG9yZy5lY2xpcHNlLmpkdC5pbnRlcm5hbC5jb21waWxlci5hc3QuQW5ub3RhdGlv
bltdIGFubm90YXRpb24pIHsKKwkJaW50IGxlbmd0aCA9IGFubm90YXRpb24gPT0gbnVsbCA/IDAg
OiBhbm5vdGF0aW9uLmxlbmd0aDsKKwkJQW5ub3RhdGlvbltdIGFubm90YXRpb25zID0gbmV3IEFu
bm90YXRpb25bbGVuZ3RoXTsKKwkJZm9yIChpbnQgaSA9IDA7IGkgPCBsZW5ndGg7IGkrKykgewor
CQkJYW5ub3RhdGlvbnNbaV0gPSBjb252ZXJ0KGFubm90YXRpb25baV0pOworCQl9CisJCURpbWVu
c2lvblR5cGUgZGltZW5zaW9uID0gdGhpcy5hc3QubmV3RGltZW5zaW9uKGFubm90YXRpb25zKTsK
KwkJcmV0cmlldmVEaW1lbnNpb25BbmRTZXRQb3NpdGlvbnMoc3RhcnQsIGVuZCwgZGltZW5zaW9u
KTsKKwkJcmV0dXJuIGRpbWVuc2lvbjsKIAl9CiAKQEAgLTI5NjgsNSArMjk5MCw4IEBACiAJCWlu
dCBlbmQgPSBzdGFydDsKIAkJaW50IGV4dHJhRGltZW5zaW9ucyA9IHJldHJpZXZlRXh0cmFEaW1l
bnNpb24oZmllbGREZWNsYXJhdGlvbi5zb3VyY2VFbmQgKyAxLCBmaWVsZERlY2xhcmF0aW9uLmRl
Y2xhcmF0aW9uU291cmNlRW5kICk7Ci0JCXZhcmlhYmxlRGVjbGFyYXRpb25GcmFnbWVudC5zZXRF
eHRyYURpbWVuc2lvbnMoZXh0cmFEaW1lbnNpb25zKTsKKwkJdmFyaWFibGVEZWNsYXJhdGlvbkZy
YWdtZW50LnNldEV4dHJhRGltZW5zaW9ucyhleHRyYURpbWVuc2lvbnMpOwkJCisJCWlmICh0aGlz
LmFzdC5hcGlMZXZlbCA+PSBBU1QuSkxTOCkgeworCQkJc2V0RXh0cmFBbm5vdGF0ZWREaW1lbnNp
b25zKGZpZWxkRGVjbGFyYXRpb24uc291cmNlRW5kICsgMSwgdGhpcy5zY2FubmVyLmN1cnJlbnRQ
b3NpdGlvbiwgZmllbGREZWNsYXJhdGlvbi50eXBlLCB2YXJpYWJsZURlY2xhcmF0aW9uRnJhZ21l
bnQuZXh0cmFBbm5vdGF0ZWREaW1lbnNpb25zLCBleHRyYURpbWVuc2lvbnMpOworCQl9CQkKIAkJ
aWYgKGZpZWxkRGVjbGFyYXRpb24uaW5pdGlhbGl6YXRpb24gIT0gbnVsbCkgewogCQkJZmluYWwg
RXhwcmVzc2lvbiBleHByZXNzaW9uID0gY29udmVydChmaWVsZERlY2xhcmF0aW9uLmluaXRpYWxp
emF0aW9uKTsKQEAgLTMwMDcsNCArMzAzMiw4IEBACiAJCWludCBleHRyYURpbWVuc2lvbiA9IHJl
dHJpZXZlRXh0cmFEaW1lbnNpb24obG9jYWxEZWNsYXJhdGlvbi5zb3VyY2VFbmQgKyAxLCB0aGlz
LmNvbXBpbGF0aW9uVW5pdFNvdXJjZUxlbmd0aCk7CiAJCXZhcmlhYmxlRGVjbGFyYXRpb25GcmFn
bWVudC5zZXRFeHRyYURpbWVuc2lvbnMoZXh0cmFEaW1lbnNpb24pOworCQlpZiAodGhpcy5hc3Qu
YXBpTGV2ZWwgPj0gQVNULkpMUzgpIHsKKwkJCXNldEV4dHJhQW5ub3RhdGVkRGltZW5zaW9ucyhs
b2NhbERlY2xhcmF0aW9uLnNvdXJjZUVuZCArIDEsIHRoaXMuc2Nhbm5lci5jdXJyZW50UG9zaXRp
b24sIGxvY2FsRGVjbGFyYXRpb24udHlwZSwgdmFyaWFibGVEZWNsYXJhdGlvbkZyYWdtZW50LmV4
dHJhQW5ub3RhdGVkRGltZW5zaW9ucywgZXh0cmFEaW1lbnNpb24pOworCQl9CisJCQogCQlib29s
ZWFuIGhhc0luaXRpYWxpemF0aW9uID0gaW5pdGlhbGl6YXRpb24gIT0gbnVsbDsKIAkJaW50IGVu
ZDsKQEAgLTMwMzUsNCArMzA2NCwxNiBAQAogCQl9CiAJCXJldHVybiB2YXJpYWJsZURlY2xhcmF0
aW9uRnJhZ21lbnQ7CisJfQorCisJcHJvdGVjdGVkIHZvaWQgc2V0RXh0cmFBbm5vdGF0ZWREaW1l
bnNpb25zKGludCBzdGFydCwgaW50IGVuZCwgVHlwZVJlZmVyZW5jZSB0eXBlLCBmaW5hbCBMaXN0
IGV4dHJhQW5ub3RhdGVkRGltZW5zaW9ucywgaW50IGV4dHJhRGltZW5zaW9uKSB7CisJCWlmIChl
eHRyYURpbWVuc2lvbiA+IDApIHsKKwkJCW9yZy5lY2xpcHNlLmpkdC5pbnRlcm5hbC5jb21waWxl
ci5hc3QuQW5ub3RhdGlvbltdW10gYW5ub3RhdGlvbnNPbkRpbXMgPSB0eXBlLmdldEFubm90YXRp
b25zT25EaW1lbnNpb25zKCk7CisJCQlpbnQgbGVuZ3RoID0gKGFubm90YXRpb25zT25EaW1zID09
IG51bGwpID8gMCA6IGFubm90YXRpb25zT25EaW1zLmxlbmd0aDsKKwkJCWZvciAoaW50IGkgPSAo
bGVuZ3RoIC0gZXh0cmFEaW1lbnNpb24pOyBpIDwgbGVuZ3RoOyBpKyspIHsKKwkJCQlEaW1lbnNp
b25UeXBlIGRpbSA9IGNvbnZlcnRUb0RpbWVuc2lvbihzdGFydCwgZW5kLCAoYW5ub3RhdGlvbnNP
bkRpbXMgPT0gbnVsbCkgPyBudWxsIDogYW5ub3RhdGlvbnNPbkRpbXNbaV0pOworCQkJCWV4dHJh
QW5ub3RhdGVkRGltZW5zaW9ucy5hZGQoZGltKTsKKwkJCQlzdGFydCA9IGRpbS5nZXRTdGFydFBv
c2l0aW9uKCkgKyBkaW0uZ2V0TGVuZ3RoKCk7CisJCQl9CisJCX0KIAl9CiAKQEAgLTMxMTYsNSAr
MzE1Nyw1IEBACiAJCX0KIAl9Ci0KKwkKIAlwdWJsaWMgVHlwZSBjb252ZXJ0VHlwZShUeXBlUmVm
ZXJlbmNlIHR5cGVSZWZlcmVuY2UpIHsKIAkJb3JnLmVjbGlwc2UuamR0LmludGVybmFsLmNvbXBp
bGVyLmFzdC5Bbm5vdGF0aW9uW10gYW5ub3RhdGlvbnM7CkBAIC00MjI2LDQgKzQyNjcsNSBAQAog
CQl0cnkgewogCQkJaW50IHRva2VuOworCQkJYm9vbGVhbiBpc0Fubm90YXRpb24gPSBmYWxzZTsK
IAkJCXdoaWxlICgodG9rZW4gPSB0aGlzLnNjYW5uZXIuZ2V0TmV4dFRva2VuKCkpICE9IFRlcm1p
bmFsVG9rZW5zLlRva2VuTmFtZUVPRikgewogCQkJCXN3aXRjaCh0b2tlbikgewpAQCAtNDIzMiw2
ICs0Mjc0LDE3IEBACiAJCQkJCWNhc2UgVGVybWluYWxUb2tlbnMuVG9rZW5OYW1lQ09NTUVOVF9K
QVZBRE9DOgogCQkJCQljYXNlIFRlcm1pbmFsVG9rZW5zLlRva2VuTmFtZUNPTU1FTlRfTElORToK
KwkJCQkJCWlzQW5ub3RhdGlvbiA9IGZhbHNlOworCQkJCQkJYnJlYWs7CisJCQkJCWNhc2UgVGVy
bWluYWxUb2tlbnMuVG9rZW5OYW1lQVQ6CisJCQkJCQlpc0Fubm90YXRpb24gPSB0cnVlOworCQkJ
CQkJYnJlYWs7CisJCQkJCWNhc2UgVGVybWluYWxUb2tlbnMuVG9rZW5OYW1lSWRlbnRpZmllcjoK
KwkJCQkJCWlmICghaXNBbm5vdGF0aW9uKSB7CisJCQkJCQkJcmV0dXJuIGRpbWVuc2lvbnM7CisJ
CQkJCQl9CisJCQkJCQlpc0Fubm90YXRpb24gPSBmYWxzZTsKIAkJCQkJCWJyZWFrOwogCQkJCQlj
YXNlIFRlcm1pbmFsVG9rZW5zLlRva2VuTmFtZVJCUkFDS0VUOi8vMTY2CisJCQkJCQlpc0Fubm90
YXRpb24gPSBmYWxzZTsKIAkJCQkJCWRpbWVuc2lvbnMrKzsKIAkJCQkJCWJyZWFrOwpAQCAtNDI0
Niw0ICs0Mjk5LDE5IEBACiAJfQogCisJcHJvdGVjdGVkIHZvaWQgcmV0cmlldmVEaW1lbnNpb25B
bmRTZXRQb3NpdGlvbnMoaW50IHN0YXJ0LCBpbnQgZW5kLCBEaW1lbnNpb25UeXBlIGRpbSkgewor
CQl0aGlzLnNjYW5uZXIucmVzZXRUbyhzdGFydCwgZW5kKTsKKwkJaW50IHRva2VuOworCQl0cnkg
eworCQkJd2hpbGUoKHRva2VuID0gdGhpcy5zY2FubmVyLmdldE5leHRUb2tlbigpKSAhPSBUZXJt
aW5hbFRva2Vucy5Ub2tlbk5hbWVFT0YpICB7CisJCQkJaWYgKHRva2VuID09IFRlcm1pbmFsVG9r
ZW5zLlRva2VuTmFtZVJCUkFDS0VUKSB7CisJCQkJCWludCBlbmREaW0gPSB0aGlzLnNjYW5uZXIu
Y3VycmVudFBvc2l0aW9uIC0gMTsKKwkJCQkJZGltLnNldFNvdXJjZVJhbmdlKHN0YXJ0LCBlbmRE
aW0gLSBzdGFydCArIDEpOworCQkJCQlyZXR1cm47CisJCQkJfQorCQkJfQorCQl9IGNhdGNoKElu
dmFsaWRJbnB1dEV4Y2VwdGlvbiBlKSB7CisJCQkvLyBpZ25vcmUKKwkJfQorCX0KIAlwcm90ZWN0
ZWQgdm9pZCByZXRyaWV2ZUlkZW50aWZpZXJBbmRTZXRQb3NpdGlvbnMoaW50IHN0YXJ0LCBpbnQg
ZW5kLCBOYW1lIG5hbWUpIHsKIAkJdGhpcy5zY2FubmVyLnJlc2V0VG8oc3RhcnQsIGVuZCk7CkBA
IC01MTQ5LDQgKzUyMTcsNSBAQAogCQkJaWYgKHR5cGUuaXNBcnJheVR5cGUoKSkgewogCQkJCUFy
cmF5VHlwZSBhcnJheVR5cGUgPSAoQXJyYXlUeXBlKSB0eXBlOworCQkJCQogCQkJCWludCByZW1h
aW5pbmdEaW1lbnNpb25zID0gYXJyYXlUeXBlLmdldERpbWVuc2lvbnMoKSAtIGV4dHJhRGltZW5z
aW9uOwogCQkJCWlmIChyZW1haW5pbmdEaW1lbnNpb25zID09IDApICB7CkBAIC01MTgzLDUgKzUy
NTIsNSBAQAogCQkJCQkJZGVmYXVsdCA6CiAJCQkJCQkJbWV0aG9kRGVjbGFyYXRpb24uc2V0UmV0
dXJuVHlwZTIoc3ViYXJyYXlUeXBlKTsKLQkJCQkJCWJyZWFrOworCQkJCQkJCWJyZWFrOwogCQkJ
CQl9CiAJCQkJCXRoaXMuYXN0LmdldEJpbmRpbmdSZXNvbHZlcigpLnVwZGF0ZUtleSh0eXBlLCBz
dWJhcnJheVR5cGUpOwpkaWZmIC0tZ2l0IGEvb3JnLmVjbGlwc2UuamR0LmNvcmUvZG9tL29yZy9l
Y2xpcHNlL2pkdC9jb3JlL2RvbS9BU1RNYXRjaGVyLmphdmEgYi9vcmcuZWNsaXBzZS5qZHQuY29y
ZS9kb20vb3JnL2VjbGlwc2UvamR0L2NvcmUvZG9tL0FTVE1hdGNoZXIuamF2YQppbmRleCAxNjcx
NDg3Li5iOWFhNmIwIDEwMDY0NAotLS0gYS9vcmcuZWNsaXBzZS5qZHQuY29yZS9kb20vb3JnL2Vj
bGlwc2UvamR0L2NvcmUvZG9tL0FTVE1hdGNoZXIuamF2YQorKysgYi9vcmcuZWNsaXBzZS5qZHQu
Y29yZS9kb20vb3JnL2VjbGlwc2UvamR0L2NvcmUvZG9tL0FTVE1hdGNoZXIuamF2YQpAQCAtMzQz
LDQgKzM0MywyNyBAQAogCiAJLyoqCisJICogQHNpbmNlIDMuOQorCSAqLworCXB1YmxpYyBib29s
ZWFuIG1hdGNoKEFubm90YXRpb25bXSBmaXJzdCwgQW5ub3RhdGlvbltdIHNlY29uZCkgeworCQlp
ZiAoZmlyc3QubGVuZ3RoICE9IHNlY29uZC5sZW5ndGgpCisJCQlyZXR1cm4gZmFsc2U7CisJCWZv
ciAoaW50IGkgPSAwOyBpIDwgZmlyc3QubGVuZ3RoOyBpKyspIHsKKwkJCWlmICghc2FmZUVxdWFs
cyhmaXJzdFtpXSwgc2Vjb25kW2ldKSkKKwkJCQlyZXR1cm4gZmFsc2U7CisJCX0KKwkJcmV0dXJu
IHRydWU7CisJfQorCisJLyoqCisJICogQHNpbmNlIDMuOQorCSAqLworCXB1YmxpYyBib29sZWFu
IG1hdGNoKERpbWVuc2lvblR5cGUgbm9kZSwgT2JqZWN0IG90aGVyKSB7CisJCWlmICghKG90aGVy
IGluc3RhbmNlb2YgRGltZW5zaW9uVHlwZSkpCisJCQlyZXR1cm4gZmFsc2U7CisJCURpbWVuc2lv
blR5cGUgbyA9IChEaW1lbnNpb25UeXBlKSBvdGhlcjsKKwkJcmV0dXJuIHNhZmVTdWJ0cmVlTGlz
dE1hdGNoKG5vZGUuYW5ub3RhdGlvbnMoKSwgby5hbm5vdGF0aW9ucygpKTsKKwl9CisKKwkvKioK
IAkgKiBSZXR1cm5zIHdoZXRoZXIgdGhlIGdpdmVuIG5vZGUgYW5kIHRoZSBvdGhlciBvYmplY3Qg
bWF0Y2guCiAJICogPHA+CkBAIC0xMzk3LDUgKzE0MjAsNSBAQAogCQkJCS8vIG4uYi4gY29tcGFy
ZSByZXR1cm4gdHlwZSBldmVuIGZvciBjb25zdHJ1Y3RvcnMKIAkJCQkmJiBzYWZlU3VidHJlZUxp
c3RNYXRjaChub2RlLnBhcmFtZXRlcnMoKSwgby5wYXJhbWV0ZXJzKCkpCi0JIAkJCSYmIG5vZGUu
Z2V0RXh0cmFEaW1lbnNpb25zKCkgPT0gby5nZXRFeHRyYURpbWVuc2lvbnMoKQorCQkJCSYmICgo
bm9kZS5nZXRBU1QoKS5hcGlMZXZlbCA8IEFTVC5KTFM4KSA/IChub2RlLmdldEV4dHJhRGltZW5z
aW9ucygpID09IG8uZ2V0RXh0cmFEaW1lbnNpb25zKCkpIDogc2FmZVN1YnRyZWVMaXN0TWF0Y2go
bm9kZS5nZXRFeHRyYUFubm90YXRlZERpbWVuc2lvbnMoKSwgby5nZXRFeHRyYUFubm90YXRlZERp
bWVuc2lvbnMoKSkpCQkJCQogCQkJCSYmIHNhZmVTdWJ0cmVlTGlzdE1hdGNoKG5vZGUudGhyb3du
RXhjZXB0aW9ucygpLCBvLnRocm93bkV4Y2VwdGlvbnMoKSkKIAkJCQkmJiBzYWZlU3VidHJlZU1h
dGNoKG5vZGUuZ2V0Qm9keSgpLCBvLmdldEJvZHkoKSkpOwpAQCAtMTg5MCw2ICsxOTEzLDYgQEAK
IAkJICAgIHNhZmVTdWJ0cmVlTWF0Y2gobm9kZS5nZXRUeXBlKCksIG8uZ2V0VHlwZSgpKQogCQkJ
CSYmIHNhZmVTdWJ0cmVlTWF0Y2gobm9kZS5nZXROYW1lKCksIG8uZ2V0TmFtZSgpKQotCSAJCQkm
JiBub2RlLmdldEV4dHJhRGltZW5zaW9ucygpID09IG8uZ2V0RXh0cmFEaW1lbnNpb25zKCkKLQkJ
CQkmJiBzYWZlU3VidHJlZU1hdGNoKG5vZGUuZ2V0SW5pdGlhbGl6ZXIoKSwgby5nZXRJbml0aWFs
aXplcigpKTsKKwkJCSYmICgobm9kZS5nZXRBU1QoKS5hcGlMZXZlbCA8IEFTVC5KTFM4KSA/IChu
b2RlLmdldEV4dHJhRGltZW5zaW9ucygpID09IG8uZ2V0RXh0cmFEaW1lbnNpb25zKCkpIDogc2Fm
ZVN1YnRyZWVMaXN0TWF0Y2gobm9kZS5nZXRFeHRyYUFubm90YXRlZERpbWVuc2lvbnMoKSwgby5n
ZXRFeHRyYUFubm90YXRlZERpbWVuc2lvbnMoKSkpCisJCQkmJiBzYWZlU3VidHJlZU1hdGNoKG5v
ZGUuZ2V0SW5pdGlhbGl6ZXIoKSwgby5nZXRJbml0aWFsaXplcigpKTsKIAl9CiAKQEAgLTIzODIs
NSArMjQwNSw1IEBACiAJCVZhcmlhYmxlRGVjbGFyYXRpb25GcmFnbWVudCBvID0gKFZhcmlhYmxl
RGVjbGFyYXRpb25GcmFnbWVudCkgb3RoZXI7CiAJCXJldHVybiBzYWZlU3VidHJlZU1hdGNoKG5v
ZGUuZ2V0TmFtZSgpLCBvLmdldE5hbWUoKSkKLQkJCSYmIG5vZGUuZ2V0RXh0cmFEaW1lbnNpb25z
KCkgPT0gby5nZXRFeHRyYURpbWVuc2lvbnMoKQorCQkJJiYgKChub2RlLmdldEFTVCgpLmFwaUxl
dmVsIDwgQVNULkpMUzgpID8gKG5vZGUuZ2V0RXh0cmFEaW1lbnNpb25zKCkgPT0gby5nZXRFeHRy
YURpbWVuc2lvbnMoKSkgOiBzYWZlU3VidHJlZUxpc3RNYXRjaChub2RlLmdldEV4dHJhQW5ub3Rh
dGVkRGltZW5zaW9ucygpLCBvLmdldEV4dHJhQW5ub3RhdGVkRGltZW5zaW9ucygpKSkKIAkJCSYm
IHNhZmVTdWJ0cmVlTWF0Y2gobm9kZS5nZXRJbml0aWFsaXplcigpLCBvLmdldEluaXRpYWxpemVy
KCkpOwogCX0KZGlmZiAtLWdpdCBhL29yZy5lY2xpcHNlLmpkdC5jb3JlL2RvbS9vcmcvZWNsaXBz
ZS9qZHQvY29yZS9kb20vQVNUTm9kZS5qYXZhIGIvb3JnLmVjbGlwc2UuamR0LmNvcmUvZG9tL29y
Zy9lY2xpcHNlL2pkdC9jb3JlL2RvbS9BU1ROb2RlLmphdmEKaW5kZXggNjdhNjQxYS4uMWJmYWY2
ZSAxMDA2NDQKLS0tIGEvb3JnLmVjbGlwc2UuamR0LmNvcmUvZG9tL29yZy9lY2xpcHNlL2pkdC9j
b3JlL2RvbS9BU1ROb2RlLmphdmEKKysrIGIvb3JnLmVjbGlwc2UuamR0LmNvcmUvZG9tL29yZy9l
Y2xpcHNlL2pkdC9jb3JlL2RvbS9BU1ROb2RlLmphdmEKQEAgLTc3Miw0ICs3NzIsMTMgQEAKIAkg
Ki8KIAlwdWJsaWMgc3RhdGljIGZpbmFsIGludCBVTklPTl9UWVBFID0gODQ7CisJCisJLyoqCisJ
ICogTm9kZSB0eXBlIGNvbnN0YW50IGluZGljYXRpbmcgYSBub2RlIG9mIHR5cGUKKwkgKiA8Y29k
ZT5EaW1lbnNpb248L2NvZGU+LgorCSAqIAorCSAqIEBzZWUgRGltZW5zaW9uVHlwZQorCSAqIEBz
aW5jZSAzLjkKKwkgKi8KKwlwdWJsaWMgc3RhdGljIGZpbmFsIGludCBESU1FTlNJT04gPSA4NTsK
IAogCS8qKgpkaWZmIC0tZ2l0IGEvb3JnLmVjbGlwc2UuamR0LmNvcmUvZG9tL29yZy9lY2xpcHNl
L2pkdC9jb3JlL2RvbS9BU1RWaXNpdG9yLmphdmEgYi9vcmcuZWNsaXBzZS5qZHQuY29yZS9kb20v
b3JnL2VjbGlwc2UvamR0L2NvcmUvZG9tL0FTVFZpc2l0b3IuamF2YQppbmRleCBiMjkzMDUzLi45
ZjA3YTI5IDEwMDY0NAotLS0gYS9vcmcuZWNsaXBzZS5qZHQuY29yZS9kb20vb3JnL2VjbGlwc2Uv
amR0L2NvcmUvZG9tL0FTVFZpc2l0b3IuamF2YQorKysgYi9vcmcuZWNsaXBzZS5qZHQuY29yZS9k
b20vb3JnL2VjbGlwc2UvamR0L2NvcmUvZG9tL0FTVFZpc2l0b3IuamF2YQpAQCAtMjAwLDQgKzIw
MCwxMCBAQAogCX0KIAorCS8qKgorCSAqIEBzaW5jZSAzLjkKKwkgKi8KKwlwdWJsaWMgYm9vbGVh
biB2aXNpdChEaW1lbnNpb25UeXBlIG5vZGUpIHsKKwkJcmV0dXJuIHRydWU7CisJfQogCiAJLyoq
CkBAIC0xNTkzLDQgKzE1OTksMTEgQEAKIAkJLy8gZGVmYXVsdCBpbXBsZW1lbnRhdGlvbjogZG8g
bm90aGluZwogCX0KKwkKKwkvKioKKwkgKiBAc2luY2UgMy45CisJICovCisJcHVibGljIHZvaWQg
ZW5kVmlzaXQoRGltZW5zaW9uVHlwZSBub2RlKSB7CisJCS8vIGRvIG5vdGhpbmcgYnkgZGVmYXVs
dAorCX0KIAogCS8qKgpkaWZmIC0tZ2l0IGEvb3JnLmVjbGlwc2UuamR0LmNvcmUvZG9tL29yZy9l
Y2xpcHNlL2pkdC9jb3JlL2RvbS9EaW1lbnNpb25UeXBlLmphdmEgYi9vcmcuZWNsaXBzZS5qZHQu
Y29yZS9kb20vb3JnL2VjbGlwc2UvamR0L2NvcmUvZG9tL0RpbWVuc2lvblR5cGUuamF2YQpuZXcg
ZmlsZSBtb2RlIDEwMDY0NAppbmRleCAwMDAwMDAwLi4yNjFkNzgyCi0tLSAvZGV2L251bGwKKysr
IGIvb3JnLmVjbGlwc2UuamR0LmNvcmUvZG9tL29yZy9lY2xpcHNlL2pkdC9jb3JlL2RvbS9EaW1l
bnNpb25UeXBlLmphdmEKQEAgLTAsMCArMSwxMTYgQEAKK3BhY2thZ2Ugb3JnLmVjbGlwc2UuamR0
LmNvcmUuZG9tOworCitpbXBvcnQgamF2YS51dGlsLkFycmF5TGlzdDsKK2ltcG9ydCBqYXZhLnV0
aWwuTGlzdDsKKworLyoqCisgKiBAc2luY2UgMy45CisgKi8KK3B1YmxpYyBjbGFzcyBEaW1lbnNp
b25UeXBlIGV4dGVuZHMgQVNUTm9kZSB7CisKKwkKKwkvKioKKwkgKiBUaGUgImFubm90YXRpb25z
IiBzdHJ1Y3R1cmFsIHByb3BlcnR5IG9mIHRoaXMgbm9kZSB0eXBlIChjaGlsZCB0eXBlOiB7QGxp
bmsgQW5ub3RhdGlvbn0pLgorCSAqIEBzaW5jZSAzLjkKKwkgKi8KKwlwdWJsaWMgc3RhdGljIGZp
bmFsIENoaWxkTGlzdFByb3BlcnR5RGVzY3JpcHRvciBBTk5PVEFUSU9OU19QUk9QRVJUWSA9CisJ
CW5ldyBDaGlsZExpc3RQcm9wZXJ0eURlc2NyaXB0b3IoRGltZW5zaW9uVHlwZS5jbGFzcywgImFu
bm90YXRpb25zIiwgQW5ub3RhdGlvbi5jbGFzcywgTk9fQ1lDTEVfUklTSyk7IC8vJE5PTi1OTFMt
MSQKKwkKKwkvKioKKwkgKiBBIGxpc3Qgb2YgcHJvcGVydHkgZGVzY3JpcHRvcnMgKGVsZW1lbnQg
dHlwZToKKwkgKiB7QGxpbmsgU3RydWN0dXJhbFByb3BlcnR5RGVzY3JpcHRvcn0pLAorCSAqIG9y
IG51bGwgaWYgdW5pbml0aWFsaXplZC4KKwkgKiBAc2luY2UgMy45CisJICovCisJcHJpdmF0ZSBz
dGF0aWMgZmluYWwgTGlzdCBQUk9QRVJUWV9ERVNDUklQVE9SU184XzA7CisJCisJc3RhdGljIHsK
KwkJTGlzdCBwcm9wZXJ0eUxpc3QgPSBuZXcgQXJyYXlMaXN0KDIpOworCQljcmVhdGVQcm9wZXJ0
eUxpc3QoRGltZW5zaW9uVHlwZS5jbGFzcywgcHJvcGVydHlMaXN0KTsKKwkJYWRkUHJvcGVydHko
QU5OT1RBVElPTlNfUFJPUEVSVFksIHByb3BlcnR5TGlzdCk7CisJCVBST1BFUlRZX0RFU0NSSVBU
T1JTXzhfMCA9IHJlYXBQcm9wZXJ0eUxpc3QocHJvcGVydHlMaXN0KTsKKwl9CisJCisJLyoqCisJ
ICogUmV0dXJucyBhIGxpc3Qgb2Ygc3RydWN0dXJhbCBwcm9wZXJ0eSBkZXNjcmlwdG9ycyBmb3Ig
dGhpcyBub2RlIHR5cGUuCisJICogQ2xpZW50cyBtdXN0IG5vdCBtb2RpZnkgdGhlIHJlc3VsdC4K
KwkgKgorCSAqIEBwYXJhbSBhcGlMZXZlbCB0aGUgQVBJIGxldmVsOyBvbmUgb2YgdGhlCisJICog
PGNvZGU+QVNULkpMUyo8L2NvZGU+IGNvbnN0YW50cworCSAqIEByZXR1cm4gYSBsaXN0IG9mIHBy
b3BlcnR5IGRlc2NyaXB0b3JzIChlbGVtZW50IHR5cGU6CisJICoge0BsaW5rIFN0cnVjdHVyYWxQ
cm9wZXJ0eURlc2NyaXB0b3J9KQorCSAqIEBzaW5jZSAzLjAKKwkgKi8KKwlwdWJsaWMgc3RhdGlj
IExpc3QgcHJvcGVydHlEZXNjcmlwdG9ycyhpbnQgYXBpTGV2ZWwpIHsKKwkJcmV0dXJuIFBST1BF
UlRZX0RFU0NSSVBUT1JTXzhfMDsKKwl9CisJCisJcHVibGljIERpbWVuc2lvblR5cGUoQVNUIGFz
dCkgeworCQlzdXBlcihhc3QpOworCQlpZiAoYXN0LmFwaUxldmVsID49IEFTVC5KTFM4KSB7CisJ
CQl0aGlzLmFubm90YXRpb25zID0gbmV3IEFTVE5vZGUuTm9kZUxpc3QoQU5OT1RBVElPTlNfUFJP
UEVSVFkpOworCQl9CisJfQorCQorCS8qKgorCSAqIFRoZSB0eXBlIGFubm90YXRpb25zIChlbGVt
ZW50IHR5cGU6IHtAbGluayBBbm5vdGF0aW9ufSkuCisJICogQHNpbmNlIDMuOQorCSAqLworCXBy
b3RlY3RlZCBBU1ROb2RlLk5vZGVMaXN0IGFubm90YXRpb25zID0gbnVsbDsKKwkKKwkKKwlwdWJs
aWMgTGlzdCBhbm5vdGF0aW9ucygpIHsKKwkJcmV0dXJuIHRoaXMuYW5ub3RhdGlvbnM7CisJfQor
CQorCUxpc3QgaW50ZXJuYWxTdHJ1Y3R1cmFsUHJvcGVydGllc0ZvclR5cGUoaW50IGFwaUxldmVs
KSB7CisJCXJldHVybiBwcm9wZXJ0eURlc2NyaXB0b3JzKGFwaUxldmVsKTsKKwl9CisKKwkvKiAo
b21pdCBqYXZhZG9jIGZvciB0aGlzIG1ldGhvZCkKKwkgKiBNZXRob2QgZGVjbGFyZWQgb24gQVNU
Tm9kZS4KKwkgKi8KKwlmaW5hbCBMaXN0IGludGVybmFsR2V0Q2hpbGRMaXN0UHJvcGVydHkoQ2hp
bGRMaXN0UHJvcGVydHlEZXNjcmlwdG9yIHByb3BlcnR5KSB7CisJCWlmIChwcm9wZXJ0eSA9PSBB
Tk5PVEFUSU9OU19QUk9QRVJUWSkgeworCQkJcmV0dXJuIGFubm90YXRpb25zKCk7CisJCX0KKwkJ
Ly8gYWxsb3cgZGVmYXVsdCBpbXBsZW1lbnRhdGlvbiB0byBmbGFnIHRoZSBlcnJvcgorCQlyZXR1
cm4gc3VwZXIuaW50ZXJuYWxHZXRDaGlsZExpc3RQcm9wZXJ0eShwcm9wZXJ0eSk7CisJfQorCQor
CWludCBnZXROb2RlVHlwZTAoKSB7CisJCXJldHVybiBESU1FTlNJT047CisJfQorCisJYm9vbGVh
biBzdWJ0cmVlTWF0Y2gwKEFTVE1hdGNoZXIgbWF0Y2hlciwgT2JqZWN0IG90aGVyKSB7CisJCXJl
dHVybiBtYXRjaGVyLm1hdGNoKHRoaXMsIG90aGVyKTsKKwl9CisKKwlBU1ROb2RlIGNsb25lMChB
U1QgdGFyZ2V0KSB7CisJCURpbWVuc2lvblR5cGUgcmVzdWx0ID0gbmV3IERpbWVuc2lvblR5cGUo
dGFyZ2V0KTsKKwkJcmVzdWx0LmFubm90YXRpb25zID0gbmV3IEFTVE5vZGUuTm9kZUxpc3QoQU5O
T1RBVElPTlNfUFJPUEVSVFkpOworCQlyZXN1bHQuYW5ub3RhdGlvbnMuYWRkQWxsKAorCQkJCUFT
VE5vZGUuY29weVN1YnRyZWVzKHRhcmdldCwgYW5ub3RhdGlvbnMoKSkpOworCQlyZXR1cm4gcmVz
dWx0OworCX0KKworCXZvaWQgYWNjZXB0MChBU1RWaXNpdG9yIHZpc2l0b3IpIHsKKwkJYm9vbGVh
biB2aXNpdENoaWxkcmVuID0gdmlzaXRvci52aXNpdCh0aGlzKTsKKwkJaWYgKHZpc2l0Q2hpbGRy
ZW4pIHsKKwkJCWFjY2VwdENoaWxkcmVuKHZpc2l0b3IsIHRoaXMuYW5ub3RhdGlvbnMpOworCQl9
CisJCXZpc2l0b3IuZW5kVmlzaXQodGhpcyk7CisKKwl9CisKKwlpbnQgdHJlZVNpemUoKSB7CisJ
CS8vIFRPRE8gQXV0by1nZW5lcmF0ZWQgbWV0aG9kIHN0dWIKKwkJcmV0dXJuIDA7CisJfQorCisJ
aW50IG1lbVNpemUoKSB7CisJCS8vIFRPRE8gQXV0by1nZW5lcmF0ZWQgbWV0aG9kIHN0dWIKKwkJ
cmV0dXJuIDA7CisJfQorCit9CmRpZmYgLS1naXQgYS9vcmcuZWNsaXBzZS5qZHQuY29yZS9kb20v
b3JnL2VjbGlwc2UvamR0L2NvcmUvZG9tL01ldGhvZERlY2xhcmF0aW9uLmphdmEgYi9vcmcuZWNs
aXBzZS5qZHQuY29yZS9kb20vb3JnL2VjbGlwc2UvamR0L2NvcmUvZG9tL01ldGhvZERlY2xhcmF0
aW9uLmphdmEKaW5kZXggOTk1YmRlMC4uZWJiOGQ5YSAxMDA2NDQKLS0tIGEvb3JnLmVjbGlwc2Uu
amR0LmNvcmUvZG9tL29yZy9lY2xpcHNlL2pkdC9jb3JlL2RvbS9NZXRob2REZWNsYXJhdGlvbi5q
YXZhCisrKyBiL29yZy5lY2xpcHNlLmpkdC5jb3JlL2RvbS9vcmcvZWNsaXBzZS9qZHQvY29yZS9k
b20vTWV0aG9kRGVjbGFyYXRpb24uamF2YQpAQCAtMTQ2LDQgKzE0NiwxMSBAQAogCiAJLyoqCisJ
ICogVGhlICJleHRyYUFubm90YXRlZERpbWVuc2lvbnMiIHN0cnVjdHVyYWwgcHJvcGVydHkgb2Yg
dGhpcyBub2RlIHR5cGUgKGNoaWxkIHR5cGU6IHtAbGluayBEaW1lbnNpb25UeXBlfSkuCisJICog
QHNpbmNlIDMuOQorCSAqLworCXB1YmxpYyBzdGF0aWMgZmluYWwgQ2hpbGRMaXN0UHJvcGVydHlE
ZXNjcmlwdG9yIEVYVFJBX0FOTk9UQVRFRF9ESU1FTlNJT05TX1BST1BFUlRZID0KKwkJCW5ldyBD
aGlsZExpc3RQcm9wZXJ0eURlc2NyaXB0b3IoTWV0aG9kRGVjbGFyYXRpb24uY2xhc3MsICJleHRy
YUFubm90YXRlZERpbWVuc2lvbnMiLCBEaW1lbnNpb25UeXBlLmNsYXNzLCBOT19DWUNMRV9SSVNL
KTsgLy8kTk9OLU5MUy0xJAorCisJLyoqCiAJICogVGhlICJ0eXBlUGFyYW1ldGVycyIgc3RydWN0
dXJhbCBwcm9wZXJ0eSBvZiB0aGlzIG5vZGUgdHlwZSAoZWxlbWVudCB0eXBlOiB7QGxpbmsgVHlw
ZVBhcmFtZXRlcn0pIChhZGRlZCBpbiBKTFMzIEFQSSkuCiAJICogQHNpbmNlIDMuMQpAQCAtMjI4
LDQgKzIzNSw1IEBACiAJCWFkZEpMUzNQcm9wZXJ0aWVzKHByb3BlcnR5TGlzdCk7CiAJCWFkZFBy
b3BlcnR5KFJFQ0VJVkVSX1BST1BFUlRZLCBwcm9wZXJ0eUxpc3QpOworCQlhZGRQcm9wZXJ0eShF
WFRSQV9BTk5PVEFURURfRElNRU5TSU9OU19QUk9QRVJUWSwgcHJvcGVydHlMaXN0KTsKIAkJUFJP
UEVSVFlfREVTQ1JJUFRPUlNfOF8wID0gcmVhcFByb3BlcnR5TGlzdChwcm9wZXJ0eUxpc3QpOwog
CX0KQEAgLTMyMSw0ICszMjksMTEgQEAKIAogCS8qKgorCSAqIFRoZSBleHRyYSBkaW1lbnNpb24g
dHlwZXMgdGhpcyBub2RlIGhhcyB3aXRoIGFubm90YXRpb25zIGlmIGFueS4KKwkgKiAKKwkgKiBA
c2luY2UgMy45CisJICovCisJcHJvdGVjdGVkIEFTVE5vZGUuTm9kZUxpc3QgZXh0cmFBbm5vdGF0
ZWREaW1lbnNpb25zID0gbnVsbDsKKworCS8qKgogCSAqIFRoZSBsaXN0IG9mIHRocm93biBleGNl
cHRpb24gbmFtZXMgKGVsZW1lbnQgdHlwZToge0BsaW5rIE5hbWV9KS4KIAkgKiBEZWZhdWx0cyB0
byBhbiBlbXB0eSBsaXN0LgpAQCAtMzUyLDQgKzM2Nyw3IEBACiAJCWlmIChhc3QuYXBpTGV2ZWwg
Pj0gQVNULkpMUzNfSU5URVJOQUwpIHsKIAkJCXRoaXMudHlwZVBhcmFtZXRlcnMgPSBuZXcgQVNU
Tm9kZS5Ob2RlTGlzdChUWVBFX1BBUkFNRVRFUlNfUFJPUEVSVFkpOworCQl9IAorCQlpZiAoYXN0
LmFwaUxldmVsID49IEFTVC5KTFM4KSB7CisJCQl0aGlzLmV4dHJhQW5ub3RhdGVkRGltZW5zaW9u
cyA9IG5ldyBBU1ROb2RlLk5vZGVMaXN0KEVYVFJBX0FOTk9UQVRFRF9ESU1FTlNJT05TX1BST1BF
UlRZKTsKIAkJfQogCX0KQEAgLTQ3NCw0ICs0OTIsNyBAQAogCQkJcmV0dXJuIHRocm93bkV4Y2Vw
dGlvbnMoKTsKIAkJfQorCQlpZiAocHJvcGVydHkgPT0gRVhUUkFfQU5OT1RBVEVEX0RJTUVOU0lP
TlNfUFJPUEVSVFkpIHsKKwkJCXJldHVybiB0aGlzLmV4dHJhQW5ub3RhdGVkRGltZW5zaW9uczsK
KwkJfQogCQkvLyBhbGxvdyBkZWZhdWx0IGltcGxlbWVudGF0aW9uIHRvIGZsYWcgdGhlIGVycm9y
CiAJCXJldHVybiBzdXBlci5pbnRlcm5hbEdldENoaWxkTGlzdFByb3BlcnR5KHByb3BlcnR5KTsK
QEAgLTUzMSw0ICs1NTIsOSBAQAogCQlyZXN1bHQuc2V0Q29uc3RydWN0b3IoaXNDb25zdHJ1Y3Rv
cigpKTsKIAkJcmVzdWx0LnNldEV4dHJhRGltZW5zaW9ucyhnZXRFeHRyYURpbWVuc2lvbnMoKSk7
CisJCWlmICh0aGlzLmFzdC5hcGlMZXZlbCA+PSBBU1QuSkxTOCkgeworCQkJcmVzdWx0LmV4dHJh
QW5ub3RhdGVkRGltZW5zaW9ucyA9IG5ldyBBU1ROb2RlLk5vZGVMaXN0KEVYVFJBX0FOTk9UQVRF
RF9ESU1FTlNJT05TX1BST1BFUlRZKTsKKwkJCXJlc3VsdC5leHRyYUFubm90YXRlZERpbWVuc2lv
bnMuYWRkQWxsKAorCQkJCQlBU1ROb2RlLmNvcHlTdWJ0cmVlcyh0YXJnZXQsIHRoaXMuZXh0cmFB
bm5vdGF0ZWREaW1lbnNpb25zKSk7CisJCX0KIAkJcmVzdWx0LnNldE5hbWUoKFNpbXBsZU5hbWUp
IGdldE5hbWUoKS5jbG9uZSh0YXJnZXQpKTsKIAkJcmVzdWx0LnBhcmFtZXRlcnMoKS5hZGRBbGwo
CkBAIC01NzAsNCArNTk2LDcgQEAKIAkJCX0KIAkJCWFjY2VwdENoaWxkcmVuKHZpc2l0b3IsIHRo
aXMucGFyYW1ldGVycyk7CisJCQlpZiAodGhpcy5hc3QuYXBpTGV2ZWwgPj0gQVNULkpMUzgpIHsK
KwkJCQlhY2NlcHRDaGlsZHJlbih2aXNpdG9yLCB0aGlzLmV4dHJhQW5ub3RhdGVkRGltZW5zaW9u
cyk7CisJCQl9CiAJCQlhY2NlcHRDaGlsZHJlbih2aXNpdG9yLCB0aGlzLnRocm93bkV4Y2VwdGlv
bnMpOwogCQkJYWNjZXB0Q2hpbGQodmlzaXRvciwgZ2V0Qm9keSgpKTsKQEAgLTY3OCw1ICs3MDcs
NSBAQAogCSAqCiAJICogQHNpbmNlIDMuOQotCSAqIEBwYXJhbSByZWMgZXhwbGljaXQgcmVjZWl2
ZXIgcGFyYW1ldGVyIHRvIGJlIGFkZGVkIHRvIHRoZSBtZXRob2QgZGVjbGFyYXRpb24KKwkgKiBA
cGFyYW0gcmVjZWl2ZXIgZXhwbGljaXQgcmVjZWl2ZXIgcGFyYW1ldGVyIHRvIGJlIGFkZGVkIHRv
IHRoZSBtZXRob2QgZGVjbGFyYXRpb24KIAkgKi8KIAlwdWJsaWMgdm9pZCBzZXRSZWNlaXZlcihT
aW5nbGVWYXJpYWJsZURlY2xhcmF0aW9uIHJlY2VpdmVyKSB7CkBAIC05MjcsNCArOTU2LDE1IEBA
CiAKIAkvKioKKwkgKiBSZXR1cm5zIHRoZSBsaXZlIG9yZGVyZWQgbGlzdCBvZiBleHRyYSBkaW1l
bnNpb25zIHdpdGggYW5ub3RhdGlvbnMgaWYgYW55LgorCSAqIAorCSAqIEByZXR1cm4gdGhlIGxp
dmUgbGlzdCBvZiBleHRyYSBkaW1lbnNpb25zIHdpdGggYW5ub3RhdGlvbnMgaWYgYW55IChlbGVt
ZW50IHR5cGU6IHtAbGluayBEaW1lbnNpb25UeXBlfVtdKQorCSAqIEBzaW5jZSAzLjkKKwkgKi8K
KwlwdWJsaWMgTGlzdCBnZXRFeHRyYUFubm90YXRlZERpbWVuc2lvbnMoKSB7CisJCXVuc3VwcG9y
dGVkSW4yXzNfNCgpOworCQlyZXR1cm4gdGhpcy5leHRyYUFubm90YXRlZERpbWVuc2lvbnM7CisJ
fQorCisJLyoqCiAJICogUmV0dXJucyB0aGUgYm9keSBvZiB0aGlzIG1ldGhvZCBkZWNsYXJhdGlv
biwgb3IgPGNvZGU+bnVsbDwvY29kZT4gaWYKIAkgKiB0aGlzIG1ldGhvZCBoYXMgPGI+bm88L2I+
IGJvZHkuCmRpZmYgLS1naXQgYS9vcmcuZWNsaXBzZS5qZHQuY29yZS9kb20vb3JnL2VjbGlwc2Uv
amR0L2NvcmUvZG9tL1NpbmdsZVZhcmlhYmxlRGVjbGFyYXRpb24uamF2YSBiL29yZy5lY2xpcHNl
LmpkdC5jb3JlL2RvbS9vcmcvZWNsaXBzZS9qZHQvY29yZS9kb20vU2luZ2xlVmFyaWFibGVEZWNs
YXJhdGlvbi5qYXZhCmluZGV4IDQzNmFmMjEuLjAxYzIwNWIgMTAwNjQ0Ci0tLSBhL29yZy5lY2xp
cHNlLmpkdC5jb3JlL2RvbS9vcmcvZWNsaXBzZS9qZHQvY29yZS9kb20vU2luZ2xlVmFyaWFibGVE
ZWNsYXJhdGlvbi5qYXZhCisrKyBiL29yZy5lY2xpcHNlLmpkdC5jb3JlL2RvbS9vcmcvZWNsaXBz
ZS9qZHQvY29yZS9kb20vU2luZ2xlVmFyaWFibGVEZWNsYXJhdGlvbi5qYXZhCkBAIC04Miw0ICs4
MiwxMSBAQAogCiAJLyoqCisJICogVGhlICJleHRyYUFubm90YXRlZERpbWVuc2lvbnMiIHN0cnVj
dHVyYWwgcHJvcGVydHkgb2YgdGhpcyBub2RlIHR5cGUgKGNoaWxkIHR5cGU6IHtAbGluayBEaW1l
bnNpb25UeXBlfSkuCisJICogQHNpbmNlIDMuOQorCSAqLworCXB1YmxpYyBzdGF0aWMgZmluYWwg
Q2hpbGRMaXN0UHJvcGVydHlEZXNjcmlwdG9yIEVYVFJBX0FOTk9UQVRFRF9ESU1FTlNJT05TX1BS
T1BFUlRZID0KKwkJCW5ldyBDaGlsZExpc3RQcm9wZXJ0eURlc2NyaXB0b3IoU2luZ2xlVmFyaWFi
bGVEZWNsYXJhdGlvbi5jbGFzcywgImV4dHJhQW5ub3RhdGVkRGltZW5zaW9ucyIsIERpbWVuc2lv
blR5cGUuY2xhc3MsIE5PX0NZQ0xFX1JJU0spOyAvLyROT04tTkxTLTEkCisKKwkvKioKIAkgKiBU
aGUgImluaXRpYWxpemVyIiBzdHJ1Y3R1cmFsIHByb3BlcnR5IG9mIHRoaXMgbm9kZSB0eXBlIChj
aGlsZCB0eXBlOiB7QGxpbmsgRXhwcmVzc2lvbn0pLgogCSAqIEBzaW5jZSAzLjAKQEAgLTEwMyw0
ICsxMTAsMTIgQEAKIAkgKi8KIAlwcml2YXRlIHN0YXRpYyBmaW5hbCBMaXN0IFBST1BFUlRZX0RF
U0NSSVBUT1JTXzNfMDsKKwkKKwkvKioKKwkgKiBBIGxpc3Qgb2YgcHJvcGVydHkgZGVzY3JpcHRv
cnMgKGVsZW1lbnQgdHlwZToKKwkgKiB7QGxpbmsgU3RydWN0dXJhbFByb3BlcnR5RGVzY3JpcHRv
cn0pLAorCSAqIG9yIG51bGwgaWYgdW5pbml0aWFsaXplZC4KKwkgKiBAc2luY2UgMy45CisJICov
CisJcHJpdmF0ZSBzdGF0aWMgZmluYWwgTGlzdCBQUk9QRVJUWV9ERVNDUklQVE9SU184XzA7CiAK
IAlzdGF0aWMgewpAQCAtMTE2LDQgKzEzMSwxNSBAQAogCQlwcm9wZXJ0eUxpc3QgPSBuZXcgQXJy
YXlMaXN0KDcpOwogCQljcmVhdGVQcm9wZXJ0eUxpc3QoU2luZ2xlVmFyaWFibGVEZWNsYXJhdGlv
bi5jbGFzcywgcHJvcGVydHlMaXN0KTsKKwkJYWRkSkxTM1Byb3BlcnRpZXMocHJvcGVydHlMaXN0
KTsKKwkJUFJPUEVSVFlfREVTQ1JJUFRPUlNfM18wID0gcmVhcFByb3BlcnR5TGlzdChwcm9wZXJ0
eUxpc3QpOworCQkKKwkJcHJvcGVydHlMaXN0ID0gbmV3IEFycmF5TGlzdCg4KTsKKwkJY3JlYXRl
UHJvcGVydHlMaXN0KFNpbmdsZVZhcmlhYmxlRGVjbGFyYXRpb24uY2xhc3MsIHByb3BlcnR5TGlz
dCk7CisJCWFkZEpMUzNQcm9wZXJ0aWVzKHByb3BlcnR5TGlzdCk7CisJCWFkZFByb3BlcnR5KEVY
VFJBX0FOTk9UQVRFRF9ESU1FTlNJT05TX1BST1BFUlRZLCBwcm9wZXJ0eUxpc3QpOworCQlQUk9Q
RVJUWV9ERVNDUklQVE9SU184XzAgPSByZWFwUHJvcGVydHlMaXN0KHByb3BlcnR5TGlzdCk7CisJ
fQorCisJcHJpdmF0ZSBzdGF0aWMgdm9pZCBhZGRKTFMzUHJvcGVydGllcyhMaXN0IHByb3BlcnR5
TGlzdCkgewogCQlhZGRQcm9wZXJ0eShNT0RJRklFUlMyX1BST1BFUlRZLCBwcm9wZXJ0eUxpc3Qp
OwogCQlhZGRQcm9wZXJ0eShUWVBFX1BST1BFUlRZLCBwcm9wZXJ0eUxpc3QpOwpAQCAtMTIyLDUg
KzE0OCw0IEBACiAJCWFkZFByb3BlcnR5KEVYVFJBX0RJTUVOU0lPTlNfUFJPUEVSVFksIHByb3Bl
cnR5TGlzdCk7CiAJCWFkZFByb3BlcnR5KElOSVRJQUxJWkVSX1BST1BFUlRZLCBwcm9wZXJ0eUxp
c3QpOwotCQlQUk9QRVJUWV9ERVNDUklQVE9SU18zXzAgPSByZWFwUHJvcGVydHlMaXN0KHByb3Bl
cnR5TGlzdCk7CiAJfQogCkBAIC0xMzYsOCArMTYxLDEyIEBACiAJICovCiAJcHVibGljIHN0YXRp
YyBMaXN0IHByb3BlcnR5RGVzY3JpcHRvcnMoaW50IGFwaUxldmVsKSB7Ci0JCWlmIChhcGlMZXZl
bCA9PSBBU1QuSkxTMl9JTlRFUk5BTCkgewotCQkJcmV0dXJuIFBST1BFUlRZX0RFU0NSSVBUT1JT
XzJfMDsKLQkJfSBlbHNlIHsKLQkJCXJldHVybiBQUk9QRVJUWV9ERVNDUklQVE9SU18zXzA7CisJ
CXN3aXRjaCAoYXBpTGV2ZWwpIHsKKwkJCWNhc2UgQVNULkpMUzJfSU5URVJOQUw6CisJCQkJCXJl
dHVybiBQUk9QRVJUWV9ERVNDUklQVE9SU18yXzA7CisJCQljYXNlIEFTVC5KTFMzX0lOVEVSTkFM
OgorCQkJY2FzZSBBU1QuSkxTNDoKKwkJCQkJcmV0dXJuIFBST1BFUlRZX0RFU0NSSVBUT1JTXzNf
MDsKKwkJCWRlZmF1bHQ6CisJCQkJCXJldHVybiBQUk9QRVJUWV9ERVNDUklQVE9SU184XzA7CiAJ
CX0KIAl9CkBAIC0xODcsNCArMjE2LDExIEBACiAKIAkvKioKKwkgKiBUaGUgZXh0cmEgZGltZW5z
aW9uIHR5cGVzIHRoaXMgbm9kZSBoYXMgd2l0aCBhbm5vdGF0aW9ucyBpZiBhbnkuCisJICogCisJ
ICogQHNpbmNlIDMuOQorCSAqLworCXByb3RlY3RlZCBBU1ROb2RlLk5vZGVMaXN0IGV4dHJhQW5u
b3RhdGVkRGltZW5zaW9ucyA9IG51bGw7CisKKwkvKioKIAkgKiBUaGUgaW5pdGlhbGl6ZXIgZXhw
cmVzc2lvbiwgb3IgPGNvZGU+bnVsbDwvY29kZT4gaWYgbm9uZTsKIAkgKiBkZWZhdWx0cyB0byBu
b25lLgpAQCAtMjA3LDQgKzI0Myw3IEBACiAJCWlmIChhc3QuYXBpTGV2ZWwgPj0gQVNULkpMUzNf
SU5URVJOQUwpIHsKIAkJCXRoaXMubW9kaWZpZXJzID0gbmV3IEFTVE5vZGUuTm9kZUxpc3QoTU9E
SUZJRVJTMl9QUk9QRVJUWSk7CisJCX0gCisJCWlmIChhc3QuYXBpTGV2ZWwgPj0gQVNULkpMUzgp
IHsKKwkJCXRoaXMuZXh0cmFBbm5vdGF0ZWREaW1lbnNpb25zID0gbmV3IEFTVE5vZGUuTm9kZUxp
c3QoRVhUUkFfQU5OT1RBVEVEX0RJTUVOU0lPTlNfUFJPUEVSVFkpOwogCQl9CiAJfQpAQCAtMzIw
LDQgKzM1OSw3IEBACiAJCQlyZXR1cm4gbW9kaWZpZXJzKCk7CiAJCX0KKwkJaWYgKHByb3BlcnR5
ID09IEVYVFJBX0FOTk9UQVRFRF9ESU1FTlNJT05TX1BST1BFUlRZKSB7CisJCQlyZXR1cm4gdGhp
cy5leHRyYUFubm90YXRlZERpbWVuc2lvbnM7CisJCX0KIAkJLy8gYWxsb3cgZGVmYXVsdCBpbXBs
ZW1lbnRhdGlvbiB0byBmbGFnIHRoZSBlcnJvcgogCQlyZXR1cm4gc3VwZXIuaW50ZXJuYWxHZXRD
aGlsZExpc3RQcm9wZXJ0eShwcm9wZXJ0eSk7CkBAIC0zNDUsNCArMzg3LDkgQEAKIAkJcmVzdWx0
LnNldFR5cGUoKFR5cGUpIGdldFR5cGUoKS5jbG9uZSh0YXJnZXQpKTsKIAkJcmVzdWx0LnNldEV4
dHJhRGltZW5zaW9ucyhnZXRFeHRyYURpbWVuc2lvbnMoKSk7CisJCWlmICh0aGlzLmFzdC5hcGlM
ZXZlbCA+PSBBU1QuSkxTOCkgeworCQkJcmVzdWx0LmV4dHJhQW5ub3RhdGVkRGltZW5zaW9ucyA9
IG5ldyBBU1ROb2RlLk5vZGVMaXN0KEVYVFJBX0FOTk9UQVRFRF9ESU1FTlNJT05TX1BST1BFUlRZ
KTsKKwkJCXJlc3VsdC5leHRyYUFubm90YXRlZERpbWVuc2lvbnMuYWRkQWxsKAorCQkJCQlBU1RO
b2RlLmNvcHlTdWJ0cmVlcyh0YXJnZXQsIHRoaXMuZXh0cmFBbm5vdGF0ZWREaW1lbnNpb25zKSk7
CisJCX0KIAkJcmVzdWx0LnNldE5hbWUoKFNpbXBsZU5hbWUpIGdldE5hbWUoKS5jbG9uZSh0YXJn
ZXQpKTsKIAkJcmVzdWx0LnNldEluaXRpYWxpemVyKApAQCAtMzcxLDQgKzQxOCw3IEBACiAJCQlh
Y2NlcHRDaGlsZCh2aXNpdG9yLCBnZXRUeXBlKCkpOwogCQkJYWNjZXB0Q2hpbGQodmlzaXRvciwg
Z2V0TmFtZSgpKTsKKwkJCWlmICh0aGlzLmFzdC5hcGlMZXZlbCA+PSBBU1QuSkxTOCkgeworCQkJ
CWFjY2VwdENoaWxkcmVuKHZpc2l0b3IsIHRoaXMuZXh0cmFBbm5vdGF0ZWREaW1lbnNpb25zKTsK
KwkJCX0KIAkJCWFjY2VwdENoaWxkKHZpc2l0b3IsIGdldEluaXRpYWxpemVyKCkpOwogCQl9CkBA
IC01OTYsNCArNjQ2LDE2IEBACiAJfQogCisJLyoqCisJICogUmV0dXJucyB0aGUgbGl2ZSBvcmRl
cmVkIGxpc3Qgb2YgZXh0cmEgZGltZW5zaW9ucyB3aXRoIGFubm90YXRpb25zIGlmIGFueS4KKwkg
KiAKKwkgKiBAcmV0dXJuIHRoZSBsaXZlIGxpc3Qgb2YgZXh0cmEgZGltZW5zaW9ucyB3aXRoIGFu
bm90YXRpb25zIGlmIGFueSAoZWxlbWVudCB0eXBlOiB7QGxpbmsgRGltZW5zaW9uVHlwZX1bXSkK
KwkgKiBAc2luY2UgMy45CisJICovCisJcHVibGljIExpc3QgZ2V0RXh0cmFBbm5vdGF0ZWREaW1l
bnNpb25zKCkgeworCQl1bnN1cHBvcnRlZEluMl8zXzQoKTsKKwkJcmV0dXJuIHRoaXMuZXh0cmFB
bm5vdGF0ZWREaW1lbnNpb25zOworCX0KKwkKKwkKIAkvKiAob21pdCBqYXZhZG9jIGZvciB0aGlz
IG1ldGhvZCkKIAkgKiBNZXRob2QgZGVjbGFyZWQgb24gVmFyaWFibGVEZWNsYXJhdGlvbi4KZGlm
ZiAtLWdpdCBhL29yZy5lY2xpcHNlLmpkdC5jb3JlL2RvbS9vcmcvZWNsaXBzZS9qZHQvY29yZS9k
b20vVmFyaWFibGVEZWNsYXJhdGlvbkZyYWdtZW50LmphdmEgYi9vcmcuZWNsaXBzZS5qZHQuY29y
ZS9kb20vb3JnL2VjbGlwc2UvamR0L2NvcmUvZG9tL1ZhcmlhYmxlRGVjbGFyYXRpb25GcmFnbWVu
dC5qYXZhCmluZGV4IGU5ZGU3YzguLjFmYTk5NWMgMTAwNjQ0Ci0tLSBhL29yZy5lY2xpcHNlLmpk
dC5jb3JlL2RvbS9vcmcvZWNsaXBzZS9qZHQvY29yZS9kb20vVmFyaWFibGVEZWNsYXJhdGlvbkZy
YWdtZW50LmphdmEKKysrIGIvb3JnLmVjbGlwc2UuamR0LmNvcmUvZG9tL29yZy9lY2xpcHNlL2pk
dC9jb3JlL2RvbS9WYXJpYWJsZURlY2xhcmF0aW9uRnJhZ21lbnQuamF2YQpAQCAtNDcsNCArNDcs
MTEgQEAKIAogCS8qKgorCSAqIFRoZSAiZXh0cmFBbm5vdGF0ZWREaW1lbnNpb25zIiBzdHJ1Y3R1
cmFsIHByb3BlcnR5IG9mIHRoaXMgbm9kZSB0eXBlIChjaGlsZCB0eXBlOiB7QGxpbmsgRGltZW5z
aW9uVHlwZX0pLgorCSAqIEBzaW5jZSAzLjkKKwkgKi8KKwlwdWJsaWMgc3RhdGljIGZpbmFsIENo
aWxkTGlzdFByb3BlcnR5RGVzY3JpcHRvciBFWFRSQV9BTk5PVEFURURfRElNRU5TSU9OU19QUk9Q
RVJUWSA9CisJCQluZXcgQ2hpbGRMaXN0UHJvcGVydHlEZXNjcmlwdG9yKFZhcmlhYmxlRGVjbGFy
YXRpb25GcmFnbWVudC5jbGFzcywgImV4dHJhQW5ub3RhdGVkRGltZW5zaW9ucyIsIERpbWVuc2lv
blR5cGUuY2xhc3MsIE5PX0NZQ0xFX1JJU0spOyAvLyROT04tTkxTLTEkCisKKwkvKioKIAkgKiBU
aGUgImluaXRpYWxpemVyIiBzdHJ1Y3R1cmFsIHByb3BlcnR5IG9mIHRoaXMgbm9kZSB0eXBlIChj
aGlsZCB0eXBlOiB7QGxpbmsgRXhwcmVzc2lvbn0pLgogCSAqIEBzaW5jZSAzLjAKQEAgLTYwLDEy
ICs2NywzMCBAQAogCSAqLwogCXByaXZhdGUgc3RhdGljIGZpbmFsIExpc3QgUFJPUEVSVFlfREVT
Q1JJUFRPUlM7CisJCisJLyoqCisJICogQSBsaXN0IG9mIHByb3BlcnR5IGRlc2NyaXB0b3JzIChl
bGVtZW50IHR5cGU6CisJICoge0BsaW5rIFN0cnVjdHVyYWxQcm9wZXJ0eURlc2NyaXB0b3J9KSwK
KwkgKiBvciBudWxsIGlmIHVuaW5pdGlhbGl6ZWQuCisJICogQHNpbmNlIDMuOQorCSAqLworCXBy
aXZhdGUgc3RhdGljIGZpbmFsIExpc3QgUFJPUEVSVFlfREVTQ1JJUFRPUlNfOF8wOwogCiAJc3Rh
dGljIHsKIAkJTGlzdCBwcm9wZXJ0eUxpc3QgPSBuZXcgQXJyYXlMaXN0KDQpOwogCQljcmVhdGVQ
cm9wZXJ0eUxpc3QoVmFyaWFibGVEZWNsYXJhdGlvbkZyYWdtZW50LmNsYXNzLCBwcm9wZXJ0eUxp
c3QpOworCQlhZGRKTFMzUHJvcGVydGllcyhwcm9wZXJ0eUxpc3QpOworCQlQUk9QRVJUWV9ERVND
UklQVE9SUyA9IHJlYXBQcm9wZXJ0eUxpc3QocHJvcGVydHlMaXN0KTsKKwkJCisJCXByb3BlcnR5
TGlzdCA9IG5ldyBBcnJheUxpc3QoNSk7CisJCWNyZWF0ZVByb3BlcnR5TGlzdChWYXJpYWJsZURl
Y2xhcmF0aW9uRnJhZ21lbnQuY2xhc3MsIHByb3BlcnR5TGlzdCk7CisJCWFkZEpMUzNQcm9wZXJ0
aWVzKHByb3BlcnR5TGlzdCk7CisJCWFkZFByb3BlcnR5KEVYVFJBX0FOTk9UQVRFRF9ESU1FTlNJ
T05TX1BST1BFUlRZLCBwcm9wZXJ0eUxpc3QpOworCQlQUk9QRVJUWV9ERVNDUklQVE9SU184XzAg
PSByZWFwUHJvcGVydHlMaXN0KHByb3BlcnR5TGlzdCk7CisJfQorCisJcHJpdmF0ZSBzdGF0aWMg
dm9pZCBhZGRKTFMzUHJvcGVydGllcyhMaXN0IHByb3BlcnR5TGlzdCkgewogCQlhZGRQcm9wZXJ0
eShOQU1FX1BST1BFUlRZLCBwcm9wZXJ0eUxpc3QpOwogCQlhZGRQcm9wZXJ0eShFWFRSQV9ESU1F
TlNJT05TX1BST1BFUlRZLCBwcm9wZXJ0eUxpc3QpOwogCQlhZGRQcm9wZXJ0eShJTklUSUFMSVpF
Ul9QUk9QRVJUWSwgcHJvcGVydHlMaXN0KTsKLQkJUFJPUEVSVFlfREVTQ1JJUFRPUlMgPSByZWFw
UHJvcGVydHlMaXN0KHByb3BlcnR5TGlzdCk7CiAJfQogCkBAIC04MSw1ICsxMDYsOSBAQAogCSAq
LwogCXB1YmxpYyBzdGF0aWMgTGlzdCBwcm9wZXJ0eURlc2NyaXB0b3JzKGludCBhcGlMZXZlbCkg
ewotCQlyZXR1cm4gUFJPUEVSVFlfREVTQ1JJUFRPUlM7CisJCWlmIChhcGlMZXZlbCA+PSBBU1Qu
SkxTOCkgeworCQkJcmV0dXJuIFBST1BFUlRZX0RFU0NSSVBUT1JTXzhfMDsKKwkJfSBlbHNlIHsK
KwkJCXJldHVybiBQUk9QRVJUWV9ERVNDUklQVE9SUzsKKwkJfQogCX0KIApAQCAtOTUsNCArMTI0
LDExIEBACiAJICovCiAJcHJpdmF0ZSBpbnQgZXh0cmFBcnJheURpbWVuc2lvbnMgPSAwOworCQor
CS8qKgorCSAqIFRoZSBleHRyYSBkaW1lbnNpb24gdHlwZXMgdGhpcyBub2RlIGhhcyB3aXRoIGFu
bm90YXRpb25zIGlmIGFueS4KKwkgKiAKKwkgKiBAc2luY2UgMy45CisJICovCisJcHJvdGVjdGVk
IEFTVE5vZGUuTm9kZUxpc3QgZXh0cmFBbm5vdGF0ZWREaW1lbnNpb25zID0gbnVsbDsKIAogCS8q
KgpAQCAtMTE0LDQgKzE1MCw3IEBACiAJVmFyaWFibGVEZWNsYXJhdGlvbkZyYWdtZW50KEFTVCBh
c3QpIHsKIAkJc3VwZXIoYXN0KTsKKwkJaWYgKGFzdC5hcGlMZXZlbCA+PSBBU1QuSkxTOCkgewor
CQkJdGhpcy5leHRyYUFubm90YXRlZERpbWVuc2lvbnMgPSBuZXcgQVNUTm9kZS5Ob2RlTGlzdChF
WFRSQV9BTk5PVEFURURfRElNRU5TSU9OU19QUk9QRVJUWSk7CisJCX0KIAl9CiAKQEAgLTE3NCw1
ICsyMTMsNSBAQAogCQkJCXJldHVybiBudWxsOwogCQkJfQotCQl9CisJCX0gCiAJCWlmIChwcm9w
ZXJ0eSA9PSBJTklUSUFMSVpFUl9QUk9QRVJUWSkgewogCQkJaWYgKGdldCkgewpAQCAtMTgyLDcg
KzIyMSwxOSBAQAogCQkJCXJldHVybiBudWxsOwogCQkJfQotCQl9CisJCX0gCisJCQogCQkvLyBh
bGxvdyBkZWZhdWx0IGltcGxlbWVudGF0aW9uIHRvIGZsYWcgdGhlIGVycm9yCiAJCXJldHVybiBz
dXBlci5pbnRlcm5hbEdldFNldENoaWxkUHJvcGVydHkocHJvcGVydHksIGdldCwgY2hpbGQpOwor
CX0KKworCS8qIChvbWl0IGphdmFkb2MgZm9yIHRoaXMgbWV0aG9kKQorCSAqIE1ldGhvZCBkZWNs
YXJlZCBvbiBBU1ROb2RlLgorCSAqLworCWZpbmFsIExpc3QgaW50ZXJuYWxHZXRDaGlsZExpc3RQ
cm9wZXJ0eShDaGlsZExpc3RQcm9wZXJ0eURlc2NyaXB0b3IgcHJvcGVydHkpIHsKKwkJaWYgKHBy
b3BlcnR5ID09IEVYVFJBX0FOTk9UQVRFRF9ESU1FTlNJT05TX1BST1BFUlRZKSB7CisJCQlyZXR1
cm4gdGhpcy5leHRyYUFubm90YXRlZERpbWVuc2lvbnM7CisJCX0KKwkJLy8gYWxsb3cgZGVmYXVs
dCBpbXBsZW1lbnRhdGlvbiB0byBmbGFnIHRoZSBlcnJvcgorCQlyZXR1cm4gc3VwZXIuaW50ZXJu
YWxHZXRDaGlsZExpc3RQcm9wZXJ0eShwcm9wZXJ0eSk7CiAJfQogCkBAIC0yMDIsNCArMjUzLDkg
QEAKIAkJcmVzdWx0LnNldE5hbWUoKFNpbXBsZU5hbWUpIGdldE5hbWUoKS5jbG9uZSh0YXJnZXQp
KTsKIAkJcmVzdWx0LnNldEV4dHJhRGltZW5zaW9ucyhnZXRFeHRyYURpbWVuc2lvbnMoKSk7CisJ
CWlmICh0aGlzLmFzdC5hcGlMZXZlbCA+PSBBU1QuSkxTOCkgeworCQkJcmVzdWx0LmV4dHJhQW5u
b3RhdGVkRGltZW5zaW9ucyA9IG5ldyBBU1ROb2RlLk5vZGVMaXN0KEVYVFJBX0FOTk9UQVRFRF9E
SU1FTlNJT05TX1BST1BFUlRZKTsKKwkJCXJlc3VsdC5leHRyYUFubm90YXRlZERpbWVuc2lvbnMu
YWRkQWxsKAorCQkJCQlBU1ROb2RlLmNvcHlTdWJ0cmVlcyh0YXJnZXQsIHRoaXMuZXh0cmFBbm5v
dGF0ZWREaW1lbnNpb25zKSk7CisJCX0KIAkJcmVzdWx0LnNldEluaXRpYWxpemVyKAogCQkJKEV4
cHJlc3Npb24pIEFTVE5vZGUuY29weVN1YnRyZWUodGFyZ2V0LCBnZXRJbml0aWFsaXplcigpKSk7
CkBAIC0yMjQsNCArMjgwLDggQEAKIAkJCWFjY2VwdENoaWxkKHZpc2l0b3IsIGdldE5hbWUoKSk7
CiAJCQlhY2NlcHRDaGlsZCh2aXNpdG9yLCBnZXRJbml0aWFsaXplcigpKTsKKwkJCQorCQkJaWYg
KHRoaXMuYXN0LmFwaUxldmVsID49IEFTVC5KTFM4KSB7CisJCQkJYWNjZXB0Q2hpbGRyZW4odmlz
aXRvciwgdGhpcy5leHRyYUFubm90YXRlZERpbWVuc2lvbnMpOworCQkJfQogCQl9CiAJCXZpc2l0
b3IuZW5kVmlzaXQodGhpcyk7CkBAIC0yOTcsNSArMzU3LDE2IEBACiAJCXBvc3RWYWx1ZUNoYW5n
ZShFWFRSQV9ESU1FTlNJT05TX1BST1BFUlRZKTsKIAl9Ci0KKwkKKwkvKioKKwkgKiBSZXR1cm5z
IHRoZSBsaXZlIG9yZGVyZWQgbGlzdCBvZiBleHRyYSBkaW1lbnNpb25zIHdpdGggYW5ub3RhdGlv
bnMgaWYgYW55LgorCSAqIAorCSAqIEByZXR1cm4gdGhlIGxpdmUgbGlzdCBvZiBleHRyYSBkaW1l
bnNpb25zIHdpdGggYW5ub3RhdGlvbnMgaWYgYW55IChlbGVtZW50IHR5cGU6IHtAbGluayBEaW1l
bnNpb25UeXBlfVtdKQorCSAqIEBzaW5jZSAzLjkKKwkgKi8KKwlwdWJsaWMgTGlzdCBnZXRFeHRy
YUFubm90YXRlZERpbWVuc2lvbnMoKSB7CisJCXVuc3VwcG9ydGVkSW4yXzNfNCgpOworCQlyZXR1
cm4gdGhpcy5leHRyYUFubm90YXRlZERpbWVuc2lvbnM7CisJfQorCQogCS8qIChvbWl0IGphdmFk
b2MgZm9yIHRoaXMgbWV0aG9kKQogCSAqIE1ldGhvZCBkZWNsYXJlZCBvbiBWYXJpYWJsZURlY2xh
cmF0aW9uLgpkaWZmIC0tZ2l0IGEvb3JnLmVjbGlwc2UuamR0LmNvcmUvZG9tL29yZy9lY2xpcHNl
L2pkdC9pbnRlcm5hbC9jb3JlL2RvbS9OYWl2ZUFTVEZsYXR0ZW5lci5qYXZhIGIvb3JnLmVjbGlw
c2UuamR0LmNvcmUvZG9tL29yZy9lY2xpcHNlL2pkdC9pbnRlcm5hbC9jb3JlL2RvbS9OYWl2ZUFT
VEZsYXR0ZW5lci5qYXZhCmluZGV4IDM2MDM0ZTguLmM3YWM3OGYgMTAwNjQ0Ci0tLSBhL29yZy5l
Y2xpcHNlLmpkdC5jb3JlL2RvbS9vcmcvZWNsaXBzZS9qZHQvaW50ZXJuYWwvY29yZS9kb20vTmFp
dmVBU1RGbGF0dGVuZXIuamF2YQorKysgYi9vcmcuZWNsaXBzZS5qZHQuY29yZS9kb20vb3JnL2Vj
bGlwc2UvamR0L2ludGVybmFsL2NvcmUvZG9tL05haXZlQVNURmxhdHRlbmVyLmphdmEKQEAgLTQ1
LDQgKzQ1LDUgQEAKIGltcG9ydCBvcmcuZWNsaXBzZS5qZHQuY29yZS5kb20uQ29uc3RydWN0b3JJ
bnZvY2F0aW9uOwogaW1wb3J0IG9yZy5lY2xpcHNlLmpkdC5jb3JlLmRvbS5Db250aW51ZVN0YXRl
bWVudDsKK2ltcG9ydCBvcmcuZWNsaXBzZS5qZHQuY29yZS5kb20uRGltZW5zaW9uVHlwZTsKIGlt
cG9ydCBvcmcuZWNsaXBzZS5qZHQuY29yZS5kb20uVW5pb25UeXBlOwogaW1wb3J0IG9yZy5lY2xp
cHNlLmpkdC5jb3JlLmRvbS5Eb1N0YXRlbWVudDsKQEAgLTQxMyw0ICs0MTQsMTAgQEAKIAkJdmlz
aXRUeXBlQW5ub3RhdGlvbnMobm9kZSk7CiAJCXRoaXMuYnVmZmVyLmFwcGVuZCgiW10iKTsvLyRO
T04tTkxTLTEkCisJCXJldHVybiBmYWxzZTsKKwl9CisKKwlwdWJsaWMgYm9vbGVhbiB2aXNpdChE
aW1lbnNpb25UeXBlIG5vZGUpIHsKKwkJdmlzaXRUeXBlQW5ub3RhdGlvbnMobm9kZSk7CisJCXRo
aXMuYnVmZmVyLmFwcGVuZCgiW10iKTsgLy8kTk9OLU5MUy0xJAogCQlyZXR1cm4gZmFsc2U7CiAJ
fQpAQCAtMTAzMCw2ICsxMDM3LDkgQEAKIAkJfQogCQl0aGlzLmJ1ZmZlci5hcHBlbmQoIikiKTsv
LyROT04tTkxTLTEkCi0JCWZvciAoaW50IGkgPSAwOyBpIDwgbm9kZS5nZXRFeHRyYURpbWVuc2lv
bnMoKTsgaSsrKSB7Ci0JCQl0aGlzLmJ1ZmZlci5hcHBlbmQoIltdIik7IC8vJE5PTi1OTFMtMSQK
KwkJaWYgKG5vZGUuZ2V0QVNUKCkuYXBpTGV2ZWwoKSA+PSBBU1QuSkxTOCkgeworCQkJTGlzdCBk
aW1lbnNpb25zID0gbm9kZS5nZXRFeHRyYUFubm90YXRlZERpbWVuc2lvbnMoKTsKKwkJCWZvciAo
aW50IGkgPSAwOyBpIDwgZGltZW5zaW9ucy5zaXplKCk7IGkrKykgeworCQkJCXZpc2l0KChEaW1l
bnNpb25UeXBlKSBkaW1lbnNpb25zLmdldChpKSk7CisJCQl9CiAJCX0KIAkJaWYgKCFub2RlLnRo
cm93bkV4Y2VwdGlvbnMoKS5pc0VtcHR5KCkpIHsKQEAgLTEzMzMsNiArMTM0Myw5IEBACiAJCXRo
aXMuYnVmZmVyLmFwcGVuZCgiICIpOy8vJE5PTi1OTFMtMSQKIAkJbm9kZS5nZXROYW1lKCkuYWNj
ZXB0KHRoaXMpOwotCQlmb3IgKGludCBpID0gMDsgaSA8IG5vZGUuZ2V0RXh0cmFEaW1lbnNpb25z
KCk7IGkrKykgewotCQkJdGhpcy5idWZmZXIuYXBwZW5kKCJbXSIpOyAvLyROT04tTkxTLTEkCisJ
CWlmIChub2RlLmdldEFTVCgpLmFwaUxldmVsKCkgPj0gQVNULkpMUzgpIHsKKwkJCUxpc3QgZGlt
ZW5zaW9ucyA9IG5vZGUuZ2V0RXh0cmFBbm5vdGF0ZWREaW1lbnNpb25zKCk7CisJCQlmb3IgKGlu
dCBpID0gMDsgaSA8IGRpbWVuc2lvbnMuc2l6ZSgpOyBpKyspIHsKKwkJCQl2aXNpdCgoRGltZW5z
aW9uVHlwZSkgZGltZW5zaW9ucy5nZXQoaSkpOworCQkJfQogCQl9CiAJCWlmIChub2RlLmdldElu
aXRpYWxpemVyKCkgIT0gbnVsbCkgewpAQCAtMTc1NCw2ICsxNzY3LDkgQEAKIAlwdWJsaWMgYm9v
bGVhbiB2aXNpdChWYXJpYWJsZURlY2xhcmF0aW9uRnJhZ21lbnQgbm9kZSkgewogCQlub2RlLmdl
dE5hbWUoKS5hY2NlcHQodGhpcyk7Ci0JCWZvciAoaW50IGkgPSAwOyBpIDwgbm9kZS5nZXRFeHRy
YURpbWVuc2lvbnMoKTsgaSsrKSB7Ci0JCQl0aGlzLmJ1ZmZlci5hcHBlbmQoIltdIik7Ly8kTk9O
LU5MUy0xJAorCQlpZiAobm9kZS5nZXRBU1QoKS5hcGlMZXZlbCgpID49IEFTVC5KTFM4KSB7CisJ
CQlMaXN0IGRpbWVuc2lvbnMgPSBub2RlLmdldEV4dHJhQW5ub3RhdGVkRGltZW5zaW9ucygpOwor
CQkJZm9yIChpbnQgaSA9IDA7IGkgPCBkaW1lbnNpb25zLnNpemUoKTsgaSsrKSB7CisJCQkJdmlz
aXQoKERpbWVuc2lvblR5cGUpIGRpbWVuc2lvbnMuZ2V0KGkpKTsKKwkJCX0KIAkJfQogCQlpZiAo
bm9kZS5nZXRJbml0aWFsaXplcigpICE9IG51bGwpIHsKQEAgLTE3NjIsNCArMTc3OCwxNCBAQAog
CQl9CiAJCXJldHVybiBmYWxzZTsKKwl9CisKKwlwcml2YXRlIHZvaWQgdmlzaXRFeHRyYURpbWVu
c2lvbnNUeXBlKEFycmF5VHlwZSB0eXBlLCBpbnQgZGltZW5zaW9uc0xlZnQpIHsKKwkJaWYgKGRp
bWVuc2lvbnNMZWZ0ID09IDApIHJldHVybjsKKwkJQXJyYXlUeXBlIHN1YmFycmF5VHlwZSA9IChB
cnJheVR5cGUpIHR5cGUuZ2V0Q29tcG9uZW50VHlwZSgpOworCQl2aXNpdEV4dHJhRGltZW5zaW9u
c1R5cGUoc3ViYXJyYXlUeXBlLCAtLWRpbWVuc2lvbnNMZWZ0KTsKKwkJaWYgKHR5cGUuZ2V0QVNU
KCkuYXBpTGV2ZWwoKSA+PSBBU1QuSkxTOCkgeworCQkJdmlzaXRUeXBlQW5ub3RhdGlvbnModHlw
ZSk7CisJCX0KKwkJdGhpcy5idWZmZXIuYXBwZW5kKCJbXSIpOy8vJE5PTi1OTFMtMSQKIAl9CiAK
QEAgLTE4MjEsNSArMTg0NywxOCBAQAogCQlpZiAobm9kZS5nZXRBU1QoKS5hcGlMZXZlbCgpID49
IEFTVC5KTFM4KSB7CiAJCQlMaXN0IGFubm90YXRpb25zID0gbm9kZS5hbm5vdGF0aW9ucygpOwot
CQkJaWYgKGFubm90YXRpb25zICE9IG51bGwpIHsKKwkJCWlmIChhbm5vdGF0aW9ucyAhPSBudWxs
ICYmIGFubm90YXRpb25zLnNpemUoKSA+IDApIHsKKwkJCQlmb3IgKEl0ZXJhdG9yIGl0ID0gYW5u
b3RhdGlvbnMuaXRlcmF0b3IoKTsgaXQuaGFzTmV4dCgpOyApIHsKKwkJCQkJQW5ub3RhdGlvbiBh
bm5vdGF0aW9uID0gKEFubm90YXRpb24pIGl0Lm5leHQoKTsKKwkJCQkJYW5ub3RhdGlvbi5hY2Nl
cHQodGhpcyk7CisJCQkJCXRoaXMuYnVmZmVyLmFwcGVuZCgnICcpOworCQkJCX0KKwkJCX0KKwkJ
fQorCX0KKwkvLyBUT0RPOiBUaGlzIGFuZCBhYm92ZSBtZXRob2QgY2FuIGJlIG1lcmdlZCB3aGVu
IERpbWVuc2lvbiBpcyBtYWRlIEFubm90YXRlZFR5cGUgCisJcHJpdmF0ZSB2b2lkIHZpc2l0VHlw
ZUFubm90YXRpb25zKERpbWVuc2lvblR5cGUgbm9kZSkgeworCQlpZiAobm9kZS5nZXRBU1QoKS5h
cGlMZXZlbCgpID49IEFTVC5KTFM4KSB7CisJCQlMaXN0IGFubm90YXRpb25zID0gbm9kZS5hbm5v
dGF0aW9ucygpOworCQkJaWYgKGFubm90YXRpb25zICE9IG51bGwgJiYgYW5ub3RhdGlvbnMuc2l6
ZSgpID4gMCkgewogCQkJCWZvciAoSXRlcmF0b3IgaXQgPSBhbm5vdGF0aW9ucy5pdGVyYXRvcigp
OyBpdC5oYXNOZXh0KCk7ICkgewogCQkJCQlBbm5vdGF0aW9uIGFubm90YXRpb24gPSAoQW5ub3Rh
dGlvbikgaXQubmV4dCgpOwpAQCAtMTgzMyw1ICsxODcyLDUgQEAKIAkJaWYgKG5vZGUuZ2V0QVNU
KCkuYXBpTGV2ZWwoKSA+PSBBU1QuSkxTOCkgewogCQkJTGlzdCBhbm5vdGF0aW9ucyA9IG5vZGUu
YW5ub3RhdGlvbnMoKTsKLQkJCWlmIChhbm5vdGF0aW9ucyAhPSBudWxsKSB7CisJCQlpZiAoYW5u
b3RhdGlvbnMgIT0gbnVsbCAmJiBhbm5vdGF0aW9ucy5zaXplKCkgPiAwKSB7CiAJCQkJZm9yIChJ
dGVyYXRvciBpdCA9IGFubm90YXRpb25zLml0ZXJhdG9yKCk7IGl0Lmhhc05leHQoKTsgKSB7CiAJ
CQkJCUFubm90YXRpb24gYW5ub3RhdGlvbiA9IChBbm5vdGF0aW9uKSBpdC5uZXh0KCk7CmRpZmYg
LS1naXQgYS9vcmcuZWNsaXBzZS5qZHQuY29yZS9kb20vb3JnL2VjbGlwc2UvamR0L2ludGVybmFs
L2NvcmUvZG9tL3Jld3JpdGUvQVNUUmV3cml0ZUFuYWx5emVyLmphdmEgYi9vcmcuZWNsaXBzZS5q
ZHQuY29yZS9kb20vb3JnL2VjbGlwc2UvamR0L2ludGVybmFsL2NvcmUvZG9tL3Jld3JpdGUvQVNU
UmV3cml0ZUFuYWx5emVyLmphdmEKaW5kZXggMTA5NGU1Ny4uZTE0YjU0YiAxMDA2NDQKLS0tIGEv
b3JnLmVjbGlwc2UuamR0LmNvcmUvZG9tL29yZy9lY2xpcHNlL2pkdC9pbnRlcm5hbC9jb3JlL2Rv
bS9yZXdyaXRlL0FTVFJld3JpdGVBbmFseXplci5qYXZhCisrKyBiL29yZy5lY2xpcHNlLmpkdC5j
b3JlL2RvbS9vcmcvZWNsaXBzZS9qZHQvaW50ZXJuYWwvY29yZS9kb20vcmV3cml0ZS9BU1RSZXdy
aXRlQW5hbHl6ZXIuamF2YQpAQCAtMTg4Miw0ICsxODgyLDkgQEAKIAkJCXBvcz0gZ2V0U2Nhbm5l
cigpLmdldFRva2VuRW5kT2Zmc2V0KFRlcm1pbmFsVG9rZW5zLlRva2VuTmFtZVJQQVJFTiwgcG9z
KTsKIAorCQkJLy8gSW4gY2FzZSBvZiBBU1QuSkxTOCwgdGhlIGRpbWVuc2lvbnMgd2lsbCBoYXZl
IGFubm90YXRpb25zIGFzIHdlbGwKKwkJCS8vIFN1cHBvcnQgbmV3IHByb3BlcnR5IEVYVFJBX0FO
Tk9UQVRFRF9ESU1FTlNJT05TX1BST1BFUlRZCisJCQkvLyBhbGdvcml0aG06IDEuIFNlZSBpZiB0
aGUgbmV3IHByb3BlcnR5IGhhcyBjaGFuZ2VkCisJCQkvLyAJCQkJMi4gSWYgdHJ1ZSwgZG9uJ3Qg
Ym90aGVyIGFib3V0IEVYVFJBX0RJTUVOU0lPTlNfUFJPUEVSVFksIHJld3JpdGUgYWNjb3JkaW5n
IHRvIHRoZSBuZXcgdmFsdWUgb2YgdGhlIEVYVFJBX0FOTk9UQVRFRF9ESU1FTlNJT05TX1BST1BF
UlRZCisJCQkvLwkJCQkzLiBJZiBmYWxzZSwgc2VlIHByb2NlZWQgYXMgdXN1YWwuIAogCQkJaW50
IGV4dHJhRGltcz0gcmV3cml0ZUV4dHJhRGltZW5zaW9ucyhub2RlLCBNZXRob2REZWNsYXJhdGlv
bi5FWFRSQV9ESU1FTlNJT05TX1BST1BFUlRZLCBwb3MpOwogCmRpZmYgLS1naXQgYS9vcmcuZWNs
aXBzZS5qZHQuY29yZS9kb20vb3JnL2VjbGlwc2UvamR0L2ludGVybmFsL2NvcmUvZG9tL3Jld3Jp
dGUvQVNUUmV3cml0ZUZsYXR0ZW5lci5qYXZhIGIvb3JnLmVjbGlwc2UuamR0LmNvcmUvZG9tL29y
Zy9lY2xpcHNlL2pkdC9pbnRlcm5hbC9jb3JlL2RvbS9yZXdyaXRlL0FTVFJld3JpdGVGbGF0dGVu
ZXIuamF2YQppbmRleCBjYjI5ZDUwLi5mNDZmZmEzIDEwMDY0NAotLS0gYS9vcmcuZWNsaXBzZS5q
ZHQuY29yZS9kb20vb3JnL2VjbGlwc2UvamR0L2ludGVybmFsL2NvcmUvZG9tL3Jld3JpdGUvQVNU
UmV3cml0ZUZsYXR0ZW5lci5qYXZhCisrKyBiL29yZy5lY2xpcHNlLmpkdC5jb3JlL2RvbS9vcmcv
ZWNsaXBzZS9qZHQvaW50ZXJuYWwvY29yZS9kb20vcmV3cml0ZS9BU1RSZXdyaXRlRmxhdHRlbmVy
LmphdmEKQEAgLTIyNSw2ICsyMjUsMTIgQEAKIAkJZ2V0Q2hpbGROb2RlKG5vZGUsIEFycmF5VHlw
ZS5DT01QT05FTlRfVFlQRV9QUk9QRVJUWSkuYWNjZXB0KHRoaXMpOwogCQlpZiAobm9kZS5nZXRB
U1QoKS5hcGlMZXZlbCgpID49IEFTVC5KTFM4KSB7Ci0JCQl2aXNpdExpc3Qobm9kZSwgQXJyYXlU
eXBlLkFOTk9UQVRJT05TX1BST1BFUlRZLCBTdHJpbmcudmFsdWVPZignICcpLCBVdGlsLkVNUFRZ
X1NUUklORywgU3RyaW5nLnZhbHVlT2YoJyAnKSk7CisJCQl2aXNpdExpc3Qobm9kZSwgQXJyYXlU
eXBlLkFOTk9UQVRJT05TX1BST1BFUlRZLCBTdHJpbmcudmFsdWVPZignICcpLCBVdGlsLkVNUFRZ
X1NUUklORywgVXRpbC5FTVBUWV9TVFJJTkcpOwogCQl9CisJCXRoaXMucmVzdWx0LmFwcGVuZCgi
W10iKTsgLy8kTk9OLU5MUy0xJAorCQlyZXR1cm4gZmFsc2U7CisJfQorCQorCXB1YmxpYyBib29s
ZWFuIHZpc2l0KERpbWVuc2lvblR5cGUgbm9kZSkgeworCQl2aXNpdExpc3Qobm9kZSwgQXJyYXlU
eXBlLkFOTk9UQVRJT05TX1BST1BFUlRZLCBTdHJpbmcudmFsdWVPZignICcpLCBVdGlsLkVNUFRZ
X1NUUklORywgVXRpbC5FTVBUWV9TVFJJTkcpOwogCQl0aGlzLnJlc3VsdC5hcHBlbmQoIltdIik7
IC8vJE5PTi1OTFMtMSQKIAkJcmV0dXJuIGZhbHNlOwpAQCAtNjMyLDcgKzYzOCw2IEBACiAJCXZp
c2l0TGlzdChwYXJhbWV0ZXJzLCBTdHJpbmcudmFsdWVPZignLCcpKTsKIAkJdGhpcy5yZXN1bHQu
YXBwZW5kKCcpJyk7Ci0JCWludCBleHRyYURpbXM9IGdldEludEF0dHJpYnV0ZShub2RlLCBNZXRo
b2REZWNsYXJhdGlvbi5FWFRSQV9ESU1FTlNJT05TX1BST1BFUlRZKTsKLQkJZm9yIChpbnQgaSA9
IDA7IGkgPCBleHRyYURpbXM7IGkrKykgewotCQkJdGhpcy5yZXN1bHQuYXBwZW5kKCJbXSIpOyAv
LyROT04tTkxTLTEkCisJCWlmIChub2RlLmdldEFTVCgpLmFwaUxldmVsKCkgPj0gQVNULkpMUzgp
IHsKKwkJCXZpc2l0TGlzdChub2RlLCBWYXJpYWJsZURlY2xhcmF0aW9uRnJhZ21lbnQuRVhUUkFf
QU5OT1RBVEVEX0RJTUVOU0lPTlNfUFJPUEVSVFksIFN0cmluZy52YWx1ZU9mKCcgJyksIFV0aWwu
RU1QVFlfU1RSSU5HLCBVdGlsLkVNUFRZX1NUUklORyk7CiAJCX0KIAkJdmlzaXRMaXN0KG5vZGUs
IE1ldGhvZERlY2xhcmF0aW9uLlRIUk9XTl9FWENFUFRJT05TX1BST1BFUlRZLCBTdHJpbmcudmFs
dWVPZignLCcpLCAiIHRocm93cyAiLCBVdGlsLkVNUFRZX1NUUklORyk7IC8vJE5PTi1OTFMtMSQK
QEAgLTgwNCw3ICs4MDksNiBAQAogCQl0aGlzLnJlc3VsdC5hcHBlbmQoJyAnKTsKIAkJZ2V0Q2hp
bGROb2RlKG5vZGUsIFNpbmdsZVZhcmlhYmxlRGVjbGFyYXRpb24uTkFNRV9QUk9QRVJUWSkuYWNj
ZXB0KHRoaXMpOwotCQlpbnQgZXh0cmFEaW1lbnNpb25zPSBnZXRJbnRBdHRyaWJ1dGUobm9kZSwg
U2luZ2xlVmFyaWFibGVEZWNsYXJhdGlvbi5FWFRSQV9ESU1FTlNJT05TX1BST1BFUlRZKTsKLQkJ
Zm9yIChpbnQgaSA9IDA7IGkgPCBleHRyYURpbWVuc2lvbnM7IGkrKykgewotCQkJdGhpcy5yZXN1
bHQuYXBwZW5kKCJbXSIpOyAvLyROT04tTkxTLTEkCisJCWlmIChub2RlLmdldEFTVCgpLmFwaUxl
dmVsKCkgPj0gQVNULkpMUzgpIHsKKwkJCXZpc2l0TGlzdChub2RlLCBWYXJpYWJsZURlY2xhcmF0
aW9uRnJhZ21lbnQuRVhUUkFfQU5OT1RBVEVEX0RJTUVOU0lPTlNfUFJPUEVSVFksIFN0cmluZy52
YWx1ZU9mKCcgJyksIFV0aWwuRU1QVFlfU1RSSU5HLCBVdGlsLkVNUFRZX1NUUklORyk7CiAJCX0K
IAkJQVNUTm9kZSBpbml0aWFsaXplcj0gZ2V0Q2hpbGROb2RlKG5vZGUsIFNpbmdsZVZhcmlhYmxl
RGVjbGFyYXRpb24uSU5JVElBTElaRVJfUFJPUEVSVFkpOwpAQCAtMTA0OSw3ICsxMDUzLDYgQEAK
IAlwdWJsaWMgYm9vbGVhbiB2aXNpdChWYXJpYWJsZURlY2xhcmF0aW9uRnJhZ21lbnQgbm9kZSkg
ewogCQlnZXRDaGlsZE5vZGUobm9kZSwgVmFyaWFibGVEZWNsYXJhdGlvbkZyYWdtZW50Lk5BTUVf
UFJPUEVSVFkpLmFjY2VwdCh0aGlzKTsKLQkJaW50IGV4dHJhRGltZW5zaW9ucz0gZ2V0SW50QXR0
cmlidXRlKG5vZGUsIFZhcmlhYmxlRGVjbGFyYXRpb25GcmFnbWVudC5FWFRSQV9ESU1FTlNJT05T
X1BST1BFUlRZKTsKLQkJZm9yIChpbnQgaSA9IDA7IGkgPCBleHRyYURpbWVuc2lvbnM7IGkrKykg
ewotCQkJdGhpcy5yZXN1bHQuYXBwZW5kKCJbXSIpOyAvLyROT04tTkxTLTEkCisJCWlmIChub2Rl
LmdldEFTVCgpLmFwaUxldmVsKCkgPj0gQVNULkpMUzgpIHsKKwkJCXZpc2l0TGlzdChub2RlLCBW
YXJpYWJsZURlY2xhcmF0aW9uRnJhZ21lbnQuRVhUUkFfQU5OT1RBVEVEX0RJTUVOU0lPTlNfUFJP
UEVSVFksIFN0cmluZy52YWx1ZU9mKCcgJyksIFV0aWwuRU1QVFlfU1RSSU5HLCBVdGlsLkVNUFRZ
X1NUUklORyk7CiAJCX0KIAkJQVNUTm9kZSBpbml0aWFsaXplcj0gZ2V0Q2hpbGROb2RlKG5vZGUs
IFZhcmlhYmxlRGVjbGFyYXRpb25GcmFnbWVudC5JTklUSUFMSVpFUl9QUk9QRVJUWSk7
</data>

          </attachment>
          <attachment
              isobsolete="1"
              ispatch="1"
              isprivate="0"
          >
            <attachid>224706</attachid>
            <date>2012-12-14 01:11:00 -0500</date>
            <delta_ts>2013-01-10 02:23:21 -0500</delta_ts>
            <desc>Updated patch</desc>
            <filename>Fix-for-bug-391895.patch</filename>
            <type>text/plain</type>
            <size>59873</size>
            <attacher name="Jay Arthanareeswaran">jarthana</attacher>
            
              <data encoding="base64">ZGlmZiAtLWdpdCBhL29yZy5lY2xpcHNlLmpkdC5jb3JlLnRlc3RzLm1vZGVsL3NyYy9vcmcvZWNs
aXBzZS9qZHQvY29yZS90ZXN0cy9kb20vQVNUQ29udmVydGVyMTVKTFM4VGVzdC5qYXZhIGIvb3Jn
LmVjbGlwc2UuamR0LmNvcmUudGVzdHMubW9kZWwvc3JjL29yZy9lY2xpcHNlL2pkdC9jb3JlL3Rl
c3RzL2RvbS9BU1RDb252ZXJ0ZXIxNUpMUzhUZXN0LmphdmEKaW5kZXggZjRiMTUyOC4uODc0NjI0
MCAxMDA2NDQKLS0tIGEvb3JnLmVjbGlwc2UuamR0LmNvcmUudGVzdHMubW9kZWwvc3JjL29yZy9l
Y2xpcHNlL2pkdC9jb3JlL3Rlc3RzL2RvbS9BU1RDb252ZXJ0ZXIxNUpMUzhUZXN0LmphdmEKKysr
IGIvb3JnLmVjbGlwc2UuamR0LmNvcmUudGVzdHMubW9kZWwvc3JjL29yZy9lY2xpcHNlL2pkdC9j
b3JlL3Rlc3RzL2RvbS9BU1RDb252ZXJ0ZXIxNUpMUzhUZXN0LmphdmEKQEAgLTUxNyw1ICs1MTcs
NSBAQAogCQltb2RpZmllciA9IChJRXh0ZW5kZWRNb2RpZmllcikgbW9kaWZpZXJzLmdldCgxKTsK
IAkJY2hlY2tTb3VyY2VSYW5nZSgoQVNUTm9kZSkgbW9kaWZpZXIsICJmaW5hbCIsIHNvdXJjZSk7
Ci0JCWFzc2VydEVxdWFscygiV3JvbmcgZGltZW5zaW9uIiwgMSwgc2luZ2xlVmFyaWFibGVEZWNs
YXJhdGlvbi5nZXRFeHRyYURpbWVuc2lvbnMoKSk7CisJCWFzc2VydEVxdWFscygiV3JvbmcgZGlt
ZW5zaW9uIiwgMSwgc2luZ2xlVmFyaWFibGVEZWNsYXJhdGlvbi5nZXRFeHRyYURpbWVuc2lvblR5
cGVzKCkuc2l6ZSgpKTsKIAkJVHlwZSB0eXBlID0gc2luZ2xlVmFyaWFibGVEZWNsYXJhdGlvbi5n
ZXRUeXBlKCk7CiAJCWNoZWNrU291cmNlUmFuZ2UodHlwZSwgIlN0cmluZyIsIHNvdXJjZSk7CkBA
IC0xNzEwLDUgKzE3MTAsNSBAQAogCQlBcnJheVR5cGUgYXJyYXlUeXBlID0gKEFycmF5VHlwZSkg
dHlwZTsKIAkJY2hlY2tTb3VyY2VSYW5nZShhcnJheVR5cGUuZ2V0Q29tcG9uZW50VHlwZSgpLCAi
U3RyaW5nIiwgc291cmNlKTsKLQkJYXNzZXJ0RXF1YWxzKCJXcm9uZyBleHRyYSBkaW1lbnNpb25z
IiwgMSwgc2luZ2xlVmFyaWFibGVEZWNsYXJhdGlvbi5nZXRFeHRyYURpbWVuc2lvbnMoKSk7CisJ
CWFzc2VydEVxdWFscygiV3JvbmcgZXh0cmEgZGltZW5zaW9ucyIsIDEsIHNpbmdsZVZhcmlhYmxl
RGVjbGFyYXRpb24uZ2V0RXh0cmFEaW1lbnNpb25UeXBlcygpLnNpemUoKSk7CiAJfQogCkBAIC0x
NzM4LDUgKzE3MzgsNSBAQAogCQlBcnJheVR5cGUgYXJyYXlUeXBlID0gKEFycmF5VHlwZSkgdHlw
ZTsKIAkJY2hlY2tTb3VyY2VSYW5nZShhcnJheVR5cGUuZ2V0Q29tcG9uZW50VHlwZSgpLCAiU3Ry
aW5nIiwgc291cmNlKTsKLQkJYXNzZXJ0RXF1YWxzKCJXcm9uZyBleHRyYSBkaW1lbnNpb25zIiwg
MCwgc2luZ2xlVmFyaWFibGVEZWNsYXJhdGlvbi5nZXRFeHRyYURpbWVuc2lvbnMoKSk7CisJCWFz
c2VydEVxdWFscygiV3JvbmcgZXh0cmEgZGltZW5zaW9ucyIsIDAsIHNpbmdsZVZhcmlhYmxlRGVj
bGFyYXRpb24uZ2V0RXh0cmFEaW1lbnNpb25UeXBlcygpLnNpemUoKSk7CiAJfQogCS8qKgpkaWZm
IC0tZ2l0IGEvb3JnLmVjbGlwc2UuamR0LmNvcmUudGVzdHMubW9kZWwvc3JjL29yZy9lY2xpcHNl
L2pkdC9jb3JlL3Rlc3RzL2RvbS9BU1RDb252ZXJ0ZXIxOFRlc3QuamF2YSBiL29yZy5lY2xpcHNl
LmpkdC5jb3JlLnRlc3RzLm1vZGVsL3NyYy9vcmcvZWNsaXBzZS9qZHQvY29yZS90ZXN0cy9kb20v
QVNUQ29udmVydGVyMThUZXN0LmphdmEKbmV3IGZpbGUgbW9kZSAxMDA2NDQKaW5kZXggMDAwMDAw
MC4uOTE0YWIyZAotLS0gL2Rldi9udWxsCisrKyBiL29yZy5lY2xpcHNlLmpkdC5jb3JlLnRlc3Rz
Lm1vZGVsL3NyYy9vcmcvZWNsaXBzZS9qZHQvY29yZS90ZXN0cy9kb20vQVNUQ29udmVydGVyMThU
ZXN0LmphdmEKQEAgLTAsMCArMSwxNDEgQEAKKy8qKioqKioqKioqKioqKioqKioqKioqKioqKioq
KioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqCisgKiBD
b3B5cmlnaHQgKGMpIDIwMDAsIDIwMTEgSUJNIENvcnBvcmF0aW9uIGFuZCBvdGhlcnMuCisgKiBB
bGwgcmlnaHRzIHJlc2VydmVkLiBUaGlzIHByb2dyYW0gYW5kIHRoZSBhY2NvbXBhbnlpbmcgbWF0
ZXJpYWxzCisgKiBhcmUgbWFkZSBhdmFpbGFibGUgdW5kZXIgdGhlIHRlcm1zIG9mIHRoZSBFY2xp
cHNlIFB1YmxpYyBMaWNlbnNlIHYxLjAKKyAqIHdoaWNoIGFjY29tcGFuaWVzIHRoaXMgZGlzdHJp
YnV0aW9uLCBhbmQgaXMgYXZhaWxhYmxlIGF0CisgKiBodHRwOi8vd3d3LmVjbGlwc2Uub3JnL2xl
Z2FsL2VwbC12MTAuaHRtbAorICoKKyAqIFRoaXMgaXMgYW4gaW1wbGVtZW50YXRpb24gb2YgYW4g
ZWFybHktZHJhZnQgc3BlY2lmaWNhdGlvbiBkZXZlbG9wZWQgdW5kZXIgdGhlIEphdmEKKyAqIENv
bW11bml0eSBQcm9jZXNzIChKQ1ApIGFuZCBpcyBtYWRlIGF2YWlsYWJsZSBmb3IgdGVzdGluZyBh
bmQgZXZhbHVhdGlvbiBwdXJwb3NlcworICogb25seS4gVGhlIGNvZGUgaXMgbm90IGNvbXBhdGli
bGUgd2l0aCBhbnkgc3BlY2lmaWNhdGlvbiBvZiB0aGUgSkNQLgorICoKKyAqIENvbnRyaWJ1dG9y
czoKKyAqICAgICBJQk0gQ29ycG9yYXRpb24gLSBpbml0aWFsIEFQSSBhbmQgaW1wbGVtZW50YXRp
b24KKyAqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioq
KioqKioqKioqKioqKioqKioqKioqKioqKioqLworcGFja2FnZSBvcmcuZWNsaXBzZS5qZHQuY29y
ZS50ZXN0cy5kb207CisKK2ltcG9ydCBqYXZhLnV0aWwuTGlzdDsKKworaW1wb3J0IGp1bml0LmZy
YW1ld29yay5UZXN0OworCitpbXBvcnQgb3JnLmVjbGlwc2UuamR0LmNvcmUuSUNvbXBpbGF0aW9u
VW5pdDsKK2ltcG9ydCBvcmcuZWNsaXBzZS5qZHQuY29yZS5KYXZhTW9kZWxFeGNlcHRpb247Citp
bXBvcnQgb3JnLmVjbGlwc2UuamR0LmNvcmUuZG9tLkFTVDsKK2ltcG9ydCBvcmcuZWNsaXBzZS5q
ZHQuY29yZS5kb20uQVNUTm9kZTsKK2ltcG9ydCBvcmcuZWNsaXBzZS5qZHQuY29yZS5kb20uQ29t
cGlsYXRpb25Vbml0OworaW1wb3J0IG9yZy5lY2xpcHNlLmpkdC5jb3JlLmRvbS5GaWVsZERlY2xh
cmF0aW9uOworaW1wb3J0IG9yZy5lY2xpcHNlLmpkdC5jb3JlLmRvbS5NZXRob2REZWNsYXJhdGlv
bjsKK2ltcG9ydCBvcmcuZWNsaXBzZS5qZHQuY29yZS5kb20uU2luZ2xlVmFyaWFibGVEZWNsYXJh
dGlvbjsKK2ltcG9ydCBvcmcuZWNsaXBzZS5qZHQuY29yZS5kb20uVmFyaWFibGVEZWNsYXJhdGlv
bkZyYWdtZW50OworCitwdWJsaWMgY2xhc3MgQVNUQ29udmVydGVyMThUZXN0IGV4dGVuZHMgQ29u
dmVydGVyVGVzdFNldHVwIHsKKworCUlDb21waWxhdGlvblVuaXQgd29ya2luZ0NvcHk7CisKKwlw
dWJsaWMgdm9pZCBzZXRVcFN1aXRlKCkgdGhyb3dzIEV4Y2VwdGlvbiB7CisJCXN1cGVyLnNldFVw
U3VpdGUoKTsKKwkJdGhpcy5hc3QgPSBBU1QubmV3QVNUKEFTVC5KTFM4KTsKKwl9CisKKwlwdWJs
aWMgQVNUQ29udmVydGVyMThUZXN0KFN0cmluZyBuYW1lKSB7CisJCXN1cGVyKG5hbWUpOworCX0K
KworCXB1YmxpYyBzdGF0aWMgVGVzdCBzdWl0ZSgpIHsKKwkJcmV0dXJuIGJ1aWxkTW9kZWxUZXN0
U3VpdGUoQVNUQ29udmVydGVyMThUZXN0LmNsYXNzKTsKKwl9CisKKwlwcm90ZWN0ZWQgdm9pZCB0
ZWFyRG93bigpIHRocm93cyBFeGNlcHRpb24geworCQlzdXBlci50ZWFyRG93bigpOworCQlpZiAo
dGhpcy53b3JraW5nQ29weSAhPSBudWxsKSB7CisJCQl0aGlzLndvcmtpbmdDb3B5LmRpc2NhcmRX
b3JraW5nQ29weSgpOworCQkJdGhpcy53b3JraW5nQ29weSA9IG51bGw7CisJCX0KKwl9CisKKwlw
dWJsaWMgdm9pZCB0ZXN0MDAwMigpIHRocm93cyBKYXZhTW9kZWxFeGNlcHRpb24geworCQlTdHJp
bmcgY29udGVudHMgPQorCQkJCSJpbXBvcnQgamF2YS5sYW5nLmFubm90YXRpb24uRWxlbWVudFR5
cGU7XG4iICsKKwkJCQkiaW1wb3J0IGphdmEubGFuZy5hbm5vdGF0aW9uLlRhcmdldDtcbiIgKwor
CQkJCSJwdWJsaWMgY2xhc3MgWCB7XG4iICsKKwkJCQkiCXB1YmxpYyBATWFya2VyIGludCBATWFy
a2VyMSBbXSBmb28oKSBATWFya2VyMiBbXXsgcmV0dXJuIG51bGw7IH1cbiIgKworCQkJCSJ9XG4i
ICsKKwkJCQkiQFRhcmdldCh2YWx1ZSA9IHsgRWxlbWVudFR5cGUuVFlQRV9VU0V9KVxuIiArCisJ
CQkJIkBpbnRlcmZhY2UgTWFya2VyIHt9XG4iICsKKwkJCQkiQFRhcmdldCh2YWx1ZSA9IHsgRWxl
bWVudFR5cGUuVFlQRV9VU0V9KVxuIiArCisJCQkJIkBpbnRlcmZhY2UgTWFya2VyMSB7fVxuIiAr
CisJCQkJIkBUYXJnZXQodmFsdWUgPSB7IEVsZW1lbnRUeXBlLlRZUEVfVVNFfSlcbiIgKworCQkJ
CSJAaW50ZXJmYWNlIE1hcmtlcjIge30iOworCQl0aGlzLndvcmtpbmdDb3B5ID0gZ2V0V29ya2lu
Z0NvcHkoIi9Db252ZXJ0ZXIxOC9zcmMvWC5qYXZhIiwgdHJ1ZSk7CisJCUFTVE5vZGUgbm9kZSA9
IGJ1aWxkQVNUKGNvbnRlbnRzLCB0aGlzLndvcmtpbmdDb3B5KTsKKwkJYXNzZXJ0RXF1YWxzKCJO
b3QgYSBjb21waWxhdGlvbiB1bml0IiwgQVNUTm9kZS5DT01QSUxBVElPTl9VTklULCBub2RlLmdl
dE5vZGVUeXBlKCkpOworCQlDb21waWxhdGlvblVuaXQgdW5pdCA9IChDb21waWxhdGlvblVuaXQp
IG5vZGU7CisJCW5vZGUgPSBnZXRBU1ROb2RlKHVuaXQsIDAsIDApOworCQlhc3NlcnRFcXVhbHMo
Ik5vdCBhIG1ldGhvZCBEZWNsYXJhdGlvbiIsIEFTVE5vZGUuTUVUSE9EX0RFQ0xBUkFUSU9OLCBu
b2RlLmdldE5vZGVUeXBlKCkpOworCQlNZXRob2REZWNsYXJhdGlvbiBtZXRob2QgPSAoTWV0aG9k
RGVjbGFyYXRpb24pIG5vZGU7CisJCUxpc3QgZXh0cmFEaW1lbnNpb25zID0gbWV0aG9kLmdldEV4
dHJhQW5ub3RhdGVkRGltZW5zaW9ucygpOworCQlhc3NlcnRFeHRyYURpbWVuc2lvbnNFcXVhbCgi
V3JvbmcgZXh0cmEgZGltZW5zaW9uIGluZm8iLCBleHRyYURpbWVuc2lvbnMsICJATWFya2VyMiBb
XSAiKTsKKwl9CisJCisJcHVibGljIHZvaWQgdGVzdDAwMDMoKSB0aHJvd3MgSmF2YU1vZGVsRXhj
ZXB0aW9uIHsKKwkJU3RyaW5nIGNvbnRlbnRzID0KKwkJCQkiaW1wb3J0IGphdmEubGFuZy5hbm5v
dGF0aW9uLkVsZW1lbnRUeXBlO1xuIiArCisJCQkJImltcG9ydCBqYXZhLmxhbmcuYW5ub3RhdGlv
bi5UYXJnZXQ7XG4iICsKKwkJCQkicHVibGljIGNsYXNzIFgge1xuIiArCisJCQkJIglwdWJsaWMg
dm9pZCBmb28oQE1hcmtlciBpbnQgQE1hcmtlcjEgW10gaSBATWFya2VyMiBbXSkge31cbiIgKwor
CQkJCSJ9XG4iICsKKwkJCQkiQFRhcmdldCh2YWx1ZSA9IHsgRWxlbWVudFR5cGUuVFlQRV9VU0V9
KVxuIiArCisJCQkJIkBpbnRlcmZhY2UgTWFya2VyIHt9XG4iICsKKwkJCQkiQFRhcmdldCh2YWx1
ZSA9IHsgRWxlbWVudFR5cGUuVFlQRV9VU0V9KVxuIiArCisJCQkJIkBpbnRlcmZhY2UgTWFya2Vy
MSB7fVxuIiArCisJCQkJIkBUYXJnZXQodmFsdWUgPSB7IEVsZW1lbnRUeXBlLlRZUEVfVVNFfSlc
biIgKworCQkJCSJAaW50ZXJmYWNlIE1hcmtlcjIge30iOworCQl0aGlzLndvcmtpbmdDb3B5ID0g
Z2V0V29ya2luZ0NvcHkoIi9Db252ZXJ0ZXIxOC9zcmMvWC5qYXZhIiwgdHJ1ZSk7CisJCUFTVE5v
ZGUgbm9kZSA9IGJ1aWxkQVNUKGNvbnRlbnRzLCB0aGlzLndvcmtpbmdDb3B5KTsKKwkJYXNzZXJ0
RXF1YWxzKCJOb3QgYSBjb21waWxhdGlvbiB1bml0IiwgQVNUTm9kZS5DT01QSUxBVElPTl9VTklU
LCBub2RlLmdldE5vZGVUeXBlKCkpOworCQlDb21waWxhdGlvblVuaXQgdW5pdCA9IChDb21waWxh
dGlvblVuaXQpIG5vZGU7CisJCW5vZGUgPSBnZXRBU1ROb2RlKHVuaXQsIDAsIDApOworCQlhc3Nl
cnRFcXVhbHMoIk5vdCBhIG1ldGhvZCBEZWNsYXJhdGlvbiIsIEFTVE5vZGUuTUVUSE9EX0RFQ0xB
UkFUSU9OLCBub2RlLmdldE5vZGVUeXBlKCkpOworCQlTaW5nbGVWYXJpYWJsZURlY2xhcmF0aW9u
IHNpbmdsZVZhcmlhYmxlID0gKFNpbmdsZVZhcmlhYmxlRGVjbGFyYXRpb24pICgoTWV0aG9kRGVj
bGFyYXRpb24pIG5vZGUpLnBhcmFtZXRlcnMoKS5nZXQoMCk7CisJCWFzc2VydE5vdE51bGwoIldy
b25nIHBhcmFtZXRlciIsIHNpbmdsZVZhcmlhYmxlKTsKKwkJTGlzdCBleHRyYURpbWVuc2lvbnMg
PSBzaW5nbGVWYXJpYWJsZS5nZXRFeHRyYURpbWVuc2lvblR5cGVzKCk7CisJCWFzc2VydEV4dHJh
RGltZW5zaW9uc0VxdWFsKCJXcm9uZyBleHRyYSBkaW1lbnNpb24gaW5mbyIsIGV4dHJhRGltZW5z
aW9ucywgIkBNYXJrZXIyIFtdICIpOworCX0KKwkKKwlwdWJsaWMgdm9pZCB0ZXN0MDAwNCgpIHRo
cm93cyBKYXZhTW9kZWxFeGNlcHRpb24geworCQlTdHJpbmcgY29udGVudHMgPQorCQkJCSJpbXBv
cnQgamF2YS5sYW5nLmFubm90YXRpb24uRWxlbWVudFR5cGU7XG4iICsKKwkJCQkiaW1wb3J0IGph
dmEubGFuZy5hbm5vdGF0aW9uLlRhcmdldDtcbiIgKworCQkJCSJwdWJsaWMgY2xhc3MgWCB7XG4i
ICsKKwkJCQkiCUBNYXJrZXIgaW50IEBNYXJrZXIxIFtdIGEgQE1hcmtlcjIgW10gQE1hcmtlcjMg
W10gQE1hcmtlcjQgW10sIGIgQE1hcmtlcjIgQE1hcmtlcjMgW10gQE1hcmtlcjQgW10sIGMgW11b
XVtdO1xuIiArCisJCQkJIn1cbiIgKworCQkJCSJAVGFyZ2V0KHZhbHVlID0geyBFbGVtZW50VHlw
ZS5UWVBFX1VTRX0pXG4iICsKKwkJCQkiQGludGVyZmFjZSBNYXJrZXIge31cbiIgKworCQkJCSJA
VGFyZ2V0KHZhbHVlID0geyBFbGVtZW50VHlwZS5UWVBFX1VTRX0pXG4iICsKKwkJCQkiQGludGVy
ZmFjZSBNYXJrZXIxIHt9XG4iICsKKwkJCQkiQFRhcmdldCh2YWx1ZSA9IHsgRWxlbWVudFR5cGUu
VFlQRV9VU0V9KVxuIiArCisJCQkJIkBpbnRlcmZhY2UgTWFya2VyMiB7fVxuIiArCisJCQkJIkBU
YXJnZXQodmFsdWUgPSB7IEVsZW1lbnRUeXBlLlRZUEVfVVNFfSlcbiIgKworCQkJCSJAaW50ZXJm
YWNlIE1hcmtlcjMge31cbiIgKworCQkJCSJAVGFyZ2V0KHZhbHVlID0geyBFbGVtZW50VHlwZS5U
WVBFX1VTRX0pXG4iICsKKwkJCQkiQGludGVyZmFjZSBNYXJrZXI0IHt9IjsKKwkJU3lzdGVtLm91
dC5wcmludGxuKGNvbnRlbnRzKTsKKwkJdGhpcy53b3JraW5nQ29weSA9IGdldFdvcmtpbmdDb3B5
KCIvQ29udmVydGVyMTgvc3JjL1guamF2YSIsIHRydWUpOworCQlBU1ROb2RlIG5vZGUgPSBidWls
ZEFTVChjb250ZW50cywgdGhpcy53b3JraW5nQ29weSk7CisJCWFzc2VydEVxdWFscygiTm90IGEg
Y29tcGlsYXRpb24gdW5pdCIsIEFTVE5vZGUuQ09NUElMQVRJT05fVU5JVCwgbm9kZS5nZXROb2Rl
VHlwZSgpKTsKKwkJQ29tcGlsYXRpb25Vbml0IHVuaXQgPSAoQ29tcGlsYXRpb25Vbml0KSBub2Rl
OworCQlub2RlID0gZ2V0QVNUTm9kZSh1bml0LCAwLCAwKTsKKwkJYXNzZXJ0RXF1YWxzKCJOb3Qg
YSBtZXRob2QgRGVjbGFyYXRpb24iLCBBU1ROb2RlLkZJRUxEX0RFQ0xBUkFUSU9OLCBub2RlLmdl
dE5vZGVUeXBlKCkpOworCQlGaWVsZERlY2xhcmF0aW9uIGZpZWxkID0gKEZpZWxkRGVjbGFyYXRp
b24pIG5vZGU7CisJCWFzc2VydEVxdWFscygid3Jvbmcgbm8gb2YgdmFyaWFibGUgZnJhZ21lbnRz
IiwgMywgZmllbGQuZnJhZ21lbnRzKCkuc2l6ZSgpKTsKKwkJVmFyaWFibGVEZWNsYXJhdGlvbkZy
YWdtZW50IGZyYWdtZW50ID0gKFZhcmlhYmxlRGVjbGFyYXRpb25GcmFnbWVudCkgZmllbGQuZnJh
Z21lbnRzKCkuZ2V0KDApOworCQlMaXN0IGV4dHJhRGltZW5zaW9ucyA9IGZyYWdtZW50LmdldEV4
dHJhRGltZW5zaW9uVHlwZXMoKTsKKwkJYXNzZXJ0RXh0cmFEaW1lbnNpb25zRXF1YWwoIldyb25n
IGV4dHJhIGRpbWVuc2lvbiBpbmZvIiwgZXh0cmFEaW1lbnNpb25zLCAiQE1hcmtlcjIgW10gQE1h
cmtlcjMgW10gQE1hcmtlcjQgW10gIik7CisJCWZyYWdtZW50ID0gKFZhcmlhYmxlRGVjbGFyYXRp
b25GcmFnbWVudCkgZmllbGQuZnJhZ21lbnRzKCkuZ2V0KDEpOworCQlleHRyYURpbWVuc2lvbnMg
PSBmcmFnbWVudC5nZXRFeHRyYURpbWVuc2lvblR5cGVzKCk7CisJCWFzc2VydEV4dHJhRGltZW5z
aW9uc0VxdWFsKCJXcm9uZyBleHRyYSBkaW1lbnNpb24gaW5mbyIsIGV4dHJhRGltZW5zaW9ucywg
IkBNYXJrZXIyIEBNYXJrZXIzIFtdIEBNYXJrZXI0IFtdICIpOworCQlmcmFnbWVudCA9IChWYXJp
YWJsZURlY2xhcmF0aW9uRnJhZ21lbnQpIGZpZWxkLmZyYWdtZW50cygpLmdldCgyKTsKKwkJZXh0
cmFEaW1lbnNpb25zID0gZnJhZ21lbnQuZ2V0RXh0cmFEaW1lbnNpb25UeXBlcygpOworCQlhc3Nl
cnRFeHRyYURpbWVuc2lvbnNFcXVhbCgiV3JvbmcgZXh0cmEgZGltZW5zaW9uIGluZm8iLCBleHRy
YURpbWVuc2lvbnMsICJbXSBbXSBbXSAiKTsKKwl9Cit9ClwgTm8gbmV3bGluZSBhdCBlbmQgb2Yg
ZmlsZQpkaWZmIC0tZ2l0IGEvb3JnLmVjbGlwc2UuamR0LmNvcmUudGVzdHMubW9kZWwvc3JjL29y
Zy9lY2xpcHNlL2pkdC9jb3JlL3Rlc3RzL2RvbS9BU1RDb252ZXJ0ZXJBU1Q4VGVzdC5qYXZhIGIv
b3JnLmVjbGlwc2UuamR0LmNvcmUudGVzdHMubW9kZWwvc3JjL29yZy9lY2xpcHNlL2pkdC9jb3Jl
L3Rlc3RzL2RvbS9BU1RDb252ZXJ0ZXJBU1Q4VGVzdC5qYXZhCmluZGV4IGE3MjE0MGMuLjVjODAw
MDMgMTAwNjQ0Ci0tLSBhL29yZy5lY2xpcHNlLmpkdC5jb3JlLnRlc3RzLm1vZGVsL3NyYy9vcmcv
ZWNsaXBzZS9qZHQvY29yZS90ZXN0cy9kb20vQVNUQ29udmVydGVyQVNUOFRlc3QuamF2YQorKysg
Yi9vcmcuZWNsaXBzZS5qZHQuY29yZS50ZXN0cy5tb2RlbC9zcmMvb3JnL2VjbGlwc2UvamR0L2Nv
cmUvdGVzdHMvZG9tL0FTVENvbnZlcnRlckFTVDhUZXN0LmphdmEKQEAgLTM4LDQgKzM4LDUgQEAK
IAlzdGF0aWMgewogLy8JCVRFU1RTX05VTUJFUlMgPSBuZXcgaW50W10geyAzNTYgfTsKKy8vCQlU
RVNUU19OQU1FUyA9IG5ldyBTdHJpbmdbXXsgInRlc3QwMzkzIiB9OwogCX0KIAlwdWJsaWMgc3Rh
dGljIFRlc3Qgc3VpdGUoKSB7CkBAIC0xOTkzLDUgKzE5OTQsNSBAQAogCQlhc3NlcnRUcnVlKCJC
b3RoIEFTVCB0cmVlcyBzaG91bGQgYmUgaWRlbnRpY2FsIiwgdmFyaWFibGVEZWNsYXJhdGlvbi5z
dWJ0cmVlTWF0Y2gobmV3IEFTVE1hdGNoZXIoKSwgbm9kZSkpOwkJLy8kTk9OLU5MUy0xJAogCQlj
aGVja1NvdXJjZVJhbmdlKG5vZGUsICJmaW5hbCBTdHJpbmcgcyIsIHNvdXJjZSk7IC8vJE5PTi1O
TFMtMSQKLQkJYXNzZXJ0RXF1YWxzKCJXcm9uZyBkaW1lbnNpb24iLCAwLCBub2RlLmdldEV4dHJh
RGltZW5zaW9ucygpKTsgLy8kTk9OLU5MUy0xJAorCQlhc3NlcnRFcXVhbHMoIldyb25nIGRpbWVu
c2lvbiIsIDAsIG5vZGUuZ2V0RXh0cmFEaW1lbnNpb25UeXBlcygpLnNpemUoKSk7IC8vJE5PTi1O
TFMtMSQKIAl9CiAKQEAgLTI3MTksMTggKzI3MjAsMjEgQEAKIAkJbGl0ZXJhbC5zZXRUb2tlbigi
MTAiKTsvLyROT04tTkxTLTEkCiAJCWZyYWdtZW50LnNldEluaXRpYWxpemVyKGxpdGVyYWwpOwot
CQlmcmFnbWVudC5zZXRFeHRyYURpbWVuc2lvbnMoMCk7CisJCWZyYWdtZW50LmdldEV4dHJhRGlt
ZW5zaW9uVHlwZXMoKS5jbGVhcigpOwogCQlWYXJpYWJsZURlY2xhcmF0aW9uU3RhdGVtZW50IHN0
YXRlbWVudCA9IHRoaXMuYXN0Lm5ld1ZhcmlhYmxlRGVjbGFyYXRpb25TdGF0ZW1lbnQoZnJhZ21l
bnQpOwogCQlmcmFnbWVudCA9IHRoaXMuYXN0Lm5ld1ZhcmlhYmxlRGVjbGFyYXRpb25GcmFnbWVu
dCgpOwogCQlmcmFnbWVudC5zZXROYW1lKHRoaXMuYXN0Lm5ld1NpbXBsZU5hbWUoInoiKSk7Ly8k
Tk9OLU5MUy0xJAogCQlmcmFnbWVudC5zZXRJbml0aWFsaXplcih0aGlzLmFzdC5uZXdOdWxsTGl0
ZXJhbCgpKTsKLQkJZnJhZ21lbnQuc2V0RXh0cmFEaW1lbnNpb25zKDEpOworCQlmcmFnbWVudC5n
ZXRFeHRyYURpbWVuc2lvblR5cGVzKCkuY2xlYXIoKTsKKwkJZnJhZ21lbnQuZ2V0RXh0cmFEaW1l
bnNpb25UeXBlcygpLmFkZCh0aGlzLmFzdC5uZXdEaW1lbnNpb24obnVsbCkpOwogCQlzdGF0ZW1l
bnQuZnJhZ21lbnRzKCkuYWRkKGZyYWdtZW50KTsKIAkJZnJhZ21lbnQgPSB0aGlzLmFzdC5uZXdW
YXJpYWJsZURlY2xhcmF0aW9uRnJhZ21lbnQoKTsKIAkJZnJhZ21lbnQuc2V0TmFtZSh0aGlzLmFz
dC5uZXdTaW1wbGVOYW1lKCJpIikpOy8vJE5PTi1OTFMtMSQKLQkJZnJhZ21lbnQuc2V0RXh0cmFE
aW1lbnNpb25zKDApOworCQlmcmFnbWVudC5nZXRFeHRyYURpbWVuc2lvblR5cGVzKCkuY2xlYXIo
KTsKIAkJc3RhdGVtZW50LmZyYWdtZW50cygpLmFkZChmcmFnbWVudCk7CiAJCWZyYWdtZW50ID0g
dGhpcy5hc3QubmV3VmFyaWFibGVEZWNsYXJhdGlvbkZyYWdtZW50KCk7CiAJCWZyYWdtZW50LnNl
dE5hbWUodGhpcy5hc3QubmV3U2ltcGxlTmFtZSgiaiIpKTsvLyROT04tTkxTLTEkCi0JCWZyYWdt
ZW50LnNldEV4dHJhRGltZW5zaW9ucygyKTsKKwkJZnJhZ21lbnQuZ2V0RXh0cmFEaW1lbnNpb25U
eXBlcygpLmNsZWFyKCk7CisJCWZyYWdtZW50LmdldEV4dHJhRGltZW5zaW9uVHlwZXMoKS5hZGQo
dGhpcy5hc3QubmV3RGltZW5zaW9uKG51bGwpKTsKKwkJZnJhZ21lbnQuZ2V0RXh0cmFEaW1lbnNp
b25UeXBlcygpLmFkZCh0aGlzLmFzdC5uZXdEaW1lbnNpb24obnVsbCkpOwogCQlzdGF0ZW1lbnQu
ZnJhZ21lbnRzKCkuYWRkKGZyYWdtZW50KTsKIAkJc3RhdGVtZW50LnNldFR5cGUodGhpcy5hc3Qu
bmV3UHJpbWl0aXZlVHlwZShQcmltaXRpdmVUeXBlLklOVCkpOwpAQCAtMjc1OSwxOCArMjc2Mywy
MSBAQAogCQlsaXRlcmFsLnNldFRva2VuKCIxMCIpOy8vJE5PTi1OTFMtMSQKIAkJZnJhZ21lbnQu
c2V0SW5pdGlhbGl6ZXIobGl0ZXJhbCk7Ci0JCWZyYWdtZW50LnNldEV4dHJhRGltZW5zaW9ucygw
KTsKKwkJZnJhZ21lbnQuZ2V0RXh0cmFEaW1lbnNpb25UeXBlcygpLmNsZWFyKCk7CiAJCVZhcmlh
YmxlRGVjbGFyYXRpb25TdGF0ZW1lbnQgc3RhdGVtZW50ID0gdGhpcy5hc3QubmV3VmFyaWFibGVE
ZWNsYXJhdGlvblN0YXRlbWVudChmcmFnbWVudCk7CiAJCWZyYWdtZW50ID0gdGhpcy5hc3QubmV3
VmFyaWFibGVEZWNsYXJhdGlvbkZyYWdtZW50KCk7CiAJCWZyYWdtZW50LnNldE5hbWUodGhpcy5h
c3QubmV3U2ltcGxlTmFtZSgieiIpKTsvLyROT04tTkxTLTEkCiAJCWZyYWdtZW50LnNldEluaXRp
YWxpemVyKHRoaXMuYXN0Lm5ld051bGxMaXRlcmFsKCkpOwotCQlmcmFnbWVudC5zZXRFeHRyYURp
bWVuc2lvbnMoMSk7CisJCWZyYWdtZW50LmdldEV4dHJhRGltZW5zaW9uVHlwZXMoKS5jbGVhcigp
OworCQlmcmFnbWVudC5nZXRFeHRyYURpbWVuc2lvblR5cGVzKCkuYWRkKHRoaXMuYXN0Lm5ld0Rp
bWVuc2lvbihudWxsKSk7CiAJCXN0YXRlbWVudC5mcmFnbWVudHMoKS5hZGQoZnJhZ21lbnQpOwog
CQlmcmFnbWVudCA9IHRoaXMuYXN0Lm5ld1ZhcmlhYmxlRGVjbGFyYXRpb25GcmFnbWVudCgpOwog
CQlmcmFnbWVudC5zZXROYW1lKHRoaXMuYXN0Lm5ld1NpbXBsZU5hbWUoImkiKSk7Ly8kTk9OLU5M
Uy0xJAotCQlmcmFnbWVudC5zZXRFeHRyYURpbWVuc2lvbnMoMCk7CisJCWZyYWdtZW50LmdldEV4
dHJhRGltZW5zaW9uVHlwZXMoKS5jbGVhcigpOwogCQlzdGF0ZW1lbnQuZnJhZ21lbnRzKCkuYWRk
KGZyYWdtZW50KTsKIAkJZnJhZ21lbnQgPSB0aGlzLmFzdC5uZXdWYXJpYWJsZURlY2xhcmF0aW9u
RnJhZ21lbnQoKTsKIAkJZnJhZ21lbnQuc2V0TmFtZSh0aGlzLmFzdC5uZXdTaW1wbGVOYW1lKCJq
IikpOy8vJE5PTi1OTFMtMSQKLQkJZnJhZ21lbnQuc2V0RXh0cmFEaW1lbnNpb25zKDIpOworCQlm
cmFnbWVudC5nZXRFeHRyYURpbWVuc2lvblR5cGVzKCkuY2xlYXIoKTsKKwkJZnJhZ21lbnQuZ2V0
RXh0cmFEaW1lbnNpb25UeXBlcygpLmFkZCh0aGlzLmFzdC5uZXdEaW1lbnNpb24obnVsbCkpOwor
CQlmcmFnbWVudC5nZXRFeHRyYURpbWVuc2lvblR5cGVzKCkuYWRkKHRoaXMuYXN0Lm5ld0RpbWVu
c2lvbihudWxsKSk7CiAJCXN0YXRlbWVudC5mcmFnbWVudHMoKS5hZGQoZnJhZ21lbnQpOwogCQlz
dGF0ZW1lbnQuc2V0VHlwZSh0aGlzLmFzdC5uZXdBcnJheVR5cGUodGhpcy5hc3QubmV3UHJpbWl0
aXZlVHlwZShQcmltaXRpdmVUeXBlLklOVCksIDEpKTsKQEAgLTI3OTgsNSArMjgwNSw2IEBACiAJ
CXZhcmlhYmxlRGVjbGFyYXRpb25GcmFnbWVudC5zZXROYW1lKHRoaXMuYXN0Lm5ld1NpbXBsZU5h
bWUoInRhYiIpKTsgLy8kTk9OLU5MUy0xJAogCQl2YXJpYWJsZURlY2xhcmF0aW9uRnJhZ21lbnQu
c2V0SW5pdGlhbGl6ZXIodGhpcy5hc3QubmV3TnVsbExpdGVyYWwoKSk7Ly8kTk9OLU5MUy0xJAot
CQl2YXJpYWJsZURlY2xhcmF0aW9uRnJhZ21lbnQuc2V0RXh0cmFEaW1lbnNpb25zKDEpOworCQl2
YXJpYWJsZURlY2xhcmF0aW9uRnJhZ21lbnQuZ2V0RXh0cmFEaW1lbnNpb25UeXBlcygpLmNsZWFy
KCk7CisJCXZhcmlhYmxlRGVjbGFyYXRpb25GcmFnbWVudC5nZXRFeHRyYURpbWVuc2lvblR5cGVz
KCkuYWRkKHRoaXMuYXN0Lm5ld0RpbWVuc2lvbihudWxsKSk7CiAJCVZhcmlhYmxlRGVjbGFyYXRp
b25FeHByZXNzaW9uIHZhcmlhYmxlRGVjbGFyYXRpb25FeHByZXNzaW9uID0gdGhpcy5hc3QubmV3
VmFyaWFibGVEZWNsYXJhdGlvbkV4cHJlc3Npb24odmFyaWFibGVEZWNsYXJhdGlvbkZyYWdtZW50
KTsKIAkJdmFyaWFibGVEZWNsYXJhdGlvbkV4cHJlc3Npb24uc2V0VHlwZSh0aGlzLmFzdC5uZXdB
cnJheVR5cGUodGhpcy5hc3QubmV3U2ltcGxlVHlwZSh0aGlzLmFzdC5uZXdTaW1wbGVOYW1lKCJT
dHJpbmciKSksIDEpKTsvLyROT04tTkxTLTEkCkBAIC0yODI2LDUgKzI4MzQsNiBAQAogCQl2YXJp
YWJsZURlY2xhcmF0aW9uRnJhZ21lbnQuc2V0TmFtZSh0aGlzLmFzdC5uZXdTaW1wbGVOYW1lKCJ0
YWIiKSk7IC8vJE5PTi1OTFMtMSQKIAkJdmFyaWFibGVEZWNsYXJhdGlvbkZyYWdtZW50LnNldElu
aXRpYWxpemVyKHRoaXMuYXN0Lm5ld051bGxMaXRlcmFsKCkpOy8vJE5PTi1OTFMtMSQKLQkJdmFy
aWFibGVEZWNsYXJhdGlvbkZyYWdtZW50LnNldEV4dHJhRGltZW5zaW9ucygxKTsKKwkJdmFyaWFi
bGVEZWNsYXJhdGlvbkZyYWdtZW50LmdldEV4dHJhRGltZW5zaW9uVHlwZXMoKS5jbGVhcigpOwor
CQl2YXJpYWJsZURlY2xhcmF0aW9uRnJhZ21lbnQuZ2V0RXh0cmFEaW1lbnNpb25UeXBlcygpLmFk
ZCh0aGlzLmFzdC5uZXdEaW1lbnNpb24obnVsbCkpOwogCQlWYXJpYWJsZURlY2xhcmF0aW9uRXhw
cmVzc2lvbiB2YXJpYWJsZURlY2xhcmF0aW9uRXhwcmVzc2lvbiA9IHRoaXMuYXN0Lm5ld1Zhcmlh
YmxlRGVjbGFyYXRpb25FeHByZXNzaW9uKHZhcmlhYmxlRGVjbGFyYXRpb25GcmFnbWVudCk7CiAJ
CXZhcmlhYmxlRGVjbGFyYXRpb25FeHByZXNzaW9uLnNldFR5cGUodGhpcy5hc3QubmV3U2ltcGxl
VHlwZSh0aGlzLmFzdC5uZXdTaW1wbGVOYW1lKCJTdHJpbmciKSkpOy8vJE5PTi1OTFMtMSQKQEAg
LTI4NTQsNSArMjg2Myw2IEBACiAJCXZhcmlhYmxlRGVjbGFyYXRpb25GcmFnbWVudC5zZXROYW1l
KHRoaXMuYXN0Lm5ld1NpbXBsZU5hbWUoInRhYiIpKTsgLy8kTk9OLU5MUy0xJAogCQl2YXJpYWJs
ZURlY2xhcmF0aW9uRnJhZ21lbnQuc2V0SW5pdGlhbGl6ZXIodGhpcy5hc3QubmV3TnVsbExpdGVy
YWwoKSk7Ly8kTk9OLU5MUy0xJAotCQl2YXJpYWJsZURlY2xhcmF0aW9uRnJhZ21lbnQuc2V0RXh0
cmFEaW1lbnNpb25zKDEpOworCQl2YXJpYWJsZURlY2xhcmF0aW9uRnJhZ21lbnQuZ2V0RXh0cmFE
aW1lbnNpb25UeXBlcygpLmNsZWFyKCk7CisJCXZhcmlhYmxlRGVjbGFyYXRpb25GcmFnbWVudC5n
ZXRFeHRyYURpbWVuc2lvblR5cGVzKCkuYWRkKHRoaXMuYXN0Lm5ld0RpbWVuc2lvbihudWxsKSk7
CiAJCVZhcmlhYmxlRGVjbGFyYXRpb25FeHByZXNzaW9uIHZhcmlhYmxlRGVjbGFyYXRpb25FeHBy
ZXNzaW9uID0gdGhpcy5hc3QubmV3VmFyaWFibGVEZWNsYXJhdGlvbkV4cHJlc3Npb24odmFyaWFi
bGVEZWNsYXJhdGlvbkZyYWdtZW50KTsKIAkJdmFyaWFibGVEZWNsYXJhdGlvbkV4cHJlc3Npb24u
c2V0VHlwZSh0aGlzLmFzdC5uZXdTaW1wbGVUeXBlKHRoaXMuYXN0Lm5ld1NpbXBsZU5hbWUoIlN0
cmluZyIpKSk7Ly8kTk9OLU5MUy0xJApAQCAtMjg4Myw1ICsyODkzLDUgQEAKIAkJVmFyaWFibGVE
ZWNsYXJhdGlvbkZyYWdtZW50IGZyYWdtZW50ID0gdGhpcy5hc3QubmV3VmFyaWFibGVEZWNsYXJh
dGlvbkZyYWdtZW50KCk7CiAJCWZyYWdtZW50LnNldE5hbWUodGhpcy5hc3QubmV3U2ltcGxlTmFt
ZSgiaSIpKTsgLy8kTk9OLU5MUy0xJAotCQlmcmFnbWVudC5zZXRFeHRyYURpbWVuc2lvbnMoMCk7
CisJCWZyYWdtZW50LmdldEV4dHJhRGltZW5zaW9uVHlwZXMoKS5jbGVhcigpOwogCQlGaWVsZERl
Y2xhcmF0aW9uIGZpZWxkRGVjbGFyYXRpb24gPSB0aGlzLmFzdC5uZXdGaWVsZERlY2xhcmF0aW9u
KGZyYWdtZW50KTsKIAkJZmllbGREZWNsYXJhdGlvbi5zZXRUeXBlKHRoaXMuYXN0Lm5ld1ByaW1p
dGl2ZVR5cGUoUHJpbWl0aXZlVHlwZS5JTlQpKTsKQEAgLTI5MDUsNSArMjkxNSw1IEBACiAJCWxp
dGVyYWwuc2V0VG9rZW4oIjEwIik7IC8vJE5PTi1OTFMtMSQKIAkJZnJhZ21lbnQuc2V0SW5pdGlh
bGl6ZXIobGl0ZXJhbCk7Ci0JCWZyYWdtZW50LnNldEV4dHJhRGltZW5zaW9ucygwKTsKKwkJZnJh
Z21lbnQuZ2V0RXh0cmFEaW1lbnNpb25UeXBlcygpLmNsZWFyKCk7CiAJCUZpZWxkRGVjbGFyYXRp
b24gZmllbGREZWNsYXJhdGlvbiA9IHRoaXMuYXN0Lm5ld0ZpZWxkRGVjbGFyYXRpb24oZnJhZ21l
bnQpOwogCQlmaWVsZERlY2xhcmF0aW9uLm1vZGlmaWVycygpLmFkZCh0aGlzLmFzdC5uZXdNb2Rp
ZmllcihNb2RpZmllci5Nb2RpZmllcktleXdvcmQuUFVCTElDX0tFWVdPUkQpKTsKQEAgLTI5MTEs
MTQgKzI5MjEsMTcgQEAKIAkJZnJhZ21lbnQgPSB0aGlzLmFzdC5uZXdWYXJpYWJsZURlY2xhcmF0
aW9uRnJhZ21lbnQoKTsKIAkJZnJhZ21lbnQuc2V0TmFtZSh0aGlzLmFzdC5uZXdTaW1wbGVOYW1l
KCJ5IikpOy8vJE5PTi1OTFMtMSQKLQkJZnJhZ21lbnQuc2V0RXh0cmFEaW1lbnNpb25zKDEpOwor
CQlmcmFnbWVudC5nZXRFeHRyYURpbWVuc2lvblR5cGVzKCkuY2xlYXIoKTsKKwkJZnJhZ21lbnQu
Z2V0RXh0cmFEaW1lbnNpb25UeXBlcygpLmFkZCh0aGlzLmFzdC5uZXdEaW1lbnNpb24obnVsbCkp
OwogCQlmcmFnbWVudC5zZXRJbml0aWFsaXplcih0aGlzLmFzdC5uZXdOdWxsTGl0ZXJhbCgpKTsK
IAkJZmllbGREZWNsYXJhdGlvbi5mcmFnbWVudHMoKS5hZGQoZnJhZ21lbnQpOwogCQlmcmFnbWVu
dCA9IHRoaXMuYXN0Lm5ld1ZhcmlhYmxlRGVjbGFyYXRpb25GcmFnbWVudCgpOwogCQlmcmFnbWVu
dC5zZXROYW1lKHRoaXMuYXN0Lm5ld1NpbXBsZU5hbWUoImkiKSk7Ly8kTk9OLU5MUy0xJAotCQlm
cmFnbWVudC5zZXRFeHRyYURpbWVuc2lvbnMoMCk7CisJCWZyYWdtZW50LmdldEV4dHJhRGltZW5z
aW9uVHlwZXMoKS5jbGVhcigpOwogCQlmaWVsZERlY2xhcmF0aW9uLmZyYWdtZW50cygpLmFkZChm
cmFnbWVudCk7CiAJCWZyYWdtZW50ID0gdGhpcy5hc3QubmV3VmFyaWFibGVEZWNsYXJhdGlvbkZy
YWdtZW50KCk7CiAJCWZyYWdtZW50LnNldE5hbWUodGhpcy5hc3QubmV3U2ltcGxlTmFtZSgiaiIp
KTsvLyROT04tTkxTLTEkCi0JCWZyYWdtZW50LnNldEV4dHJhRGltZW5zaW9ucygyKTsKKwkJZnJh
Z21lbnQuZ2V0RXh0cmFEaW1lbnNpb25UeXBlcygpLmNsZWFyKCk7CisJCWZyYWdtZW50LmdldEV4
dHJhRGltZW5zaW9uVHlwZXMoKS5hZGQodGhpcy5hc3QubmV3RGltZW5zaW9uKG51bGwpKTsKKwkJ
ZnJhZ21lbnQuZ2V0RXh0cmFEaW1lbnNpb25UeXBlcygpLmFkZCh0aGlzLmFzdC5uZXdEaW1lbnNp
b24obnVsbCkpOwogCQlmaWVsZERlY2xhcmF0aW9uLmZyYWdtZW50cygpLmFkZChmcmFnbWVudCk7
CiAJCWFzc2VydFRydWUoIkJvdGggQVNUIHRyZWVzIHNob3VsZCBiZSBpZGVudGljYWwiLCBmaWVs
ZERlY2xhcmF0aW9uLnN1YnRyZWVNYXRjaChuZXcgQVNUTWF0Y2hlcigpLCBub2RlKSk7CQkvLyRO
T04tTkxTLTEkCkBAIC05NTg0LDQgKzk1OTcsNiBAQAogCQlhc3NlcnRFcXVhbHMoIldyb25nIHF1
YWxpZmllZCBuYW1lIiwgImphdmEubGFuZy5TdHJpbmdbXSIsIHR5cGVCaW5kaW5nMi5nZXRRdWFs
aWZpZWROYW1lKCkpOyAvLyROT04tTkxTLTEkIC8vJE5PTi1OTFMtMiQKIAkJYXNzZXJ0RXF1YWxz
KCJXcm9uZyBkaW1lbnNpb24iLCAxLCB0eXBlQmluZGluZzIuZ2V0RGltZW5zaW9ucygpKTsgLy8k
Tk9OLU5MUy0xJAorCQlMaXN0IGV4dHJhRGltZW5zaW9ucyA9IG1ldGhvZERlY2xhcmF0aW9uLmdl
dEV4dHJhQW5ub3RhdGVkRGltZW5zaW9ucygpOworCQlhc3NlcnRFeHRyYURpbWVuc2lvbnNFcXVh
bCgiV3JvbmcgZXh0cmEgZGltZW5zaW9uIGluZm8iLCBleHRyYURpbWVuc2lvbnMsICJbXSAiKTsK
IAl9CiAKQEAgLTk2NTYsNSArOTY3MSw1IEBACiAJCVR5cGUgdHlwZSA9IHNpbmdsZVZhcmlhYmxl
RGVjbGFyYXRpb24uZ2V0VHlwZSgpOwogCQljaGVja1NvdXJjZVJhbmdlKHR5cGUsICJTdHJpbmci
LCBzb3VyY2UpOyAvLyROT04tTkxTLTEkCi0JCWFzc2VydEVxdWFscygiV3JvbmcgZGltZW5zaW9u
IiwgMSwgc2luZ2xlVmFyaWFibGVEZWNsYXJhdGlvbi5nZXRFeHRyYURpbWVuc2lvbnMoKSk7IC8v
JE5PTi1OTFMtMSQKKwkJYXNzZXJ0RXF1YWxzKCJXcm9uZyBkaW1lbnNpb24iLCAxLCBzaW5nbGVW
YXJpYWJsZURlY2xhcmF0aW9uLmdldEV4dHJhRGltZW5zaW9uVHlwZXMoKS5zaXplKCkpOyAvLyRO
T04tTkxTLTEkCiAJCUlUeXBlQmluZGluZyB0eXBlQmluZGluZyA9IHR5cGUucmVzb2x2ZUJpbmRp
bmcoKTsKIAkJYXNzZXJ0Tm90TnVsbCgiTm8gdHlwZSBiaW5kaW5nIiwgdHlwZUJpbmRpbmcpOyAv
LyROT04tTkxTLTEkCkBAIC05NjcwLDQgKzk2ODUsNiBAQAogCQlhc3NlcnRFcXVhbHMoIldyb25n
IGRpbWVuc2lvbiIsIDEsIHR5cGVCaW5kaW5nMi5nZXREaW1lbnNpb25zKCkpOyAvLyROT04tTkxT
LTEkCiAJCWFzc2VydEVxdWFscygid3JvbmcgZnVsbHkgcXVhbGlmaWVkIG5hbWUiLCAiamF2YS5s
YW5nLlN0cmluZ1tdIiwgdHlwZUJpbmRpbmcyLmdldFF1YWxpZmllZE5hbWUoKSk7IC8vJE5PTi1O
TFMtMSQgLy8kTk9OLU5MUy0yJAorCQlMaXN0IGV4dHJhRGltZW5zaW9ucyA9IHNpbmdsZVZhcmlh
YmxlRGVjbGFyYXRpb24uZ2V0RXh0cmFEaW1lbnNpb25UeXBlcygpOworCQlhc3NlcnRFeHRyYURp
bWVuc2lvbnNFcXVhbCgiV3JvbmcgZXh0cmEgZGltZW5zaW9uIGluZm8iLCBleHRyYURpbWVuc2lv
bnMsICJbXSAiKTsKIAl9CiAKQEAgLTk2ODgsNSArOTcwNSw1IEBACiAJCVR5cGUgdHlwZSA9IHNp
bmdsZVZhcmlhYmxlRGVjbGFyYXRpb24uZ2V0VHlwZSgpOwogCQljaGVja1NvdXJjZVJhbmdlKHR5
cGUsICJTdHJpbmdbXSIsIHNvdXJjZSk7IC8vJE5PTi1OTFMtMSQKLQkJYXNzZXJ0RXF1YWxzKCJX
cm9uZyBkaW1lbnNpb24iLCAyLCBzaW5nbGVWYXJpYWJsZURlY2xhcmF0aW9uLmdldEV4dHJhRGlt
ZW5zaW9ucygpKTsgLy8kTk9OLU5MUy0xJAorCQlhc3NlcnRFcXVhbHMoIldyb25nIGRpbWVuc2lv
biIsIDIsIHNpbmdsZVZhcmlhYmxlRGVjbGFyYXRpb24uZ2V0RXh0cmFEaW1lbnNpb25UeXBlcygp
LnNpemUoKSk7IC8vJE5PTi1OTFMtMSQKIAkJSVR5cGVCaW5kaW5nIHR5cGVCaW5kaW5nID0gdHlw
ZS5yZXNvbHZlQmluZGluZygpOwogCQlhc3NlcnROb3ROdWxsKCJObyB0eXBlIGJpbmRpbmciLCB0
eXBlQmluZGluZyk7IC8vJE5PTi1OTFMtMSQKZGlmZiAtLWdpdCBhL29yZy5lY2xpcHNlLmpkdC5j
b3JlLnRlc3RzLm1vZGVsL3NyYy9vcmcvZWNsaXBzZS9qZHQvY29yZS90ZXN0cy9kb20vQVNUQ29u
dmVydGVyVGVzdEFTVDhfMi5qYXZhIGIvb3JnLmVjbGlwc2UuamR0LmNvcmUudGVzdHMubW9kZWwv
c3JjL29yZy9lY2xpcHNlL2pkdC9jb3JlL3Rlc3RzL2RvbS9BU1RDb252ZXJ0ZXJUZXN0QVNUOF8y
LmphdmEKaW5kZXggZWMyZmY3YS4uMmU4YWY2YyAxMDA2NDQKLS0tIGEvb3JnLmVjbGlwc2UuamR0
LmNvcmUudGVzdHMubW9kZWwvc3JjL29yZy9lY2xpcHNlL2pkdC9jb3JlL3Rlc3RzL2RvbS9BU1RD
b252ZXJ0ZXJUZXN0QVNUOF8yLmphdmEKKysrIGIvb3JnLmVjbGlwc2UuamR0LmNvcmUudGVzdHMu
bW9kZWwvc3JjL29yZy9lY2xpcHNlL2pkdC9jb3JlL3Rlc3RzL2RvbS9BU1RDb252ZXJ0ZXJUZXN0
QVNUOF8yLmphdmEKQEAgLTI3NzUsNSArMjc3NSw1IEBACiAJCWFzc2VydEVxdWFscygid3Jvbmcg
c2l6ZSIsIDEsIGZyYWdtZW50cy5zaXplKCkpOwogCQlWYXJpYWJsZURlY2xhcmF0aW9uRnJhZ21l
bnQgZnJhZ21lbnQgPSAoVmFyaWFibGVEZWNsYXJhdGlvbkZyYWdtZW50KSBmcmFnbWVudHMuZ2V0
KDApOwotCQlhc3NlcnRFcXVhbHMoIndyb25nIGV4dHJhIGRpbWVuc2lvbiIsIDEsIGZyYWdtZW50
LmdldEV4dHJhRGltZW5zaW9ucygpKTsKKwkJYXNzZXJ0RXF1YWxzKCJ3cm9uZyBleHRyYSBkaW1l
bnNpb24iLCAxLCBmcmFnbWVudC5nZXRFeHRyYURpbWVuc2lvblR5cGVzKCkuc2l6ZSgpKTsKIAl9
CiAKZGlmZiAtLWdpdCBhL29yZy5lY2xpcHNlLmpkdC5jb3JlLnRlc3RzLm1vZGVsL3NyYy9vcmcv
ZWNsaXBzZS9qZHQvY29yZS90ZXN0cy9kb20vQ29udmVydGVyVGVzdFNldHVwLmphdmEgYi9vcmcu
ZWNsaXBzZS5qZHQuY29yZS50ZXN0cy5tb2RlbC9zcmMvb3JnL2VjbGlwc2UvamR0L2NvcmUvdGVz
dHMvZG9tL0NvbnZlcnRlclRlc3RTZXR1cC5qYXZhCmluZGV4IGNkYmM0YTAuLmJmM2I5NTMgMTAw
NjQ0Ci0tLSBhL29yZy5lY2xpcHNlLmpkdC5jb3JlLnRlc3RzLm1vZGVsL3NyYy9vcmcvZWNsaXBz
ZS9qZHQvY29yZS90ZXN0cy9kb20vQ29udmVydGVyVGVzdFNldHVwLmphdmEKKysrIGIvb3JnLmVj
bGlwc2UuamR0LmNvcmUudGVzdHMubW9kZWwvc3JjL29yZy9lY2xpcHNlL2pkdC9jb3JlL3Rlc3Rz
L2RvbS9Db252ZXJ0ZXJUZXN0U2V0dXAuamF2YQpAQCAtMTYsNCArMTYsNSBAQAogCiBpbXBvcnQg
amF2YS5pby5JT0V4Y2VwdGlvbjsKK2ltcG9ydCBqYXZhLnV0aWwuSXRlcmF0b3I7CiBpbXBvcnQg
amF2YS51dGlsLkxpc3Q7CiBpbXBvcnQgamF2YS51dGlsLk1hcDsKQEAgLTE0Miw0ICsxNDMsMjAg
QEAKIAl9CiAKKwlwcm90ZWN0ZWQgdm9pZCBhc3NlcnRFeHRyYURpbWVuc2lvbnNFcXVhbChTdHJp
bmcgbWVzc2FnZSwgTGlzdCBkaW1lbnNpb25zLCBTdHJpbmcgZXhwZWN0ZWQpIHsKKwkJU3RyaW5n
QnVmZmVyIGJ1ZmZlciA9IG5ldyBTdHJpbmdCdWZmZXIoKTsKKwkJSXRlcmF0b3IgaXRlciA9IGRp
bWVuc2lvbnMuaXRlcmF0b3IoKTsKKwkJd2hpbGUoaXRlci5oYXNOZXh0KCkpIHsKKwkJCURpbWVu
c2lvblR5cGUgZGltID0gKERpbWVuc2lvblR5cGUpIGl0ZXIubmV4dCgpOworCQkJSXRlcmF0b3Ig
YW5ub3RhdGlvbnMgPSBkaW0uYW5ub3RhdGlvbnMoKS5pdGVyYXRvcigpOworCQkJd2hpbGUgKGFu
bm90YXRpb25zLmhhc05leHQoKSkgeworCQkJCWJ1ZmZlci5hcHBlbmQoJ0AnKTsKKwkJCQlidWZm
ZXIuYXBwZW5kKCgoQW5ub3RhdGlvbikgYW5ub3RhdGlvbnMubmV4dCgpKS5nZXRUeXBlTmFtZSgp
LmdldEZ1bGx5UXVhbGlmaWVkTmFtZSgpKTsKKwkJCQlidWZmZXIuYXBwZW5kKCcgJyk7CisJCQl9
CisJCQlidWZmZXIuYXBwZW5kKCJbXSAiKTsKKwkJfQorCQlhc3NlcnRFcXVhbHMobWVzc2FnZSwg
ZXhwZWN0ZWQsIGJ1ZmZlci50b1N0cmluZygpKTsKKwl9CisKIAlwdWJsaWMgQVNUTm9kZSBydW5D
b252ZXJzaW9uKElDb21waWxhdGlvblVuaXQgdW5pdCwgYm9vbGVhbiByZXNvbHZlQmluZGluZ3Ms
CiAJCQlib29sZWFuIGJpbmRpbmdzUmVjb3ZlcnkpIHsKZGlmZiAtLWdpdCBhL29yZy5lY2xpcHNl
LmpkdC5jb3JlLnRlc3RzLm1vZGVsL3NyYy9vcmcvZWNsaXBzZS9qZHQvY29yZS90ZXN0cy9kb20v
UnVuQ29udmVydGVyVGVzdHMuamF2YSBiL29yZy5lY2xpcHNlLmpkdC5jb3JlLnRlc3RzLm1vZGVs
L3NyYy9vcmcvZWNsaXBzZS9qZHQvY29yZS90ZXN0cy9kb20vUnVuQ29udmVydGVyVGVzdHMuamF2
YQppbmRleCBlMGUxMWMxLi5mODk3NDQ1IDEwMDY0NAotLS0gYS9vcmcuZWNsaXBzZS5qZHQuY29y
ZS50ZXN0cy5tb2RlbC9zcmMvb3JnL2VjbGlwc2UvamR0L2NvcmUvdGVzdHMvZG9tL1J1bkNvbnZl
cnRlclRlc3RzLmphdmEKKysrIGIvb3JnLmVjbGlwc2UuamR0LmNvcmUudGVzdHMubW9kZWwvc3Jj
L29yZy9lY2xpcHNlL2pkdC9jb3JlL3Rlc3RzL2RvbS9SdW5Db252ZXJ0ZXJUZXN0cy5qYXZhCkBA
IC0zNCw0ICszNCw1IEBACiAJCUFTVENvbnZlcnRlcjE2VGVzdC5jbGFzcywKIAkJQVNUQ29udmVy
dGVyMTdUZXN0LmNsYXNzLAorCQlBU1RDb252ZXJ0ZXIxOFRlc3QuY2xhc3MsCiAJCUFTVENvbnZl
cnRlckFTVDNUZXN0LmNsYXNzLAogCQlBU1RDb252ZXJ0ZXJUZXN0QVNUM18yLmNsYXNzLApkaWZm
IC0tZ2l0IGEvb3JnLmVjbGlwc2UuamR0LmNvcmUvLnNldHRpbmdzLy5hcGlfZmlsdGVycyBiL29y
Zy5lY2xpcHNlLmpkdC5jb3JlLy5zZXR0aW5ncy8uYXBpX2ZpbHRlcnMKbmV3IGZpbGUgbW9kZSAx
MDA2NDQKaW5kZXggMDAwMDAwMC4uOGE4NWY1NwotLS0gL2Rldi9udWxsCisrKyBiL29yZy5lY2xp
cHNlLmpkdC5jb3JlLy5zZXR0aW5ncy8uYXBpX2ZpbHRlcnMKQEAgLTAsMCArMSwxMSBAQAorPD94
bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0iVVRGLTgiIHN0YW5kYWxvbmU9Im5vIj8+Cis8Y29t
cG9uZW50IGlkPSJvcmcuZWNsaXBzZS5qZHQuY29yZSIgdmVyc2lvbj0iMiI+CisgICAgPHJlc291
cmNlIHBhdGg9ImRvbS9vcmcvZWNsaXBzZS9qZHQvY29yZS9kb20vVmFyaWFibGVEZWNsYXJhdGlv
bi5qYXZhIiB0eXBlPSJvcmcuZWNsaXBzZS5qZHQuY29yZS5kb20uVmFyaWFibGVEZWNsYXJhdGlv
biI+CisgICAgICAgIDxmaWx0ZXIgaWQ9IjMzNjY5NTMzNyI+CisgICAgICAgICAgICA8bWVzc2Fn
ZV9hcmd1bWVudHM+CisgICAgICAgICAgICAgICAgPG1lc3NhZ2VfYXJndW1lbnQgdmFsdWU9Im9y
Zy5lY2xpcHNlLmpkdC5jb3JlLmRvbS5WYXJpYWJsZURlY2xhcmF0aW9uIi8+CisgICAgICAgICAg
ICAgICAgPG1lc3NhZ2VfYXJndW1lbnQgdmFsdWU9ImdldEV4dHJhRGltZW5zaW9uVHlwZXMoKSIv
PgorICAgICAgICAgICAgPC9tZXNzYWdlX2FyZ3VtZW50cz4KKyAgICAgICAgPC9maWx0ZXI+Cisg
ICAgPC9yZXNvdXJjZT4KKzwvY29tcG9uZW50PgpkaWZmIC0tZ2l0IGEvb3JnLmVjbGlwc2UuamR0
LmNvcmUvZG9tL29yZy9lY2xpcHNlL2pkdC9jb3JlL2RvbS9BU1QuamF2YSBiL29yZy5lY2xpcHNl
LmpkdC5jb3JlL2RvbS9vcmcvZWNsaXBzZS9qZHQvY29yZS9kb20vQVNULmphdmEKaW5kZXggMGQ1
YWVkNS4uZGM2NzQ1ZSAxMDA2NDQKLS0tIGEvb3JnLmVjbGlwc2UuamR0LmNvcmUvZG9tL29yZy9l
Y2xpcHNlL2pkdC9jb3JlL2RvbS9BU1QuamF2YQorKysgYi9vcmcuZWNsaXBzZS5qZHQuY29yZS9k
b20vb3JnL2VjbGlwc2UvamR0L2NvcmUvZG9tL0FTVC5qYXZhCkBAIC0xMTE1LDQgKzExMTUsMTYg
QEAKIAkJcmV0dXJuIHJlc3VsdDsKIAl9CisJCisJLyoqCisJICogQHNpbmNlIDMuOQorCSAqLwor
CXB1YmxpYyBEaW1lbnNpb25UeXBlIG5ld0RpbWVuc2lvbihBbm5vdGF0aW9uW10gYW5ub3RhdGlv
bnMpIHsKKwkJRGltZW5zaW9uVHlwZSByZXN1bHQgPSBuZXcgRGltZW5zaW9uVHlwZSh0aGlzKTsK
KwkJaW50IGxlbmd0aCA9IChhbm5vdGF0aW9ucyA9PSBudWxsKSA/IDAgOiBhbm5vdGF0aW9ucy5s
ZW5ndGg7CisJCWZvciAoaW50IGkgPSAwOyBpIDwgbGVuZ3RoOyBpKyspIHsKKwkJCXJlc3VsdC5h
bm5vdGF0aW9ucy5hZGQoYW5ub3RhdGlvbnNbaV0pOworCQl9CisJCXJldHVybiByZXN1bHQ7CisJ
fQogCiAJLyoqCmRpZmYgLS1naXQgYS9vcmcuZWNsaXBzZS5qZHQuY29yZS9kb20vb3JnL2VjbGlw
c2UvamR0L2NvcmUvZG9tL0FTVENvbnZlcnRlci5qYXZhIGIvb3JnLmVjbGlwc2UuamR0LmNvcmUv
ZG9tL29yZy9lY2xpcHNlL2pkdC9jb3JlL2RvbS9BU1RDb252ZXJ0ZXIuamF2YQppbmRleCAxYmJj
ODZhLi43NGMwYjljIDEwMDY0NAotLS0gYS9vcmcuZWNsaXBzZS5qZHQuY29yZS9kb20vb3JnL2Vj
bGlwc2UvamR0L2NvcmUvZG9tL0FTVENvbnZlcnRlci5qYXZhCisrKyBiL29yZy5lY2xpcHNlLmpk
dC5jb3JlL2RvbS9vcmcvZWNsaXBzZS9qZHQvY29yZS9kb20vQVNUQ29udmVydGVyLmphdmEKQEAg
LTQ5MSw0ICs0OTEsOCBAQAogCQkJCWludCBleHRyYURpbWVuc2lvbnMgPSByZXRyaWV2ZUV4dHJh
RGltZW5zaW9uKHJpZ2h0UGFyZW50aGVzaXNQb3NpdGlvbiwgbWV0aG9kLmJvZHlFbmQpOwogCQkJ
CW1ldGhvZERlY2wuc2V0RXh0cmFEaW1lbnNpb25zKGV4dHJhRGltZW5zaW9ucyk7CisJCQkJLy8g
VE9ETzogQW5ub3RhdGlvbnMgb24gZXh0cmEgZGltZW5zaW9ucyB0byBiZSByZW1vdmVkIChidWcg
MzkxODk1LCBjb21tZW50IDYKKwkJCQlpZiAodGhpcy5hc3QuYXBpTGV2ZWwgPj0gQVNULkpMUzgp
IHsKKwkJCQkJc2V0RXh0cmFBbm5vdGF0ZWREaW1lbnNpb25zKHJpZ2h0UGFyZW50aGVzaXNQb3Np
dGlvbiwgdGhpcy5zY2FubmVyLmN1cnJlbnRQb3NpdGlvbiwgIHR5cGVSZWZlcmVuY2UsIG1ldGhv
ZERlY2wuZXh0cmFBbm5vdGF0ZWREaW1lbnNpb25zLCBleHRyYURpbWVuc2lvbnMpOworCQkJCX0K
IAkJCQlzZXRUeXBlRm9yTWV0aG9kRGVjbGFyYXRpb24obWV0aG9kRGVjbCwgcmV0dXJuVHlwZSwg
ZXh0cmFEaW1lbnNpb25zKTsKIAkJCX0gZWxzZSB7CkBAIC03ODEsNSArNzg1LDkgQEAKIAkJZmlu
YWwgaW50IHR5cGVTb3VyY2VFbmQgPSBhcmd1bWVudC50eXBlLnNvdXJjZUVuZDsKIAkJZmluYWwg
aW50IGV4dHJhRGltZW5zaW9ucyA9IHJldHJpZXZlRXh0cmFEaW1lbnNpb24obmFtZUVuZCArIDEs
IHR5cGVTb3VyY2VFbmQpOwotCQl2YXJpYWJsZURlY2wuc2V0RXh0cmFEaW1lbnNpb25zKGV4dHJh
RGltZW5zaW9ucyk7CisJCWlmICh0aGlzLmFzdC5hcGlMZXZlbCA+PSBBU1QuSkxTOCkgeworCQkJ
c2V0RXh0cmFBbm5vdGF0ZWREaW1lbnNpb25zKG5hbWVFbmQgKyAxLCB0aGlzLnNjYW5uZXIuY3Vy
cmVudFBvc2l0aW9uLCAgYXJndW1lbnQudHlwZSwgdmFyaWFibGVEZWNsLmV4dHJhRGltZW5zaW9u
VHlwZXMsIGV4dHJhRGltZW5zaW9ucyk7CisJCX0gZWxzZSB7CisJCQl2YXJpYWJsZURlY2wuc2V0
RXh0cmFEaW1lbnNpb25zKGV4dHJhRGltZW5zaW9ucyk7CisJCX0KIAkJZmluYWwgYm9vbGVhbiBp
c1ZhckFyZ3MgPSBhcmd1bWVudC5pc1ZhckFyZ3MoKTsKIAkJaWYgKGlzVmFyQXJncyAmJiBleHRy
YURpbWVuc2lvbnMgPT0gMCkgewpAQCAtODAyLDQgKzgxMCw1IEBACiAJCQlzZXRUeXBlRm9yU2lu
Z2xlVmFyaWFibGVEZWNsYXJhdGlvbih2YXJpYWJsZURlY2wsIHR5cGUsIGV4dHJhRGltZW5zaW9u
cyk7CiAJCX0KKwkJCiAJCXZhcmlhYmxlRGVjbC5zZXRTb3VyY2VSYW5nZShhcmd1bWVudC5kZWNs
YXJhdGlvblNvdXJjZVN0YXJ0LCByaWdodEVuZCAtIGFyZ3VtZW50LmRlY2xhcmF0aW9uU291cmNl
U3RhcnQgKyAxKTsKIApAQCAtMjg4OCw1ICsyODk3LDYgQEAKIAkJZmllbGREZWNsYXJhdGlvbi5z
ZXRTb3VyY2VSYW5nZShmaWVsZERlY2wuZGVjbGFyYXRpb25Tb3VyY2VTdGFydCwgZmllbGREZWNs
LmRlY2xhcmF0aW9uRW5kIC0gZmllbGREZWNsLmRlY2xhcmF0aW9uU291cmNlU3RhcnQgKyAxKTsK
IAkJVHlwZSB0eXBlID0gY29udmVydFR5cGUoZmllbGREZWNsLnR5cGUpOwotCQlzZXRUeXBlRm9y
RmllbGQoZmllbGREZWNsYXJhdGlvbiwgdHlwZSwgdmFyaWFibGVEZWNsYXJhdGlvbkZyYWdtZW50
LmdldEV4dHJhRGltZW5zaW9ucygpKTsKKwkJc2V0VHlwZUZvckZpZWxkKGZpZWxkRGVjbGFyYXRp
b24sIHR5cGUsIAorCQkJCSh0aGlzLmFzdC5hcGlMZXZlbCA8IEFTVC5KTFM4KSA/IHZhcmlhYmxl
RGVjbGFyYXRpb25GcmFnbWVudC5nZXRFeHRyYURpbWVuc2lvbnMoKSA6IHZhcmlhYmxlRGVjbGFy
YXRpb25GcmFnbWVudC5nZXRFeHRyYURpbWVuc2lvblR5cGVzKCkuc2l6ZSgpKTsKIAkJc2V0TW9k
aWZpZXJzKGZpZWxkRGVjbGFyYXRpb24sIGZpZWxkRGVjbCk7CiAJCWNvbnZlcnQoZmllbGREZWNs
LmphdmFkb2MsIGZpZWxkRGVjbGFyYXRpb24pOwpAQCAtMjkxOSw1ICsyOTI5LDYgQEAKIAkJdmFy
aWFibGVEZWNsYXJhdGlvbkV4cHJlc3Npb24uc2V0U291cmNlUmFuZ2UobG9jYWxEZWNsYXJhdGlv
bi5kZWNsYXJhdGlvblNvdXJjZVN0YXJ0LCBsb2NhbERlY2xhcmF0aW9uLmRlY2xhcmF0aW9uU291
cmNlRW5kIC0gbG9jYWxEZWNsYXJhdGlvbi5kZWNsYXJhdGlvblNvdXJjZVN0YXJ0ICsgMSk7CiAJ
CVR5cGUgdHlwZSA9IGNvbnZlcnRUeXBlKGxvY2FsRGVjbGFyYXRpb24udHlwZSk7Ci0JCXNldFR5
cGVGb3JWYXJpYWJsZURlY2xhcmF0aW9uRXhwcmVzc2lvbih2YXJpYWJsZURlY2xhcmF0aW9uRXhw
cmVzc2lvbiwgdHlwZSwgdmFyaWFibGVEZWNsYXJhdGlvbkZyYWdtZW50LmdldEV4dHJhRGltZW5z
aW9ucygpKTsKKwkJc2V0VHlwZUZvclZhcmlhYmxlRGVjbGFyYXRpb25FeHByZXNzaW9uKHZhcmlh
YmxlRGVjbGFyYXRpb25FeHByZXNzaW9uLCB0eXBlLCAKKwkJCQkodGhpcy5hc3QuYXBpTGV2ZWwg
PCBBU1QuSkxTOCkgPyB2YXJpYWJsZURlY2xhcmF0aW9uRnJhZ21lbnQuZ2V0RXh0cmFEaW1lbnNp
b25zKCkgOiB2YXJpYWJsZURlY2xhcmF0aW9uRnJhZ21lbnQuZ2V0RXh0cmFEaW1lbnNpb25UeXBl
cygpLnNpemUoKSk7CiAJCWlmIChsb2NhbERlY2xhcmF0aW9uLm1vZGlmaWVyc1NvdXJjZVN0YXJ0
ICE9IC0xKSB7CiAJCQlzZXRNb2RpZmllcnModmFyaWFibGVEZWNsYXJhdGlvbkV4cHJlc3Npb24s
IGxvY2FsRGVjbGFyYXRpb24pOwpAQCAtMjkzNiw1ICsyOTQ3LDkgQEAKIAkJdmFyaWFibGVEZWNs
LnNldE5hbWUobmFtZSk7CiAJCWZpbmFsIGludCBleHRyYURpbWVuc2lvbnMgPSByZXRyaWV2ZUV4
dHJhRGltZW5zaW9uKG5hbWVFbmQgKyAxLCBsb2NhbERlY2xhcmF0aW9uLnR5cGUuc291cmNlRW5k
KTsKLQkJdmFyaWFibGVEZWNsLnNldEV4dHJhRGltZW5zaW9ucyhleHRyYURpbWVuc2lvbnMpOwor
CQlpZiAodGhpcy5hc3QuYXBpTGV2ZWwgPj0gQVNULkpMUzgpIHsKKwkJCXNldEV4dHJhQW5ub3Rh
dGVkRGltZW5zaW9ucyhuYW1lRW5kICsgMSwgdGhpcy5zY2FubmVyLmN1cnJlbnRQb3NpdGlvbiwg
IGxvY2FsRGVjbGFyYXRpb24udHlwZSwgdmFyaWFibGVEZWNsLmV4dHJhRGltZW5zaW9uVHlwZXMs
IGV4dHJhRGltZW5zaW9ucyk7CisJCX0gZWxzZSB7CisJCQl2YXJpYWJsZURlY2wuc2V0RXh0cmFE
aW1lbnNpb25zKGV4dHJhRGltZW5zaW9ucyk7CisJCX0KIAkJVHlwZSB0eXBlID0gY29udmVydFR5
cGUobG9jYWxEZWNsYXJhdGlvbi50eXBlKTsKIAkJaW50IHR5cGVFbmQgPSB0eXBlLmdldFN0YXJ0
UG9zaXRpb24oKSArIHR5cGUuZ2V0TGVuZ3RoKCkgLSAxOwpAQCAtMjk0NSw0ICsyOTYwLDUgQEAK
IAkJICovCiAJCXNldFR5cGVGb3JTaW5nbGVWYXJpYWJsZURlY2xhcmF0aW9uKHZhcmlhYmxlRGVj
bCwgdHlwZSwgZXh0cmFEaW1lbnNpb25zKTsKKwogCQl2YXJpYWJsZURlY2wuc2V0U291cmNlUmFu
Z2UobG9jYWxEZWNsYXJhdGlvbi5kZWNsYXJhdGlvblNvdXJjZVN0YXJ0LCByaWdodEVuZCAtIGxv
Y2FsRGVjbGFyYXRpb24uZGVjbGFyYXRpb25Tb3VyY2VTdGFydCArIDEpOwogCQlpZiAodGhpcy5y
ZXNvbHZlQmluZGluZ3MpIHsKQEAgLTI5NTIsNCArMjk2OCwxNSBAQAogCQl9CiAJCXJldHVybiB2
YXJpYWJsZURlY2w7CisJfQorCisJcHJpdmF0ZSBEaW1lbnNpb25UeXBlIGNvbnZlcnRUb0RpbWVu
c2lvbihpbnQgc3RhcnQsIGludCBlbmQsIG9yZy5lY2xpcHNlLmpkdC5pbnRlcm5hbC5jb21waWxl
ci5hc3QuQW5ub3RhdGlvbltdIGFubm90YXRpb24pIHsKKwkJaW50IGxlbmd0aCA9IGFubm90YXRp
b24gPT0gbnVsbCA/IDAgOiBhbm5vdGF0aW9uLmxlbmd0aDsKKwkJQW5ub3RhdGlvbltdIGFubm90
YXRpb25zID0gbmV3IEFubm90YXRpb25bbGVuZ3RoXTsKKwkJZm9yIChpbnQgaSA9IDA7IGkgPCBs
ZW5ndGg7IGkrKykgeworCQkJYW5ub3RhdGlvbnNbaV0gPSBjb252ZXJ0KGFubm90YXRpb25baV0p
OworCQl9CisJCURpbWVuc2lvblR5cGUgZGltZW5zaW9uID0gdGhpcy5hc3QubmV3RGltZW5zaW9u
KGFubm90YXRpb25zKTsKKwkJcmV0cmlldmVEaW1lbnNpb25BbmRTZXRQb3NpdGlvbnMoc3RhcnQs
IGVuZCwgZGltZW5zaW9uKTsKKwkJcmV0dXJuIGRpbWVuc2lvbjsKIAl9CiAKQEAgLTI5NjMsNSAr
Mjk5MCw5IEBACiAJCWludCBlbmQgPSBzdGFydDsKIAkJaW50IGV4dHJhRGltZW5zaW9ucyA9IHJl
dHJpZXZlRXh0cmFEaW1lbnNpb24oZmllbGREZWNsYXJhdGlvbi5zb3VyY2VFbmQgKyAxLCBmaWVs
ZERlY2xhcmF0aW9uLmRlY2xhcmF0aW9uU291cmNlRW5kICk7Ci0JCXZhcmlhYmxlRGVjbGFyYXRp
b25GcmFnbWVudC5zZXRFeHRyYURpbWVuc2lvbnMoZXh0cmFEaW1lbnNpb25zKTsKKwkJaWYgKHRo
aXMuYXN0LmFwaUxldmVsID49IEFTVC5KTFM4KSB7CisJCQlzZXRFeHRyYUFubm90YXRlZERpbWVu
c2lvbnMoZmllbGREZWNsYXJhdGlvbi5zb3VyY2VFbmQgKyAxLCB0aGlzLnNjYW5uZXIuY3VycmVu
dFBvc2l0aW9uLCBmaWVsZERlY2xhcmF0aW9uLnR5cGUsIHZhcmlhYmxlRGVjbGFyYXRpb25GcmFn
bWVudC5leHRyYURpbWVuc2lvblR5cGVzLCBleHRyYURpbWVuc2lvbnMpOworCQl9IGVsc2Ugewor
CQkJdmFyaWFibGVEZWNsYXJhdGlvbkZyYWdtZW50LnNldEV4dHJhRGltZW5zaW9ucyhleHRyYURp
bWVuc2lvbnMpOworCQl9CiAJCWlmIChmaWVsZERlY2xhcmF0aW9uLmluaXRpYWxpemF0aW9uICE9
IG51bGwpIHsKIAkJCWZpbmFsIEV4cHJlc3Npb24gZXhwcmVzc2lvbiA9IGNvbnZlcnQoZmllbGRE
ZWNsYXJhdGlvbi5pbml0aWFsaXphdGlvbik7CkBAIC0zMDAxLDUgKzMwMzIsMTAgQEAKIAkJb3Jn
LmVjbGlwc2UuamR0LmludGVybmFsLmNvbXBpbGVyLmFzdC5FeHByZXNzaW9uIGluaXRpYWxpemF0
aW9uID0gbG9jYWxEZWNsYXJhdGlvbi5pbml0aWFsaXphdGlvbjsKIAkJaW50IGV4dHJhRGltZW5z
aW9uID0gcmV0cmlldmVFeHRyYURpbWVuc2lvbihsb2NhbERlY2xhcmF0aW9uLnNvdXJjZUVuZCAr
IDEsIHRoaXMuY29tcGlsYXRpb25Vbml0U291cmNlTGVuZ3RoKTsKLQkJdmFyaWFibGVEZWNsYXJh
dGlvbkZyYWdtZW50LnNldEV4dHJhRGltZW5zaW9ucyhleHRyYURpbWVuc2lvbik7CisJCWlmICh0
aGlzLmFzdC5hcGlMZXZlbCA+PSBBU1QuSkxTOCkgeworCQkJc2V0RXh0cmFBbm5vdGF0ZWREaW1l
bnNpb25zKGxvY2FsRGVjbGFyYXRpb24uc291cmNlRW5kICsgMSwgdGhpcy5zY2FubmVyLmN1cnJl
bnRQb3NpdGlvbiwgbG9jYWxEZWNsYXJhdGlvbi50eXBlLCB2YXJpYWJsZURlY2xhcmF0aW9uRnJh
Z21lbnQuZXh0cmFEaW1lbnNpb25UeXBlcywgZXh0cmFEaW1lbnNpb24pOworCQl9IGVsc2Ugewor
CQkJdmFyaWFibGVEZWNsYXJhdGlvbkZyYWdtZW50LnNldEV4dHJhRGltZW5zaW9ucyhleHRyYURp
bWVuc2lvbik7CisJCX0KKwkJCiAJCWJvb2xlYW4gaGFzSW5pdGlhbGl6YXRpb24gPSBpbml0aWFs
aXphdGlvbiAhPSBudWxsOwogCQlpbnQgZW5kOwpAQCAtMzAzMiw0ICszMDY4LDE2IEBACiAJfQog
CisJcHJvdGVjdGVkIHZvaWQgc2V0RXh0cmFBbm5vdGF0ZWREaW1lbnNpb25zKGludCBzdGFydCwg
aW50IGVuZCwgVHlwZVJlZmVyZW5jZSB0eXBlLCBmaW5hbCBMaXN0IGV4dHJhQW5ub3RhdGVkRGlt
ZW5zaW9ucywgaW50IGV4dHJhRGltZW5zaW9uKSB7CisJCWlmIChleHRyYURpbWVuc2lvbiA+IDAp
IHsKKwkJCW9yZy5lY2xpcHNlLmpkdC5pbnRlcm5hbC5jb21waWxlci5hc3QuQW5ub3RhdGlvbltd
W10gYW5ub3RhdGlvbnNPbkRpbXMgPSB0eXBlLmdldEFubm90YXRpb25zT25EaW1lbnNpb25zKCk7
CisJCQlpbnQgbGVuZ3RoID0gKGFubm90YXRpb25zT25EaW1zID09IG51bGwpID8gMCA6IGFubm90
YXRpb25zT25EaW1zLmxlbmd0aDsKKwkJCWZvciAoaW50IGkgPSAobGVuZ3RoIC0gZXh0cmFEaW1l
bnNpb24pOyBpIDwgbGVuZ3RoOyBpKyspIHsKKwkJCQlEaW1lbnNpb25UeXBlIGRpbSA9IGNvbnZl
cnRUb0RpbWVuc2lvbihzdGFydCwgZW5kLCAoYW5ub3RhdGlvbnNPbkRpbXMgPT0gbnVsbCkgPyBu
dWxsIDogYW5ub3RhdGlvbnNPbkRpbXNbaV0pOworCQkJCWV4dHJhQW5ub3RhdGVkRGltZW5zaW9u
cy5hZGQoZGltKTsKKwkJCQlzdGFydCA9IGRpbS5nZXRTdGFydFBvc2l0aW9uKCkgKyBkaW0uZ2V0
TGVuZ3RoKCk7CisJCQl9CisJCX0KKwl9CisKIAlwcm90ZWN0ZWQgVmFyaWFibGVEZWNsYXJhdGlv
blN0YXRlbWVudCBjb252ZXJ0VG9WYXJpYWJsZURlY2xhcmF0aW9uU3RhdGVtZW50KG9yZy5lY2xp
cHNlLmpkdC5pbnRlcm5hbC5jb21waWxlci5hc3QuTG9jYWxEZWNsYXJhdGlvbiBsb2NhbERlY2xh
cmF0aW9uKSB7CiAJCWZpbmFsIFZhcmlhYmxlRGVjbGFyYXRpb25GcmFnbWVudCB2YXJpYWJsZURl
Y2xhcmF0aW9uRnJhZ21lbnQgPSBjb252ZXJ0VG9WYXJpYWJsZURlY2xhcmF0aW9uRnJhZ21lbnQo
bG9jYWxEZWNsYXJhdGlvbik7CkBAIC0zMDQxLDUgKzMwODksNiBAQAogCQl2YXJpYWJsZURlY2xh
cmF0aW9uU3RhdGVtZW50LnNldFNvdXJjZVJhbmdlKGxvY2FsRGVjbGFyYXRpb24uZGVjbGFyYXRp
b25Tb3VyY2VTdGFydCwgbG9jYWxEZWNsYXJhdGlvbi5kZWNsYXJhdGlvblNvdXJjZUVuZCAtIGxv
Y2FsRGVjbGFyYXRpb24uZGVjbGFyYXRpb25Tb3VyY2VTdGFydCArIDEpOwogCQlUeXBlIHR5cGUg
PSBjb252ZXJ0VHlwZShsb2NhbERlY2xhcmF0aW9uLnR5cGUpOwotCQlzZXRUeXBlRm9yVmFyaWFi
bGVEZWNsYXJhdGlvblN0YXRlbWVudCh2YXJpYWJsZURlY2xhcmF0aW9uU3RhdGVtZW50LCB0eXBl
LCB2YXJpYWJsZURlY2xhcmF0aW9uRnJhZ21lbnQuZ2V0RXh0cmFEaW1lbnNpb25zKCkpOworCQlz
ZXRUeXBlRm9yVmFyaWFibGVEZWNsYXJhdGlvblN0YXRlbWVudCh2YXJpYWJsZURlY2xhcmF0aW9u
U3RhdGVtZW50LCB0eXBlLCAKKwkJCQkodGhpcy5hc3QuYXBpTGV2ZWwgPCBBU1QuSkxTOCkgPyB2
YXJpYWJsZURlY2xhcmF0aW9uRnJhZ21lbnQuZ2V0RXh0cmFEaW1lbnNpb25zKCkgOiB2YXJpYWJs
ZURlY2xhcmF0aW9uRnJhZ21lbnQuZ2V0RXh0cmFEaW1lbnNpb25UeXBlcygpLnNpemUoKSk7CiAJ
CWlmIChsb2NhbERlY2xhcmF0aW9uLm1vZGlmaWVyc1NvdXJjZVN0YXJ0ICE9IC0xKSB7CiAJCQlz
ZXRNb2RpZmllcnModmFyaWFibGVEZWNsYXJhdGlvblN0YXRlbWVudCwgbG9jYWxEZWNsYXJhdGlv
bik7CkBAIC0zMTExLDUgKzMxNjAsNSBAQAogCQl9CiAJfQotCisJCiAJcHVibGljIFR5cGUgY29u
dmVydFR5cGUoVHlwZVJlZmVyZW5jZSB0eXBlUmVmZXJlbmNlKSB7CiAJCW9yZy5lY2xpcHNlLmpk
dC5pbnRlcm5hbC5jb21waWxlci5hc3QuQW5ub3RhdGlvbltdIGFubm90YXRpb25zOwpAQCAtNDI0
Miw0ICs0MjkxLDUgQEAKIAkJdHJ5IHsKIAkJCWludCB0b2tlbjsKKwkJCWJvb2xlYW4gaXNBbm5v
dGF0aW9uID0gZmFsc2U7CiAJCQl3aGlsZSAoKHRva2VuID0gdGhpcy5zY2FubmVyLmdldE5leHRU
b2tlbigpKSAhPSBUZXJtaW5hbFRva2Vucy5Ub2tlbk5hbWVFT0YpIHsKIAkJCQlzd2l0Y2godG9r
ZW4pIHsKQEAgLTQyNDgsNiArNDI5OCwxNyBAQAogCQkJCQljYXNlIFRlcm1pbmFsVG9rZW5zLlRv
a2VuTmFtZUNPTU1FTlRfSkFWQURPQzoKIAkJCQkJY2FzZSBUZXJtaW5hbFRva2Vucy5Ub2tlbk5h
bWVDT01NRU5UX0xJTkU6CisJCQkJCQlpc0Fubm90YXRpb24gPSBmYWxzZTsKKwkJCQkJCWJyZWFr
OworCQkJCQljYXNlIFRlcm1pbmFsVG9rZW5zLlRva2VuTmFtZUFUOgorCQkJCQkJaXNBbm5vdGF0
aW9uID0gdHJ1ZTsKKwkJCQkJCWJyZWFrOworCQkJCQljYXNlIFRlcm1pbmFsVG9rZW5zLlRva2Vu
TmFtZUlkZW50aWZpZXI6CisJCQkJCQlpZiAoIWlzQW5ub3RhdGlvbikgeworCQkJCQkJCXJldHVy
biBkaW1lbnNpb25zOworCQkJCQkJfQorCQkJCQkJaXNBbm5vdGF0aW9uID0gZmFsc2U7CiAJCQkJ
CQlicmVhazsKIAkJCQkJY2FzZSBUZXJtaW5hbFRva2Vucy5Ub2tlbk5hbWVSQlJBQ0tFVDovLzE2
NgorCQkJCQkJaXNBbm5vdGF0aW9uID0gZmFsc2U7CiAJCQkJCQlkaW1lbnNpb25zKys7CiAJCQkJ
CQlicmVhazsKQEAgLTQyNjIsNCArNDMyMywzMCBAQAogCX0KIAorCXByb3RlY3RlZCB2b2lkIHJl
dHJpZXZlRGltZW5zaW9uQW5kU2V0UG9zaXRpb25zKGludCBzdGFydCwgaW50IGVuZCwgRGltZW5z
aW9uVHlwZSBkaW0pIHsKKwkJdGhpcy5zY2FubmVyLnJlc2V0VG8oc3RhcnQsIGVuZCk7CisJCWlu
dCB0b2tlbjsKKwkJYm9vbGVhbiBzdGFydFNldCA9IGZhbHNlOworCQl0cnkgeworCQkJd2hpbGUo
KHRva2VuID0gdGhpcy5zY2FubmVyLmdldE5leHRUb2tlbigpKSAhPSBUZXJtaW5hbFRva2Vucy5U
b2tlbk5hbWVFT0YpICB7CisJCQkJc3dpdGNoKHRva2VuKSB7CisJCQkJCWNhc2UgVGVybWluYWxU
b2tlbnMuVG9rZW5OYW1lV0hJVEVTUEFDRToKKwkJCQkJCWJyZWFrOworCQkJCQljYXNlIFRlcm1p
bmFsVG9rZW5zLlRva2VuTmFtZVJCUkFDS0VUOgorCQkJCQkJaW50IGVuZERpbSA9IHRoaXMuc2Nh
bm5lci5jdXJyZW50UG9zaXRpb24gLSAxOworCQkJCQkJZGltLnNldFNvdXJjZVJhbmdlKHN0YXJ0
LCBlbmREaW0gLSBzdGFydCArIDEpOworCQkJCQkJcmV0dXJuOworCQkJCQlkZWZhdWx0OgorCQkJ
CQkJaWYgKCFzdGFydFNldCkgeworCQkJCQkJCXN0YXJ0ID0gdGhpcy5zY2FubmVyLnN0YXJ0UG9z
aXRpb247CisJCQkJCQkJc3RhcnRTZXQgPSB0cnVlOworCQkJCQkJfQorCQkJCQkJYnJlYWs7CisJ
CQkJCQkKKwkJCQl9CisJCQl9CisJCX0gY2F0Y2goSW52YWxpZElucHV0RXhjZXB0aW9uIGUpIHsK
KwkJCS8vIGlnbm9yZQorCQl9CisJfQogCXByb3RlY3RlZCB2b2lkIHJldHJpZXZlSWRlbnRpZmll
ckFuZFNldFBvc2l0aW9ucyhpbnQgc3RhcnQsIGludCBlbmQsIE5hbWUgbmFtZSkgewogCQl0aGlz
LnNjYW5uZXIucmVzZXRUbyhzdGFydCwgZW5kKTsKQEAgLTUxNjUsNCArNTI1Miw1IEBACiAJCQlp
ZiAodHlwZS5pc0FycmF5VHlwZSgpKSB7CiAJCQkJQXJyYXlUeXBlIGFycmF5VHlwZSA9IChBcnJh
eVR5cGUpIHR5cGU7CisJCQkJCiAJCQkJaW50IHJlbWFpbmluZ0RpbWVuc2lvbnMgPSBhcnJheVR5
cGUuZ2V0RGltZW5zaW9ucygpIC0gZXh0cmFEaW1lbnNpb247CiAJCQkJaWYgKHJlbWFpbmluZ0Rp
bWVuc2lvbnMgPT0gMCkgIHsKQEAgLTUxOTksNSArNTI4Nyw1IEBACiAJCQkJCQlkZWZhdWx0IDoK
IAkJCQkJCQltZXRob2REZWNsYXJhdGlvbi5zZXRSZXR1cm5UeXBlMihzdWJhcnJheVR5cGUpOwot
CQkJCQkJYnJlYWs7CisJCQkJCQkJYnJlYWs7CiAJCQkJCX0KIAkJCQkJdGhpcy5hc3QuZ2V0Qmlu
ZGluZ1Jlc29sdmVyKCkudXBkYXRlS2V5KHR5cGUsIHN1YmFycmF5VHlwZSk7CmRpZmYgLS1naXQg
YS9vcmcuZWNsaXBzZS5qZHQuY29yZS9kb20vb3JnL2VjbGlwc2UvamR0L2NvcmUvZG9tL0FTVE1h
dGNoZXIuamF2YSBiL29yZy5lY2xpcHNlLmpkdC5jb3JlL2RvbS9vcmcvZWNsaXBzZS9qZHQvY29y
ZS9kb20vQVNUTWF0Y2hlci5qYXZhCmluZGV4IDY0MTg2YmIuLmZkNjRmMjEgMTAwNjQ0Ci0tLSBh
L29yZy5lY2xpcHNlLmpkdC5jb3JlL2RvbS9vcmcvZWNsaXBzZS9qZHQvY29yZS9kb20vQVNUTWF0
Y2hlci5qYXZhCisrKyBiL29yZy5lY2xpcHNlLmpkdC5jb3JlL2RvbS9vcmcvZWNsaXBzZS9qZHQv
Y29yZS9kb20vQVNUTWF0Y2hlci5qYXZhCkBAIC0zNDMsNCArMzQzLDI3IEBACiAKIAkvKioKKwkg
KiBAc2luY2UgMy45CisJICovCisJcHVibGljIGJvb2xlYW4gbWF0Y2goQW5ub3RhdGlvbltdIGZp
cnN0LCBBbm5vdGF0aW9uW10gc2Vjb25kKSB7CisJCWlmIChmaXJzdC5sZW5ndGggIT0gc2Vjb25k
Lmxlbmd0aCkKKwkJCXJldHVybiBmYWxzZTsKKwkJZm9yIChpbnQgaSA9IDA7IGkgPCBmaXJzdC5s
ZW5ndGg7IGkrKykgeworCQkJaWYgKCFzYWZlRXF1YWxzKGZpcnN0W2ldLCBzZWNvbmRbaV0pKQor
CQkJCXJldHVybiBmYWxzZTsKKwkJfQorCQlyZXR1cm4gdHJ1ZTsKKwl9CisKKwkvKioKKwkgKiBA
c2luY2UgMy45CisJICovCisJcHVibGljIGJvb2xlYW4gbWF0Y2goRGltZW5zaW9uVHlwZSBub2Rl
LCBPYmplY3Qgb3RoZXIpIHsKKwkJaWYgKCEob3RoZXIgaW5zdGFuY2VvZiBEaW1lbnNpb25UeXBl
KSkKKwkJCXJldHVybiBmYWxzZTsKKwkJRGltZW5zaW9uVHlwZSBvID0gKERpbWVuc2lvblR5cGUp
IG90aGVyOworCQlyZXR1cm4gc2FmZVN1YnRyZWVMaXN0TWF0Y2gobm9kZS5hbm5vdGF0aW9ucygp
LCBvLmFubm90YXRpb25zKCkpOworCX0KKworCS8qKgogCSAqIFJldHVybnMgd2hldGhlciB0aGUg
Z2l2ZW4gbm9kZSBhbmQgdGhlIG90aGVyIG9iamVjdCBtYXRjaC4KIAkgKiA8cD4KQEAgLTEzOTIs
NSArMTQxNSw1IEBACiAJCQkJLy8gbi5iLiBjb21wYXJlIHJldHVybiB0eXBlIGV2ZW4gZm9yIGNv
bnN0cnVjdG9ycwogCQkJCSYmIHNhZmVTdWJ0cmVlTGlzdE1hdGNoKG5vZGUucGFyYW1ldGVycygp
LCBvLnBhcmFtZXRlcnMoKSkKLQkgCQkJJiYgbm9kZS5nZXRFeHRyYURpbWVuc2lvbnMoKSA9PSBv
LmdldEV4dHJhRGltZW5zaW9ucygpCisJCQkJJiYgKChub2RlLmdldEFTVCgpLmFwaUxldmVsIDwg
QVNULkpMUzgpID8gKG5vZGUuZ2V0RXh0cmFEaW1lbnNpb25zKCkgPT0gby5nZXRFeHRyYURpbWVu
c2lvbnMoKSkgOiBzYWZlU3VidHJlZUxpc3RNYXRjaChub2RlLmdldEV4dHJhQW5ub3RhdGVkRGlt
ZW5zaW9ucygpLCBvLmdldEV4dHJhQW5ub3RhdGVkRGltZW5zaW9ucygpKSkJCQkJCiAJCQkJJiYg
c2FmZVN1YnRyZWVMaXN0TWF0Y2gobm9kZS50aHJvd25FeGNlcHRpb25zKCksIG8udGhyb3duRXhj
ZXB0aW9ucygpKQogCQkJCSYmIHNhZmVTdWJ0cmVlTWF0Y2gobm9kZS5nZXRCb2R5KCksIG8uZ2V0
Qm9keSgpKSk7CkBAIC0xODg1LDYgKzE5MDgsNiBAQAogCQkgICAgc2FmZVN1YnRyZWVNYXRjaChu
b2RlLmdldFR5cGUoKSwgby5nZXRUeXBlKCkpCiAJCQkJJiYgc2FmZVN1YnRyZWVNYXRjaChub2Rl
LmdldE5hbWUoKSwgby5nZXROYW1lKCkpCi0JIAkJCSYmIG5vZGUuZ2V0RXh0cmFEaW1lbnNpb25z
KCkgPT0gby5nZXRFeHRyYURpbWVuc2lvbnMoKQotCQkJCSYmIHNhZmVTdWJ0cmVlTWF0Y2gobm9k
ZS5nZXRJbml0aWFsaXplcigpLCBvLmdldEluaXRpYWxpemVyKCkpOworCQkJJiYgKChub2RlLmdl
dEFTVCgpLmFwaUxldmVsIDwgQVNULkpMUzgpID8gKG5vZGUuZ2V0RXh0cmFEaW1lbnNpb25zKCkg
PT0gby5nZXRFeHRyYURpbWVuc2lvbnMoKSkgOiBzYWZlU3VidHJlZUxpc3RNYXRjaChub2RlLmdl
dEV4dHJhRGltZW5zaW9uVHlwZXMoKSwgby5nZXRFeHRyYURpbWVuc2lvblR5cGVzKCkpKQorCQkJ
JiYgc2FmZVN1YnRyZWVNYXRjaChub2RlLmdldEluaXRpYWxpemVyKCksIG8uZ2V0SW5pdGlhbGl6
ZXIoKSk7CiAJfQogCkBAIC0yMzc3LDUgKzI0MDAsNSBAQAogCQlWYXJpYWJsZURlY2xhcmF0aW9u
RnJhZ21lbnQgbyA9IChWYXJpYWJsZURlY2xhcmF0aW9uRnJhZ21lbnQpIG90aGVyOwogCQlyZXR1
cm4gc2FmZVN1YnRyZWVNYXRjaChub2RlLmdldE5hbWUoKSwgby5nZXROYW1lKCkpCi0JCQkmJiBu
b2RlLmdldEV4dHJhRGltZW5zaW9ucygpID09IG8uZ2V0RXh0cmFEaW1lbnNpb25zKCkKKwkJCSYm
ICgobm9kZS5nZXRBU1QoKS5hcGlMZXZlbCA8IEFTVC5KTFM4KSA/IChub2RlLmdldEV4dHJhRGlt
ZW5zaW9ucygpID09IG8uZ2V0RXh0cmFEaW1lbnNpb25zKCkpIDogc2FmZVN1YnRyZWVMaXN0TWF0
Y2gobm9kZS5nZXRFeHRyYURpbWVuc2lvblR5cGVzKCksIG8uZ2V0RXh0cmFEaW1lbnNpb25UeXBl
cygpKSkKIAkJCSYmIHNhZmVTdWJ0cmVlTWF0Y2gobm9kZS5nZXRJbml0aWFsaXplcigpLCBvLmdl
dEluaXRpYWxpemVyKCkpOwogCX0KZGlmZiAtLWdpdCBhL29yZy5lY2xpcHNlLmpkdC5jb3JlL2Rv
bS9vcmcvZWNsaXBzZS9qZHQvY29yZS9kb20vQVNUTm9kZS5qYXZhIGIvb3JnLmVjbGlwc2UuamR0
LmNvcmUvZG9tL29yZy9lY2xpcHNlL2pkdC9jb3JlL2RvbS9BU1ROb2RlLmphdmEKaW5kZXggNjdh
NjQxYS4uYjA3MjA5OSAxMDA2NDQKLS0tIGEvb3JnLmVjbGlwc2UuamR0LmNvcmUvZG9tL29yZy9l
Y2xpcHNlL2pkdC9jb3JlL2RvbS9BU1ROb2RlLmphdmEKKysrIGIvb3JnLmVjbGlwc2UuamR0LmNv
cmUvZG9tL29yZy9lY2xpcHNlL2pkdC9jb3JlL2RvbS9BU1ROb2RlLmphdmEKQEAgLTc3Miw0ICs3
NzIsMTMgQEAKIAkgKi8KIAlwdWJsaWMgc3RhdGljIGZpbmFsIGludCBVTklPTl9UWVBFID0gODQ7
CisJCisJLyoqCisJICogTm9kZSB0eXBlIGNvbnN0YW50IGluZGljYXRpbmcgYSBub2RlIG9mIHR5
cGUKKwkgKiA8Y29kZT5EaW1lbnNpb248L2NvZGU+LgorCSAqIAorCSAqIEBzZWUgRGltZW5zaW9u
VHlwZQorCSAqIEBzaW5jZSAzLjkKKwkgKi8KKwlwdWJsaWMgc3RhdGljIGZpbmFsIGludCBESU1F
TlNJT04gPSA4NTsKIAogCS8qKgpAQCAtMTg0MSw0ICsxODUwLDIwIEBACiAJICB9CiAJfQorCQor
CS8qKgorICAgICAqIENoZWNrcyB0aGF0IHRoaXMgQVNUIG9wZXJhdGlvbiBpcyBvbmx5IHVzZWQg
d2hlbgorICAgICAqIGJ1aWxkaW5nIEpMUzMgb3IgZWFybGllciBsZXZlbCBBU1RzLgorICAgICAq
IDxwPgorICAgICAqIFVzZSB0aGlzIG1ldGhvZCB0byBwcmV2ZW50IGFjY2VzcyB0byBkZXByZWNh
dGVkIHByb3BlcnRpZXMgKGRlcHJlY2F0ZWQgaW4gSkxTOCkuCisgICAgICogPC9wPgorICAgICAq
IAorICAgICAqIEBleGNlcHRpb24gVW5zdXBwb3J0ZWRPcGVyYXRpb25FeGNlcHRpb24KKwkgKiBA
c2luY2UgMy45CisgICAgICovCisJZmluYWwgdm9pZCBzdXBwb3J0ZWRPbmx5SW4yXzNfNCgpIHsK
KwkJICBpZiAodGhpcy5hc3QuYXBpTGV2ZWwgPj0gQVNULkpMUzgpIHsKKwkJCSAgCXRocm93IG5l
dyBVbnN1cHBvcnRlZE9wZXJhdGlvbkV4Y2VwdGlvbigiT3BlcmF0aW9uIG9ubHkgc3VwcG9ydGVk
IGluIEpMUzggQVNUIik7IC8vJE5PTi1OTFMtMSQKKwkJICB9CisJfQogCiAJLyoqCmRpZmYgLS1n
aXQgYS9vcmcuZWNsaXBzZS5qZHQuY29yZS9kb20vb3JnL2VjbGlwc2UvamR0L2NvcmUvZG9tL0FT
VFZpc2l0b3IuamF2YSBiL29yZy5lY2xpcHNlLmpkdC5jb3JlL2RvbS9vcmcvZWNsaXBzZS9qZHQv
Y29yZS9kb20vQVNUVmlzaXRvci5qYXZhCmluZGV4IGIyOTMwNTMuLjlmMDdhMjkgMTAwNjQ0Ci0t
LSBhL29yZy5lY2xpcHNlLmpkdC5jb3JlL2RvbS9vcmcvZWNsaXBzZS9qZHQvY29yZS9kb20vQVNU
VmlzaXRvci5qYXZhCisrKyBiL29yZy5lY2xpcHNlLmpkdC5jb3JlL2RvbS9vcmcvZWNsaXBzZS9q
ZHQvY29yZS9kb20vQVNUVmlzaXRvci5qYXZhCkBAIC0yMDAsNCArMjAwLDEwIEBACiAJfQogCisJ
LyoqCisJICogQHNpbmNlIDMuOQorCSAqLworCXB1YmxpYyBib29sZWFuIHZpc2l0KERpbWVuc2lv
blR5cGUgbm9kZSkgeworCQlyZXR1cm4gdHJ1ZTsKKwl9CiAKIAkvKioKQEAgLTE1OTMsNCArMTU5
OSwxMSBAQAogCQkvLyBkZWZhdWx0IGltcGxlbWVudGF0aW9uOiBkbyBub3RoaW5nCiAJfQorCQor
CS8qKgorCSAqIEBzaW5jZSAzLjkKKwkgKi8KKwlwdWJsaWMgdm9pZCBlbmRWaXNpdChEaW1lbnNp
b25UeXBlIG5vZGUpIHsKKwkJLy8gZG8gbm90aGluZyBieSBkZWZhdWx0CisJfQogCiAJLyoqCmRp
ZmYgLS1naXQgYS9vcmcuZWNsaXBzZS5qZHQuY29yZS9kb20vb3JnL2VjbGlwc2UvamR0L2NvcmUv
ZG9tL0RpbWVuc2lvblR5cGUuamF2YSBiL29yZy5lY2xpcHNlLmpkdC5jb3JlL2RvbS9vcmcvZWNs
aXBzZS9qZHQvY29yZS9kb20vRGltZW5zaW9uVHlwZS5qYXZhCm5ldyBmaWxlIG1vZGUgMTAwNjQ0
CmluZGV4IDAwMDAwMDAuLjUwZmQyNmYKLS0tIC9kZXYvbnVsbAorKysgYi9vcmcuZWNsaXBzZS5q
ZHQuY29yZS9kb20vb3JnL2VjbGlwc2UvamR0L2NvcmUvZG9tL0RpbWVuc2lvblR5cGUuamF2YQpA
QCAtMCwwICsxLDEwNSBAQAorcGFja2FnZSBvcmcuZWNsaXBzZS5qZHQuY29yZS5kb207CisKK2lt
cG9ydCBqYXZhLnV0aWwuQXJyYXlMaXN0OworaW1wb3J0IGphdmEudXRpbC5MaXN0OworCisvKioK
KyAqIEBzaW5jZSAzLjkKKyAqLworcHVibGljIGNsYXNzIERpbWVuc2lvblR5cGUgZXh0ZW5kcyBB
bm5vdGF0YWJsZVR5cGUgeworCisJCisJLyoqCisJICogVGhlICJhbm5vdGF0aW9ucyIgc3RydWN0
dXJhbCBwcm9wZXJ0eSBvZiB0aGlzIG5vZGUgdHlwZSAoY2hpbGQgdHlwZToge0BsaW5rIEFubm90
YXRpb259KS4KKwkgKiBAc2luY2UgMy45CisJICovCisJcHVibGljIHN0YXRpYyBmaW5hbCBDaGls
ZExpc3RQcm9wZXJ0eURlc2NyaXB0b3IgQU5OT1RBVElPTlNfUFJPUEVSVFkgPQorCQluZXcgQ2hp
bGRMaXN0UHJvcGVydHlEZXNjcmlwdG9yKERpbWVuc2lvblR5cGUuY2xhc3MsICJhbm5vdGF0aW9u
cyIsIEFubm90YXRpb24uY2xhc3MsIE5PX0NZQ0xFX1JJU0spOyAvLyROT04tTkxTLTEkCisJCisJ
LyoqCisJICogQSBsaXN0IG9mIHByb3BlcnR5IGRlc2NyaXB0b3JzIChlbGVtZW50IHR5cGU6CisJ
ICoge0BsaW5rIFN0cnVjdHVyYWxQcm9wZXJ0eURlc2NyaXB0b3J9KSwKKwkgKiBvciBudWxsIGlm
IHVuaW5pdGlhbGl6ZWQuCisJICogQHNpbmNlIDMuOQorCSAqLworCXByaXZhdGUgc3RhdGljIGZp
bmFsIExpc3QgUFJPUEVSVFlfREVTQ1JJUFRPUlNfOF8wOworCQorCXN0YXRpYyB7CisJCUxpc3Qg
cHJvcGVydHlMaXN0ID0gbmV3IEFycmF5TGlzdCgyKTsKKwkJY3JlYXRlUHJvcGVydHlMaXN0KERp
bWVuc2lvblR5cGUuY2xhc3MsIHByb3BlcnR5TGlzdCk7CisJCWFkZFByb3BlcnR5KEFOTk9UQVRJ
T05TX1BST1BFUlRZLCBwcm9wZXJ0eUxpc3QpOworCQlQUk9QRVJUWV9ERVNDUklQVE9SU184XzAg
PSByZWFwUHJvcGVydHlMaXN0KHByb3BlcnR5TGlzdCk7CisJfQorCQorCS8qKgorCSAqIFJldHVy
bnMgYSBsaXN0IG9mIHN0cnVjdHVyYWwgcHJvcGVydHkgZGVzY3JpcHRvcnMgZm9yIHRoaXMgbm9k
ZSB0eXBlLgorCSAqIENsaWVudHMgbXVzdCBub3QgbW9kaWZ5IHRoZSByZXN1bHQuCisJICoKKwkg
KiBAcGFyYW0gYXBpTGV2ZWwgdGhlIEFQSSBsZXZlbDsgb25lIG9mIHRoZQorCSAqIDxjb2RlPkFT
VC5KTFMqPC9jb2RlPiBjb25zdGFudHMKKwkgKiBAcmV0dXJuIGEgbGlzdCBvZiBwcm9wZXJ0eSBk
ZXNjcmlwdG9ycyAoZWxlbWVudCB0eXBlOgorCSAqIHtAbGluayBTdHJ1Y3R1cmFsUHJvcGVydHlE
ZXNjcmlwdG9yfSkKKwkgKiBAc2luY2UgMy4wCisJICovCisJcHVibGljIHN0YXRpYyBMaXN0IHBy
b3BlcnR5RGVzY3JpcHRvcnMoaW50IGFwaUxldmVsKSB7CisJCXJldHVybiBQUk9QRVJUWV9ERVND
UklQVE9SU184XzA7CisJfQorCQorCXB1YmxpYyBEaW1lbnNpb25UeXBlKEFTVCBhc3QpIHsKKwkJ
c3VwZXIoYXN0KTsKKwkJaWYgKGFzdC5hcGlMZXZlbCA+PSBBU1QuSkxTOCkgeworCQkJdGhpcy5h
bm5vdGF0aW9ucyA9IG5ldyBBU1ROb2RlLk5vZGVMaXN0KEFOTk9UQVRJT05TX1BST1BFUlRZKTsK
KwkJfQorCX0KKwkKKwlMaXN0IGludGVybmFsU3RydWN0dXJhbFByb3BlcnRpZXNGb3JUeXBlKGlu
dCBhcGlMZXZlbCkgeworCQlyZXR1cm4gcHJvcGVydHlEZXNjcmlwdG9ycyhhcGlMZXZlbCk7CisJ
fQorCisJLyogKG9taXQgamF2YWRvYyBmb3IgdGhpcyBtZXRob2QpCisJICogTWV0aG9kIGRlY2xh
cmVkIG9uIEFTVE5vZGUuCisJICovCisJZmluYWwgTGlzdCBpbnRlcm5hbEdldENoaWxkTGlzdFBy
b3BlcnR5KENoaWxkTGlzdFByb3BlcnR5RGVzY3JpcHRvciBwcm9wZXJ0eSkgeworCQlpZiAocHJv
cGVydHkgPT0gQU5OT1RBVElPTlNfUFJPUEVSVFkpIHsKKwkJCXJldHVybiBhbm5vdGF0aW9ucygp
OworCQl9CisJCS8vIGFsbG93IGRlZmF1bHQgaW1wbGVtZW50YXRpb24gdG8gZmxhZyB0aGUgZXJy
b3IKKwkJcmV0dXJuIHN1cGVyLmludGVybmFsR2V0Q2hpbGRMaXN0UHJvcGVydHkocHJvcGVydHkp
OworCX0KKwkKKwlpbnQgZ2V0Tm9kZVR5cGUwKCkgeworCQlyZXR1cm4gRElNRU5TSU9OOworCX0K
KworCWJvb2xlYW4gc3VidHJlZU1hdGNoMChBU1RNYXRjaGVyIG1hdGNoZXIsIE9iamVjdCBvdGhl
cikgeworCQlyZXR1cm4gbWF0Y2hlci5tYXRjaCh0aGlzLCBvdGhlcik7CisJfQorCisJQVNUTm9k
ZSBjbG9uZTAoQVNUIHRhcmdldCkgeworCQlEaW1lbnNpb25UeXBlIHJlc3VsdCA9IG5ldyBEaW1l
bnNpb25UeXBlKHRhcmdldCk7CisJCXJlc3VsdC5hbm5vdGF0aW9ucyA9IG5ldyBBU1ROb2RlLk5v
ZGVMaXN0KEFOTk9UQVRJT05TX1BST1BFUlRZKTsKKwkJcmVzdWx0LmFubm90YXRpb25zLmFkZEFs
bCgKKwkJCQlBU1ROb2RlLmNvcHlTdWJ0cmVlcyh0YXJnZXQsIGFubm90YXRpb25zKCkpKTsKKwkJ
cmV0dXJuIHJlc3VsdDsKKwl9CisKKwl2b2lkIGFjY2VwdDAoQVNUVmlzaXRvciB2aXNpdG9yKSB7
CisJCWJvb2xlYW4gdmlzaXRDaGlsZHJlbiA9IHZpc2l0b3IudmlzaXQodGhpcyk7CisJCWlmICh2
aXNpdENoaWxkcmVuKSB7CisJCQlhY2NlcHRDaGlsZHJlbih2aXNpdG9yLCB0aGlzLmFubm90YXRp
b25zKTsKKwkJfQorCQl2aXNpdG9yLmVuZFZpc2l0KHRoaXMpOworCisJfQorCisJaW50IHRyZWVT
aXplKCkgeworCQkvLyBUT0RPIEF1dG8tZ2VuZXJhdGVkIG1ldGhvZCBzdHViCisJCXJldHVybiAw
OworCX0KKworCWludCBtZW1TaXplKCkgeworCQkvLyBUT0RPIEF1dG8tZ2VuZXJhdGVkIG1ldGhv
ZCBzdHViCisJCXJldHVybiAwOworCX0KKworfQpkaWZmIC0tZ2l0IGEvb3JnLmVjbGlwc2UuamR0
LmNvcmUvZG9tL29yZy9lY2xpcHNlL2pkdC9jb3JlL2RvbS9NZXRob2REZWNsYXJhdGlvbi5qYXZh
IGIvb3JnLmVjbGlwc2UuamR0LmNvcmUvZG9tL29yZy9lY2xpcHNlL2pkdC9jb3JlL2RvbS9NZXRo
b2REZWNsYXJhdGlvbi5qYXZhCmluZGV4IGJmOGQ5OTcuLmZjZmMwNTAgMTAwNjQ0Ci0tLSBhL29y
Zy5lY2xpcHNlLmpkdC5jb3JlL2RvbS9vcmcvZWNsaXBzZS9qZHQvY29yZS9kb20vTWV0aG9kRGVj
bGFyYXRpb24uamF2YQorKysgYi9vcmcuZWNsaXBzZS5qZHQuY29yZS9kb20vb3JnL2VjbGlwc2Uv
amR0L2NvcmUvZG9tL01ldGhvZERlY2xhcmF0aW9uLmphdmEKQEAgLTEyNSw0ICsxMjUsMTEgQEAK
IAogCS8qKgorCSAqIFRoZSAiZXh0cmFBbm5vdGF0ZWREaW1lbnNpb25zIiBzdHJ1Y3R1cmFsIHBy
b3BlcnR5IG9mIHRoaXMgbm9kZSB0eXBlIChjaGlsZCB0eXBlOiB7QGxpbmsgRGltZW5zaW9uVHlw
ZX0pLgorCSAqIEBzaW5jZSAzLjkKKwkgKi8KKwlwdWJsaWMgc3RhdGljIGZpbmFsIENoaWxkTGlz
dFByb3BlcnR5RGVzY3JpcHRvciBFWFRSQV9BTk5PVEFURURfRElNRU5TSU9OU19QUk9QRVJUWSA9
CisJCQluZXcgQ2hpbGRMaXN0UHJvcGVydHlEZXNjcmlwdG9yKE1ldGhvZERlY2xhcmF0aW9uLmNs
YXNzLCAiZXh0cmFBbm5vdGF0ZWREaW1lbnNpb25zIiwgRGltZW5zaW9uVHlwZS5jbGFzcywgTk9f
Q1lDTEVfUklTSyk7IC8vJE5PTi1OTFMtMSQKKworCS8qKgogCSAqIFRoZSAidHlwZVBhcmFtZXRl
cnMiIHN0cnVjdHVyYWwgcHJvcGVydHkgb2YgdGhpcyBub2RlIHR5cGUgKGVsZW1lbnQgdHlwZTog
e0BsaW5rIFR5cGVQYXJhbWV0ZXJ9KSAoYWRkZWQgaW4gSkxTMyBBUEkpLgogCSAqIEBzaW5jZSAz
LjEKQEAgLTI2NSw0ICsyNzIsMTEgQEAKIAogCS8qKgorCSAqIFRoZSBleHRyYSBkaW1lbnNpb24g
dHlwZXMgdGhpcyBub2RlIGhhcyB3aXRoIGFubm90YXRpb25zIGlmIGFueS4KKwkgKiAKKwkgKiBA
c2luY2UgMy45CisJICovCisJcHJvdGVjdGVkIEFTVE5vZGUuTm9kZUxpc3QgZXh0cmFBbm5vdGF0
ZWREaW1lbnNpb25zID0gbnVsbDsKKworCS8qKgogCSAqIFRoZSBsaXN0IG9mIHRocm93biBleGNl
cHRpb24gbmFtZXMgKGVsZW1lbnQgdHlwZToge0BsaW5rIE5hbWV9KS4KIAkgKiBEZWZhdWx0cyB0
byBhbiBlbXB0eSBsaXN0LgpAQCAtMjk2LDQgKzMxMCw3IEBACiAJCWlmIChhc3QuYXBpTGV2ZWwg
Pj0gQVNULkpMUzNfSU5URVJOQUwpIHsKIAkJCXRoaXMudHlwZVBhcmFtZXRlcnMgPSBuZXcgQVNU
Tm9kZS5Ob2RlTGlzdChUWVBFX1BBUkFNRVRFUlNfUFJPUEVSVFkpOworCQl9IAorCQlpZiAoYXN0
LmFwaUxldmVsID49IEFTVC5KTFM4KSB7CisJCQl0aGlzLmV4dHJhQW5ub3RhdGVkRGltZW5zaW9u
cyA9IG5ldyBBU1ROb2RlLk5vZGVMaXN0KEVYVFJBX0FOTk9UQVRFRF9ESU1FTlNJT05TX1BST1BF
UlRZKTsKIAkJfQogCX0KQEAgLTQxMSw0ICs0MjgsNyBAQAogCQkJcmV0dXJuIHRocm93bkV4Y2Vw
dGlvbnMoKTsKIAkJfQorCQlpZiAocHJvcGVydHkgPT0gRVhUUkFfQU5OT1RBVEVEX0RJTUVOU0lP
TlNfUFJPUEVSVFkpIHsKKwkJCXJldHVybiB0aGlzLmV4dHJhQW5ub3RhdGVkRGltZW5zaW9uczsK
KwkJfQogCQkvLyBhbGxvdyBkZWZhdWx0IGltcGxlbWVudGF0aW9uIHRvIGZsYWcgdGhlIGVycm9y
CiAJCXJldHVybiBzdXBlci5pbnRlcm5hbEdldENoaWxkTGlzdFByb3BlcnR5KHByb3BlcnR5KTsK
QEAgLTQ2NSw0ICs0ODUsOSBAQAogCQlyZXN1bHQuc2V0Q29uc3RydWN0b3IoaXNDb25zdHJ1Y3Rv
cigpKTsKIAkJcmVzdWx0LnNldEV4dHJhRGltZW5zaW9ucyhnZXRFeHRyYURpbWVuc2lvbnMoKSk7
CisJCWlmICh0aGlzLmFzdC5hcGlMZXZlbCA+PSBBU1QuSkxTOCkgeworCQkJcmVzdWx0LmV4dHJh
QW5ub3RhdGVkRGltZW5zaW9ucyA9IG5ldyBBU1ROb2RlLk5vZGVMaXN0KEVYVFJBX0FOTk9UQVRF
RF9ESU1FTlNJT05TX1BST1BFUlRZKTsKKwkJCXJlc3VsdC5leHRyYUFubm90YXRlZERpbWVuc2lv
bnMuYWRkQWxsKAorCQkJCQlBU1ROb2RlLmNvcHlTdWJ0cmVlcyh0YXJnZXQsIHRoaXMuZXh0cmFB
bm5vdGF0ZWREaW1lbnNpb25zKSk7CisJCX0KIAkJcmVzdWx0LnNldE5hbWUoKFNpbXBsZU5hbWUp
IGdldE5hbWUoKS5jbG9uZSh0YXJnZXQpKTsKIAkJcmVzdWx0LnBhcmFtZXRlcnMoKS5hZGRBbGwo
CkBAIC04MjksNCArODU0LDE1IEBACiAKIAkvKioKKwkgKiBSZXR1cm5zIHRoZSBsaXZlIG9yZGVy
ZWQgbGlzdCBvZiBleHRyYSBkaW1lbnNpb25zIHdpdGggYW5ub3RhdGlvbnMgaWYgYW55LgorCSAq
IAorCSAqIEByZXR1cm4gdGhlIGxpdmUgbGlzdCBvZiBleHRyYSBkaW1lbnNpb25zIHdpdGggYW5u
b3RhdGlvbnMgaWYgYW55IChlbGVtZW50IHR5cGU6IHtAbGluayBEaW1lbnNpb25UeXBlfVtdKQor
CSAqIEBzaW5jZSAzLjkKKwkgKi8KKwlwdWJsaWMgTGlzdCBnZXRFeHRyYUFubm90YXRlZERpbWVu
c2lvbnMoKSB7CisJCXVuc3VwcG9ydGVkSW4yXzNfNCgpOworCQlyZXR1cm4gdGhpcy5leHRyYUFu
bm90YXRlZERpbWVuc2lvbnM7CisJfQorCisJLyoqCiAJICogUmV0dXJucyB0aGUgYm9keSBvZiB0
aGlzIG1ldGhvZCBkZWNsYXJhdGlvbiwgb3IgPGNvZGU+bnVsbDwvY29kZT4gaWYKIAkgKiB0aGlz
IG1ldGhvZCBoYXMgPGI+bm88L2I+IGJvZHkuCmRpZmYgLS1naXQgYS9vcmcuZWNsaXBzZS5qZHQu
Y29yZS9kb20vb3JnL2VjbGlwc2UvamR0L2NvcmUvZG9tL1JlY292ZXJlZFZhcmlhYmxlQmluZGlu
Zy5qYXZhIGIvb3JnLmVjbGlwc2UuamR0LmNvcmUvZG9tL29yZy9lY2xpcHNlL2pkdC9jb3JlL2Rv
bS9SZWNvdmVyZWRWYXJpYWJsZUJpbmRpbmcuamF2YQppbmRleCBiYTUxMmZjLi5iMDg5YTUyIDEw
MDY0NAotLS0gYS9vcmcuZWNsaXBzZS5qZHQuY29yZS9kb20vb3JnL2VjbGlwc2UvamR0L2NvcmUv
ZG9tL1JlY292ZXJlZFZhcmlhYmxlQmluZGluZy5qYXZhCisrKyBiL29yZy5lY2xpcHNlLmpkdC5j
b3JlL2RvbS9vcmcvZWNsaXBzZS9qZHQvY29yZS9kb20vUmVjb3ZlcmVkVmFyaWFibGVCaW5kaW5n
LmphdmEKQEAgLTk1LDUgKzk1LDYgQEAKIAkJCQkuYXBwZW5kKHRoaXMudmFyaWFibGVEZWNsYXJh
dGlvbi5nZXRDbGFzcygpKQogCQkJCS5hcHBlbmQodGhpcy52YXJpYWJsZURlY2xhcmF0aW9uLmdl
dE5hbWUoKS5nZXRJZGVudGlmaWVyKCkpCi0JCQkJLmFwcGVuZCh0aGlzLnZhcmlhYmxlRGVjbGFy
YXRpb24uZ2V0RXh0cmFEaW1lbnNpb25zKCkpOworCQkJCS5hcHBlbmQoKHRoaXMudmFyaWFibGVE
ZWNsYXJhdGlvbi5hc3QuYXBpTGV2ZWwgPCBBU1QuSkxTOCkgPyAKKwkJCQkJCXRoaXMudmFyaWFi
bGVEZWNsYXJhdGlvbi5nZXRFeHRyYURpbWVuc2lvbnMoKSA6IHRoaXMudmFyaWFibGVEZWNsYXJh
dGlvbi5nZXRFeHRyYURpbWVuc2lvblR5cGVzKCkuc2l6ZSgpKTsKIAkJfQogCQlyZXR1cm4gU3Ry
aW5nLnZhbHVlT2YoYnVmZmVyKTsKZGlmZiAtLWdpdCBhL29yZy5lY2xpcHNlLmpkdC5jb3JlL2Rv
bS9vcmcvZWNsaXBzZS9qZHQvY29yZS9kb20vU2luZ2xlVmFyaWFibGVEZWNsYXJhdGlvbi5qYXZh
IGIvb3JnLmVjbGlwc2UuamR0LmNvcmUvZG9tL29yZy9lY2xpcHNlL2pkdC9jb3JlL2RvbS9TaW5n
bGVWYXJpYWJsZURlY2xhcmF0aW9uLmphdmEKaW5kZXggNDM2YWYyMS4uY2UxMjRiMCAxMDA2NDQK
LS0tIGEvb3JnLmVjbGlwc2UuamR0LmNvcmUvZG9tL29yZy9lY2xpcHNlL2pkdC9jb3JlL2RvbS9T
aW5nbGVWYXJpYWJsZURlY2xhcmF0aW9uLmphdmEKKysrIGIvb3JnLmVjbGlwc2UuamR0LmNvcmUv
ZG9tL29yZy9lY2xpcHNlL2pkdC9jb3JlL2RvbS9TaW5nbGVWYXJpYWJsZURlY2xhcmF0aW9uLmph
dmEKQEAgLTc1LDkgKzc1LDE3IEBACiAKIAkvKioKLQkgKiBUaGUgImV4dHJhRGltZW5zaW9ucyIg
c3RydWN0dXJhbCBwcm9wZXJ0eSBvZiB0aGlzIG5vZGUgdHlwZSAodHlwZToge0BsaW5rIEludGVn
ZXJ9KS4KKwkgKiBUaGUgImV4dHJhRGltZW5zaW9ucyIgc3RydWN0dXJhbCBwcm9wZXJ0eSBvZiB0
aGlzIG5vZGUgdHlwZSAodHlwZToge0BsaW5rIEludGVnZXJ9KS4gVGhpcyBwcm9wZXJ0eSBpcyBz
dXBwb3J0ZWQKKwkgKiBvbmx5IGluIEpMUzMgb3IgbG93ZXIgbGV2ZWwuCiAJICogQHNpbmNlIDMu
MAogCSAqLwogCXB1YmxpYyBzdGF0aWMgZmluYWwgU2ltcGxlUHJvcGVydHlEZXNjcmlwdG9yIEVY
VFJBX0RJTUVOU0lPTlNfUFJPUEVSVFkgPQogCQluZXcgU2ltcGxlUHJvcGVydHlEZXNjcmlwdG9y
KFNpbmdsZVZhcmlhYmxlRGVjbGFyYXRpb24uY2xhc3MsICJleHRyYURpbWVuc2lvbnMiLCBpbnQu
Y2xhc3MsIE1BTkRBVE9SWSk7IC8vJE5PTi1OTFMtMSQKKworCS8qKgorCSAqIFRoZSAiZXh0cmFB
bm5vdGF0ZWREaW1lbnNpb25zIiBzdHJ1Y3R1cmFsIHByb3BlcnR5IG9mIHRoaXMgbm9kZSB0eXBl
IChjaGlsZCB0eXBlOiB7QGxpbmsgRGltZW5zaW9uVHlwZX0pLgorCSAqIEBzaW5jZSAzLjkKKwkg
Ki8KKwlwdWJsaWMgc3RhdGljIGZpbmFsIENoaWxkTGlzdFByb3BlcnR5RGVzY3JpcHRvciBFWFRS
QV9ESU1FTlNJT05fVFlQRVNfUFJPUEVSVFkgPQorCQkJbmV3IENoaWxkTGlzdFByb3BlcnR5RGVz
Y3JpcHRvcihTaW5nbGVWYXJpYWJsZURlY2xhcmF0aW9uLmNsYXNzLCAiZXh0cmFEaW1lbnNpb25U
eXBlcyIsIERpbWVuc2lvblR5cGUuY2xhc3MsIE5PX0NZQ0xFX1JJU0spOyAvLyROT04tTkxTLTEk
CiAKIAkvKioKQEAgLTEwMyw0ICsxMTEsMTIgQEAKIAkgKi8KIAlwcml2YXRlIHN0YXRpYyBmaW5h
bCBMaXN0IFBST1BFUlRZX0RFU0NSSVBUT1JTXzNfMDsKKwkKKwkvKioKKwkgKiBBIGxpc3Qgb2Yg
cHJvcGVydHkgZGVzY3JpcHRvcnMgKGVsZW1lbnQgdHlwZToKKwkgKiB7QGxpbmsgU3RydWN0dXJh
bFByb3BlcnR5RGVzY3JpcHRvcn0pLAorCSAqIG9yIG51bGwgaWYgdW5pbml0aWFsaXplZC4KKwkg
KiBAc2luY2UgMy45CisJICovCisJcHJpdmF0ZSBzdGF0aWMgZmluYWwgTGlzdCBQUk9QRVJUWV9E
RVNDUklQVE9SU184XzA7CiAKIAlzdGF0aWMgewpAQCAtMTE2LDExICsxMzIsMjEgQEAKIAkJcHJv
cGVydHlMaXN0ID0gbmV3IEFycmF5TGlzdCg3KTsKIAkJY3JlYXRlUHJvcGVydHlMaXN0KFNpbmds
ZVZhcmlhYmxlRGVjbGFyYXRpb24uY2xhc3MsIHByb3BlcnR5TGlzdCk7CisJCWFkZEpMUzNQcm9w
ZXJ0aWVzKHByb3BlcnR5TGlzdCk7CisJCWFkZFByb3BlcnR5KEVYVFJBX0RJTUVOU0lPTlNfUFJP
UEVSVFksIHByb3BlcnR5TGlzdCk7CisJCVBST1BFUlRZX0RFU0NSSVBUT1JTXzNfMCA9IHJlYXBQ
cm9wZXJ0eUxpc3QocHJvcGVydHlMaXN0KTsKKwkJCisJCXByb3BlcnR5TGlzdCA9IG5ldyBBcnJh
eUxpc3QoNyk7CisJCWNyZWF0ZVByb3BlcnR5TGlzdChTaW5nbGVWYXJpYWJsZURlY2xhcmF0aW9u
LmNsYXNzLCBwcm9wZXJ0eUxpc3QpOworCQlhZGRKTFMzUHJvcGVydGllcyhwcm9wZXJ0eUxpc3Qp
OworCQlhZGRQcm9wZXJ0eShFWFRSQV9ESU1FTlNJT05fVFlQRVNfUFJPUEVSVFksIHByb3BlcnR5
TGlzdCk7CisJCVBST1BFUlRZX0RFU0NSSVBUT1JTXzhfMCA9IHJlYXBQcm9wZXJ0eUxpc3QocHJv
cGVydHlMaXN0KTsKKwl9CisKKwlwcml2YXRlIHN0YXRpYyB2b2lkIGFkZEpMUzNQcm9wZXJ0aWVz
KExpc3QgcHJvcGVydHlMaXN0KSB7CiAJCWFkZFByb3BlcnR5KE1PRElGSUVSUzJfUFJPUEVSVFks
IHByb3BlcnR5TGlzdCk7CiAJCWFkZFByb3BlcnR5KFRZUEVfUFJPUEVSVFksIHByb3BlcnR5TGlz
dCk7CiAJCWFkZFByb3BlcnR5KFZBUkFSR1NfUFJPUEVSVFksIHByb3BlcnR5TGlzdCk7CiAJCWFk
ZFByb3BlcnR5KE5BTUVfUFJPUEVSVFksIHByb3BlcnR5TGlzdCk7Ci0JCWFkZFByb3BlcnR5KEVY
VFJBX0RJTUVOU0lPTlNfUFJPUEVSVFksIHByb3BlcnR5TGlzdCk7CiAJCWFkZFByb3BlcnR5KElO
SVRJQUxJWkVSX1BST1BFUlRZLCBwcm9wZXJ0eUxpc3QpOwotCQlQUk9QRVJUWV9ERVNDUklQVE9S
U18zXzAgPSByZWFwUHJvcGVydHlMaXN0KHByb3BlcnR5TGlzdCk7CiAJfQogCkBAIC0xMzYsOCAr
MTYyLDEyIEBACiAJICovCiAJcHVibGljIHN0YXRpYyBMaXN0IHByb3BlcnR5RGVzY3JpcHRvcnMo
aW50IGFwaUxldmVsKSB7Ci0JCWlmIChhcGlMZXZlbCA9PSBBU1QuSkxTMl9JTlRFUk5BTCkgewot
CQkJcmV0dXJuIFBST1BFUlRZX0RFU0NSSVBUT1JTXzJfMDsKLQkJfSBlbHNlIHsKLQkJCXJldHVy
biBQUk9QRVJUWV9ERVNDUklQVE9SU18zXzA7CisJCXN3aXRjaCAoYXBpTGV2ZWwpIHsKKwkJCWNh
c2UgQVNULkpMUzJfSU5URVJOQUw6CisJCQkJCXJldHVybiBQUk9QRVJUWV9ERVNDUklQVE9SU18y
XzA7CisJCQljYXNlIEFTVC5KTFMzX0lOVEVSTkFMOgorCQkJY2FzZSBBU1QuSkxTNDoKKwkJCQkJ
cmV0dXJuIFBST1BFUlRZX0RFU0NSSVBUT1JTXzNfMDsKKwkJCWRlZmF1bHQ6CisJCQkJCXJldHVy
biBQUk9QRVJUWV9ERVNDUklQVE9SU184XzA7CiAJCX0KIAl9CkBAIC0xODcsNCArMjE3LDExIEBA
CiAKIAkvKioKKwkgKiBUaGUgZXh0cmEgZGltZW5zaW9uIHR5cGVzIHRoaXMgbm9kZSBoYXMgd2l0
aCBhbm5vdGF0aW9ucyBpZiBhbnkuCisJICogCisJICogQHNpbmNlIDMuOQorCSAqLworCXByb3Rl
Y3RlZCBBU1ROb2RlLk5vZGVMaXN0IGV4dHJhRGltZW5zaW9uVHlwZXMgPSBudWxsOworCisJLyoq
CiAJICogVGhlIGluaXRpYWxpemVyIGV4cHJlc3Npb24sIG9yIDxjb2RlPm51bGw8L2NvZGU+IGlm
IG5vbmU7CiAJICogZGVmYXVsdHMgdG8gbm9uZS4KQEAgLTIwNyw0ICsyNDQsNyBAQAogCQlpZiAo
YXN0LmFwaUxldmVsID49IEFTVC5KTFMzX0lOVEVSTkFMKSB7CiAJCQl0aGlzLm1vZGlmaWVycyA9
IG5ldyBBU1ROb2RlLk5vZGVMaXN0KE1PRElGSUVSUzJfUFJPUEVSVFkpOworCQl9IAorCQlpZiAo
YXN0LmFwaUxldmVsID49IEFTVC5KTFM4KSB7CisJCQl0aGlzLmV4dHJhRGltZW5zaW9uVHlwZXMg
PSBuZXcgQVNUTm9kZS5Ob2RlTGlzdChFWFRSQV9ESU1FTlNJT05fVFlQRVNfUFJPUEVSVFkpOwog
CQl9CiAJfQpAQCAtMzIwLDQgKzM2MCw3IEBACiAJCQlyZXR1cm4gbW9kaWZpZXJzKCk7CiAJCX0K
KwkJaWYgKHByb3BlcnR5ID09IEVYVFJBX0RJTUVOU0lPTl9UWVBFU19QUk9QRVJUWSkgeworCQkJ
cmV0dXJuIHRoaXMuZXh0cmFEaW1lbnNpb25UeXBlczsKKwkJfQogCQkvLyBhbGxvdyBkZWZhdWx0
IGltcGxlbWVudGF0aW9uIHRvIGZsYWcgdGhlIGVycm9yCiAJCXJldHVybiBzdXBlci5pbnRlcm5h
bEdldENoaWxkTGlzdFByb3BlcnR5KHByb3BlcnR5KTsKQEAgLTM0NCw1ICszODcsMTEgQEAKIAkJ
fQogCQlyZXN1bHQuc2V0VHlwZSgoVHlwZSkgZ2V0VHlwZSgpLmNsb25lKHRhcmdldCkpOwotCQly
ZXN1bHQuc2V0RXh0cmFEaW1lbnNpb25zKGdldEV4dHJhRGltZW5zaW9ucygpKTsKKwkJaWYgKHRo
aXMuYXN0LmFwaUxldmVsID49IEFTVC5KTFM4KSB7CisJCQlyZXN1bHQuZXh0cmFEaW1lbnNpb25U
eXBlcyA9IG5ldyBBU1ROb2RlLk5vZGVMaXN0KEVYVFJBX0RJTUVOU0lPTl9UWVBFU19QUk9QRVJU
WSk7CisJCQlyZXN1bHQuZXh0cmFEaW1lbnNpb25UeXBlcy5hZGRBbGwoCisJCQkJCUFTVE5vZGUu
Y29weVN1YnRyZWVzKHRhcmdldCwgdGhpcy5leHRyYURpbWVuc2lvblR5cGVzKSk7CisJCX0gZWxz
ZSB7CisJCQlyZXN1bHQuc2V0RXh0cmFEaW1lbnNpb25zKGdldEV4dHJhRGltZW5zaW9ucygpKTsK
KwkJfQogCQlyZXN1bHQuc2V0TmFtZSgoU2ltcGxlTmFtZSkgZ2V0TmFtZSgpLmNsb25lKHRhcmdl
dCkpOwogCQlyZXN1bHQuc2V0SW5pdGlhbGl6ZXIoCkBAIC0zNzEsNCArNDIwLDcgQEAKIAkJCWFj
Y2VwdENoaWxkKHZpc2l0b3IsIGdldFR5cGUoKSk7CiAJCQlhY2NlcHRDaGlsZCh2aXNpdG9yLCBn
ZXROYW1lKCkpOworCQkJaWYgKHRoaXMuYXN0LmFwaUxldmVsID49IEFTVC5KTFM4KSB7CisJCQkJ
YWNjZXB0Q2hpbGRyZW4odmlzaXRvciwgdGhpcy5leHRyYURpbWVuc2lvblR5cGVzKTsKKwkJCX0K
IAkJCWFjY2VwdENoaWxkKHZpc2l0b3IsIGdldEluaXRpYWxpemVyKCkpOwogCQl9CkBAIC01ODAs
NCArNjMyLDUgQEAKIAkgKi8KIAlwdWJsaWMgaW50IGdldEV4dHJhRGltZW5zaW9ucygpIHsKKwkJ
c3VwcG9ydGVkT25seUluMl8zXzQoKTsKIAkJcmV0dXJuIHRoaXMuZXh0cmFBcnJheURpbWVuc2lv
bnM7CiAJfQpAQCAtNTg4LDQgKzY0MSw1IEBACiAJICovCiAJcHVibGljIHZvaWQgc2V0RXh0cmFE
aW1lbnNpb25zKGludCBkaW1lbnNpb25zKSB7CisJCXN1cHBvcnRlZE9ubHlJbjJfM180KCk7CiAJ
CWlmIChkaW1lbnNpb25zIDwgMCkgewogCQkJdGhyb3cgbmV3IElsbGVnYWxBcmd1bWVudEV4Y2Vw
dGlvbigpOwpAQCAtNTk2LDQgKzY1MCwxNiBAQAogCX0KIAorCS8qKgorCSAqIFJldHVybnMgdGhl
IGxpdmUgb3JkZXJlZCBsaXN0IG9mIGV4dHJhIGRpbWVuc2lvbnMgd2l0aCBhbm5vdGF0aW9ucyBp
ZiBhbnkuCisJICogCisJICogQHJldHVybiB0aGUgbGl2ZSBsaXN0IG9mIGV4dHJhIGRpbWVuc2lv
bnMgd2l0aCBhbm5vdGF0aW9ucyBpZiBhbnkgKGVsZW1lbnQgdHlwZToge0BsaW5rIERpbWVuc2lv
blR5cGV9W10pCisJICogQHNpbmNlIDMuOQorCSAqLworCXB1YmxpYyBMaXN0IGdldEV4dHJhRGlt
ZW5zaW9uVHlwZXMoKSB7CisJCXVuc3VwcG9ydGVkSW4yXzNfNCgpOworCQlyZXR1cm4gdGhpcy5l
eHRyYURpbWVuc2lvblR5cGVzOworCX0KKwkKKwkKIAkvKiAob21pdCBqYXZhZG9jIGZvciB0aGlz
IG1ldGhvZCkKIAkgKiBNZXRob2QgZGVjbGFyZWQgb24gVmFyaWFibGVEZWNsYXJhdGlvbi4KZGlm
ZiAtLWdpdCBhL29yZy5lY2xpcHNlLmpkdC5jb3JlL2RvbS9vcmcvZWNsaXBzZS9qZHQvY29yZS9k
b20vVmFyaWFibGVEZWNsYXJhdGlvbi5qYXZhIGIvb3JnLmVjbGlwc2UuamR0LmNvcmUvZG9tL29y
Zy9lY2xpcHNlL2pkdC9jb3JlL2RvbS9WYXJpYWJsZURlY2xhcmF0aW9uLmphdmEKaW5kZXggZmMz
ODhlOC4uODljZjI4MSAxMDA2NDQKLS0tIGEvb3JnLmVjbGlwc2UuamR0LmNvcmUvZG9tL29yZy9l
Y2xpcHNlL2pkdC9jb3JlL2RvbS9WYXJpYWJsZURlY2xhcmF0aW9uLmphdmEKKysrIGIvb3JnLmVj
bGlwc2UuamR0LmNvcmUvZG9tL29yZy9lY2xpcHNlL2pkdC9jb3JlL2RvbS9WYXJpYWJsZURlY2xh
cmF0aW9uLmphdmEKQEAgLTEyLDQgKzEyLDYgQEAKIHBhY2thZ2Ugb3JnLmVjbGlwc2UuamR0LmNv
cmUuZG9tOwogCitpbXBvcnQgamF2YS51dGlsLkxpc3Q7CisKIC8qKgogICogQWJzdHJhY3QgYmFz
ZSBjbGFzcyBvZiBhbGwgQVNUIG5vZGUgdHlwZXMgdGhhdCBkZWNsYXJlIGEgc2luZ2xlIGxvY2Fs
CkBAIC0xNTcsNCArMTU5LDE0IEBACiAJcHVibGljIGFic3RyYWN0IHZvaWQgc2V0RXh0cmFEaW1l
bnNpb25zKGludCBkaW1lbnNpb25zKTsKIAorCQorCS8qKgorCSAqIFJldHVybnMgdGhlIGV4dHJh
IGFubm90YXRhYmxlIGRpbWVuc2lvbiB0eXBlcyBvZiB0aGUgc3BlY2lmaWVkIHR5cGUuIChKTFM4
IG9ubHkpCisJICogCisJICogQHJldHVybiB0aGUgbGlzdCBvZiBleHRyYSBkaW1lbnNpb24gdHlw
ZXMKKwkgKiBAZXhjZXB0aW9uIElsbGVnYWxBcmd1bWVudEV4Y2VwdGlvbiBpZiBzcGVjaWZpZWQg
YXBpIGxldmVsIGlzIGxvd2VyIHRoYW4gSkxTOC4KKwkgKiBAc2luY2UgMy45CisJICovCisJcHVi
bGljIGFic3RyYWN0IExpc3QgZ2V0RXh0cmFEaW1lbnNpb25UeXBlcygpOworCQogCS8qKgogCSAq
IFJldHVybnMgdGhlIGluaXRpYWxpemVyIG9mIHRoaXMgdmFyaWFibGUgZGVjbGFyYXRpb24sIG9y
CmRpZmYgLS1naXQgYS9vcmcuZWNsaXBzZS5qZHQuY29yZS9kb20vb3JnL2VjbGlwc2UvamR0L2Nv
cmUvZG9tL1ZhcmlhYmxlRGVjbGFyYXRpb25GcmFnbWVudC5qYXZhIGIvb3JnLmVjbGlwc2UuamR0
LmNvcmUvZG9tL29yZy9lY2xpcHNlL2pkdC9jb3JlL2RvbS9WYXJpYWJsZURlY2xhcmF0aW9uRnJh
Z21lbnQuamF2YQppbmRleCBlOWRlN2M4Li44NDlmODNlIDEwMDY0NAotLS0gYS9vcmcuZWNsaXBz
ZS5qZHQuY29yZS9kb20vb3JnL2VjbGlwc2UvamR0L2NvcmUvZG9tL1ZhcmlhYmxlRGVjbGFyYXRp
b25GcmFnbWVudC5qYXZhCisrKyBiL29yZy5lY2xpcHNlLmpkdC5jb3JlL2RvbS9vcmcvZWNsaXBz
ZS9qZHQvY29yZS9kb20vVmFyaWFibGVEZWNsYXJhdGlvbkZyYWdtZW50LmphdmEKQEAgLTQ3LDQg
KzQ3LDExIEBACiAKIAkvKioKKwkgKiBUaGUgImV4dHJhQW5ub3RhdGVkRGltZW5zaW9ucyIgc3Ry
dWN0dXJhbCBwcm9wZXJ0eSBvZiB0aGlzIG5vZGUgdHlwZSAoY2hpbGQgdHlwZToge0BsaW5rIERp
bWVuc2lvblR5cGV9KS4KKwkgKiBAc2luY2UgMy45CisJICovCisJcHVibGljIHN0YXRpYyBmaW5h
bCBDaGlsZExpc3RQcm9wZXJ0eURlc2NyaXB0b3IgRVhUUkFfRElNRU5TSU9OX1RZUEVTX1BST1BF
UlRZID0KKwkJCW5ldyBDaGlsZExpc3RQcm9wZXJ0eURlc2NyaXB0b3IoVmFyaWFibGVEZWNsYXJh
dGlvbkZyYWdtZW50LmNsYXNzLCAiZXh0cmFEaW1lbnNpb25UeXBlcyIsIERpbWVuc2lvblR5cGUu
Y2xhc3MsIE5PX0NZQ0xFX1JJU0spOyAvLyROT04tTkxTLTEkCisKKwkvKioKIAkgKiBUaGUgImlu
aXRpYWxpemVyIiBzdHJ1Y3R1cmFsIHByb3BlcnR5IG9mIHRoaXMgbm9kZSB0eXBlIChjaGlsZCB0
eXBlOiB7QGxpbmsgRXhwcmVzc2lvbn0pLgogCSAqIEBzaW5jZSAzLjAKQEAgLTYwLDEyICs2Nywz
MCBAQAogCSAqLwogCXByaXZhdGUgc3RhdGljIGZpbmFsIExpc3QgUFJPUEVSVFlfREVTQ1JJUFRP
UlM7CisJCisJLyoqCisJICogQSBsaXN0IG9mIHByb3BlcnR5IGRlc2NyaXB0b3JzIChlbGVtZW50
IHR5cGU6CisJICoge0BsaW5rIFN0cnVjdHVyYWxQcm9wZXJ0eURlc2NyaXB0b3J9KSwKKwkgKiBv
ciBudWxsIGlmIHVuaW5pdGlhbGl6ZWQuCisJICogQHNpbmNlIDMuOQorCSAqLworCXByaXZhdGUg
c3RhdGljIGZpbmFsIExpc3QgUFJPUEVSVFlfREVTQ1JJUFRPUlNfOF8wOwogCiAJc3RhdGljIHsK
IAkJTGlzdCBwcm9wZXJ0eUxpc3QgPSBuZXcgQXJyYXlMaXN0KDQpOwogCQljcmVhdGVQcm9wZXJ0
eUxpc3QoVmFyaWFibGVEZWNsYXJhdGlvbkZyYWdtZW50LmNsYXNzLCBwcm9wZXJ0eUxpc3QpOwot
CQlhZGRQcm9wZXJ0eShOQU1FX1BST1BFUlRZLCBwcm9wZXJ0eUxpc3QpOworCQlhZGRKTFMzUHJv
cGVydGllcyhwcm9wZXJ0eUxpc3QpOwogCQlhZGRQcm9wZXJ0eShFWFRSQV9ESU1FTlNJT05TX1BS
T1BFUlRZLCBwcm9wZXJ0eUxpc3QpOwotCQlhZGRQcm9wZXJ0eShJTklUSUFMSVpFUl9QUk9QRVJU
WSwgcHJvcGVydHlMaXN0KTsKIAkJUFJPUEVSVFlfREVTQ1JJUFRPUlMgPSByZWFwUHJvcGVydHlM
aXN0KHByb3BlcnR5TGlzdCk7CisJCQorCQlwcm9wZXJ0eUxpc3QgPSBuZXcgQXJyYXlMaXN0KDQp
OworCQljcmVhdGVQcm9wZXJ0eUxpc3QoVmFyaWFibGVEZWNsYXJhdGlvbkZyYWdtZW50LmNsYXNz
LCBwcm9wZXJ0eUxpc3QpOworCQlhZGRKTFMzUHJvcGVydGllcyhwcm9wZXJ0eUxpc3QpOworCQlh
ZGRQcm9wZXJ0eShFWFRSQV9ESU1FTlNJT05fVFlQRVNfUFJPUEVSVFksIHByb3BlcnR5TGlzdCk7
CisJCVBST1BFUlRZX0RFU0NSSVBUT1JTXzhfMCA9IHJlYXBQcm9wZXJ0eUxpc3QocHJvcGVydHlM
aXN0KTsKKwl9CisKKwlwcml2YXRlIHN0YXRpYyB2b2lkIGFkZEpMUzNQcm9wZXJ0aWVzKExpc3Qg
cHJvcGVydHlMaXN0KSB7CisJCWFkZFByb3BlcnR5KE5BTUVfUFJPUEVSVFksIHByb3BlcnR5TGlz
dCk7CisJCWFkZFByb3BlcnR5KElOSVRJQUxJWkVSX1BST1BFUlRZLCBwcm9wZXJ0eUxpc3QpOwog
CX0KIApAQCAtODEsNSArMTA2LDkgQEAKIAkgKi8KIAlwdWJsaWMgc3RhdGljIExpc3QgcHJvcGVy
dHlEZXNjcmlwdG9ycyhpbnQgYXBpTGV2ZWwpIHsKLQkJcmV0dXJuIFBST1BFUlRZX0RFU0NSSVBU
T1JTOworCQlpZiAoYXBpTGV2ZWwgPj0gQVNULkpMUzgpIHsKKwkJCXJldHVybiBQUk9QRVJUWV9E
RVNDUklQVE9SU184XzA7CisJCX0gZWxzZSB7CisJCQlyZXR1cm4gUFJPUEVSVFlfREVTQ1JJUFRP
UlM7CisJCX0KIAl9CiAKQEAgLTk1LDQgKzEyNCwxMSBAQAogCSAqLwogCXByaXZhdGUgaW50IGV4
dHJhQXJyYXlEaW1lbnNpb25zID0gMDsKKwkKKwkvKioKKwkgKiBUaGUgZXh0cmEgZGltZW5zaW9u
IHR5cGVzIHRoaXMgbm9kZSBoYXMgd2l0aCBhbm5vdGF0aW9ucyBpZiBhbnkuCisJICogCisJICog
QHNpbmNlIDMuOQorCSAqLworCXByb3RlY3RlZCBBU1ROb2RlLk5vZGVMaXN0IGV4dHJhRGltZW5z
aW9uVHlwZXMgPSBudWxsOwogCiAJLyoqCkBAIC0xMTQsNCArMTUwLDcgQEAKIAlWYXJpYWJsZURl
Y2xhcmF0aW9uRnJhZ21lbnQoQVNUIGFzdCkgewogCQlzdXBlcihhc3QpOworCQlpZiAoYXN0LmFw
aUxldmVsID49IEFTVC5KTFM4KSB7CisJCQl0aGlzLmV4dHJhRGltZW5zaW9uVHlwZXMgPSBuZXcg
QVNUTm9kZS5Ob2RlTGlzdChFWFRSQV9ESU1FTlNJT05fVFlQRVNfUFJPUEVSVFkpOworCQl9CiAJ
fQogCkBAIC0xNzQsNSArMjEzLDUgQEAKIAkJCQlyZXR1cm4gbnVsbDsKIAkJCX0KLQkJfQorCQl9
IAogCQlpZiAocHJvcGVydHkgPT0gSU5JVElBTElaRVJfUFJPUEVSVFkpIHsKIAkJCWlmIChnZXQp
IHsKQEAgLTE4Miw3ICsyMjEsMTkgQEAKIAkJCQlyZXR1cm4gbnVsbDsKIAkJCX0KLQkJfQorCQl9
IAorCQkKIAkJLy8gYWxsb3cgZGVmYXVsdCBpbXBsZW1lbnRhdGlvbiB0byBmbGFnIHRoZSBlcnJv
cgogCQlyZXR1cm4gc3VwZXIuaW50ZXJuYWxHZXRTZXRDaGlsZFByb3BlcnR5KHByb3BlcnR5LCBn
ZXQsIGNoaWxkKTsKKwl9CisKKwkvKiAob21pdCBqYXZhZG9jIGZvciB0aGlzIG1ldGhvZCkKKwkg
KiBNZXRob2QgZGVjbGFyZWQgb24gQVNUTm9kZS4KKwkgKi8KKwlmaW5hbCBMaXN0IGludGVybmFs
R2V0Q2hpbGRMaXN0UHJvcGVydHkoQ2hpbGRMaXN0UHJvcGVydHlEZXNjcmlwdG9yIHByb3BlcnR5
KSB7CisJCWlmIChwcm9wZXJ0eSA9PSBFWFRSQV9ESU1FTlNJT05fVFlQRVNfUFJPUEVSVFkpIHsK
KwkJCXJldHVybiB0aGlzLmV4dHJhRGltZW5zaW9uVHlwZXM7CisJCX0KKwkJLy8gYWxsb3cgZGVm
YXVsdCBpbXBsZW1lbnRhdGlvbiB0byBmbGFnIHRoZSBlcnJvcgorCQlyZXR1cm4gc3VwZXIuaW50
ZXJuYWxHZXRDaGlsZExpc3RQcm9wZXJ0eShwcm9wZXJ0eSk7CiAJfQogCkBAIC0yMDEsNSArMjUy
LDExIEBACiAJCXJlc3VsdC5zZXRTb3VyY2VSYW5nZShnZXRTdGFydFBvc2l0aW9uKCksIGdldExl
bmd0aCgpKTsKIAkJcmVzdWx0LnNldE5hbWUoKFNpbXBsZU5hbWUpIGdldE5hbWUoKS5jbG9uZSh0
YXJnZXQpKTsKLQkJcmVzdWx0LnNldEV4dHJhRGltZW5zaW9ucyhnZXRFeHRyYURpbWVuc2lvbnMo
KSk7CisJCWlmICh0aGlzLmFzdC5hcGlMZXZlbCA+PSBBU1QuSkxTOCkgeworCQkJcmVzdWx0LmV4
dHJhRGltZW5zaW9uVHlwZXMgPSBuZXcgQVNUTm9kZS5Ob2RlTGlzdChFWFRSQV9ESU1FTlNJT05f
VFlQRVNfUFJPUEVSVFkpOworCQkJcmVzdWx0LmV4dHJhRGltZW5zaW9uVHlwZXMuYWRkQWxsKAor
CQkJCQlBU1ROb2RlLmNvcHlTdWJ0cmVlcyh0YXJnZXQsIHRoaXMuZXh0cmFEaW1lbnNpb25UeXBl
cykpOworCQl9IGVsc2UgeworCQkJcmVzdWx0LnNldEV4dHJhRGltZW5zaW9ucyhnZXRFeHRyYURp
bWVuc2lvbnMoKSk7CisJCX0KIAkJcmVzdWx0LnNldEluaXRpYWxpemVyKAogCQkJKEV4cHJlc3Np
b24pIEFTVE5vZGUuY29weVN1YnRyZWUodGFyZ2V0LCBnZXRJbml0aWFsaXplcigpKSk7CkBAIC0y
MjQsNCArMjgxLDggQEAKIAkJCWFjY2VwdENoaWxkKHZpc2l0b3IsIGdldE5hbWUoKSk7CiAJCQlh
Y2NlcHRDaGlsZCh2aXNpdG9yLCBnZXRJbml0aWFsaXplcigpKTsKKwkJCQorCQkJaWYgKHRoaXMu
YXN0LmFwaUxldmVsID49IEFTVC5KTFM4KSB7CisJCQkJYWNjZXB0Q2hpbGRyZW4odmlzaXRvciwg
dGhpcy5leHRyYURpbWVuc2lvblR5cGVzKTsKKwkJCX0KIAkJfQogCQl2aXNpdG9yLmVuZFZpc2l0
KHRoaXMpOwpAQCAtMjczLDQgKzMzNCw1IEBACiAJICovCiAJcHVibGljIGludCBnZXRFeHRyYURp
bWVuc2lvbnMoKSB7CisJCXN1cHBvcnRlZE9ubHlJbjJfM180KCk7CiAJCXJldHVybiB0aGlzLmV4
dHJhQXJyYXlEaW1lbnNpb25zOwogCX0KQEAgLTI5MCw0ICszNTIsNSBAQAogCSAqLwogCXB1Ymxp
YyB2b2lkIHNldEV4dHJhRGltZW5zaW9ucyhpbnQgZGltZW5zaW9ucykgeworCQlzdXBwb3J0ZWRP
bmx5SW4yXzNfNCgpOwogCQlpZiAoZGltZW5zaW9ucyA8IDApIHsKIAkJCXRocm93IG5ldyBJbGxl
Z2FsQXJndW1lbnRFeGNlcHRpb24oKTsKQEAgLTI5Nyw1ICszNjAsMTYgQEAKIAkJcG9zdFZhbHVl
Q2hhbmdlKEVYVFJBX0RJTUVOU0lPTlNfUFJPUEVSVFkpOwogCX0KLQorCQorCS8qKgorCSAqIFJl
dHVybnMgdGhlIGxpdmUgb3JkZXJlZCBsaXN0IG9mIGV4dHJhIGRpbWVuc2lvbnMgd2l0aCBhbm5v
dGF0aW9ucyBpZiBhbnkuCisJICogCisJICogQHJldHVybiB0aGUgbGl2ZSBsaXN0IG9mIGV4dHJh
IGRpbWVuc2lvbnMgd2l0aCBhbm5vdGF0aW9ucyBpZiBhbnkgKGVsZW1lbnQgdHlwZToge0BsaW5r
IERpbWVuc2lvblR5cGV9W10pCisJICogQHNpbmNlIDMuOQorCSAqLworCXB1YmxpYyBMaXN0IGdl
dEV4dHJhRGltZW5zaW9uVHlwZXMoKSB7CisJCXVuc3VwcG9ydGVkSW4yXzNfNCgpOworCQlyZXR1
cm4gdGhpcy5leHRyYURpbWVuc2lvblR5cGVzOworCX0KKwkKIAkvKiAob21pdCBqYXZhZG9jIGZv
ciB0aGlzIG1ldGhvZCkKIAkgKiBNZXRob2QgZGVjbGFyZWQgb24gVmFyaWFibGVEZWNsYXJhdGlv
bi4KZGlmZiAtLWdpdCBhL29yZy5lY2xpcHNlLmpkdC5jb3JlL2RvbS9vcmcvZWNsaXBzZS9qZHQv
aW50ZXJuYWwvY29yZS9kb20vTmFpdmVBU1RGbGF0dGVuZXIuamF2YSBiL29yZy5lY2xpcHNlLmpk
dC5jb3JlL2RvbS9vcmcvZWNsaXBzZS9qZHQvaW50ZXJuYWwvY29yZS9kb20vTmFpdmVBU1RGbGF0
dGVuZXIuamF2YQppbmRleCA5NGRjM2YxLi5lYjg0OTExIDEwMDY0NAotLS0gYS9vcmcuZWNsaXBz
ZS5qZHQuY29yZS9kb20vb3JnL2VjbGlwc2UvamR0L2ludGVybmFsL2NvcmUvZG9tL05haXZlQVNU
RmxhdHRlbmVyLmphdmEKKysrIGIvb3JnLmVjbGlwc2UuamR0LmNvcmUvZG9tL29yZy9lY2xpcHNl
L2pkdC9pbnRlcm5hbC9jb3JlL2RvbS9OYWl2ZUFTVEZsYXR0ZW5lci5qYXZhCkBAIC00Niw0ICs0
Niw1IEBACiBpbXBvcnQgb3JnLmVjbGlwc2UuamR0LmNvcmUuZG9tLkNvbnN0cnVjdG9ySW52b2Nh
dGlvbjsKIGltcG9ydCBvcmcuZWNsaXBzZS5qZHQuY29yZS5kb20uQ29udGludWVTdGF0ZW1lbnQ7
CitpbXBvcnQgb3JnLmVjbGlwc2UuamR0LmNvcmUuZG9tLkRpbWVuc2lvblR5cGU7CiBpbXBvcnQg
b3JnLmVjbGlwc2UuamR0LmNvcmUuZG9tLlVuaW9uVHlwZTsKIGltcG9ydCBvcmcuZWNsaXBzZS5q
ZHQuY29yZS5kb20uRG9TdGF0ZW1lbnQ7CkBAIC00MTQsNCArNDE1LDEwIEBACiAJCXZpc2l0VHlw
ZUFubm90YXRpb25zKG5vZGUpOwogCQl0aGlzLmJ1ZmZlci5hcHBlbmQoIltdIik7Ly8kTk9OLU5M
Uy0xJAorCQlyZXR1cm4gZmFsc2U7CisJfQorCisJcHVibGljIGJvb2xlYW4gdmlzaXQoRGltZW5z
aW9uVHlwZSBub2RlKSB7CisJCXZpc2l0VHlwZUFubm90YXRpb25zKG5vZGUpOworCQl0aGlzLmJ1
ZmZlci5hcHBlbmQoIltdIik7IC8vJE5PTi1OTFMtMSQKIAkJcmV0dXJuIGZhbHNlOwogCX0KQEAg
LTEwMjIsNiArMTAyOSw5IEBACiAJCX0KIAkJdGhpcy5idWZmZXIuYXBwZW5kKCIpIik7Ly8kTk9O
LU5MUy0xJAotCQlmb3IgKGludCBpID0gMDsgaSA8IG5vZGUuZ2V0RXh0cmFEaW1lbnNpb25zKCk7
IGkrKykgewotCQkJdGhpcy5idWZmZXIuYXBwZW5kKCJbXSIpOyAvLyROT04tTkxTLTEkCisJCWlm
IChub2RlLmdldEFTVCgpLmFwaUxldmVsKCkgPj0gQVNULkpMUzgpIHsKKwkJCUxpc3QgZGltZW5z
aW9ucyA9IG5vZGUuZ2V0RXh0cmFBbm5vdGF0ZWREaW1lbnNpb25zKCk7CisJCQlmb3IgKGludCBp
ID0gMDsgaSA8IGRpbWVuc2lvbnMuc2l6ZSgpOyBpKyspIHsKKwkJCQl2aXNpdCgoRGltZW5zaW9u
VHlwZSkgZGltZW5zaW9ucy5nZXQoaSkpOworCQkJfQogCQl9CiAJCWlmICghbm9kZS50aHJvd25F
eGNlcHRpb25zKCkuaXNFbXB0eSgpKSB7CkBAIC0xMzI1LDYgKzEzMzUsOSBAQAogCQl0aGlzLmJ1
ZmZlci5hcHBlbmQoIiAiKTsvLyROT04tTkxTLTEkCiAJCW5vZGUuZ2V0TmFtZSgpLmFjY2VwdCh0
aGlzKTsKLQkJZm9yIChpbnQgaSA9IDA7IGkgPCBub2RlLmdldEV4dHJhRGltZW5zaW9ucygpOyBp
KyspIHsKLQkJCXRoaXMuYnVmZmVyLmFwcGVuZCgiW10iKTsgLy8kTk9OLU5MUy0xJAorCQlpZiAo
bm9kZS5nZXRBU1QoKS5hcGlMZXZlbCgpID49IEFTVC5KTFM4KSB7CisJCQlMaXN0IGRpbWVuc2lv
bnMgPSBub2RlLmdldEV4dHJhRGltZW5zaW9uVHlwZXMoKTsKKwkJCWZvciAoaW50IGkgPSAwOyBp
IDwgZGltZW5zaW9ucy5zaXplKCk7IGkrKykgeworCQkJCXZpc2l0KChEaW1lbnNpb25UeXBlKSBk
aW1lbnNpb25zLmdldChpKSk7CisJCQl9CiAJCX0KIAkJaWYgKG5vZGUuZ2V0SW5pdGlhbGl6ZXIo
KSAhPSBudWxsKSB7CkBAIC0xNzQ2LDYgKzE3NTksOSBAQAogCXB1YmxpYyBib29sZWFuIHZpc2l0
KFZhcmlhYmxlRGVjbGFyYXRpb25GcmFnbWVudCBub2RlKSB7CiAJCW5vZGUuZ2V0TmFtZSgpLmFj
Y2VwdCh0aGlzKTsKLQkJZm9yIChpbnQgaSA9IDA7IGkgPCBub2RlLmdldEV4dHJhRGltZW5zaW9u
cygpOyBpKyspIHsKLQkJCXRoaXMuYnVmZmVyLmFwcGVuZCgiW10iKTsvLyROT04tTkxTLTEkCisJ
CWlmIChub2RlLmdldEFTVCgpLmFwaUxldmVsKCkgPj0gQVNULkpMUzgpIHsKKwkJCUxpc3QgZGlt
ZW5zaW9ucyA9IG5vZGUuZ2V0RXh0cmFEaW1lbnNpb25UeXBlcygpOworCQkJZm9yIChpbnQgaSA9
IDA7IGkgPCBkaW1lbnNpb25zLnNpemUoKTsgaSsrKSB7CisJCQkJdmlzaXQoKERpbWVuc2lvblR5
cGUpIGRpbWVuc2lvbnMuZ2V0KGkpKTsKKwkJCX0KIAkJfQogCQlpZiAobm9kZS5nZXRJbml0aWFs
aXplcigpICE9IG51bGwpIHsKQEAgLTE4MTMsNSArMTgyOSw1IEBACiAJCWlmIChub2RlLmdldEFT
VCgpLmFwaUxldmVsKCkgPj0gQVNULkpMUzgpIHsKIAkJCUxpc3QgYW5ub3RhdGlvbnMgPSBub2Rl
LmFubm90YXRpb25zKCk7Ci0JCQlpZiAoYW5ub3RhdGlvbnMgIT0gbnVsbCkgeworCQkJaWYgKGFu
bm90YXRpb25zICE9IG51bGwgJiYgYW5ub3RhdGlvbnMuc2l6ZSgpID4gMCkgewogCQkJCWZvciAo
SXRlcmF0b3IgaXQgPSBhbm5vdGF0aW9ucy5pdGVyYXRvcigpOyBpdC5oYXNOZXh0KCk7ICkgewog
CQkJCQlBbm5vdGF0aW9uIGFubm90YXRpb24gPSAoQW5ub3RhdGlvbikgaXQubmV4dCgpOwpAQCAt
MTgyNSw1ICsxODQxLDUgQEAKIAkJaWYgKG5vZGUuZ2V0QVNUKCkuYXBpTGV2ZWwoKSA+PSBBU1Qu
SkxTOCkgewogCQkJTGlzdCBhbm5vdGF0aW9ucyA9IG5vZGUuYW5ub3RhdGlvbnMoKTsKLQkJCWlm
IChhbm5vdGF0aW9ucyAhPSBudWxsKSB7CisJCQlpZiAoYW5ub3RhdGlvbnMgIT0gbnVsbCAmJiBh
bm5vdGF0aW9ucy5zaXplKCkgPiAwKSB7CiAJCQkJZm9yIChJdGVyYXRvciBpdCA9IGFubm90YXRp
b25zLml0ZXJhdG9yKCk7IGl0Lmhhc05leHQoKTsgKSB7CiAJCQkJCUFubm90YXRpb24gYW5ub3Rh
dGlvbiA9IChBbm5vdGF0aW9uKSBpdC5uZXh0KCk7CmRpZmYgLS1naXQgYS9vcmcuZWNsaXBzZS5q
ZHQuY29yZS9kb20vb3JnL2VjbGlwc2UvamR0L2ludGVybmFsL2NvcmUvZG9tL3Jld3JpdGUvQVNU
UmV3cml0ZUFuYWx5emVyLmphdmEgYi9vcmcuZWNsaXBzZS5qZHQuY29yZS9kb20vb3JnL2VjbGlw
c2UvamR0L2ludGVybmFsL2NvcmUvZG9tL3Jld3JpdGUvQVNUUmV3cml0ZUFuYWx5emVyLmphdmEK
aW5kZXggYjI2MTFhMS4uYzljNTQ2MiAxMDA2NDQKLS0tIGEvb3JnLmVjbGlwc2UuamR0LmNvcmUv
ZG9tL29yZy9lY2xpcHNlL2pkdC9pbnRlcm5hbC9jb3JlL2RvbS9yZXdyaXRlL0FTVFJld3JpdGVB
bmFseXplci5qYXZhCisrKyBiL29yZy5lY2xpcHNlLmpkdC5jb3JlL2RvbS9vcmcvZWNsaXBzZS9q
ZHQvaW50ZXJuYWwvY29yZS9kb20vcmV3cml0ZS9BU1RSZXdyaXRlQW5hbHl6ZXIuamF2YQpAQCAt
MTgzMyw0ICsxODMzLDkgQEAKIAkJCXBvcz0gZ2V0U2Nhbm5lcigpLmdldFRva2VuRW5kT2Zmc2V0
KFRlcm1pbmFsVG9rZW5zLlRva2VuTmFtZVJQQVJFTiwgcG9zKTsKIAorCQkJLy8gSW4gY2FzZSBv
ZiBBU1QuSkxTOCwgdGhlIGRpbWVuc2lvbnMgd2lsbCBoYXZlIGFubm90YXRpb25zIGFzIHdlbGwK
KwkJCS8vIFN1cHBvcnQgbmV3IHByb3BlcnR5IEVYVFJBX0FOTk9UQVRFRF9ESU1FTlNJT05TX1BS
T1BFUlRZCisJCQkvLyBhbGdvcml0aG06IDEuIFNlZSBpZiB0aGUgbmV3IHByb3BlcnR5IGhhcyBj
aGFuZ2VkCisJCQkvLyAJCQkJMi4gSWYgdHJ1ZSwgZG9uJ3QgYm90aGVyIGFib3V0IEVYVFJBX0RJ
TUVOU0lPTlNfUFJPUEVSVFksIHJld3JpdGUgYWNjb3JkaW5nIHRvIHRoZSBuZXcgdmFsdWUgb2Yg
dGhlIEVYVFJBX0FOTk9UQVRFRF9ESU1FTlNJT05TX1BST1BFUlRZCisJCQkvLwkJCQkzLiBJZiBm
YWxzZSwgc2VlIHByb2NlZWQgYXMgdXN1YWwuIAogCQkJaW50IGV4dHJhRGltcz0gcmV3cml0ZUV4
dHJhRGltZW5zaW9ucyhub2RlLCBNZXRob2REZWNsYXJhdGlvbi5FWFRSQV9ESU1FTlNJT05TX1BS
T1BFUlRZLCBwb3MpOwogCmRpZmYgLS1naXQgYS9vcmcuZWNsaXBzZS5qZHQuY29yZS9kb20vb3Jn
L2VjbGlwc2UvamR0L2ludGVybmFsL2NvcmUvZG9tL3Jld3JpdGUvQVNUUmV3cml0ZUZsYXR0ZW5l
ci5qYXZhIGIvb3JnLmVjbGlwc2UuamR0LmNvcmUvZG9tL29yZy9lY2xpcHNlL2pkdC9pbnRlcm5h
bC9jb3JlL2RvbS9yZXdyaXRlL0FTVFJld3JpdGVGbGF0dGVuZXIuamF2YQppbmRleCAxNGQyYjU5
Li41YTRkMjBhIDEwMDY0NAotLS0gYS9vcmcuZWNsaXBzZS5qZHQuY29yZS9kb20vb3JnL2VjbGlw
c2UvamR0L2ludGVybmFsL2NvcmUvZG9tL3Jld3JpdGUvQVNUUmV3cml0ZUZsYXR0ZW5lci5qYXZh
CisrKyBiL29yZy5lY2xpcHNlLmpkdC5jb3JlL2RvbS9vcmcvZWNsaXBzZS9qZHQvaW50ZXJuYWwv
Y29yZS9kb20vcmV3cml0ZS9BU1RSZXdyaXRlRmxhdHRlbmVyLmphdmEKQEAgLTIyNyw2ICsyMjcs
MTIgQEAKIAkJZ2V0Q2hpbGROb2RlKG5vZGUsIEFycmF5VHlwZS5DT01QT05FTlRfVFlQRV9QUk9Q
RVJUWSkuYWNjZXB0KHRoaXMpOwogCQlpZiAobm9kZS5nZXRBU1QoKS5hcGlMZXZlbCgpID49IEFT
VC5KTFM4KSB7Ci0JCQl2aXNpdExpc3Qobm9kZSwgQXJyYXlUeXBlLkFOTk9UQVRJT05TX1BST1BF
UlRZLCBTdHJpbmcudmFsdWVPZignICcpLCBVdGlsLkVNUFRZX1NUUklORywgU3RyaW5nLnZhbHVl
T2YoJyAnKSk7CisJCQl2aXNpdExpc3Qobm9kZSwgQXJyYXlUeXBlLkFOTk9UQVRJT05TX1BST1BF
UlRZLCBTdHJpbmcudmFsdWVPZignICcpLCBVdGlsLkVNUFRZX1NUUklORywgVXRpbC5FTVBUWV9T
VFJJTkcpOwogCQl9CisJCXRoaXMucmVzdWx0LmFwcGVuZCgiW10iKTsgLy8kTk9OLU5MUy0xJAor
CQlyZXR1cm4gZmFsc2U7CisJfQorCQorCXB1YmxpYyBib29sZWFuIHZpc2l0KERpbWVuc2lvblR5
cGUgbm9kZSkgeworCQl2aXNpdExpc3Qobm9kZSwgQXJyYXlUeXBlLkFOTk9UQVRJT05TX1BST1BF
UlRZLCBTdHJpbmcudmFsdWVPZignICcpLCBVdGlsLkVNUFRZX1NUUklORywgVXRpbC5FTVBUWV9T
VFJJTkcpOwogCQl0aGlzLnJlc3VsdC5hcHBlbmQoIltdIik7IC8vJE5PTi1OTFMtMSQKIAkJcmV0
dXJuIGZhbHNlOwpAQCAtNzk1LDcgKzgwMSwxMSBAQAogCQl0aGlzLnJlc3VsdC5hcHBlbmQoJyAn
KTsKIAkJZ2V0Q2hpbGROb2RlKG5vZGUsIFNpbmdsZVZhcmlhYmxlRGVjbGFyYXRpb24uTkFNRV9Q
Uk9QRVJUWSkuYWNjZXB0KHRoaXMpOwotCQlpbnQgZXh0cmFEaW1lbnNpb25zPSBnZXRJbnRBdHRy
aWJ1dGUobm9kZSwgU2luZ2xlVmFyaWFibGVEZWNsYXJhdGlvbi5FWFRSQV9ESU1FTlNJT05TX1BS
T1BFUlRZKTsKLQkJZm9yIChpbnQgaSA9IDA7IGkgPCBleHRyYURpbWVuc2lvbnM7IGkrKykgewot
CQkJdGhpcy5yZXN1bHQuYXBwZW5kKCJbXSIpOyAvLyROT04tTkxTLTEkCisJCWlmIChub2RlLmdl
dEFTVCgpLmFwaUxldmVsKCkgPj0gQVNULkpMUzgpIHsKKwkJCXZpc2l0TGlzdChub2RlLCBTaW5n
bGVWYXJpYWJsZURlY2xhcmF0aW9uLkVYVFJBX0RJTUVOU0lPTl9UWVBFU19QUk9QRVJUWSwgU3Ry
aW5nLnZhbHVlT2YoJyAnKSwgVXRpbC5FTVBUWV9TVFJJTkcsIFV0aWwuRU1QVFlfU1RSSU5HKTsK
KwkJfSAgZWxzZSB7CisJCQlpbnQgZXh0cmFEaW1lbnNpb25zPSBnZXRJbnRBdHRyaWJ1dGUobm9k
ZSwgU2luZ2xlVmFyaWFibGVEZWNsYXJhdGlvbi5FWFRSQV9ESU1FTlNJT05TX1BST1BFUlRZKTsK
KwkJCWZvciAoaW50IGkgPSAwOyBpIDwgZXh0cmFEaW1lbnNpb25zOyBpKyspIHsKKwkJCQl0aGlz
LnJlc3VsdC5hcHBlbmQoIltdIik7IC8vJE5PTi1OTFMtMSQKKwkJCX0KIAkJfQogCQlBU1ROb2Rl
IGluaXRpYWxpemVyPSBnZXRDaGlsZE5vZGUobm9kZSwgU2luZ2xlVmFyaWFibGVEZWNsYXJhdGlv
bi5JTklUSUFMSVpFUl9QUk9QRVJUWSk7CkBAIC0xMDQwLDcgKzEwNTAsMTEgQEAKIAlwdWJsaWMg
Ym9vbGVhbiB2aXNpdChWYXJpYWJsZURlY2xhcmF0aW9uRnJhZ21lbnQgbm9kZSkgewogCQlnZXRD
aGlsZE5vZGUobm9kZSwgVmFyaWFibGVEZWNsYXJhdGlvbkZyYWdtZW50Lk5BTUVfUFJPUEVSVFkp
LmFjY2VwdCh0aGlzKTsKLQkJaW50IGV4dHJhRGltZW5zaW9ucz0gZ2V0SW50QXR0cmlidXRlKG5v
ZGUsIFZhcmlhYmxlRGVjbGFyYXRpb25GcmFnbWVudC5FWFRSQV9ESU1FTlNJT05TX1BST1BFUlRZ
KTsKLQkJZm9yIChpbnQgaSA9IDA7IGkgPCBleHRyYURpbWVuc2lvbnM7IGkrKykgewotCQkJdGhp
cy5yZXN1bHQuYXBwZW5kKCJbXSIpOyAvLyROT04tTkxTLTEkCisJCWlmIChub2RlLmdldEFTVCgp
LmFwaUxldmVsKCkgPj0gQVNULkpMUzgpIHsKKwkJCXZpc2l0TGlzdChub2RlLCBWYXJpYWJsZURl
Y2xhcmF0aW9uRnJhZ21lbnQuRVhUUkFfRElNRU5TSU9OX1RZUEVTX1BST1BFUlRZLCBTdHJpbmcu
dmFsdWVPZignICcpLCBVdGlsLkVNUFRZX1NUUklORywgVXRpbC5FTVBUWV9TVFJJTkcpOworCQl9
IGVsc2UgeworCQkJaW50IGV4dHJhRGltZW5zaW9ucz0gZ2V0SW50QXR0cmlidXRlKG5vZGUsIFZh
cmlhYmxlRGVjbGFyYXRpb25GcmFnbWVudC5FWFRSQV9ESU1FTlNJT05TX1BST1BFUlRZKTsKKwkJ
CWZvciAoaW50IGkgPSAwOyBpIDwgZXh0cmFEaW1lbnNpb25zOyBpKyspIHsKKwkJCQl0aGlzLnJl
c3VsdC5hcHBlbmQoIltdIik7IC8vJE5PTi1OTFMtMSQKKwkJCX0KIAkJfQogCQlBU1ROb2RlIGlu
aXRpYWxpemVyPSBnZXRDaGlsZE5vZGUobm9kZSwgVmFyaWFibGVEZWNsYXJhdGlvbkZyYWdtZW50
LklOSVRJQUxJWkVSX1BST1BFUlRZKTs=
</data>

          </attachment>
          <attachment
              isobsolete="1"
              ispatch="1"
              isprivate="0"
          >
            <attachid>225413</attachid>
            <date>2013-01-10 02:23:00 -0500</date>
            <delta_ts>2013-01-10 10:51:22 -0500</delta_ts>
            <desc>Latest patch</desc>
            <filename>Fix-for-bug-391895.patch</filename>
            <type>text/plain</type>
            <size>64481</size>
            <attacher name="Jay Arthanareeswaran">jarthana</attacher>
            
              <data encoding="base64">ZGlmZiAtLWdpdCBhL29yZy5lY2xpcHNlLmpkdC5jb3JlLnRlc3RzLm1vZGVsL3NyYy9vcmcvZWNs
aXBzZS9qZHQvY29yZS90ZXN0cy9kb20vQVNUQ29udmVydGVyMTVKTFM4VGVzdC5qYXZhIGIvb3Jn
LmVjbGlwc2UuamR0LmNvcmUudGVzdHMubW9kZWwvc3JjL29yZy9lY2xpcHNlL2pkdC9jb3JlL3Rl
c3RzL2RvbS9BU1RDb252ZXJ0ZXIxNUpMUzhUZXN0LmphdmEKaW5kZXggZjRiMTUyOC4uODc0NjI0
MCAxMDA2NDQKLS0tIGEvb3JnLmVjbGlwc2UuamR0LmNvcmUudGVzdHMubW9kZWwvc3JjL29yZy9l
Y2xpcHNlL2pkdC9jb3JlL3Rlc3RzL2RvbS9BU1RDb252ZXJ0ZXIxNUpMUzhUZXN0LmphdmEKKysr
IGIvb3JnLmVjbGlwc2UuamR0LmNvcmUudGVzdHMubW9kZWwvc3JjL29yZy9lY2xpcHNlL2pkdC9j
b3JlL3Rlc3RzL2RvbS9BU1RDb252ZXJ0ZXIxNUpMUzhUZXN0LmphdmEKQEAgLTUxNyw1ICs1MTcs
NSBAQAogCQltb2RpZmllciA9IChJRXh0ZW5kZWRNb2RpZmllcikgbW9kaWZpZXJzLmdldCgxKTsK
IAkJY2hlY2tTb3VyY2VSYW5nZSgoQVNUTm9kZSkgbW9kaWZpZXIsICJmaW5hbCIsIHNvdXJjZSk7
Ci0JCWFzc2VydEVxdWFscygiV3JvbmcgZGltZW5zaW9uIiwgMSwgc2luZ2xlVmFyaWFibGVEZWNs
YXJhdGlvbi5nZXRFeHRyYURpbWVuc2lvbnMoKSk7CisJCWFzc2VydEVxdWFscygiV3JvbmcgZGlt
ZW5zaW9uIiwgMSwgc2luZ2xlVmFyaWFibGVEZWNsYXJhdGlvbi5nZXRFeHRyYURpbWVuc2lvblR5
cGVzKCkuc2l6ZSgpKTsKIAkJVHlwZSB0eXBlID0gc2luZ2xlVmFyaWFibGVEZWNsYXJhdGlvbi5n
ZXRUeXBlKCk7CiAJCWNoZWNrU291cmNlUmFuZ2UodHlwZSwgIlN0cmluZyIsIHNvdXJjZSk7CkBA
IC0xNzEwLDUgKzE3MTAsNSBAQAogCQlBcnJheVR5cGUgYXJyYXlUeXBlID0gKEFycmF5VHlwZSkg
dHlwZTsKIAkJY2hlY2tTb3VyY2VSYW5nZShhcnJheVR5cGUuZ2V0Q29tcG9uZW50VHlwZSgpLCAi
U3RyaW5nIiwgc291cmNlKTsKLQkJYXNzZXJ0RXF1YWxzKCJXcm9uZyBleHRyYSBkaW1lbnNpb25z
IiwgMSwgc2luZ2xlVmFyaWFibGVEZWNsYXJhdGlvbi5nZXRFeHRyYURpbWVuc2lvbnMoKSk7CisJ
CWFzc2VydEVxdWFscygiV3JvbmcgZXh0cmEgZGltZW5zaW9ucyIsIDEsIHNpbmdsZVZhcmlhYmxl
RGVjbGFyYXRpb24uZ2V0RXh0cmFEaW1lbnNpb25UeXBlcygpLnNpemUoKSk7CiAJfQogCkBAIC0x
NzM4LDUgKzE3MzgsNSBAQAogCQlBcnJheVR5cGUgYXJyYXlUeXBlID0gKEFycmF5VHlwZSkgdHlw
ZTsKIAkJY2hlY2tTb3VyY2VSYW5nZShhcnJheVR5cGUuZ2V0Q29tcG9uZW50VHlwZSgpLCAiU3Ry
aW5nIiwgc291cmNlKTsKLQkJYXNzZXJ0RXF1YWxzKCJXcm9uZyBleHRyYSBkaW1lbnNpb25zIiwg
MCwgc2luZ2xlVmFyaWFibGVEZWNsYXJhdGlvbi5nZXRFeHRyYURpbWVuc2lvbnMoKSk7CisJCWFz
c2VydEVxdWFscygiV3JvbmcgZXh0cmEgZGltZW5zaW9ucyIsIDAsIHNpbmdsZVZhcmlhYmxlRGVj
bGFyYXRpb24uZ2V0RXh0cmFEaW1lbnNpb25UeXBlcygpLnNpemUoKSk7CiAJfQogCS8qKgpkaWZm
IC0tZ2l0IGEvb3JnLmVjbGlwc2UuamR0LmNvcmUudGVzdHMubW9kZWwvc3JjL29yZy9lY2xpcHNl
L2pkdC9jb3JlL3Rlc3RzL2RvbS9BU1RDb252ZXJ0ZXIxOFRlc3QuamF2YSBiL29yZy5lY2xpcHNl
LmpkdC5jb3JlLnRlc3RzLm1vZGVsL3NyYy9vcmcvZWNsaXBzZS9qZHQvY29yZS90ZXN0cy9kb20v
QVNUQ29udmVydGVyMThUZXN0LmphdmEKbmV3IGZpbGUgbW9kZSAxMDA2NDQKaW5kZXggMDAwMDAw
MC4uOTE0YWIyZAotLS0gL2Rldi9udWxsCisrKyBiL29yZy5lY2xpcHNlLmpkdC5jb3JlLnRlc3Rz
Lm1vZGVsL3NyYy9vcmcvZWNsaXBzZS9qZHQvY29yZS90ZXN0cy9kb20vQVNUQ29udmVydGVyMThU
ZXN0LmphdmEKQEAgLTAsMCArMSwxNDEgQEAKKy8qKioqKioqKioqKioqKioqKioqKioqKioqKioq
KioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqCisgKiBD
b3B5cmlnaHQgKGMpIDIwMDAsIDIwMTEgSUJNIENvcnBvcmF0aW9uIGFuZCBvdGhlcnMuCisgKiBB
bGwgcmlnaHRzIHJlc2VydmVkLiBUaGlzIHByb2dyYW0gYW5kIHRoZSBhY2NvbXBhbnlpbmcgbWF0
ZXJpYWxzCisgKiBhcmUgbWFkZSBhdmFpbGFibGUgdW5kZXIgdGhlIHRlcm1zIG9mIHRoZSBFY2xp
cHNlIFB1YmxpYyBMaWNlbnNlIHYxLjAKKyAqIHdoaWNoIGFjY29tcGFuaWVzIHRoaXMgZGlzdHJp
YnV0aW9uLCBhbmQgaXMgYXZhaWxhYmxlIGF0CisgKiBodHRwOi8vd3d3LmVjbGlwc2Uub3JnL2xl
Z2FsL2VwbC12MTAuaHRtbAorICoKKyAqIFRoaXMgaXMgYW4gaW1wbGVtZW50YXRpb24gb2YgYW4g
ZWFybHktZHJhZnQgc3BlY2lmaWNhdGlvbiBkZXZlbG9wZWQgdW5kZXIgdGhlIEphdmEKKyAqIENv
bW11bml0eSBQcm9jZXNzIChKQ1ApIGFuZCBpcyBtYWRlIGF2YWlsYWJsZSBmb3IgdGVzdGluZyBh
bmQgZXZhbHVhdGlvbiBwdXJwb3NlcworICogb25seS4gVGhlIGNvZGUgaXMgbm90IGNvbXBhdGli
bGUgd2l0aCBhbnkgc3BlY2lmaWNhdGlvbiBvZiB0aGUgSkNQLgorICoKKyAqIENvbnRyaWJ1dG9y
czoKKyAqICAgICBJQk0gQ29ycG9yYXRpb24gLSBpbml0aWFsIEFQSSBhbmQgaW1wbGVtZW50YXRp
b24KKyAqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioq
KioqKioqKioqKioqKioqKioqKioqKioqKioqLworcGFja2FnZSBvcmcuZWNsaXBzZS5qZHQuY29y
ZS50ZXN0cy5kb207CisKK2ltcG9ydCBqYXZhLnV0aWwuTGlzdDsKKworaW1wb3J0IGp1bml0LmZy
YW1ld29yay5UZXN0OworCitpbXBvcnQgb3JnLmVjbGlwc2UuamR0LmNvcmUuSUNvbXBpbGF0aW9u
VW5pdDsKK2ltcG9ydCBvcmcuZWNsaXBzZS5qZHQuY29yZS5KYXZhTW9kZWxFeGNlcHRpb247Citp
bXBvcnQgb3JnLmVjbGlwc2UuamR0LmNvcmUuZG9tLkFTVDsKK2ltcG9ydCBvcmcuZWNsaXBzZS5q
ZHQuY29yZS5kb20uQVNUTm9kZTsKK2ltcG9ydCBvcmcuZWNsaXBzZS5qZHQuY29yZS5kb20uQ29t
cGlsYXRpb25Vbml0OworaW1wb3J0IG9yZy5lY2xpcHNlLmpkdC5jb3JlLmRvbS5GaWVsZERlY2xh
cmF0aW9uOworaW1wb3J0IG9yZy5lY2xpcHNlLmpkdC5jb3JlLmRvbS5NZXRob2REZWNsYXJhdGlv
bjsKK2ltcG9ydCBvcmcuZWNsaXBzZS5qZHQuY29yZS5kb20uU2luZ2xlVmFyaWFibGVEZWNsYXJh
dGlvbjsKK2ltcG9ydCBvcmcuZWNsaXBzZS5qZHQuY29yZS5kb20uVmFyaWFibGVEZWNsYXJhdGlv
bkZyYWdtZW50OworCitwdWJsaWMgY2xhc3MgQVNUQ29udmVydGVyMThUZXN0IGV4dGVuZHMgQ29u
dmVydGVyVGVzdFNldHVwIHsKKworCUlDb21waWxhdGlvblVuaXQgd29ya2luZ0NvcHk7CisKKwlw
dWJsaWMgdm9pZCBzZXRVcFN1aXRlKCkgdGhyb3dzIEV4Y2VwdGlvbiB7CisJCXN1cGVyLnNldFVw
U3VpdGUoKTsKKwkJdGhpcy5hc3QgPSBBU1QubmV3QVNUKEFTVC5KTFM4KTsKKwl9CisKKwlwdWJs
aWMgQVNUQ29udmVydGVyMThUZXN0KFN0cmluZyBuYW1lKSB7CisJCXN1cGVyKG5hbWUpOworCX0K
KworCXB1YmxpYyBzdGF0aWMgVGVzdCBzdWl0ZSgpIHsKKwkJcmV0dXJuIGJ1aWxkTW9kZWxUZXN0
U3VpdGUoQVNUQ29udmVydGVyMThUZXN0LmNsYXNzKTsKKwl9CisKKwlwcm90ZWN0ZWQgdm9pZCB0
ZWFyRG93bigpIHRocm93cyBFeGNlcHRpb24geworCQlzdXBlci50ZWFyRG93bigpOworCQlpZiAo
dGhpcy53b3JraW5nQ29weSAhPSBudWxsKSB7CisJCQl0aGlzLndvcmtpbmdDb3B5LmRpc2NhcmRX
b3JraW5nQ29weSgpOworCQkJdGhpcy53b3JraW5nQ29weSA9IG51bGw7CisJCX0KKwl9CisKKwlw
dWJsaWMgdm9pZCB0ZXN0MDAwMigpIHRocm93cyBKYXZhTW9kZWxFeGNlcHRpb24geworCQlTdHJp
bmcgY29udGVudHMgPQorCQkJCSJpbXBvcnQgamF2YS5sYW5nLmFubm90YXRpb24uRWxlbWVudFR5
cGU7XG4iICsKKwkJCQkiaW1wb3J0IGphdmEubGFuZy5hbm5vdGF0aW9uLlRhcmdldDtcbiIgKwor
CQkJCSJwdWJsaWMgY2xhc3MgWCB7XG4iICsKKwkJCQkiCXB1YmxpYyBATWFya2VyIGludCBATWFy
a2VyMSBbXSBmb28oKSBATWFya2VyMiBbXXsgcmV0dXJuIG51bGw7IH1cbiIgKworCQkJCSJ9XG4i
ICsKKwkJCQkiQFRhcmdldCh2YWx1ZSA9IHsgRWxlbWVudFR5cGUuVFlQRV9VU0V9KVxuIiArCisJ
CQkJIkBpbnRlcmZhY2UgTWFya2VyIHt9XG4iICsKKwkJCQkiQFRhcmdldCh2YWx1ZSA9IHsgRWxl
bWVudFR5cGUuVFlQRV9VU0V9KVxuIiArCisJCQkJIkBpbnRlcmZhY2UgTWFya2VyMSB7fVxuIiAr
CisJCQkJIkBUYXJnZXQodmFsdWUgPSB7IEVsZW1lbnRUeXBlLlRZUEVfVVNFfSlcbiIgKworCQkJ
CSJAaW50ZXJmYWNlIE1hcmtlcjIge30iOworCQl0aGlzLndvcmtpbmdDb3B5ID0gZ2V0V29ya2lu
Z0NvcHkoIi9Db252ZXJ0ZXIxOC9zcmMvWC5qYXZhIiwgdHJ1ZSk7CisJCUFTVE5vZGUgbm9kZSA9
IGJ1aWxkQVNUKGNvbnRlbnRzLCB0aGlzLndvcmtpbmdDb3B5KTsKKwkJYXNzZXJ0RXF1YWxzKCJO
b3QgYSBjb21waWxhdGlvbiB1bml0IiwgQVNUTm9kZS5DT01QSUxBVElPTl9VTklULCBub2RlLmdl
dE5vZGVUeXBlKCkpOworCQlDb21waWxhdGlvblVuaXQgdW5pdCA9IChDb21waWxhdGlvblVuaXQp
IG5vZGU7CisJCW5vZGUgPSBnZXRBU1ROb2RlKHVuaXQsIDAsIDApOworCQlhc3NlcnRFcXVhbHMo
Ik5vdCBhIG1ldGhvZCBEZWNsYXJhdGlvbiIsIEFTVE5vZGUuTUVUSE9EX0RFQ0xBUkFUSU9OLCBu
b2RlLmdldE5vZGVUeXBlKCkpOworCQlNZXRob2REZWNsYXJhdGlvbiBtZXRob2QgPSAoTWV0aG9k
RGVjbGFyYXRpb24pIG5vZGU7CisJCUxpc3QgZXh0cmFEaW1lbnNpb25zID0gbWV0aG9kLmdldEV4
dHJhQW5ub3RhdGVkRGltZW5zaW9ucygpOworCQlhc3NlcnRFeHRyYURpbWVuc2lvbnNFcXVhbCgi
V3JvbmcgZXh0cmEgZGltZW5zaW9uIGluZm8iLCBleHRyYURpbWVuc2lvbnMsICJATWFya2VyMiBb
XSAiKTsKKwl9CisJCisJcHVibGljIHZvaWQgdGVzdDAwMDMoKSB0aHJvd3MgSmF2YU1vZGVsRXhj
ZXB0aW9uIHsKKwkJU3RyaW5nIGNvbnRlbnRzID0KKwkJCQkiaW1wb3J0IGphdmEubGFuZy5hbm5v
dGF0aW9uLkVsZW1lbnRUeXBlO1xuIiArCisJCQkJImltcG9ydCBqYXZhLmxhbmcuYW5ub3RhdGlv
bi5UYXJnZXQ7XG4iICsKKwkJCQkicHVibGljIGNsYXNzIFgge1xuIiArCisJCQkJIglwdWJsaWMg
dm9pZCBmb28oQE1hcmtlciBpbnQgQE1hcmtlcjEgW10gaSBATWFya2VyMiBbXSkge31cbiIgKwor
CQkJCSJ9XG4iICsKKwkJCQkiQFRhcmdldCh2YWx1ZSA9IHsgRWxlbWVudFR5cGUuVFlQRV9VU0V9
KVxuIiArCisJCQkJIkBpbnRlcmZhY2UgTWFya2VyIHt9XG4iICsKKwkJCQkiQFRhcmdldCh2YWx1
ZSA9IHsgRWxlbWVudFR5cGUuVFlQRV9VU0V9KVxuIiArCisJCQkJIkBpbnRlcmZhY2UgTWFya2Vy
MSB7fVxuIiArCisJCQkJIkBUYXJnZXQodmFsdWUgPSB7IEVsZW1lbnRUeXBlLlRZUEVfVVNFfSlc
biIgKworCQkJCSJAaW50ZXJmYWNlIE1hcmtlcjIge30iOworCQl0aGlzLndvcmtpbmdDb3B5ID0g
Z2V0V29ya2luZ0NvcHkoIi9Db252ZXJ0ZXIxOC9zcmMvWC5qYXZhIiwgdHJ1ZSk7CisJCUFTVE5v
ZGUgbm9kZSA9IGJ1aWxkQVNUKGNvbnRlbnRzLCB0aGlzLndvcmtpbmdDb3B5KTsKKwkJYXNzZXJ0
RXF1YWxzKCJOb3QgYSBjb21waWxhdGlvbiB1bml0IiwgQVNUTm9kZS5DT01QSUxBVElPTl9VTklU
LCBub2RlLmdldE5vZGVUeXBlKCkpOworCQlDb21waWxhdGlvblVuaXQgdW5pdCA9IChDb21waWxh
dGlvblVuaXQpIG5vZGU7CisJCW5vZGUgPSBnZXRBU1ROb2RlKHVuaXQsIDAsIDApOworCQlhc3Nl
cnRFcXVhbHMoIk5vdCBhIG1ldGhvZCBEZWNsYXJhdGlvbiIsIEFTVE5vZGUuTUVUSE9EX0RFQ0xB
UkFUSU9OLCBub2RlLmdldE5vZGVUeXBlKCkpOworCQlTaW5nbGVWYXJpYWJsZURlY2xhcmF0aW9u
IHNpbmdsZVZhcmlhYmxlID0gKFNpbmdsZVZhcmlhYmxlRGVjbGFyYXRpb24pICgoTWV0aG9kRGVj
bGFyYXRpb24pIG5vZGUpLnBhcmFtZXRlcnMoKS5nZXQoMCk7CisJCWFzc2VydE5vdE51bGwoIldy
b25nIHBhcmFtZXRlciIsIHNpbmdsZVZhcmlhYmxlKTsKKwkJTGlzdCBleHRyYURpbWVuc2lvbnMg
PSBzaW5nbGVWYXJpYWJsZS5nZXRFeHRyYURpbWVuc2lvblR5cGVzKCk7CisJCWFzc2VydEV4dHJh
RGltZW5zaW9uc0VxdWFsKCJXcm9uZyBleHRyYSBkaW1lbnNpb24gaW5mbyIsIGV4dHJhRGltZW5z
aW9ucywgIkBNYXJrZXIyIFtdICIpOworCX0KKwkKKwlwdWJsaWMgdm9pZCB0ZXN0MDAwNCgpIHRo
cm93cyBKYXZhTW9kZWxFeGNlcHRpb24geworCQlTdHJpbmcgY29udGVudHMgPQorCQkJCSJpbXBv
cnQgamF2YS5sYW5nLmFubm90YXRpb24uRWxlbWVudFR5cGU7XG4iICsKKwkJCQkiaW1wb3J0IGph
dmEubGFuZy5hbm5vdGF0aW9uLlRhcmdldDtcbiIgKworCQkJCSJwdWJsaWMgY2xhc3MgWCB7XG4i
ICsKKwkJCQkiCUBNYXJrZXIgaW50IEBNYXJrZXIxIFtdIGEgQE1hcmtlcjIgW10gQE1hcmtlcjMg
W10gQE1hcmtlcjQgW10sIGIgQE1hcmtlcjIgQE1hcmtlcjMgW10gQE1hcmtlcjQgW10sIGMgW11b
XVtdO1xuIiArCisJCQkJIn1cbiIgKworCQkJCSJAVGFyZ2V0KHZhbHVlID0geyBFbGVtZW50VHlw
ZS5UWVBFX1VTRX0pXG4iICsKKwkJCQkiQGludGVyZmFjZSBNYXJrZXIge31cbiIgKworCQkJCSJA
VGFyZ2V0KHZhbHVlID0geyBFbGVtZW50VHlwZS5UWVBFX1VTRX0pXG4iICsKKwkJCQkiQGludGVy
ZmFjZSBNYXJrZXIxIHt9XG4iICsKKwkJCQkiQFRhcmdldCh2YWx1ZSA9IHsgRWxlbWVudFR5cGUu
VFlQRV9VU0V9KVxuIiArCisJCQkJIkBpbnRlcmZhY2UgTWFya2VyMiB7fVxuIiArCisJCQkJIkBU
YXJnZXQodmFsdWUgPSB7IEVsZW1lbnRUeXBlLlRZUEVfVVNFfSlcbiIgKworCQkJCSJAaW50ZXJm
YWNlIE1hcmtlcjMge31cbiIgKworCQkJCSJAVGFyZ2V0KHZhbHVlID0geyBFbGVtZW50VHlwZS5U
WVBFX1VTRX0pXG4iICsKKwkJCQkiQGludGVyZmFjZSBNYXJrZXI0IHt9IjsKKwkJU3lzdGVtLm91
dC5wcmludGxuKGNvbnRlbnRzKTsKKwkJdGhpcy53b3JraW5nQ29weSA9IGdldFdvcmtpbmdDb3B5
KCIvQ29udmVydGVyMTgvc3JjL1guamF2YSIsIHRydWUpOworCQlBU1ROb2RlIG5vZGUgPSBidWls
ZEFTVChjb250ZW50cywgdGhpcy53b3JraW5nQ29weSk7CisJCWFzc2VydEVxdWFscygiTm90IGEg
Y29tcGlsYXRpb24gdW5pdCIsIEFTVE5vZGUuQ09NUElMQVRJT05fVU5JVCwgbm9kZS5nZXROb2Rl
VHlwZSgpKTsKKwkJQ29tcGlsYXRpb25Vbml0IHVuaXQgPSAoQ29tcGlsYXRpb25Vbml0KSBub2Rl
OworCQlub2RlID0gZ2V0QVNUTm9kZSh1bml0LCAwLCAwKTsKKwkJYXNzZXJ0RXF1YWxzKCJOb3Qg
YSBtZXRob2QgRGVjbGFyYXRpb24iLCBBU1ROb2RlLkZJRUxEX0RFQ0xBUkFUSU9OLCBub2RlLmdl
dE5vZGVUeXBlKCkpOworCQlGaWVsZERlY2xhcmF0aW9uIGZpZWxkID0gKEZpZWxkRGVjbGFyYXRp
b24pIG5vZGU7CisJCWFzc2VydEVxdWFscygid3Jvbmcgbm8gb2YgdmFyaWFibGUgZnJhZ21lbnRz
IiwgMywgZmllbGQuZnJhZ21lbnRzKCkuc2l6ZSgpKTsKKwkJVmFyaWFibGVEZWNsYXJhdGlvbkZy
YWdtZW50IGZyYWdtZW50ID0gKFZhcmlhYmxlRGVjbGFyYXRpb25GcmFnbWVudCkgZmllbGQuZnJh
Z21lbnRzKCkuZ2V0KDApOworCQlMaXN0IGV4dHJhRGltZW5zaW9ucyA9IGZyYWdtZW50LmdldEV4
dHJhRGltZW5zaW9uVHlwZXMoKTsKKwkJYXNzZXJ0RXh0cmFEaW1lbnNpb25zRXF1YWwoIldyb25n
IGV4dHJhIGRpbWVuc2lvbiBpbmZvIiwgZXh0cmFEaW1lbnNpb25zLCAiQE1hcmtlcjIgW10gQE1h
cmtlcjMgW10gQE1hcmtlcjQgW10gIik7CisJCWZyYWdtZW50ID0gKFZhcmlhYmxlRGVjbGFyYXRp
b25GcmFnbWVudCkgZmllbGQuZnJhZ21lbnRzKCkuZ2V0KDEpOworCQlleHRyYURpbWVuc2lvbnMg
PSBmcmFnbWVudC5nZXRFeHRyYURpbWVuc2lvblR5cGVzKCk7CisJCWFzc2VydEV4dHJhRGltZW5z
aW9uc0VxdWFsKCJXcm9uZyBleHRyYSBkaW1lbnNpb24gaW5mbyIsIGV4dHJhRGltZW5zaW9ucywg
IkBNYXJrZXIyIEBNYXJrZXIzIFtdIEBNYXJrZXI0IFtdICIpOworCQlmcmFnbWVudCA9IChWYXJp
YWJsZURlY2xhcmF0aW9uRnJhZ21lbnQpIGZpZWxkLmZyYWdtZW50cygpLmdldCgyKTsKKwkJZXh0
cmFEaW1lbnNpb25zID0gZnJhZ21lbnQuZ2V0RXh0cmFEaW1lbnNpb25UeXBlcygpOworCQlhc3Nl
cnRFeHRyYURpbWVuc2lvbnNFcXVhbCgiV3JvbmcgZXh0cmEgZGltZW5zaW9uIGluZm8iLCBleHRy
YURpbWVuc2lvbnMsICJbXSBbXSBbXSAiKTsKKwl9Cit9ClwgTm8gbmV3bGluZSBhdCBlbmQgb2Yg
ZmlsZQpkaWZmIC0tZ2l0IGEvb3JnLmVjbGlwc2UuamR0LmNvcmUudGVzdHMubW9kZWwvc3JjL29y
Zy9lY2xpcHNlL2pkdC9jb3JlL3Rlc3RzL2RvbS9BU1RDb252ZXJ0ZXJBU1Q4VGVzdC5qYXZhIGIv
b3JnLmVjbGlwc2UuamR0LmNvcmUudGVzdHMubW9kZWwvc3JjL29yZy9lY2xpcHNlL2pkdC9jb3Jl
L3Rlc3RzL2RvbS9BU1RDb252ZXJ0ZXJBU1Q4VGVzdC5qYXZhCmluZGV4IGE3MjE0MGMuLjVjODAw
MDMgMTAwNjQ0Ci0tLSBhL29yZy5lY2xpcHNlLmpkdC5jb3JlLnRlc3RzLm1vZGVsL3NyYy9vcmcv
ZWNsaXBzZS9qZHQvY29yZS90ZXN0cy9kb20vQVNUQ29udmVydGVyQVNUOFRlc3QuamF2YQorKysg
Yi9vcmcuZWNsaXBzZS5qZHQuY29yZS50ZXN0cy5tb2RlbC9zcmMvb3JnL2VjbGlwc2UvamR0L2Nv
cmUvdGVzdHMvZG9tL0FTVENvbnZlcnRlckFTVDhUZXN0LmphdmEKQEAgLTM4LDQgKzM4LDUgQEAK
IAlzdGF0aWMgewogLy8JCVRFU1RTX05VTUJFUlMgPSBuZXcgaW50W10geyAzNTYgfTsKKy8vCQlU
RVNUU19OQU1FUyA9IG5ldyBTdHJpbmdbXXsgInRlc3QwMzkzIiB9OwogCX0KIAlwdWJsaWMgc3Rh
dGljIFRlc3Qgc3VpdGUoKSB7CkBAIC0xOTkzLDUgKzE5OTQsNSBAQAogCQlhc3NlcnRUcnVlKCJC
b3RoIEFTVCB0cmVlcyBzaG91bGQgYmUgaWRlbnRpY2FsIiwgdmFyaWFibGVEZWNsYXJhdGlvbi5z
dWJ0cmVlTWF0Y2gobmV3IEFTVE1hdGNoZXIoKSwgbm9kZSkpOwkJLy8kTk9OLU5MUy0xJAogCQlj
aGVja1NvdXJjZVJhbmdlKG5vZGUsICJmaW5hbCBTdHJpbmcgcyIsIHNvdXJjZSk7IC8vJE5PTi1O
TFMtMSQKLQkJYXNzZXJ0RXF1YWxzKCJXcm9uZyBkaW1lbnNpb24iLCAwLCBub2RlLmdldEV4dHJh
RGltZW5zaW9ucygpKTsgLy8kTk9OLU5MUy0xJAorCQlhc3NlcnRFcXVhbHMoIldyb25nIGRpbWVu
c2lvbiIsIDAsIG5vZGUuZ2V0RXh0cmFEaW1lbnNpb25UeXBlcygpLnNpemUoKSk7IC8vJE5PTi1O
TFMtMSQKIAl9CiAKQEAgLTI3MTksMTggKzI3MjAsMjEgQEAKIAkJbGl0ZXJhbC5zZXRUb2tlbigi
MTAiKTsvLyROT04tTkxTLTEkCiAJCWZyYWdtZW50LnNldEluaXRpYWxpemVyKGxpdGVyYWwpOwot
CQlmcmFnbWVudC5zZXRFeHRyYURpbWVuc2lvbnMoMCk7CisJCWZyYWdtZW50LmdldEV4dHJhRGlt
ZW5zaW9uVHlwZXMoKS5jbGVhcigpOwogCQlWYXJpYWJsZURlY2xhcmF0aW9uU3RhdGVtZW50IHN0
YXRlbWVudCA9IHRoaXMuYXN0Lm5ld1ZhcmlhYmxlRGVjbGFyYXRpb25TdGF0ZW1lbnQoZnJhZ21l
bnQpOwogCQlmcmFnbWVudCA9IHRoaXMuYXN0Lm5ld1ZhcmlhYmxlRGVjbGFyYXRpb25GcmFnbWVu
dCgpOwogCQlmcmFnbWVudC5zZXROYW1lKHRoaXMuYXN0Lm5ld1NpbXBsZU5hbWUoInoiKSk7Ly8k
Tk9OLU5MUy0xJAogCQlmcmFnbWVudC5zZXRJbml0aWFsaXplcih0aGlzLmFzdC5uZXdOdWxsTGl0
ZXJhbCgpKTsKLQkJZnJhZ21lbnQuc2V0RXh0cmFEaW1lbnNpb25zKDEpOworCQlmcmFnbWVudC5n
ZXRFeHRyYURpbWVuc2lvblR5cGVzKCkuY2xlYXIoKTsKKwkJZnJhZ21lbnQuZ2V0RXh0cmFEaW1l
bnNpb25UeXBlcygpLmFkZCh0aGlzLmFzdC5uZXdEaW1lbnNpb24obnVsbCkpOwogCQlzdGF0ZW1l
bnQuZnJhZ21lbnRzKCkuYWRkKGZyYWdtZW50KTsKIAkJZnJhZ21lbnQgPSB0aGlzLmFzdC5uZXdW
YXJpYWJsZURlY2xhcmF0aW9uRnJhZ21lbnQoKTsKIAkJZnJhZ21lbnQuc2V0TmFtZSh0aGlzLmFz
dC5uZXdTaW1wbGVOYW1lKCJpIikpOy8vJE5PTi1OTFMtMSQKLQkJZnJhZ21lbnQuc2V0RXh0cmFE
aW1lbnNpb25zKDApOworCQlmcmFnbWVudC5nZXRFeHRyYURpbWVuc2lvblR5cGVzKCkuY2xlYXIo
KTsKIAkJc3RhdGVtZW50LmZyYWdtZW50cygpLmFkZChmcmFnbWVudCk7CiAJCWZyYWdtZW50ID0g
dGhpcy5hc3QubmV3VmFyaWFibGVEZWNsYXJhdGlvbkZyYWdtZW50KCk7CiAJCWZyYWdtZW50LnNl
dE5hbWUodGhpcy5hc3QubmV3U2ltcGxlTmFtZSgiaiIpKTsvLyROT04tTkxTLTEkCi0JCWZyYWdt
ZW50LnNldEV4dHJhRGltZW5zaW9ucygyKTsKKwkJZnJhZ21lbnQuZ2V0RXh0cmFEaW1lbnNpb25U
eXBlcygpLmNsZWFyKCk7CisJCWZyYWdtZW50LmdldEV4dHJhRGltZW5zaW9uVHlwZXMoKS5hZGQo
dGhpcy5hc3QubmV3RGltZW5zaW9uKG51bGwpKTsKKwkJZnJhZ21lbnQuZ2V0RXh0cmFEaW1lbnNp
b25UeXBlcygpLmFkZCh0aGlzLmFzdC5uZXdEaW1lbnNpb24obnVsbCkpOwogCQlzdGF0ZW1lbnQu
ZnJhZ21lbnRzKCkuYWRkKGZyYWdtZW50KTsKIAkJc3RhdGVtZW50LnNldFR5cGUodGhpcy5hc3Qu
bmV3UHJpbWl0aXZlVHlwZShQcmltaXRpdmVUeXBlLklOVCkpOwpAQCAtMjc1OSwxOCArMjc2Mywy
MSBAQAogCQlsaXRlcmFsLnNldFRva2VuKCIxMCIpOy8vJE5PTi1OTFMtMSQKIAkJZnJhZ21lbnQu
c2V0SW5pdGlhbGl6ZXIobGl0ZXJhbCk7Ci0JCWZyYWdtZW50LnNldEV4dHJhRGltZW5zaW9ucygw
KTsKKwkJZnJhZ21lbnQuZ2V0RXh0cmFEaW1lbnNpb25UeXBlcygpLmNsZWFyKCk7CiAJCVZhcmlh
YmxlRGVjbGFyYXRpb25TdGF0ZW1lbnQgc3RhdGVtZW50ID0gdGhpcy5hc3QubmV3VmFyaWFibGVE
ZWNsYXJhdGlvblN0YXRlbWVudChmcmFnbWVudCk7CiAJCWZyYWdtZW50ID0gdGhpcy5hc3QubmV3
VmFyaWFibGVEZWNsYXJhdGlvbkZyYWdtZW50KCk7CiAJCWZyYWdtZW50LnNldE5hbWUodGhpcy5h
c3QubmV3U2ltcGxlTmFtZSgieiIpKTsvLyROT04tTkxTLTEkCiAJCWZyYWdtZW50LnNldEluaXRp
YWxpemVyKHRoaXMuYXN0Lm5ld051bGxMaXRlcmFsKCkpOwotCQlmcmFnbWVudC5zZXRFeHRyYURp
bWVuc2lvbnMoMSk7CisJCWZyYWdtZW50LmdldEV4dHJhRGltZW5zaW9uVHlwZXMoKS5jbGVhcigp
OworCQlmcmFnbWVudC5nZXRFeHRyYURpbWVuc2lvblR5cGVzKCkuYWRkKHRoaXMuYXN0Lm5ld0Rp
bWVuc2lvbihudWxsKSk7CiAJCXN0YXRlbWVudC5mcmFnbWVudHMoKS5hZGQoZnJhZ21lbnQpOwog
CQlmcmFnbWVudCA9IHRoaXMuYXN0Lm5ld1ZhcmlhYmxlRGVjbGFyYXRpb25GcmFnbWVudCgpOwog
CQlmcmFnbWVudC5zZXROYW1lKHRoaXMuYXN0Lm5ld1NpbXBsZU5hbWUoImkiKSk7Ly8kTk9OLU5M
Uy0xJAotCQlmcmFnbWVudC5zZXRFeHRyYURpbWVuc2lvbnMoMCk7CisJCWZyYWdtZW50LmdldEV4
dHJhRGltZW5zaW9uVHlwZXMoKS5jbGVhcigpOwogCQlzdGF0ZW1lbnQuZnJhZ21lbnRzKCkuYWRk
KGZyYWdtZW50KTsKIAkJZnJhZ21lbnQgPSB0aGlzLmFzdC5uZXdWYXJpYWJsZURlY2xhcmF0aW9u
RnJhZ21lbnQoKTsKIAkJZnJhZ21lbnQuc2V0TmFtZSh0aGlzLmFzdC5uZXdTaW1wbGVOYW1lKCJq
IikpOy8vJE5PTi1OTFMtMSQKLQkJZnJhZ21lbnQuc2V0RXh0cmFEaW1lbnNpb25zKDIpOworCQlm
cmFnbWVudC5nZXRFeHRyYURpbWVuc2lvblR5cGVzKCkuY2xlYXIoKTsKKwkJZnJhZ21lbnQuZ2V0
RXh0cmFEaW1lbnNpb25UeXBlcygpLmFkZCh0aGlzLmFzdC5uZXdEaW1lbnNpb24obnVsbCkpOwor
CQlmcmFnbWVudC5nZXRFeHRyYURpbWVuc2lvblR5cGVzKCkuYWRkKHRoaXMuYXN0Lm5ld0RpbWVu
c2lvbihudWxsKSk7CiAJCXN0YXRlbWVudC5mcmFnbWVudHMoKS5hZGQoZnJhZ21lbnQpOwogCQlz
dGF0ZW1lbnQuc2V0VHlwZSh0aGlzLmFzdC5uZXdBcnJheVR5cGUodGhpcy5hc3QubmV3UHJpbWl0
aXZlVHlwZShQcmltaXRpdmVUeXBlLklOVCksIDEpKTsKQEAgLTI3OTgsNSArMjgwNSw2IEBACiAJ
CXZhcmlhYmxlRGVjbGFyYXRpb25GcmFnbWVudC5zZXROYW1lKHRoaXMuYXN0Lm5ld1NpbXBsZU5h
bWUoInRhYiIpKTsgLy8kTk9OLU5MUy0xJAogCQl2YXJpYWJsZURlY2xhcmF0aW9uRnJhZ21lbnQu
c2V0SW5pdGlhbGl6ZXIodGhpcy5hc3QubmV3TnVsbExpdGVyYWwoKSk7Ly8kTk9OLU5MUy0xJAot
CQl2YXJpYWJsZURlY2xhcmF0aW9uRnJhZ21lbnQuc2V0RXh0cmFEaW1lbnNpb25zKDEpOworCQl2
YXJpYWJsZURlY2xhcmF0aW9uRnJhZ21lbnQuZ2V0RXh0cmFEaW1lbnNpb25UeXBlcygpLmNsZWFy
KCk7CisJCXZhcmlhYmxlRGVjbGFyYXRpb25GcmFnbWVudC5nZXRFeHRyYURpbWVuc2lvblR5cGVz
KCkuYWRkKHRoaXMuYXN0Lm5ld0RpbWVuc2lvbihudWxsKSk7CiAJCVZhcmlhYmxlRGVjbGFyYXRp
b25FeHByZXNzaW9uIHZhcmlhYmxlRGVjbGFyYXRpb25FeHByZXNzaW9uID0gdGhpcy5hc3QubmV3
VmFyaWFibGVEZWNsYXJhdGlvbkV4cHJlc3Npb24odmFyaWFibGVEZWNsYXJhdGlvbkZyYWdtZW50
KTsKIAkJdmFyaWFibGVEZWNsYXJhdGlvbkV4cHJlc3Npb24uc2V0VHlwZSh0aGlzLmFzdC5uZXdB
cnJheVR5cGUodGhpcy5hc3QubmV3U2ltcGxlVHlwZSh0aGlzLmFzdC5uZXdTaW1wbGVOYW1lKCJT
dHJpbmciKSksIDEpKTsvLyROT04tTkxTLTEkCkBAIC0yODI2LDUgKzI4MzQsNiBAQAogCQl2YXJp
YWJsZURlY2xhcmF0aW9uRnJhZ21lbnQuc2V0TmFtZSh0aGlzLmFzdC5uZXdTaW1wbGVOYW1lKCJ0
YWIiKSk7IC8vJE5PTi1OTFMtMSQKIAkJdmFyaWFibGVEZWNsYXJhdGlvbkZyYWdtZW50LnNldElu
aXRpYWxpemVyKHRoaXMuYXN0Lm5ld051bGxMaXRlcmFsKCkpOy8vJE5PTi1OTFMtMSQKLQkJdmFy
aWFibGVEZWNsYXJhdGlvbkZyYWdtZW50LnNldEV4dHJhRGltZW5zaW9ucygxKTsKKwkJdmFyaWFi
bGVEZWNsYXJhdGlvbkZyYWdtZW50LmdldEV4dHJhRGltZW5zaW9uVHlwZXMoKS5jbGVhcigpOwor
CQl2YXJpYWJsZURlY2xhcmF0aW9uRnJhZ21lbnQuZ2V0RXh0cmFEaW1lbnNpb25UeXBlcygpLmFk
ZCh0aGlzLmFzdC5uZXdEaW1lbnNpb24obnVsbCkpOwogCQlWYXJpYWJsZURlY2xhcmF0aW9uRXhw
cmVzc2lvbiB2YXJpYWJsZURlY2xhcmF0aW9uRXhwcmVzc2lvbiA9IHRoaXMuYXN0Lm5ld1Zhcmlh
YmxlRGVjbGFyYXRpb25FeHByZXNzaW9uKHZhcmlhYmxlRGVjbGFyYXRpb25GcmFnbWVudCk7CiAJ
CXZhcmlhYmxlRGVjbGFyYXRpb25FeHByZXNzaW9uLnNldFR5cGUodGhpcy5hc3QubmV3U2ltcGxl
VHlwZSh0aGlzLmFzdC5uZXdTaW1wbGVOYW1lKCJTdHJpbmciKSkpOy8vJE5PTi1OTFMtMSQKQEAg
LTI4NTQsNSArMjg2Myw2IEBACiAJCXZhcmlhYmxlRGVjbGFyYXRpb25GcmFnbWVudC5zZXROYW1l
KHRoaXMuYXN0Lm5ld1NpbXBsZU5hbWUoInRhYiIpKTsgLy8kTk9OLU5MUy0xJAogCQl2YXJpYWJs
ZURlY2xhcmF0aW9uRnJhZ21lbnQuc2V0SW5pdGlhbGl6ZXIodGhpcy5hc3QubmV3TnVsbExpdGVy
YWwoKSk7Ly8kTk9OLU5MUy0xJAotCQl2YXJpYWJsZURlY2xhcmF0aW9uRnJhZ21lbnQuc2V0RXh0
cmFEaW1lbnNpb25zKDEpOworCQl2YXJpYWJsZURlY2xhcmF0aW9uRnJhZ21lbnQuZ2V0RXh0cmFE
aW1lbnNpb25UeXBlcygpLmNsZWFyKCk7CisJCXZhcmlhYmxlRGVjbGFyYXRpb25GcmFnbWVudC5n
ZXRFeHRyYURpbWVuc2lvblR5cGVzKCkuYWRkKHRoaXMuYXN0Lm5ld0RpbWVuc2lvbihudWxsKSk7
CiAJCVZhcmlhYmxlRGVjbGFyYXRpb25FeHByZXNzaW9uIHZhcmlhYmxlRGVjbGFyYXRpb25FeHBy
ZXNzaW9uID0gdGhpcy5hc3QubmV3VmFyaWFibGVEZWNsYXJhdGlvbkV4cHJlc3Npb24odmFyaWFi
bGVEZWNsYXJhdGlvbkZyYWdtZW50KTsKIAkJdmFyaWFibGVEZWNsYXJhdGlvbkV4cHJlc3Npb24u
c2V0VHlwZSh0aGlzLmFzdC5uZXdTaW1wbGVUeXBlKHRoaXMuYXN0Lm5ld1NpbXBsZU5hbWUoIlN0
cmluZyIpKSk7Ly8kTk9OLU5MUy0xJApAQCAtMjg4Myw1ICsyODkzLDUgQEAKIAkJVmFyaWFibGVE
ZWNsYXJhdGlvbkZyYWdtZW50IGZyYWdtZW50ID0gdGhpcy5hc3QubmV3VmFyaWFibGVEZWNsYXJh
dGlvbkZyYWdtZW50KCk7CiAJCWZyYWdtZW50LnNldE5hbWUodGhpcy5hc3QubmV3U2ltcGxlTmFt
ZSgiaSIpKTsgLy8kTk9OLU5MUy0xJAotCQlmcmFnbWVudC5zZXRFeHRyYURpbWVuc2lvbnMoMCk7
CisJCWZyYWdtZW50LmdldEV4dHJhRGltZW5zaW9uVHlwZXMoKS5jbGVhcigpOwogCQlGaWVsZERl
Y2xhcmF0aW9uIGZpZWxkRGVjbGFyYXRpb24gPSB0aGlzLmFzdC5uZXdGaWVsZERlY2xhcmF0aW9u
KGZyYWdtZW50KTsKIAkJZmllbGREZWNsYXJhdGlvbi5zZXRUeXBlKHRoaXMuYXN0Lm5ld1ByaW1p
dGl2ZVR5cGUoUHJpbWl0aXZlVHlwZS5JTlQpKTsKQEAgLTI5MDUsNSArMjkxNSw1IEBACiAJCWxp
dGVyYWwuc2V0VG9rZW4oIjEwIik7IC8vJE5PTi1OTFMtMSQKIAkJZnJhZ21lbnQuc2V0SW5pdGlh
bGl6ZXIobGl0ZXJhbCk7Ci0JCWZyYWdtZW50LnNldEV4dHJhRGltZW5zaW9ucygwKTsKKwkJZnJh
Z21lbnQuZ2V0RXh0cmFEaW1lbnNpb25UeXBlcygpLmNsZWFyKCk7CiAJCUZpZWxkRGVjbGFyYXRp
b24gZmllbGREZWNsYXJhdGlvbiA9IHRoaXMuYXN0Lm5ld0ZpZWxkRGVjbGFyYXRpb24oZnJhZ21l
bnQpOwogCQlmaWVsZERlY2xhcmF0aW9uLm1vZGlmaWVycygpLmFkZCh0aGlzLmFzdC5uZXdNb2Rp
ZmllcihNb2RpZmllci5Nb2RpZmllcktleXdvcmQuUFVCTElDX0tFWVdPUkQpKTsKQEAgLTI5MTEs
MTQgKzI5MjEsMTcgQEAKIAkJZnJhZ21lbnQgPSB0aGlzLmFzdC5uZXdWYXJpYWJsZURlY2xhcmF0
aW9uRnJhZ21lbnQoKTsKIAkJZnJhZ21lbnQuc2V0TmFtZSh0aGlzLmFzdC5uZXdTaW1wbGVOYW1l
KCJ5IikpOy8vJE5PTi1OTFMtMSQKLQkJZnJhZ21lbnQuc2V0RXh0cmFEaW1lbnNpb25zKDEpOwor
CQlmcmFnbWVudC5nZXRFeHRyYURpbWVuc2lvblR5cGVzKCkuY2xlYXIoKTsKKwkJZnJhZ21lbnQu
Z2V0RXh0cmFEaW1lbnNpb25UeXBlcygpLmFkZCh0aGlzLmFzdC5uZXdEaW1lbnNpb24obnVsbCkp
OwogCQlmcmFnbWVudC5zZXRJbml0aWFsaXplcih0aGlzLmFzdC5uZXdOdWxsTGl0ZXJhbCgpKTsK
IAkJZmllbGREZWNsYXJhdGlvbi5mcmFnbWVudHMoKS5hZGQoZnJhZ21lbnQpOwogCQlmcmFnbWVu
dCA9IHRoaXMuYXN0Lm5ld1ZhcmlhYmxlRGVjbGFyYXRpb25GcmFnbWVudCgpOwogCQlmcmFnbWVu
dC5zZXROYW1lKHRoaXMuYXN0Lm5ld1NpbXBsZU5hbWUoImkiKSk7Ly8kTk9OLU5MUy0xJAotCQlm
cmFnbWVudC5zZXRFeHRyYURpbWVuc2lvbnMoMCk7CisJCWZyYWdtZW50LmdldEV4dHJhRGltZW5z
aW9uVHlwZXMoKS5jbGVhcigpOwogCQlmaWVsZERlY2xhcmF0aW9uLmZyYWdtZW50cygpLmFkZChm
cmFnbWVudCk7CiAJCWZyYWdtZW50ID0gdGhpcy5hc3QubmV3VmFyaWFibGVEZWNsYXJhdGlvbkZy
YWdtZW50KCk7CiAJCWZyYWdtZW50LnNldE5hbWUodGhpcy5hc3QubmV3U2ltcGxlTmFtZSgiaiIp
KTsvLyROT04tTkxTLTEkCi0JCWZyYWdtZW50LnNldEV4dHJhRGltZW5zaW9ucygyKTsKKwkJZnJh
Z21lbnQuZ2V0RXh0cmFEaW1lbnNpb25UeXBlcygpLmNsZWFyKCk7CisJCWZyYWdtZW50LmdldEV4
dHJhRGltZW5zaW9uVHlwZXMoKS5hZGQodGhpcy5hc3QubmV3RGltZW5zaW9uKG51bGwpKTsKKwkJ
ZnJhZ21lbnQuZ2V0RXh0cmFEaW1lbnNpb25UeXBlcygpLmFkZCh0aGlzLmFzdC5uZXdEaW1lbnNp
b24obnVsbCkpOwogCQlmaWVsZERlY2xhcmF0aW9uLmZyYWdtZW50cygpLmFkZChmcmFnbWVudCk7
CiAJCWFzc2VydFRydWUoIkJvdGggQVNUIHRyZWVzIHNob3VsZCBiZSBpZGVudGljYWwiLCBmaWVs
ZERlY2xhcmF0aW9uLnN1YnRyZWVNYXRjaChuZXcgQVNUTWF0Y2hlcigpLCBub2RlKSk7CQkvLyRO
T04tTkxTLTEkCkBAIC05NTg0LDQgKzk1OTcsNiBAQAogCQlhc3NlcnRFcXVhbHMoIldyb25nIHF1
YWxpZmllZCBuYW1lIiwgImphdmEubGFuZy5TdHJpbmdbXSIsIHR5cGVCaW5kaW5nMi5nZXRRdWFs
aWZpZWROYW1lKCkpOyAvLyROT04tTkxTLTEkIC8vJE5PTi1OTFMtMiQKIAkJYXNzZXJ0RXF1YWxz
KCJXcm9uZyBkaW1lbnNpb24iLCAxLCB0eXBlQmluZGluZzIuZ2V0RGltZW5zaW9ucygpKTsgLy8k
Tk9OLU5MUy0xJAorCQlMaXN0IGV4dHJhRGltZW5zaW9ucyA9IG1ldGhvZERlY2xhcmF0aW9uLmdl
dEV4dHJhQW5ub3RhdGVkRGltZW5zaW9ucygpOworCQlhc3NlcnRFeHRyYURpbWVuc2lvbnNFcXVh
bCgiV3JvbmcgZXh0cmEgZGltZW5zaW9uIGluZm8iLCBleHRyYURpbWVuc2lvbnMsICJbXSAiKTsK
IAl9CiAKQEAgLTk2NTYsNSArOTY3MSw1IEBACiAJCVR5cGUgdHlwZSA9IHNpbmdsZVZhcmlhYmxl
RGVjbGFyYXRpb24uZ2V0VHlwZSgpOwogCQljaGVja1NvdXJjZVJhbmdlKHR5cGUsICJTdHJpbmci
LCBzb3VyY2UpOyAvLyROT04tTkxTLTEkCi0JCWFzc2VydEVxdWFscygiV3JvbmcgZGltZW5zaW9u
IiwgMSwgc2luZ2xlVmFyaWFibGVEZWNsYXJhdGlvbi5nZXRFeHRyYURpbWVuc2lvbnMoKSk7IC8v
JE5PTi1OTFMtMSQKKwkJYXNzZXJ0RXF1YWxzKCJXcm9uZyBkaW1lbnNpb24iLCAxLCBzaW5nbGVW
YXJpYWJsZURlY2xhcmF0aW9uLmdldEV4dHJhRGltZW5zaW9uVHlwZXMoKS5zaXplKCkpOyAvLyRO
T04tTkxTLTEkCiAJCUlUeXBlQmluZGluZyB0eXBlQmluZGluZyA9IHR5cGUucmVzb2x2ZUJpbmRp
bmcoKTsKIAkJYXNzZXJ0Tm90TnVsbCgiTm8gdHlwZSBiaW5kaW5nIiwgdHlwZUJpbmRpbmcpOyAv
LyROT04tTkxTLTEkCkBAIC05NjcwLDQgKzk2ODUsNiBAQAogCQlhc3NlcnRFcXVhbHMoIldyb25n
IGRpbWVuc2lvbiIsIDEsIHR5cGVCaW5kaW5nMi5nZXREaW1lbnNpb25zKCkpOyAvLyROT04tTkxT
LTEkCiAJCWFzc2VydEVxdWFscygid3JvbmcgZnVsbHkgcXVhbGlmaWVkIG5hbWUiLCAiamF2YS5s
YW5nLlN0cmluZ1tdIiwgdHlwZUJpbmRpbmcyLmdldFF1YWxpZmllZE5hbWUoKSk7IC8vJE5PTi1O
TFMtMSQgLy8kTk9OLU5MUy0yJAorCQlMaXN0IGV4dHJhRGltZW5zaW9ucyA9IHNpbmdsZVZhcmlh
YmxlRGVjbGFyYXRpb24uZ2V0RXh0cmFEaW1lbnNpb25UeXBlcygpOworCQlhc3NlcnRFeHRyYURp
bWVuc2lvbnNFcXVhbCgiV3JvbmcgZXh0cmEgZGltZW5zaW9uIGluZm8iLCBleHRyYURpbWVuc2lv
bnMsICJbXSAiKTsKIAl9CiAKQEAgLTk2ODgsNSArOTcwNSw1IEBACiAJCVR5cGUgdHlwZSA9IHNp
bmdsZVZhcmlhYmxlRGVjbGFyYXRpb24uZ2V0VHlwZSgpOwogCQljaGVja1NvdXJjZVJhbmdlKHR5
cGUsICJTdHJpbmdbXSIsIHNvdXJjZSk7IC8vJE5PTi1OTFMtMSQKLQkJYXNzZXJ0RXF1YWxzKCJX
cm9uZyBkaW1lbnNpb24iLCAyLCBzaW5nbGVWYXJpYWJsZURlY2xhcmF0aW9uLmdldEV4dHJhRGlt
ZW5zaW9ucygpKTsgLy8kTk9OLU5MUy0xJAorCQlhc3NlcnRFcXVhbHMoIldyb25nIGRpbWVuc2lv
biIsIDIsIHNpbmdsZVZhcmlhYmxlRGVjbGFyYXRpb24uZ2V0RXh0cmFEaW1lbnNpb25UeXBlcygp
LnNpemUoKSk7IC8vJE5PTi1OTFMtMSQKIAkJSVR5cGVCaW5kaW5nIHR5cGVCaW5kaW5nID0gdHlw
ZS5yZXNvbHZlQmluZGluZygpOwogCQlhc3NlcnROb3ROdWxsKCJObyB0eXBlIGJpbmRpbmciLCB0
eXBlQmluZGluZyk7IC8vJE5PTi1OTFMtMSQKZGlmZiAtLWdpdCBhL29yZy5lY2xpcHNlLmpkdC5j
b3JlLnRlc3RzLm1vZGVsL3NyYy9vcmcvZWNsaXBzZS9qZHQvY29yZS90ZXN0cy9kb20vQVNUQ29u
dmVydGVyVGVzdEFTVDhfMi5qYXZhIGIvb3JnLmVjbGlwc2UuamR0LmNvcmUudGVzdHMubW9kZWwv
c3JjL29yZy9lY2xpcHNlL2pkdC9jb3JlL3Rlc3RzL2RvbS9BU1RDb252ZXJ0ZXJUZXN0QVNUOF8y
LmphdmEKaW5kZXggZWMyZmY3YS4uMmU4YWY2YyAxMDA2NDQKLS0tIGEvb3JnLmVjbGlwc2UuamR0
LmNvcmUudGVzdHMubW9kZWwvc3JjL29yZy9lY2xpcHNlL2pkdC9jb3JlL3Rlc3RzL2RvbS9BU1RD
b252ZXJ0ZXJUZXN0QVNUOF8yLmphdmEKKysrIGIvb3JnLmVjbGlwc2UuamR0LmNvcmUudGVzdHMu
bW9kZWwvc3JjL29yZy9lY2xpcHNlL2pkdC9jb3JlL3Rlc3RzL2RvbS9BU1RDb252ZXJ0ZXJUZXN0
QVNUOF8yLmphdmEKQEAgLTI3NzUsNSArMjc3NSw1IEBACiAJCWFzc2VydEVxdWFscygid3Jvbmcg
c2l6ZSIsIDEsIGZyYWdtZW50cy5zaXplKCkpOwogCQlWYXJpYWJsZURlY2xhcmF0aW9uRnJhZ21l
bnQgZnJhZ21lbnQgPSAoVmFyaWFibGVEZWNsYXJhdGlvbkZyYWdtZW50KSBmcmFnbWVudHMuZ2V0
KDApOwotCQlhc3NlcnRFcXVhbHMoIndyb25nIGV4dHJhIGRpbWVuc2lvbiIsIDEsIGZyYWdtZW50
LmdldEV4dHJhRGltZW5zaW9ucygpKTsKKwkJYXNzZXJ0RXF1YWxzKCJ3cm9uZyBleHRyYSBkaW1l
bnNpb24iLCAxLCBmcmFnbWVudC5nZXRFeHRyYURpbWVuc2lvblR5cGVzKCkuc2l6ZSgpKTsKIAl9
CiAKZGlmZiAtLWdpdCBhL29yZy5lY2xpcHNlLmpkdC5jb3JlLnRlc3RzLm1vZGVsL3NyYy9vcmcv
ZWNsaXBzZS9qZHQvY29yZS90ZXN0cy9kb20vQ29udmVydGVyVGVzdFNldHVwLmphdmEgYi9vcmcu
ZWNsaXBzZS5qZHQuY29yZS50ZXN0cy5tb2RlbC9zcmMvb3JnL2VjbGlwc2UvamR0L2NvcmUvdGVz
dHMvZG9tL0NvbnZlcnRlclRlc3RTZXR1cC5qYXZhCmluZGV4IGNkYmM0YTAuLmJmM2I5NTMgMTAw
NjQ0Ci0tLSBhL29yZy5lY2xpcHNlLmpkdC5jb3JlLnRlc3RzLm1vZGVsL3NyYy9vcmcvZWNsaXBz
ZS9qZHQvY29yZS90ZXN0cy9kb20vQ29udmVydGVyVGVzdFNldHVwLmphdmEKKysrIGIvb3JnLmVj
bGlwc2UuamR0LmNvcmUudGVzdHMubW9kZWwvc3JjL29yZy9lY2xpcHNlL2pkdC9jb3JlL3Rlc3Rz
L2RvbS9Db252ZXJ0ZXJUZXN0U2V0dXAuamF2YQpAQCAtMTYsNCArMTYsNSBAQAogCiBpbXBvcnQg
amF2YS5pby5JT0V4Y2VwdGlvbjsKK2ltcG9ydCBqYXZhLnV0aWwuSXRlcmF0b3I7CiBpbXBvcnQg
amF2YS51dGlsLkxpc3Q7CiBpbXBvcnQgamF2YS51dGlsLk1hcDsKQEAgLTE0Miw0ICsxNDMsMjAg
QEAKIAl9CiAKKwlwcm90ZWN0ZWQgdm9pZCBhc3NlcnRFeHRyYURpbWVuc2lvbnNFcXVhbChTdHJp
bmcgbWVzc2FnZSwgTGlzdCBkaW1lbnNpb25zLCBTdHJpbmcgZXhwZWN0ZWQpIHsKKwkJU3RyaW5n
QnVmZmVyIGJ1ZmZlciA9IG5ldyBTdHJpbmdCdWZmZXIoKTsKKwkJSXRlcmF0b3IgaXRlciA9IGRp
bWVuc2lvbnMuaXRlcmF0b3IoKTsKKwkJd2hpbGUoaXRlci5oYXNOZXh0KCkpIHsKKwkJCURpbWVu
c2lvblR5cGUgZGltID0gKERpbWVuc2lvblR5cGUpIGl0ZXIubmV4dCgpOworCQkJSXRlcmF0b3Ig
YW5ub3RhdGlvbnMgPSBkaW0uYW5ub3RhdGlvbnMoKS5pdGVyYXRvcigpOworCQkJd2hpbGUgKGFu
bm90YXRpb25zLmhhc05leHQoKSkgeworCQkJCWJ1ZmZlci5hcHBlbmQoJ0AnKTsKKwkJCQlidWZm
ZXIuYXBwZW5kKCgoQW5ub3RhdGlvbikgYW5ub3RhdGlvbnMubmV4dCgpKS5nZXRUeXBlTmFtZSgp
LmdldEZ1bGx5UXVhbGlmaWVkTmFtZSgpKTsKKwkJCQlidWZmZXIuYXBwZW5kKCcgJyk7CisJCQl9
CisJCQlidWZmZXIuYXBwZW5kKCJbXSAiKTsKKwkJfQorCQlhc3NlcnRFcXVhbHMobWVzc2FnZSwg
ZXhwZWN0ZWQsIGJ1ZmZlci50b1N0cmluZygpKTsKKwl9CisKIAlwdWJsaWMgQVNUTm9kZSBydW5D
b252ZXJzaW9uKElDb21waWxhdGlvblVuaXQgdW5pdCwgYm9vbGVhbiByZXNvbHZlQmluZGluZ3Ms
CiAJCQlib29sZWFuIGJpbmRpbmdzUmVjb3ZlcnkpIHsKZGlmZiAtLWdpdCBhL29yZy5lY2xpcHNl
LmpkdC5jb3JlLnRlc3RzLm1vZGVsL3NyYy9vcmcvZWNsaXBzZS9qZHQvY29yZS90ZXN0cy9kb20v
UnVuQ29udmVydGVyVGVzdHMuamF2YSBiL29yZy5lY2xpcHNlLmpkdC5jb3JlLnRlc3RzLm1vZGVs
L3NyYy9vcmcvZWNsaXBzZS9qZHQvY29yZS90ZXN0cy9kb20vUnVuQ29udmVydGVyVGVzdHMuamF2
YQppbmRleCBlMGUxMWMxLi5mODk3NDQ1IDEwMDY0NAotLS0gYS9vcmcuZWNsaXBzZS5qZHQuY29y
ZS50ZXN0cy5tb2RlbC9zcmMvb3JnL2VjbGlwc2UvamR0L2NvcmUvdGVzdHMvZG9tL1J1bkNvbnZl
cnRlclRlc3RzLmphdmEKKysrIGIvb3JnLmVjbGlwc2UuamR0LmNvcmUudGVzdHMubW9kZWwvc3Jj
L29yZy9lY2xpcHNlL2pkdC9jb3JlL3Rlc3RzL2RvbS9SdW5Db252ZXJ0ZXJUZXN0cy5qYXZhCkBA
IC0zNCw0ICszNCw1IEBACiAJCUFTVENvbnZlcnRlcjE2VGVzdC5jbGFzcywKIAkJQVNUQ29udmVy
dGVyMTdUZXN0LmNsYXNzLAorCQlBU1RDb252ZXJ0ZXIxOFRlc3QuY2xhc3MsCiAJCUFTVENvbnZl
cnRlckFTVDNUZXN0LmNsYXNzLAogCQlBU1RDb252ZXJ0ZXJUZXN0QVNUM18yLmNsYXNzLApkaWZm
IC0tZ2l0IGEvb3JnLmVjbGlwc2UuamR0LmNvcmUvLnNldHRpbmdzLy5hcGlfZmlsdGVycyBiL29y
Zy5lY2xpcHNlLmpkdC5jb3JlLy5zZXR0aW5ncy8uYXBpX2ZpbHRlcnMKbmV3IGZpbGUgbW9kZSAx
MDA2NDQKaW5kZXggMDAwMDAwMC4uOGE4NWY1NwotLS0gL2Rldi9udWxsCisrKyBiL29yZy5lY2xp
cHNlLmpkdC5jb3JlLy5zZXR0aW5ncy8uYXBpX2ZpbHRlcnMKQEAgLTAsMCArMSwxMSBAQAorPD94
bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0iVVRGLTgiIHN0YW5kYWxvbmU9Im5vIj8+Cis8Y29t
cG9uZW50IGlkPSJvcmcuZWNsaXBzZS5qZHQuY29yZSIgdmVyc2lvbj0iMiI+CisgICAgPHJlc291
cmNlIHBhdGg9ImRvbS9vcmcvZWNsaXBzZS9qZHQvY29yZS9kb20vVmFyaWFibGVEZWNsYXJhdGlv
bi5qYXZhIiB0eXBlPSJvcmcuZWNsaXBzZS5qZHQuY29yZS5kb20uVmFyaWFibGVEZWNsYXJhdGlv
biI+CisgICAgICAgIDxmaWx0ZXIgaWQ9IjMzNjY5NTMzNyI+CisgICAgICAgICAgICA8bWVzc2Fn
ZV9hcmd1bWVudHM+CisgICAgICAgICAgICAgICAgPG1lc3NhZ2VfYXJndW1lbnQgdmFsdWU9Im9y
Zy5lY2xpcHNlLmpkdC5jb3JlLmRvbS5WYXJpYWJsZURlY2xhcmF0aW9uIi8+CisgICAgICAgICAg
ICAgICAgPG1lc3NhZ2VfYXJndW1lbnQgdmFsdWU9ImdldEV4dHJhRGltZW5zaW9uVHlwZXMoKSIv
PgorICAgICAgICAgICAgPC9tZXNzYWdlX2FyZ3VtZW50cz4KKyAgICAgICAgPC9maWx0ZXI+Cisg
ICAgPC9yZXNvdXJjZT4KKzwvY29tcG9uZW50PgpkaWZmIC0tZ2l0IGEvb3JnLmVjbGlwc2UuamR0
LmNvcmUvZG9tL29yZy9lY2xpcHNlL2pkdC9jb3JlL2RvbS9BU1QuamF2YSBiL29yZy5lY2xpcHNl
LmpkdC5jb3JlL2RvbS9vcmcvZWNsaXBzZS9qZHQvY29yZS9kb20vQVNULmphdmEKaW5kZXggMGQ1
YWVkNS4uZGM2NzQ1ZSAxMDA2NDQKLS0tIGEvb3JnLmVjbGlwc2UuamR0LmNvcmUvZG9tL29yZy9l
Y2xpcHNlL2pkdC9jb3JlL2RvbS9BU1QuamF2YQorKysgYi9vcmcuZWNsaXBzZS5qZHQuY29yZS9k
b20vb3JnL2VjbGlwc2UvamR0L2NvcmUvZG9tL0FTVC5qYXZhCkBAIC0xMTE1LDQgKzExMTUsMTYg
QEAKIAkJcmV0dXJuIHJlc3VsdDsKIAl9CisJCisJLyoqCisJICogQHNpbmNlIDMuOQorCSAqLwor
CXB1YmxpYyBEaW1lbnNpb25UeXBlIG5ld0RpbWVuc2lvbihBbm5vdGF0aW9uW10gYW5ub3RhdGlv
bnMpIHsKKwkJRGltZW5zaW9uVHlwZSByZXN1bHQgPSBuZXcgRGltZW5zaW9uVHlwZSh0aGlzKTsK
KwkJaW50IGxlbmd0aCA9IChhbm5vdGF0aW9ucyA9PSBudWxsKSA/IDAgOiBhbm5vdGF0aW9ucy5s
ZW5ndGg7CisJCWZvciAoaW50IGkgPSAwOyBpIDwgbGVuZ3RoOyBpKyspIHsKKwkJCXJlc3VsdC5h
bm5vdGF0aW9ucy5hZGQoYW5ub3RhdGlvbnNbaV0pOworCQl9CisJCXJldHVybiByZXN1bHQ7CisJ
fQogCiAJLyoqCmRpZmYgLS1naXQgYS9vcmcuZWNsaXBzZS5qZHQuY29yZS9kb20vb3JnL2VjbGlw
c2UvamR0L2NvcmUvZG9tL0FTVENvbnZlcnRlci5qYXZhIGIvb3JnLmVjbGlwc2UuamR0LmNvcmUv
ZG9tL29yZy9lY2xpcHNlL2pkdC9jb3JlL2RvbS9BU1RDb252ZXJ0ZXIuamF2YQppbmRleCAxYmJj
ODZhLi43NGMwYjljIDEwMDY0NAotLS0gYS9vcmcuZWNsaXBzZS5qZHQuY29yZS9kb20vb3JnL2Vj
bGlwc2UvamR0L2NvcmUvZG9tL0FTVENvbnZlcnRlci5qYXZhCisrKyBiL29yZy5lY2xpcHNlLmpk
dC5jb3JlL2RvbS9vcmcvZWNsaXBzZS9qZHQvY29yZS9kb20vQVNUQ29udmVydGVyLmphdmEKQEAg
LTQ5MSw0ICs0OTEsOCBAQAogCQkJCWludCBleHRyYURpbWVuc2lvbnMgPSByZXRyaWV2ZUV4dHJh
RGltZW5zaW9uKHJpZ2h0UGFyZW50aGVzaXNQb3NpdGlvbiwgbWV0aG9kLmJvZHlFbmQpOwogCQkJ
CW1ldGhvZERlY2wuc2V0RXh0cmFEaW1lbnNpb25zKGV4dHJhRGltZW5zaW9ucyk7CisJCQkJLy8g
VE9ETzogQW5ub3RhdGlvbnMgb24gZXh0cmEgZGltZW5zaW9ucyB0byBiZSByZW1vdmVkIChidWcg
MzkxODk1LCBjb21tZW50IDYKKwkJCQlpZiAodGhpcy5hc3QuYXBpTGV2ZWwgPj0gQVNULkpMUzgp
IHsKKwkJCQkJc2V0RXh0cmFBbm5vdGF0ZWREaW1lbnNpb25zKHJpZ2h0UGFyZW50aGVzaXNQb3Np
dGlvbiwgdGhpcy5zY2FubmVyLmN1cnJlbnRQb3NpdGlvbiwgIHR5cGVSZWZlcmVuY2UsIG1ldGhv
ZERlY2wuZXh0cmFBbm5vdGF0ZWREaW1lbnNpb25zLCBleHRyYURpbWVuc2lvbnMpOworCQkJCX0K
IAkJCQlzZXRUeXBlRm9yTWV0aG9kRGVjbGFyYXRpb24obWV0aG9kRGVjbCwgcmV0dXJuVHlwZSwg
ZXh0cmFEaW1lbnNpb25zKTsKIAkJCX0gZWxzZSB7CkBAIC03ODEsNSArNzg1LDkgQEAKIAkJZmlu
YWwgaW50IHR5cGVTb3VyY2VFbmQgPSBhcmd1bWVudC50eXBlLnNvdXJjZUVuZDsKIAkJZmluYWwg
aW50IGV4dHJhRGltZW5zaW9ucyA9IHJldHJpZXZlRXh0cmFEaW1lbnNpb24obmFtZUVuZCArIDEs
IHR5cGVTb3VyY2VFbmQpOwotCQl2YXJpYWJsZURlY2wuc2V0RXh0cmFEaW1lbnNpb25zKGV4dHJh
RGltZW5zaW9ucyk7CisJCWlmICh0aGlzLmFzdC5hcGlMZXZlbCA+PSBBU1QuSkxTOCkgeworCQkJ
c2V0RXh0cmFBbm5vdGF0ZWREaW1lbnNpb25zKG5hbWVFbmQgKyAxLCB0aGlzLnNjYW5uZXIuY3Vy
cmVudFBvc2l0aW9uLCAgYXJndW1lbnQudHlwZSwgdmFyaWFibGVEZWNsLmV4dHJhRGltZW5zaW9u
VHlwZXMsIGV4dHJhRGltZW5zaW9ucyk7CisJCX0gZWxzZSB7CisJCQl2YXJpYWJsZURlY2wuc2V0
RXh0cmFEaW1lbnNpb25zKGV4dHJhRGltZW5zaW9ucyk7CisJCX0KIAkJZmluYWwgYm9vbGVhbiBp
c1ZhckFyZ3MgPSBhcmd1bWVudC5pc1ZhckFyZ3MoKTsKIAkJaWYgKGlzVmFyQXJncyAmJiBleHRy
YURpbWVuc2lvbnMgPT0gMCkgewpAQCAtODAyLDQgKzgxMCw1IEBACiAJCQlzZXRUeXBlRm9yU2lu
Z2xlVmFyaWFibGVEZWNsYXJhdGlvbih2YXJpYWJsZURlY2wsIHR5cGUsIGV4dHJhRGltZW5zaW9u
cyk7CiAJCX0KKwkJCiAJCXZhcmlhYmxlRGVjbC5zZXRTb3VyY2VSYW5nZShhcmd1bWVudC5kZWNs
YXJhdGlvblNvdXJjZVN0YXJ0LCByaWdodEVuZCAtIGFyZ3VtZW50LmRlY2xhcmF0aW9uU291cmNl
U3RhcnQgKyAxKTsKIApAQCAtMjg4OCw1ICsyODk3LDYgQEAKIAkJZmllbGREZWNsYXJhdGlvbi5z
ZXRTb3VyY2VSYW5nZShmaWVsZERlY2wuZGVjbGFyYXRpb25Tb3VyY2VTdGFydCwgZmllbGREZWNs
LmRlY2xhcmF0aW9uRW5kIC0gZmllbGREZWNsLmRlY2xhcmF0aW9uU291cmNlU3RhcnQgKyAxKTsK
IAkJVHlwZSB0eXBlID0gY29udmVydFR5cGUoZmllbGREZWNsLnR5cGUpOwotCQlzZXRUeXBlRm9y
RmllbGQoZmllbGREZWNsYXJhdGlvbiwgdHlwZSwgdmFyaWFibGVEZWNsYXJhdGlvbkZyYWdtZW50
LmdldEV4dHJhRGltZW5zaW9ucygpKTsKKwkJc2V0VHlwZUZvckZpZWxkKGZpZWxkRGVjbGFyYXRp
b24sIHR5cGUsIAorCQkJCSh0aGlzLmFzdC5hcGlMZXZlbCA8IEFTVC5KTFM4KSA/IHZhcmlhYmxl
RGVjbGFyYXRpb25GcmFnbWVudC5nZXRFeHRyYURpbWVuc2lvbnMoKSA6IHZhcmlhYmxlRGVjbGFy
YXRpb25GcmFnbWVudC5nZXRFeHRyYURpbWVuc2lvblR5cGVzKCkuc2l6ZSgpKTsKIAkJc2V0TW9k
aWZpZXJzKGZpZWxkRGVjbGFyYXRpb24sIGZpZWxkRGVjbCk7CiAJCWNvbnZlcnQoZmllbGREZWNs
LmphdmFkb2MsIGZpZWxkRGVjbGFyYXRpb24pOwpAQCAtMjkxOSw1ICsyOTI5LDYgQEAKIAkJdmFy
aWFibGVEZWNsYXJhdGlvbkV4cHJlc3Npb24uc2V0U291cmNlUmFuZ2UobG9jYWxEZWNsYXJhdGlv
bi5kZWNsYXJhdGlvblNvdXJjZVN0YXJ0LCBsb2NhbERlY2xhcmF0aW9uLmRlY2xhcmF0aW9uU291
cmNlRW5kIC0gbG9jYWxEZWNsYXJhdGlvbi5kZWNsYXJhdGlvblNvdXJjZVN0YXJ0ICsgMSk7CiAJ
CVR5cGUgdHlwZSA9IGNvbnZlcnRUeXBlKGxvY2FsRGVjbGFyYXRpb24udHlwZSk7Ci0JCXNldFR5
cGVGb3JWYXJpYWJsZURlY2xhcmF0aW9uRXhwcmVzc2lvbih2YXJpYWJsZURlY2xhcmF0aW9uRXhw
cmVzc2lvbiwgdHlwZSwgdmFyaWFibGVEZWNsYXJhdGlvbkZyYWdtZW50LmdldEV4dHJhRGltZW5z
aW9ucygpKTsKKwkJc2V0VHlwZUZvclZhcmlhYmxlRGVjbGFyYXRpb25FeHByZXNzaW9uKHZhcmlh
YmxlRGVjbGFyYXRpb25FeHByZXNzaW9uLCB0eXBlLCAKKwkJCQkodGhpcy5hc3QuYXBpTGV2ZWwg
PCBBU1QuSkxTOCkgPyB2YXJpYWJsZURlY2xhcmF0aW9uRnJhZ21lbnQuZ2V0RXh0cmFEaW1lbnNp
b25zKCkgOiB2YXJpYWJsZURlY2xhcmF0aW9uRnJhZ21lbnQuZ2V0RXh0cmFEaW1lbnNpb25UeXBl
cygpLnNpemUoKSk7CiAJCWlmIChsb2NhbERlY2xhcmF0aW9uLm1vZGlmaWVyc1NvdXJjZVN0YXJ0
ICE9IC0xKSB7CiAJCQlzZXRNb2RpZmllcnModmFyaWFibGVEZWNsYXJhdGlvbkV4cHJlc3Npb24s
IGxvY2FsRGVjbGFyYXRpb24pOwpAQCAtMjkzNiw1ICsyOTQ3LDkgQEAKIAkJdmFyaWFibGVEZWNs
LnNldE5hbWUobmFtZSk7CiAJCWZpbmFsIGludCBleHRyYURpbWVuc2lvbnMgPSByZXRyaWV2ZUV4
dHJhRGltZW5zaW9uKG5hbWVFbmQgKyAxLCBsb2NhbERlY2xhcmF0aW9uLnR5cGUuc291cmNlRW5k
KTsKLQkJdmFyaWFibGVEZWNsLnNldEV4dHJhRGltZW5zaW9ucyhleHRyYURpbWVuc2lvbnMpOwor
CQlpZiAodGhpcy5hc3QuYXBpTGV2ZWwgPj0gQVNULkpMUzgpIHsKKwkJCXNldEV4dHJhQW5ub3Rh
dGVkRGltZW5zaW9ucyhuYW1lRW5kICsgMSwgdGhpcy5zY2FubmVyLmN1cnJlbnRQb3NpdGlvbiwg
IGxvY2FsRGVjbGFyYXRpb24udHlwZSwgdmFyaWFibGVEZWNsLmV4dHJhRGltZW5zaW9uVHlwZXMs
IGV4dHJhRGltZW5zaW9ucyk7CisJCX0gZWxzZSB7CisJCQl2YXJpYWJsZURlY2wuc2V0RXh0cmFE
aW1lbnNpb25zKGV4dHJhRGltZW5zaW9ucyk7CisJCX0KIAkJVHlwZSB0eXBlID0gY29udmVydFR5
cGUobG9jYWxEZWNsYXJhdGlvbi50eXBlKTsKIAkJaW50IHR5cGVFbmQgPSB0eXBlLmdldFN0YXJ0
UG9zaXRpb24oKSArIHR5cGUuZ2V0TGVuZ3RoKCkgLSAxOwpAQCAtMjk0NSw0ICsyOTYwLDUgQEAK
IAkJICovCiAJCXNldFR5cGVGb3JTaW5nbGVWYXJpYWJsZURlY2xhcmF0aW9uKHZhcmlhYmxlRGVj
bCwgdHlwZSwgZXh0cmFEaW1lbnNpb25zKTsKKwogCQl2YXJpYWJsZURlY2wuc2V0U291cmNlUmFu
Z2UobG9jYWxEZWNsYXJhdGlvbi5kZWNsYXJhdGlvblNvdXJjZVN0YXJ0LCByaWdodEVuZCAtIGxv
Y2FsRGVjbGFyYXRpb24uZGVjbGFyYXRpb25Tb3VyY2VTdGFydCArIDEpOwogCQlpZiAodGhpcy5y
ZXNvbHZlQmluZGluZ3MpIHsKQEAgLTI5NTIsNCArMjk2OCwxNSBAQAogCQl9CiAJCXJldHVybiB2
YXJpYWJsZURlY2w7CisJfQorCisJcHJpdmF0ZSBEaW1lbnNpb25UeXBlIGNvbnZlcnRUb0RpbWVu
c2lvbihpbnQgc3RhcnQsIGludCBlbmQsIG9yZy5lY2xpcHNlLmpkdC5pbnRlcm5hbC5jb21waWxl
ci5hc3QuQW5ub3RhdGlvbltdIGFubm90YXRpb24pIHsKKwkJaW50IGxlbmd0aCA9IGFubm90YXRp
b24gPT0gbnVsbCA/IDAgOiBhbm5vdGF0aW9uLmxlbmd0aDsKKwkJQW5ub3RhdGlvbltdIGFubm90
YXRpb25zID0gbmV3IEFubm90YXRpb25bbGVuZ3RoXTsKKwkJZm9yIChpbnQgaSA9IDA7IGkgPCBs
ZW5ndGg7IGkrKykgeworCQkJYW5ub3RhdGlvbnNbaV0gPSBjb252ZXJ0KGFubm90YXRpb25baV0p
OworCQl9CisJCURpbWVuc2lvblR5cGUgZGltZW5zaW9uID0gdGhpcy5hc3QubmV3RGltZW5zaW9u
KGFubm90YXRpb25zKTsKKwkJcmV0cmlldmVEaW1lbnNpb25BbmRTZXRQb3NpdGlvbnMoc3RhcnQs
IGVuZCwgZGltZW5zaW9uKTsKKwkJcmV0dXJuIGRpbWVuc2lvbjsKIAl9CiAKQEAgLTI5NjMsNSAr
Mjk5MCw5IEBACiAJCWludCBlbmQgPSBzdGFydDsKIAkJaW50IGV4dHJhRGltZW5zaW9ucyA9IHJl
dHJpZXZlRXh0cmFEaW1lbnNpb24oZmllbGREZWNsYXJhdGlvbi5zb3VyY2VFbmQgKyAxLCBmaWVs
ZERlY2xhcmF0aW9uLmRlY2xhcmF0aW9uU291cmNlRW5kICk7Ci0JCXZhcmlhYmxlRGVjbGFyYXRp
b25GcmFnbWVudC5zZXRFeHRyYURpbWVuc2lvbnMoZXh0cmFEaW1lbnNpb25zKTsKKwkJaWYgKHRo
aXMuYXN0LmFwaUxldmVsID49IEFTVC5KTFM4KSB7CisJCQlzZXRFeHRyYUFubm90YXRlZERpbWVu
c2lvbnMoZmllbGREZWNsYXJhdGlvbi5zb3VyY2VFbmQgKyAxLCB0aGlzLnNjYW5uZXIuY3VycmVu
dFBvc2l0aW9uLCBmaWVsZERlY2xhcmF0aW9uLnR5cGUsIHZhcmlhYmxlRGVjbGFyYXRpb25GcmFn
bWVudC5leHRyYURpbWVuc2lvblR5cGVzLCBleHRyYURpbWVuc2lvbnMpOworCQl9IGVsc2Ugewor
CQkJdmFyaWFibGVEZWNsYXJhdGlvbkZyYWdtZW50LnNldEV4dHJhRGltZW5zaW9ucyhleHRyYURp
bWVuc2lvbnMpOworCQl9CiAJCWlmIChmaWVsZERlY2xhcmF0aW9uLmluaXRpYWxpemF0aW9uICE9
IG51bGwpIHsKIAkJCWZpbmFsIEV4cHJlc3Npb24gZXhwcmVzc2lvbiA9IGNvbnZlcnQoZmllbGRE
ZWNsYXJhdGlvbi5pbml0aWFsaXphdGlvbik7CkBAIC0zMDAxLDUgKzMwMzIsMTAgQEAKIAkJb3Jn
LmVjbGlwc2UuamR0LmludGVybmFsLmNvbXBpbGVyLmFzdC5FeHByZXNzaW9uIGluaXRpYWxpemF0
aW9uID0gbG9jYWxEZWNsYXJhdGlvbi5pbml0aWFsaXphdGlvbjsKIAkJaW50IGV4dHJhRGltZW5z
aW9uID0gcmV0cmlldmVFeHRyYURpbWVuc2lvbihsb2NhbERlY2xhcmF0aW9uLnNvdXJjZUVuZCAr
IDEsIHRoaXMuY29tcGlsYXRpb25Vbml0U291cmNlTGVuZ3RoKTsKLQkJdmFyaWFibGVEZWNsYXJh
dGlvbkZyYWdtZW50LnNldEV4dHJhRGltZW5zaW9ucyhleHRyYURpbWVuc2lvbik7CisJCWlmICh0
aGlzLmFzdC5hcGlMZXZlbCA+PSBBU1QuSkxTOCkgeworCQkJc2V0RXh0cmFBbm5vdGF0ZWREaW1l
bnNpb25zKGxvY2FsRGVjbGFyYXRpb24uc291cmNlRW5kICsgMSwgdGhpcy5zY2FubmVyLmN1cnJl
bnRQb3NpdGlvbiwgbG9jYWxEZWNsYXJhdGlvbi50eXBlLCB2YXJpYWJsZURlY2xhcmF0aW9uRnJh
Z21lbnQuZXh0cmFEaW1lbnNpb25UeXBlcywgZXh0cmFEaW1lbnNpb24pOworCQl9IGVsc2Ugewor
CQkJdmFyaWFibGVEZWNsYXJhdGlvbkZyYWdtZW50LnNldEV4dHJhRGltZW5zaW9ucyhleHRyYURp
bWVuc2lvbik7CisJCX0KKwkJCiAJCWJvb2xlYW4gaGFzSW5pdGlhbGl6YXRpb24gPSBpbml0aWFs
aXphdGlvbiAhPSBudWxsOwogCQlpbnQgZW5kOwpAQCAtMzAzMiw0ICszMDY4LDE2IEBACiAJfQog
CisJcHJvdGVjdGVkIHZvaWQgc2V0RXh0cmFBbm5vdGF0ZWREaW1lbnNpb25zKGludCBzdGFydCwg
aW50IGVuZCwgVHlwZVJlZmVyZW5jZSB0eXBlLCBmaW5hbCBMaXN0IGV4dHJhQW5ub3RhdGVkRGlt
ZW5zaW9ucywgaW50IGV4dHJhRGltZW5zaW9uKSB7CisJCWlmIChleHRyYURpbWVuc2lvbiA+IDAp
IHsKKwkJCW9yZy5lY2xpcHNlLmpkdC5pbnRlcm5hbC5jb21waWxlci5hc3QuQW5ub3RhdGlvbltd
W10gYW5ub3RhdGlvbnNPbkRpbXMgPSB0eXBlLmdldEFubm90YXRpb25zT25EaW1lbnNpb25zKCk7
CisJCQlpbnQgbGVuZ3RoID0gKGFubm90YXRpb25zT25EaW1zID09IG51bGwpID8gMCA6IGFubm90
YXRpb25zT25EaW1zLmxlbmd0aDsKKwkJCWZvciAoaW50IGkgPSAobGVuZ3RoIC0gZXh0cmFEaW1l
bnNpb24pOyBpIDwgbGVuZ3RoOyBpKyspIHsKKwkJCQlEaW1lbnNpb25UeXBlIGRpbSA9IGNvbnZl
cnRUb0RpbWVuc2lvbihzdGFydCwgZW5kLCAoYW5ub3RhdGlvbnNPbkRpbXMgPT0gbnVsbCkgPyBu
dWxsIDogYW5ub3RhdGlvbnNPbkRpbXNbaV0pOworCQkJCWV4dHJhQW5ub3RhdGVkRGltZW5zaW9u
cy5hZGQoZGltKTsKKwkJCQlzdGFydCA9IGRpbS5nZXRTdGFydFBvc2l0aW9uKCkgKyBkaW0uZ2V0
TGVuZ3RoKCk7CisJCQl9CisJCX0KKwl9CisKIAlwcm90ZWN0ZWQgVmFyaWFibGVEZWNsYXJhdGlv
blN0YXRlbWVudCBjb252ZXJ0VG9WYXJpYWJsZURlY2xhcmF0aW9uU3RhdGVtZW50KG9yZy5lY2xp
cHNlLmpkdC5pbnRlcm5hbC5jb21waWxlci5hc3QuTG9jYWxEZWNsYXJhdGlvbiBsb2NhbERlY2xh
cmF0aW9uKSB7CiAJCWZpbmFsIFZhcmlhYmxlRGVjbGFyYXRpb25GcmFnbWVudCB2YXJpYWJsZURl
Y2xhcmF0aW9uRnJhZ21lbnQgPSBjb252ZXJ0VG9WYXJpYWJsZURlY2xhcmF0aW9uRnJhZ21lbnQo
bG9jYWxEZWNsYXJhdGlvbik7CkBAIC0zMDQxLDUgKzMwODksNiBAQAogCQl2YXJpYWJsZURlY2xh
cmF0aW9uU3RhdGVtZW50LnNldFNvdXJjZVJhbmdlKGxvY2FsRGVjbGFyYXRpb24uZGVjbGFyYXRp
b25Tb3VyY2VTdGFydCwgbG9jYWxEZWNsYXJhdGlvbi5kZWNsYXJhdGlvblNvdXJjZUVuZCAtIGxv
Y2FsRGVjbGFyYXRpb24uZGVjbGFyYXRpb25Tb3VyY2VTdGFydCArIDEpOwogCQlUeXBlIHR5cGUg
PSBjb252ZXJ0VHlwZShsb2NhbERlY2xhcmF0aW9uLnR5cGUpOwotCQlzZXRUeXBlRm9yVmFyaWFi
bGVEZWNsYXJhdGlvblN0YXRlbWVudCh2YXJpYWJsZURlY2xhcmF0aW9uU3RhdGVtZW50LCB0eXBl
LCB2YXJpYWJsZURlY2xhcmF0aW9uRnJhZ21lbnQuZ2V0RXh0cmFEaW1lbnNpb25zKCkpOworCQlz
ZXRUeXBlRm9yVmFyaWFibGVEZWNsYXJhdGlvblN0YXRlbWVudCh2YXJpYWJsZURlY2xhcmF0aW9u
U3RhdGVtZW50LCB0eXBlLCAKKwkJCQkodGhpcy5hc3QuYXBpTGV2ZWwgPCBBU1QuSkxTOCkgPyB2
YXJpYWJsZURlY2xhcmF0aW9uRnJhZ21lbnQuZ2V0RXh0cmFEaW1lbnNpb25zKCkgOiB2YXJpYWJs
ZURlY2xhcmF0aW9uRnJhZ21lbnQuZ2V0RXh0cmFEaW1lbnNpb25UeXBlcygpLnNpemUoKSk7CiAJ
CWlmIChsb2NhbERlY2xhcmF0aW9uLm1vZGlmaWVyc1NvdXJjZVN0YXJ0ICE9IC0xKSB7CiAJCQlz
ZXRNb2RpZmllcnModmFyaWFibGVEZWNsYXJhdGlvblN0YXRlbWVudCwgbG9jYWxEZWNsYXJhdGlv
bik7CkBAIC0zMTExLDUgKzMxNjAsNSBAQAogCQl9CiAJfQotCisJCiAJcHVibGljIFR5cGUgY29u
dmVydFR5cGUoVHlwZVJlZmVyZW5jZSB0eXBlUmVmZXJlbmNlKSB7CiAJCW9yZy5lY2xpcHNlLmpk
dC5pbnRlcm5hbC5jb21waWxlci5hc3QuQW5ub3RhdGlvbltdIGFubm90YXRpb25zOwpAQCAtNDI0
Miw0ICs0MjkxLDUgQEAKIAkJdHJ5IHsKIAkJCWludCB0b2tlbjsKKwkJCWJvb2xlYW4gaXNBbm5v
dGF0aW9uID0gZmFsc2U7CiAJCQl3aGlsZSAoKHRva2VuID0gdGhpcy5zY2FubmVyLmdldE5leHRU
b2tlbigpKSAhPSBUZXJtaW5hbFRva2Vucy5Ub2tlbk5hbWVFT0YpIHsKIAkJCQlzd2l0Y2godG9r
ZW4pIHsKQEAgLTQyNDgsNiArNDI5OCwxNyBAQAogCQkJCQljYXNlIFRlcm1pbmFsVG9rZW5zLlRv
a2VuTmFtZUNPTU1FTlRfSkFWQURPQzoKIAkJCQkJY2FzZSBUZXJtaW5hbFRva2Vucy5Ub2tlbk5h
bWVDT01NRU5UX0xJTkU6CisJCQkJCQlpc0Fubm90YXRpb24gPSBmYWxzZTsKKwkJCQkJCWJyZWFr
OworCQkJCQljYXNlIFRlcm1pbmFsVG9rZW5zLlRva2VuTmFtZUFUOgorCQkJCQkJaXNBbm5vdGF0
aW9uID0gdHJ1ZTsKKwkJCQkJCWJyZWFrOworCQkJCQljYXNlIFRlcm1pbmFsVG9rZW5zLlRva2Vu
TmFtZUlkZW50aWZpZXI6CisJCQkJCQlpZiAoIWlzQW5ub3RhdGlvbikgeworCQkJCQkJCXJldHVy
biBkaW1lbnNpb25zOworCQkJCQkJfQorCQkJCQkJaXNBbm5vdGF0aW9uID0gZmFsc2U7CiAJCQkJ
CQlicmVhazsKIAkJCQkJY2FzZSBUZXJtaW5hbFRva2Vucy5Ub2tlbk5hbWVSQlJBQ0tFVDovLzE2
NgorCQkJCQkJaXNBbm5vdGF0aW9uID0gZmFsc2U7CiAJCQkJCQlkaW1lbnNpb25zKys7CiAJCQkJ
CQlicmVhazsKQEAgLTQyNjIsNCArNDMyMywzMCBAQAogCX0KIAorCXByb3RlY3RlZCB2b2lkIHJl
dHJpZXZlRGltZW5zaW9uQW5kU2V0UG9zaXRpb25zKGludCBzdGFydCwgaW50IGVuZCwgRGltZW5z
aW9uVHlwZSBkaW0pIHsKKwkJdGhpcy5zY2FubmVyLnJlc2V0VG8oc3RhcnQsIGVuZCk7CisJCWlu
dCB0b2tlbjsKKwkJYm9vbGVhbiBzdGFydFNldCA9IGZhbHNlOworCQl0cnkgeworCQkJd2hpbGUo
KHRva2VuID0gdGhpcy5zY2FubmVyLmdldE5leHRUb2tlbigpKSAhPSBUZXJtaW5hbFRva2Vucy5U
b2tlbk5hbWVFT0YpICB7CisJCQkJc3dpdGNoKHRva2VuKSB7CisJCQkJCWNhc2UgVGVybWluYWxU
b2tlbnMuVG9rZW5OYW1lV0hJVEVTUEFDRToKKwkJCQkJCWJyZWFrOworCQkJCQljYXNlIFRlcm1p
bmFsVG9rZW5zLlRva2VuTmFtZVJCUkFDS0VUOgorCQkJCQkJaW50IGVuZERpbSA9IHRoaXMuc2Nh
bm5lci5jdXJyZW50UG9zaXRpb24gLSAxOworCQkJCQkJZGltLnNldFNvdXJjZVJhbmdlKHN0YXJ0
LCBlbmREaW0gLSBzdGFydCArIDEpOworCQkJCQkJcmV0dXJuOworCQkJCQlkZWZhdWx0OgorCQkJ
CQkJaWYgKCFzdGFydFNldCkgeworCQkJCQkJCXN0YXJ0ID0gdGhpcy5zY2FubmVyLnN0YXJ0UG9z
aXRpb247CisJCQkJCQkJc3RhcnRTZXQgPSB0cnVlOworCQkJCQkJfQorCQkJCQkJYnJlYWs7CisJ
CQkJCQkKKwkJCQl9CisJCQl9CisJCX0gY2F0Y2goSW52YWxpZElucHV0RXhjZXB0aW9uIGUpIHsK
KwkJCS8vIGlnbm9yZQorCQl9CisJfQogCXByb3RlY3RlZCB2b2lkIHJldHJpZXZlSWRlbnRpZmll
ckFuZFNldFBvc2l0aW9ucyhpbnQgc3RhcnQsIGludCBlbmQsIE5hbWUgbmFtZSkgewogCQl0aGlz
LnNjYW5uZXIucmVzZXRUbyhzdGFydCwgZW5kKTsKQEAgLTUxNjUsNCArNTI1Miw1IEBACiAJCQlp
ZiAodHlwZS5pc0FycmF5VHlwZSgpKSB7CiAJCQkJQXJyYXlUeXBlIGFycmF5VHlwZSA9IChBcnJh
eVR5cGUpIHR5cGU7CisJCQkJCiAJCQkJaW50IHJlbWFpbmluZ0RpbWVuc2lvbnMgPSBhcnJheVR5
cGUuZ2V0RGltZW5zaW9ucygpIC0gZXh0cmFEaW1lbnNpb247CiAJCQkJaWYgKHJlbWFpbmluZ0Rp
bWVuc2lvbnMgPT0gMCkgIHsKQEAgLTUxOTksNSArNTI4Nyw1IEBACiAJCQkJCQlkZWZhdWx0IDoK
IAkJCQkJCQltZXRob2REZWNsYXJhdGlvbi5zZXRSZXR1cm5UeXBlMihzdWJhcnJheVR5cGUpOwot
CQkJCQkJYnJlYWs7CisJCQkJCQkJYnJlYWs7CiAJCQkJCX0KIAkJCQkJdGhpcy5hc3QuZ2V0Qmlu
ZGluZ1Jlc29sdmVyKCkudXBkYXRlS2V5KHR5cGUsIHN1YmFycmF5VHlwZSk7CmRpZmYgLS1naXQg
YS9vcmcuZWNsaXBzZS5qZHQuY29yZS9kb20vb3JnL2VjbGlwc2UvamR0L2NvcmUvZG9tL0FTVE1h
dGNoZXIuamF2YSBiL29yZy5lY2xpcHNlLmpkdC5jb3JlL2RvbS9vcmcvZWNsaXBzZS9qZHQvY29y
ZS9kb20vQVNUTWF0Y2hlci5qYXZhCmluZGV4IDY0MTg2YmIuLmZkNjRmMjEgMTAwNjQ0Ci0tLSBh
L29yZy5lY2xpcHNlLmpkdC5jb3JlL2RvbS9vcmcvZWNsaXBzZS9qZHQvY29yZS9kb20vQVNUTWF0
Y2hlci5qYXZhCisrKyBiL29yZy5lY2xpcHNlLmpkdC5jb3JlL2RvbS9vcmcvZWNsaXBzZS9qZHQv
Y29yZS9kb20vQVNUTWF0Y2hlci5qYXZhCkBAIC0zNDMsNCArMzQzLDI3IEBACiAKIAkvKioKKwkg
KiBAc2luY2UgMy45CisJICovCisJcHVibGljIGJvb2xlYW4gbWF0Y2goQW5ub3RhdGlvbltdIGZp
cnN0LCBBbm5vdGF0aW9uW10gc2Vjb25kKSB7CisJCWlmIChmaXJzdC5sZW5ndGggIT0gc2Vjb25k
Lmxlbmd0aCkKKwkJCXJldHVybiBmYWxzZTsKKwkJZm9yIChpbnQgaSA9IDA7IGkgPCBmaXJzdC5s
ZW5ndGg7IGkrKykgeworCQkJaWYgKCFzYWZlRXF1YWxzKGZpcnN0W2ldLCBzZWNvbmRbaV0pKQor
CQkJCXJldHVybiBmYWxzZTsKKwkJfQorCQlyZXR1cm4gdHJ1ZTsKKwl9CisKKwkvKioKKwkgKiBA
c2luY2UgMy45CisJICovCisJcHVibGljIGJvb2xlYW4gbWF0Y2goRGltZW5zaW9uVHlwZSBub2Rl
LCBPYmplY3Qgb3RoZXIpIHsKKwkJaWYgKCEob3RoZXIgaW5zdGFuY2VvZiBEaW1lbnNpb25UeXBl
KSkKKwkJCXJldHVybiBmYWxzZTsKKwkJRGltZW5zaW9uVHlwZSBvID0gKERpbWVuc2lvblR5cGUp
IG90aGVyOworCQlyZXR1cm4gc2FmZVN1YnRyZWVMaXN0TWF0Y2gobm9kZS5hbm5vdGF0aW9ucygp
LCBvLmFubm90YXRpb25zKCkpOworCX0KKworCS8qKgogCSAqIFJldHVybnMgd2hldGhlciB0aGUg
Z2l2ZW4gbm9kZSBhbmQgdGhlIG90aGVyIG9iamVjdCBtYXRjaC4KIAkgKiA8cD4KQEAgLTEzOTIs
NSArMTQxNSw1IEBACiAJCQkJLy8gbi5iLiBjb21wYXJlIHJldHVybiB0eXBlIGV2ZW4gZm9yIGNv
bnN0cnVjdG9ycwogCQkJCSYmIHNhZmVTdWJ0cmVlTGlzdE1hdGNoKG5vZGUucGFyYW1ldGVycygp
LCBvLnBhcmFtZXRlcnMoKSkKLQkgCQkJJiYgbm9kZS5nZXRFeHRyYURpbWVuc2lvbnMoKSA9PSBv
LmdldEV4dHJhRGltZW5zaW9ucygpCisJCQkJJiYgKChub2RlLmdldEFTVCgpLmFwaUxldmVsIDwg
QVNULkpMUzgpID8gKG5vZGUuZ2V0RXh0cmFEaW1lbnNpb25zKCkgPT0gby5nZXRFeHRyYURpbWVu
c2lvbnMoKSkgOiBzYWZlU3VidHJlZUxpc3RNYXRjaChub2RlLmdldEV4dHJhQW5ub3RhdGVkRGlt
ZW5zaW9ucygpLCBvLmdldEV4dHJhQW5ub3RhdGVkRGltZW5zaW9ucygpKSkJCQkJCiAJCQkJJiYg
c2FmZVN1YnRyZWVMaXN0TWF0Y2gobm9kZS50aHJvd25FeGNlcHRpb25zKCksIG8udGhyb3duRXhj
ZXB0aW9ucygpKQogCQkJCSYmIHNhZmVTdWJ0cmVlTWF0Y2gobm9kZS5nZXRCb2R5KCksIG8uZ2V0
Qm9keSgpKSk7CkBAIC0xODg1LDYgKzE5MDgsNiBAQAogCQkgICAgc2FmZVN1YnRyZWVNYXRjaChu
b2RlLmdldFR5cGUoKSwgby5nZXRUeXBlKCkpCiAJCQkJJiYgc2FmZVN1YnRyZWVNYXRjaChub2Rl
LmdldE5hbWUoKSwgby5nZXROYW1lKCkpCi0JIAkJCSYmIG5vZGUuZ2V0RXh0cmFEaW1lbnNpb25z
KCkgPT0gby5nZXRFeHRyYURpbWVuc2lvbnMoKQotCQkJCSYmIHNhZmVTdWJ0cmVlTWF0Y2gobm9k
ZS5nZXRJbml0aWFsaXplcigpLCBvLmdldEluaXRpYWxpemVyKCkpOworCQkJJiYgKChub2RlLmdl
dEFTVCgpLmFwaUxldmVsIDwgQVNULkpMUzgpID8gKG5vZGUuZ2V0RXh0cmFEaW1lbnNpb25zKCkg
PT0gby5nZXRFeHRyYURpbWVuc2lvbnMoKSkgOiBzYWZlU3VidHJlZUxpc3RNYXRjaChub2RlLmdl
dEV4dHJhRGltZW5zaW9uVHlwZXMoKSwgby5nZXRFeHRyYURpbWVuc2lvblR5cGVzKCkpKQorCQkJ
JiYgc2FmZVN1YnRyZWVNYXRjaChub2RlLmdldEluaXRpYWxpemVyKCksIG8uZ2V0SW5pdGlhbGl6
ZXIoKSk7CiAJfQogCkBAIC0yMzc3LDUgKzI0MDAsNSBAQAogCQlWYXJpYWJsZURlY2xhcmF0aW9u
RnJhZ21lbnQgbyA9IChWYXJpYWJsZURlY2xhcmF0aW9uRnJhZ21lbnQpIG90aGVyOwogCQlyZXR1
cm4gc2FmZVN1YnRyZWVNYXRjaChub2RlLmdldE5hbWUoKSwgby5nZXROYW1lKCkpCi0JCQkmJiBu
b2RlLmdldEV4dHJhRGltZW5zaW9ucygpID09IG8uZ2V0RXh0cmFEaW1lbnNpb25zKCkKKwkJCSYm
ICgobm9kZS5nZXRBU1QoKS5hcGlMZXZlbCA8IEFTVC5KTFM4KSA/IChub2RlLmdldEV4dHJhRGlt
ZW5zaW9ucygpID09IG8uZ2V0RXh0cmFEaW1lbnNpb25zKCkpIDogc2FmZVN1YnRyZWVMaXN0TWF0
Y2gobm9kZS5nZXRFeHRyYURpbWVuc2lvblR5cGVzKCksIG8uZ2V0RXh0cmFEaW1lbnNpb25UeXBl
cygpKSkKIAkJCSYmIHNhZmVTdWJ0cmVlTWF0Y2gobm9kZS5nZXRJbml0aWFsaXplcigpLCBvLmdl
dEluaXRpYWxpemVyKCkpOwogCX0KZGlmZiAtLWdpdCBhL29yZy5lY2xpcHNlLmpkdC5jb3JlL2Rv
bS9vcmcvZWNsaXBzZS9qZHQvY29yZS9kb20vQVNUTm9kZS5qYXZhIGIvb3JnLmVjbGlwc2UuamR0
LmNvcmUvZG9tL29yZy9lY2xpcHNlL2pkdC9jb3JlL2RvbS9BU1ROb2RlLmphdmEKaW5kZXggNjdh
NjQxYS4uYjA3MjA5OSAxMDA2NDQKLS0tIGEvb3JnLmVjbGlwc2UuamR0LmNvcmUvZG9tL29yZy9l
Y2xpcHNlL2pkdC9jb3JlL2RvbS9BU1ROb2RlLmphdmEKKysrIGIvb3JnLmVjbGlwc2UuamR0LmNv
cmUvZG9tL29yZy9lY2xpcHNlL2pkdC9jb3JlL2RvbS9BU1ROb2RlLmphdmEKQEAgLTc3Miw0ICs3
NzIsMTMgQEAKIAkgKi8KIAlwdWJsaWMgc3RhdGljIGZpbmFsIGludCBVTklPTl9UWVBFID0gODQ7
CisJCisJLyoqCisJICogTm9kZSB0eXBlIGNvbnN0YW50IGluZGljYXRpbmcgYSBub2RlIG9mIHR5
cGUKKwkgKiA8Y29kZT5EaW1lbnNpb248L2NvZGU+LgorCSAqIAorCSAqIEBzZWUgRGltZW5zaW9u
VHlwZQorCSAqIEBzaW5jZSAzLjkKKwkgKi8KKwlwdWJsaWMgc3RhdGljIGZpbmFsIGludCBESU1F
TlNJT04gPSA4NTsKIAogCS8qKgpAQCAtMTg0MSw0ICsxODUwLDIwIEBACiAJICB9CiAJfQorCQor
CS8qKgorICAgICAqIENoZWNrcyB0aGF0IHRoaXMgQVNUIG9wZXJhdGlvbiBpcyBvbmx5IHVzZWQg
d2hlbgorICAgICAqIGJ1aWxkaW5nIEpMUzMgb3IgZWFybGllciBsZXZlbCBBU1RzLgorICAgICAq
IDxwPgorICAgICAqIFVzZSB0aGlzIG1ldGhvZCB0byBwcmV2ZW50IGFjY2VzcyB0byBkZXByZWNh
dGVkIHByb3BlcnRpZXMgKGRlcHJlY2F0ZWQgaW4gSkxTOCkuCisgICAgICogPC9wPgorICAgICAq
IAorICAgICAqIEBleGNlcHRpb24gVW5zdXBwb3J0ZWRPcGVyYXRpb25FeGNlcHRpb24KKwkgKiBA
c2luY2UgMy45CisgICAgICovCisJZmluYWwgdm9pZCBzdXBwb3J0ZWRPbmx5SW4yXzNfNCgpIHsK
KwkJICBpZiAodGhpcy5hc3QuYXBpTGV2ZWwgPj0gQVNULkpMUzgpIHsKKwkJCSAgCXRocm93IG5l
dyBVbnN1cHBvcnRlZE9wZXJhdGlvbkV4Y2VwdGlvbigiT3BlcmF0aW9uIG9ubHkgc3VwcG9ydGVk
IGluIEpMUzggQVNUIik7IC8vJE5PTi1OTFMtMSQKKwkJICB9CisJfQogCiAJLyoqCmRpZmYgLS1n
aXQgYS9vcmcuZWNsaXBzZS5qZHQuY29yZS9kb20vb3JnL2VjbGlwc2UvamR0L2NvcmUvZG9tL0FT
VFZpc2l0b3IuamF2YSBiL29yZy5lY2xpcHNlLmpkdC5jb3JlL2RvbS9vcmcvZWNsaXBzZS9qZHQv
Y29yZS9kb20vQVNUVmlzaXRvci5qYXZhCmluZGV4IGIyOTMwNTMuLjlmMDdhMjkgMTAwNjQ0Ci0t
LSBhL29yZy5lY2xpcHNlLmpkdC5jb3JlL2RvbS9vcmcvZWNsaXBzZS9qZHQvY29yZS9kb20vQVNU
VmlzaXRvci5qYXZhCisrKyBiL29yZy5lY2xpcHNlLmpkdC5jb3JlL2RvbS9vcmcvZWNsaXBzZS9q
ZHQvY29yZS9kb20vQVNUVmlzaXRvci5qYXZhCkBAIC0yMDAsNCArMjAwLDEwIEBACiAJfQogCisJ
LyoqCisJICogQHNpbmNlIDMuOQorCSAqLworCXB1YmxpYyBib29sZWFuIHZpc2l0KERpbWVuc2lv
blR5cGUgbm9kZSkgeworCQlyZXR1cm4gdHJ1ZTsKKwl9CiAKIAkvKioKQEAgLTE1OTMsNCArMTU5
OSwxMSBAQAogCQkvLyBkZWZhdWx0IGltcGxlbWVudGF0aW9uOiBkbyBub3RoaW5nCiAJfQorCQor
CS8qKgorCSAqIEBzaW5jZSAzLjkKKwkgKi8KKwlwdWJsaWMgdm9pZCBlbmRWaXNpdChEaW1lbnNp
b25UeXBlIG5vZGUpIHsKKwkJLy8gZG8gbm90aGluZyBieSBkZWZhdWx0CisJfQogCiAJLyoqCmRp
ZmYgLS1naXQgYS9vcmcuZWNsaXBzZS5qZHQuY29yZS9kb20vb3JnL2VjbGlwc2UvamR0L2NvcmUv
ZG9tL0RpbWVuc2lvblR5cGUuamF2YSBiL29yZy5lY2xpcHNlLmpkdC5jb3JlL2RvbS9vcmcvZWNs
aXBzZS9qZHQvY29yZS9kb20vRGltZW5zaW9uVHlwZS5qYXZhCm5ldyBmaWxlIG1vZGUgMTAwNjQ0
CmluZGV4IDAwMDAwMDAuLmIwYmJjZDIKLS0tIC9kZXYvbnVsbAorKysgYi9vcmcuZWNsaXBzZS5q
ZHQuY29yZS9kb20vb3JnL2VjbGlwc2UvamR0L2NvcmUvZG9tL0RpbWVuc2lvblR5cGUuamF2YQpA
QCAtMCwwICsxLDE5NyBAQAorLyoqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioq
KioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioKKyAqIENvcHlyaWdodCAo
YykgMjAwMCwgMjAxMyBJQk0gQ29ycG9yYXRpb24gYW5kIG90aGVycy4KKyAqIEFsbCByaWdodHMg
cmVzZXJ2ZWQuIFRoaXMgcHJvZ3JhbSBhbmQgdGhlIGFjY29tcGFueWluZyBtYXRlcmlhbHMKKyAq
IGFyZSBtYWRlIGF2YWlsYWJsZSB1bmRlciB0aGUgdGVybXMgb2YgdGhlIEVjbGlwc2UgUHVibGlj
IExpY2Vuc2UgdjEuMAorICogd2hpY2ggYWNjb21wYW5pZXMgdGhpcyBkaXN0cmlidXRpb24sIGFu
ZCBpcyBhdmFpbGFibGUgYXQKKyAqIGh0dHA6Ly93d3cuZWNsaXBzZS5vcmcvbGVnYWwvZXBsLXYx
MC5odG1sCisgKgorICogVGhpcyBpcyBhbiBpbXBsZW1lbnRhdGlvbiBvZiBhbiBlYXJseS1kcmFm
dCBzcGVjaWZpY2F0aW9uIGRldmVsb3BlZCB1bmRlciB0aGUgSmF2YQorICogQ29tbXVuaXR5IFBy
b2Nlc3MgKEpDUCkgYW5kIGlzIG1hZGUgYXZhaWxhYmxlIGZvciB0ZXN0aW5nIGFuZCBldmFsdWF0
aW9uIHB1cnBvc2VzCisgKiBvbmx5LiBUaGUgY29kZSBpcyBub3QgY29tcGF0aWJsZSB3aXRoIGFu
eSBzcGVjaWZpY2F0aW9uIG9mIHRoZSBKQ1AuCisgKiAKKyAqIENvbnRyaWJ1dG9yczoKKyAqICAg
ICBJQk0gQ29ycG9yYXRpb24gLSBpbml0aWFsIEFQSSBhbmQgaW1wbGVtZW50YXRpb24KKyAqKioq
KioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioq
KioqKioqKioqKioqKioqKioqLworcGFja2FnZSBvcmcuZWNsaXBzZS5qZHQuY29yZS5kb207CisK
K2ltcG9ydCBqYXZhLnV0aWwuQXJyYXlMaXN0OworaW1wb3J0IGphdmEudXRpbC5MaXN0OworCisv
KioKKyAqIFRoZSBhcnJheSBkaW1lbnNpb24gdHlwZSBub2RlLiBUaGUgYXJyYXkgZGltZW5zaW9u
LCByZXByZXNlbnRlZCBhcyA8Yj5bXTwvYj4sIG1heSBub3QgbWF5IG5vdCAKKyAqIGluY2x1ZGUg
YW4gPGNvZGU+RXhwcmVzc2lvbjwvY29kZT4gZGVwZW5kaW5nIG9uIHdoZXJlIGl0IGFwcGVhcnMu
IFRoZSBvbmx5IAorICogbm9kZSB0aGF0IHN1cHBvcnRzIGEgZGltZW5zaW9uIHR5cGUgd2l0aCBh
biBleHByZXNzaW9uIGlzIDxjb2RlPkFycmF5Q3JlYXRpb248L2NvZGU+LgorICogVGhpcyBub2Rl
IHR5cGUgaXMgc3VwcG9ydGVkIG9ubHkgaW4gSkxTOCBvciBsYXRlci4KKyAqIAorICogRm9yIEpM
Uzg6CisgKiA8cHJlPgorICogRGltZW5zaW9uVHlwZToKKyAqIAk8Yj5bPC9iPiB7RXhwcmVzc2lv
bn0gPGI+XTwvYj4gCisgKiA8L3ByZT4KKyAqIAorICogQHNpbmNlIDMuOQorICovCitwdWJsaWMg
Y2xhc3MgRGltZW5zaW9uVHlwZSBleHRlbmRzIEFubm90YXRhYmxlVHlwZSB7CisKKwkKKwkvKioK
KwkgKiBUaGUgImFubm90YXRpb25zIiBzdHJ1Y3R1cmFsIHByb3BlcnR5IG9mIHRoaXMgbm9kZSB0
eXBlIChjaGlsZCB0eXBlOiB7QGxpbmsgQW5ub3RhdGlvbn0pLgorCSAqIEBzaW5jZSAzLjkKKwkg
Ki8KKwlwdWJsaWMgc3RhdGljIGZpbmFsIENoaWxkTGlzdFByb3BlcnR5RGVzY3JpcHRvciBBTk5P
VEFUSU9OU19QUk9QRVJUWSA9CisJCW5ldyBDaGlsZExpc3RQcm9wZXJ0eURlc2NyaXB0b3IoRGlt
ZW5zaW9uVHlwZS5jbGFzcywgImFubm90YXRpb25zIiwgQW5ub3RhdGlvbi5jbGFzcywgTk9fQ1lD
TEVfUklTSyk7IC8vJE5PTi1OTFMtMSQKKwkKKworCS8qKgorCSAqIFRoZSAiZGltZW5zaW9ucyIg
c3RydWN0dXJhbCBwcm9wZXJ0eSBvZiB0aGlzIG5vZGUgdHlwZSAoZWxlbWVudCB0eXBlOiB7QGxp
bmsgRXhwcmVzc2lvbn0pLgorCSAqIEBzaW5jZSAzLjkKKwkgKi8KKwlwdWJsaWMgc3RhdGljIGZp
bmFsIENoaWxkUHJvcGVydHlEZXNjcmlwdG9yIEVYUFJFU1NJT05fUFJPUEVSVFkgPQorCQkJbmV3
IENoaWxkUHJvcGVydHlEZXNjcmlwdG9yKERpbWVuc2lvblR5cGUuY2xhc3MsICJleHByZXNzaW9u
IiwgRXhwcmVzc2lvbi5jbGFzcywgTUFOREFUT1JZLCBDWUNMRV9SSVNLKTsgLy8kTk9OLU5MUy0x
JAorCQorCQorCS8qKgorCSAqIEEgbGlzdCBvZiBwcm9wZXJ0eSBkZXNjcmlwdG9ycyAoZWxlbWVu
dCB0eXBlOgorCSAqIHtAbGluayBTdHJ1Y3R1cmFsUHJvcGVydHlEZXNjcmlwdG9yfSksCisJICog
b3IgbnVsbCBpZiB1bmluaXRpYWxpemVkLgorCSAqIEBzaW5jZSAzLjkKKwkgKi8KKwlwcml2YXRl
IHN0YXRpYyBmaW5hbCBMaXN0IFBST1BFUlRZX0RFU0NSSVBUT1JTXzhfMDsKKwkKKwlzdGF0aWMg
eworCQlMaXN0IHByb3BlcnR5TGlzdCA9IG5ldyBBcnJheUxpc3QoMyk7CisJCWNyZWF0ZVByb3Bl
cnR5TGlzdChEaW1lbnNpb25UeXBlLmNsYXNzLCBwcm9wZXJ0eUxpc3QpOworCQlhZGRQcm9wZXJ0
eShBTk5PVEFUSU9OU19QUk9QRVJUWSwgcHJvcGVydHlMaXN0KTsKKwkJYWRkUHJvcGVydHkoRVhQ
UkVTU0lPTl9QUk9QRVJUWSwgcHJvcGVydHlMaXN0KTsKKwkJUFJPUEVSVFlfREVTQ1JJUFRPUlNf
OF8wID0gcmVhcFByb3BlcnR5TGlzdChwcm9wZXJ0eUxpc3QpOworCX0KKwkKKwkvKioKKwkgKiBS
ZXR1cm5zIGEgbGlzdCBvZiBzdHJ1Y3R1cmFsIHByb3BlcnR5IGRlc2NyaXB0b3JzIGZvciB0aGlz
IG5vZGUgdHlwZS4KKwkgKiBDbGllbnRzIG11c3Qgbm90IG1vZGlmeSB0aGUgcmVzdWx0LgorCSAq
CisJICogQHBhcmFtIGFwaUxldmVsIHRoZSBBUEkgbGV2ZWw7IG9uZSBvZiB0aGUKKwkgKiA8Y29k
ZT5BU1QuSkxTKjwvY29kZT4gY29uc3RhbnRzCisJICogQHJldHVybiBhIGxpc3Qgb2YgcHJvcGVy
dHkgZGVzY3JpcHRvcnMgKGVsZW1lbnQgdHlwZToKKwkgKiB7QGxpbmsgU3RydWN0dXJhbFByb3Bl
cnR5RGVzY3JpcHRvcn0pCisJICogQHNpbmNlIDMuOQorCSAqLworCXB1YmxpYyBzdGF0aWMgTGlz
dCBwcm9wZXJ0eURlc2NyaXB0b3JzKGludCBhcGlMZXZlbCkgeworCQlyZXR1cm4gUFJPUEVSVFlf
REVTQ1JJUFRPUlNfOF8wOworCX0KKwkKKwlwdWJsaWMgRGltZW5zaW9uVHlwZShBU1QgYXN0KSB7
CisJCXN1cGVyKGFzdCk7CisJCXVuc3VwcG9ydGVkSW4yXzNfNCgpOworCQl0aGlzLmFubm90YXRp
b25zID0gbmV3IEFTVE5vZGUuTm9kZUxpc3QoQU5OT1RBVElPTlNfUFJPUEVSVFkpOworCX0KKwkK
KwkvKioKKwkgKiBUaGUgbGlzdCBvZiBkaW1lbnNpb24gZXhwcmVzc2lvbnMgKGVsZW1lbnQgdHlw
ZToKKwkgKiB7QGxpbmsgRXhwcmVzc2lvbn0pLiBEZWZhdWx0cyB0byBhbiBlbXB0eSBsaXN0Lgor
CSAqLworCXByaXZhdGUgRXhwcmVzc2lvbiBleHByZXNzaW9uID0gbnVsbDsKKwkKKwkvKioKKwkg
KiBTZXRzIHRoZSBhcnJheSB0eXBlIGluIHRoaXMgYXJyYXkgY3JlYXRpb24gZXhwcmVzc2lvbi4K
KwkgKgorCSAqIEBwYXJhbSBleHByZXNzaW9uIHRoZSBuZXcgYXJyYXkgdHlwZQorCSAqIEBleGNl
cHRpb24gSWxsZWdhbEFyZ3VtZW50RXhjZXB0aW9uIGlmOgorCSAqIDx1bD4KKwkgKiA8bGk+dGhl
IG5vZGUgYmVsb25ncyB0byBhIGRpZmZlcmVudCBBU1Q8L2xpPgorCSAqIDxsaT50aGUgbm9kZSBh
bHJlYWR5IGhhcyBhIHBhcmVudDwvbGk+CisJICogPC91bD4KKwkgKiAKKwkgKiBAc2luY2UgMy45
CisJICovCisJcHVibGljIHZvaWQgc2V0RXhwcmVzc2lvbihFeHByZXNzaW9uIGV4cHJlc3Npb24p
IHsKKwkJLy8gYW4gQXJyYXlDcmVhdGlvbiBjYW5ub3Qgb2NjdXIgaW5zaWRlIGEgQXJyYXlUeXBl
IC0gY3ljbGVzIG5vdCBwb3NzaWJsZQorCQlBU1ROb2RlIG9sZENoaWxkID0gdGhpcy5leHByZXNz
aW9uOworCQlwcmVSZXBsYWNlQ2hpbGQob2xkQ2hpbGQsIGV4cHJlc3Npb24sIEVYUFJFU1NJT05f
UFJPUEVSVFkpOworCQl0aGlzLmV4cHJlc3Npb24gPSBleHByZXNzaW9uOworCQlwb3N0UmVwbGFj
ZUNoaWxkKG9sZENoaWxkLCBleHByZXNzaW9uLCBFWFBSRVNTSU9OX1BST1BFUlRZKTsKKwl9CisJ
CisJLyoqCisJICogUmV0dXJucyB0aGUgZXhwcmVzc2lvbiBpbiB0aGUgZGltZW5zaW9uIHR5cGUu
CisJICoKKwkgKiBAcmV0dXJuIHRoZSBleHByZXNzaW9uCisJICogQHNpbmNlIDMuOQorCSAqLwor
CXB1YmxpYyBFeHByZXNzaW9uIGV4cHJlc3Npb24oKSB7CisJCXJldHVybiB0aGlzLmV4cHJlc3Np
b247CisJfQorCQorCUxpc3QgaW50ZXJuYWxTdHJ1Y3R1cmFsUHJvcGVydGllc0ZvclR5cGUoaW50
IGFwaUxldmVsKSB7CisJCXJldHVybiBwcm9wZXJ0eURlc2NyaXB0b3JzKGFwaUxldmVsKTsKKwl9
CisKKwkvKiAob21pdCBqYXZhZG9jIGZvciB0aGlzIG1ldGhvZCkKKwkgKiBNZXRob2QgZGVjbGFy
ZWQgb24gQVNUTm9kZS4KKwkgKi8KKwlmaW5hbCBBU1ROb2RlIGludGVybmFsR2V0U2V0Q2hpbGRQ
cm9wZXJ0eShDaGlsZFByb3BlcnR5RGVzY3JpcHRvciBwcm9wZXJ0eSwgYm9vbGVhbiBnZXQsIEFT
VE5vZGUgY2hpbGQpIHsKKwkJaWYgKHByb3BlcnR5ID09IEVYUFJFU1NJT05fUFJPUEVSVFkpIHsK
KwkJCWlmIChnZXQpIHsKKwkJCQlyZXR1cm4gZXhwcmVzc2lvbigpOworCQkJfSBlbHNlIHsKKwkJ
CQlzZXRFeHByZXNzaW9uKChFeHByZXNzaW9uKSBjaGlsZCk7CisJCQkJcmV0dXJuIG51bGw7CisJ
CQl9CisJCX0KKwkJLy8gYWxsb3cgZGVmYXVsdCBpbXBsZW1lbnRhdGlvbiB0byBmbGFnIHRoZSBl
cnJvcgorCQlyZXR1cm4gc3VwZXIuaW50ZXJuYWxHZXRTZXRDaGlsZFByb3BlcnR5KHByb3BlcnR5
LCBnZXQsIGNoaWxkKTsKKwl9CisKKwkvKiAob21pdCBqYXZhZG9jIGZvciB0aGlzIG1ldGhvZCkK
KwkgKiBNZXRob2QgZGVjbGFyZWQgb24gQVNUTm9kZS4KKwkgKi8KKwlmaW5hbCBMaXN0IGludGVy
bmFsR2V0Q2hpbGRMaXN0UHJvcGVydHkoQ2hpbGRMaXN0UHJvcGVydHlEZXNjcmlwdG9yIHByb3Bl
cnR5KSB7CisJCWlmIChwcm9wZXJ0eSA9PSBBTk5PVEFUSU9OU19QUk9QRVJUWSkgeworCQkJcmV0
dXJuIGFubm90YXRpb25zKCk7CisJCX0KKwkJLy8gYWxsb3cgZGVmYXVsdCBpbXBsZW1lbnRhdGlv
biB0byBmbGFnIHRoZSBlcnJvcgorCQlyZXR1cm4gc3VwZXIuaW50ZXJuYWxHZXRDaGlsZExpc3RQ
cm9wZXJ0eShwcm9wZXJ0eSk7CisJfQorCisJaW50IGdldE5vZGVUeXBlMCgpIHsKKwkJcmV0dXJu
IERJTUVOU0lPTjsKKwl9CisKKwlib29sZWFuIHN1YnRyZWVNYXRjaDAoQVNUTWF0Y2hlciBtYXRj
aGVyLCBPYmplY3Qgb3RoZXIpIHsKKwkJcmV0dXJuIG1hdGNoZXIubWF0Y2godGhpcywgb3RoZXIp
OworCX0KKworCUFTVE5vZGUgY2xvbmUwKEFTVCB0YXJnZXQpIHsKKwkJRGltZW5zaW9uVHlwZSBy
ZXN1bHQgPSBuZXcgRGltZW5zaW9uVHlwZSh0YXJnZXQpOworCQlyZXN1bHQuYW5ub3RhdGlvbnMu
YWRkQWxsKAorCQkJCUFTVE5vZGUuY29weVN1YnRyZWVzKHRhcmdldCwgYW5ub3RhdGlvbnMoKSkp
OworCQlpZiAodGhpcy5leHByZXNzaW9uICE9IG51bGwpIHsKKwkJCXJlc3VsdC5zZXRFeHByZXNz
aW9uKChFeHByZXNzaW9uKWV4cHJlc3Npb24oKS5jbG9uZSh0YXJnZXQpKTsKKwkJfQorCQlyZXR1
cm4gcmVzdWx0OworCX0KKworCXZvaWQgYWNjZXB0MChBU1RWaXNpdG9yIHZpc2l0b3IpIHsKKwkJ
Ym9vbGVhbiB2aXNpdENoaWxkcmVuID0gdmlzaXRvci52aXNpdCh0aGlzKTsKKwkJaWYgKHZpc2l0
Q2hpbGRyZW4pIHsKKwkJCWFjY2VwdENoaWxkcmVuKHZpc2l0b3IsIHRoaXMuYW5ub3RhdGlvbnMp
OworCQkJaWYgKHRoaXMuZXhwcmVzc2lvbiAhPSBudWxsKSB7CisJCQkJYWNjZXB0Q2hpbGQodmlz
aXRvciwgdGhpcy5leHByZXNzaW9uKTsKKwkJCX0KKwkJfQorCQl2aXNpdG9yLmVuZFZpc2l0KHRo
aXMpOworCisJfQorCisJaW50IHRyZWVTaXplKCkgeworCQlpbnQgc2l6ZSA9IG1lbVNpemUoKQor
CQkJCSsgdGhpcy5hbm5vdGF0aW9ucy5saXN0U2l6ZSgpCisJCQkJKyAodGhpcy5leHByZXNzaW9u
ID09IG51bGwgPyAwIDogdGhpcy5leHByZXNzaW9uLnRyZWVTaXplKCkpOworCQkJcmV0dXJuIHNp
emU7CisJfQorCisJaW50IG1lbVNpemUoKSB7CisJCXJldHVybiBCQVNFX05PREVfU0laRSArIDIg
KiA0OworCX0KKworfQpkaWZmIC0tZ2l0IGEvb3JnLmVjbGlwc2UuamR0LmNvcmUvZG9tL29yZy9l
Y2xpcHNlL2pkdC9jb3JlL2RvbS9NZXRob2REZWNsYXJhdGlvbi5qYXZhIGIvb3JnLmVjbGlwc2Uu
amR0LmNvcmUvZG9tL29yZy9lY2xpcHNlL2pkdC9jb3JlL2RvbS9NZXRob2REZWNsYXJhdGlvbi5q
YXZhCmluZGV4IGJmOGQ5OTcuLmZjZmMwNTAgMTAwNjQ0Ci0tLSBhL29yZy5lY2xpcHNlLmpkdC5j
b3JlL2RvbS9vcmcvZWNsaXBzZS9qZHQvY29yZS9kb20vTWV0aG9kRGVjbGFyYXRpb24uamF2YQor
KysgYi9vcmcuZWNsaXBzZS5qZHQuY29yZS9kb20vb3JnL2VjbGlwc2UvamR0L2NvcmUvZG9tL01l
dGhvZERlY2xhcmF0aW9uLmphdmEKQEAgLTEyNSw0ICsxMjUsMTEgQEAKIAogCS8qKgorCSAqIFRo
ZSAiZXh0cmFBbm5vdGF0ZWREaW1lbnNpb25zIiBzdHJ1Y3R1cmFsIHByb3BlcnR5IG9mIHRoaXMg
bm9kZSB0eXBlIChjaGlsZCB0eXBlOiB7QGxpbmsgRGltZW5zaW9uVHlwZX0pLgorCSAqIEBzaW5j
ZSAzLjkKKwkgKi8KKwlwdWJsaWMgc3RhdGljIGZpbmFsIENoaWxkTGlzdFByb3BlcnR5RGVzY3Jp
cHRvciBFWFRSQV9BTk5PVEFURURfRElNRU5TSU9OU19QUk9QRVJUWSA9CisJCQluZXcgQ2hpbGRM
aXN0UHJvcGVydHlEZXNjcmlwdG9yKE1ldGhvZERlY2xhcmF0aW9uLmNsYXNzLCAiZXh0cmFBbm5v
dGF0ZWREaW1lbnNpb25zIiwgRGltZW5zaW9uVHlwZS5jbGFzcywgTk9fQ1lDTEVfUklTSyk7IC8v
JE5PTi1OTFMtMSQKKworCS8qKgogCSAqIFRoZSAidHlwZVBhcmFtZXRlcnMiIHN0cnVjdHVyYWwg
cHJvcGVydHkgb2YgdGhpcyBub2RlIHR5cGUgKGVsZW1lbnQgdHlwZToge0BsaW5rIFR5cGVQYXJh
bWV0ZXJ9KSAoYWRkZWQgaW4gSkxTMyBBUEkpLgogCSAqIEBzaW5jZSAzLjEKQEAgLTI2NSw0ICsy
NzIsMTEgQEAKIAogCS8qKgorCSAqIFRoZSBleHRyYSBkaW1lbnNpb24gdHlwZXMgdGhpcyBub2Rl
IGhhcyB3aXRoIGFubm90YXRpb25zIGlmIGFueS4KKwkgKiAKKwkgKiBAc2luY2UgMy45CisJICov
CisJcHJvdGVjdGVkIEFTVE5vZGUuTm9kZUxpc3QgZXh0cmFBbm5vdGF0ZWREaW1lbnNpb25zID0g
bnVsbDsKKworCS8qKgogCSAqIFRoZSBsaXN0IG9mIHRocm93biBleGNlcHRpb24gbmFtZXMgKGVs
ZW1lbnQgdHlwZToge0BsaW5rIE5hbWV9KS4KIAkgKiBEZWZhdWx0cyB0byBhbiBlbXB0eSBsaXN0
LgpAQCAtMjk2LDQgKzMxMCw3IEBACiAJCWlmIChhc3QuYXBpTGV2ZWwgPj0gQVNULkpMUzNfSU5U
RVJOQUwpIHsKIAkJCXRoaXMudHlwZVBhcmFtZXRlcnMgPSBuZXcgQVNUTm9kZS5Ob2RlTGlzdChU
WVBFX1BBUkFNRVRFUlNfUFJPUEVSVFkpOworCQl9IAorCQlpZiAoYXN0LmFwaUxldmVsID49IEFT
VC5KTFM4KSB7CisJCQl0aGlzLmV4dHJhQW5ub3RhdGVkRGltZW5zaW9ucyA9IG5ldyBBU1ROb2Rl
Lk5vZGVMaXN0KEVYVFJBX0FOTk9UQVRFRF9ESU1FTlNJT05TX1BST1BFUlRZKTsKIAkJfQogCX0K
QEAgLTQxMSw0ICs0MjgsNyBAQAogCQkJcmV0dXJuIHRocm93bkV4Y2VwdGlvbnMoKTsKIAkJfQor
CQlpZiAocHJvcGVydHkgPT0gRVhUUkFfQU5OT1RBVEVEX0RJTUVOU0lPTlNfUFJPUEVSVFkpIHsK
KwkJCXJldHVybiB0aGlzLmV4dHJhQW5ub3RhdGVkRGltZW5zaW9uczsKKwkJfQogCQkvLyBhbGxv
dyBkZWZhdWx0IGltcGxlbWVudGF0aW9uIHRvIGZsYWcgdGhlIGVycm9yCiAJCXJldHVybiBzdXBl
ci5pbnRlcm5hbEdldENoaWxkTGlzdFByb3BlcnR5KHByb3BlcnR5KTsKQEAgLTQ2NSw0ICs0ODUs
OSBAQAogCQlyZXN1bHQuc2V0Q29uc3RydWN0b3IoaXNDb25zdHJ1Y3RvcigpKTsKIAkJcmVzdWx0
LnNldEV4dHJhRGltZW5zaW9ucyhnZXRFeHRyYURpbWVuc2lvbnMoKSk7CisJCWlmICh0aGlzLmFz
dC5hcGlMZXZlbCA+PSBBU1QuSkxTOCkgeworCQkJcmVzdWx0LmV4dHJhQW5ub3RhdGVkRGltZW5z
aW9ucyA9IG5ldyBBU1ROb2RlLk5vZGVMaXN0KEVYVFJBX0FOTk9UQVRFRF9ESU1FTlNJT05TX1BS
T1BFUlRZKTsKKwkJCXJlc3VsdC5leHRyYUFubm90YXRlZERpbWVuc2lvbnMuYWRkQWxsKAorCQkJ
CQlBU1ROb2RlLmNvcHlTdWJ0cmVlcyh0YXJnZXQsIHRoaXMuZXh0cmFBbm5vdGF0ZWREaW1lbnNp
b25zKSk7CisJCX0KIAkJcmVzdWx0LnNldE5hbWUoKFNpbXBsZU5hbWUpIGdldE5hbWUoKS5jbG9u
ZSh0YXJnZXQpKTsKIAkJcmVzdWx0LnBhcmFtZXRlcnMoKS5hZGRBbGwoCkBAIC04MjksNCArODU0
LDE1IEBACiAKIAkvKioKKwkgKiBSZXR1cm5zIHRoZSBsaXZlIG9yZGVyZWQgbGlzdCBvZiBleHRy
YSBkaW1lbnNpb25zIHdpdGggYW5ub3RhdGlvbnMgaWYgYW55LgorCSAqIAorCSAqIEByZXR1cm4g
dGhlIGxpdmUgbGlzdCBvZiBleHRyYSBkaW1lbnNpb25zIHdpdGggYW5ub3RhdGlvbnMgaWYgYW55
IChlbGVtZW50IHR5cGU6IHtAbGluayBEaW1lbnNpb25UeXBlfVtdKQorCSAqIEBzaW5jZSAzLjkK
KwkgKi8KKwlwdWJsaWMgTGlzdCBnZXRFeHRyYUFubm90YXRlZERpbWVuc2lvbnMoKSB7CisJCXVu
c3VwcG9ydGVkSW4yXzNfNCgpOworCQlyZXR1cm4gdGhpcy5leHRyYUFubm90YXRlZERpbWVuc2lv
bnM7CisJfQorCisJLyoqCiAJICogUmV0dXJucyB0aGUgYm9keSBvZiB0aGlzIG1ldGhvZCBkZWNs
YXJhdGlvbiwgb3IgPGNvZGU+bnVsbDwvY29kZT4gaWYKIAkgKiB0aGlzIG1ldGhvZCBoYXMgPGI+
bm88L2I+IGJvZHkuCmRpZmYgLS1naXQgYS9vcmcuZWNsaXBzZS5qZHQuY29yZS9kb20vb3JnL2Vj
bGlwc2UvamR0L2NvcmUvZG9tL1JlY292ZXJlZFZhcmlhYmxlQmluZGluZy5qYXZhIGIvb3JnLmVj
bGlwc2UuamR0LmNvcmUvZG9tL29yZy9lY2xpcHNlL2pkdC9jb3JlL2RvbS9SZWNvdmVyZWRWYXJp
YWJsZUJpbmRpbmcuamF2YQppbmRleCBiYTUxMmZjLi5iMDg5YTUyIDEwMDY0NAotLS0gYS9vcmcu
ZWNsaXBzZS5qZHQuY29yZS9kb20vb3JnL2VjbGlwc2UvamR0L2NvcmUvZG9tL1JlY292ZXJlZFZh
cmlhYmxlQmluZGluZy5qYXZhCisrKyBiL29yZy5lY2xpcHNlLmpkdC5jb3JlL2RvbS9vcmcvZWNs
aXBzZS9qZHQvY29yZS9kb20vUmVjb3ZlcmVkVmFyaWFibGVCaW5kaW5nLmphdmEKQEAgLTk1LDUg
Kzk1LDYgQEAKIAkJCQkuYXBwZW5kKHRoaXMudmFyaWFibGVEZWNsYXJhdGlvbi5nZXRDbGFzcygp
KQogCQkJCS5hcHBlbmQodGhpcy52YXJpYWJsZURlY2xhcmF0aW9uLmdldE5hbWUoKS5nZXRJZGVu
dGlmaWVyKCkpCi0JCQkJLmFwcGVuZCh0aGlzLnZhcmlhYmxlRGVjbGFyYXRpb24uZ2V0RXh0cmFE
aW1lbnNpb25zKCkpOworCQkJCS5hcHBlbmQoKHRoaXMudmFyaWFibGVEZWNsYXJhdGlvbi5hc3Qu
YXBpTGV2ZWwgPCBBU1QuSkxTOCkgPyAKKwkJCQkJCXRoaXMudmFyaWFibGVEZWNsYXJhdGlvbi5n
ZXRFeHRyYURpbWVuc2lvbnMoKSA6IHRoaXMudmFyaWFibGVEZWNsYXJhdGlvbi5nZXRFeHRyYURp
bWVuc2lvblR5cGVzKCkuc2l6ZSgpKTsKIAkJfQogCQlyZXR1cm4gU3RyaW5nLnZhbHVlT2YoYnVm
ZmVyKTsKZGlmZiAtLWdpdCBhL29yZy5lY2xpcHNlLmpkdC5jb3JlL2RvbS9vcmcvZWNsaXBzZS9q
ZHQvY29yZS9kb20vU2luZ2xlVmFyaWFibGVEZWNsYXJhdGlvbi5qYXZhIGIvb3JnLmVjbGlwc2Uu
amR0LmNvcmUvZG9tL29yZy9lY2xpcHNlL2pkdC9jb3JlL2RvbS9TaW5nbGVWYXJpYWJsZURlY2xh
cmF0aW9uLmphdmEKaW5kZXggNDM2YWYyMS4uMDZjNWU1YiAxMDA2NDQKLS0tIGEvb3JnLmVjbGlw
c2UuamR0LmNvcmUvZG9tL29yZy9lY2xpcHNlL2pkdC9jb3JlL2RvbS9TaW5nbGVWYXJpYWJsZURl
Y2xhcmF0aW9uLmphdmEKKysrIGIvb3JnLmVjbGlwc2UuamR0LmNvcmUvZG9tL29yZy9lY2xpcHNl
L2pkdC9jb3JlL2RvbS9TaW5nbGVWYXJpYWJsZURlY2xhcmF0aW9uLmphdmEKQEAgLTEsNCArMSw0
IEBACiAvKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioq
KioqKioqKioqKioqKioqKioqKioqKioqKioqKgotICogQ29weXJpZ2h0IChjKSAyMDAwLCAyMDEy
IElCTSBDb3Jwb3JhdGlvbiBhbmQgb3RoZXJzLgorICogQ29weXJpZ2h0IChjKSAyMDAwLCAyMDEz
IElCTSBDb3Jwb3JhdGlvbiBhbmQgb3RoZXJzLgogICogQWxsIHJpZ2h0cyByZXNlcnZlZC4gVGhp
cyBwcm9ncmFtIGFuZCB0aGUgYWNjb21wYW55aW5nIG1hdGVyaWFscwogICogYXJlIG1hZGUgYXZh
aWxhYmxlIHVuZGVyIHRoZSB0ZXJtcyBvZiB0aGUgRWNsaXBzZSBQdWJsaWMgTGljZW5zZSB2MS4w
CkBAIC03NSw5ICs3NSwxNyBAQAogCiAJLyoqCi0JICogVGhlICJleHRyYURpbWVuc2lvbnMiIHN0
cnVjdHVyYWwgcHJvcGVydHkgb2YgdGhpcyBub2RlIHR5cGUgKHR5cGU6IHtAbGluayBJbnRlZ2Vy
fSkuCisJICogVGhlICJleHRyYURpbWVuc2lvbnMiIHN0cnVjdHVyYWwgcHJvcGVydHkgb2YgdGhp
cyBub2RlIHR5cGUgKHR5cGU6IHtAbGluayBJbnRlZ2VyfSkuIFRoaXMgcHJvcGVydHkgaXMgc3Vw
cG9ydGVkCisJICogb25seSBpbiBKTFM0IG9yIGxvd2VyIGxldmVsLiBGb3IgSkxTOCBhbmQgYWJv
dmUsIHVzZSA8Y29kZT5FWFRSQV9ESU1FTlNJT05fVFlQRVNfUFJPUEVSVFk8L2NvZGU+LgogCSAq
IEBzaW5jZSAzLjAKIAkgKi8KIAlwdWJsaWMgc3RhdGljIGZpbmFsIFNpbXBsZVByb3BlcnR5RGVz
Y3JpcHRvciBFWFRSQV9ESU1FTlNJT05TX1BST1BFUlRZID0KIAkJbmV3IFNpbXBsZVByb3BlcnR5
RGVzY3JpcHRvcihTaW5nbGVWYXJpYWJsZURlY2xhcmF0aW9uLmNsYXNzLCAiZXh0cmFEaW1lbnNp
b25zIiwgaW50LmNsYXNzLCBNQU5EQVRPUlkpOyAvLyROT04tTkxTLTEkCisKKwkvKioKKwkgKiBU
aGUgImV4dHJhQW5ub3RhdGVkRGltZW5zaW9ucyIgc3RydWN0dXJhbCBwcm9wZXJ0eSBvZiB0aGlz
IG5vZGUgdHlwZSAoY2hpbGQgdHlwZToge0BsaW5rIERpbWVuc2lvblR5cGV9KS4KKwkgKiBAc2lu
Y2UgMy45CisJICovCisJcHVibGljIHN0YXRpYyBmaW5hbCBDaGlsZExpc3RQcm9wZXJ0eURlc2Ny
aXB0b3IgRVhUUkFfRElNRU5TSU9OX1RZUEVTX1BST1BFUlRZID0KKwkJCW5ldyBDaGlsZExpc3RQ
cm9wZXJ0eURlc2NyaXB0b3IoU2luZ2xlVmFyaWFibGVEZWNsYXJhdGlvbi5jbGFzcywgImV4dHJh
RGltZW5zaW9uVHlwZXMiLCBEaW1lbnNpb25UeXBlLmNsYXNzLCBOT19DWUNMRV9SSVNLKTsgLy8k
Tk9OLU5MUy0xJAogCiAJLyoqCkBAIC0xMDMsNCArMTExLDEyIEBACiAJICovCiAJcHJpdmF0ZSBz
dGF0aWMgZmluYWwgTGlzdCBQUk9QRVJUWV9ERVNDUklQVE9SU18zXzA7CisJCisJLyoqCisJICog
QSBsaXN0IG9mIHByb3BlcnR5IGRlc2NyaXB0b3JzIChlbGVtZW50IHR5cGU6CisJICoge0BsaW5r
IFN0cnVjdHVyYWxQcm9wZXJ0eURlc2NyaXB0b3J9KSwKKwkgKiBvciBudWxsIGlmIHVuaW5pdGlh
bGl6ZWQuCisJICogQHNpbmNlIDMuOQorCSAqLworCXByaXZhdGUgc3RhdGljIGZpbmFsIExpc3Qg
UFJPUEVSVFlfREVTQ1JJUFRPUlNfOF8wOwogCiAJc3RhdGljIHsKQEAgLTExNiwxMSArMTMyLDIx
IEBACiAJCXByb3BlcnR5TGlzdCA9IG5ldyBBcnJheUxpc3QoNyk7CiAJCWNyZWF0ZVByb3BlcnR5
TGlzdChTaW5nbGVWYXJpYWJsZURlY2xhcmF0aW9uLmNsYXNzLCBwcm9wZXJ0eUxpc3QpOworCQlh
ZGRKTFMzUHJvcGVydGllcyhwcm9wZXJ0eUxpc3QpOworCQlhZGRQcm9wZXJ0eShFWFRSQV9ESU1F
TlNJT05TX1BST1BFUlRZLCBwcm9wZXJ0eUxpc3QpOworCQlQUk9QRVJUWV9ERVNDUklQVE9SU18z
XzAgPSByZWFwUHJvcGVydHlMaXN0KHByb3BlcnR5TGlzdCk7CisJCQorCQlwcm9wZXJ0eUxpc3Qg
PSBuZXcgQXJyYXlMaXN0KDcpOworCQljcmVhdGVQcm9wZXJ0eUxpc3QoU2luZ2xlVmFyaWFibGVE
ZWNsYXJhdGlvbi5jbGFzcywgcHJvcGVydHlMaXN0KTsKKwkJYWRkSkxTM1Byb3BlcnRpZXMocHJv
cGVydHlMaXN0KTsKKwkJYWRkUHJvcGVydHkoRVhUUkFfRElNRU5TSU9OX1RZUEVTX1BST1BFUlRZ
LCBwcm9wZXJ0eUxpc3QpOworCQlQUk9QRVJUWV9ERVNDUklQVE9SU184XzAgPSByZWFwUHJvcGVy
dHlMaXN0KHByb3BlcnR5TGlzdCk7CisJfQorCisJcHJpdmF0ZSBzdGF0aWMgdm9pZCBhZGRKTFMz
UHJvcGVydGllcyhMaXN0IHByb3BlcnR5TGlzdCkgewogCQlhZGRQcm9wZXJ0eShNT0RJRklFUlMy
X1BST1BFUlRZLCBwcm9wZXJ0eUxpc3QpOwogCQlhZGRQcm9wZXJ0eShUWVBFX1BST1BFUlRZLCBw
cm9wZXJ0eUxpc3QpOwogCQlhZGRQcm9wZXJ0eShWQVJBUkdTX1BST1BFUlRZLCBwcm9wZXJ0eUxp
c3QpOwogCQlhZGRQcm9wZXJ0eShOQU1FX1BST1BFUlRZLCBwcm9wZXJ0eUxpc3QpOwotCQlhZGRQ
cm9wZXJ0eShFWFRSQV9ESU1FTlNJT05TX1BST1BFUlRZLCBwcm9wZXJ0eUxpc3QpOwogCQlhZGRQ
cm9wZXJ0eShJTklUSUFMSVpFUl9QUk9QRVJUWSwgcHJvcGVydHlMaXN0KTsKLQkJUFJPUEVSVFlf
REVTQ1JJUFRPUlNfM18wID0gcmVhcFByb3BlcnR5TGlzdChwcm9wZXJ0eUxpc3QpOwogCX0KIApA
QCAtMTM2LDggKzE2MiwxMiBAQAogCSAqLwogCXB1YmxpYyBzdGF0aWMgTGlzdCBwcm9wZXJ0eURl
c2NyaXB0b3JzKGludCBhcGlMZXZlbCkgewotCQlpZiAoYXBpTGV2ZWwgPT0gQVNULkpMUzJfSU5U
RVJOQUwpIHsKLQkJCXJldHVybiBQUk9QRVJUWV9ERVNDUklQVE9SU18yXzA7Ci0JCX0gZWxzZSB7
Ci0JCQlyZXR1cm4gUFJPUEVSVFlfREVTQ1JJUFRPUlNfM18wOworCQlzd2l0Y2ggKGFwaUxldmVs
KSB7CisJCQljYXNlIEFTVC5KTFMyX0lOVEVSTkFMOgorCQkJCQlyZXR1cm4gUFJPUEVSVFlfREVT
Q1JJUFRPUlNfMl8wOworCQkJY2FzZSBBU1QuSkxTM19JTlRFUk5BTDoKKwkJCWNhc2UgQVNULkpM
UzQ6CisJCQkJCXJldHVybiBQUk9QRVJUWV9ERVNDUklQVE9SU18zXzA7CisJCQlkZWZhdWx0Ogor
CQkJCQlyZXR1cm4gUFJPUEVSVFlfREVTQ1JJUFRPUlNfOF8wOwogCQl9CiAJfQpAQCAtMTg3LDQg
KzIxNywxMSBAQAogCiAJLyoqCisJICogVGhlIGV4dHJhIGRpbWVuc2lvbiB0eXBlcyB0aGlzIG5v
ZGUgaGFzIHdpdGggYW5ub3RhdGlvbnMgaWYgYW55LgorCSAqIAorCSAqIEBzaW5jZSAzLjkKKwkg
Ki8KKwlwcm90ZWN0ZWQgQVNUTm9kZS5Ob2RlTGlzdCBleHRyYURpbWVuc2lvblR5cGVzID0gbnVs
bDsKKworCS8qKgogCSAqIFRoZSBpbml0aWFsaXplciBleHByZXNzaW9uLCBvciA8Y29kZT5udWxs
PC9jb2RlPiBpZiBub25lOwogCSAqIGRlZmF1bHRzIHRvIG5vbmUuCkBAIC0yMDcsNCArMjQ0LDcg
QEAKIAkJaWYgKGFzdC5hcGlMZXZlbCA+PSBBU1QuSkxTM19JTlRFUk5BTCkgewogCQkJdGhpcy5t
b2RpZmllcnMgPSBuZXcgQVNUTm9kZS5Ob2RlTGlzdChNT0RJRklFUlMyX1BST1BFUlRZKTsKKwkJ
fSAKKwkJaWYgKGFzdC5hcGlMZXZlbCA+PSBBU1QuSkxTOCkgeworCQkJdGhpcy5leHRyYURpbWVu
c2lvblR5cGVzID0gbmV3IEFTVE5vZGUuTm9kZUxpc3QoRVhUUkFfRElNRU5TSU9OX1RZUEVTX1BS
T1BFUlRZKTsKIAkJfQogCX0KQEAgLTMyMCw0ICszNjAsNyBAQAogCQkJcmV0dXJuIG1vZGlmaWVy
cygpOwogCQl9CisJCWlmIChwcm9wZXJ0eSA9PSBFWFRSQV9ESU1FTlNJT05fVFlQRVNfUFJPUEVS
VFkpIHsKKwkJCXJldHVybiB0aGlzLmV4dHJhRGltZW5zaW9uVHlwZXM7CisJCX0KIAkJLy8gYWxs
b3cgZGVmYXVsdCBpbXBsZW1lbnRhdGlvbiB0byBmbGFnIHRoZSBlcnJvcgogCQlyZXR1cm4gc3Vw
ZXIuaW50ZXJuYWxHZXRDaGlsZExpc3RQcm9wZXJ0eShwcm9wZXJ0eSk7CkBAIC0zNDQsNSArMzg3
LDExIEBACiAJCX0KIAkJcmVzdWx0LnNldFR5cGUoKFR5cGUpIGdldFR5cGUoKS5jbG9uZSh0YXJn
ZXQpKTsKLQkJcmVzdWx0LnNldEV4dHJhRGltZW5zaW9ucyhnZXRFeHRyYURpbWVuc2lvbnMoKSk7
CisJCWlmICh0aGlzLmFzdC5hcGlMZXZlbCA+PSBBU1QuSkxTOCkgeworCQkJcmVzdWx0LmV4dHJh
RGltZW5zaW9uVHlwZXMgPSBuZXcgQVNUTm9kZS5Ob2RlTGlzdChFWFRSQV9ESU1FTlNJT05fVFlQ
RVNfUFJPUEVSVFkpOworCQkJcmVzdWx0LmV4dHJhRGltZW5zaW9uVHlwZXMuYWRkQWxsKAorCQkJ
CQlBU1ROb2RlLmNvcHlTdWJ0cmVlcyh0YXJnZXQsIHRoaXMuZXh0cmFEaW1lbnNpb25UeXBlcykp
OworCQl9IGVsc2UgeworCQkJcmVzdWx0LnNldEV4dHJhRGltZW5zaW9ucyhnZXRFeHRyYURpbWVu
c2lvbnMoKSk7CisJCX0KIAkJcmVzdWx0LnNldE5hbWUoKFNpbXBsZU5hbWUpIGdldE5hbWUoKS5j
bG9uZSh0YXJnZXQpKTsKIAkJcmVzdWx0LnNldEluaXRpYWxpemVyKApAQCAtMzcxLDQgKzQyMCw3
IEBACiAJCQlhY2NlcHRDaGlsZCh2aXNpdG9yLCBnZXRUeXBlKCkpOwogCQkJYWNjZXB0Q2hpbGQo
dmlzaXRvciwgZ2V0TmFtZSgpKTsKKwkJCWlmICh0aGlzLmFzdC5hcGlMZXZlbCA+PSBBU1QuSkxT
OCkgeworCQkJCWFjY2VwdENoaWxkcmVuKHZpc2l0b3IsIHRoaXMuZXh0cmFEaW1lbnNpb25UeXBl
cyk7CisJCQl9CiAJCQlhY2NlcHRDaGlsZCh2aXNpdG9yLCBnZXRJbml0aWFsaXplcigpKTsKIAkJ
fQpAQCAtNTgwLDQgKzYzMiw1IEBACiAJICovCiAJcHVibGljIGludCBnZXRFeHRyYURpbWVuc2lv
bnMoKSB7CisJCXN1cHBvcnRlZE9ubHlJbjJfM180KCk7CiAJCXJldHVybiB0aGlzLmV4dHJhQXJy
YXlEaW1lbnNpb25zOwogCX0KQEAgLTU4OCw0ICs2NDEsNSBAQAogCSAqLwogCXB1YmxpYyB2b2lk
IHNldEV4dHJhRGltZW5zaW9ucyhpbnQgZGltZW5zaW9ucykgeworCQlzdXBwb3J0ZWRPbmx5SW4y
XzNfNCgpOwogCQlpZiAoZGltZW5zaW9ucyA8IDApIHsKIAkJCXRocm93IG5ldyBJbGxlZ2FsQXJn
dW1lbnRFeGNlcHRpb24oKTsKQEAgLTU5Niw0ICs2NTAsMTYgQEAKIAl9CiAKKwkvKioKKwkgKiBS
ZXR1cm5zIHRoZSBsaXZlIG9yZGVyZWQgbGlzdCBvZiBleHRyYSBkaW1lbnNpb25zIHdpdGggYW5u
b3RhdGlvbnMgaWYgYW55LgorCSAqIAorCSAqIEByZXR1cm4gdGhlIGxpdmUgbGlzdCBvZiBleHRy
YSBkaW1lbnNpb25zIHdpdGggYW5ub3RhdGlvbnMgaWYgYW55IChlbGVtZW50IHR5cGU6IHtAbGlu
ayBEaW1lbnNpb25UeXBlfVtdKQorCSAqIEBzaW5jZSAzLjkKKwkgKi8KKwlwdWJsaWMgTGlzdCBn
ZXRFeHRyYURpbWVuc2lvblR5cGVzKCkgeworCQl1bnN1cHBvcnRlZEluMl8zXzQoKTsKKwkJcmV0
dXJuIHRoaXMuZXh0cmFEaW1lbnNpb25UeXBlczsKKwl9CisJCisJCiAJLyogKG9taXQgamF2YWRv
YyBmb3IgdGhpcyBtZXRob2QpCiAJICogTWV0aG9kIGRlY2xhcmVkIG9uIFZhcmlhYmxlRGVjbGFy
YXRpb24uCmRpZmYgLS1naXQgYS9vcmcuZWNsaXBzZS5qZHQuY29yZS9kb20vb3JnL2VjbGlwc2Uv
amR0L2NvcmUvZG9tL1ZhcmlhYmxlRGVjbGFyYXRpb24uamF2YSBiL29yZy5lY2xpcHNlLmpkdC5j
b3JlL2RvbS9vcmcvZWNsaXBzZS9qZHQvY29yZS9kb20vVmFyaWFibGVEZWNsYXJhdGlvbi5qYXZh
CmluZGV4IGZjMzg4ZTguLjg5Y2YyODEgMTAwNjQ0Ci0tLSBhL29yZy5lY2xpcHNlLmpkdC5jb3Jl
L2RvbS9vcmcvZWNsaXBzZS9qZHQvY29yZS9kb20vVmFyaWFibGVEZWNsYXJhdGlvbi5qYXZhCisr
KyBiL29yZy5lY2xpcHNlLmpkdC5jb3JlL2RvbS9vcmcvZWNsaXBzZS9qZHQvY29yZS9kb20vVmFy
aWFibGVEZWNsYXJhdGlvbi5qYXZhCkBAIC0xMiw0ICsxMiw2IEBACiBwYWNrYWdlIG9yZy5lY2xp
cHNlLmpkdC5jb3JlLmRvbTsKIAoraW1wb3J0IGphdmEudXRpbC5MaXN0OworCiAvKioKICAqIEFi
c3RyYWN0IGJhc2UgY2xhc3Mgb2YgYWxsIEFTVCBub2RlIHR5cGVzIHRoYXQgZGVjbGFyZSBhIHNp
bmdsZSBsb2NhbApAQCAtMTU3LDQgKzE1OSwxNCBAQAogCXB1YmxpYyBhYnN0cmFjdCB2b2lkIHNl
dEV4dHJhRGltZW5zaW9ucyhpbnQgZGltZW5zaW9ucyk7CiAKKwkKKwkvKioKKwkgKiBSZXR1cm5z
IHRoZSBleHRyYSBhbm5vdGF0YWJsZSBkaW1lbnNpb24gdHlwZXMgb2YgdGhlIHNwZWNpZmllZCB0
eXBlLiAoSkxTOCBvbmx5KQorCSAqIAorCSAqIEByZXR1cm4gdGhlIGxpc3Qgb2YgZXh0cmEgZGlt
ZW5zaW9uIHR5cGVzCisJICogQGV4Y2VwdGlvbiBJbGxlZ2FsQXJndW1lbnRFeGNlcHRpb24gaWYg
c3BlY2lmaWVkIGFwaSBsZXZlbCBpcyBsb3dlciB0aGFuIEpMUzguCisJICogQHNpbmNlIDMuOQor
CSAqLworCXB1YmxpYyBhYnN0cmFjdCBMaXN0IGdldEV4dHJhRGltZW5zaW9uVHlwZXMoKTsKKwkK
IAkvKioKIAkgKiBSZXR1cm5zIHRoZSBpbml0aWFsaXplciBvZiB0aGlzIHZhcmlhYmxlIGRlY2xh
cmF0aW9uLCBvcgpkaWZmIC0tZ2l0IGEvb3JnLmVjbGlwc2UuamR0LmNvcmUvZG9tL29yZy9lY2xp
cHNlL2pkdC9jb3JlL2RvbS9WYXJpYWJsZURlY2xhcmF0aW9uRnJhZ21lbnQuamF2YSBiL29yZy5l
Y2xpcHNlLmpkdC5jb3JlL2RvbS9vcmcvZWNsaXBzZS9qZHQvY29yZS9kb20vVmFyaWFibGVEZWNs
YXJhdGlvbkZyYWdtZW50LmphdmEKaW5kZXggZTlkZTdjOC4uODQ5ZjgzZSAxMDA2NDQKLS0tIGEv
b3JnLmVjbGlwc2UuamR0LmNvcmUvZG9tL29yZy9lY2xpcHNlL2pkdC9jb3JlL2RvbS9WYXJpYWJs
ZURlY2xhcmF0aW9uRnJhZ21lbnQuamF2YQorKysgYi9vcmcuZWNsaXBzZS5qZHQuY29yZS9kb20v
b3JnL2VjbGlwc2UvamR0L2NvcmUvZG9tL1ZhcmlhYmxlRGVjbGFyYXRpb25GcmFnbWVudC5qYXZh
CkBAIC00Nyw0ICs0NywxMSBAQAogCiAJLyoqCisJICogVGhlICJleHRyYUFubm90YXRlZERpbWVu
c2lvbnMiIHN0cnVjdHVyYWwgcHJvcGVydHkgb2YgdGhpcyBub2RlIHR5cGUgKGNoaWxkIHR5cGU6
IHtAbGluayBEaW1lbnNpb25UeXBlfSkuCisJICogQHNpbmNlIDMuOQorCSAqLworCXB1YmxpYyBz
dGF0aWMgZmluYWwgQ2hpbGRMaXN0UHJvcGVydHlEZXNjcmlwdG9yIEVYVFJBX0RJTUVOU0lPTl9U
WVBFU19QUk9QRVJUWSA9CisJCQluZXcgQ2hpbGRMaXN0UHJvcGVydHlEZXNjcmlwdG9yKFZhcmlh
YmxlRGVjbGFyYXRpb25GcmFnbWVudC5jbGFzcywgImV4dHJhRGltZW5zaW9uVHlwZXMiLCBEaW1l
bnNpb25UeXBlLmNsYXNzLCBOT19DWUNMRV9SSVNLKTsgLy8kTk9OLU5MUy0xJAorCisJLyoqCiAJ
ICogVGhlICJpbml0aWFsaXplciIgc3RydWN0dXJhbCBwcm9wZXJ0eSBvZiB0aGlzIG5vZGUgdHlw
ZSAoY2hpbGQgdHlwZToge0BsaW5rIEV4cHJlc3Npb259KS4KIAkgKiBAc2luY2UgMy4wCkBAIC02
MCwxMiArNjcsMzAgQEAKIAkgKi8KIAlwcml2YXRlIHN0YXRpYyBmaW5hbCBMaXN0IFBST1BFUlRZ
X0RFU0NSSVBUT1JTOworCQorCS8qKgorCSAqIEEgbGlzdCBvZiBwcm9wZXJ0eSBkZXNjcmlwdG9y
cyAoZWxlbWVudCB0eXBlOgorCSAqIHtAbGluayBTdHJ1Y3R1cmFsUHJvcGVydHlEZXNjcmlwdG9y
fSksCisJICogb3IgbnVsbCBpZiB1bmluaXRpYWxpemVkLgorCSAqIEBzaW5jZSAzLjkKKwkgKi8K
Kwlwcml2YXRlIHN0YXRpYyBmaW5hbCBMaXN0IFBST1BFUlRZX0RFU0NSSVBUT1JTXzhfMDsKIAog
CXN0YXRpYyB7CiAJCUxpc3QgcHJvcGVydHlMaXN0ID0gbmV3IEFycmF5TGlzdCg0KTsKIAkJY3Jl
YXRlUHJvcGVydHlMaXN0KFZhcmlhYmxlRGVjbGFyYXRpb25GcmFnbWVudC5jbGFzcywgcHJvcGVy
dHlMaXN0KTsKLQkJYWRkUHJvcGVydHkoTkFNRV9QUk9QRVJUWSwgcHJvcGVydHlMaXN0KTsKKwkJ
YWRkSkxTM1Byb3BlcnRpZXMocHJvcGVydHlMaXN0KTsKIAkJYWRkUHJvcGVydHkoRVhUUkFfRElN
RU5TSU9OU19QUk9QRVJUWSwgcHJvcGVydHlMaXN0KTsKLQkJYWRkUHJvcGVydHkoSU5JVElBTEla
RVJfUFJPUEVSVFksIHByb3BlcnR5TGlzdCk7CiAJCVBST1BFUlRZX0RFU0NSSVBUT1JTID0gcmVh
cFByb3BlcnR5TGlzdChwcm9wZXJ0eUxpc3QpOworCQkKKwkJcHJvcGVydHlMaXN0ID0gbmV3IEFy
cmF5TGlzdCg0KTsKKwkJY3JlYXRlUHJvcGVydHlMaXN0KFZhcmlhYmxlRGVjbGFyYXRpb25GcmFn
bWVudC5jbGFzcywgcHJvcGVydHlMaXN0KTsKKwkJYWRkSkxTM1Byb3BlcnRpZXMocHJvcGVydHlM
aXN0KTsKKwkJYWRkUHJvcGVydHkoRVhUUkFfRElNRU5TSU9OX1RZUEVTX1BST1BFUlRZLCBwcm9w
ZXJ0eUxpc3QpOworCQlQUk9QRVJUWV9ERVNDUklQVE9SU184XzAgPSByZWFwUHJvcGVydHlMaXN0
KHByb3BlcnR5TGlzdCk7CisJfQorCisJcHJpdmF0ZSBzdGF0aWMgdm9pZCBhZGRKTFMzUHJvcGVy
dGllcyhMaXN0IHByb3BlcnR5TGlzdCkgeworCQlhZGRQcm9wZXJ0eShOQU1FX1BST1BFUlRZLCBw
cm9wZXJ0eUxpc3QpOworCQlhZGRQcm9wZXJ0eShJTklUSUFMSVpFUl9QUk9QRVJUWSwgcHJvcGVy
dHlMaXN0KTsKIAl9CiAKQEAgLTgxLDUgKzEwNiw5IEBACiAJICovCiAJcHVibGljIHN0YXRpYyBM
aXN0IHByb3BlcnR5RGVzY3JpcHRvcnMoaW50IGFwaUxldmVsKSB7Ci0JCXJldHVybiBQUk9QRVJU
WV9ERVNDUklQVE9SUzsKKwkJaWYgKGFwaUxldmVsID49IEFTVC5KTFM4KSB7CisJCQlyZXR1cm4g
UFJPUEVSVFlfREVTQ1JJUFRPUlNfOF8wOworCQl9IGVsc2UgeworCQkJcmV0dXJuIFBST1BFUlRZ
X0RFU0NSSVBUT1JTOworCQl9CiAJfQogCkBAIC05NSw0ICsxMjQsMTEgQEAKIAkgKi8KIAlwcml2
YXRlIGludCBleHRyYUFycmF5RGltZW5zaW9ucyA9IDA7CisJCisJLyoqCisJICogVGhlIGV4dHJh
IGRpbWVuc2lvbiB0eXBlcyB0aGlzIG5vZGUgaGFzIHdpdGggYW5ub3RhdGlvbnMgaWYgYW55Lgor
CSAqIAorCSAqIEBzaW5jZSAzLjkKKwkgKi8KKwlwcm90ZWN0ZWQgQVNUTm9kZS5Ob2RlTGlzdCBl
eHRyYURpbWVuc2lvblR5cGVzID0gbnVsbDsKIAogCS8qKgpAQCAtMTE0LDQgKzE1MCw3IEBACiAJ
VmFyaWFibGVEZWNsYXJhdGlvbkZyYWdtZW50KEFTVCBhc3QpIHsKIAkJc3VwZXIoYXN0KTsKKwkJ
aWYgKGFzdC5hcGlMZXZlbCA+PSBBU1QuSkxTOCkgeworCQkJdGhpcy5leHRyYURpbWVuc2lvblR5
cGVzID0gbmV3IEFTVE5vZGUuTm9kZUxpc3QoRVhUUkFfRElNRU5TSU9OX1RZUEVTX1BST1BFUlRZ
KTsKKwkJfQogCX0KIApAQCAtMTc0LDUgKzIxMyw1IEBACiAJCQkJcmV0dXJuIG51bGw7CiAJCQl9
Ci0JCX0KKwkJfSAKIAkJaWYgKHByb3BlcnR5ID09IElOSVRJQUxJWkVSX1BST1BFUlRZKSB7CiAJ
CQlpZiAoZ2V0KSB7CkBAIC0xODIsNyArMjIxLDE5IEBACiAJCQkJcmV0dXJuIG51bGw7CiAJCQl9
Ci0JCX0KKwkJfSAKKwkJCiAJCS8vIGFsbG93IGRlZmF1bHQgaW1wbGVtZW50YXRpb24gdG8gZmxh
ZyB0aGUgZXJyb3IKIAkJcmV0dXJuIHN1cGVyLmludGVybmFsR2V0U2V0Q2hpbGRQcm9wZXJ0eShw
cm9wZXJ0eSwgZ2V0LCBjaGlsZCk7CisJfQorCisJLyogKG9taXQgamF2YWRvYyBmb3IgdGhpcyBt
ZXRob2QpCisJICogTWV0aG9kIGRlY2xhcmVkIG9uIEFTVE5vZGUuCisJICovCisJZmluYWwgTGlz
dCBpbnRlcm5hbEdldENoaWxkTGlzdFByb3BlcnR5KENoaWxkTGlzdFByb3BlcnR5RGVzY3JpcHRv
ciBwcm9wZXJ0eSkgeworCQlpZiAocHJvcGVydHkgPT0gRVhUUkFfRElNRU5TSU9OX1RZUEVTX1BS
T1BFUlRZKSB7CisJCQlyZXR1cm4gdGhpcy5leHRyYURpbWVuc2lvblR5cGVzOworCQl9CisJCS8v
IGFsbG93IGRlZmF1bHQgaW1wbGVtZW50YXRpb24gdG8gZmxhZyB0aGUgZXJyb3IKKwkJcmV0dXJu
IHN1cGVyLmludGVybmFsR2V0Q2hpbGRMaXN0UHJvcGVydHkocHJvcGVydHkpOwogCX0KIApAQCAt
MjAxLDUgKzI1MiwxMSBAQAogCQlyZXN1bHQuc2V0U291cmNlUmFuZ2UoZ2V0U3RhcnRQb3NpdGlv
bigpLCBnZXRMZW5ndGgoKSk7CiAJCXJlc3VsdC5zZXROYW1lKChTaW1wbGVOYW1lKSBnZXROYW1l
KCkuY2xvbmUodGFyZ2V0KSk7Ci0JCXJlc3VsdC5zZXRFeHRyYURpbWVuc2lvbnMoZ2V0RXh0cmFE
aW1lbnNpb25zKCkpOworCQlpZiAodGhpcy5hc3QuYXBpTGV2ZWwgPj0gQVNULkpMUzgpIHsKKwkJ
CXJlc3VsdC5leHRyYURpbWVuc2lvblR5cGVzID0gbmV3IEFTVE5vZGUuTm9kZUxpc3QoRVhUUkFf
RElNRU5TSU9OX1RZUEVTX1BST1BFUlRZKTsKKwkJCXJlc3VsdC5leHRyYURpbWVuc2lvblR5cGVz
LmFkZEFsbCgKKwkJCQkJQVNUTm9kZS5jb3B5U3VidHJlZXModGFyZ2V0LCB0aGlzLmV4dHJhRGlt
ZW5zaW9uVHlwZXMpKTsKKwkJfSBlbHNlIHsKKwkJCXJlc3VsdC5zZXRFeHRyYURpbWVuc2lvbnMo
Z2V0RXh0cmFEaW1lbnNpb25zKCkpOworCQl9CiAJCXJlc3VsdC5zZXRJbml0aWFsaXplcigKIAkJ
CShFeHByZXNzaW9uKSBBU1ROb2RlLmNvcHlTdWJ0cmVlKHRhcmdldCwgZ2V0SW5pdGlhbGl6ZXIo
KSkpOwpAQCAtMjI0LDQgKzI4MSw4IEBACiAJCQlhY2NlcHRDaGlsZCh2aXNpdG9yLCBnZXROYW1l
KCkpOwogCQkJYWNjZXB0Q2hpbGQodmlzaXRvciwgZ2V0SW5pdGlhbGl6ZXIoKSk7CisJCQkKKwkJ
CWlmICh0aGlzLmFzdC5hcGlMZXZlbCA+PSBBU1QuSkxTOCkgeworCQkJCWFjY2VwdENoaWxkcmVu
KHZpc2l0b3IsIHRoaXMuZXh0cmFEaW1lbnNpb25UeXBlcyk7CisJCQl9CiAJCX0KIAkJdmlzaXRv
ci5lbmRWaXNpdCh0aGlzKTsKQEAgLTI3Myw0ICszMzQsNSBAQAogCSAqLwogCXB1YmxpYyBpbnQg
Z2V0RXh0cmFEaW1lbnNpb25zKCkgeworCQlzdXBwb3J0ZWRPbmx5SW4yXzNfNCgpOwogCQlyZXR1
cm4gdGhpcy5leHRyYUFycmF5RGltZW5zaW9uczsKIAl9CkBAIC0yOTAsNCArMzUyLDUgQEAKIAkg
Ki8KIAlwdWJsaWMgdm9pZCBzZXRFeHRyYURpbWVuc2lvbnMoaW50IGRpbWVuc2lvbnMpIHsKKwkJ
c3VwcG9ydGVkT25seUluMl8zXzQoKTsKIAkJaWYgKGRpbWVuc2lvbnMgPCAwKSB7CiAJCQl0aHJv
dyBuZXcgSWxsZWdhbEFyZ3VtZW50RXhjZXB0aW9uKCk7CkBAIC0yOTcsNSArMzYwLDE2IEBACiAJ
CXBvc3RWYWx1ZUNoYW5nZShFWFRSQV9ESU1FTlNJT05TX1BST1BFUlRZKTsKIAl9Ci0KKwkKKwkv
KioKKwkgKiBSZXR1cm5zIHRoZSBsaXZlIG9yZGVyZWQgbGlzdCBvZiBleHRyYSBkaW1lbnNpb25z
IHdpdGggYW5ub3RhdGlvbnMgaWYgYW55LgorCSAqIAorCSAqIEByZXR1cm4gdGhlIGxpdmUgbGlz
dCBvZiBleHRyYSBkaW1lbnNpb25zIHdpdGggYW5ub3RhdGlvbnMgaWYgYW55IChlbGVtZW50IHR5
cGU6IHtAbGluayBEaW1lbnNpb25UeXBlfVtdKQorCSAqIEBzaW5jZSAzLjkKKwkgKi8KKwlwdWJs
aWMgTGlzdCBnZXRFeHRyYURpbWVuc2lvblR5cGVzKCkgeworCQl1bnN1cHBvcnRlZEluMl8zXzQo
KTsKKwkJcmV0dXJuIHRoaXMuZXh0cmFEaW1lbnNpb25UeXBlczsKKwl9CisJCiAJLyogKG9taXQg
amF2YWRvYyBmb3IgdGhpcyBtZXRob2QpCiAJICogTWV0aG9kIGRlY2xhcmVkIG9uIFZhcmlhYmxl
RGVjbGFyYXRpb24uCmRpZmYgLS1naXQgYS9vcmcuZWNsaXBzZS5qZHQuY29yZS9kb20vb3JnL2Vj
bGlwc2UvamR0L2ludGVybmFsL2NvcmUvZG9tL05haXZlQVNURmxhdHRlbmVyLmphdmEgYi9vcmcu
ZWNsaXBzZS5qZHQuY29yZS9kb20vb3JnL2VjbGlwc2UvamR0L2ludGVybmFsL2NvcmUvZG9tL05h
aXZlQVNURmxhdHRlbmVyLmphdmEKaW5kZXggOTRkYzNmMS4uNzc4OGU2ZCAxMDA2NDQKLS0tIGEv
b3JnLmVjbGlwc2UuamR0LmNvcmUvZG9tL29yZy9lY2xpcHNlL2pkdC9pbnRlcm5hbC9jb3JlL2Rv
bS9OYWl2ZUFTVEZsYXR0ZW5lci5qYXZhCisrKyBiL29yZy5lY2xpcHNlLmpkdC5jb3JlL2RvbS9v
cmcvZWNsaXBzZS9qZHQvaW50ZXJuYWwvY29yZS9kb20vTmFpdmVBU1RGbGF0dGVuZXIuamF2YQpA
QCAtMSw0ICsxLDQgQEAKIC8qKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioq
KioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqCi0gKiBDb3B5cmlnaHQgKGMp
IDIwMDAsIDIwMTIgSUJNIENvcnBvcmF0aW9uIGFuZCBvdGhlcnMuCisgKiBDb3B5cmlnaHQgKGMp
IDIwMDAsIDIwMTMgSUJNIENvcnBvcmF0aW9uIGFuZCBvdGhlcnMuCiAgKiBBbGwgcmlnaHRzIHJl
c2VydmVkLiBUaGlzIHByb2dyYW0gYW5kIHRoZSBhY2NvbXBhbnlpbmcgbWF0ZXJpYWxzCiAgKiBh
cmUgbWFkZSBhdmFpbGFibGUgdW5kZXIgdGhlIHRlcm1zIG9mIHRoZSBFY2xpcHNlIFB1YmxpYyBM
aWNlbnNlIHYxLjAKQEAgLTQ2LDQgKzQ2LDUgQEAKIGltcG9ydCBvcmcuZWNsaXBzZS5qZHQuY29y
ZS5kb20uQ29uc3RydWN0b3JJbnZvY2F0aW9uOwogaW1wb3J0IG9yZy5lY2xpcHNlLmpkdC5jb3Jl
LmRvbS5Db250aW51ZVN0YXRlbWVudDsKK2ltcG9ydCBvcmcuZWNsaXBzZS5qZHQuY29yZS5kb20u
RGltZW5zaW9uVHlwZTsKIGltcG9ydCBvcmcuZWNsaXBzZS5qZHQuY29yZS5kb20uVW5pb25UeXBl
OwogaW1wb3J0IG9yZy5lY2xpcHNlLmpkdC5jb3JlLmRvbS5Eb1N0YXRlbWVudDsKQEAgLTQxNCw0
ICs0MTUsMTQgQEAKIAkJdmlzaXRUeXBlQW5ub3RhdGlvbnMobm9kZSk7CiAJCXRoaXMuYnVmZmVy
LmFwcGVuZCgiW10iKTsvLyROT04tTkxTLTEkCisJCXJldHVybiBmYWxzZTsKKwl9CisKKwlwdWJs
aWMgYm9vbGVhbiB2aXNpdChEaW1lbnNpb25UeXBlIG5vZGUpIHsKKwkJdmlzaXRUeXBlQW5ub3Rh
dGlvbnMobm9kZSk7CisJCXRoaXMuYnVmZmVyLmFwcGVuZCgiWyIpOyAvLyROT04tTkxTLTEkCisJ
CWlmIChub2RlLmV4cHJlc3Npb24oKSAhPSBudWxsKSB7CisJCQlub2RlLmV4cHJlc3Npb24oKS5h
Y2NlcHQodGhpcyk7CisJCX0KKwkJdGhpcy5idWZmZXIuYXBwZW5kKCJdIik7IC8vJE5PTi1OTFMt
MSQKIAkJcmV0dXJuIGZhbHNlOwogCX0KQEAgLTEwMjIsNiArMTAzMyw5IEBACiAJCX0KIAkJdGhp
cy5idWZmZXIuYXBwZW5kKCIpIik7Ly8kTk9OLU5MUy0xJAotCQlmb3IgKGludCBpID0gMDsgaSA8
IG5vZGUuZ2V0RXh0cmFEaW1lbnNpb25zKCk7IGkrKykgewotCQkJdGhpcy5idWZmZXIuYXBwZW5k
KCJbXSIpOyAvLyROT04tTkxTLTEkCisJCWlmIChub2RlLmdldEFTVCgpLmFwaUxldmVsKCkgPj0g
QVNULkpMUzgpIHsKKwkJCUxpc3QgZGltZW5zaW9ucyA9IG5vZGUuZ2V0RXh0cmFBbm5vdGF0ZWRE
aW1lbnNpb25zKCk7CisJCQlmb3IgKGludCBpID0gMDsgaSA8IGRpbWVuc2lvbnMuc2l6ZSgpOyBp
KyspIHsKKwkJCQl2aXNpdCgoRGltZW5zaW9uVHlwZSkgZGltZW5zaW9ucy5nZXQoaSkpOworCQkJ
fQogCQl9CiAJCWlmICghbm9kZS50aHJvd25FeGNlcHRpb25zKCkuaXNFbXB0eSgpKSB7CkBAIC0x
MzI1LDYgKzEzMzksOSBAQAogCQl0aGlzLmJ1ZmZlci5hcHBlbmQoIiAiKTsvLyROT04tTkxTLTEk
CiAJCW5vZGUuZ2V0TmFtZSgpLmFjY2VwdCh0aGlzKTsKLQkJZm9yIChpbnQgaSA9IDA7IGkgPCBu
b2RlLmdldEV4dHJhRGltZW5zaW9ucygpOyBpKyspIHsKLQkJCXRoaXMuYnVmZmVyLmFwcGVuZCgi
W10iKTsgLy8kTk9OLU5MUy0xJAorCQlpZiAobm9kZS5nZXRBU1QoKS5hcGlMZXZlbCgpID49IEFT
VC5KTFM4KSB7CisJCQlMaXN0IGRpbWVuc2lvbnMgPSBub2RlLmdldEV4dHJhRGltZW5zaW9uVHlw
ZXMoKTsKKwkJCWZvciAoaW50IGkgPSAwOyBpIDwgZGltZW5zaW9ucy5zaXplKCk7IGkrKykgewor
CQkJCXZpc2l0KChEaW1lbnNpb25UeXBlKSBkaW1lbnNpb25zLmdldChpKSk7CisJCQl9CiAJCX0K
IAkJaWYgKG5vZGUuZ2V0SW5pdGlhbGl6ZXIoKSAhPSBudWxsKSB7CkBAIC0xNzQ2LDYgKzE3NjMs
OSBAQAogCXB1YmxpYyBib29sZWFuIHZpc2l0KFZhcmlhYmxlRGVjbGFyYXRpb25GcmFnbWVudCBu
b2RlKSB7CiAJCW5vZGUuZ2V0TmFtZSgpLmFjY2VwdCh0aGlzKTsKLQkJZm9yIChpbnQgaSA9IDA7
IGkgPCBub2RlLmdldEV4dHJhRGltZW5zaW9ucygpOyBpKyspIHsKLQkJCXRoaXMuYnVmZmVyLmFw
cGVuZCgiW10iKTsvLyROT04tTkxTLTEkCisJCWlmIChub2RlLmdldEFTVCgpLmFwaUxldmVsKCkg
Pj0gQVNULkpMUzgpIHsKKwkJCUxpc3QgZGltZW5zaW9ucyA9IG5vZGUuZ2V0RXh0cmFEaW1lbnNp
b25UeXBlcygpOworCQkJZm9yIChpbnQgaSA9IDA7IGkgPCBkaW1lbnNpb25zLnNpemUoKTsgaSsr
KSB7CisJCQkJdmlzaXQoKERpbWVuc2lvblR5cGUpIGRpbWVuc2lvbnMuZ2V0KGkpKTsKKwkJCX0K
IAkJfQogCQlpZiAobm9kZS5nZXRJbml0aWFsaXplcigpICE9IG51bGwpIHsKQEAgLTE4MTMsNSAr
MTgzMyw1IEBACiAJCWlmIChub2RlLmdldEFTVCgpLmFwaUxldmVsKCkgPj0gQVNULkpMUzgpIHsK
IAkJCUxpc3QgYW5ub3RhdGlvbnMgPSBub2RlLmFubm90YXRpb25zKCk7Ci0JCQlpZiAoYW5ub3Rh
dGlvbnMgIT0gbnVsbCkgeworCQkJaWYgKGFubm90YXRpb25zICE9IG51bGwgJiYgYW5ub3RhdGlv
bnMuc2l6ZSgpID4gMCkgewogCQkJCWZvciAoSXRlcmF0b3IgaXQgPSBhbm5vdGF0aW9ucy5pdGVy
YXRvcigpOyBpdC5oYXNOZXh0KCk7ICkgewogCQkJCQlBbm5vdGF0aW9uIGFubm90YXRpb24gPSAo
QW5ub3RhdGlvbikgaXQubmV4dCgpOwpAQCAtMTgyNSw1ICsxODQ1LDUgQEAKIAkJaWYgKG5vZGUu
Z2V0QVNUKCkuYXBpTGV2ZWwoKSA+PSBBU1QuSkxTOCkgewogCQkJTGlzdCBhbm5vdGF0aW9ucyA9
IG5vZGUuYW5ub3RhdGlvbnMoKTsKLQkJCWlmIChhbm5vdGF0aW9ucyAhPSBudWxsKSB7CisJCQlp
ZiAoYW5ub3RhdGlvbnMgIT0gbnVsbCAmJiBhbm5vdGF0aW9ucy5zaXplKCkgPiAwKSB7CiAJCQkJ
Zm9yIChJdGVyYXRvciBpdCA9IGFubm90YXRpb25zLml0ZXJhdG9yKCk7IGl0Lmhhc05leHQoKTsg
KSB7CiAJCQkJCUFubm90YXRpb24gYW5ub3RhdGlvbiA9IChBbm5vdGF0aW9uKSBpdC5uZXh0KCk7
CmRpZmYgLS1naXQgYS9vcmcuZWNsaXBzZS5qZHQuY29yZS9kb20vb3JnL2VjbGlwc2UvamR0L2lu
dGVybmFsL2NvcmUvZG9tL3Jld3JpdGUvQVNUUmV3cml0ZUFuYWx5emVyLmphdmEgYi9vcmcuZWNs
aXBzZS5qZHQuY29yZS9kb20vb3JnL2VjbGlwc2UvamR0L2ludGVybmFsL2NvcmUvZG9tL3Jld3Jp
dGUvQVNUUmV3cml0ZUFuYWx5emVyLmphdmEKaW5kZXggYjI2MTFhMS4uYzljNTQ2MiAxMDA2NDQK
LS0tIGEvb3JnLmVjbGlwc2UuamR0LmNvcmUvZG9tL29yZy9lY2xpcHNlL2pkdC9pbnRlcm5hbC9j
b3JlL2RvbS9yZXdyaXRlL0FTVFJld3JpdGVBbmFseXplci5qYXZhCisrKyBiL29yZy5lY2xpcHNl
LmpkdC5jb3JlL2RvbS9vcmcvZWNsaXBzZS9qZHQvaW50ZXJuYWwvY29yZS9kb20vcmV3cml0ZS9B
U1RSZXdyaXRlQW5hbHl6ZXIuamF2YQpAQCAtMTgzMyw0ICsxODMzLDkgQEAKIAkJCXBvcz0gZ2V0
U2Nhbm5lcigpLmdldFRva2VuRW5kT2Zmc2V0KFRlcm1pbmFsVG9rZW5zLlRva2VuTmFtZVJQQVJF
TiwgcG9zKTsKIAorCQkJLy8gSW4gY2FzZSBvZiBBU1QuSkxTOCwgdGhlIGRpbWVuc2lvbnMgd2ls
bCBoYXZlIGFubm90YXRpb25zIGFzIHdlbGwKKwkJCS8vIFN1cHBvcnQgbmV3IHByb3BlcnR5IEVY
VFJBX0FOTk9UQVRFRF9ESU1FTlNJT05TX1BST1BFUlRZCisJCQkvLyBhbGdvcml0aG06IDEuIFNl
ZSBpZiB0aGUgbmV3IHByb3BlcnR5IGhhcyBjaGFuZ2VkCisJCQkvLyAJCQkJMi4gSWYgdHJ1ZSwg
ZG9uJ3QgYm90aGVyIGFib3V0IEVYVFJBX0RJTUVOU0lPTlNfUFJPUEVSVFksIHJld3JpdGUgYWNj
b3JkaW5nIHRvIHRoZSBuZXcgdmFsdWUgb2YgdGhlIEVYVFJBX0FOTk9UQVRFRF9ESU1FTlNJT05T
X1BST1BFUlRZCisJCQkvLwkJCQkzLiBJZiBmYWxzZSwgc2VlIHByb2NlZWQgYXMgdXN1YWwuIAog
CQkJaW50IGV4dHJhRGltcz0gcmV3cml0ZUV4dHJhRGltZW5zaW9ucyhub2RlLCBNZXRob2REZWNs
YXJhdGlvbi5FWFRSQV9ESU1FTlNJT05TX1BST1BFUlRZLCBwb3MpOwogCmRpZmYgLS1naXQgYS9v
cmcuZWNsaXBzZS5qZHQuY29yZS9kb20vb3JnL2VjbGlwc2UvamR0L2ludGVybmFsL2NvcmUvZG9t
L3Jld3JpdGUvQVNUUmV3cml0ZUZsYXR0ZW5lci5qYXZhIGIvb3JnLmVjbGlwc2UuamR0LmNvcmUv
ZG9tL29yZy9lY2xpcHNlL2pkdC9pbnRlcm5hbC9jb3JlL2RvbS9yZXdyaXRlL0FTVFJld3JpdGVG
bGF0dGVuZXIuamF2YQppbmRleCAxNGQyYjU5Li4yOTM4NDVlIDEwMDY0NAotLS0gYS9vcmcuZWNs
aXBzZS5qZHQuY29yZS9kb20vb3JnL2VjbGlwc2UvamR0L2ludGVybmFsL2NvcmUvZG9tL3Jld3Jp
dGUvQVNUUmV3cml0ZUZsYXR0ZW5lci5qYXZhCisrKyBiL29yZy5lY2xpcHNlLmpkdC5jb3JlL2Rv
bS9vcmcvZWNsaXBzZS9qZHQvaW50ZXJuYWwvY29yZS9kb20vcmV3cml0ZS9BU1RSZXdyaXRlRmxh
dHRlbmVyLmphdmEKQEAgLTEsNCArMSw0IEBACiAvKioqKioqKioqKioqKioqKioqKioqKioqKioq
KioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKgotICog
Q29weXJpZ2h0IChjKSAyMDAwLCAyMDEyIElCTSBDb3Jwb3JhdGlvbiBhbmQgb3RoZXJzLgorICog
Q29weXJpZ2h0IChjKSAyMDAwLCAyMDEzIElCTSBDb3Jwb3JhdGlvbiBhbmQgb3RoZXJzLgogICog
QWxsIHJpZ2h0cyByZXNlcnZlZC4gVGhpcyBwcm9ncmFtIGFuZCB0aGUgYWNjb21wYW55aW5nIG1h
dGVyaWFscwogICogYXJlIG1hZGUgYXZhaWxhYmxlIHVuZGVyIHRoZSB0ZXJtcyBvZiB0aGUgRWNs
aXBzZSBQdWJsaWMgTGljZW5zZSB2MS4wCkBAIC0yMjcsNyArMjI3LDE3IEBACiAJCWdldENoaWxk
Tm9kZShub2RlLCBBcnJheVR5cGUuQ09NUE9ORU5UX1RZUEVfUFJPUEVSVFkpLmFjY2VwdCh0aGlz
KTsKIAkJaWYgKG5vZGUuZ2V0QVNUKCkuYXBpTGV2ZWwoKSA+PSBBU1QuSkxTOCkgewotCQkJdmlz
aXRMaXN0KG5vZGUsIEFycmF5VHlwZS5BTk5PVEFUSU9OU19QUk9QRVJUWSwgU3RyaW5nLnZhbHVl
T2YoJyAnKSwgVXRpbC5FTVBUWV9TVFJJTkcsIFN0cmluZy52YWx1ZU9mKCcgJykpOworCQkJdmlz
aXRMaXN0KG5vZGUsIEFycmF5VHlwZS5BTk5PVEFUSU9OU19QUk9QRVJUWSwgU3RyaW5nLnZhbHVl
T2YoJyAnKSwgVXRpbC5FTVBUWV9TVFJJTkcsIFV0aWwuRU1QVFlfU1RSSU5HKTsKIAkJfQogCQl0
aGlzLnJlc3VsdC5hcHBlbmQoIltdIik7IC8vJE5PTi1OTFMtMSQKKwkJcmV0dXJuIGZhbHNlOwor
CX0KKwkKKwlwdWJsaWMgYm9vbGVhbiB2aXNpdChEaW1lbnNpb25UeXBlIG5vZGUpIHsKKwkJdmlz
aXRMaXN0KG5vZGUsIEFycmF5VHlwZS5BTk5PVEFUSU9OU19QUk9QRVJUWSwgU3RyaW5nLnZhbHVl
T2YoJyAnKSwgVXRpbC5FTVBUWV9TVFJJTkcsIFV0aWwuRU1QVFlfU1RSSU5HKTsKKwkJdGhpcy5y
ZXN1bHQuYXBwZW5kKCJbIik7IC8vJE5PTi1OTFMtMSQKKwkJaWYgKG5vZGUuZXhwcmVzc2lvbigp
ICE9IG51bGwpIHsKKwkJCW5vZGUuZXhwcmVzc2lvbigpLmFjY2VwdCh0aGlzKTsKKwkJfQorCQl0
aGlzLnJlc3VsdC5hcHBlbmQoIl0iKTsgLy8kTk9OLU5MUy0xJAogCQlyZXR1cm4gZmFsc2U7CiAJ
fQpAQCAtNzk1LDcgKzgwNSwxMSBAQAogCQl0aGlzLnJlc3VsdC5hcHBlbmQoJyAnKTsKIAkJZ2V0
Q2hpbGROb2RlKG5vZGUsIFNpbmdsZVZhcmlhYmxlRGVjbGFyYXRpb24uTkFNRV9QUk9QRVJUWSku
YWNjZXB0KHRoaXMpOwotCQlpbnQgZXh0cmFEaW1lbnNpb25zPSBnZXRJbnRBdHRyaWJ1dGUobm9k
ZSwgU2luZ2xlVmFyaWFibGVEZWNsYXJhdGlvbi5FWFRSQV9ESU1FTlNJT05TX1BST1BFUlRZKTsK
LQkJZm9yIChpbnQgaSA9IDA7IGkgPCBleHRyYURpbWVuc2lvbnM7IGkrKykgewotCQkJdGhpcy5y
ZXN1bHQuYXBwZW5kKCJbXSIpOyAvLyROT04tTkxTLTEkCisJCWlmIChub2RlLmdldEFTVCgpLmFw
aUxldmVsKCkgPj0gQVNULkpMUzgpIHsKKwkJCXZpc2l0TGlzdChub2RlLCBTaW5nbGVWYXJpYWJs
ZURlY2xhcmF0aW9uLkVYVFJBX0RJTUVOU0lPTl9UWVBFU19QUk9QRVJUWSwgU3RyaW5nLnZhbHVl
T2YoJyAnKSwgVXRpbC5FTVBUWV9TVFJJTkcsIFV0aWwuRU1QVFlfU1RSSU5HKTsKKwkJfSAgZWxz
ZSB7CisJCQlpbnQgZXh0cmFEaW1lbnNpb25zPSBnZXRJbnRBdHRyaWJ1dGUobm9kZSwgU2luZ2xl
VmFyaWFibGVEZWNsYXJhdGlvbi5FWFRSQV9ESU1FTlNJT05TX1BST1BFUlRZKTsKKwkJCWZvciAo
aW50IGkgPSAwOyBpIDwgZXh0cmFEaW1lbnNpb25zOyBpKyspIHsKKwkJCQl0aGlzLnJlc3VsdC5h
cHBlbmQoIltdIik7IC8vJE5PTi1OTFMtMSQKKwkJCX0KIAkJfQogCQlBU1ROb2RlIGluaXRpYWxp
emVyPSBnZXRDaGlsZE5vZGUobm9kZSwgU2luZ2xlVmFyaWFibGVEZWNsYXJhdGlvbi5JTklUSUFM
SVpFUl9QUk9QRVJUWSk7CkBAIC0xMDQwLDcgKzEwNTQsMTEgQEAKIAlwdWJsaWMgYm9vbGVhbiB2
aXNpdChWYXJpYWJsZURlY2xhcmF0aW9uRnJhZ21lbnQgbm9kZSkgewogCQlnZXRDaGlsZE5vZGUo
bm9kZSwgVmFyaWFibGVEZWNsYXJhdGlvbkZyYWdtZW50Lk5BTUVfUFJPUEVSVFkpLmFjY2VwdCh0
aGlzKTsKLQkJaW50IGV4dHJhRGltZW5zaW9ucz0gZ2V0SW50QXR0cmlidXRlKG5vZGUsIFZhcmlh
YmxlRGVjbGFyYXRpb25GcmFnbWVudC5FWFRSQV9ESU1FTlNJT05TX1BST1BFUlRZKTsKLQkJZm9y
IChpbnQgaSA9IDA7IGkgPCBleHRyYURpbWVuc2lvbnM7IGkrKykgewotCQkJdGhpcy5yZXN1bHQu
YXBwZW5kKCJbXSIpOyAvLyROT04tTkxTLTEkCisJCWlmIChub2RlLmdldEFTVCgpLmFwaUxldmVs
KCkgPj0gQVNULkpMUzgpIHsKKwkJCXZpc2l0TGlzdChub2RlLCBWYXJpYWJsZURlY2xhcmF0aW9u
RnJhZ21lbnQuRVhUUkFfRElNRU5TSU9OX1RZUEVTX1BST1BFUlRZLCBTdHJpbmcudmFsdWVPZign
ICcpLCBVdGlsLkVNUFRZX1NUUklORywgVXRpbC5FTVBUWV9TVFJJTkcpOworCQl9IGVsc2Ugewor
CQkJaW50IGV4dHJhRGltZW5zaW9ucz0gZ2V0SW50QXR0cmlidXRlKG5vZGUsIFZhcmlhYmxlRGVj
bGFyYXRpb25GcmFnbWVudC5FWFRSQV9ESU1FTlNJT05TX1BST1BFUlRZKTsKKwkJCWZvciAoaW50
IGkgPSAwOyBpIDwgZXh0cmFEaW1lbnNpb25zOyBpKyspIHsKKwkJCQl0aGlzLnJlc3VsdC5hcHBl
bmQoIltdIik7IC8vJE5PTi1OTFMtMSQKKwkJCX0KIAkJfQogCQlBU1ROb2RlIGluaXRpYWxpemVy
PSBnZXRDaGlsZE5vZGUobm9kZSwgVmFyaWFibGVEZWNsYXJhdGlvbkZyYWdtZW50LklOSVRJQUxJ
WkVSX1BST1BFUlRZKTs=
</data>

          </attachment>
          <attachment
              isobsolete="1"
              ispatch="1"
              isprivate="0"
          >
            <attachid>225453</attachid>
            <date>2013-01-10 10:51:00 -0500</date>
            <delta_ts>2013-01-14 11:02:49 -0500</delta_ts>
            <desc>Updated patch</desc>
            <filename>Fix-for-bug-391895.patch</filename>
            <type>text/plain</type>
            <size>56697</size>
            <attacher name="Jay Arthanareeswaran">jarthana</attacher>
            
              <data encoding="base64">ZGlmZiAtLWdpdCBhL29yZy5lY2xpcHNlLmpkdC5jb3JlLnRlc3RzLm1vZGVsL3NyYy9vcmcvZWNs
aXBzZS9qZHQvY29yZS90ZXN0cy9kb20vQVNUQ29udmVydGVyMTVKTFM4VGVzdC5qYXZhIGIvb3Jn
LmVjbGlwc2UuamR0LmNvcmUudGVzdHMubW9kZWwvc3JjL29yZy9lY2xpcHNlL2pkdC9jb3JlL3Rl
c3RzL2RvbS9BU1RDb252ZXJ0ZXIxNUpMUzhUZXN0LmphdmEKaW5kZXggZjRiMTUyOC4uODc0NjI0
MCAxMDA2NDQKLS0tIGEvb3JnLmVjbGlwc2UuamR0LmNvcmUudGVzdHMubW9kZWwvc3JjL29yZy9l
Y2xpcHNlL2pkdC9jb3JlL3Rlc3RzL2RvbS9BU1RDb252ZXJ0ZXIxNUpMUzhUZXN0LmphdmEKKysr
IGIvb3JnLmVjbGlwc2UuamR0LmNvcmUudGVzdHMubW9kZWwvc3JjL29yZy9lY2xpcHNlL2pkdC9j
b3JlL3Rlc3RzL2RvbS9BU1RDb252ZXJ0ZXIxNUpMUzhUZXN0LmphdmEKQEAgLTUxNyw1ICs1MTcs
NSBAQAogCQltb2RpZmllciA9IChJRXh0ZW5kZWRNb2RpZmllcikgbW9kaWZpZXJzLmdldCgxKTsK
IAkJY2hlY2tTb3VyY2VSYW5nZSgoQVNUTm9kZSkgbW9kaWZpZXIsICJmaW5hbCIsIHNvdXJjZSk7
Ci0JCWFzc2VydEVxdWFscygiV3JvbmcgZGltZW5zaW9uIiwgMSwgc2luZ2xlVmFyaWFibGVEZWNs
YXJhdGlvbi5nZXRFeHRyYURpbWVuc2lvbnMoKSk7CisJCWFzc2VydEVxdWFscygiV3JvbmcgZGlt
ZW5zaW9uIiwgMSwgc2luZ2xlVmFyaWFibGVEZWNsYXJhdGlvbi5nZXRFeHRyYURpbWVuc2lvblR5
cGVzKCkuc2l6ZSgpKTsKIAkJVHlwZSB0eXBlID0gc2luZ2xlVmFyaWFibGVEZWNsYXJhdGlvbi5n
ZXRUeXBlKCk7CiAJCWNoZWNrU291cmNlUmFuZ2UodHlwZSwgIlN0cmluZyIsIHNvdXJjZSk7CkBA
IC0xNzEwLDUgKzE3MTAsNSBAQAogCQlBcnJheVR5cGUgYXJyYXlUeXBlID0gKEFycmF5VHlwZSkg
dHlwZTsKIAkJY2hlY2tTb3VyY2VSYW5nZShhcnJheVR5cGUuZ2V0Q29tcG9uZW50VHlwZSgpLCAi
U3RyaW5nIiwgc291cmNlKTsKLQkJYXNzZXJ0RXF1YWxzKCJXcm9uZyBleHRyYSBkaW1lbnNpb25z
IiwgMSwgc2luZ2xlVmFyaWFibGVEZWNsYXJhdGlvbi5nZXRFeHRyYURpbWVuc2lvbnMoKSk7CisJ
CWFzc2VydEVxdWFscygiV3JvbmcgZXh0cmEgZGltZW5zaW9ucyIsIDEsIHNpbmdsZVZhcmlhYmxl
RGVjbGFyYXRpb24uZ2V0RXh0cmFEaW1lbnNpb25UeXBlcygpLnNpemUoKSk7CiAJfQogCkBAIC0x
NzM4LDUgKzE3MzgsNSBAQAogCQlBcnJheVR5cGUgYXJyYXlUeXBlID0gKEFycmF5VHlwZSkgdHlw
ZTsKIAkJY2hlY2tTb3VyY2VSYW5nZShhcnJheVR5cGUuZ2V0Q29tcG9uZW50VHlwZSgpLCAiU3Ry
aW5nIiwgc291cmNlKTsKLQkJYXNzZXJ0RXF1YWxzKCJXcm9uZyBleHRyYSBkaW1lbnNpb25zIiwg
MCwgc2luZ2xlVmFyaWFibGVEZWNsYXJhdGlvbi5nZXRFeHRyYURpbWVuc2lvbnMoKSk7CisJCWFz
c2VydEVxdWFscygiV3JvbmcgZXh0cmEgZGltZW5zaW9ucyIsIDAsIHNpbmdsZVZhcmlhYmxlRGVj
bGFyYXRpb24uZ2V0RXh0cmFEaW1lbnNpb25UeXBlcygpLnNpemUoKSk7CiAJfQogCS8qKgpkaWZm
IC0tZ2l0IGEvb3JnLmVjbGlwc2UuamR0LmNvcmUudGVzdHMubW9kZWwvc3JjL29yZy9lY2xpcHNl
L2pkdC9jb3JlL3Rlc3RzL2RvbS9BU1RDb252ZXJ0ZXIxOFRlc3QuamF2YSBiL29yZy5lY2xpcHNl
LmpkdC5jb3JlLnRlc3RzLm1vZGVsL3NyYy9vcmcvZWNsaXBzZS9qZHQvY29yZS90ZXN0cy9kb20v
QVNUQ29udmVydGVyMThUZXN0LmphdmEKaW5kZXggM2EzNWU1Ny4uOWVjNDRlNyAxMDA2NDQKLS0t
IGEvb3JnLmVjbGlwc2UuamR0LmNvcmUudGVzdHMubW9kZWwvc3JjL29yZy9lY2xpcHNlL2pkdC9j
b3JlL3Rlc3RzL2RvbS9BU1RDb252ZXJ0ZXIxOFRlc3QuamF2YQorKysgYi9vcmcuZWNsaXBzZS5q
ZHQuY29yZS50ZXN0cy5tb2RlbC9zcmMvb3JnL2VjbGlwc2UvamR0L2NvcmUvdGVzdHMvZG9tL0FT
VENvbnZlcnRlcjE4VGVzdC5qYXZhCkBAIC02MSw1ICs2MSw1IEBACiAJICovCiAJLy8gaHR0cHM6
Ly9idWdzLmVjbGlwc2Uub3JnL2J1Z3Mvc2hvd19idWcuY2dpP2lkPTM5MTg5OAotCXB1YmxpYyB2
b2lkIHRlc3QwMDAxKCkgdGhyb3dzIEphdmFNb2RlbEV4Y2VwdGlvbiB7CisJcHVibGljIHZvaWQg
dGVzdEJ1ZzM5MTg5OCgpIHRocm93cyBKYXZhTW9kZWxFeGNlcHRpb24gewogCQlTdHJpbmcgY29u
dGVudHMgPQogCQkJIiAgICBAamF2YS5sYW5nLmFubm90YXRpb24uVGFyZ2V0IChqYXZhLmxhbmcu
YW5ub3RhdGlvbi5FbGVtZW50VHlwZS5UWVBFX1VTRSlcbiIgKwpkaWZmIC0tZ2l0IGEvb3JnLmVj
bGlwc2UuamR0LmNvcmUudGVzdHMubW9kZWwvc3JjL29yZy9lY2xpcHNlL2pkdC9jb3JlL3Rlc3Rz
L2RvbS9BU1RDb252ZXJ0ZXJBU1Q4VGVzdC5qYXZhIGIvb3JnLmVjbGlwc2UuamR0LmNvcmUudGVz
dHMubW9kZWwvc3JjL29yZy9lY2xpcHNlL2pkdC9jb3JlL3Rlc3RzL2RvbS9BU1RDb252ZXJ0ZXJB
U1Q4VGVzdC5qYXZhCmluZGV4IGE3MjE0MGMuLmJlNDAyNDQgMTAwNjQ0Ci0tLSBhL29yZy5lY2xp
cHNlLmpkdC5jb3JlLnRlc3RzLm1vZGVsL3NyYy9vcmcvZWNsaXBzZS9qZHQvY29yZS90ZXN0cy9k
b20vQVNUQ29udmVydGVyQVNUOFRlc3QuamF2YQorKysgYi9vcmcuZWNsaXBzZS5qZHQuY29yZS50
ZXN0cy5tb2RlbC9zcmMvb3JnL2VjbGlwc2UvamR0L2NvcmUvdGVzdHMvZG9tL0FTVENvbnZlcnRl
ckFTVDhUZXN0LmphdmEKQEAgLTM4LDQgKzM4LDUgQEAKIAlzdGF0aWMgewogLy8JCVRFU1RTX05V
TUJFUlMgPSBuZXcgaW50W10geyAzNTYgfTsKKy8vCQlURVNUU19OQU1FUyA9IG5ldyBTdHJpbmdb
XXsgInRlc3QwMzkzIiB9OwogCX0KIAlwdWJsaWMgc3RhdGljIFRlc3Qgc3VpdGUoKSB7CkBAIC0x
OTkzLDUgKzE5OTQsNSBAQAogCQlhc3NlcnRUcnVlKCJCb3RoIEFTVCB0cmVlcyBzaG91bGQgYmUg
aWRlbnRpY2FsIiwgdmFyaWFibGVEZWNsYXJhdGlvbi5zdWJ0cmVlTWF0Y2gobmV3IEFTVE1hdGNo
ZXIoKSwgbm9kZSkpOwkJLy8kTk9OLU5MUy0xJAogCQljaGVja1NvdXJjZVJhbmdlKG5vZGUsICJm
aW5hbCBTdHJpbmcgcyIsIHNvdXJjZSk7IC8vJE5PTi1OTFMtMSQKLQkJYXNzZXJ0RXF1YWxzKCJX
cm9uZyBkaW1lbnNpb24iLCAwLCBub2RlLmdldEV4dHJhRGltZW5zaW9ucygpKTsgLy8kTk9OLU5M
Uy0xJAorCQlhc3NlcnRFcXVhbHMoIldyb25nIGRpbWVuc2lvbiIsIDAsIG5vZGUuZ2V0RXh0cmFE
aW1lbnNpb25UeXBlcygpLnNpemUoKSk7IC8vJE5PTi1OTFMtMSQKIAl9CiAKQEAgLTI3MTksMTgg
KzI3MjAsMjEgQEAKIAkJbGl0ZXJhbC5zZXRUb2tlbigiMTAiKTsvLyROT04tTkxTLTEkCiAJCWZy
YWdtZW50LnNldEluaXRpYWxpemVyKGxpdGVyYWwpOwotCQlmcmFnbWVudC5zZXRFeHRyYURpbWVu
c2lvbnMoMCk7CisJCWZyYWdtZW50LmdldEV4dHJhRGltZW5zaW9uVHlwZXMoKS5jbGVhcigpOwog
CQlWYXJpYWJsZURlY2xhcmF0aW9uU3RhdGVtZW50IHN0YXRlbWVudCA9IHRoaXMuYXN0Lm5ld1Zh
cmlhYmxlRGVjbGFyYXRpb25TdGF0ZW1lbnQoZnJhZ21lbnQpOwogCQlmcmFnbWVudCA9IHRoaXMu
YXN0Lm5ld1ZhcmlhYmxlRGVjbGFyYXRpb25GcmFnbWVudCgpOwogCQlmcmFnbWVudC5zZXROYW1l
KHRoaXMuYXN0Lm5ld1NpbXBsZU5hbWUoInoiKSk7Ly8kTk9OLU5MUy0xJAogCQlmcmFnbWVudC5z
ZXRJbml0aWFsaXplcih0aGlzLmFzdC5uZXdOdWxsTGl0ZXJhbCgpKTsKLQkJZnJhZ21lbnQuc2V0
RXh0cmFEaW1lbnNpb25zKDEpOworCQlmcmFnbWVudC5nZXRFeHRyYURpbWVuc2lvblR5cGVzKCku
Y2xlYXIoKTsKKwkJZnJhZ21lbnQuZ2V0RXh0cmFEaW1lbnNpb25UeXBlcygpLmFkZCh0aGlzLmFz
dC5uZXdEaW1lbnNpb24obnVsbCkpOwogCQlzdGF0ZW1lbnQuZnJhZ21lbnRzKCkuYWRkKGZyYWdt
ZW50KTsKIAkJZnJhZ21lbnQgPSB0aGlzLmFzdC5uZXdWYXJpYWJsZURlY2xhcmF0aW9uRnJhZ21l
bnQoKTsKIAkJZnJhZ21lbnQuc2V0TmFtZSh0aGlzLmFzdC5uZXdTaW1wbGVOYW1lKCJpIikpOy8v
JE5PTi1OTFMtMSQKLQkJZnJhZ21lbnQuc2V0RXh0cmFEaW1lbnNpb25zKDApOworCQlmcmFnbWVu
dC5nZXRFeHRyYURpbWVuc2lvblR5cGVzKCkuY2xlYXIoKTsKIAkJc3RhdGVtZW50LmZyYWdtZW50
cygpLmFkZChmcmFnbWVudCk7CiAJCWZyYWdtZW50ID0gdGhpcy5hc3QubmV3VmFyaWFibGVEZWNs
YXJhdGlvbkZyYWdtZW50KCk7CiAJCWZyYWdtZW50LnNldE5hbWUodGhpcy5hc3QubmV3U2ltcGxl
TmFtZSgiaiIpKTsvLyROT04tTkxTLTEkCi0JCWZyYWdtZW50LnNldEV4dHJhRGltZW5zaW9ucygy
KTsKKwkJZnJhZ21lbnQuZ2V0RXh0cmFEaW1lbnNpb25UeXBlcygpLmNsZWFyKCk7CisJCWZyYWdt
ZW50LmdldEV4dHJhRGltZW5zaW9uVHlwZXMoKS5hZGQodGhpcy5hc3QubmV3RGltZW5zaW9uKG51
bGwpKTsKKwkJZnJhZ21lbnQuZ2V0RXh0cmFEaW1lbnNpb25UeXBlcygpLmFkZCh0aGlzLmFzdC5u
ZXdEaW1lbnNpb24obnVsbCkpOwogCQlzdGF0ZW1lbnQuZnJhZ21lbnRzKCkuYWRkKGZyYWdtZW50
KTsKIAkJc3RhdGVtZW50LnNldFR5cGUodGhpcy5hc3QubmV3UHJpbWl0aXZlVHlwZShQcmltaXRp
dmVUeXBlLklOVCkpOwpAQCAtMjc1OSwxOCArMjc2MywyMSBAQAogCQlsaXRlcmFsLnNldFRva2Vu
KCIxMCIpOy8vJE5PTi1OTFMtMSQKIAkJZnJhZ21lbnQuc2V0SW5pdGlhbGl6ZXIobGl0ZXJhbCk7
Ci0JCWZyYWdtZW50LnNldEV4dHJhRGltZW5zaW9ucygwKTsKKwkJZnJhZ21lbnQuZ2V0RXh0cmFE
aW1lbnNpb25UeXBlcygpLmNsZWFyKCk7CiAJCVZhcmlhYmxlRGVjbGFyYXRpb25TdGF0ZW1lbnQg
c3RhdGVtZW50ID0gdGhpcy5hc3QubmV3VmFyaWFibGVEZWNsYXJhdGlvblN0YXRlbWVudChmcmFn
bWVudCk7CiAJCWZyYWdtZW50ID0gdGhpcy5hc3QubmV3VmFyaWFibGVEZWNsYXJhdGlvbkZyYWdt
ZW50KCk7CiAJCWZyYWdtZW50LnNldE5hbWUodGhpcy5hc3QubmV3U2ltcGxlTmFtZSgieiIpKTsv
LyROT04tTkxTLTEkCiAJCWZyYWdtZW50LnNldEluaXRpYWxpemVyKHRoaXMuYXN0Lm5ld051bGxM
aXRlcmFsKCkpOwotCQlmcmFnbWVudC5zZXRFeHRyYURpbWVuc2lvbnMoMSk7CisJCWZyYWdtZW50
LmdldEV4dHJhRGltZW5zaW9uVHlwZXMoKS5jbGVhcigpOworCQlmcmFnbWVudC5nZXRFeHRyYURp
bWVuc2lvblR5cGVzKCkuYWRkKHRoaXMuYXN0Lm5ld0RpbWVuc2lvbihudWxsKSk7CiAJCXN0YXRl
bWVudC5mcmFnbWVudHMoKS5hZGQoZnJhZ21lbnQpOwogCQlmcmFnbWVudCA9IHRoaXMuYXN0Lm5l
d1ZhcmlhYmxlRGVjbGFyYXRpb25GcmFnbWVudCgpOwogCQlmcmFnbWVudC5zZXROYW1lKHRoaXMu
YXN0Lm5ld1NpbXBsZU5hbWUoImkiKSk7Ly8kTk9OLU5MUy0xJAotCQlmcmFnbWVudC5zZXRFeHRy
YURpbWVuc2lvbnMoMCk7CisJCWZyYWdtZW50LmdldEV4dHJhRGltZW5zaW9uVHlwZXMoKS5jbGVh
cigpOwogCQlzdGF0ZW1lbnQuZnJhZ21lbnRzKCkuYWRkKGZyYWdtZW50KTsKIAkJZnJhZ21lbnQg
PSB0aGlzLmFzdC5uZXdWYXJpYWJsZURlY2xhcmF0aW9uRnJhZ21lbnQoKTsKIAkJZnJhZ21lbnQu
c2V0TmFtZSh0aGlzLmFzdC5uZXdTaW1wbGVOYW1lKCJqIikpOy8vJE5PTi1OTFMtMSQKLQkJZnJh
Z21lbnQuc2V0RXh0cmFEaW1lbnNpb25zKDIpOworCQlmcmFnbWVudC5nZXRFeHRyYURpbWVuc2lv
blR5cGVzKCkuY2xlYXIoKTsKKwkJZnJhZ21lbnQuZ2V0RXh0cmFEaW1lbnNpb25UeXBlcygpLmFk
ZCh0aGlzLmFzdC5uZXdEaW1lbnNpb24obnVsbCkpOworCQlmcmFnbWVudC5nZXRFeHRyYURpbWVu
c2lvblR5cGVzKCkuYWRkKHRoaXMuYXN0Lm5ld0RpbWVuc2lvbihudWxsKSk7CiAJCXN0YXRlbWVu
dC5mcmFnbWVudHMoKS5hZGQoZnJhZ21lbnQpOwogCQlzdGF0ZW1lbnQuc2V0VHlwZSh0aGlzLmFz
dC5uZXdBcnJheVR5cGUodGhpcy5hc3QubmV3UHJpbWl0aXZlVHlwZShQcmltaXRpdmVUeXBlLklO
VCksIDEpKTsKQEAgLTI3OTgsNSArMjgwNSw2IEBACiAJCXZhcmlhYmxlRGVjbGFyYXRpb25GcmFn
bWVudC5zZXROYW1lKHRoaXMuYXN0Lm5ld1NpbXBsZU5hbWUoInRhYiIpKTsgLy8kTk9OLU5MUy0x
JAogCQl2YXJpYWJsZURlY2xhcmF0aW9uRnJhZ21lbnQuc2V0SW5pdGlhbGl6ZXIodGhpcy5hc3Qu
bmV3TnVsbExpdGVyYWwoKSk7Ly8kTk9OLU5MUy0xJAotCQl2YXJpYWJsZURlY2xhcmF0aW9uRnJh
Z21lbnQuc2V0RXh0cmFEaW1lbnNpb25zKDEpOworCQl2YXJpYWJsZURlY2xhcmF0aW9uRnJhZ21l
bnQuZ2V0RXh0cmFEaW1lbnNpb25UeXBlcygpLmNsZWFyKCk7CisJCXZhcmlhYmxlRGVjbGFyYXRp
b25GcmFnbWVudC5nZXRFeHRyYURpbWVuc2lvblR5cGVzKCkuYWRkKHRoaXMuYXN0Lm5ld0RpbWVu
c2lvbihudWxsKSk7CiAJCVZhcmlhYmxlRGVjbGFyYXRpb25FeHByZXNzaW9uIHZhcmlhYmxlRGVj
bGFyYXRpb25FeHByZXNzaW9uID0gdGhpcy5hc3QubmV3VmFyaWFibGVEZWNsYXJhdGlvbkV4cHJl
c3Npb24odmFyaWFibGVEZWNsYXJhdGlvbkZyYWdtZW50KTsKIAkJdmFyaWFibGVEZWNsYXJhdGlv
bkV4cHJlc3Npb24uc2V0VHlwZSh0aGlzLmFzdC5uZXdBcnJheVR5cGUodGhpcy5hc3QubmV3U2lt
cGxlVHlwZSh0aGlzLmFzdC5uZXdTaW1wbGVOYW1lKCJTdHJpbmciKSksIDEpKTsvLyROT04tTkxT
LTEkCkBAIC0yODI2LDUgKzI4MzQsNiBAQAogCQl2YXJpYWJsZURlY2xhcmF0aW9uRnJhZ21lbnQu
c2V0TmFtZSh0aGlzLmFzdC5uZXdTaW1wbGVOYW1lKCJ0YWIiKSk7IC8vJE5PTi1OTFMtMSQKIAkJ
dmFyaWFibGVEZWNsYXJhdGlvbkZyYWdtZW50LnNldEluaXRpYWxpemVyKHRoaXMuYXN0Lm5ld051
bGxMaXRlcmFsKCkpOy8vJE5PTi1OTFMtMSQKLQkJdmFyaWFibGVEZWNsYXJhdGlvbkZyYWdtZW50
LnNldEV4dHJhRGltZW5zaW9ucygxKTsKKwkJdmFyaWFibGVEZWNsYXJhdGlvbkZyYWdtZW50Lmdl
dEV4dHJhRGltZW5zaW9uVHlwZXMoKS5jbGVhcigpOworCQl2YXJpYWJsZURlY2xhcmF0aW9uRnJh
Z21lbnQuZ2V0RXh0cmFEaW1lbnNpb25UeXBlcygpLmFkZCh0aGlzLmFzdC5uZXdEaW1lbnNpb24o
bnVsbCkpOwogCQlWYXJpYWJsZURlY2xhcmF0aW9uRXhwcmVzc2lvbiB2YXJpYWJsZURlY2xhcmF0
aW9uRXhwcmVzc2lvbiA9IHRoaXMuYXN0Lm5ld1ZhcmlhYmxlRGVjbGFyYXRpb25FeHByZXNzaW9u
KHZhcmlhYmxlRGVjbGFyYXRpb25GcmFnbWVudCk7CiAJCXZhcmlhYmxlRGVjbGFyYXRpb25FeHBy
ZXNzaW9uLnNldFR5cGUodGhpcy5hc3QubmV3U2ltcGxlVHlwZSh0aGlzLmFzdC5uZXdTaW1wbGVO
YW1lKCJTdHJpbmciKSkpOy8vJE5PTi1OTFMtMSQKQEAgLTI4NTQsNSArMjg2Myw2IEBACiAJCXZh
cmlhYmxlRGVjbGFyYXRpb25GcmFnbWVudC5zZXROYW1lKHRoaXMuYXN0Lm5ld1NpbXBsZU5hbWUo
InRhYiIpKTsgLy8kTk9OLU5MUy0xJAogCQl2YXJpYWJsZURlY2xhcmF0aW9uRnJhZ21lbnQuc2V0
SW5pdGlhbGl6ZXIodGhpcy5hc3QubmV3TnVsbExpdGVyYWwoKSk7Ly8kTk9OLU5MUy0xJAotCQl2
YXJpYWJsZURlY2xhcmF0aW9uRnJhZ21lbnQuc2V0RXh0cmFEaW1lbnNpb25zKDEpOworCQl2YXJp
YWJsZURlY2xhcmF0aW9uRnJhZ21lbnQuZ2V0RXh0cmFEaW1lbnNpb25UeXBlcygpLmNsZWFyKCk7
CisJCXZhcmlhYmxlRGVjbGFyYXRpb25GcmFnbWVudC5nZXRFeHRyYURpbWVuc2lvblR5cGVzKCku
YWRkKHRoaXMuYXN0Lm5ld0RpbWVuc2lvbihudWxsKSk7CiAJCVZhcmlhYmxlRGVjbGFyYXRpb25F
eHByZXNzaW9uIHZhcmlhYmxlRGVjbGFyYXRpb25FeHByZXNzaW9uID0gdGhpcy5hc3QubmV3VmFy
aWFibGVEZWNsYXJhdGlvbkV4cHJlc3Npb24odmFyaWFibGVEZWNsYXJhdGlvbkZyYWdtZW50KTsK
IAkJdmFyaWFibGVEZWNsYXJhdGlvbkV4cHJlc3Npb24uc2V0VHlwZSh0aGlzLmFzdC5uZXdTaW1w
bGVUeXBlKHRoaXMuYXN0Lm5ld1NpbXBsZU5hbWUoIlN0cmluZyIpKSk7Ly8kTk9OLU5MUy0xJApA
QCAtMjg4Myw1ICsyODkzLDUgQEAKIAkJVmFyaWFibGVEZWNsYXJhdGlvbkZyYWdtZW50IGZyYWdt
ZW50ID0gdGhpcy5hc3QubmV3VmFyaWFibGVEZWNsYXJhdGlvbkZyYWdtZW50KCk7CiAJCWZyYWdt
ZW50LnNldE5hbWUodGhpcy5hc3QubmV3U2ltcGxlTmFtZSgiaSIpKTsgLy8kTk9OLU5MUy0xJAot
CQlmcmFnbWVudC5zZXRFeHRyYURpbWVuc2lvbnMoMCk7CisJCWZyYWdtZW50LmdldEV4dHJhRGlt
ZW5zaW9uVHlwZXMoKS5jbGVhcigpOwogCQlGaWVsZERlY2xhcmF0aW9uIGZpZWxkRGVjbGFyYXRp
b24gPSB0aGlzLmFzdC5uZXdGaWVsZERlY2xhcmF0aW9uKGZyYWdtZW50KTsKIAkJZmllbGREZWNs
YXJhdGlvbi5zZXRUeXBlKHRoaXMuYXN0Lm5ld1ByaW1pdGl2ZVR5cGUoUHJpbWl0aXZlVHlwZS5J
TlQpKTsKQEAgLTI5MDUsNSArMjkxNSw1IEBACiAJCWxpdGVyYWwuc2V0VG9rZW4oIjEwIik7IC8v
JE5PTi1OTFMtMSQKIAkJZnJhZ21lbnQuc2V0SW5pdGlhbGl6ZXIobGl0ZXJhbCk7Ci0JCWZyYWdt
ZW50LnNldEV4dHJhRGltZW5zaW9ucygwKTsKKwkJZnJhZ21lbnQuZ2V0RXh0cmFEaW1lbnNpb25U
eXBlcygpLmNsZWFyKCk7CiAJCUZpZWxkRGVjbGFyYXRpb24gZmllbGREZWNsYXJhdGlvbiA9IHRo
aXMuYXN0Lm5ld0ZpZWxkRGVjbGFyYXRpb24oZnJhZ21lbnQpOwogCQlmaWVsZERlY2xhcmF0aW9u
Lm1vZGlmaWVycygpLmFkZCh0aGlzLmFzdC5uZXdNb2RpZmllcihNb2RpZmllci5Nb2RpZmllcktl
eXdvcmQuUFVCTElDX0tFWVdPUkQpKTsKQEAgLTI5MTEsMTQgKzI5MjEsMTcgQEAKIAkJZnJhZ21l
bnQgPSB0aGlzLmFzdC5uZXdWYXJpYWJsZURlY2xhcmF0aW9uRnJhZ21lbnQoKTsKIAkJZnJhZ21l
bnQuc2V0TmFtZSh0aGlzLmFzdC5uZXdTaW1wbGVOYW1lKCJ5IikpOy8vJE5PTi1OTFMtMSQKLQkJ
ZnJhZ21lbnQuc2V0RXh0cmFEaW1lbnNpb25zKDEpOworCQlmcmFnbWVudC5nZXRFeHRyYURpbWVu
c2lvblR5cGVzKCkuY2xlYXIoKTsKKwkJZnJhZ21lbnQuZ2V0RXh0cmFEaW1lbnNpb25UeXBlcygp
LmFkZCh0aGlzLmFzdC5uZXdEaW1lbnNpb24obnVsbCkpOwogCQlmcmFnbWVudC5zZXRJbml0aWFs
aXplcih0aGlzLmFzdC5uZXdOdWxsTGl0ZXJhbCgpKTsKIAkJZmllbGREZWNsYXJhdGlvbi5mcmFn
bWVudHMoKS5hZGQoZnJhZ21lbnQpOwogCQlmcmFnbWVudCA9IHRoaXMuYXN0Lm5ld1ZhcmlhYmxl
RGVjbGFyYXRpb25GcmFnbWVudCgpOwogCQlmcmFnbWVudC5zZXROYW1lKHRoaXMuYXN0Lm5ld1Np
bXBsZU5hbWUoImkiKSk7Ly8kTk9OLU5MUy0xJAotCQlmcmFnbWVudC5zZXRFeHRyYURpbWVuc2lv
bnMoMCk7CisJCWZyYWdtZW50LmdldEV4dHJhRGltZW5zaW9uVHlwZXMoKS5jbGVhcigpOwogCQlm
aWVsZERlY2xhcmF0aW9uLmZyYWdtZW50cygpLmFkZChmcmFnbWVudCk7CiAJCWZyYWdtZW50ID0g
dGhpcy5hc3QubmV3VmFyaWFibGVEZWNsYXJhdGlvbkZyYWdtZW50KCk7CiAJCWZyYWdtZW50LnNl
dE5hbWUodGhpcy5hc3QubmV3U2ltcGxlTmFtZSgiaiIpKTsvLyROT04tTkxTLTEkCi0JCWZyYWdt
ZW50LnNldEV4dHJhRGltZW5zaW9ucygyKTsKKwkJZnJhZ21lbnQuZ2V0RXh0cmFEaW1lbnNpb25U
eXBlcygpLmNsZWFyKCk7CisJCWZyYWdtZW50LmdldEV4dHJhRGltZW5zaW9uVHlwZXMoKS5hZGQo
dGhpcy5hc3QubmV3RGltZW5zaW9uKG51bGwpKTsKKwkJZnJhZ21lbnQuZ2V0RXh0cmFEaW1lbnNp
b25UeXBlcygpLmFkZCh0aGlzLmFzdC5uZXdEaW1lbnNpb24obnVsbCkpOwogCQlmaWVsZERlY2xh
cmF0aW9uLmZyYWdtZW50cygpLmFkZChmcmFnbWVudCk7CiAJCWFzc2VydFRydWUoIkJvdGggQVNU
IHRyZWVzIHNob3VsZCBiZSBpZGVudGljYWwiLCBmaWVsZERlY2xhcmF0aW9uLnN1YnRyZWVNYXRj
aChuZXcgQVNUTWF0Y2hlcigpLCBub2RlKSk7CQkvLyROT04tTkxTLTEkCkBAIC05NTg0LDQgKzk1
OTcsNiBAQAogCQlhc3NlcnRFcXVhbHMoIldyb25nIHF1YWxpZmllZCBuYW1lIiwgImphdmEubGFu
Zy5TdHJpbmdbXSIsIHR5cGVCaW5kaW5nMi5nZXRRdWFsaWZpZWROYW1lKCkpOyAvLyROT04tTkxT
LTEkIC8vJE5PTi1OTFMtMiQKIAkJYXNzZXJ0RXF1YWxzKCJXcm9uZyBkaW1lbnNpb24iLCAxLCB0
eXBlQmluZGluZzIuZ2V0RGltZW5zaW9ucygpKTsgLy8kTk9OLU5MUy0xJAorCQlMaXN0IGV4dHJh
RGltZW5zaW9ucyA9IG1ldGhvZERlY2xhcmF0aW9uLmdldGV4dHJhRGltZW5zaW9uVHlwZXMoKTsK
KwkJYXNzZXJ0RXh0cmFEaW1lbnNpb25zRXF1YWwoIldyb25nIGV4dHJhIGRpbWVuc2lvbiBpbmZv
IiwgZXh0cmFEaW1lbnNpb25zLCAiW10gIik7CiAJfQogCkBAIC05NjU2LDUgKzk2NzEsNSBAQAog
CQlUeXBlIHR5cGUgPSBzaW5nbGVWYXJpYWJsZURlY2xhcmF0aW9uLmdldFR5cGUoKTsKIAkJY2hl
Y2tTb3VyY2VSYW5nZSh0eXBlLCAiU3RyaW5nIiwgc291cmNlKTsgLy8kTk9OLU5MUy0xJAotCQlh
c3NlcnRFcXVhbHMoIldyb25nIGRpbWVuc2lvbiIsIDEsIHNpbmdsZVZhcmlhYmxlRGVjbGFyYXRp
b24uZ2V0RXh0cmFEaW1lbnNpb25zKCkpOyAvLyROT04tTkxTLTEkCisJCWFzc2VydEVxdWFscygi
V3JvbmcgZGltZW5zaW9uIiwgMSwgc2luZ2xlVmFyaWFibGVEZWNsYXJhdGlvbi5nZXRFeHRyYURp
bWVuc2lvblR5cGVzKCkuc2l6ZSgpKTsgLy8kTk9OLU5MUy0xJAogCQlJVHlwZUJpbmRpbmcgdHlw
ZUJpbmRpbmcgPSB0eXBlLnJlc29sdmVCaW5kaW5nKCk7CiAJCWFzc2VydE5vdE51bGwoIk5vIHR5
cGUgYmluZGluZyIsIHR5cGVCaW5kaW5nKTsgLy8kTk9OLU5MUy0xJApAQCAtOTY3MCw0ICs5Njg1
LDYgQEAKIAkJYXNzZXJ0RXF1YWxzKCJXcm9uZyBkaW1lbnNpb24iLCAxLCB0eXBlQmluZGluZzIu
Z2V0RGltZW5zaW9ucygpKTsgLy8kTk9OLU5MUy0xJAogCQlhc3NlcnRFcXVhbHMoIndyb25nIGZ1
bGx5IHF1YWxpZmllZCBuYW1lIiwgImphdmEubGFuZy5TdHJpbmdbXSIsIHR5cGVCaW5kaW5nMi5n
ZXRRdWFsaWZpZWROYW1lKCkpOyAvLyROT04tTkxTLTEkIC8vJE5PTi1OTFMtMiQKKwkJTGlzdCBl
eHRyYURpbWVuc2lvbnMgPSBzaW5nbGVWYXJpYWJsZURlY2xhcmF0aW9uLmdldEV4dHJhRGltZW5z
aW9uVHlwZXMoKTsKKwkJYXNzZXJ0RXh0cmFEaW1lbnNpb25zRXF1YWwoIldyb25nIGV4dHJhIGRp
bWVuc2lvbiBpbmZvIiwgZXh0cmFEaW1lbnNpb25zLCAiW10gIik7CiAJfQogCkBAIC05Njg4LDUg
Kzk3MDUsNSBAQAogCQlUeXBlIHR5cGUgPSBzaW5nbGVWYXJpYWJsZURlY2xhcmF0aW9uLmdldFR5
cGUoKTsKIAkJY2hlY2tTb3VyY2VSYW5nZSh0eXBlLCAiU3RyaW5nW10iLCBzb3VyY2UpOyAvLyRO
T04tTkxTLTEkCi0JCWFzc2VydEVxdWFscygiV3JvbmcgZGltZW5zaW9uIiwgMiwgc2luZ2xlVmFy
aWFibGVEZWNsYXJhdGlvbi5nZXRFeHRyYURpbWVuc2lvbnMoKSk7IC8vJE5PTi1OTFMtMSQKKwkJ
YXNzZXJ0RXF1YWxzKCJXcm9uZyBkaW1lbnNpb24iLCAyLCBzaW5nbGVWYXJpYWJsZURlY2xhcmF0
aW9uLmdldEV4dHJhRGltZW5zaW9uVHlwZXMoKS5zaXplKCkpOyAvLyROT04tTkxTLTEkCiAJCUlU
eXBlQmluZGluZyB0eXBlQmluZGluZyA9IHR5cGUucmVzb2x2ZUJpbmRpbmcoKTsKIAkJYXNzZXJ0
Tm90TnVsbCgiTm8gdHlwZSBiaW5kaW5nIiwgdHlwZUJpbmRpbmcpOyAvLyROT04tTkxTLTEkCmRp
ZmYgLS1naXQgYS9vcmcuZWNsaXBzZS5qZHQuY29yZS50ZXN0cy5tb2RlbC9zcmMvb3JnL2VjbGlw
c2UvamR0L2NvcmUvdGVzdHMvZG9tL0FTVENvbnZlcnRlclRlc3RBU1Q4XzIuamF2YSBiL29yZy5l
Y2xpcHNlLmpkdC5jb3JlLnRlc3RzLm1vZGVsL3NyYy9vcmcvZWNsaXBzZS9qZHQvY29yZS90ZXN0
cy9kb20vQVNUQ29udmVydGVyVGVzdEFTVDhfMi5qYXZhCmluZGV4IGVjMmZmN2EuLjJlOGFmNmMg
MTAwNjQ0Ci0tLSBhL29yZy5lY2xpcHNlLmpkdC5jb3JlLnRlc3RzLm1vZGVsL3NyYy9vcmcvZWNs
aXBzZS9qZHQvY29yZS90ZXN0cy9kb20vQVNUQ29udmVydGVyVGVzdEFTVDhfMi5qYXZhCisrKyBi
L29yZy5lY2xpcHNlLmpkdC5jb3JlLnRlc3RzLm1vZGVsL3NyYy9vcmcvZWNsaXBzZS9qZHQvY29y
ZS90ZXN0cy9kb20vQVNUQ29udmVydGVyVGVzdEFTVDhfMi5qYXZhCkBAIC0yNzc1LDUgKzI3NzUs
NSBAQAogCQlhc3NlcnRFcXVhbHMoIndyb25nIHNpemUiLCAxLCBmcmFnbWVudHMuc2l6ZSgpKTsK
IAkJVmFyaWFibGVEZWNsYXJhdGlvbkZyYWdtZW50IGZyYWdtZW50ID0gKFZhcmlhYmxlRGVjbGFy
YXRpb25GcmFnbWVudCkgZnJhZ21lbnRzLmdldCgwKTsKLQkJYXNzZXJ0RXF1YWxzKCJ3cm9uZyBl
eHRyYSBkaW1lbnNpb24iLCAxLCBmcmFnbWVudC5nZXRFeHRyYURpbWVuc2lvbnMoKSk7CisJCWFz
c2VydEVxdWFscygid3JvbmcgZXh0cmEgZGltZW5zaW9uIiwgMSwgZnJhZ21lbnQuZ2V0RXh0cmFE
aW1lbnNpb25UeXBlcygpLnNpemUoKSk7CiAJfQogCmRpZmYgLS1naXQgYS9vcmcuZWNsaXBzZS5q
ZHQuY29yZS50ZXN0cy5tb2RlbC9zcmMvb3JnL2VjbGlwc2UvamR0L2NvcmUvdGVzdHMvZG9tL0Nv
bnZlcnRlclRlc3RTZXR1cC5qYXZhIGIvb3JnLmVjbGlwc2UuamR0LmNvcmUudGVzdHMubW9kZWwv
c3JjL29yZy9lY2xpcHNlL2pkdC9jb3JlL3Rlc3RzL2RvbS9Db252ZXJ0ZXJUZXN0U2V0dXAuamF2
YQppbmRleCBjZGJjNGEwLi5iZjNiOTUzIDEwMDY0NAotLS0gYS9vcmcuZWNsaXBzZS5qZHQuY29y
ZS50ZXN0cy5tb2RlbC9zcmMvb3JnL2VjbGlwc2UvamR0L2NvcmUvdGVzdHMvZG9tL0NvbnZlcnRl
clRlc3RTZXR1cC5qYXZhCisrKyBiL29yZy5lY2xpcHNlLmpkdC5jb3JlLnRlc3RzLm1vZGVsL3Ny
Yy9vcmcvZWNsaXBzZS9qZHQvY29yZS90ZXN0cy9kb20vQ29udmVydGVyVGVzdFNldHVwLmphdmEK
QEAgLTE2LDQgKzE2LDUgQEAKIAogaW1wb3J0IGphdmEuaW8uSU9FeGNlcHRpb247CitpbXBvcnQg
amF2YS51dGlsLkl0ZXJhdG9yOwogaW1wb3J0IGphdmEudXRpbC5MaXN0OwogaW1wb3J0IGphdmEu
dXRpbC5NYXA7CkBAIC0xNDIsNCArMTQzLDIwIEBACiAJfQogCisJcHJvdGVjdGVkIHZvaWQgYXNz
ZXJ0RXh0cmFEaW1lbnNpb25zRXF1YWwoU3RyaW5nIG1lc3NhZ2UsIExpc3QgZGltZW5zaW9ucywg
U3RyaW5nIGV4cGVjdGVkKSB7CisJCVN0cmluZ0J1ZmZlciBidWZmZXIgPSBuZXcgU3RyaW5nQnVm
ZmVyKCk7CisJCUl0ZXJhdG9yIGl0ZXIgPSBkaW1lbnNpb25zLml0ZXJhdG9yKCk7CisJCXdoaWxl
KGl0ZXIuaGFzTmV4dCgpKSB7CisJCQlEaW1lbnNpb25UeXBlIGRpbSA9IChEaW1lbnNpb25UeXBl
KSBpdGVyLm5leHQoKTsKKwkJCUl0ZXJhdG9yIGFubm90YXRpb25zID0gZGltLmFubm90YXRpb25z
KCkuaXRlcmF0b3IoKTsKKwkJCXdoaWxlIChhbm5vdGF0aW9ucy5oYXNOZXh0KCkpIHsKKwkJCQli
dWZmZXIuYXBwZW5kKCdAJyk7CisJCQkJYnVmZmVyLmFwcGVuZCgoKEFubm90YXRpb24pIGFubm90
YXRpb25zLm5leHQoKSkuZ2V0VHlwZU5hbWUoKS5nZXRGdWxseVF1YWxpZmllZE5hbWUoKSk7CisJ
CQkJYnVmZmVyLmFwcGVuZCgnICcpOworCQkJfQorCQkJYnVmZmVyLmFwcGVuZCgiW10gIik7CisJ
CX0KKwkJYXNzZXJ0RXF1YWxzKG1lc3NhZ2UsIGV4cGVjdGVkLCBidWZmZXIudG9TdHJpbmcoKSk7
CisJfQorCiAJcHVibGljIEFTVE5vZGUgcnVuQ29udmVyc2lvbihJQ29tcGlsYXRpb25Vbml0IHVu
aXQsIGJvb2xlYW4gcmVzb2x2ZUJpbmRpbmdzLAogCQkJYm9vbGVhbiBiaW5kaW5nc1JlY292ZXJ5
KSB7CmRpZmYgLS1naXQgYS9vcmcuZWNsaXBzZS5qZHQuY29yZS9kb20vb3JnL2VjbGlwc2UvamR0
L2NvcmUvZG9tL0FTVC5qYXZhIGIvb3JnLmVjbGlwc2UuamR0LmNvcmUvZG9tL29yZy9lY2xpcHNl
L2pkdC9jb3JlL2RvbS9BU1QuamF2YQppbmRleCAwZDVhZWQ1Li44OTQ1MjFmIDEwMDY0NAotLS0g
YS9vcmcuZWNsaXBzZS5qZHQuY29yZS9kb20vb3JnL2VjbGlwc2UvamR0L2NvcmUvZG9tL0FTVC5q
YXZhCisrKyBiL29yZy5lY2xpcHNlLmpkdC5jb3JlL2RvbS9vcmcvZWNsaXBzZS9qZHQvY29yZS9k
b20vQVNULmphdmEKQEAgLTExMTUsNCArMTExNSwyNiBAQAogCQlyZXR1cm4gcmVzdWx0OwogCX0K
KwkKKwkvKioKKwkgKiBDcmVhdGVzIGFuZCByZXR1cm5zIGEgbmV3IHVucGFyZW50ZWQgYW5ub3Rh
dGFibGUgZGltZW5zaW9uIHR5cGUgbm9kZSB3aXRoIHRoZSBnaXZlbgorCSAqIGFycmF5IG9mIGFu
bm90YXRpb25zLgorCSAqCisJICogQHBhcmFtIGFubm90YXRpb25zIHRoZSBsaXN0IG9mIGFubm90
YXRpb25zIHRoYXQgd2lsbCBiZSBhZGRlZCB0byB0aGlzIGRpbWVuc2lvbiB0eXBlCisJICogQHJl
dHVybiBhIG5ldyB1bnBhcmVudGVkIGFubm90YXRhYmxlIGRpbWVuc2lvbiB0eXBlIG5vZGUKKwkg
KiBAZXhjZXB0aW9uIElsbGVnYWxBcmd1bWVudEV4Y2VwdGlvbiBpZjoKKwkgKiA8dWw+CisJICog
PGxpPnRoZSBub2RlIGJlbG9uZ3MgdG8gYSBkaWZmZXJlbnQgQVNUPC9saT4KKwkgKiA8bGk+dGhl
IG5vZGUgYWxyZWFkeSBoYXMgYSBwYXJlbnQ8L2xpPgorCSAqIDwvdWw+CisJICogQHNpbmNlIDMu
OQorCSAqLworCXB1YmxpYyBEaW1lbnNpb25UeXBlIG5ld0RpbWVuc2lvbihBbm5vdGF0aW9uW10g
YW5ub3RhdGlvbnMpIHsKKwkJRGltZW5zaW9uVHlwZSByZXN1bHQgPSBuZXcgRGltZW5zaW9uVHlw
ZSh0aGlzKTsKKwkJaW50IGxlbmd0aCA9IChhbm5vdGF0aW9ucyA9PSBudWxsKSA/IDAgOiBhbm5v
dGF0aW9ucy5sZW5ndGg7CisJCWZvciAoaW50IGkgPSAwOyBpIDwgbGVuZ3RoOyBpKyspIHsKKwkJ
CXJlc3VsdC5hbm5vdGF0aW9ucy5hZGQoYW5ub3RhdGlvbnNbaV0pOworCQl9CisJCXJldHVybiBy
ZXN1bHQ7CisJfQogCiAJLyoqCmRpZmYgLS1naXQgYS9vcmcuZWNsaXBzZS5qZHQuY29yZS9kb20v
b3JnL2VjbGlwc2UvamR0L2NvcmUvZG9tL0FTVENvbnZlcnRlci5qYXZhIGIvb3JnLmVjbGlwc2Uu
amR0LmNvcmUvZG9tL29yZy9lY2xpcHNlL2pkdC9jb3JlL2RvbS9BU1RDb252ZXJ0ZXIuamF2YQpp
bmRleCBhNTg0MTdiLi4xMzRlZTc3IDEwMDY0NAotLS0gYS9vcmcuZWNsaXBzZS5qZHQuY29yZS9k
b20vb3JnL2VjbGlwc2UvamR0L2NvcmUvZG9tL0FTVENvbnZlcnRlci5qYXZhCisrKyBiL29yZy5l
Y2xpcHNlLmpkdC5jb3JlL2RvbS9vcmcvZWNsaXBzZS9qZHQvY29yZS9kb20vQVNUQ29udmVydGVy
LmphdmEKQEAgLTQ5MSw0ICs0OTEsOCBAQAogCQkJCWludCBleHRyYURpbWVuc2lvbnMgPSByZXRy
aWV2ZUV4dHJhRGltZW5zaW9uKHJpZ2h0UGFyZW50aGVzaXNQb3NpdGlvbiwgbWV0aG9kLmJvZHlF
bmQpOwogCQkJCW1ldGhvZERlY2wuc2V0RXh0cmFEaW1lbnNpb25zKGV4dHJhRGltZW5zaW9ucyk7
CisJCQkJLy8gVE9ETzogQW5ub3RhdGlvbnMgb24gZXh0cmEgZGltZW5zaW9ucyB0byBiZSByZW1v
dmVkIChidWcgMzkxODk1LCBjb21tZW50IDYKKwkJCQlpZiAodGhpcy5hc3QuYXBpTGV2ZWwgPj0g
QVNULkpMUzgpIHsKKwkJCQkJc2V0RXh0cmFBbm5vdGF0ZWREaW1lbnNpb25zKHJpZ2h0UGFyZW50
aGVzaXNQb3NpdGlvbiwgdGhpcy5zY2FubmVyLmN1cnJlbnRQb3NpdGlvbiwgIHR5cGVSZWZlcmVu
Y2UsIG1ldGhvZERlY2wuZXh0cmFEaW1lbnNpb25UeXBlcywgZXh0cmFEaW1lbnNpb25zKTsKKwkJ
CQl9CiAJCQkJc2V0VHlwZUZvck1ldGhvZERlY2xhcmF0aW9uKG1ldGhvZERlY2wsIHJldHVyblR5
cGUsIGV4dHJhRGltZW5zaW9ucyk7CiAJCQl9IGVsc2UgewpAQCAtNzgxLDUgKzc4NSw5IEBACiAJ
CWZpbmFsIGludCB0eXBlU291cmNlRW5kID0gYXJndW1lbnQudHlwZS5zb3VyY2VFbmQ7CiAJCWZp
bmFsIGludCBleHRyYURpbWVuc2lvbnMgPSByZXRyaWV2ZUV4dHJhRGltZW5zaW9uKG5hbWVFbmQg
KyAxLCB0eXBlU291cmNlRW5kKTsKLQkJdmFyaWFibGVEZWNsLnNldEV4dHJhRGltZW5zaW9ucyhl
eHRyYURpbWVuc2lvbnMpOworCQlpZiAodGhpcy5hc3QuYXBpTGV2ZWwgPj0gQVNULkpMUzgpIHsK
KwkJCXNldEV4dHJhQW5ub3RhdGVkRGltZW5zaW9ucyhuYW1lRW5kICsgMSwgdGhpcy5zY2FubmVy
LmN1cnJlbnRQb3NpdGlvbiwgIGFyZ3VtZW50LnR5cGUsIHZhcmlhYmxlRGVjbC5leHRyYURpbWVu
c2lvblR5cGVzLCBleHRyYURpbWVuc2lvbnMpOworCQl9IGVsc2UgeworCQkJdmFyaWFibGVEZWNs
LnNldEV4dHJhRGltZW5zaW9ucyhleHRyYURpbWVuc2lvbnMpOworCQl9CiAJCWZpbmFsIGJvb2xl
YW4gaXNWYXJBcmdzID0gYXJndW1lbnQuaXNWYXJBcmdzKCk7CiAJCWlmIChpc1ZhckFyZ3MgJiYg
ZXh0cmFEaW1lbnNpb25zID09IDApIHsKQEAgLTI5MDAsNSArMjkwOCw2IEBACiAJCWZpZWxkRGVj
bGFyYXRpb24uc2V0U291cmNlUmFuZ2UoZmllbGREZWNsLmRlY2xhcmF0aW9uU291cmNlU3RhcnQs
IGZpZWxkRGVjbC5kZWNsYXJhdGlvbkVuZCAtIGZpZWxkRGVjbC5kZWNsYXJhdGlvblNvdXJjZVN0
YXJ0ICsgMSk7CiAJCVR5cGUgdHlwZSA9IGNvbnZlcnRUeXBlKGZpZWxkRGVjbC50eXBlKTsKLQkJ
c2V0VHlwZUZvckZpZWxkKGZpZWxkRGVjbGFyYXRpb24sIHR5cGUsIHZhcmlhYmxlRGVjbGFyYXRp
b25GcmFnbWVudC5nZXRFeHRyYURpbWVuc2lvbnMoKSk7CisJCXNldFR5cGVGb3JGaWVsZChmaWVs
ZERlY2xhcmF0aW9uLCB0eXBlLCAKKwkJCQkodGhpcy5hc3QuYXBpTGV2ZWwgPCBBU1QuSkxTOCkg
PyB2YXJpYWJsZURlY2xhcmF0aW9uRnJhZ21lbnQuZ2V0RXh0cmFEaW1lbnNpb25zKCkgOiB2YXJp
YWJsZURlY2xhcmF0aW9uRnJhZ21lbnQuZ2V0RXh0cmFEaW1lbnNpb25UeXBlcygpLnNpemUoKSk7
CiAJCXNldE1vZGlmaWVycyhmaWVsZERlY2xhcmF0aW9uLCBmaWVsZERlY2wpOwogCQljb252ZXJ0
KGZpZWxkRGVjbC5qYXZhZG9jLCBmaWVsZERlY2xhcmF0aW9uKTsKQEAgLTI5MzEsNSArMjk0MCw2
IEBACiAJCXZhcmlhYmxlRGVjbGFyYXRpb25FeHByZXNzaW9uLnNldFNvdXJjZVJhbmdlKGxvY2Fs
RGVjbGFyYXRpb24uZGVjbGFyYXRpb25Tb3VyY2VTdGFydCwgbG9jYWxEZWNsYXJhdGlvbi5kZWNs
YXJhdGlvblNvdXJjZUVuZCAtIGxvY2FsRGVjbGFyYXRpb24uZGVjbGFyYXRpb25Tb3VyY2VTdGFy
dCArIDEpOwogCQlUeXBlIHR5cGUgPSBjb252ZXJ0VHlwZShsb2NhbERlY2xhcmF0aW9uLnR5cGUp
OwotCQlzZXRUeXBlRm9yVmFyaWFibGVEZWNsYXJhdGlvbkV4cHJlc3Npb24odmFyaWFibGVEZWNs
YXJhdGlvbkV4cHJlc3Npb24sIHR5cGUsIHZhcmlhYmxlRGVjbGFyYXRpb25GcmFnbWVudC5nZXRF
eHRyYURpbWVuc2lvbnMoKSk7CisJCXNldFR5cGVGb3JWYXJpYWJsZURlY2xhcmF0aW9uRXhwcmVz
c2lvbih2YXJpYWJsZURlY2xhcmF0aW9uRXhwcmVzc2lvbiwgdHlwZSwgCisJCQkJKHRoaXMuYXN0
LmFwaUxldmVsIDwgQVNULkpMUzgpID8gdmFyaWFibGVEZWNsYXJhdGlvbkZyYWdtZW50LmdldEV4
dHJhRGltZW5zaW9ucygpIDogdmFyaWFibGVEZWNsYXJhdGlvbkZyYWdtZW50LmdldEV4dHJhRGlt
ZW5zaW9uVHlwZXMoKS5zaXplKCkpOwogCQlpZiAobG9jYWxEZWNsYXJhdGlvbi5tb2RpZmllcnNT
b3VyY2VTdGFydCAhPSAtMSkgewogCQkJc2V0TW9kaWZpZXJzKHZhcmlhYmxlRGVjbGFyYXRpb25F
eHByZXNzaW9uLCBsb2NhbERlY2xhcmF0aW9uKTsKQEAgLTI5NDgsNSArMjk1OCw5IEBACiAJCXZh
cmlhYmxlRGVjbC5zZXROYW1lKG5hbWUpOwogCQlmaW5hbCBpbnQgZXh0cmFEaW1lbnNpb25zID0g
cmV0cmlldmVFeHRyYURpbWVuc2lvbihuYW1lRW5kICsgMSwgbG9jYWxEZWNsYXJhdGlvbi50eXBl
LnNvdXJjZUVuZCk7Ci0JCXZhcmlhYmxlRGVjbC5zZXRFeHRyYURpbWVuc2lvbnMoZXh0cmFEaW1l
bnNpb25zKTsKKwkJaWYgKHRoaXMuYXN0LmFwaUxldmVsID49IEFTVC5KTFM4KSB7CisJCQlzZXRF
eHRyYUFubm90YXRlZERpbWVuc2lvbnMobmFtZUVuZCArIDEsIHRoaXMuc2Nhbm5lci5jdXJyZW50
UG9zaXRpb24sICBsb2NhbERlY2xhcmF0aW9uLnR5cGUsIHZhcmlhYmxlRGVjbC5leHRyYURpbWVu
c2lvblR5cGVzLCBleHRyYURpbWVuc2lvbnMpOworCQl9IGVsc2UgeworCQkJdmFyaWFibGVEZWNs
LnNldEV4dHJhRGltZW5zaW9ucyhleHRyYURpbWVuc2lvbnMpOworCQl9CiAJCVR5cGUgdHlwZSA9
IGNvbnZlcnRUeXBlKGxvY2FsRGVjbGFyYXRpb24udHlwZSk7CiAJCWludCB0eXBlRW5kID0gdHlw
ZS5nZXRTdGFydFBvc2l0aW9uKCkgKyB0eXBlLmdldExlbmd0aCgpIC0gMTsKQEAgLTI5NjYsNCAr
Mjk4MCwxNSBAQAogCX0KIAorCXByaXZhdGUgRGltZW5zaW9uVHlwZSBjb252ZXJ0VG9EaW1lbnNp
b24oaW50IHN0YXJ0LCBpbnQgZW5kLCBvcmcuZWNsaXBzZS5qZHQuaW50ZXJuYWwuY29tcGlsZXIu
YXN0LkFubm90YXRpb25bXSBhbm5vdGF0aW9uKSB7CisJCWludCBsZW5ndGggPSBhbm5vdGF0aW9u
ID09IG51bGwgPyAwIDogYW5ub3RhdGlvbi5sZW5ndGg7CisJCUFubm90YXRpb25bXSBhbm5vdGF0
aW9ucyA9IG5ldyBBbm5vdGF0aW9uW2xlbmd0aF07CisJCWZvciAoaW50IGkgPSAwOyBpIDwgbGVu
Z3RoOyBpKyspIHsKKwkJCWFubm90YXRpb25zW2ldID0gY29udmVydChhbm5vdGF0aW9uW2ldKTsK
KwkJfQorCQlEaW1lbnNpb25UeXBlIGRpbWVuc2lvbiA9IHRoaXMuYXN0Lm5ld0RpbWVuc2lvbihh
bm5vdGF0aW9ucyk7CisJCXJldHJpZXZlRGltZW5zaW9uQW5kU2V0UG9zaXRpb25zKHN0YXJ0LCBl
bmQsIGRpbWVuc2lvbik7CisJCXJldHVybiBkaW1lbnNpb247CisJfQorCiAJcHJvdGVjdGVkIFZh
cmlhYmxlRGVjbGFyYXRpb25GcmFnbWVudCBjb252ZXJ0VG9WYXJpYWJsZURlY2xhcmF0aW9uRnJh
Z21lbnQob3JnLmVjbGlwc2UuamR0LmludGVybmFsLmNvbXBpbGVyLmFzdC5GaWVsZERlY2xhcmF0
aW9uIGZpZWxkRGVjbGFyYXRpb24pIHsKIAkJZmluYWwgVmFyaWFibGVEZWNsYXJhdGlvbkZyYWdt
ZW50IHZhcmlhYmxlRGVjbGFyYXRpb25GcmFnbWVudCA9IG5ldyBWYXJpYWJsZURlY2xhcmF0aW9u
RnJhZ21lbnQodGhpcy5hc3QpOwpAQCAtMjk3NSw1ICszMDAwLDkgQEAKIAkJaW50IGVuZCA9IHN0
YXJ0OwogCQlpbnQgZXh0cmFEaW1lbnNpb25zID0gcmV0cmlldmVFeHRyYURpbWVuc2lvbihmaWVs
ZERlY2xhcmF0aW9uLnNvdXJjZUVuZCArIDEsIGZpZWxkRGVjbGFyYXRpb24uZGVjbGFyYXRpb25T
b3VyY2VFbmQgKTsKLQkJdmFyaWFibGVEZWNsYXJhdGlvbkZyYWdtZW50LnNldEV4dHJhRGltZW5z
aW9ucyhleHRyYURpbWVuc2lvbnMpOworCQlpZiAodGhpcy5hc3QuYXBpTGV2ZWwgPj0gQVNULkpM
UzgpIHsKKwkJCXNldEV4dHJhQW5ub3RhdGVkRGltZW5zaW9ucyhmaWVsZERlY2xhcmF0aW9uLnNv
dXJjZUVuZCArIDEsIHRoaXMuc2Nhbm5lci5jdXJyZW50UG9zaXRpb24sIGZpZWxkRGVjbGFyYXRp
b24udHlwZSwgdmFyaWFibGVEZWNsYXJhdGlvbkZyYWdtZW50LmV4dHJhRGltZW5zaW9uVHlwZXMs
IGV4dHJhRGltZW5zaW9ucyk7CisJCX0gZWxzZSB7CisJCQl2YXJpYWJsZURlY2xhcmF0aW9uRnJh
Z21lbnQuc2V0RXh0cmFEaW1lbnNpb25zKGV4dHJhRGltZW5zaW9ucyk7CisJCX0KIAkJaWYgKGZp
ZWxkRGVjbGFyYXRpb24uaW5pdGlhbGl6YXRpb24gIT0gbnVsbCkgewogCQkJZmluYWwgRXhwcmVz
c2lvbiBleHByZXNzaW9uID0gY29udmVydChmaWVsZERlY2xhcmF0aW9uLmluaXRpYWxpemF0aW9u
KTsKQEAgLTMwMTMsNSArMzA0MiwxMCBAQAogCQlvcmcuZWNsaXBzZS5qZHQuaW50ZXJuYWwuY29t
cGlsZXIuYXN0LkV4cHJlc3Npb24gaW5pdGlhbGl6YXRpb24gPSBsb2NhbERlY2xhcmF0aW9uLmlu
aXRpYWxpemF0aW9uOwogCQlpbnQgZXh0cmFEaW1lbnNpb24gPSByZXRyaWV2ZUV4dHJhRGltZW5z
aW9uKGxvY2FsRGVjbGFyYXRpb24uc291cmNlRW5kICsgMSwgdGhpcy5jb21waWxhdGlvblVuaXRT
b3VyY2VMZW5ndGgpOwotCQl2YXJpYWJsZURlY2xhcmF0aW9uRnJhZ21lbnQuc2V0RXh0cmFEaW1l
bnNpb25zKGV4dHJhRGltZW5zaW9uKTsKKwkJaWYgKHRoaXMuYXN0LmFwaUxldmVsID49IEFTVC5K
TFM4KSB7CisJCQlzZXRFeHRyYUFubm90YXRlZERpbWVuc2lvbnMobG9jYWxEZWNsYXJhdGlvbi5z
b3VyY2VFbmQgKyAxLCB0aGlzLnNjYW5uZXIuY3VycmVudFBvc2l0aW9uLCBsb2NhbERlY2xhcmF0
aW9uLnR5cGUsIHZhcmlhYmxlRGVjbGFyYXRpb25GcmFnbWVudC5leHRyYURpbWVuc2lvblR5cGVz
LCBleHRyYURpbWVuc2lvbik7CisJCX0gZWxzZSB7CisJCQl2YXJpYWJsZURlY2xhcmF0aW9uRnJh
Z21lbnQuc2V0RXh0cmFEaW1lbnNpb25zKGV4dHJhRGltZW5zaW9uKTsKKwkJfQorCQkKIAkJYm9v
bGVhbiBoYXNJbml0aWFsaXphdGlvbiA9IGluaXRpYWxpemF0aW9uICE9IG51bGw7CiAJCWludCBl
bmQ7CkBAIC0zMDQ0LDQgKzMwNzgsMTYgQEAKIAl9CiAKKwlwcm90ZWN0ZWQgdm9pZCBzZXRFeHRy
YUFubm90YXRlZERpbWVuc2lvbnMoaW50IHN0YXJ0LCBpbnQgZW5kLCBUeXBlUmVmZXJlbmNlIHR5
cGUsIGZpbmFsIExpc3QgZXh0cmFBbm5vdGF0ZWREaW1lbnNpb25zLCBpbnQgZXh0cmFEaW1lbnNp
b24pIHsKKwkJaWYgKGV4dHJhRGltZW5zaW9uID4gMCkgeworCQkJb3JnLmVjbGlwc2UuamR0Lmlu
dGVybmFsLmNvbXBpbGVyLmFzdC5Bbm5vdGF0aW9uW11bXSBhbm5vdGF0aW9uc09uRGltcyA9IHR5
cGUuZ2V0QW5ub3RhdGlvbnNPbkRpbWVuc2lvbnMoKTsKKwkJCWludCBsZW5ndGggPSAoYW5ub3Rh
dGlvbnNPbkRpbXMgPT0gbnVsbCkgPyAwIDogYW5ub3RhdGlvbnNPbkRpbXMubGVuZ3RoOworCQkJ
Zm9yIChpbnQgaSA9IChsZW5ndGggLSBleHRyYURpbWVuc2lvbik7IGkgPCBsZW5ndGg7IGkrKykg
eworCQkJCURpbWVuc2lvblR5cGUgZGltID0gY29udmVydFRvRGltZW5zaW9uKHN0YXJ0LCBlbmQs
IChhbm5vdGF0aW9uc09uRGltcyA9PSBudWxsKSA/IG51bGwgOiBhbm5vdGF0aW9uc09uRGltc1tp
XSk7CisJCQkJZXh0cmFBbm5vdGF0ZWREaW1lbnNpb25zLmFkZChkaW0pOworCQkJCXN0YXJ0ID0g
ZGltLmdldFN0YXJ0UG9zaXRpb24oKSArIGRpbS5nZXRMZW5ndGgoKTsKKwkJCX0KKwkJfQorCX0K
KwogCXByb3RlY3RlZCBWYXJpYWJsZURlY2xhcmF0aW9uU3RhdGVtZW50IGNvbnZlcnRUb1Zhcmlh
YmxlRGVjbGFyYXRpb25TdGF0ZW1lbnQob3JnLmVjbGlwc2UuamR0LmludGVybmFsLmNvbXBpbGVy
LmFzdC5Mb2NhbERlY2xhcmF0aW9uIGxvY2FsRGVjbGFyYXRpb24pIHsKIAkJZmluYWwgVmFyaWFi
bGVEZWNsYXJhdGlvbkZyYWdtZW50IHZhcmlhYmxlRGVjbGFyYXRpb25GcmFnbWVudCA9IGNvbnZl
cnRUb1ZhcmlhYmxlRGVjbGFyYXRpb25GcmFnbWVudChsb2NhbERlY2xhcmF0aW9uKTsKQEAgLTMw
NTMsNSArMzA5OSw2IEBACiAJCXZhcmlhYmxlRGVjbGFyYXRpb25TdGF0ZW1lbnQuc2V0U291cmNl
UmFuZ2UobG9jYWxEZWNsYXJhdGlvbi5kZWNsYXJhdGlvblNvdXJjZVN0YXJ0LCBsb2NhbERlY2xh
cmF0aW9uLmRlY2xhcmF0aW9uU291cmNlRW5kIC0gbG9jYWxEZWNsYXJhdGlvbi5kZWNsYXJhdGlv
blNvdXJjZVN0YXJ0ICsgMSk7CiAJCVR5cGUgdHlwZSA9IGNvbnZlcnRUeXBlKGxvY2FsRGVjbGFy
YXRpb24udHlwZSk7Ci0JCXNldFR5cGVGb3JWYXJpYWJsZURlY2xhcmF0aW9uU3RhdGVtZW50KHZh
cmlhYmxlRGVjbGFyYXRpb25TdGF0ZW1lbnQsIHR5cGUsIHZhcmlhYmxlRGVjbGFyYXRpb25GcmFn
bWVudC5nZXRFeHRyYURpbWVuc2lvbnMoKSk7CisJCXNldFR5cGVGb3JWYXJpYWJsZURlY2xhcmF0
aW9uU3RhdGVtZW50KHZhcmlhYmxlRGVjbGFyYXRpb25TdGF0ZW1lbnQsIHR5cGUsIAorCQkJCSh0
aGlzLmFzdC5hcGlMZXZlbCA8IEFTVC5KTFM4KSA/IHZhcmlhYmxlRGVjbGFyYXRpb25GcmFnbWVu
dC5nZXRFeHRyYURpbWVuc2lvbnMoKSA6IHZhcmlhYmxlRGVjbGFyYXRpb25GcmFnbWVudC5nZXRF
eHRyYURpbWVuc2lvblR5cGVzKCkuc2l6ZSgpKTsKIAkJaWYgKGxvY2FsRGVjbGFyYXRpb24ubW9k
aWZpZXJzU291cmNlU3RhcnQgIT0gLTEpIHsKIAkJCXNldE1vZGlmaWVycyh2YXJpYWJsZURlY2xh
cmF0aW9uU3RhdGVtZW50LCBsb2NhbERlY2xhcmF0aW9uKTsKQEAgLTQyNTUsNCArNDMwMiw1IEBA
CiAJCXRyeSB7CiAJCQlpbnQgdG9rZW47CisJCQlib29sZWFuIGlzQW5ub3RhdGlvbiA9IGZhbHNl
OwogCQkJd2hpbGUgKCh0b2tlbiA9IHRoaXMuc2Nhbm5lci5nZXROZXh0VG9rZW4oKSkgIT0gVGVy
bWluYWxUb2tlbnMuVG9rZW5OYW1lRU9GKSB7CiAJCQkJc3dpdGNoKHRva2VuKSB7CkBAIC00MjYx
LDYgKzQzMDksMTcgQEAKIAkJCQkJY2FzZSBUZXJtaW5hbFRva2Vucy5Ub2tlbk5hbWVDT01NRU5U
X0pBVkFET0M6CiAJCQkJCWNhc2UgVGVybWluYWxUb2tlbnMuVG9rZW5OYW1lQ09NTUVOVF9MSU5F
OgorCQkJCQkJaXNBbm5vdGF0aW9uID0gZmFsc2U7CisJCQkJCQlicmVhazsKKwkJCQkJY2FzZSBU
ZXJtaW5hbFRva2Vucy5Ub2tlbk5hbWVBVDoKKwkJCQkJCWlzQW5ub3RhdGlvbiA9IHRydWU7CisJ
CQkJCQlicmVhazsKKwkJCQkJY2FzZSBUZXJtaW5hbFRva2Vucy5Ub2tlbk5hbWVJZGVudGlmaWVy
OgorCQkJCQkJaWYgKCFpc0Fubm90YXRpb24pIHsKKwkJCQkJCQlyZXR1cm4gZGltZW5zaW9uczsK
KwkJCQkJCX0KKwkJCQkJCWlzQW5ub3RhdGlvbiA9IGZhbHNlOwogCQkJCQkJYnJlYWs7CiAJCQkJ
CWNhc2UgVGVybWluYWxUb2tlbnMuVG9rZW5OYW1lUkJSQUNLRVQ6Ly8xNjYKKwkJCQkJCWlzQW5u
b3RhdGlvbiA9IGZhbHNlOwogCQkJCQkJZGltZW5zaW9ucysrOwogCQkJCQkJYnJlYWs7CkBAIC00
Mjc1LDQgKzQzMzQsMzAgQEAKIAl9CiAKKwlwcm90ZWN0ZWQgdm9pZCByZXRyaWV2ZURpbWVuc2lv
bkFuZFNldFBvc2l0aW9ucyhpbnQgc3RhcnQsIGludCBlbmQsIERpbWVuc2lvblR5cGUgZGltKSB7
CisJCXRoaXMuc2Nhbm5lci5yZXNldFRvKHN0YXJ0LCBlbmQpOworCQlpbnQgdG9rZW47CisJCWJv
b2xlYW4gc3RhcnRTZXQgPSBmYWxzZTsKKwkJdHJ5IHsKKwkJCXdoaWxlKCh0b2tlbiA9IHRoaXMu
c2Nhbm5lci5nZXROZXh0VG9rZW4oKSkgIT0gVGVybWluYWxUb2tlbnMuVG9rZW5OYW1lRU9GKSAg
eworCQkJCXN3aXRjaCh0b2tlbikgeworCQkJCQljYXNlIFRlcm1pbmFsVG9rZW5zLlRva2VuTmFt
ZVdISVRFU1BBQ0U6CisJCQkJCQlicmVhazsKKwkJCQkJY2FzZSBUZXJtaW5hbFRva2Vucy5Ub2tl
bk5hbWVSQlJBQ0tFVDoKKwkJCQkJCWludCBlbmREaW0gPSB0aGlzLnNjYW5uZXIuY3VycmVudFBv
c2l0aW9uIC0gMTsKKwkJCQkJCWRpbS5zZXRTb3VyY2VSYW5nZShzdGFydCwgZW5kRGltIC0gc3Rh
cnQgKyAxKTsKKwkJCQkJCXJldHVybjsKKwkJCQkJZGVmYXVsdDoKKwkJCQkJCWlmICghc3RhcnRT
ZXQpIHsKKwkJCQkJCQlzdGFydCA9IHRoaXMuc2Nhbm5lci5zdGFydFBvc2l0aW9uOworCQkJCQkJ
CXN0YXJ0U2V0ID0gdHJ1ZTsKKwkJCQkJCX0KKwkJCQkJCWJyZWFrOworCQkJCQkJCisJCQkJfQor
CQkJfQorCQl9IGNhdGNoKEludmFsaWRJbnB1dEV4Y2VwdGlvbiBlKSB7CisJCQkvLyBpZ25vcmUK
KwkJfQorCX0KIAlwcm90ZWN0ZWQgdm9pZCByZXRyaWV2ZUlkZW50aWZpZXJBbmRTZXRQb3NpdGlv
bnMoaW50IHN0YXJ0LCBpbnQgZW5kLCBOYW1lIG5hbWUpIHsKIAkJdGhpcy5zY2FubmVyLnJlc2V0
VG8oc3RhcnQsIGVuZCk7CkBAIC01MjEyLDUgKzUyOTcsNSBAQAogCQkJCQkJZGVmYXVsdCA6CiAJ
CQkJCQkJbWV0aG9kRGVjbGFyYXRpb24uc2V0UmV0dXJuVHlwZTIoc3ViYXJyYXlUeXBlKTsKLQkJ
CQkJCWJyZWFrOworCQkJCQkJCWJyZWFrOwogCQkJCQl9CiAJCQkJCXRoaXMuYXN0LmdldEJpbmRp
bmdSZXNvbHZlcigpLnVwZGF0ZUtleSh0eXBlLCBzdWJhcnJheVR5cGUpOwpkaWZmIC0tZ2l0IGEv
b3JnLmVjbGlwc2UuamR0LmNvcmUvZG9tL29yZy9lY2xpcHNlL2pkdC9jb3JlL2RvbS9BU1RNYXRj
aGVyLmphdmEgYi9vcmcuZWNsaXBzZS5qZHQuY29yZS9kb20vb3JnL2VjbGlwc2UvamR0L2NvcmUv
ZG9tL0FTVE1hdGNoZXIuamF2YQppbmRleCAzNDE0OWMyLi40ZmE0NGFkIDEwMDY0NAotLS0gYS9v
cmcuZWNsaXBzZS5qZHQuY29yZS9kb20vb3JnL2VjbGlwc2UvamR0L2NvcmUvZG9tL0FTVE1hdGNo
ZXIuamF2YQorKysgYi9vcmcuZWNsaXBzZS5qZHQuY29yZS9kb20vb3JnL2VjbGlwc2UvamR0L2Nv
cmUvZG9tL0FTVE1hdGNoZXIuamF2YQpAQCAtMzU1LDQgKzM1NSwyNyBAQAogCSAqICAgPGNvZGU+
ZmFsc2U8L2NvZGU+IGlmIHRoZXkgZG8gbm90IG1hdGNoIG9yIHRoZSBvdGhlciBvYmplY3QgaGFz
IGEKIAkgKiAgIGRpZmZlcmVudCBub2RlIHR5cGUgb3IgaXMgPGNvZGU+bnVsbDwvY29kZT4KKwkg
KiBAc2luY2UgMy45CisJICovCisJcHVibGljIGJvb2xlYW4gbWF0Y2goRGltZW5zaW9uVHlwZSBu
b2RlLCBPYmplY3Qgb3RoZXIpIHsKKwkJaWYgKCEob3RoZXIgaW5zdGFuY2VvZiBEaW1lbnNpb25U
eXBlKSkKKwkJCXJldHVybiBmYWxzZTsKKwkJRGltZW5zaW9uVHlwZSBvID0gKERpbWVuc2lvblR5
cGUpIG90aGVyOworCQlyZXR1cm4gc2FmZVN1YnRyZWVMaXN0TWF0Y2gobm9kZS5hbm5vdGF0aW9u
cygpLCBvLmFubm90YXRpb25zKCkpCisJCQkJJiYgc2FmZVN1YnRyZWVNYXRjaChub2RlLmV4cHJl
c3Npb24oKSwgby5leHByZXNzaW9uKCkpOworCX0KKworCS8qKgorCSAqIFJldHVybnMgd2hldGhl
ciB0aGUgZ2l2ZW4gbm9kZSBhbmQgdGhlIG90aGVyIG9iamVjdCBtYXRjaC4KKwkgKiA8cD4KKwkg
KiBUaGUgZGVmYXVsdCBpbXBsZW1lbnRhdGlvbiBwcm92aWRlZCBieSB0aGlzIGNsYXNzIHRlc3Rz
IHdoZXRoZXIgdGhlCisJICogb3RoZXIgb2JqZWN0IGlzIGEgbm9kZSBvZiB0aGUgc2FtZSB0eXBl
IHdpdGggc3RydWN0dXJhbGx5IGlzb21vcnBoaWMKKwkgKiBjaGlsZCBzdWJ0cmVlcy4gU3ViY2xh
c3NlcyBtYXkgb3ZlcnJpZGUgdGhpcyBtZXRob2QgYXMgbmVlZGVkLgorCSAqIDwvcD4KKwkgKgor
CSAqIEBwYXJhbSBub2RlIHRoZSBub2RlCisJICogQHBhcmFtIG90aGVyIHRoZSBvdGhlciBvYmpl
Y3QsIG9yIDxjb2RlPm51bGw8L2NvZGU+CisJICogQHJldHVybiA8Y29kZT50cnVlPC9jb2RlPiBp
ZiB0aGUgc3VidHJlZSBtYXRjaGVzLCBvcgorCSAqICAgPGNvZGU+ZmFsc2U8L2NvZGU+IGlmIHRo
ZXkgZG8gbm90IG1hdGNoIG9yIHRoZSBvdGhlciBvYmplY3QgaGFzIGEKKwkgKiAgIGRpZmZlcmVu
dCBub2RlIHR5cGUgb3IgaXMgPGNvZGU+bnVsbDwvY29kZT4KIAkgKi8KIAlwdWJsaWMgYm9vbGVh
biBtYXRjaChBc3NlcnRTdGF0ZW1lbnQgbm9kZSwgT2JqZWN0IG90aGVyKSB7CkBAIC0xMzkyLDUg
KzE0MTUsNSBAQAogCQkJCS8vIG4uYi4gY29tcGFyZSByZXR1cm4gdHlwZSBldmVuIGZvciBjb25z
dHJ1Y3RvcnMKIAkJCQkmJiBzYWZlU3VidHJlZUxpc3RNYXRjaChub2RlLnBhcmFtZXRlcnMoKSwg
by5wYXJhbWV0ZXJzKCkpCi0JIAkJCSYmIG5vZGUuZ2V0RXh0cmFEaW1lbnNpb25zKCkgPT0gby5n
ZXRFeHRyYURpbWVuc2lvbnMoKQorCQkJCSYmICgobm9kZS5nZXRBU1QoKS5hcGlMZXZlbCA8IEFT
VC5KTFM4KSA/IChub2RlLmdldEV4dHJhRGltZW5zaW9ucygpID09IG8uZ2V0RXh0cmFEaW1lbnNp
b25zKCkpIDogc2FmZVN1YnRyZWVMaXN0TWF0Y2gobm9kZS5nZXRleHRyYURpbWVuc2lvblR5cGVz
KCksIG8uZ2V0ZXh0cmFEaW1lbnNpb25UeXBlcygpKSkJCQkJCiAJCQkJJiYgc2FmZVN1YnRyZWVM
aXN0TWF0Y2gobm9kZS50aHJvd25FeGNlcHRpb25zKCksIG8udGhyb3duRXhjZXB0aW9ucygpKQog
CQkJCSYmIHNhZmVTdWJ0cmVlTWF0Y2gobm9kZS5nZXRCb2R5KCksIG8uZ2V0Qm9keSgpKSk7CkBA
IC0xODg1LDUgKzE5MDgsNSBAQAogCQkgICAgc2FmZVN1YnRyZWVNYXRjaChub2RlLmdldFR5cGUo
KSwgby5nZXRUeXBlKCkpCiAJCQkJJiYgc2FmZVN1YnRyZWVNYXRjaChub2RlLmdldE5hbWUoKSwg
by5nZXROYW1lKCkpCi0JIAkJCSYmIG5vZGUuZ2V0RXh0cmFEaW1lbnNpb25zKCkgPT0gby5nZXRF
eHRyYURpbWVuc2lvbnMoKQorCSAJCQkmJiAoKG5vZGUuZ2V0QVNUKCkuYXBpTGV2ZWwgPCBBU1Qu
SkxTOCkgPyAobm9kZS5nZXRFeHRyYURpbWVuc2lvbnMoKSA9PSBvLmdldEV4dHJhRGltZW5zaW9u
cygpKSA6IHNhZmVTdWJ0cmVlTGlzdE1hdGNoKG5vZGUuZ2V0RXh0cmFEaW1lbnNpb25UeXBlcygp
LCBvLmdldEV4dHJhRGltZW5zaW9uVHlwZXMoKSkpCiAJCQkJJiYgc2FmZVN1YnRyZWVNYXRjaChu
b2RlLmdldEluaXRpYWxpemVyKCksIG8uZ2V0SW5pdGlhbGl6ZXIoKSkKIAkJCQkmJiAobGV2ZWwg
Pj0gQVNULkpMUzggJiYgbm9kZS5pc1ZhcmFyZ3MoKSkgPyBzYWZlU3VidHJlZUxpc3RNYXRjaChu
b2RlLnZhcmFyZ3NBbm5vdGF0aW9ucygpLCBvLnZhcmFyZ3NBbm5vdGF0aW9ucygpKSA6IHRydWU7
CQkKQEAgLTIzNzgsNSArMjQwMSw1IEBACiAJCVZhcmlhYmxlRGVjbGFyYXRpb25GcmFnbWVudCBv
ID0gKFZhcmlhYmxlRGVjbGFyYXRpb25GcmFnbWVudCkgb3RoZXI7CiAJCXJldHVybiBzYWZlU3Vi
dHJlZU1hdGNoKG5vZGUuZ2V0TmFtZSgpLCBvLmdldE5hbWUoKSkKLQkJCSYmIG5vZGUuZ2V0RXh0
cmFEaW1lbnNpb25zKCkgPT0gby5nZXRFeHRyYURpbWVuc2lvbnMoKQorCQkJJiYgKChub2RlLmdl
dEFTVCgpLmFwaUxldmVsIDwgQVNULkpMUzgpID8gKG5vZGUuZ2V0RXh0cmFEaW1lbnNpb25zKCkg
PT0gby5nZXRFeHRyYURpbWVuc2lvbnMoKSkgOiBzYWZlU3VidHJlZUxpc3RNYXRjaChub2RlLmdl
dEV4dHJhRGltZW5zaW9uVHlwZXMoKSwgby5nZXRFeHRyYURpbWVuc2lvblR5cGVzKCkpKQogCQkJ
JiYgc2FmZVN1YnRyZWVNYXRjaChub2RlLmdldEluaXRpYWxpemVyKCksIG8uZ2V0SW5pdGlhbGl6
ZXIoKSk7CiAJfQpkaWZmIC0tZ2l0IGEvb3JnLmVjbGlwc2UuamR0LmNvcmUvZG9tL29yZy9lY2xp
cHNlL2pkdC9jb3JlL2RvbS9BU1ROb2RlLmphdmEgYi9vcmcuZWNsaXBzZS5qZHQuY29yZS9kb20v
b3JnL2VjbGlwc2UvamR0L2NvcmUvZG9tL0FTVE5vZGUuamF2YQppbmRleCA2N2E2NDFhLi5jMmU4
MjcwIDEwMDY0NAotLS0gYS9vcmcuZWNsaXBzZS5qZHQuY29yZS9kb20vb3JnL2VjbGlwc2UvamR0
L2NvcmUvZG9tL0FTVE5vZGUuamF2YQorKysgYi9vcmcuZWNsaXBzZS5qZHQuY29yZS9kb20vb3Jn
L2VjbGlwc2UvamR0L2NvcmUvZG9tL0FTVE5vZGUuamF2YQpAQCAtNzcyLDQgKzc3MiwxMyBAQAog
CSAqLwogCXB1YmxpYyBzdGF0aWMgZmluYWwgaW50IFVOSU9OX1RZUEUgPSA4NDsKKwkKKwkvKioK
KwkgKiBOb2RlIHR5cGUgY29uc3RhbnQgaW5kaWNhdGluZyBhIG5vZGUgb2YgdHlwZQorCSAqIDxj
b2RlPkRpbWVuc2lvbjwvY29kZT4uCisJICogCisJICogQHNlZSBEaW1lbnNpb25UeXBlCisJICog
QHNpbmNlIDMuOQorCSAqLworCXB1YmxpYyBzdGF0aWMgZmluYWwgaW50IERJTUVOU0lPTl9UWVBF
ID0gODU7CiAKIAkvKioKQEAgLTE4NDEsNCArMTg1MCwyMCBAQAogCSAgfQogCX0KKwkKKwkvKioK
KyAgICAgKiBDaGVja3MgdGhhdCB0aGlzIEFTVCBvcGVyYXRpb24gaXMgb25seSB1c2VkIHdoZW4K
KyAgICAgKiBidWlsZGluZyBKTFMzIG9yIGVhcmxpZXIgbGV2ZWwgQVNUcy4KKyAgICAgKiA8cD4K
KyAgICAgKiBVc2UgdGhpcyBtZXRob2QgdG8gcHJldmVudCBhY2Nlc3MgdG8gZGVwcmVjYXRlZCBw
cm9wZXJ0aWVzIChkZXByZWNhdGVkIGZyb20gSkxTOCApLgorICAgICAqIDwvcD4KKyAgICAgKiAK
KyAgICAgKiBAZXhjZXB0aW9uIFVuc3VwcG9ydGVkT3BlcmF0aW9uRXhjZXB0aW9uCisJICogQHNp
bmNlIDMuOQorICAgICAqLworCWZpbmFsIHZvaWQgc3VwcG9ydGVkT25seUluMl8zXzQoKSB7CisJ
CSAgaWYgKHRoaXMuYXN0LmFwaUxldmVsID49IEFTVC5KTFM4KSB7CisJCQkgIAl0aHJvdyBuZXcg
VW5zdXBwb3J0ZWRPcGVyYXRpb25FeGNlcHRpb24oIk9wZXJhdGlvbiBvbmx5IHN1cHBvcnRlZCBp
biBKTFM4IEFTVCIpOyAvLyROT04tTkxTLTEkCisJCSAgfQorCX0KIAogCS8qKgpkaWZmIC0tZ2l0
IGEvb3JnLmVjbGlwc2UuamR0LmNvcmUvZG9tL29yZy9lY2xpcHNlL2pkdC9jb3JlL2RvbS9BU1RW
aXNpdG9yLmphdmEgYi9vcmcuZWNsaXBzZS5qZHQuY29yZS9kb20vb3JnL2VjbGlwc2UvamR0L2Nv
cmUvZG9tL0FTVFZpc2l0b3IuamF2YQppbmRleCBiMjkzMDUzLi5mOGQxNmFhIDEwMDY0NAotLS0g
YS9vcmcuZWNsaXBzZS5qZHQuY29yZS9kb20vb3JnL2VjbGlwc2UvamR0L2NvcmUvZG9tL0FTVFZp
c2l0b3IuamF2YQorKysgYi9vcmcuZWNsaXBzZS5qZHQuY29yZS9kb20vb3JnL2VjbGlwc2UvamR0
L2NvcmUvZG9tL0FTVFZpc2l0b3IuamF2YQpAQCAtMjAwLDQgKzIwMCwyMCBAQAogCX0KIAorCS8q
KgorCSAqIFZpc2l0cyB0aGUgZ2l2ZW4gdHlwZS1zcGVjaWZpYyBBU1Qgbm9kZS4KKwkgKiA8cD4K
KwkgKiBUaGUgZGVmYXVsdCBpbXBsZW1lbnRhdGlvbiBkb2VzIG5vdGhpbmcgYW5kIHJldHVybiB0
cnVlLgorCSAqIFN1YmNsYXNzZXMgbWF5IHJlaW1wbGVtZW50LgorCSAqIDwvcD4KKwkgKgorCSAq
IEBwYXJhbSBub2RlIHRoZSBub2RlIHRvIHZpc2l0CisJICogQHJldHVybiA8Y29kZT50cnVlPC9j
b2RlPiBpZiB0aGUgY2hpbGRyZW4gb2YgdGhpcyBub2RlIHNob3VsZCBiZQorCSAqIHZpc2l0ZWQs
IGFuZCA8Y29kZT5mYWxzZTwvY29kZT4gaWYgdGhlIGNoaWxkcmVuIG9mIHRoaXMgbm9kZSBzaG91
bGQKKwkgKiBiZSBza2lwcGVkCisJICogQHNpbmNlIDMuOQorCSAqLworCXB1YmxpYyBib29sZWFu
IHZpc2l0KERpbWVuc2lvblR5cGUgbm9kZSkgeworCQlyZXR1cm4gdHJ1ZTsKKwl9CiAKIAkvKioK
QEAgLTE1OTMsNCArMTYwOSwxNyBAQAogCQkvLyBkZWZhdWx0IGltcGxlbWVudGF0aW9uOiBkbyBu
b3RoaW5nCiAJfQorCQorCS8qKgorCSAqIEVuZCBvZiB2aXNpdCB0aGUgZ2l2ZW4gdHlwZS1zcGVj
aWZpYyBBU1Qgbm9kZS4KKwkgKiA8cD4KKwkgKiBUaGUgZGVmYXVsdCBpbXBsZW1lbnRhdGlvbiBk
b2VzIG5vdGhpbmcuIFN1YmNsYXNzZXMgbWF5IHJlaW1wbGVtZW50LgorCSAqIDwvcD4KKwkgKgor
CSAqIEBwYXJhbSBub2RlIHRoZSBub2RlIHRvIHZpc2l0CisJICogQHNpbmNlIDMuOQorCSAqLwor
CXB1YmxpYyB2b2lkIGVuZFZpc2l0KERpbWVuc2lvblR5cGUgbm9kZSkgeworCQkvLyBkbyBub3Ro
aW5nIGJ5IGRlZmF1bHQKKwl9CiAKIAkvKioKZGlmZiAtLWdpdCBhL29yZy5lY2xpcHNlLmpkdC5j
b3JlL2RvbS9vcmcvZWNsaXBzZS9qZHQvY29yZS9kb20vQXJyYXlUeXBlLmphdmEgYi9vcmcuZWNs
aXBzZS5qZHQuY29yZS9kb20vb3JnL2VjbGlwc2UvamR0L2NvcmUvZG9tL0FycmF5VHlwZS5qYXZh
CmluZGV4IGQ0OWVmNWEuLmEwMWQ5NTIgMTAwNjQ0Ci0tLSBhL29yZy5lY2xpcHNlLmpkdC5jb3Jl
L2RvbS9vcmcvZWNsaXBzZS9qZHQvY29yZS9kb20vQXJyYXlUeXBlLmphdmEKKysrIGIvb3JnLmVj
bGlwc2UuamR0LmNvcmUvZG9tL29yZy9lY2xpcHNlL2pkdC9jb3JlL2RvbS9BcnJheVR5cGUuamF2
YQpAQCAtMTczLDUgKzE3Myw0IEBACiAJCXJlc3VsdC5zZXRDb21wb25lbnRUeXBlKChUeXBlKSBn
ZXRDb21wb25lbnRUeXBlKCkuY2xvbmUodGFyZ2V0KSk7CiAJCWlmICh0aGlzLmFzdC5hcGlMZXZl
bCA+PSBBU1QuSkxTOCkgewotCQkJcmVzdWx0LmFubm90YXRpb25zID0gbmV3IEFTVE5vZGUuTm9k
ZUxpc3QoQU5OT1RBVElPTlNfUFJPUEVSVFkpOwogCQkJcmVzdWx0LmFubm90YXRpb25zLmFkZEFs
bCgKIAkJCQkJQVNUTm9kZS5jb3B5U3VidHJlZXModGFyZ2V0LCBhbm5vdGF0aW9ucygpKSk7CmRp
ZmYgLS1naXQgYS9vcmcuZWNsaXBzZS5qZHQuY29yZS9kb20vb3JnL2VjbGlwc2UvamR0L2NvcmUv
ZG9tL0RpbWVuc2lvblR5cGUuamF2YSBiL29yZy5lY2xpcHNlLmpkdC5jb3JlL2RvbS9vcmcvZWNs
aXBzZS9qZHQvY29yZS9kb20vRGltZW5zaW9uVHlwZS5qYXZhCm5ldyBmaWxlIG1vZGUgMTAwNjQ0
CmluZGV4IDAwMDAwMDAuLjU0Y2EyNGMKLS0tIC9kZXYvbnVsbAorKysgYi9vcmcuZWNsaXBzZS5q
ZHQuY29yZS9kb20vb3JnL2VjbGlwc2UvamR0L2NvcmUvZG9tL0RpbWVuc2lvblR5cGUuamF2YQpA
QCAtMCwwICsxLDE5NyBAQAorLyoqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioq
KioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioKKyAqIENvcHlyaWdodCAo
YykgMjAwMCwgMjAxMyBJQk0gQ29ycG9yYXRpb24gYW5kIG90aGVycy4KKyAqIEFsbCByaWdodHMg
cmVzZXJ2ZWQuIFRoaXMgcHJvZ3JhbSBhbmQgdGhlIGFjY29tcGFueWluZyBtYXRlcmlhbHMKKyAq
IGFyZSBtYWRlIGF2YWlsYWJsZSB1bmRlciB0aGUgdGVybXMgb2YgdGhlIEVjbGlwc2UgUHVibGlj
IExpY2Vuc2UgdjEuMAorICogd2hpY2ggYWNjb21wYW5pZXMgdGhpcyBkaXN0cmlidXRpb24sIGFu
ZCBpcyBhdmFpbGFibGUgYXQKKyAqIGh0dHA6Ly93d3cuZWNsaXBzZS5vcmcvbGVnYWwvZXBsLXYx
MC5odG1sCisgKgorICogVGhpcyBpcyBhbiBpbXBsZW1lbnRhdGlvbiBvZiBhbiBlYXJseS1kcmFm
dCBzcGVjaWZpY2F0aW9uIGRldmVsb3BlZCB1bmRlciB0aGUgSmF2YQorICogQ29tbXVuaXR5IFBy
b2Nlc3MgKEpDUCkgYW5kIGlzIG1hZGUgYXZhaWxhYmxlIGZvciB0ZXN0aW5nIGFuZCBldmFsdWF0
aW9uIHB1cnBvc2VzCisgKiBvbmx5LiBUaGUgY29kZSBpcyBub3QgY29tcGF0aWJsZSB3aXRoIGFu
eSBzcGVjaWZpY2F0aW9uIG9mIHRoZSBKQ1AuCisgKiAKKyAqIENvbnRyaWJ1dG9yczoKKyAqICAg
ICBJQk0gQ29ycG9yYXRpb24gLSBpbml0aWFsIEFQSSBhbmQgaW1wbGVtZW50YXRpb24KKyAqKioq
KioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioq
KioqKioqKioqKioqKioqKioqLworcGFja2FnZSBvcmcuZWNsaXBzZS5qZHQuY29yZS5kb207CisK
K2ltcG9ydCBqYXZhLnV0aWwuQXJyYXlMaXN0OworaW1wb3J0IGphdmEudXRpbC5MaXN0OworCisv
KioKKyAqIFRoZSBhcnJheSBkaW1lbnNpb24gdHlwZSBub2RlLiBUaGUgYXJyYXkgZGltZW5zaW9u
LCByZXByZXNlbnRlZCBhcyA8Yj5bXTwvYj4sIG1heSBub3QgbWF5IG5vdCAKKyAqIGluY2x1ZGUg
YW4gPGNvZGU+RXhwcmVzc2lvbjwvY29kZT4gZGVwZW5kaW5nIG9uIHdoZXJlIGl0IGFwcGVhcnMu
IFRoZSBvbmx5IAorICogbm9kZSB0aGF0IHN1cHBvcnRzIGEgZGltZW5zaW9uIHR5cGUgd2l0aCBh
biBleHByZXNzaW9uIGlzIDxjb2RlPkFycmF5Q3JlYXRpb248L2NvZGU+LgorICogVGhpcyBub2Rl
IHR5cGUgaXMgc3VwcG9ydGVkIG9ubHkgaW4gSkxTOCBvciBsYXRlci4KKyAqIAorICogRm9yIEpM
Uzg6CisgKiA8cHJlPgorICogRGltZW5zaW9uVHlwZToKKyAqIAk8Yj5bPC9iPiB7RXhwcmVzc2lv
bn0gPGI+XTwvYj4gCisgKiA8L3ByZT4KKyAqIAorICogQHNpbmNlIDMuOQorICovCitwdWJsaWMg
Y2xhc3MgRGltZW5zaW9uVHlwZSBleHRlbmRzIEFubm90YXRhYmxlVHlwZSB7CisKKwkKKwkvKioK
KwkgKiBUaGUgImFubm90YXRpb25zIiBzdHJ1Y3R1cmFsIHByb3BlcnR5IG9mIHRoaXMgbm9kZSB0
eXBlIChjaGlsZCB0eXBlOiB7QGxpbmsgQW5ub3RhdGlvbn0pLgorCSAqIEBzaW5jZSAzLjkKKwkg
Ki8KKwlwdWJsaWMgc3RhdGljIGZpbmFsIENoaWxkTGlzdFByb3BlcnR5RGVzY3JpcHRvciBBTk5P
VEFUSU9OU19QUk9QRVJUWSA9CisJCW5ldyBDaGlsZExpc3RQcm9wZXJ0eURlc2NyaXB0b3IoRGlt
ZW5zaW9uVHlwZS5jbGFzcywgImFubm90YXRpb25zIiwgQW5ub3RhdGlvbi5jbGFzcywgTk9fQ1lD
TEVfUklTSyk7IC8vJE5PTi1OTFMtMSQKKwkKKworCS8qKgorCSAqIFRoZSAiZGltZW5zaW9ucyIg
c3RydWN0dXJhbCBwcm9wZXJ0eSBvZiB0aGlzIG5vZGUgdHlwZSAoZWxlbWVudCB0eXBlOiB7QGxp
bmsgRXhwcmVzc2lvbn0pLgorCSAqIEBzaW5jZSAzLjkKKwkgKi8KKwlwdWJsaWMgc3RhdGljIGZp
bmFsIENoaWxkUHJvcGVydHlEZXNjcmlwdG9yIEVYUFJFU1NJT05fUFJPUEVSVFkgPQorCQkJbmV3
IENoaWxkUHJvcGVydHlEZXNjcmlwdG9yKERpbWVuc2lvblR5cGUuY2xhc3MsICJleHByZXNzaW9u
IiwgRXhwcmVzc2lvbi5jbGFzcywgTUFOREFUT1JZLCBOT19DWUNMRV9SSVNLKTsgLy8kTk9OLU5M
Uy0xJAorCQorCQorCS8qKgorCSAqIEEgbGlzdCBvZiBwcm9wZXJ0eSBkZXNjcmlwdG9ycyAoZWxl
bWVudCB0eXBlOgorCSAqIHtAbGluayBTdHJ1Y3R1cmFsUHJvcGVydHlEZXNjcmlwdG9yfSksCisJ
ICogb3IgbnVsbCBpZiB1bmluaXRpYWxpemVkLgorCSAqIEBzaW5jZSAzLjkKKwkgKi8KKwlwcml2
YXRlIHN0YXRpYyBmaW5hbCBMaXN0IFBST1BFUlRZX0RFU0NSSVBUT1JTXzhfMDsKKwkKKwlzdGF0
aWMgeworCQlMaXN0IHByb3BlcnR5TGlzdCA9IG5ldyBBcnJheUxpc3QoMyk7CisJCWNyZWF0ZVBy
b3BlcnR5TGlzdChEaW1lbnNpb25UeXBlLmNsYXNzLCBwcm9wZXJ0eUxpc3QpOworCQlhZGRQcm9w
ZXJ0eShBTk5PVEFUSU9OU19QUk9QRVJUWSwgcHJvcGVydHlMaXN0KTsKKwkJYWRkUHJvcGVydHko
RVhQUkVTU0lPTl9QUk9QRVJUWSwgcHJvcGVydHlMaXN0KTsKKwkJUFJPUEVSVFlfREVTQ1JJUFRP
UlNfOF8wID0gcmVhcFByb3BlcnR5TGlzdChwcm9wZXJ0eUxpc3QpOworCX0KKwkKKwkvKioKKwkg
KiBSZXR1cm5zIGEgbGlzdCBvZiBzdHJ1Y3R1cmFsIHByb3BlcnR5IGRlc2NyaXB0b3JzIGZvciB0
aGlzIG5vZGUgdHlwZS4KKwkgKiBDbGllbnRzIG11c3Qgbm90IG1vZGlmeSB0aGUgcmVzdWx0Lgor
CSAqCisJICogQHBhcmFtIGFwaUxldmVsIHRoZSBBUEkgbGV2ZWw7IG9uZSBvZiB0aGUKKwkgKiA8
Y29kZT5BU1QuSkxTKjwvY29kZT4gY29uc3RhbnRzCisJICogQHJldHVybiBhIGxpc3Qgb2YgcHJv
cGVydHkgZGVzY3JpcHRvcnMgKGVsZW1lbnQgdHlwZToKKwkgKiB7QGxpbmsgU3RydWN0dXJhbFBy
b3BlcnR5RGVzY3JpcHRvcn0pCisJICogQHNpbmNlIDMuOQorCSAqLworCXB1YmxpYyBzdGF0aWMg
TGlzdCBwcm9wZXJ0eURlc2NyaXB0b3JzKGludCBhcGlMZXZlbCkgeworCQlyZXR1cm4gUFJPUEVS
VFlfREVTQ1JJUFRPUlNfOF8wOworCX0KKwkKKwlwdWJsaWMgRGltZW5zaW9uVHlwZShBU1QgYXN0
KSB7CisJCXN1cGVyKGFzdCk7CisJCXVuc3VwcG9ydGVkSW4yXzNfNCgpOworCQl0aGlzLmFubm90
YXRpb25zID0gbmV3IEFTVE5vZGUuTm9kZUxpc3QoQU5OT1RBVElPTlNfUFJPUEVSVFkpOworCX0K
KwkKKwkvKioKKwkgKiBUaGUgbGlzdCBvZiBkaW1lbnNpb24gZXhwcmVzc2lvbnMgKGVsZW1lbnQg
dHlwZToKKwkgKiB7QGxpbmsgRXhwcmVzc2lvbn0pLiBEZWZhdWx0cyB0byBhbiBlbXB0eSBsaXN0
LgorCSAqLworCXByaXZhdGUgRXhwcmVzc2lvbiBleHByZXNzaW9uID0gbnVsbDsKKwkKKwkvKioK
KwkgKiBTZXRzIHRoZSBhcnJheSB0eXBlIGluIHRoaXMgYXJyYXkgY3JlYXRpb24gZXhwcmVzc2lv
bi4KKwkgKgorCSAqIEBwYXJhbSBleHByZXNzaW9uIHRoZSBuZXcgYXJyYXkgdHlwZQorCSAqIEBl
eGNlcHRpb24gSWxsZWdhbEFyZ3VtZW50RXhjZXB0aW9uIGlmOgorCSAqIDx1bD4KKwkgKiA8bGk+
dGhlIG5vZGUgYmVsb25ncyB0byBhIGRpZmZlcmVudCBBU1Q8L2xpPgorCSAqIDxsaT50aGUgbm9k
ZSBhbHJlYWR5IGhhcyBhIHBhcmVudDwvbGk+CisJICogPC91bD4KKwkgKiAKKwkgKiBAc2luY2Ug
My45CisJICovCisJcHVibGljIHZvaWQgc2V0RXhwcmVzc2lvbihFeHByZXNzaW9uIGV4cHJlc3Np
b24pIHsKKwkJLy8gYW4gQXJyYXlDcmVhdGlvbiBjYW5ub3Qgb2NjdXIgaW5zaWRlIGEgQXJyYXlU
eXBlIC0gY3ljbGVzIG5vdCBwb3NzaWJsZQorCQlBU1ROb2RlIG9sZENoaWxkID0gdGhpcy5leHBy
ZXNzaW9uOworCQlwcmVSZXBsYWNlQ2hpbGQob2xkQ2hpbGQsIGV4cHJlc3Npb24sIEVYUFJFU1NJ
T05fUFJPUEVSVFkpOworCQl0aGlzLmV4cHJlc3Npb24gPSBleHByZXNzaW9uOworCQlwb3N0UmVw
bGFjZUNoaWxkKG9sZENoaWxkLCBleHByZXNzaW9uLCBFWFBSRVNTSU9OX1BST1BFUlRZKTsKKwl9
CisJCisJLyoqCisJICogUmV0dXJucyB0aGUgZXhwcmVzc2lvbiBpbiB0aGUgZGltZW5zaW9uIHR5
cGUuCisJICoKKwkgKiBAcmV0dXJuIHRoZSBleHByZXNzaW9uCisJICogQHNpbmNlIDMuOQorCSAq
LworCXB1YmxpYyBFeHByZXNzaW9uIGV4cHJlc3Npb24oKSB7CisJCXJldHVybiB0aGlzLmV4cHJl
c3Npb247CisJfQorCQorCUxpc3QgaW50ZXJuYWxTdHJ1Y3R1cmFsUHJvcGVydGllc0ZvclR5cGUo
aW50IGFwaUxldmVsKSB7CisJCXJldHVybiBwcm9wZXJ0eURlc2NyaXB0b3JzKGFwaUxldmVsKTsK
Kwl9CisKKwkvKiAob21pdCBqYXZhZG9jIGZvciB0aGlzIG1ldGhvZCkKKwkgKiBNZXRob2QgZGVj
bGFyZWQgb24gQVNUTm9kZS4KKwkgKi8KKwlmaW5hbCBBU1ROb2RlIGludGVybmFsR2V0U2V0Q2hp
bGRQcm9wZXJ0eShDaGlsZFByb3BlcnR5RGVzY3JpcHRvciBwcm9wZXJ0eSwgYm9vbGVhbiBnZXQs
IEFTVE5vZGUgY2hpbGQpIHsKKwkJaWYgKHByb3BlcnR5ID09IEVYUFJFU1NJT05fUFJPUEVSVFkp
IHsKKwkJCWlmIChnZXQpIHsKKwkJCQlyZXR1cm4gZXhwcmVzc2lvbigpOworCQkJfSBlbHNlIHsK
KwkJCQlzZXRFeHByZXNzaW9uKChFeHByZXNzaW9uKSBjaGlsZCk7CisJCQkJcmV0dXJuIG51bGw7
CisJCQl9CisJCX0KKwkJLy8gYWxsb3cgZGVmYXVsdCBpbXBsZW1lbnRhdGlvbiB0byBmbGFnIHRo
ZSBlcnJvcgorCQlyZXR1cm4gc3VwZXIuaW50ZXJuYWxHZXRTZXRDaGlsZFByb3BlcnR5KHByb3Bl
cnR5LCBnZXQsIGNoaWxkKTsKKwl9CisKKwkvKiAob21pdCBqYXZhZG9jIGZvciB0aGlzIG1ldGhv
ZCkKKwkgKiBNZXRob2QgZGVjbGFyZWQgb24gQVNUTm9kZS4KKwkgKi8KKwlmaW5hbCBMaXN0IGlu
dGVybmFsR2V0Q2hpbGRMaXN0UHJvcGVydHkoQ2hpbGRMaXN0UHJvcGVydHlEZXNjcmlwdG9yIHBy
b3BlcnR5KSB7CisJCWlmIChwcm9wZXJ0eSA9PSBBTk5PVEFUSU9OU19QUk9QRVJUWSkgeworCQkJ
cmV0dXJuIGFubm90YXRpb25zKCk7CisJCX0KKwkJLy8gYWxsb3cgZGVmYXVsdCBpbXBsZW1lbnRh
dGlvbiB0byBmbGFnIHRoZSBlcnJvcgorCQlyZXR1cm4gc3VwZXIuaW50ZXJuYWxHZXRDaGlsZExp
c3RQcm9wZXJ0eShwcm9wZXJ0eSk7CisJfQorCisJaW50IGdldE5vZGVUeXBlMCgpIHsKKwkJcmV0
dXJuIERJTUVOU0lPTl9UWVBFOworCX0KKworCWJvb2xlYW4gc3VidHJlZU1hdGNoMChBU1RNYXRj
aGVyIG1hdGNoZXIsIE9iamVjdCBvdGhlcikgeworCQlyZXR1cm4gbWF0Y2hlci5tYXRjaCh0aGlz
LCBvdGhlcik7CisJfQorCisJQVNUTm9kZSBjbG9uZTAoQVNUIHRhcmdldCkgeworCQlEaW1lbnNp
b25UeXBlIHJlc3VsdCA9IG5ldyBEaW1lbnNpb25UeXBlKHRhcmdldCk7CisJCXJlc3VsdC5hbm5v
dGF0aW9ucy5hZGRBbGwoCisJCQkJQVNUTm9kZS5jb3B5U3VidHJlZXModGFyZ2V0LCBhbm5vdGF0
aW9ucygpKSk7CisJCWlmICh0aGlzLmV4cHJlc3Npb24gIT0gbnVsbCkgeworCQkJcmVzdWx0LnNl
dEV4cHJlc3Npb24oKEV4cHJlc3Npb24pZXhwcmVzc2lvbigpLmNsb25lKHRhcmdldCkpOworCQl9
CisJCXJldHVybiByZXN1bHQ7CisJfQorCisJdm9pZCBhY2NlcHQwKEFTVFZpc2l0b3IgdmlzaXRv
cikgeworCQlib29sZWFuIHZpc2l0Q2hpbGRyZW4gPSB2aXNpdG9yLnZpc2l0KHRoaXMpOworCQlp
ZiAodmlzaXRDaGlsZHJlbikgeworCQkJYWNjZXB0Q2hpbGRyZW4odmlzaXRvciwgdGhpcy5hbm5v
dGF0aW9ucyk7CisJCQlpZiAodGhpcy5leHByZXNzaW9uICE9IG51bGwpIHsKKwkJCQlhY2NlcHRD
aGlsZCh2aXNpdG9yLCB0aGlzLmV4cHJlc3Npb24pOworCQkJfQorCQl9CisJCXZpc2l0b3IuZW5k
VmlzaXQodGhpcyk7CisKKwl9CisKKwlpbnQgdHJlZVNpemUoKSB7CisJCWludCBzaXplID0gbWVt
U2l6ZSgpCisJCQkJKyB0aGlzLmFubm90YXRpb25zLmxpc3RTaXplKCkKKwkJCQkrICh0aGlzLmV4
cHJlc3Npb24gPT0gbnVsbCA/IDAgOiB0aGlzLmV4cHJlc3Npb24udHJlZVNpemUoKSk7CisJCQly
ZXR1cm4gc2l6ZTsKKwl9CisKKwlpbnQgbWVtU2l6ZSgpIHsKKwkJcmV0dXJuIEJBU0VfTk9ERV9T
SVpFICsgMiAqIDQ7CisJfQorCit9CmRpZmYgLS1naXQgYS9vcmcuZWNsaXBzZS5qZHQuY29yZS9k
b20vb3JnL2VjbGlwc2UvamR0L2NvcmUvZG9tL01ldGhvZERlY2xhcmF0aW9uLmphdmEgYi9vcmcu
ZWNsaXBzZS5qZHQuY29yZS9kb20vb3JnL2VjbGlwc2UvamR0L2NvcmUvZG9tL01ldGhvZERlY2xh
cmF0aW9uLmphdmEKaW5kZXggYmY4ZDk5Ny4uZjM1NzBiYSAxMDA2NDQKLS0tIGEvb3JnLmVjbGlw
c2UuamR0LmNvcmUvZG9tL29yZy9lY2xpcHNlL2pkdC9jb3JlL2RvbS9NZXRob2REZWNsYXJhdGlv
bi5qYXZhCisrKyBiL29yZy5lY2xpcHNlLmpkdC5jb3JlL2RvbS9vcmcvZWNsaXBzZS9qZHQvY29y
ZS9kb20vTWV0aG9kRGVjbGFyYXRpb24uamF2YQpAQCAtMTI1LDQgKzEyNSwxMSBAQAogCiAJLyoq
CisJICogVGhlICJleHRyYURpbWVuc2lvblR5cGVzIiBzdHJ1Y3R1cmFsIHByb3BlcnR5IG9mIHRo
aXMgbm9kZSB0eXBlIChjaGlsZCB0eXBlOiB7QGxpbmsgRGltZW5zaW9uVHlwZX0pLgorCSAqIEBz
aW5jZSAzLjkKKwkgKi8KKwlwdWJsaWMgc3RhdGljIGZpbmFsIENoaWxkTGlzdFByb3BlcnR5RGVz
Y3JpcHRvciBFWFRSQV9ESU1FTlNJT05fVFlQRVNfUFJPUEVSVFkgPQorCQkJbmV3IENoaWxkTGlz
dFByb3BlcnR5RGVzY3JpcHRvcihNZXRob2REZWNsYXJhdGlvbi5jbGFzcywgImV4dHJhRGltZW5z
aW9uVHlwZXMiLCBEaW1lbnNpb25UeXBlLmNsYXNzLCBOT19DWUNMRV9SSVNLKTsgLy8kTk9OLU5M
Uy0xJAorCisJLyoqCiAJICogVGhlICJ0eXBlUGFyYW1ldGVycyIgc3RydWN0dXJhbCBwcm9wZXJ0
eSBvZiB0aGlzIG5vZGUgdHlwZSAoZWxlbWVudCB0eXBlOiB7QGxpbmsgVHlwZVBhcmFtZXRlcn0p
IChhZGRlZCBpbiBKTFMzIEFQSSkuCiAJICogQHNpbmNlIDMuMQpAQCAtMjY1LDQgKzI3MiwxMSBA
QAogCiAJLyoqCisJICogVGhlIGV4dHJhIGRpbWVuc2lvbiB0eXBlcyB0aGlzIG5vZGUgaGFzIHdp
dGggYW5ub3RhdGlvbnMgaWYgYW55LgorCSAqIAorCSAqIEBzaW5jZSAzLjkKKwkgKi8KKwlwcm90
ZWN0ZWQgQVNUTm9kZS5Ob2RlTGlzdCBleHRyYURpbWVuc2lvblR5cGVzID0gbnVsbDsKKworCS8q
KgogCSAqIFRoZSBsaXN0IG9mIHRocm93biBleGNlcHRpb24gbmFtZXMgKGVsZW1lbnQgdHlwZTog
e0BsaW5rIE5hbWV9KS4KIAkgKiBEZWZhdWx0cyB0byBhbiBlbXB0eSBsaXN0LgpAQCAtMjk2LDQg
KzMxMCw3IEBACiAJCWlmIChhc3QuYXBpTGV2ZWwgPj0gQVNULkpMUzNfSU5URVJOQUwpIHsKIAkJ
CXRoaXMudHlwZVBhcmFtZXRlcnMgPSBuZXcgQVNUTm9kZS5Ob2RlTGlzdChUWVBFX1BBUkFNRVRF
UlNfUFJPUEVSVFkpOworCQl9IAorCQlpZiAoYXN0LmFwaUxldmVsID49IEFTVC5KTFM4KSB7CisJ
CQl0aGlzLmV4dHJhRGltZW5zaW9uVHlwZXMgPSBuZXcgQVNUTm9kZS5Ob2RlTGlzdChFWFRSQV9E
SU1FTlNJT05fVFlQRVNfUFJPUEVSVFkpOwogCQl9CiAJfQpAQCAtNDExLDQgKzQyOCw3IEBACiAJ
CQlyZXR1cm4gdGhyb3duRXhjZXB0aW9ucygpOwogCQl9CisJCWlmIChwcm9wZXJ0eSA9PSBFWFRS
QV9ESU1FTlNJT05fVFlQRVNfUFJPUEVSVFkpIHsKKwkJCXJldHVybiB0aGlzLmV4dHJhRGltZW5z
aW9uVHlwZXM7CisJCX0KIAkJLy8gYWxsb3cgZGVmYXVsdCBpbXBsZW1lbnRhdGlvbiB0byBmbGFn
IHRoZSBlcnJvcgogCQlyZXR1cm4gc3VwZXIuaW50ZXJuYWxHZXRDaGlsZExpc3RQcm9wZXJ0eShw
cm9wZXJ0eSk7CkBAIC00NjUsNCArNDg1LDkgQEAKIAkJcmVzdWx0LnNldENvbnN0cnVjdG9yKGlz
Q29uc3RydWN0b3IoKSk7CiAJCXJlc3VsdC5zZXRFeHRyYURpbWVuc2lvbnMoZ2V0RXh0cmFEaW1l
bnNpb25zKCkpOworCQlpZiAodGhpcy5hc3QuYXBpTGV2ZWwgPj0gQVNULkpMUzgpIHsKKwkJCXJl
c3VsdC5leHRyYURpbWVuc2lvblR5cGVzID0gbmV3IEFTVE5vZGUuTm9kZUxpc3QoRVhUUkFfRElN
RU5TSU9OX1RZUEVTX1BST1BFUlRZKTsKKwkJCXJlc3VsdC5leHRyYURpbWVuc2lvblR5cGVzLmFk
ZEFsbCgKKwkJCQkJQVNUTm9kZS5jb3B5U3VidHJlZXModGFyZ2V0LCB0aGlzLmV4dHJhRGltZW5z
aW9uVHlwZXMpKTsKKwkJfQogCQlyZXN1bHQuc2V0TmFtZSgoU2ltcGxlTmFtZSkgZ2V0TmFtZSgp
LmNsb25lKHRhcmdldCkpOwogCQlyZXN1bHQucGFyYW1ldGVycygpLmFkZEFsbCgKQEAgLTgyOSw0
ICs4NTQsMTUgQEAKIAogCS8qKgorCSAqIFJldHVybnMgdGhlIGxpdmUgb3JkZXJlZCBsaXN0IG9m
IGV4dHJhIGRpbWVuc2lvbnMgd2l0aCBhbm5vdGF0aW9ucyBpZiBhbnkuCisJICogCisJICogQHJl
dHVybiB0aGUgbGl2ZSBsaXN0IG9mIGV4dHJhIGRpbWVuc2lvbnMgd2l0aCBhbm5vdGF0aW9ucyBp
ZiBhbnkgKGVsZW1lbnQgdHlwZToge0BsaW5rIERpbWVuc2lvblR5cGV9W10pCisJICogQHNpbmNl
IDMuOQorCSAqLworCXB1YmxpYyBMaXN0IGdldGV4dHJhRGltZW5zaW9uVHlwZXMoKSB7CisJCXVu
c3VwcG9ydGVkSW4yXzNfNCgpOworCQlyZXR1cm4gdGhpcy5leHRyYURpbWVuc2lvblR5cGVzOwor
CX0KKworCS8qKgogCSAqIFJldHVybnMgdGhlIGJvZHkgb2YgdGhpcyBtZXRob2QgZGVjbGFyYXRp
b24sIG9yIDxjb2RlPm51bGw8L2NvZGU+IGlmCiAJICogdGhpcyBtZXRob2QgaGFzIDxiPm5vPC9i
PiBib2R5LgpkaWZmIC0tZ2l0IGEvb3JnLmVjbGlwc2UuamR0LmNvcmUvZG9tL29yZy9lY2xpcHNl
L2pkdC9jb3JlL2RvbS9QcmltaXRpdmVUeXBlLmphdmEgYi9vcmcuZWNsaXBzZS5qZHQuY29yZS9k
b20vb3JnL2VjbGlwc2UvamR0L2NvcmUvZG9tL1ByaW1pdGl2ZVR5cGUuamF2YQppbmRleCAyMjkw
YzU4Li4zMzIwZTllIDEwMDY0NAotLS0gYS9vcmcuZWNsaXBzZS5qZHQuY29yZS9kb20vb3JnL2Vj
bGlwc2UvamR0L2NvcmUvZG9tL1ByaW1pdGl2ZVR5cGUuamF2YQorKysgYi9vcmcuZWNsaXBzZS5q
ZHQuY29yZS9kb20vb3JnL2VjbGlwc2UvamR0L2NvcmUvZG9tL1ByaW1pdGl2ZVR5cGUuamF2YQpA
QCAtMjg2LDUgKzI4Niw0IEBACiAJCXJlc3VsdC5zZXRQcmltaXRpdmVUeXBlQ29kZShnZXRQcmlt
aXRpdmVUeXBlQ29kZSgpKTsKIAkJaWYgKHRoaXMuYXN0LmFwaUxldmVsID49IEFTVC5KTFM4KSB7
Ci0JCQlyZXN1bHQuYW5ub3RhdGlvbnMgPSBuZXcgQVNUTm9kZS5Ob2RlTGlzdChBTk5PVEFUSU9O
U19QUk9QRVJUWSk7CiAJCQlyZXN1bHQuYW5ub3RhdGlvbnMuYWRkQWxsKAogCQkJCQlBU1ROb2Rl
LmNvcHlTdWJ0cmVlcyh0YXJnZXQsIGFubm90YXRpb25zKCkpKTsKZGlmZiAtLWdpdCBhL29yZy5l
Y2xpcHNlLmpkdC5jb3JlL2RvbS9vcmcvZWNsaXBzZS9qZHQvY29yZS9kb20vUXVhbGlmaWVkVHlw
ZS5qYXZhIGIvb3JnLmVjbGlwc2UuamR0LmNvcmUvZG9tL29yZy9lY2xpcHNlL2pkdC9jb3JlL2Rv
bS9RdWFsaWZpZWRUeXBlLmphdmEKaW5kZXggOTY3YjVjMi4uMmVlZDg5ZSAxMDA2NDQKLS0tIGEv
b3JnLmVjbGlwc2UuamR0LmNvcmUvZG9tL29yZy9lY2xpcHNlL2pkdC9jb3JlL2RvbS9RdWFsaWZp
ZWRUeXBlLmphdmEKKysrIGIvb3JnLmVjbGlwc2UuamR0LmNvcmUvZG9tL29yZy9lY2xpcHNlL2pk
dC9jb3JlL2RvbS9RdWFsaWZpZWRUeXBlLmphdmEKQEAgLTIxNyw1ICsyMTcsNCBAQAogCQlyZXN1
bHQuc2V0TmFtZSgoU2ltcGxlTmFtZSkgKChBU1ROb2RlKSBnZXROYW1lKCkpLmNsb25lKHRhcmdl
dCkpOwogCQlpZiAodGhpcy5hc3QuYXBpTGV2ZWwgPj0gQVNULkpMUzgpIHsKLQkJCXJlc3VsdC5h
bm5vdGF0aW9ucyA9IG5ldyBBU1ROb2RlLk5vZGVMaXN0KEFOTk9UQVRJT05TX1BST1BFUlRZKTsK
IAkJCXJlc3VsdC5hbm5vdGF0aW9ucy5hZGRBbGwoCiAJCQkJCUFTVE5vZGUuY29weVN1YnRyZWVz
KHRhcmdldCwgYW5ub3RhdGlvbnMoKSkpOwpkaWZmIC0tZ2l0IGEvb3JnLmVjbGlwc2UuamR0LmNv
cmUvZG9tL29yZy9lY2xpcHNlL2pkdC9jb3JlL2RvbS9SZWNvdmVyZWRWYXJpYWJsZUJpbmRpbmcu
amF2YSBiL29yZy5lY2xpcHNlLmpkdC5jb3JlL2RvbS9vcmcvZWNsaXBzZS9qZHQvY29yZS9kb20v
UmVjb3ZlcmVkVmFyaWFibGVCaW5kaW5nLmphdmEKaW5kZXggYmE1MTJmYy4uYjA4OWE1MiAxMDA2
NDQKLS0tIGEvb3JnLmVjbGlwc2UuamR0LmNvcmUvZG9tL29yZy9lY2xpcHNlL2pkdC9jb3JlL2Rv
bS9SZWNvdmVyZWRWYXJpYWJsZUJpbmRpbmcuamF2YQorKysgYi9vcmcuZWNsaXBzZS5qZHQuY29y
ZS9kb20vb3JnL2VjbGlwc2UvamR0L2NvcmUvZG9tL1JlY292ZXJlZFZhcmlhYmxlQmluZGluZy5q
YXZhCkBAIC05NSw1ICs5NSw2IEBACiAJCQkJLmFwcGVuZCh0aGlzLnZhcmlhYmxlRGVjbGFyYXRp
b24uZ2V0Q2xhc3MoKSkKIAkJCQkuYXBwZW5kKHRoaXMudmFyaWFibGVEZWNsYXJhdGlvbi5nZXRO
YW1lKCkuZ2V0SWRlbnRpZmllcigpKQotCQkJCS5hcHBlbmQodGhpcy52YXJpYWJsZURlY2xhcmF0
aW9uLmdldEV4dHJhRGltZW5zaW9ucygpKTsKKwkJCQkuYXBwZW5kKCh0aGlzLnZhcmlhYmxlRGVj
bGFyYXRpb24uYXN0LmFwaUxldmVsIDwgQVNULkpMUzgpID8gCisJCQkJCQl0aGlzLnZhcmlhYmxl
RGVjbGFyYXRpb24uZ2V0RXh0cmFEaW1lbnNpb25zKCkgOiB0aGlzLnZhcmlhYmxlRGVjbGFyYXRp
b24uZ2V0RXh0cmFEaW1lbnNpb25UeXBlcygpLnNpemUoKSk7CiAJCX0KIAkJcmV0dXJuIFN0cmlu
Zy52YWx1ZU9mKGJ1ZmZlcik7CmRpZmYgLS1naXQgYS9vcmcuZWNsaXBzZS5qZHQuY29yZS9kb20v
b3JnL2VjbGlwc2UvamR0L2NvcmUvZG9tL1NpbXBsZVR5cGUuamF2YSBiL29yZy5lY2xpcHNlLmpk
dC5jb3JlL2RvbS9vcmcvZWNsaXBzZS9qZHQvY29yZS9kb20vU2ltcGxlVHlwZS5qYXZhCmluZGV4
IGZlNTAzYWEuLmFmZjJiOWEgMTAwNjQ0Ci0tLSBhL29yZy5lY2xpcHNlLmpkdC5jb3JlL2RvbS9v
cmcvZWNsaXBzZS9qZHQvY29yZS9kb20vU2ltcGxlVHlwZS5qYXZhCisrKyBiL29yZy5lY2xpcHNl
LmpkdC5jb3JlL2RvbS9vcmcvZWNsaXBzZS9qZHQvY29yZS9kb20vU2ltcGxlVHlwZS5qYXZhCkBA
IC0xNjYsNSArMTY2LDQgQEAKIAkJcmVzdWx0LnNldE5hbWUoKE5hbWUpIChnZXROYW1lKCkpLmNs
b25lKHRhcmdldCkpOwogCQlpZiAodGhpcy5hc3QuYXBpTGV2ZWwgPj0gQVNULkpMUzgpIHsKLQkJ
CXJlc3VsdC5hbm5vdGF0aW9ucyA9IG5ldyBBU1ROb2RlLk5vZGVMaXN0KEFOTk9UQVRJT05TX1BS
T1BFUlRZKTsKIAkJCXJlc3VsdC5hbm5vdGF0aW9ucy5hZGRBbGwoCiAJCQkJCUFTVE5vZGUuY29w
eVN1YnRyZWVzKHRhcmdldCwgYW5ub3RhdGlvbnMoKSkpOwpkaWZmIC0tZ2l0IGEvb3JnLmVjbGlw
c2UuamR0LmNvcmUvZG9tL29yZy9lY2xpcHNlL2pkdC9jb3JlL2RvbS9TaW5nbGVWYXJpYWJsZURl
Y2xhcmF0aW9uLmphdmEgYi9vcmcuZWNsaXBzZS5qZHQuY29yZS9kb20vb3JnL2VjbGlwc2UvamR0
L2NvcmUvZG9tL1NpbmdsZVZhcmlhYmxlRGVjbGFyYXRpb24uamF2YQppbmRleCA1YzI4YjA4Li45
OTAyZTE0IDEwMDY0NAotLS0gYS9vcmcuZWNsaXBzZS5qZHQuY29yZS9kb20vb3JnL2VjbGlwc2Uv
amR0L2NvcmUvZG9tL1NpbmdsZVZhcmlhYmxlRGVjbGFyYXRpb24uamF2YQorKysgYi9vcmcuZWNs
aXBzZS5qZHQuY29yZS9kb20vb3JnL2VjbGlwc2UvamR0L2NvcmUvZG9tL1NpbmdsZVZhcmlhYmxl
RGVjbGFyYXRpb24uamF2YQpAQCAtOTEsOSArOTEsMTcgQEAKIAogCS8qKgotCSAqIFRoZSAiZXh0
cmFEaW1lbnNpb25zIiBzdHJ1Y3R1cmFsIHByb3BlcnR5IG9mIHRoaXMgbm9kZSB0eXBlICh0eXBl
OiB7QGxpbmsgSW50ZWdlcn0pLgorCSAqIFRoZSAiZXh0cmFEaW1lbnNpb25zIiBzdHJ1Y3R1cmFs
IHByb3BlcnR5IG9mIHRoaXMgbm9kZSB0eXBlICh0eXBlOiB7QGxpbmsgSW50ZWdlcn0pLiBUaGlz
IHByb3BlcnR5IGlzIHN1cHBvcnRlZAorCSAqIG9ubHkgaW4gSkxTNCBvciBsb3dlciBsZXZlbC4g
Rm9yIEpMUzggYW5kIGFib3ZlLCB1c2UgPGNvZGU+RVhUUkFfRElNRU5TSU9OX1RZUEVTX1BST1BF
UlRZPC9jb2RlPi4KIAkgKiBAc2luY2UgMy4wCiAJICovCiAJcHVibGljIHN0YXRpYyBmaW5hbCBT
aW1wbGVQcm9wZXJ0eURlc2NyaXB0b3IgRVhUUkFfRElNRU5TSU9OU19QUk9QRVJUWSA9CiAJCW5l
dyBTaW1wbGVQcm9wZXJ0eURlc2NyaXB0b3IoU2luZ2xlVmFyaWFibGVEZWNsYXJhdGlvbi5jbGFz
cywgImV4dHJhRGltZW5zaW9ucyIsIGludC5jbGFzcywgTUFOREFUT1JZKTsgLy8kTk9OLU5MUy0x
JAorCisJLyoqCisJICogVGhlICJleHRyYUFubm90YXRlZERpbWVuc2lvbnMiIHN0cnVjdHVyYWwg
cHJvcGVydHkgb2YgdGhpcyBub2RlIHR5cGUgKGNoaWxkIHR5cGU6IHtAbGluayBEaW1lbnNpb25U
eXBlfSkuCisJICogQHNpbmNlIDMuOQorCSAqLworCXB1YmxpYyBzdGF0aWMgZmluYWwgQ2hpbGRM
aXN0UHJvcGVydHlEZXNjcmlwdG9yIEVYVFJBX0RJTUVOU0lPTl9UWVBFU19QUk9QRVJUWSA9CisJ
CQluZXcgQ2hpbGRMaXN0UHJvcGVydHlEZXNjcmlwdG9yKFNpbmdsZVZhcmlhYmxlRGVjbGFyYXRp
b24uY2xhc3MsICJleHRyYURpbWVuc2lvblR5cGVzIiwgRGltZW5zaW9uVHlwZS5jbGFzcywgTk9f
Q1lDTEVfUklTSyk7IC8vJE5PTi1OTFMtMSQKIAogCS8qKgpAQCAtMjI2LDQgKzIzNCwxMSBAQAog
CiAJLyoqCisJICogVGhlIGV4dHJhIGRpbWVuc2lvbiB0eXBlcyB0aGlzIG5vZGUgaGFzIHdpdGgg
YW5ub3RhdGlvbnMgaWYgYW55LgorCSAqIAorCSAqIEBzaW5jZSAzLjkKKwkgKi8KKwlwcm90ZWN0
ZWQgQVNUTm9kZS5Ob2RlTGlzdCBleHRyYURpbWVuc2lvblR5cGVzID0gbnVsbDsKKworCS8qKgog
CSAqIFRoZSBpbml0aWFsaXplciBleHByZXNzaW9uLCBvciA8Y29kZT5udWxsPC9jb2RlPiBpZiBu
b25lOwogCSAqIGRlZmF1bHRzIHRvIG5vbmUuCkBAIC0yNTQsNCArMjY5LDUgQEAKIAkJCWlmIChh
c3QuYXBpTGV2ZWwgPj0gQVNULkpMUzgpIHsKIAkJCQl0aGlzLnZhcmFyZ3NBbm5vdGF0aW9ucyA9
IG5ldyBBU1ROb2RlLk5vZGVMaXN0KFZBUkFSR1NfQU5OT1RBVElPTlNfUFJPUEVSVFkpOworCQkJ
CXRoaXMuZXh0cmFEaW1lbnNpb25UeXBlcyA9IG5ldyBBU1ROb2RlLk5vZGVMaXN0KEVYVFJBX0RJ
TUVOU0lPTl9UWVBFU19QUk9QRVJUWSk7CiAJCQl9CiAJCX0KQEAgLTM5NSw1ICs0MTEsMTEgQEAK
IAkJfQogCQlyZXN1bHQuc2V0VHlwZSgoVHlwZSkgZ2V0VHlwZSgpLmNsb25lKHRhcmdldCkpOwot
CQlyZXN1bHQuc2V0RXh0cmFEaW1lbnNpb25zKGdldEV4dHJhRGltZW5zaW9ucygpKTsKKwkJaWYg
KHRoaXMuYXN0LmFwaUxldmVsID49IEFTVC5KTFM4KSB7CisJCQlyZXN1bHQuZXh0cmFEaW1lbnNp
b25UeXBlcyA9IG5ldyBBU1ROb2RlLk5vZGVMaXN0KEVYVFJBX0RJTUVOU0lPTl9UWVBFU19QUk9Q
RVJUWSk7CisJCQlyZXN1bHQuZXh0cmFEaW1lbnNpb25UeXBlcy5hZGRBbGwoCisJCQkJCUFTVE5v
ZGUuY29weVN1YnRyZWVzKHRhcmdldCwgdGhpcy5leHRyYURpbWVuc2lvblR5cGVzKSk7CisJCX0g
ZWxzZSB7CisJCQlyZXN1bHQuc2V0RXh0cmFEaW1lbnNpb25zKGdldEV4dHJhRGltZW5zaW9ucygp
KTsKKwkJfQogCQlyZXN1bHQuc2V0TmFtZSgoU2ltcGxlTmFtZSkgZ2V0TmFtZSgpLmNsb25lKHRh
cmdldCkpOwogCQlyZXN1bHQuc2V0SW5pdGlhbGl6ZXIoCkBAIC02MzksNCArNjYxLDUgQEAKIAkg
Ki8KIAlwdWJsaWMgaW50IGdldEV4dHJhRGltZW5zaW9ucygpIHsKKwkJc3VwcG9ydGVkT25seUlu
Ml8zXzQoKTsKIAkJcmV0dXJuIHRoaXMuZXh0cmFBcnJheURpbWVuc2lvbnM7CiAJfQpAQCAtNjQ3
LDQgKzY3MCw1IEBACiAJICovCiAJcHVibGljIHZvaWQgc2V0RXh0cmFEaW1lbnNpb25zKGludCBk
aW1lbnNpb25zKSB7CisJCXN1cHBvcnRlZE9ubHlJbjJfM180KCk7CiAJCWlmIChkaW1lbnNpb25z
IDwgMCkgewogCQkJdGhyb3cgbmV3IElsbGVnYWxBcmd1bWVudEV4Y2VwdGlvbigpOwpAQCAtNjU1
LDQgKzY3OSwxNSBAQAogCX0KIAorCS8qKgorCSAqIFJldHVybnMgdGhlIGxpdmUgb3JkZXJlZCBs
aXN0IG9mIGV4dHJhIGRpbWVuc2lvbnMgd2l0aCBhbm5vdGF0aW9ucyBpZiBhbnkuCisJICogCisJ
ICogQHJldHVybiB0aGUgbGl2ZSBsaXN0IG9mIGV4dHJhIGRpbWVuc2lvbnMgd2l0aCBhbm5vdGF0
aW9ucyBpZiBhbnkgKGVsZW1lbnQgdHlwZToge0BsaW5rIERpbWVuc2lvblR5cGV9W10pCisJICog
QHNpbmNlIDMuOQorCSAqLworCXB1YmxpYyBMaXN0IGdldEV4dHJhRGltZW5zaW9uVHlwZXMoKSB7
CisJCXVuc3VwcG9ydGVkSW4yXzNfNCgpOworCQlyZXR1cm4gdGhpcy5leHRyYURpbWVuc2lvblR5
cGVzOworCX0KKwkKIAkvKiAob21pdCBqYXZhZG9jIGZvciB0aGlzIG1ldGhvZCkKIAkgKiBNZXRo
b2QgZGVjbGFyZWQgb24gVmFyaWFibGVEZWNsYXJhdGlvbi4KZGlmZiAtLWdpdCBhL29yZy5lY2xp
cHNlLmpkdC5jb3JlL2RvbS9vcmcvZWNsaXBzZS9qZHQvY29yZS9kb20vVmFyaWFibGVEZWNsYXJh
dGlvbi5qYXZhIGIvb3JnLmVjbGlwc2UuamR0LmNvcmUvZG9tL29yZy9lY2xpcHNlL2pkdC9jb3Jl
L2RvbS9WYXJpYWJsZURlY2xhcmF0aW9uLmphdmEKaW5kZXggZmMzODhlOC4uODljZjI4MSAxMDA2
NDQKLS0tIGEvb3JnLmVjbGlwc2UuamR0LmNvcmUvZG9tL29yZy9lY2xpcHNlL2pkdC9jb3JlL2Rv
bS9WYXJpYWJsZURlY2xhcmF0aW9uLmphdmEKKysrIGIvb3JnLmVjbGlwc2UuamR0LmNvcmUvZG9t
L29yZy9lY2xpcHNlL2pkdC9jb3JlL2RvbS9WYXJpYWJsZURlY2xhcmF0aW9uLmphdmEKQEAgLTEy
LDQgKzEyLDYgQEAKIHBhY2thZ2Ugb3JnLmVjbGlwc2UuamR0LmNvcmUuZG9tOwogCitpbXBvcnQg
amF2YS51dGlsLkxpc3Q7CisKIC8qKgogICogQWJzdHJhY3QgYmFzZSBjbGFzcyBvZiBhbGwgQVNU
IG5vZGUgdHlwZXMgdGhhdCBkZWNsYXJlIGEgc2luZ2xlIGxvY2FsCkBAIC0xNTcsNCArMTU5LDE0
IEBACiAJcHVibGljIGFic3RyYWN0IHZvaWQgc2V0RXh0cmFEaW1lbnNpb25zKGludCBkaW1lbnNp
b25zKTsKIAorCQorCS8qKgorCSAqIFJldHVybnMgdGhlIGV4dHJhIGFubm90YXRhYmxlIGRpbWVu
c2lvbiB0eXBlcyBvZiB0aGUgc3BlY2lmaWVkIHR5cGUuIChKTFM4IG9ubHkpCisJICogCisJICog
QHJldHVybiB0aGUgbGlzdCBvZiBleHRyYSBkaW1lbnNpb24gdHlwZXMKKwkgKiBAZXhjZXB0aW9u
IElsbGVnYWxBcmd1bWVudEV4Y2VwdGlvbiBpZiBzcGVjaWZpZWQgYXBpIGxldmVsIGlzIGxvd2Vy
IHRoYW4gSkxTOC4KKwkgKiBAc2luY2UgMy45CisJICovCisJcHVibGljIGFic3RyYWN0IExpc3Qg
Z2V0RXh0cmFEaW1lbnNpb25UeXBlcygpOworCQogCS8qKgogCSAqIFJldHVybnMgdGhlIGluaXRp
YWxpemVyIG9mIHRoaXMgdmFyaWFibGUgZGVjbGFyYXRpb24sIG9yCmRpZmYgLS1naXQgYS9vcmcu
ZWNsaXBzZS5qZHQuY29yZS9kb20vb3JnL2VjbGlwc2UvamR0L2NvcmUvZG9tL1ZhcmlhYmxlRGVj
bGFyYXRpb25GcmFnbWVudC5qYXZhIGIvb3JnLmVjbGlwc2UuamR0LmNvcmUvZG9tL29yZy9lY2xp
cHNlL2pkdC9jb3JlL2RvbS9WYXJpYWJsZURlY2xhcmF0aW9uRnJhZ21lbnQuamF2YQppbmRleCBl
OWRlN2M4Li5hNTlmZTU5IDEwMDY0NAotLS0gYS9vcmcuZWNsaXBzZS5qZHQuY29yZS9kb20vb3Jn
L2VjbGlwc2UvamR0L2NvcmUvZG9tL1ZhcmlhYmxlRGVjbGFyYXRpb25GcmFnbWVudC5qYXZhCisr
KyBiL29yZy5lY2xpcHNlLmpkdC5jb3JlL2RvbS9vcmcvZWNsaXBzZS9qZHQvY29yZS9kb20vVmFy
aWFibGVEZWNsYXJhdGlvbkZyYWdtZW50LmphdmEKQEAgLTQ3LDQgKzQ3LDExIEBACiAKIAkvKioK
KwkgKiBUaGUgImV4dHJhQW5ub3RhdGVkRGltZW5zaW9ucyIgc3RydWN0dXJhbCBwcm9wZXJ0eSBv
ZiB0aGlzIG5vZGUgdHlwZSAoY2hpbGQgdHlwZToge0BsaW5rIERpbWVuc2lvblR5cGV9KS4KKwkg
KiBAc2luY2UgMy45CisJICovCisJcHVibGljIHN0YXRpYyBmaW5hbCBDaGlsZExpc3RQcm9wZXJ0
eURlc2NyaXB0b3IgRVhUUkFfRElNRU5TSU9OX1RZUEVTX1BST1BFUlRZID0KKwkJCW5ldyBDaGls
ZExpc3RQcm9wZXJ0eURlc2NyaXB0b3IoVmFyaWFibGVEZWNsYXJhdGlvbkZyYWdtZW50LmNsYXNz
LCAiZXh0cmFEaW1lbnNpb25UeXBlcyIsIERpbWVuc2lvblR5cGUuY2xhc3MsIE5PX0NZQ0xFX1JJ
U0spOyAvLyROT04tTkxTLTEkCisKKwkvKioKIAkgKiBUaGUgImluaXRpYWxpemVyIiBzdHJ1Y3R1
cmFsIHByb3BlcnR5IG9mIHRoaXMgbm9kZSB0eXBlIChjaGlsZCB0eXBlOiB7QGxpbmsgRXhwcmVz
c2lvbn0pLgogCSAqIEBzaW5jZSAzLjAKQEAgLTYwLDEyICs2NywzMCBAQAogCSAqLwogCXByaXZh
dGUgc3RhdGljIGZpbmFsIExpc3QgUFJPUEVSVFlfREVTQ1JJUFRPUlM7CisJCisJLyoqCisJICog
QSBsaXN0IG9mIHByb3BlcnR5IGRlc2NyaXB0b3JzIChlbGVtZW50IHR5cGU6CisJICoge0BsaW5r
IFN0cnVjdHVyYWxQcm9wZXJ0eURlc2NyaXB0b3J9KSwKKwkgKiBvciBudWxsIGlmIHVuaW5pdGlh
bGl6ZWQuCisJICogQHNpbmNlIDMuOQorCSAqLworCXByaXZhdGUgc3RhdGljIGZpbmFsIExpc3Qg
UFJPUEVSVFlfREVTQ1JJUFRPUlNfOF8wOwogCiAJc3RhdGljIHsKIAkJTGlzdCBwcm9wZXJ0eUxp
c3QgPSBuZXcgQXJyYXlMaXN0KDQpOwogCQljcmVhdGVQcm9wZXJ0eUxpc3QoVmFyaWFibGVEZWNs
YXJhdGlvbkZyYWdtZW50LmNsYXNzLCBwcm9wZXJ0eUxpc3QpOwotCQlhZGRQcm9wZXJ0eShOQU1F
X1BST1BFUlRZLCBwcm9wZXJ0eUxpc3QpOworCQlhZGRKTFMzUHJvcGVydGllcyhwcm9wZXJ0eUxp
c3QpOwogCQlhZGRQcm9wZXJ0eShFWFRSQV9ESU1FTlNJT05TX1BST1BFUlRZLCBwcm9wZXJ0eUxp
c3QpOwotCQlhZGRQcm9wZXJ0eShJTklUSUFMSVpFUl9QUk9QRVJUWSwgcHJvcGVydHlMaXN0KTsK
IAkJUFJPUEVSVFlfREVTQ1JJUFRPUlMgPSByZWFwUHJvcGVydHlMaXN0KHByb3BlcnR5TGlzdCk7
CisJCQorCQlwcm9wZXJ0eUxpc3QgPSBuZXcgQXJyYXlMaXN0KDQpOworCQljcmVhdGVQcm9wZXJ0
eUxpc3QoVmFyaWFibGVEZWNsYXJhdGlvbkZyYWdtZW50LmNsYXNzLCBwcm9wZXJ0eUxpc3QpOwor
CQlhZGRKTFMzUHJvcGVydGllcyhwcm9wZXJ0eUxpc3QpOworCQlhZGRQcm9wZXJ0eShFWFRSQV9E
SU1FTlNJT05fVFlQRVNfUFJPUEVSVFksIHByb3BlcnR5TGlzdCk7CisJCVBST1BFUlRZX0RFU0NS
SVBUT1JTXzhfMCA9IHJlYXBQcm9wZXJ0eUxpc3QocHJvcGVydHlMaXN0KTsKKwl9CisKKwlwcml2
YXRlIHN0YXRpYyB2b2lkIGFkZEpMUzNQcm9wZXJ0aWVzKExpc3QgcHJvcGVydHlMaXN0KSB7CisJ
CWFkZFByb3BlcnR5KE5BTUVfUFJPUEVSVFksIHByb3BlcnR5TGlzdCk7CisJCWFkZFByb3BlcnR5
KElOSVRJQUxJWkVSX1BST1BFUlRZLCBwcm9wZXJ0eUxpc3QpOwogCX0KIApAQCAtODEsNSArMTA2
LDkgQEAKIAkgKi8KIAlwdWJsaWMgc3RhdGljIExpc3QgcHJvcGVydHlEZXNjcmlwdG9ycyhpbnQg
YXBpTGV2ZWwpIHsKLQkJcmV0dXJuIFBST1BFUlRZX0RFU0NSSVBUT1JTOworCQlpZiAoYXBpTGV2
ZWwgPj0gQVNULkpMUzgpIHsKKwkJCXJldHVybiBQUk9QRVJUWV9ERVNDUklQVE9SU184XzA7CisJ
CX0gZWxzZSB7CisJCQlyZXR1cm4gUFJPUEVSVFlfREVTQ1JJUFRPUlM7CisJCX0KIAl9CiAKQEAg
LTk1LDQgKzEyNCwxMSBAQAogCSAqLwogCXByaXZhdGUgaW50IGV4dHJhQXJyYXlEaW1lbnNpb25z
ID0gMDsKKwkKKwkvKioKKwkgKiBUaGUgZXh0cmEgZGltZW5zaW9uIHR5cGVzIHRoaXMgbm9kZSBo
YXMgd2l0aCBhbm5vdGF0aW9ucyBpZiBhbnkuCisJICogCisJICogQHNpbmNlIDMuOQorCSAqLwor
CXByb3RlY3RlZCBBU1ROb2RlLk5vZGVMaXN0IGV4dHJhRGltZW5zaW9uVHlwZXMgPSBudWxsOwog
CiAJLyoqCkBAIC0xMTQsNCArMTUwLDcgQEAKIAlWYXJpYWJsZURlY2xhcmF0aW9uRnJhZ21lbnQo
QVNUIGFzdCkgewogCQlzdXBlcihhc3QpOworCQlpZiAoYXN0LmFwaUxldmVsID49IEFTVC5KTFM4
KSB7CisJCQl0aGlzLmV4dHJhRGltZW5zaW9uVHlwZXMgPSBuZXcgQVNUTm9kZS5Ob2RlTGlzdChF
WFRSQV9ESU1FTlNJT05fVFlQRVNfUFJPUEVSVFkpOworCQl9CiAJfQogCkBAIC0xOTAsNCArMjI5
LDE1IEBACiAJICogTWV0aG9kIGRlY2xhcmVkIG9uIEFTVE5vZGUuCiAJICovCisJZmluYWwgTGlz
dCBpbnRlcm5hbEdldENoaWxkTGlzdFByb3BlcnR5KENoaWxkTGlzdFByb3BlcnR5RGVzY3JpcHRv
ciBwcm9wZXJ0eSkgeworCQlpZiAocHJvcGVydHkgPT0gRVhUUkFfRElNRU5TSU9OX1RZUEVTX1BS
T1BFUlRZKSB7CisJCQlyZXR1cm4gdGhpcy5leHRyYURpbWVuc2lvblR5cGVzOworCQl9CisJCS8v
IGFsbG93IGRlZmF1bHQgaW1wbGVtZW50YXRpb24gdG8gZmxhZyB0aGUgZXJyb3IKKwkJcmV0dXJu
IHN1cGVyLmludGVybmFsR2V0Q2hpbGRMaXN0UHJvcGVydHkocHJvcGVydHkpOworCX0KKworCS8q
IChvbWl0IGphdmFkb2MgZm9yIHRoaXMgbWV0aG9kKQorCSAqIE1ldGhvZCBkZWNsYXJlZCBvbiBB
U1ROb2RlLgorCSAqLwogCWZpbmFsIGludCBnZXROb2RlVHlwZTAoKSB7CiAJCXJldHVybiBWQVJJ
QUJMRV9ERUNMQVJBVElPTl9GUkFHTUVOVDsKQEAgLTIwMSw1ICsyNTEsMTEgQEAKIAkJcmVzdWx0
LnNldFNvdXJjZVJhbmdlKGdldFN0YXJ0UG9zaXRpb24oKSwgZ2V0TGVuZ3RoKCkpOwogCQlyZXN1
bHQuc2V0TmFtZSgoU2ltcGxlTmFtZSkgZ2V0TmFtZSgpLmNsb25lKHRhcmdldCkpOwotCQlyZXN1
bHQuc2V0RXh0cmFEaW1lbnNpb25zKGdldEV4dHJhRGltZW5zaW9ucygpKTsKKwkJaWYgKHRoaXMu
YXN0LmFwaUxldmVsID49IEFTVC5KTFM4KSB7CisJCQlyZXN1bHQuZXh0cmFEaW1lbnNpb25UeXBl
cyA9IG5ldyBBU1ROb2RlLk5vZGVMaXN0KEVYVFJBX0RJTUVOU0lPTl9UWVBFU19QUk9QRVJUWSk7
CisJCQlyZXN1bHQuZXh0cmFEaW1lbnNpb25UeXBlcy5hZGRBbGwoCisJCQkJCUFTVE5vZGUuY29w
eVN1YnRyZWVzKHRhcmdldCwgdGhpcy5leHRyYURpbWVuc2lvblR5cGVzKSk7CisJCX0gZWxzZSB7
CisJCQlyZXN1bHQuc2V0RXh0cmFEaW1lbnNpb25zKGdldEV4dHJhRGltZW5zaW9ucygpKTsKKwkJ
fQogCQlyZXN1bHQuc2V0SW5pdGlhbGl6ZXIoCiAJCQkoRXhwcmVzc2lvbikgQVNUTm9kZS5jb3B5
U3VidHJlZSh0YXJnZXQsIGdldEluaXRpYWxpemVyKCkpKTsKQEAgLTIyNCw0ICsyODAsOCBAQAog
CQkJYWNjZXB0Q2hpbGQodmlzaXRvciwgZ2V0TmFtZSgpKTsKIAkJCWFjY2VwdENoaWxkKHZpc2l0
b3IsIGdldEluaXRpYWxpemVyKCkpOworCQkJCisJCQlpZiAodGhpcy5hc3QuYXBpTGV2ZWwgPj0g
QVNULkpMUzgpIHsKKwkJCQlhY2NlcHRDaGlsZHJlbih2aXNpdG9yLCB0aGlzLmV4dHJhRGltZW5z
aW9uVHlwZXMpOworCQkJfQogCQl9CiAJCXZpc2l0b3IuZW5kVmlzaXQodGhpcyk7CkBAIC0yNzMs
NCArMzMzLDUgQEAKIAkgKi8KIAlwdWJsaWMgaW50IGdldEV4dHJhRGltZW5zaW9ucygpIHsKKwkJ
c3VwcG9ydGVkT25seUluMl8zXzQoKTsKIAkJcmV0dXJuIHRoaXMuZXh0cmFBcnJheURpbWVuc2lv
bnM7CiAJfQpAQCAtMjkwLDQgKzM1MSw1IEBACiAJICovCiAJcHVibGljIHZvaWQgc2V0RXh0cmFE
aW1lbnNpb25zKGludCBkaW1lbnNpb25zKSB7CisJCXN1cHBvcnRlZE9ubHlJbjJfM180KCk7CiAJ
CWlmIChkaW1lbnNpb25zIDwgMCkgewogCQkJdGhyb3cgbmV3IElsbGVnYWxBcmd1bWVudEV4Y2Vw
dGlvbigpOwpAQCAtMjk3LDUgKzM1OSwxNiBAQAogCQlwb3N0VmFsdWVDaGFuZ2UoRVhUUkFfRElN
RU5TSU9OU19QUk9QRVJUWSk7CiAJfQotCisJCisJLyoqCisJICogUmV0dXJucyB0aGUgbGl2ZSBv
cmRlcmVkIGxpc3Qgb2YgZXh0cmEgZGltZW5zaW9ucyB3aXRoIGFubm90YXRpb25zIGlmIGFueS4K
KwkgKiAKKwkgKiBAcmV0dXJuIHRoZSBsaXZlIGxpc3Qgb2YgZXh0cmEgZGltZW5zaW9ucyB3aXRo
IGFubm90YXRpb25zIGlmIGFueSAoZWxlbWVudCB0eXBlOiB7QGxpbmsgRGltZW5zaW9uVHlwZX1b
XSkKKwkgKiBAc2luY2UgMy45CisJICovCisJcHVibGljIExpc3QgZ2V0RXh0cmFEaW1lbnNpb25U
eXBlcygpIHsKKwkJdW5zdXBwb3J0ZWRJbjJfM180KCk7CisJCXJldHVybiB0aGlzLmV4dHJhRGlt
ZW5zaW9uVHlwZXM7CisJfQorCQogCS8qIChvbWl0IGphdmFkb2MgZm9yIHRoaXMgbWV0aG9kKQog
CSAqIE1ldGhvZCBkZWNsYXJlZCBvbiBWYXJpYWJsZURlY2xhcmF0aW9uLgpkaWZmIC0tZ2l0IGEv
b3JnLmVjbGlwc2UuamR0LmNvcmUvZG9tL29yZy9lY2xpcHNlL2pkdC9jb3JlL2RvbS9XaWxkY2Fy
ZFR5cGUuamF2YSBiL29yZy5lY2xpcHNlLmpkdC5jb3JlL2RvbS9vcmcvZWNsaXBzZS9qZHQvY29y
ZS9kb20vV2lsZGNhcmRUeXBlLmphdmEKaW5kZXggYWQ4ZmU4Yy4uOWYyMjIyMyAxMDA2NDQKLS0t
IGEvb3JnLmVjbGlwc2UuamR0LmNvcmUvZG9tL29yZy9lY2xpcHNlL2pkdC9jb3JlL2RvbS9XaWxk
Y2FyZFR5cGUuamF2YQorKysgYi9vcmcuZWNsaXBzZS5qZHQuY29yZS9kb20vb3JnL2VjbGlwc2Uv
amR0L2NvcmUvZG9tL1dpbGRjYXJkVHlwZS5qYXZhCkBAIC0yMDYsNSArMjA2LDQgQEAKIAkJcmVz
dWx0LnNldEJvdW5kKChUeXBlKSBBU1ROb2RlLmNvcHlTdWJ0cmVlKHRhcmdldCwgZ2V0Qm91bmQo
KSksIGlzVXBwZXJCb3VuZCgpKTsKIAkJaWYgKHRoaXMuYXN0LmFwaUxldmVsID49IEFTVC5KTFM4
KSB7Ci0JCQlyZXN1bHQuYW5ub3RhdGlvbnMgPSBuZXcgQVNUTm9kZS5Ob2RlTGlzdChBTk5PVEFU
SU9OU19QUk9QRVJUWSk7CiAJCQlyZXN1bHQuYW5ub3RhdGlvbnMuYWRkQWxsKAogCQkJCQlBU1RO
b2RlLmNvcHlTdWJ0cmVlcyh0YXJnZXQsIGFubm90YXRpb25zKCkpKTsKZGlmZiAtLWdpdCBhL29y
Zy5lY2xpcHNlLmpkdC5jb3JlL2RvbS9vcmcvZWNsaXBzZS9qZHQvaW50ZXJuYWwvY29yZS9kb20v
TmFpdmVBU1RGbGF0dGVuZXIuamF2YSBiL29yZy5lY2xpcHNlLmpkdC5jb3JlL2RvbS9vcmcvZWNs
aXBzZS9qZHQvaW50ZXJuYWwvY29yZS9kb20vTmFpdmVBU1RGbGF0dGVuZXIuamF2YQppbmRleCBh
OGIyMDczLi5hZTQ0YzE3IDEwMDY0NAotLS0gYS9vcmcuZWNsaXBzZS5qZHQuY29yZS9kb20vb3Jn
L2VjbGlwc2UvamR0L2ludGVybmFsL2NvcmUvZG9tL05haXZlQVNURmxhdHRlbmVyLmphdmEKKysr
IGIvb3JnLmVjbGlwc2UuamR0LmNvcmUvZG9tL29yZy9lY2xpcHNlL2pkdC9pbnRlcm5hbC9jb3Jl
L2RvbS9OYWl2ZUFTVEZsYXR0ZW5lci5qYXZhCkBAIC00Niw0ICs0Niw1IEBACiBpbXBvcnQgb3Jn
LmVjbGlwc2UuamR0LmNvcmUuZG9tLkNvbnN0cnVjdG9ySW52b2NhdGlvbjsKIGltcG9ydCBvcmcu
ZWNsaXBzZS5qZHQuY29yZS5kb20uQ29udGludWVTdGF0ZW1lbnQ7CitpbXBvcnQgb3JnLmVjbGlw
c2UuamR0LmNvcmUuZG9tLkRpbWVuc2lvblR5cGU7CiBpbXBvcnQgb3JnLmVjbGlwc2UuamR0LmNv
cmUuZG9tLlVuaW9uVHlwZTsKIGltcG9ydCBvcmcuZWNsaXBzZS5qZHQuY29yZS5kb20uRG9TdGF0
ZW1lbnQ7CkBAIC00MTQsNCArNDE1LDE0IEBACiAJCXZpc2l0VHlwZUFubm90YXRpb25zKG5vZGUp
OwogCQl0aGlzLmJ1ZmZlci5hcHBlbmQoIltdIik7Ly8kTk9OLU5MUy0xJAorCQlyZXR1cm4gZmFs
c2U7CisJfQorCisJcHVibGljIGJvb2xlYW4gdmlzaXQoRGltZW5zaW9uVHlwZSBub2RlKSB7CisJ
CXZpc2l0VHlwZUFubm90YXRpb25zKG5vZGUpOworCQl0aGlzLmJ1ZmZlci5hcHBlbmQoIlsiKTsg
Ly8kTk9OLU5MUy0xJAorCQlpZiAobm9kZS5leHByZXNzaW9uKCkgIT0gbnVsbCkgeworCQkJbm9k
ZS5leHByZXNzaW9uKCkuYWNjZXB0KHRoaXMpOworCQl9CisJCXRoaXMuYnVmZmVyLmFwcGVuZCgi
XSIpOyAvLyROT04tTkxTLTEkCiAJCXJldHVybiBmYWxzZTsKIAl9CkBAIC0xMDIyLDYgKzEwMzMs
OSBAQAogCQl9CiAJCXRoaXMuYnVmZmVyLmFwcGVuZCgiKSIpOy8vJE5PTi1OTFMtMSQKLQkJZm9y
IChpbnQgaSA9IDA7IGkgPCBub2RlLmdldEV4dHJhRGltZW5zaW9ucygpOyBpKyspIHsKLQkJCXRo
aXMuYnVmZmVyLmFwcGVuZCgiW10iKTsgLy8kTk9OLU5MUy0xJAorCQlpZiAobm9kZS5nZXRBU1Qo
KS5hcGlMZXZlbCgpID49IEFTVC5KTFM4KSB7CisJCQlMaXN0IGRpbWVuc2lvbnMgPSBub2RlLmdl
dGV4dHJhRGltZW5zaW9uVHlwZXMoKTsKKwkJCWZvciAoaW50IGkgPSAwOyBpIDwgZGltZW5zaW9u
cy5zaXplKCk7IGkrKykgeworCQkJCXZpc2l0KChEaW1lbnNpb25UeXBlKSBkaW1lbnNpb25zLmdl
dChpKSk7CisJCQl9CiAJCX0KIAkJaWYgKCFub2RlLnRocm93bkV4Y2VwdGlvbnMoKS5pc0VtcHR5
KCkpIHsKQEAgLTEzMzcsNiArMTM1MSw5IEBACiAJCXRoaXMuYnVmZmVyLmFwcGVuZCgiICIpOy8v
JE5PTi1OTFMtMSQKIAkJbm9kZS5nZXROYW1lKCkuYWNjZXB0KHRoaXMpOwotCQlmb3IgKGludCBp
ID0gMDsgaSA8IG5vZGUuZ2V0RXh0cmFEaW1lbnNpb25zKCk7IGkrKykgewotCQkJdGhpcy5idWZm
ZXIuYXBwZW5kKCJbXSIpOyAvLyROT04tTkxTLTEkCisJCWlmIChub2RlLmdldEFTVCgpLmFwaUxl
dmVsKCkgPj0gQVNULkpMUzgpIHsKKwkJCUxpc3QgZGltZW5zaW9ucyA9IG5vZGUuZ2V0RXh0cmFE
aW1lbnNpb25UeXBlcygpOworCQkJZm9yIChpbnQgaSA9IDA7IGkgPCBkaW1lbnNpb25zLnNpemUo
KTsgaSsrKSB7CisJCQkJdmlzaXQoKERpbWVuc2lvblR5cGUpIGRpbWVuc2lvbnMuZ2V0KGkpKTsK
KwkJCX0KIAkJfQogCQlpZiAobm9kZS5nZXRJbml0aWFsaXplcigpICE9IG51bGwpIHsKQEAgLTE3
NTgsNiArMTc3NSw5IEBACiAJcHVibGljIGJvb2xlYW4gdmlzaXQoVmFyaWFibGVEZWNsYXJhdGlv
bkZyYWdtZW50IG5vZGUpIHsKIAkJbm9kZS5nZXROYW1lKCkuYWNjZXB0KHRoaXMpOwotCQlmb3Ig
KGludCBpID0gMDsgaSA8IG5vZGUuZ2V0RXh0cmFEaW1lbnNpb25zKCk7IGkrKykgewotCQkJdGhp
cy5idWZmZXIuYXBwZW5kKCJbXSIpOy8vJE5PTi1OTFMtMSQKKwkJaWYgKG5vZGUuZ2V0QVNUKCku
YXBpTGV2ZWwoKSA+PSBBU1QuSkxTOCkgeworCQkJTGlzdCBkaW1lbnNpb25zID0gbm9kZS5nZXRF
eHRyYURpbWVuc2lvblR5cGVzKCk7CisJCQlmb3IgKGludCBpID0gMDsgaSA8IGRpbWVuc2lvbnMu
c2l6ZSgpOyBpKyspIHsKKwkJCQl2aXNpdCgoRGltZW5zaW9uVHlwZSkgZGltZW5zaW9ucy5nZXQo
aSkpOworCQkJfQogCQl9CiAJCWlmIChub2RlLmdldEluaXRpYWxpemVyKCkgIT0gbnVsbCkgewpA
QCAtMTgyNSw1ICsxODQ1LDUgQEAKIAkJaWYgKG5vZGUuZ2V0QVNUKCkuYXBpTGV2ZWwoKSA+PSBB
U1QuSkxTOCkgewogCQkJTGlzdCBhbm5vdGF0aW9ucyA9IG5vZGUuYW5ub3RhdGlvbnMoKTsKLQkJ
CWlmIChhbm5vdGF0aW9ucyAhPSBudWxsKSB7CisJCQlpZiAoYW5ub3RhdGlvbnMgIT0gbnVsbCAm
JiBhbm5vdGF0aW9ucy5zaXplKCkgPiAwKSB7CiAJCQkJZm9yIChJdGVyYXRvciBpdCA9IGFubm90
YXRpb25zLml0ZXJhdG9yKCk7IGl0Lmhhc05leHQoKTsgKSB7CiAJCQkJCUFubm90YXRpb24gYW5u
b3RhdGlvbiA9IChBbm5vdGF0aW9uKSBpdC5uZXh0KCk7CkBAIC0xODM3LDUgKzE4NTcsNSBAQAog
CQlpZiAobm9kZS5nZXRBU1QoKS5hcGlMZXZlbCgpID49IEFTVC5KTFM4KSB7CiAJCQlMaXN0IGFu
bm90YXRpb25zID0gbm9kZS5hbm5vdGF0aW9ucygpOwotCQkJaWYgKGFubm90YXRpb25zICE9IG51
bGwpIHsKKwkJCWlmIChhbm5vdGF0aW9ucyAhPSBudWxsICYmIGFubm90YXRpb25zLnNpemUoKSA+
IDApIHsKIAkJCQlmb3IgKEl0ZXJhdG9yIGl0ID0gYW5ub3RhdGlvbnMuaXRlcmF0b3IoKTsgaXQu
aGFzTmV4dCgpOyApIHsKIAkJCQkJQW5ub3RhdGlvbiBhbm5vdGF0aW9uID0gKEFubm90YXRpb24p
IGl0Lm5leHQoKTsKZGlmZiAtLWdpdCBhL29yZy5lY2xpcHNlLmpkdC5jb3JlL2RvbS9vcmcvZWNs
aXBzZS9qZHQvaW50ZXJuYWwvY29yZS9kb20vcmV3cml0ZS9BU1RSZXdyaXRlRmxhdHRlbmVyLmph
dmEgYi9vcmcuZWNsaXBzZS5qZHQuY29yZS9kb20vb3JnL2VjbGlwc2UvamR0L2ludGVybmFsL2Nv
cmUvZG9tL3Jld3JpdGUvQVNUUmV3cml0ZUZsYXR0ZW5lci5qYXZhCmluZGV4IDE0ZDJiNTkuLjU4
YWIyZTAgMTAwNjQ0Ci0tLSBhL29yZy5lY2xpcHNlLmpkdC5jb3JlL2RvbS9vcmcvZWNsaXBzZS9q
ZHQvaW50ZXJuYWwvY29yZS9kb20vcmV3cml0ZS9BU1RSZXdyaXRlRmxhdHRlbmVyLmphdmEKKysr
IGIvb3JnLmVjbGlwc2UuamR0LmNvcmUvZG9tL29yZy9lY2xpcHNlL2pkdC9pbnRlcm5hbC9jb3Jl
L2RvbS9yZXdyaXRlL0FTVFJld3JpdGVGbGF0dGVuZXIuamF2YQpAQCAtMSw0ICsxLDQgQEAKIC8q
KioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioq
KioqKioqKioqKioqKioqKioqKioqCi0gKiBDb3B5cmlnaHQgKGMpIDIwMDAsIDIwMTIgSUJNIENv
cnBvcmF0aW9uIGFuZCBvdGhlcnMuCisgKiBDb3B5cmlnaHQgKGMpIDIwMDAsIDIwMTMgSUJNIENv
cnBvcmF0aW9uIGFuZCBvdGhlcnMuCiAgKiBBbGwgcmlnaHRzIHJlc2VydmVkLiBUaGlzIHByb2dy
YW0gYW5kIHRoZSBhY2NvbXBhbnlpbmcgbWF0ZXJpYWxzCiAgKiBhcmUgbWFkZSBhdmFpbGFibGUg
dW5kZXIgdGhlIHRlcm1zIG9mIHRoZSBFY2xpcHNlIFB1YmxpYyBMaWNlbnNlIHYxLjAKQEAgLTIy
Nyw3ICsyMjcsMTcgQEAKIAkJZ2V0Q2hpbGROb2RlKG5vZGUsIEFycmF5VHlwZS5DT01QT05FTlRf
VFlQRV9QUk9QRVJUWSkuYWNjZXB0KHRoaXMpOwogCQlpZiAobm9kZS5nZXRBU1QoKS5hcGlMZXZl
bCgpID49IEFTVC5KTFM4KSB7Ci0JCQl2aXNpdExpc3Qobm9kZSwgQXJyYXlUeXBlLkFOTk9UQVRJ
T05TX1BST1BFUlRZLCBTdHJpbmcudmFsdWVPZignICcpLCBVdGlsLkVNUFRZX1NUUklORywgU3Ry
aW5nLnZhbHVlT2YoJyAnKSk7CisJCQl2aXNpdExpc3Qobm9kZSwgQXJyYXlUeXBlLkFOTk9UQVRJ
T05TX1BST1BFUlRZLCBTdHJpbmcudmFsdWVPZignICcpLCBVdGlsLkVNUFRZX1NUUklORywgVXRp
bC5FTVBUWV9TVFJJTkcpOwogCQl9CiAJCXRoaXMucmVzdWx0LmFwcGVuZCgiW10iKTsgLy8kTk9O
LU5MUy0xJAorCQlyZXR1cm4gZmFsc2U7CisJfQorCQorCXB1YmxpYyBib29sZWFuIHZpc2l0KERp
bWVuc2lvblR5cGUgbm9kZSkgeworCQl2aXNpdExpc3Qobm9kZSwgQXJyYXlUeXBlLkFOTk9UQVRJ
T05TX1BST1BFUlRZLCBTdHJpbmcudmFsdWVPZignICcpLCBVdGlsLkVNUFRZX1NUUklORywgVXRp
bC5FTVBUWV9TVFJJTkcpOworCQl0aGlzLnJlc3VsdC5hcHBlbmQoIlsiKTsgLy8kTk9OLU5MUy0x
JAorCQlpZiAobm9kZS5leHByZXNzaW9uKCkgIT0gbnVsbCkgeworCQkJbm9kZS5leHByZXNzaW9u
KCkuYWNjZXB0KHRoaXMpOworCQl9CisJCXRoaXMucmVzdWx0LmFwcGVuZCgiXSIpOyAvLyROT04t
TkxTLTEkCiAJCXJldHVybiBmYWxzZTsKIAl9CkBAIC03OTUsNyArODA1LDExIEBACiAJCXRoaXMu
cmVzdWx0LmFwcGVuZCgnICcpOwogCQlnZXRDaGlsZE5vZGUobm9kZSwgU2luZ2xlVmFyaWFibGVE
ZWNsYXJhdGlvbi5OQU1FX1BST1BFUlRZKS5hY2NlcHQodGhpcyk7Ci0JCWludCBleHRyYURpbWVu
c2lvbnM9IGdldEludEF0dHJpYnV0ZShub2RlLCBTaW5nbGVWYXJpYWJsZURlY2xhcmF0aW9uLkVY
VFJBX0RJTUVOU0lPTlNfUFJPUEVSVFkpOwotCQlmb3IgKGludCBpID0gMDsgaSA8IGV4dHJhRGlt
ZW5zaW9uczsgaSsrKSB7Ci0JCQl0aGlzLnJlc3VsdC5hcHBlbmQoIltdIik7IC8vJE5PTi1OTFMt
MSQKKwkJaWYgKG5vZGUuZ2V0QVNUKCkuYXBpTGV2ZWwoKSA+PSBBU1QuSkxTOCkgeworCQkJdmlz
aXRMaXN0KG5vZGUsIFNpbmdsZVZhcmlhYmxlRGVjbGFyYXRpb24uRVhUUkFfRElNRU5TSU9OX1RZ
UEVTX1BST1BFUlRZLCBTdHJpbmcudmFsdWVPZignICcpLCBVdGlsLkVNUFRZX1NUUklORywgVXRp
bC5FTVBUWV9TVFJJTkcpOworCQl9IGVsc2UgeworCQkJaW50IGV4dHJhRGltZW5zaW9ucz0gZ2V0
SW50QXR0cmlidXRlKG5vZGUsIFNpbmdsZVZhcmlhYmxlRGVjbGFyYXRpb24uRVhUUkFfRElNRU5T
SU9OU19QUk9QRVJUWSk7CisJCQlmb3IgKGludCBpID0gMDsgaSA8IGV4dHJhRGltZW5zaW9uczsg
aSsrKSB7CisJCQkJdGhpcy5yZXN1bHQuYXBwZW5kKCJbXSIpOyAvLyROT04tTkxTLTEkCisJCQl9
CiAJCX0KIAkJQVNUTm9kZSBpbml0aWFsaXplcj0gZ2V0Q2hpbGROb2RlKG5vZGUsIFNpbmdsZVZh
cmlhYmxlRGVjbGFyYXRpb24uSU5JVElBTElaRVJfUFJPUEVSVFkpOwpAQCAtMTA0MCw3ICsxMDU0
LDExIEBACiAJcHVibGljIGJvb2xlYW4gdmlzaXQoVmFyaWFibGVEZWNsYXJhdGlvbkZyYWdtZW50
IG5vZGUpIHsKIAkJZ2V0Q2hpbGROb2RlKG5vZGUsIFZhcmlhYmxlRGVjbGFyYXRpb25GcmFnbWVu
dC5OQU1FX1BST1BFUlRZKS5hY2NlcHQodGhpcyk7Ci0JCWludCBleHRyYURpbWVuc2lvbnM9IGdl
dEludEF0dHJpYnV0ZShub2RlLCBWYXJpYWJsZURlY2xhcmF0aW9uRnJhZ21lbnQuRVhUUkFfRElN
RU5TSU9OU19QUk9QRVJUWSk7Ci0JCWZvciAoaW50IGkgPSAwOyBpIDwgZXh0cmFEaW1lbnNpb25z
OyBpKyspIHsKLQkJCXRoaXMucmVzdWx0LmFwcGVuZCgiW10iKTsgLy8kTk9OLU5MUy0xJAorCQlp
ZiAobm9kZS5nZXRBU1QoKS5hcGlMZXZlbCgpID49IEFTVC5KTFM4KSB7CisJCQl2aXNpdExpc3Qo
bm9kZSwgVmFyaWFibGVEZWNsYXJhdGlvbkZyYWdtZW50LkVYVFJBX0RJTUVOU0lPTl9UWVBFU19Q
Uk9QRVJUWSwgU3RyaW5nLnZhbHVlT2YoJyAnKSwgVXRpbC5FTVBUWV9TVFJJTkcsIFV0aWwuRU1Q
VFlfU1RSSU5HKTsKKwkJfSBlbHNlIHsKKwkJCWludCBleHRyYURpbWVuc2lvbnM9IGdldEludEF0
dHJpYnV0ZShub2RlLCBWYXJpYWJsZURlY2xhcmF0aW9uRnJhZ21lbnQuRVhUUkFfRElNRU5TSU9O
U19QUk9QRVJUWSk7CisJCQlmb3IgKGludCBpID0gMDsgaSA8IGV4dHJhRGltZW5zaW9uczsgaSsr
KSB7CisJCQkJdGhpcy5yZXN1bHQuYXBwZW5kKCJbXSIpOyAvLyROT04tTkxTLTEkCisJCQl9CiAJ
CX0KIAkJQVNUTm9kZSBpbml0aWFsaXplcj0gZ2V0Q2hpbGROb2RlKG5vZGUsIFZhcmlhYmxlRGVj
bGFyYXRpb25GcmFnbWVudC5JTklUSUFMSVpFUl9QUk9QRVJUWSk7
</data>

          </attachment>
          <attachment
              isobsolete="1"
              ispatch="1"
              isprivate="0"
          >
            <attachid>225573</attachid>
            <date>2013-01-14 11:02:00 -0500</date>
            <delta_ts>2013-01-25 01:07:07 -0500</delta_ts>
            <desc>Updated patch</desc>
            <filename>Fix-for-bug-391895.patch</filename>
            <type>text/plain</type>
            <size>70959</size>
            <attacher name="Jay Arthanareeswaran">jarthana</attacher>
            
              <data encoding="base64">ZGlmZiAtLWdpdCBhL29yZy5lY2xpcHNlLmpkdC5jb3JlLnRlc3RzLm1vZGVsL3NyYy9vcmcvZWNs
aXBzZS9qZHQvY29yZS90ZXN0cy9kb20vQVNUQ29udmVydGVyMTVKTFM4VGVzdC5qYXZhIGIvb3Jn
LmVjbGlwc2UuamR0LmNvcmUudGVzdHMubW9kZWwvc3JjL29yZy9lY2xpcHNlL2pkdC9jb3JlL3Rl
c3RzL2RvbS9BU1RDb252ZXJ0ZXIxNUpMUzhUZXN0LmphdmEKaW5kZXggZjRiMTUyOC4uODc0NjI0
MCAxMDA2NDQKLS0tIGEvb3JnLmVjbGlwc2UuamR0LmNvcmUudGVzdHMubW9kZWwvc3JjL29yZy9l
Y2xpcHNlL2pkdC9jb3JlL3Rlc3RzL2RvbS9BU1RDb252ZXJ0ZXIxNUpMUzhUZXN0LmphdmEKKysr
IGIvb3JnLmVjbGlwc2UuamR0LmNvcmUudGVzdHMubW9kZWwvc3JjL29yZy9lY2xpcHNlL2pkdC9j
b3JlL3Rlc3RzL2RvbS9BU1RDb252ZXJ0ZXIxNUpMUzhUZXN0LmphdmEKQEAgLTUxNyw1ICs1MTcs
NSBAQAogCQltb2RpZmllciA9IChJRXh0ZW5kZWRNb2RpZmllcikgbW9kaWZpZXJzLmdldCgxKTsK
IAkJY2hlY2tTb3VyY2VSYW5nZSgoQVNUTm9kZSkgbW9kaWZpZXIsICJmaW5hbCIsIHNvdXJjZSk7
Ci0JCWFzc2VydEVxdWFscygiV3JvbmcgZGltZW5zaW9uIiwgMSwgc2luZ2xlVmFyaWFibGVEZWNs
YXJhdGlvbi5nZXRFeHRyYURpbWVuc2lvbnMoKSk7CisJCWFzc2VydEVxdWFscygiV3JvbmcgZGlt
ZW5zaW9uIiwgMSwgc2luZ2xlVmFyaWFibGVEZWNsYXJhdGlvbi5nZXRFeHRyYURpbWVuc2lvblR5
cGVzKCkuc2l6ZSgpKTsKIAkJVHlwZSB0eXBlID0gc2luZ2xlVmFyaWFibGVEZWNsYXJhdGlvbi5n
ZXRUeXBlKCk7CiAJCWNoZWNrU291cmNlUmFuZ2UodHlwZSwgIlN0cmluZyIsIHNvdXJjZSk7CkBA
IC0xNzEwLDUgKzE3MTAsNSBAQAogCQlBcnJheVR5cGUgYXJyYXlUeXBlID0gKEFycmF5VHlwZSkg
dHlwZTsKIAkJY2hlY2tTb3VyY2VSYW5nZShhcnJheVR5cGUuZ2V0Q29tcG9uZW50VHlwZSgpLCAi
U3RyaW5nIiwgc291cmNlKTsKLQkJYXNzZXJ0RXF1YWxzKCJXcm9uZyBleHRyYSBkaW1lbnNpb25z
IiwgMSwgc2luZ2xlVmFyaWFibGVEZWNsYXJhdGlvbi5nZXRFeHRyYURpbWVuc2lvbnMoKSk7CisJ
CWFzc2VydEVxdWFscygiV3JvbmcgZXh0cmEgZGltZW5zaW9ucyIsIDEsIHNpbmdsZVZhcmlhYmxl
RGVjbGFyYXRpb24uZ2V0RXh0cmFEaW1lbnNpb25UeXBlcygpLnNpemUoKSk7CiAJfQogCkBAIC0x
NzM4LDUgKzE3MzgsNSBAQAogCQlBcnJheVR5cGUgYXJyYXlUeXBlID0gKEFycmF5VHlwZSkgdHlw
ZTsKIAkJY2hlY2tTb3VyY2VSYW5nZShhcnJheVR5cGUuZ2V0Q29tcG9uZW50VHlwZSgpLCAiU3Ry
aW5nIiwgc291cmNlKTsKLQkJYXNzZXJ0RXF1YWxzKCJXcm9uZyBleHRyYSBkaW1lbnNpb25zIiwg
MCwgc2luZ2xlVmFyaWFibGVEZWNsYXJhdGlvbi5nZXRFeHRyYURpbWVuc2lvbnMoKSk7CisJCWFz
c2VydEVxdWFscygiV3JvbmcgZXh0cmEgZGltZW5zaW9ucyIsIDAsIHNpbmdsZVZhcmlhYmxlRGVj
bGFyYXRpb24uZ2V0RXh0cmFEaW1lbnNpb25UeXBlcygpLnNpemUoKSk7CiAJfQogCS8qKgpkaWZm
IC0tZ2l0IGEvb3JnLmVjbGlwc2UuamR0LmNvcmUudGVzdHMubW9kZWwvc3JjL29yZy9lY2xpcHNl
L2pkdC9jb3JlL3Rlc3RzL2RvbS9BU1RDb252ZXJ0ZXIxOFRlc3QuamF2YSBiL29yZy5lY2xpcHNl
LmpkdC5jb3JlLnRlc3RzLm1vZGVsL3NyYy9vcmcvZWNsaXBzZS9qZHQvY29yZS90ZXN0cy9kb20v
QVNUQ29udmVydGVyMThUZXN0LmphdmEKaW5kZXggNzkxMDc3Yy4uNmRjNWRjMiAxMDA2NDQKLS0t
IGEvb3JnLmVjbGlwc2UuamR0LmNvcmUudGVzdHMubW9kZWwvc3JjL29yZy9lY2xpcHNlL2pkdC9j
b3JlL3Rlc3RzL2RvbS9BU1RDb252ZXJ0ZXIxOFRlc3QuamF2YQorKysgYi9vcmcuZWNsaXBzZS5q
ZHQuY29yZS50ZXN0cy5tb2RlbC9zcmMvb3JnL2VjbGlwc2UvamR0L2NvcmUvdGVzdHMvZG9tL0FT
VENvbnZlcnRlcjE4VGVzdC5qYXZhCkBAIC02MSw1ICs2MSw1IEBACiAJICovCiAJLy8gaHR0cHM6
Ly9idWdzLmVjbGlwc2Uub3JnL2J1Z3Mvc2hvd19idWcuY2dpP2lkPTM5MTg5OAotCXB1YmxpYyB2
b2lkIHRlc3QwMDAxKCkgdGhyb3dzIEphdmFNb2RlbEV4Y2VwdGlvbiB7CisJcHVibGljIHZvaWQg
dGVzdEJ1ZzM5MTg5OCgpIHRocm93cyBKYXZhTW9kZWxFeGNlcHRpb24gewogCQlTdHJpbmcgY29u
dGVudHMgPQogCQkJIiAgICBAamF2YS5sYW5nLmFubm90YXRpb24uVGFyZ2V0IChqYXZhLmxhbmcu
YW5ub3RhdGlvbi5FbGVtZW50VHlwZS5UWVBFX1VTRSlcbiIgKwpkaWZmIC0tZ2l0IGEvb3JnLmVj
bGlwc2UuamR0LmNvcmUudGVzdHMubW9kZWwvc3JjL29yZy9lY2xpcHNlL2pkdC9jb3JlL3Rlc3Rz
L2RvbS9BU1RDb252ZXJ0ZXJBU1Q4VGVzdC5qYXZhIGIvb3JnLmVjbGlwc2UuamR0LmNvcmUudGVz
dHMubW9kZWwvc3JjL29yZy9lY2xpcHNlL2pkdC9jb3JlL3Rlc3RzL2RvbS9BU1RDb252ZXJ0ZXJB
U1Q4VGVzdC5qYXZhCmluZGV4IDkyN2FiM2YuLmM5NzY5ODEgMTAwNjQ0Ci0tLSBhL29yZy5lY2xp
cHNlLmpkdC5jb3JlLnRlc3RzLm1vZGVsL3NyYy9vcmcvZWNsaXBzZS9qZHQvY29yZS90ZXN0cy9k
b20vQVNUQ29udmVydGVyQVNUOFRlc3QuamF2YQorKysgYi9vcmcuZWNsaXBzZS5qZHQuY29yZS50
ZXN0cy5tb2RlbC9zcmMvb3JnL2VjbGlwc2UvamR0L2NvcmUvdGVzdHMvZG9tL0FTVENvbnZlcnRl
ckFTVDhUZXN0LmphdmEKQEAgLTM4LDQgKzM4LDUgQEAKIAlzdGF0aWMgewogLy8JCVRFU1RTX05V
TUJFUlMgPSBuZXcgaW50W10geyAzNTYgfTsKKy8vCQlURVNUU19OQU1FUyA9IG5ldyBTdHJpbmdb
XXsgInRlc3QwMzkzIiB9OwogCX0KIAlwdWJsaWMgc3RhdGljIFRlc3Qgc3VpdGUoKSB7CkBAIC0x
OTkzLDUgKzE5OTQsNSBAQAogCQlhc3NlcnRUcnVlKCJCb3RoIEFTVCB0cmVlcyBzaG91bGQgYmUg
aWRlbnRpY2FsIiwgdmFyaWFibGVEZWNsYXJhdGlvbi5zdWJ0cmVlTWF0Y2gobmV3IEFTVE1hdGNo
ZXIoKSwgbm9kZSkpOwkJLy8kTk9OLU5MUy0xJAogCQljaGVja1NvdXJjZVJhbmdlKG5vZGUsICJm
aW5hbCBTdHJpbmcgcyIsIHNvdXJjZSk7IC8vJE5PTi1OTFMtMSQKLQkJYXNzZXJ0RXF1YWxzKCJX
cm9uZyBkaW1lbnNpb24iLCAwLCBub2RlLmdldEV4dHJhRGltZW5zaW9ucygpKTsgLy8kTk9OLU5M
Uy0xJAorCQlhc3NlcnRFcXVhbHMoIldyb25nIGRpbWVuc2lvbiIsIDAsIG5vZGUuZ2V0RXh0cmFE
aW1lbnNpb25UeXBlcygpLnNpemUoKSk7IC8vJE5PTi1OTFMtMSQKIAl9CiAKQEAgLTI3MTksMTgg
KzI3MjAsMjEgQEAKIAkJbGl0ZXJhbC5zZXRUb2tlbigiMTAiKTsvLyROT04tTkxTLTEkCiAJCWZy
YWdtZW50LnNldEluaXRpYWxpemVyKGxpdGVyYWwpOwotCQlmcmFnbWVudC5zZXRFeHRyYURpbWVu
c2lvbnMoMCk7CisJCWZyYWdtZW50LmdldEV4dHJhRGltZW5zaW9uVHlwZXMoKS5jbGVhcigpOwog
CQlWYXJpYWJsZURlY2xhcmF0aW9uU3RhdGVtZW50IHN0YXRlbWVudCA9IHRoaXMuYXN0Lm5ld1Zh
cmlhYmxlRGVjbGFyYXRpb25TdGF0ZW1lbnQoZnJhZ21lbnQpOwogCQlmcmFnbWVudCA9IHRoaXMu
YXN0Lm5ld1ZhcmlhYmxlRGVjbGFyYXRpb25GcmFnbWVudCgpOwogCQlmcmFnbWVudC5zZXROYW1l
KHRoaXMuYXN0Lm5ld1NpbXBsZU5hbWUoInoiKSk7Ly8kTk9OLU5MUy0xJAogCQlmcmFnbWVudC5z
ZXRJbml0aWFsaXplcih0aGlzLmFzdC5uZXdOdWxsTGl0ZXJhbCgpKTsKLQkJZnJhZ21lbnQuc2V0
RXh0cmFEaW1lbnNpb25zKDEpOworCQlmcmFnbWVudC5nZXRFeHRyYURpbWVuc2lvblR5cGVzKCku
Y2xlYXIoKTsKKwkJZnJhZ21lbnQuZ2V0RXh0cmFEaW1lbnNpb25UeXBlcygpLmFkZCh0aGlzLmFz
dC5uZXdEaW1lbnNpb24obnVsbCkpOwogCQlzdGF0ZW1lbnQuZnJhZ21lbnRzKCkuYWRkKGZyYWdt
ZW50KTsKIAkJZnJhZ21lbnQgPSB0aGlzLmFzdC5uZXdWYXJpYWJsZURlY2xhcmF0aW9uRnJhZ21l
bnQoKTsKIAkJZnJhZ21lbnQuc2V0TmFtZSh0aGlzLmFzdC5uZXdTaW1wbGVOYW1lKCJpIikpOy8v
JE5PTi1OTFMtMSQKLQkJZnJhZ21lbnQuc2V0RXh0cmFEaW1lbnNpb25zKDApOworCQlmcmFnbWVu
dC5nZXRFeHRyYURpbWVuc2lvblR5cGVzKCkuY2xlYXIoKTsKIAkJc3RhdGVtZW50LmZyYWdtZW50
cygpLmFkZChmcmFnbWVudCk7CiAJCWZyYWdtZW50ID0gdGhpcy5hc3QubmV3VmFyaWFibGVEZWNs
YXJhdGlvbkZyYWdtZW50KCk7CiAJCWZyYWdtZW50LnNldE5hbWUodGhpcy5hc3QubmV3U2ltcGxl
TmFtZSgiaiIpKTsvLyROT04tTkxTLTEkCi0JCWZyYWdtZW50LnNldEV4dHJhRGltZW5zaW9ucygy
KTsKKwkJZnJhZ21lbnQuZ2V0RXh0cmFEaW1lbnNpb25UeXBlcygpLmNsZWFyKCk7CisJCWZyYWdt
ZW50LmdldEV4dHJhRGltZW5zaW9uVHlwZXMoKS5hZGQodGhpcy5hc3QubmV3RGltZW5zaW9uKG51
bGwpKTsKKwkJZnJhZ21lbnQuZ2V0RXh0cmFEaW1lbnNpb25UeXBlcygpLmFkZCh0aGlzLmFzdC5u
ZXdEaW1lbnNpb24obnVsbCkpOwogCQlzdGF0ZW1lbnQuZnJhZ21lbnRzKCkuYWRkKGZyYWdtZW50
KTsKIAkJc3RhdGVtZW50LnNldFR5cGUodGhpcy5hc3QubmV3UHJpbWl0aXZlVHlwZShQcmltaXRp
dmVUeXBlLklOVCkpOwpAQCAtMjc1OSwxOCArMjc2MywyMSBAQAogCQlsaXRlcmFsLnNldFRva2Vu
KCIxMCIpOy8vJE5PTi1OTFMtMSQKIAkJZnJhZ21lbnQuc2V0SW5pdGlhbGl6ZXIobGl0ZXJhbCk7
Ci0JCWZyYWdtZW50LnNldEV4dHJhRGltZW5zaW9ucygwKTsKKwkJZnJhZ21lbnQuZ2V0RXh0cmFE
aW1lbnNpb25UeXBlcygpLmNsZWFyKCk7CiAJCVZhcmlhYmxlRGVjbGFyYXRpb25TdGF0ZW1lbnQg
c3RhdGVtZW50ID0gdGhpcy5hc3QubmV3VmFyaWFibGVEZWNsYXJhdGlvblN0YXRlbWVudChmcmFn
bWVudCk7CiAJCWZyYWdtZW50ID0gdGhpcy5hc3QubmV3VmFyaWFibGVEZWNsYXJhdGlvbkZyYWdt
ZW50KCk7CiAJCWZyYWdtZW50LnNldE5hbWUodGhpcy5hc3QubmV3U2ltcGxlTmFtZSgieiIpKTsv
LyROT04tTkxTLTEkCiAJCWZyYWdtZW50LnNldEluaXRpYWxpemVyKHRoaXMuYXN0Lm5ld051bGxM
aXRlcmFsKCkpOwotCQlmcmFnbWVudC5zZXRFeHRyYURpbWVuc2lvbnMoMSk7CisJCWZyYWdtZW50
LmdldEV4dHJhRGltZW5zaW9uVHlwZXMoKS5jbGVhcigpOworCQlmcmFnbWVudC5nZXRFeHRyYURp
bWVuc2lvblR5cGVzKCkuYWRkKHRoaXMuYXN0Lm5ld0RpbWVuc2lvbihudWxsKSk7CiAJCXN0YXRl
bWVudC5mcmFnbWVudHMoKS5hZGQoZnJhZ21lbnQpOwogCQlmcmFnbWVudCA9IHRoaXMuYXN0Lm5l
d1ZhcmlhYmxlRGVjbGFyYXRpb25GcmFnbWVudCgpOwogCQlmcmFnbWVudC5zZXROYW1lKHRoaXMu
YXN0Lm5ld1NpbXBsZU5hbWUoImkiKSk7Ly8kTk9OLU5MUy0xJAotCQlmcmFnbWVudC5zZXRFeHRy
YURpbWVuc2lvbnMoMCk7CisJCWZyYWdtZW50LmdldEV4dHJhRGltZW5zaW9uVHlwZXMoKS5jbGVh
cigpOwogCQlzdGF0ZW1lbnQuZnJhZ21lbnRzKCkuYWRkKGZyYWdtZW50KTsKIAkJZnJhZ21lbnQg
PSB0aGlzLmFzdC5uZXdWYXJpYWJsZURlY2xhcmF0aW9uRnJhZ21lbnQoKTsKIAkJZnJhZ21lbnQu
c2V0TmFtZSh0aGlzLmFzdC5uZXdTaW1wbGVOYW1lKCJqIikpOy8vJE5PTi1OTFMtMSQKLQkJZnJh
Z21lbnQuc2V0RXh0cmFEaW1lbnNpb25zKDIpOworCQlmcmFnbWVudC5nZXRFeHRyYURpbWVuc2lv
blR5cGVzKCkuY2xlYXIoKTsKKwkJZnJhZ21lbnQuZ2V0RXh0cmFEaW1lbnNpb25UeXBlcygpLmFk
ZCh0aGlzLmFzdC5uZXdEaW1lbnNpb24obnVsbCkpOworCQlmcmFnbWVudC5nZXRFeHRyYURpbWVu
c2lvblR5cGVzKCkuYWRkKHRoaXMuYXN0Lm5ld0RpbWVuc2lvbihudWxsKSk7CiAJCXN0YXRlbWVu
dC5mcmFnbWVudHMoKS5hZGQoZnJhZ21lbnQpOwogCQlzdGF0ZW1lbnQuc2V0VHlwZSh0aGlzLmFz
dC5uZXdBcnJheVR5cGUodGhpcy5hc3QubmV3UHJpbWl0aXZlVHlwZShQcmltaXRpdmVUeXBlLklO
VCksIDEpKTsKQEAgLTI3OTgsNSArMjgwNSw2IEBACiAJCXZhcmlhYmxlRGVjbGFyYXRpb25GcmFn
bWVudC5zZXROYW1lKHRoaXMuYXN0Lm5ld1NpbXBsZU5hbWUoInRhYiIpKTsgLy8kTk9OLU5MUy0x
JAogCQl2YXJpYWJsZURlY2xhcmF0aW9uRnJhZ21lbnQuc2V0SW5pdGlhbGl6ZXIodGhpcy5hc3Qu
bmV3TnVsbExpdGVyYWwoKSk7Ly8kTk9OLU5MUy0xJAotCQl2YXJpYWJsZURlY2xhcmF0aW9uRnJh
Z21lbnQuc2V0RXh0cmFEaW1lbnNpb25zKDEpOworCQl2YXJpYWJsZURlY2xhcmF0aW9uRnJhZ21l
bnQuZ2V0RXh0cmFEaW1lbnNpb25UeXBlcygpLmNsZWFyKCk7CisJCXZhcmlhYmxlRGVjbGFyYXRp
b25GcmFnbWVudC5nZXRFeHRyYURpbWVuc2lvblR5cGVzKCkuYWRkKHRoaXMuYXN0Lm5ld0RpbWVu
c2lvbihudWxsKSk7CiAJCVZhcmlhYmxlRGVjbGFyYXRpb25FeHByZXNzaW9uIHZhcmlhYmxlRGVj
bGFyYXRpb25FeHByZXNzaW9uID0gdGhpcy5hc3QubmV3VmFyaWFibGVEZWNsYXJhdGlvbkV4cHJl
c3Npb24odmFyaWFibGVEZWNsYXJhdGlvbkZyYWdtZW50KTsKIAkJdmFyaWFibGVEZWNsYXJhdGlv
bkV4cHJlc3Npb24uc2V0VHlwZSh0aGlzLmFzdC5uZXdBcnJheVR5cGUodGhpcy5hc3QubmV3U2lt
cGxlVHlwZSh0aGlzLmFzdC5uZXdTaW1wbGVOYW1lKCJTdHJpbmciKSksIDEpKTsvLyROT04tTkxT
LTEkCkBAIC0yODI2LDUgKzI4MzQsNiBAQAogCQl2YXJpYWJsZURlY2xhcmF0aW9uRnJhZ21lbnQu
c2V0TmFtZSh0aGlzLmFzdC5uZXdTaW1wbGVOYW1lKCJ0YWIiKSk7IC8vJE5PTi1OTFMtMSQKIAkJ
dmFyaWFibGVEZWNsYXJhdGlvbkZyYWdtZW50LnNldEluaXRpYWxpemVyKHRoaXMuYXN0Lm5ld051
bGxMaXRlcmFsKCkpOy8vJE5PTi1OTFMtMSQKLQkJdmFyaWFibGVEZWNsYXJhdGlvbkZyYWdtZW50
LnNldEV4dHJhRGltZW5zaW9ucygxKTsKKwkJdmFyaWFibGVEZWNsYXJhdGlvbkZyYWdtZW50Lmdl
dEV4dHJhRGltZW5zaW9uVHlwZXMoKS5jbGVhcigpOworCQl2YXJpYWJsZURlY2xhcmF0aW9uRnJh
Z21lbnQuZ2V0RXh0cmFEaW1lbnNpb25UeXBlcygpLmFkZCh0aGlzLmFzdC5uZXdEaW1lbnNpb24o
bnVsbCkpOwogCQlWYXJpYWJsZURlY2xhcmF0aW9uRXhwcmVzc2lvbiB2YXJpYWJsZURlY2xhcmF0
aW9uRXhwcmVzc2lvbiA9IHRoaXMuYXN0Lm5ld1ZhcmlhYmxlRGVjbGFyYXRpb25FeHByZXNzaW9u
KHZhcmlhYmxlRGVjbGFyYXRpb25GcmFnbWVudCk7CiAJCXZhcmlhYmxlRGVjbGFyYXRpb25FeHBy
ZXNzaW9uLnNldFR5cGUodGhpcy5hc3QubmV3U2ltcGxlVHlwZSh0aGlzLmFzdC5uZXdTaW1wbGVO
YW1lKCJTdHJpbmciKSkpOy8vJE5PTi1OTFMtMSQKQEAgLTI4NTQsNSArMjg2Myw2IEBACiAJCXZh
cmlhYmxlRGVjbGFyYXRpb25GcmFnbWVudC5zZXROYW1lKHRoaXMuYXN0Lm5ld1NpbXBsZU5hbWUo
InRhYiIpKTsgLy8kTk9OLU5MUy0xJAogCQl2YXJpYWJsZURlY2xhcmF0aW9uRnJhZ21lbnQuc2V0
SW5pdGlhbGl6ZXIodGhpcy5hc3QubmV3TnVsbExpdGVyYWwoKSk7Ly8kTk9OLU5MUy0xJAotCQl2
YXJpYWJsZURlY2xhcmF0aW9uRnJhZ21lbnQuc2V0RXh0cmFEaW1lbnNpb25zKDEpOworCQl2YXJp
YWJsZURlY2xhcmF0aW9uRnJhZ21lbnQuZ2V0RXh0cmFEaW1lbnNpb25UeXBlcygpLmNsZWFyKCk7
CisJCXZhcmlhYmxlRGVjbGFyYXRpb25GcmFnbWVudC5nZXRFeHRyYURpbWVuc2lvblR5cGVzKCku
YWRkKHRoaXMuYXN0Lm5ld0RpbWVuc2lvbihudWxsKSk7CiAJCVZhcmlhYmxlRGVjbGFyYXRpb25F
eHByZXNzaW9uIHZhcmlhYmxlRGVjbGFyYXRpb25FeHByZXNzaW9uID0gdGhpcy5hc3QubmV3VmFy
aWFibGVEZWNsYXJhdGlvbkV4cHJlc3Npb24odmFyaWFibGVEZWNsYXJhdGlvbkZyYWdtZW50KTsK
IAkJdmFyaWFibGVEZWNsYXJhdGlvbkV4cHJlc3Npb24uc2V0VHlwZSh0aGlzLmFzdC5uZXdTaW1w
bGVUeXBlKHRoaXMuYXN0Lm5ld1NpbXBsZU5hbWUoIlN0cmluZyIpKSk7Ly8kTk9OLU5MUy0xJApA
QCAtMjg4Myw1ICsyODkzLDUgQEAKIAkJVmFyaWFibGVEZWNsYXJhdGlvbkZyYWdtZW50IGZyYWdt
ZW50ID0gdGhpcy5hc3QubmV3VmFyaWFibGVEZWNsYXJhdGlvbkZyYWdtZW50KCk7CiAJCWZyYWdt
ZW50LnNldE5hbWUodGhpcy5hc3QubmV3U2ltcGxlTmFtZSgiaSIpKTsgLy8kTk9OLU5MUy0xJAot
CQlmcmFnbWVudC5zZXRFeHRyYURpbWVuc2lvbnMoMCk7CisJCWZyYWdtZW50LmdldEV4dHJhRGlt
ZW5zaW9uVHlwZXMoKS5jbGVhcigpOwogCQlGaWVsZERlY2xhcmF0aW9uIGZpZWxkRGVjbGFyYXRp
b24gPSB0aGlzLmFzdC5uZXdGaWVsZERlY2xhcmF0aW9uKGZyYWdtZW50KTsKIAkJZmllbGREZWNs
YXJhdGlvbi5zZXRUeXBlKHRoaXMuYXN0Lm5ld1ByaW1pdGl2ZVR5cGUoUHJpbWl0aXZlVHlwZS5J
TlQpKTsKQEAgLTI5MDUsNSArMjkxNSw1IEBACiAJCWxpdGVyYWwuc2V0VG9rZW4oIjEwIik7IC8v
JE5PTi1OTFMtMSQKIAkJZnJhZ21lbnQuc2V0SW5pdGlhbGl6ZXIobGl0ZXJhbCk7Ci0JCWZyYWdt
ZW50LnNldEV4dHJhRGltZW5zaW9ucygwKTsKKwkJZnJhZ21lbnQuZ2V0RXh0cmFEaW1lbnNpb25U
eXBlcygpLmNsZWFyKCk7CiAJCUZpZWxkRGVjbGFyYXRpb24gZmllbGREZWNsYXJhdGlvbiA9IHRo
aXMuYXN0Lm5ld0ZpZWxkRGVjbGFyYXRpb24oZnJhZ21lbnQpOwogCQlmaWVsZERlY2xhcmF0aW9u
Lm1vZGlmaWVycygpLmFkZCh0aGlzLmFzdC5uZXdNb2RpZmllcihNb2RpZmllci5Nb2RpZmllcktl
eXdvcmQuUFVCTElDX0tFWVdPUkQpKTsKQEAgLTI5MTEsMTQgKzI5MjEsMTcgQEAKIAkJZnJhZ21l
bnQgPSB0aGlzLmFzdC5uZXdWYXJpYWJsZURlY2xhcmF0aW9uRnJhZ21lbnQoKTsKIAkJZnJhZ21l
bnQuc2V0TmFtZSh0aGlzLmFzdC5uZXdTaW1wbGVOYW1lKCJ5IikpOy8vJE5PTi1OTFMtMSQKLQkJ
ZnJhZ21lbnQuc2V0RXh0cmFEaW1lbnNpb25zKDEpOworCQlmcmFnbWVudC5nZXRFeHRyYURpbWVu
c2lvblR5cGVzKCkuY2xlYXIoKTsKKwkJZnJhZ21lbnQuZ2V0RXh0cmFEaW1lbnNpb25UeXBlcygp
LmFkZCh0aGlzLmFzdC5uZXdEaW1lbnNpb24obnVsbCkpOwogCQlmcmFnbWVudC5zZXRJbml0aWFs
aXplcih0aGlzLmFzdC5uZXdOdWxsTGl0ZXJhbCgpKTsKIAkJZmllbGREZWNsYXJhdGlvbi5mcmFn
bWVudHMoKS5hZGQoZnJhZ21lbnQpOwogCQlmcmFnbWVudCA9IHRoaXMuYXN0Lm5ld1ZhcmlhYmxl
RGVjbGFyYXRpb25GcmFnbWVudCgpOwogCQlmcmFnbWVudC5zZXROYW1lKHRoaXMuYXN0Lm5ld1Np
bXBsZU5hbWUoImkiKSk7Ly8kTk9OLU5MUy0xJAotCQlmcmFnbWVudC5zZXRFeHRyYURpbWVuc2lv
bnMoMCk7CisJCWZyYWdtZW50LmdldEV4dHJhRGltZW5zaW9uVHlwZXMoKS5jbGVhcigpOwogCQlm
aWVsZERlY2xhcmF0aW9uLmZyYWdtZW50cygpLmFkZChmcmFnbWVudCk7CiAJCWZyYWdtZW50ID0g
dGhpcy5hc3QubmV3VmFyaWFibGVEZWNsYXJhdGlvbkZyYWdtZW50KCk7CiAJCWZyYWdtZW50LnNl
dE5hbWUodGhpcy5hc3QubmV3U2ltcGxlTmFtZSgiaiIpKTsvLyROT04tTkxTLTEkCi0JCWZyYWdt
ZW50LnNldEV4dHJhRGltZW5zaW9ucygyKTsKKwkJZnJhZ21lbnQuZ2V0RXh0cmFEaW1lbnNpb25U
eXBlcygpLmNsZWFyKCk7CisJCWZyYWdtZW50LmdldEV4dHJhRGltZW5zaW9uVHlwZXMoKS5hZGQo
dGhpcy5hc3QubmV3RGltZW5zaW9uKG51bGwpKTsKKwkJZnJhZ21lbnQuZ2V0RXh0cmFEaW1lbnNp
b25UeXBlcygpLmFkZCh0aGlzLmFzdC5uZXdEaW1lbnNpb24obnVsbCkpOwogCQlmaWVsZERlY2xh
cmF0aW9uLmZyYWdtZW50cygpLmFkZChmcmFnbWVudCk7CiAJCWFzc2VydFRydWUoIkJvdGggQVNU
IHRyZWVzIHNob3VsZCBiZSBpZGVudGljYWwiLCBmaWVsZERlY2xhcmF0aW9uLnN1YnRyZWVNYXRj
aChuZXcgQVNUTWF0Y2hlcigpLCBub2RlKSk7CQkvLyROT04tTkxTLTEkCkBAIC05NTkyLDQgKzk2
MDUsNiBAQAogCQlhc3NlcnRFcXVhbHMoIldyb25nIHF1YWxpZmllZCBuYW1lIiwgImphdmEubGFu
Zy5TdHJpbmdbXSIsIHR5cGVCaW5kaW5nMi5nZXRRdWFsaWZpZWROYW1lKCkpOyAvLyROT04tTkxT
LTEkIC8vJE5PTi1OTFMtMiQKIAkJYXNzZXJ0RXF1YWxzKCJXcm9uZyBkaW1lbnNpb24iLCAxLCB0
eXBlQmluZGluZzIuZ2V0RGltZW5zaW9ucygpKTsgLy8kTk9OLU5MUy0xJAorCQlMaXN0IGV4dHJh
RGltZW5zaW9ucyA9IG1ldGhvZERlY2xhcmF0aW9uLmdldGV4dHJhRGltZW5zaW9uVHlwZXMoKTsK
KwkJYXNzZXJ0RXh0cmFEaW1lbnNpb25zRXF1YWwoIldyb25nIGV4dHJhIGRpbWVuc2lvbiBpbmZv
IiwgZXh0cmFEaW1lbnNpb25zLCAiW10gIik7CiAJfQogCkBAIC05NjY0LDUgKzk2NzksNSBAQAog
CQlUeXBlIHR5cGUgPSBzaW5nbGVWYXJpYWJsZURlY2xhcmF0aW9uLmdldFR5cGUoKTsKIAkJY2hl
Y2tTb3VyY2VSYW5nZSh0eXBlLCAiU3RyaW5nIiwgc291cmNlKTsgLy8kTk9OLU5MUy0xJAotCQlh
c3NlcnRFcXVhbHMoIldyb25nIGRpbWVuc2lvbiIsIDEsIHNpbmdsZVZhcmlhYmxlRGVjbGFyYXRp
b24uZ2V0RXh0cmFEaW1lbnNpb25zKCkpOyAvLyROT04tTkxTLTEkCisJCWFzc2VydEVxdWFscygi
V3JvbmcgZGltZW5zaW9uIiwgMSwgc2luZ2xlVmFyaWFibGVEZWNsYXJhdGlvbi5nZXRFeHRyYURp
bWVuc2lvblR5cGVzKCkuc2l6ZSgpKTsgLy8kTk9OLU5MUy0xJAogCQlJVHlwZUJpbmRpbmcgdHlw
ZUJpbmRpbmcgPSB0eXBlLnJlc29sdmVCaW5kaW5nKCk7CiAJCWFzc2VydE5vdE51bGwoIk5vIHR5
cGUgYmluZGluZyIsIHR5cGVCaW5kaW5nKTsgLy8kTk9OLU5MUy0xJApAQCAtOTY3OCw0ICs5Njkz
LDYgQEAKIAkJYXNzZXJ0RXF1YWxzKCJXcm9uZyBkaW1lbnNpb24iLCAxLCB0eXBlQmluZGluZzIu
Z2V0RGltZW5zaW9ucygpKTsgLy8kTk9OLU5MUy0xJAogCQlhc3NlcnRFcXVhbHMoIndyb25nIGZ1
bGx5IHF1YWxpZmllZCBuYW1lIiwgImphdmEubGFuZy5TdHJpbmdbXSIsIHR5cGVCaW5kaW5nMi5n
ZXRRdWFsaWZpZWROYW1lKCkpOyAvLyROT04tTkxTLTEkIC8vJE5PTi1OTFMtMiQKKwkJTGlzdCBl
eHRyYURpbWVuc2lvbnMgPSBzaW5nbGVWYXJpYWJsZURlY2xhcmF0aW9uLmdldEV4dHJhRGltZW5z
aW9uVHlwZXMoKTsKKwkJYXNzZXJ0RXh0cmFEaW1lbnNpb25zRXF1YWwoIldyb25nIGV4dHJhIGRp
bWVuc2lvbiBpbmZvIiwgZXh0cmFEaW1lbnNpb25zLCAiW10gIik7CiAJfQogCkBAIC05Njk2LDUg
Kzk3MTMsNSBAQAogCQlUeXBlIHR5cGUgPSBzaW5nbGVWYXJpYWJsZURlY2xhcmF0aW9uLmdldFR5
cGUoKTsKIAkJY2hlY2tTb3VyY2VSYW5nZSh0eXBlLCAiU3RyaW5nW10iLCBzb3VyY2UpOyAvLyRO
T04tTkxTLTEkCi0JCWFzc2VydEVxdWFscygiV3JvbmcgZGltZW5zaW9uIiwgMiwgc2luZ2xlVmFy
aWFibGVEZWNsYXJhdGlvbi5nZXRFeHRyYURpbWVuc2lvbnMoKSk7IC8vJE5PTi1OTFMtMSQKKwkJ
YXNzZXJ0RXF1YWxzKCJXcm9uZyBkaW1lbnNpb24iLCAyLCBzaW5nbGVWYXJpYWJsZURlY2xhcmF0
aW9uLmdldEV4dHJhRGltZW5zaW9uVHlwZXMoKS5zaXplKCkpOyAvLyROT04tTkxTLTEkCiAJCUlU
eXBlQmluZGluZyB0eXBlQmluZGluZyA9IHR5cGUucmVzb2x2ZUJpbmRpbmcoKTsKIAkJYXNzZXJ0
Tm90TnVsbCgiTm8gdHlwZSBiaW5kaW5nIiwgdHlwZUJpbmRpbmcpOyAvLyROT04tTkxTLTEkCmRp
ZmYgLS1naXQgYS9vcmcuZWNsaXBzZS5qZHQuY29yZS50ZXN0cy5tb2RlbC9zcmMvb3JnL2VjbGlw
c2UvamR0L2NvcmUvdGVzdHMvZG9tL0FTVENvbnZlcnRlclRlc3RBU1Q4XzIuamF2YSBiL29yZy5l
Y2xpcHNlLmpkdC5jb3JlLnRlc3RzLm1vZGVsL3NyYy9vcmcvZWNsaXBzZS9qZHQvY29yZS90ZXN0
cy9kb20vQVNUQ29udmVydGVyVGVzdEFTVDhfMi5qYXZhCmluZGV4IGM3MjVjYjcuLjFjN2M2MWIg
MTAwNjQ0Ci0tLSBhL29yZy5lY2xpcHNlLmpkdC5jb3JlLnRlc3RzLm1vZGVsL3NyYy9vcmcvZWNs
aXBzZS9qZHQvY29yZS90ZXN0cy9kb20vQVNUQ29udmVydGVyVGVzdEFTVDhfMi5qYXZhCisrKyBi
L29yZy5lY2xpcHNlLmpkdC5jb3JlLnRlc3RzLm1vZGVsL3NyYy9vcmcvZWNsaXBzZS9qZHQvY29y
ZS90ZXN0cy9kb20vQVNUQ29udmVydGVyVGVzdEFTVDhfMi5qYXZhCkBAIC0yNzg0LDUgKzI3ODQs
NSBAQAogCQlhc3NlcnRFcXVhbHMoIndyb25nIHNpemUiLCAxLCBmcmFnbWVudHMuc2l6ZSgpKTsK
IAkJVmFyaWFibGVEZWNsYXJhdGlvbkZyYWdtZW50IGZyYWdtZW50ID0gKFZhcmlhYmxlRGVjbGFy
YXRpb25GcmFnbWVudCkgZnJhZ21lbnRzLmdldCgwKTsKLQkJYXNzZXJ0RXF1YWxzKCJ3cm9uZyBl
eHRyYSBkaW1lbnNpb24iLCAxLCBmcmFnbWVudC5nZXRFeHRyYURpbWVuc2lvbnMoKSk7CisJCWFz
c2VydEVxdWFscygid3JvbmcgZXh0cmEgZGltZW5zaW9uIiwgMSwgZnJhZ21lbnQuZ2V0RXh0cmFE
aW1lbnNpb25UeXBlcygpLnNpemUoKSk7CiAJfQogCmRpZmYgLS1naXQgYS9vcmcuZWNsaXBzZS5q
ZHQuY29yZS50ZXN0cy5tb2RlbC9zcmMvb3JnL2VjbGlwc2UvamR0L2NvcmUvdGVzdHMvZG9tL0Nv
bnZlcnRlclRlc3RTZXR1cC5qYXZhIGIvb3JnLmVjbGlwc2UuamR0LmNvcmUudGVzdHMubW9kZWwv
c3JjL29yZy9lY2xpcHNlL2pkdC9jb3JlL3Rlc3RzL2RvbS9Db252ZXJ0ZXJUZXN0U2V0dXAuamF2
YQppbmRleCBjZGJjNGEwLi5iZjNiOTUzIDEwMDY0NAotLS0gYS9vcmcuZWNsaXBzZS5qZHQuY29y
ZS50ZXN0cy5tb2RlbC9zcmMvb3JnL2VjbGlwc2UvamR0L2NvcmUvdGVzdHMvZG9tL0NvbnZlcnRl
clRlc3RTZXR1cC5qYXZhCisrKyBiL29yZy5lY2xpcHNlLmpkdC5jb3JlLnRlc3RzLm1vZGVsL3Ny
Yy9vcmcvZWNsaXBzZS9qZHQvY29yZS90ZXN0cy9kb20vQ29udmVydGVyVGVzdFNldHVwLmphdmEK
QEAgLTE2LDQgKzE2LDUgQEAKIAogaW1wb3J0IGphdmEuaW8uSU9FeGNlcHRpb247CitpbXBvcnQg
amF2YS51dGlsLkl0ZXJhdG9yOwogaW1wb3J0IGphdmEudXRpbC5MaXN0OwogaW1wb3J0IGphdmEu
dXRpbC5NYXA7CkBAIC0xNDIsNCArMTQzLDIwIEBACiAJfQogCisJcHJvdGVjdGVkIHZvaWQgYXNz
ZXJ0RXh0cmFEaW1lbnNpb25zRXF1YWwoU3RyaW5nIG1lc3NhZ2UsIExpc3QgZGltZW5zaW9ucywg
U3RyaW5nIGV4cGVjdGVkKSB7CisJCVN0cmluZ0J1ZmZlciBidWZmZXIgPSBuZXcgU3RyaW5nQnVm
ZmVyKCk7CisJCUl0ZXJhdG9yIGl0ZXIgPSBkaW1lbnNpb25zLml0ZXJhdG9yKCk7CisJCXdoaWxl
KGl0ZXIuaGFzTmV4dCgpKSB7CisJCQlEaW1lbnNpb25UeXBlIGRpbSA9IChEaW1lbnNpb25UeXBl
KSBpdGVyLm5leHQoKTsKKwkJCUl0ZXJhdG9yIGFubm90YXRpb25zID0gZGltLmFubm90YXRpb25z
KCkuaXRlcmF0b3IoKTsKKwkJCXdoaWxlIChhbm5vdGF0aW9ucy5oYXNOZXh0KCkpIHsKKwkJCQli
dWZmZXIuYXBwZW5kKCdAJyk7CisJCQkJYnVmZmVyLmFwcGVuZCgoKEFubm90YXRpb24pIGFubm90
YXRpb25zLm5leHQoKSkuZ2V0VHlwZU5hbWUoKS5nZXRGdWxseVF1YWxpZmllZE5hbWUoKSk7CisJ
CQkJYnVmZmVyLmFwcGVuZCgnICcpOworCQkJfQorCQkJYnVmZmVyLmFwcGVuZCgiW10gIik7CisJ
CX0KKwkJYXNzZXJ0RXF1YWxzKG1lc3NhZ2UsIGV4cGVjdGVkLCBidWZmZXIudG9TdHJpbmcoKSk7
CisJfQorCiAJcHVibGljIEFTVE5vZGUgcnVuQ29udmVyc2lvbihJQ29tcGlsYXRpb25Vbml0IHVu
aXQsIGJvb2xlYW4gcmVzb2x2ZUJpbmRpbmdzLAogCQkJYm9vbGVhbiBiaW5kaW5nc1JlY292ZXJ5
KSB7CmRpZmYgLS1naXQgYS9vcmcuZWNsaXBzZS5qZHQuY29yZS50ZXN0cy5tb2RlbC93b3Jrc3Bh
Y2UvQ29udmVydGVyMTgvc3JjL1guamF2YSBiL29yZy5lY2xpcHNlLmpkdC5jb3JlLnRlc3RzLm1v
ZGVsL3dvcmtzcGFjZS9Db252ZXJ0ZXIxOC9zcmMvWC5qYXZhCm5ldyBmaWxlIG1vZGUgMTAwNjQ0
CmluZGV4IDAwMDAwMDAuLjVhMWE4ODgKLS0tIC9kZXYvbnVsbAorKysgYi9vcmcuZWNsaXBzZS5q
ZHQuY29yZS50ZXN0cy5tb2RlbC93b3Jrc3BhY2UvQ29udmVydGVyMTgvc3JjL1guamF2YQpAQCAt
MCwwICsxLDQgQEAKK3B1YmxpYyBjbGFzcyBYIHsKKwlwdWJsaWMgdm9pZCBmb28oWCB0aGlzKSB7
CisJfQorfQpkaWZmIC0tZ2l0IGEvb3JnLmVjbGlwc2UuamR0LmNvcmUvLnNldHRpbmdzLy5hcGlf
ZmlsdGVycyBiL29yZy5lY2xpcHNlLmpkdC5jb3JlLy5zZXR0aW5ncy8uYXBpX2ZpbHRlcnMKbmV3
IGZpbGUgbW9kZSAxMDA2NDQKaW5kZXggMDAwMDAwMC4uOGE4NWY1NwotLS0gL2Rldi9udWxsCisr
KyBiL29yZy5lY2xpcHNlLmpkdC5jb3JlLy5zZXR0aW5ncy8uYXBpX2ZpbHRlcnMKQEAgLTAsMCAr
MSwxMSBAQAorPD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0iVVRGLTgiIHN0YW5kYWxvbmU9
Im5vIj8+Cis8Y29tcG9uZW50IGlkPSJvcmcuZWNsaXBzZS5qZHQuY29yZSIgdmVyc2lvbj0iMiI+
CisgICAgPHJlc291cmNlIHBhdGg9ImRvbS9vcmcvZWNsaXBzZS9qZHQvY29yZS9kb20vVmFyaWFi
bGVEZWNsYXJhdGlvbi5qYXZhIiB0eXBlPSJvcmcuZWNsaXBzZS5qZHQuY29yZS5kb20uVmFyaWFi
bGVEZWNsYXJhdGlvbiI+CisgICAgICAgIDxmaWx0ZXIgaWQ9IjMzNjY5NTMzNyI+CisgICAgICAg
ICAgICA8bWVzc2FnZV9hcmd1bWVudHM+CisgICAgICAgICAgICAgICAgPG1lc3NhZ2VfYXJndW1l
bnQgdmFsdWU9Im9yZy5lY2xpcHNlLmpkdC5jb3JlLmRvbS5WYXJpYWJsZURlY2xhcmF0aW9uIi8+
CisgICAgICAgICAgICAgICAgPG1lc3NhZ2VfYXJndW1lbnQgdmFsdWU9ImdldEV4dHJhRGltZW5z
aW9uVHlwZXMoKSIvPgorICAgICAgICAgICAgPC9tZXNzYWdlX2FyZ3VtZW50cz4KKyAgICAgICAg
PC9maWx0ZXI+CisgICAgPC9yZXNvdXJjZT4KKzwvY29tcG9uZW50PgpkaWZmIC0tZ2l0IGEvb3Jn
LmVjbGlwc2UuamR0LmNvcmUvZG9tL29yZy9lY2xpcHNlL2pkdC9jb3JlL2RvbS9BU1QuamF2YSBi
L29yZy5lY2xpcHNlLmpkdC5jb3JlL2RvbS9vcmcvZWNsaXBzZS9qZHQvY29yZS9kb20vQVNULmph
dmEKaW5kZXggMGQ1YWVkNS4uODk0NTIxZiAxMDA2NDQKLS0tIGEvb3JnLmVjbGlwc2UuamR0LmNv
cmUvZG9tL29yZy9lY2xpcHNlL2pkdC9jb3JlL2RvbS9BU1QuamF2YQorKysgYi9vcmcuZWNsaXBz
ZS5qZHQuY29yZS9kb20vb3JnL2VjbGlwc2UvamR0L2NvcmUvZG9tL0FTVC5qYXZhCkBAIC0xMTE1
LDQgKzExMTUsMjYgQEAKIAkJcmV0dXJuIHJlc3VsdDsKIAl9CisJCisJLyoqCisJICogQ3JlYXRl
cyBhbmQgcmV0dXJucyBhIG5ldyB1bnBhcmVudGVkIGFubm90YXRhYmxlIGRpbWVuc2lvbiB0eXBl
IG5vZGUgd2l0aCB0aGUgZ2l2ZW4KKwkgKiBhcnJheSBvZiBhbm5vdGF0aW9ucy4KKwkgKgorCSAq
IEBwYXJhbSBhbm5vdGF0aW9ucyB0aGUgbGlzdCBvZiBhbm5vdGF0aW9ucyB0aGF0IHdpbGwgYmUg
YWRkZWQgdG8gdGhpcyBkaW1lbnNpb24gdHlwZQorCSAqIEByZXR1cm4gYSBuZXcgdW5wYXJlbnRl
ZCBhbm5vdGF0YWJsZSBkaW1lbnNpb24gdHlwZSBub2RlCisJICogQGV4Y2VwdGlvbiBJbGxlZ2Fs
QXJndW1lbnRFeGNlcHRpb24gaWY6CisJICogPHVsPgorCSAqIDxsaT50aGUgbm9kZSBiZWxvbmdz
IHRvIGEgZGlmZmVyZW50IEFTVDwvbGk+CisJICogPGxpPnRoZSBub2RlIGFscmVhZHkgaGFzIGEg
cGFyZW50PC9saT4KKwkgKiA8L3VsPgorCSAqIEBzaW5jZSAzLjkKKwkgKi8KKwlwdWJsaWMgRGlt
ZW5zaW9uVHlwZSBuZXdEaW1lbnNpb24oQW5ub3RhdGlvbltdIGFubm90YXRpb25zKSB7CisJCURp
bWVuc2lvblR5cGUgcmVzdWx0ID0gbmV3IERpbWVuc2lvblR5cGUodGhpcyk7CisJCWludCBsZW5n
dGggPSAoYW5ub3RhdGlvbnMgPT0gbnVsbCkgPyAwIDogYW5ub3RhdGlvbnMubGVuZ3RoOworCQlm
b3IgKGludCBpID0gMDsgaSA8IGxlbmd0aDsgaSsrKSB7CisJCQlyZXN1bHQuYW5ub3RhdGlvbnMu
YWRkKGFubm90YXRpb25zW2ldKTsKKwkJfQorCQlyZXR1cm4gcmVzdWx0OworCX0KIAogCS8qKgpk
aWZmIC0tZ2l0IGEvb3JnLmVjbGlwc2UuamR0LmNvcmUvZG9tL29yZy9lY2xpcHNlL2pkdC9jb3Jl
L2RvbS9BU1RDb252ZXJ0ZXIuamF2YSBiL29yZy5lY2xpcHNlLmpkdC5jb3JlL2RvbS9vcmcvZWNs
aXBzZS9qZHQvY29yZS9kb20vQVNUQ29udmVydGVyLmphdmEKaW5kZXggODY0ZmM4YS4uNDAzZWM0
YyAxMDA2NDQKLS0tIGEvb3JnLmVjbGlwc2UuamR0LmNvcmUvZG9tL29yZy9lY2xpcHNlL2pkdC9j
b3JlL2RvbS9BU1RDb252ZXJ0ZXIuamF2YQorKysgYi9vcmcuZWNsaXBzZS5qZHQuY29yZS9kb20v
b3JnL2VjbGlwc2UvamR0L2NvcmUvZG9tL0FTVENvbnZlcnRlci5qYXZhCkBAIC01MDEsNCArNTAx
LDggQEAKIAkJCQlpbnQgZXh0cmFEaW1lbnNpb25zID0gcmV0cmlldmVFeHRyYURpbWVuc2lvbihy
aWdodFBhcmVudGhlc2lzUG9zaXRpb24sIG1ldGhvZC5ib2R5RW5kKTsKIAkJCQltZXRob2REZWNs
LnNldEV4dHJhRGltZW5zaW9ucyhleHRyYURpbWVuc2lvbnMpOworCQkJCS8vIFRPRE86IEFubm90
YXRpb25zIG9uIGV4dHJhIGRpbWVuc2lvbnMgdG8gYmUgcmVtb3ZlZCAoYnVnIDM5MTg5NSwgY29t
bWVudCA2CisJCQkJaWYgKHRoaXMuYXN0LmFwaUxldmVsID49IEFTVC5KTFM4KSB7CisJCQkJCXNl
dEV4dHJhQW5ub3RhdGVkRGltZW5zaW9ucyhyaWdodFBhcmVudGhlc2lzUG9zaXRpb24sIHRoaXMu
c2Nhbm5lci5jdXJyZW50UG9zaXRpb24sICB0eXBlUmVmZXJlbmNlLCBtZXRob2REZWNsLmV4dHJh
RGltZW5zaW9uVHlwZXMsIGV4dHJhRGltZW5zaW9ucyk7CisJCQkJfQogCQkJCXNldFR5cGVGb3JN
ZXRob2REZWNsYXJhdGlvbihtZXRob2REZWNsLCByZXR1cm5UeXBlLCBleHRyYURpbWVuc2lvbnMp
OwogCQkJfSBlbHNlIHsKQEAgLTc5MSw1ICs3OTUsOSBAQAogCQlmaW5hbCBpbnQgdHlwZVNvdXJj
ZUVuZCA9IGFyZ3VtZW50LnR5cGUuc291cmNlRW5kOwogCQlmaW5hbCBpbnQgZXh0cmFEaW1lbnNp
b25zID0gcmV0cmlldmVFeHRyYURpbWVuc2lvbihuYW1lRW5kICsgMSwgdHlwZVNvdXJjZUVuZCk7
Ci0JCXZhcmlhYmxlRGVjbC5zZXRFeHRyYURpbWVuc2lvbnMoZXh0cmFEaW1lbnNpb25zKTsKKwkJ
aWYgKHRoaXMuYXN0LmFwaUxldmVsID49IEFTVC5KTFM4KSB7CisJCQlzZXRFeHRyYUFubm90YXRl
ZERpbWVuc2lvbnMobmFtZUVuZCArIDEsIHRoaXMuc2Nhbm5lci5jdXJyZW50UG9zaXRpb24sICBh
cmd1bWVudC50eXBlLCB2YXJpYWJsZURlY2wuZXh0cmFEaW1lbnNpb25UeXBlcywgZXh0cmFEaW1l
bnNpb25zKTsKKwkJfSBlbHNlIHsKKwkJCXZhcmlhYmxlRGVjbC5zZXRFeHRyYURpbWVuc2lvbnMo
ZXh0cmFEaW1lbnNpb25zKTsKKwkJfQogCQlmaW5hbCBib29sZWFuIGlzVmFyQXJncyA9IGFyZ3Vt
ZW50LmlzVmFyQXJncygpOwogCQlpZiAoaXNWYXJBcmdzICYmIGV4dHJhRGltZW5zaW9ucyA9PSAw
KSB7CkBAIC04MDcsMTAgKzgxNSwxMyBAQAogCQkJc2V0VHlwZUZvclNpbmdsZVZhcmlhYmxlRGVj
bGFyYXRpb24odmFyaWFibGVEZWNsLCB0eXBlLCBleHRyYURpbWVuc2lvbnMgKyAxKTsKIAkJCS8v
IGh0dHBzOi8vYnVncy5lY2xpcHNlLm9yZy9idWdzL3Nob3dfYnVnLmNnaT9pZD0zOTE4OTgKLQkJ
CWlmICh0aGlzLmFzdC5hcGlMZXZlbCgpID49IEFTVC5KTFM4ICYmICF0eXBlLmFubm90YXRpb25z
KCkuaXNFbXB0eSgpKSB7Ci0JCQkJSXRlcmF0b3IgYW5ub3RhdGlvbnMgPSB0eXBlLmFubm90YXRp
b25zLml0ZXJhdG9yKCk7Ci0JCQkJd2hpbGUgKGFubm90YXRpb25zLmhhc05leHQoKSkgewotCQkJ
CQlBbm5vdGF0aW9uIGFubm90YXRpb24gPSAoQW5ub3RhdGlvbikgYW5ub3RhdGlvbnMubmV4dCgp
OwotCQkJCQlhbm5vdGF0aW9uLnNldFBhcmVudChudWxsLCBudWxsKTsKLQkJCQkJdmFyaWFibGVE
ZWNsLnZhcmFyZ3NBbm5vdGF0aW9ucygpLmFkZChhbm5vdGF0aW9uKTsKKwkJCWlmICh0eXBlLmlz
QW5ub3RhdGFibGUoKSkgeworCQkJCUFubm90YXRhYmxlVHlwZSBhbm5vdGF0YWJsZVR5cGUgPSAo
QW5ub3RhdGFibGVUeXBlKSB0eXBlOworCQkJCWlmICh0aGlzLmFzdC5hcGlMZXZlbCgpID49IEFT
VC5KTFM4ICYmICFhbm5vdGF0YWJsZVR5cGUuYW5ub3RhdGlvbnMoKS5pc0VtcHR5KCkpIHsKKwkJ
CQkJSXRlcmF0b3IgYW5ub3RhdGlvbnMgPSBhbm5vdGF0YWJsZVR5cGUuYW5ub3RhdGlvbnMuaXRl
cmF0b3IoKTsKKwkJCQkJd2hpbGUgKGFubm90YXRpb25zLmhhc05leHQoKSkgeworCQkJCQkJQW5u
b3RhdGlvbiBhbm5vdGF0aW9uID0gKEFubm90YXRpb24pIGFubm90YXRpb25zLm5leHQoKTsKKwkJ
CQkJCWFubm90YXRpb24uc2V0UGFyZW50KG51bGwsIG51bGwpOworCQkJCQkJdmFyaWFibGVEZWNs
LnZhcmFyZ3NBbm5vdGF0aW9ucygpLmFkZChhbm5vdGF0aW9uKTsKKwkJCQkJfQogCQkJCX0KIAkJ
CX0KQEAgLTI5MDcsNSArMjkxOCw2IEBACiAJCWZpZWxkRGVjbGFyYXRpb24uc2V0U291cmNlUmFu
Z2UoZmllbGREZWNsLmRlY2xhcmF0aW9uU291cmNlU3RhcnQsIGZpZWxkRGVjbC5kZWNsYXJhdGlv
bkVuZCAtIGZpZWxkRGVjbC5kZWNsYXJhdGlvblNvdXJjZVN0YXJ0ICsgMSk7CiAJCVR5cGUgdHlw
ZSA9IGNvbnZlcnRUeXBlKGZpZWxkRGVjbC50eXBlKTsKLQkJc2V0VHlwZUZvckZpZWxkKGZpZWxk
RGVjbGFyYXRpb24sIHR5cGUsIHZhcmlhYmxlRGVjbGFyYXRpb25GcmFnbWVudC5nZXRFeHRyYURp
bWVuc2lvbnMoKSk7CisJCXNldFR5cGVGb3JGaWVsZChmaWVsZERlY2xhcmF0aW9uLCB0eXBlLCAK
KwkJCQkodGhpcy5hc3QuYXBpTGV2ZWwgPCBBU1QuSkxTOCkgPyB2YXJpYWJsZURlY2xhcmF0aW9u
RnJhZ21lbnQuZ2V0RXh0cmFEaW1lbnNpb25zKCkgOiB2YXJpYWJsZURlY2xhcmF0aW9uRnJhZ21l
bnQuZ2V0RXh0cmFEaW1lbnNpb25UeXBlcygpLnNpemUoKSk7CiAJCXNldE1vZGlmaWVycyhmaWVs
ZERlY2xhcmF0aW9uLCBmaWVsZERlY2wpOwogCQljb252ZXJ0KGZpZWxkRGVjbC5qYXZhZG9jLCBm
aWVsZERlY2xhcmF0aW9uKTsKQEAgLTI5MzgsNSArMjk1MCw2IEBACiAJCXZhcmlhYmxlRGVjbGFy
YXRpb25FeHByZXNzaW9uLnNldFNvdXJjZVJhbmdlKGxvY2FsRGVjbGFyYXRpb24uZGVjbGFyYXRp
b25Tb3VyY2VTdGFydCwgbG9jYWxEZWNsYXJhdGlvbi5kZWNsYXJhdGlvblNvdXJjZUVuZCAtIGxv
Y2FsRGVjbGFyYXRpb24uZGVjbGFyYXRpb25Tb3VyY2VTdGFydCArIDEpOwogCQlUeXBlIHR5cGUg
PSBjb252ZXJ0VHlwZShsb2NhbERlY2xhcmF0aW9uLnR5cGUpOwotCQlzZXRUeXBlRm9yVmFyaWFi
bGVEZWNsYXJhdGlvbkV4cHJlc3Npb24odmFyaWFibGVEZWNsYXJhdGlvbkV4cHJlc3Npb24sIHR5
cGUsIHZhcmlhYmxlRGVjbGFyYXRpb25GcmFnbWVudC5nZXRFeHRyYURpbWVuc2lvbnMoKSk7CisJ
CXNldFR5cGVGb3JWYXJpYWJsZURlY2xhcmF0aW9uRXhwcmVzc2lvbih2YXJpYWJsZURlY2xhcmF0
aW9uRXhwcmVzc2lvbiwgdHlwZSwgCisJCQkJKHRoaXMuYXN0LmFwaUxldmVsIDwgQVNULkpMUzgp
ID8gdmFyaWFibGVEZWNsYXJhdGlvbkZyYWdtZW50LmdldEV4dHJhRGltZW5zaW9ucygpIDogdmFy
aWFibGVEZWNsYXJhdGlvbkZyYWdtZW50LmdldEV4dHJhRGltZW5zaW9uVHlwZXMoKS5zaXplKCkp
OwogCQlpZiAobG9jYWxEZWNsYXJhdGlvbi5tb2RpZmllcnNTb3VyY2VTdGFydCAhPSAtMSkgewog
CQkJc2V0TW9kaWZpZXJzKHZhcmlhYmxlRGVjbGFyYXRpb25FeHByZXNzaW9uLCBsb2NhbERlY2xh
cmF0aW9uKTsKQEAgLTI5NTUsNSArMjk2OCw5IEBACiAJCXZhcmlhYmxlRGVjbC5zZXROYW1lKG5h
bWUpOwogCQlmaW5hbCBpbnQgZXh0cmFEaW1lbnNpb25zID0gcmV0cmlldmVFeHRyYURpbWVuc2lv
bihuYW1lRW5kICsgMSwgbG9jYWxEZWNsYXJhdGlvbi50eXBlLnNvdXJjZUVuZCk7Ci0JCXZhcmlh
YmxlRGVjbC5zZXRFeHRyYURpbWVuc2lvbnMoZXh0cmFEaW1lbnNpb25zKTsKKwkJaWYgKHRoaXMu
YXN0LmFwaUxldmVsID49IEFTVC5KTFM4KSB7CisJCQlzZXRFeHRyYUFubm90YXRlZERpbWVuc2lv
bnMobmFtZUVuZCArIDEsIHRoaXMuc2Nhbm5lci5jdXJyZW50UG9zaXRpb24sICBsb2NhbERlY2xh
cmF0aW9uLnR5cGUsIHZhcmlhYmxlRGVjbC5leHRyYURpbWVuc2lvblR5cGVzLCBleHRyYURpbWVu
c2lvbnMpOworCQl9IGVsc2UgeworCQkJdmFyaWFibGVEZWNsLnNldEV4dHJhRGltZW5zaW9ucyhl
eHRyYURpbWVuc2lvbnMpOworCQl9CiAJCVR5cGUgdHlwZSA9IGNvbnZlcnRUeXBlKGxvY2FsRGVj
bGFyYXRpb24udHlwZSk7CiAJCWludCB0eXBlRW5kID0gdHlwZS5nZXRTdGFydFBvc2l0aW9uKCkg
KyB0eXBlLmdldExlbmd0aCgpIC0gMTsKQEAgLTI5NzMsNCArMjk5MCwxNSBAQAogCX0KIAorCXBy
aXZhdGUgRGltZW5zaW9uVHlwZSBjb252ZXJ0VG9EaW1lbnNpb24oaW50IHN0YXJ0LCBpbnQgZW5k
LCBvcmcuZWNsaXBzZS5qZHQuaW50ZXJuYWwuY29tcGlsZXIuYXN0LkFubm90YXRpb25bXSBhbm5v
dGF0aW9uKSB7CisJCWludCBsZW5ndGggPSBhbm5vdGF0aW9uID09IG51bGwgPyAwIDogYW5ub3Rh
dGlvbi5sZW5ndGg7CisJCUFubm90YXRpb25bXSBhbm5vdGF0aW9ucyA9IG5ldyBBbm5vdGF0aW9u
W2xlbmd0aF07CisJCWZvciAoaW50IGkgPSAwOyBpIDwgbGVuZ3RoOyBpKyspIHsKKwkJCWFubm90
YXRpb25zW2ldID0gY29udmVydChhbm5vdGF0aW9uW2ldKTsKKwkJfQorCQlEaW1lbnNpb25UeXBl
IGRpbWVuc2lvbiA9IHRoaXMuYXN0Lm5ld0RpbWVuc2lvbihhbm5vdGF0aW9ucyk7CisJCXJldHJp
ZXZlRGltZW5zaW9uQW5kU2V0UG9zaXRpb25zKHN0YXJ0LCBlbmQsIGRpbWVuc2lvbik7CisJCXJl
dHVybiBkaW1lbnNpb247CisJfQorCiAJcHJvdGVjdGVkIFZhcmlhYmxlRGVjbGFyYXRpb25GcmFn
bWVudCBjb252ZXJ0VG9WYXJpYWJsZURlY2xhcmF0aW9uRnJhZ21lbnQob3JnLmVjbGlwc2UuamR0
LmludGVybmFsLmNvbXBpbGVyLmFzdC5GaWVsZERlY2xhcmF0aW9uIGZpZWxkRGVjbGFyYXRpb24p
IHsKIAkJZmluYWwgVmFyaWFibGVEZWNsYXJhdGlvbkZyYWdtZW50IHZhcmlhYmxlRGVjbGFyYXRp
b25GcmFnbWVudCA9IG5ldyBWYXJpYWJsZURlY2xhcmF0aW9uRnJhZ21lbnQodGhpcy5hc3QpOwpA
QCAtMjk4Miw1ICszMDEwLDkgQEAKIAkJaW50IGVuZCA9IHN0YXJ0OwogCQlpbnQgZXh0cmFEaW1l
bnNpb25zID0gcmV0cmlldmVFeHRyYURpbWVuc2lvbihmaWVsZERlY2xhcmF0aW9uLnNvdXJjZUVu
ZCArIDEsIGZpZWxkRGVjbGFyYXRpb24uZGVjbGFyYXRpb25Tb3VyY2VFbmQgKTsKLQkJdmFyaWFi
bGVEZWNsYXJhdGlvbkZyYWdtZW50LnNldEV4dHJhRGltZW5zaW9ucyhleHRyYURpbWVuc2lvbnMp
OworCQlpZiAodGhpcy5hc3QuYXBpTGV2ZWwgPj0gQVNULkpMUzgpIHsKKwkJCXNldEV4dHJhQW5u
b3RhdGVkRGltZW5zaW9ucyhmaWVsZERlY2xhcmF0aW9uLnNvdXJjZUVuZCArIDEsIHRoaXMuc2Nh
bm5lci5jdXJyZW50UG9zaXRpb24sIGZpZWxkRGVjbGFyYXRpb24udHlwZSwgdmFyaWFibGVEZWNs
YXJhdGlvbkZyYWdtZW50LmV4dHJhRGltZW5zaW9uVHlwZXMsIGV4dHJhRGltZW5zaW9ucyk7CisJ
CX0gZWxzZSB7CisJCQl2YXJpYWJsZURlY2xhcmF0aW9uRnJhZ21lbnQuc2V0RXh0cmFEaW1lbnNp
b25zKGV4dHJhRGltZW5zaW9ucyk7CisJCX0KIAkJaWYgKGZpZWxkRGVjbGFyYXRpb24uaW5pdGlh
bGl6YXRpb24gIT0gbnVsbCkgewogCQkJZmluYWwgRXhwcmVzc2lvbiBleHByZXNzaW9uID0gY29u
dmVydChmaWVsZERlY2xhcmF0aW9uLmluaXRpYWxpemF0aW9uKTsKQEAgLTMwMjAsNSArMzA1Miwx
MCBAQAogCQlvcmcuZWNsaXBzZS5qZHQuaW50ZXJuYWwuY29tcGlsZXIuYXN0LkV4cHJlc3Npb24g
aW5pdGlhbGl6YXRpb24gPSBsb2NhbERlY2xhcmF0aW9uLmluaXRpYWxpemF0aW9uOwogCQlpbnQg
ZXh0cmFEaW1lbnNpb24gPSByZXRyaWV2ZUV4dHJhRGltZW5zaW9uKGxvY2FsRGVjbGFyYXRpb24u
c291cmNlRW5kICsgMSwgdGhpcy5jb21waWxhdGlvblVuaXRTb3VyY2VMZW5ndGgpOwotCQl2YXJp
YWJsZURlY2xhcmF0aW9uRnJhZ21lbnQuc2V0RXh0cmFEaW1lbnNpb25zKGV4dHJhRGltZW5zaW9u
KTsKKwkJaWYgKHRoaXMuYXN0LmFwaUxldmVsID49IEFTVC5KTFM4KSB7CisJCQlzZXRFeHRyYUFu
bm90YXRlZERpbWVuc2lvbnMobG9jYWxEZWNsYXJhdGlvbi5zb3VyY2VFbmQgKyAxLCB0aGlzLnNj
YW5uZXIuY3VycmVudFBvc2l0aW9uLCBsb2NhbERlY2xhcmF0aW9uLnR5cGUsIHZhcmlhYmxlRGVj
bGFyYXRpb25GcmFnbWVudC5leHRyYURpbWVuc2lvblR5cGVzLCBleHRyYURpbWVuc2lvbik7CisJ
CX0gZWxzZSB7CisJCQl2YXJpYWJsZURlY2xhcmF0aW9uRnJhZ21lbnQuc2V0RXh0cmFEaW1lbnNp
b25zKGV4dHJhRGltZW5zaW9uKTsKKwkJfQorCQkKIAkJYm9vbGVhbiBoYXNJbml0aWFsaXphdGlv
biA9IGluaXRpYWxpemF0aW9uICE9IG51bGw7CiAJCWludCBlbmQ7CkBAIC0zMDUxLDQgKzMwODgs
MTYgQEAKIAl9CiAKKwlwcm90ZWN0ZWQgdm9pZCBzZXRFeHRyYUFubm90YXRlZERpbWVuc2lvbnMo
aW50IHN0YXJ0LCBpbnQgZW5kLCBUeXBlUmVmZXJlbmNlIHR5cGUsIGZpbmFsIExpc3QgZXh0cmFB
bm5vdGF0ZWREaW1lbnNpb25zLCBpbnQgZXh0cmFEaW1lbnNpb24pIHsKKwkJaWYgKGV4dHJhRGlt
ZW5zaW9uID4gMCkgeworCQkJb3JnLmVjbGlwc2UuamR0LmludGVybmFsLmNvbXBpbGVyLmFzdC5B
bm5vdGF0aW9uW11bXSBhbm5vdGF0aW9uc09uRGltcyA9IHR5cGUuZ2V0QW5ub3RhdGlvbnNPbkRp
bWVuc2lvbnMoKTsKKwkJCWludCBsZW5ndGggPSAoYW5ub3RhdGlvbnNPbkRpbXMgPT0gbnVsbCkg
PyAwIDogYW5ub3RhdGlvbnNPbkRpbXMubGVuZ3RoOworCQkJZm9yIChpbnQgaSA9IChsZW5ndGgg
LSBleHRyYURpbWVuc2lvbik7IGkgPCBsZW5ndGg7IGkrKykgeworCQkJCURpbWVuc2lvblR5cGUg
ZGltID0gY29udmVydFRvRGltZW5zaW9uKHN0YXJ0LCBlbmQsIChhbm5vdGF0aW9uc09uRGltcyA9
PSBudWxsKSA/IG51bGwgOiBhbm5vdGF0aW9uc09uRGltc1tpXSk7CisJCQkJZXh0cmFBbm5vdGF0
ZWREaW1lbnNpb25zLmFkZChkaW0pOworCQkJCXN0YXJ0ID0gZGltLmdldFN0YXJ0UG9zaXRpb24o
KSArIGRpbS5nZXRMZW5ndGgoKTsKKwkJCX0KKwkJfQorCX0KKwogCXByb3RlY3RlZCBWYXJpYWJs
ZURlY2xhcmF0aW9uU3RhdGVtZW50IGNvbnZlcnRUb1ZhcmlhYmxlRGVjbGFyYXRpb25TdGF0ZW1l
bnQob3JnLmVjbGlwc2UuamR0LmludGVybmFsLmNvbXBpbGVyLmFzdC5Mb2NhbERlY2xhcmF0aW9u
IGxvY2FsRGVjbGFyYXRpb24pIHsKIAkJZmluYWwgVmFyaWFibGVEZWNsYXJhdGlvbkZyYWdtZW50
IHZhcmlhYmxlRGVjbGFyYXRpb25GcmFnbWVudCA9IGNvbnZlcnRUb1ZhcmlhYmxlRGVjbGFyYXRp
b25GcmFnbWVudChsb2NhbERlY2xhcmF0aW9uKTsKQEAgLTMwNjAsNSArMzEwOSw2IEBACiAJCXZh
cmlhYmxlRGVjbGFyYXRpb25TdGF0ZW1lbnQuc2V0U291cmNlUmFuZ2UobG9jYWxEZWNsYXJhdGlv
bi5kZWNsYXJhdGlvblNvdXJjZVN0YXJ0LCBsb2NhbERlY2xhcmF0aW9uLmRlY2xhcmF0aW9uU291
cmNlRW5kIC0gbG9jYWxEZWNsYXJhdGlvbi5kZWNsYXJhdGlvblNvdXJjZVN0YXJ0ICsgMSk7CiAJ
CVR5cGUgdHlwZSA9IGNvbnZlcnRUeXBlKGxvY2FsRGVjbGFyYXRpb24udHlwZSk7Ci0JCXNldFR5
cGVGb3JWYXJpYWJsZURlY2xhcmF0aW9uU3RhdGVtZW50KHZhcmlhYmxlRGVjbGFyYXRpb25TdGF0
ZW1lbnQsIHR5cGUsIHZhcmlhYmxlRGVjbGFyYXRpb25GcmFnbWVudC5nZXRFeHRyYURpbWVuc2lv
bnMoKSk7CisJCXNldFR5cGVGb3JWYXJpYWJsZURlY2xhcmF0aW9uU3RhdGVtZW50KHZhcmlhYmxl
RGVjbGFyYXRpb25TdGF0ZW1lbnQsIHR5cGUsIAorCQkJCSh0aGlzLmFzdC5hcGlMZXZlbCA8IEFT
VC5KTFM4KSA/IHZhcmlhYmxlRGVjbGFyYXRpb25GcmFnbWVudC5nZXRFeHRyYURpbWVuc2lvbnMo
KSA6IHZhcmlhYmxlRGVjbGFyYXRpb25GcmFnbWVudC5nZXRFeHRyYURpbWVuc2lvblR5cGVzKCku
c2l6ZSgpKTsKIAkJaWYgKGxvY2FsRGVjbGFyYXRpb24ubW9kaWZpZXJzU291cmNlU3RhcnQgIT0g
LTEpIHsKIAkJCXNldE1vZGlmaWVycyh2YXJpYWJsZURlY2xhcmF0aW9uU3RhdGVtZW50LCBsb2Nh
bERlY2xhcmF0aW9uKTsKQEAgLTMwNjcsNSArMzExNyw1IEBACiAJfQogCi0JcHJpdmF0ZSB2b2lk
IGFubm90YXRlVHlwZShUeXBlIHR5cGUsIG9yZy5lY2xpcHNlLmpkdC5pbnRlcm5hbC5jb21waWxl
ci5hc3QuQW5ub3RhdGlvbltdIGFubm90YXRpb25zKSB7CisJcHJpdmF0ZSB2b2lkIGFubm90YXRl
VHlwZShBbm5vdGF0YWJsZVR5cGUgdHlwZSwgb3JnLmVjbGlwc2UuamR0LmludGVybmFsLmNvbXBp
bGVyLmFzdC5Bbm5vdGF0aW9uW10gYW5ub3RhdGlvbnMpIHsKIAkJc3dpdGNoKHRoaXMuYXN0LmFw
aUxldmVsKSB7CiAJCQljYXNlIEFTVC5KTFMyX0lOVEVSTkFMIDoKQEAgLTMxNjUsNSArMzIxNSw2
IEBACiAJCQkvLyBuZWVkIHRvIGZpbmQgb3V0IGlmIHRoaXMgaXMgYW4gYXJyYXkgdHlwZSBvZiBw
cmltaXRpdmUgdHlwZXMgb3Igbm90CiAJCQlpZiAoaXNQcmltaXRpdmVUeXBlKG5hbWUpKSB7Ci0J
CQkJaW50IGVuZCA9IHJldHJpZXZlRW5kT2ZFbGVtZW50VHlwZU5hbWVQb3NpdGlvbihzb3VyY2VT
dGFydCwgc291cmNlU3RhcnQgKyBsZW5ndGgpOworCQkJCWludFtdIHBvc2l0aW9ucyA9IHJldHJp
ZXZlRW5kT2ZFbGVtZW50VHlwZU5hbWVQb3NpdGlvbihzb3VyY2VTdGFydCwgc291cmNlU3RhcnQg
KyBsZW5ndGgpOworCQkJCWludCBlbmQgPSBwb3NpdGlvbnNbMV07CiAJCQkJaWYgKGVuZCA9PSAt
MSkgewogCQkJCQllbmQgPSBzb3VyY2VTdGFydCArIGxlbmd0aCAtIDE7CkBAIC0zMTgwLDkgKzMy
MzEsMTUgQEAKIAkJCQlmaW5hbCBTaW1wbGVOYW1lIHNpbXBsZU5hbWUgPSBuZXcgU2ltcGxlTmFt
ZSh0aGlzLmFzdCk7CiAJCQkJc2ltcGxlTmFtZS5pbnRlcm5hbFNldElkZW50aWZpZXIobmV3IFN0
cmluZyhuYW1lKSk7Ci0JCQkJaW50IGVuZCA9IHJldHJpZXZlRW5kT2ZFbGVtZW50VHlwZU5hbWVQ
b3NpdGlvbihzb3VyY2VTdGFydCwgc291cmNlU3RhcnQgKyBsZW5ndGgpOworCQkJCWludFtdIHBv
c2l0aW9ucyA9IHJldHJpZXZlRW5kT2ZFbGVtZW50VHlwZU5hbWVQb3NpdGlvbihzb3VyY2VTdGFy
dCwgc291cmNlU3RhcnQgKyBsZW5ndGgpOworCQkJCWludCBlbmQgPSBwb3NpdGlvbnNbMV07CiAJ
CQkJaWYgKGVuZCA9PSAtMSkgewogCQkJCQllbmQgPSBzb3VyY2VTdGFydCArIGxlbmd0aCAtIDE7
CiAJCQkJfQotCQkJCXNpbXBsZU5hbWUuc2V0U291cmNlUmFuZ2Uoc291cmNlU3RhcnQsIGVuZCAt
IHNvdXJjZVN0YXJ0ICsgMSk7CisJCQkJaWYgKHBvc2l0aW9uc1swXSAhPSAtMSkgeworCQkJCQlz
aW1wbGVOYW1lLnNldFNvdXJjZVJhbmdlKHBvc2l0aW9uc1swXSwgZW5kIC0gcG9zaXRpb25zWzBd
ICsgMSk7CisJCQkJfSBlbHNlIHsKKwkJCQkJc2ltcGxlTmFtZS5zZXRTb3VyY2VSYW5nZShzb3Vy
Y2VTdGFydCwgZW5kIC0gc291cmNlU3RhcnQgKyAxKTsJCQkJCQorCQkJCX0KKwogCQkJCXN3aXRj
aCh0aGlzLmFzdC5hcGlMZXZlbCkgewogCQkJCQljYXNlIEFTVC5KTFMyX0lOVEVSTkFMIDoKQEAg
LTMyMjksOSArMzI4NiwxNCBAQAogCQkJCS8vIHdlIG5lZWQgdG8gc2VhcmNoIGZvciB0aGUgc3Rh
cnRpbmcgcG9zaXRpb24gb2YgdGhlIGZpcnN0IGJyYWNlIGluIG9yZGVyIHRvIHNldCB0aGUgcHJv
cGVyIGxlbmd0aAogCQkJCS8vIFBSIGh0dHA6Ly9kZXYuZWNsaXBzZS5vcmcvYnVncy9zaG93X2J1
Zy5jZ2k/aWQ9MTA3NTkKLQkJCQlpbnQgZW5kID0gcmV0cmlldmVFbmRPZkVsZW1lbnRUeXBlTmFt
ZVBvc2l0aW9uKHNvdXJjZVN0YXJ0LCBzb3VyY2VTdGFydCArIGxlbmd0aCk7CisJCQkJaW50W10g
cG9zaXRpb25zID0gcmV0cmlldmVFbmRPZkVsZW1lbnRUeXBlTmFtZVBvc2l0aW9uKHNvdXJjZVN0
YXJ0LCBzb3VyY2VTdGFydCArIGxlbmd0aCk7CisJCQkJaW50IGVuZCA9IHBvc2l0aW9uc1sxXTsK
IAkJCQlpZiAoZW5kID09IC0xKSB7CiAJCQkJCWVuZCA9IHNvdXJjZVN0YXJ0ICsgbGVuZ3RoIC0g
MTsKIAkJCQl9Ci0JCQkJc2ltcGxlTmFtZS5zZXRTb3VyY2VSYW5nZShzb3VyY2VTdGFydCwgZW5k
IC0gc291cmNlU3RhcnQgKyAxKTsKKwkJCQlpZiAocG9zaXRpb25zWzBdICE9IC0xKSB7CisJCQkJ
CXNpbXBsZU5hbWUuc2V0U291cmNlUmFuZ2UocG9zaXRpb25zWzBdLCBlbmQgLSBwb3NpdGlvbnNb
MF0gKyAxKTsKKwkJCQl9IGVsc2UgeworCQkJCQlzaW1wbGVOYW1lLnNldFNvdXJjZVJhbmdlKHNv
dXJjZVN0YXJ0LCBlbmQgLSBzb3VyY2VTdGFydCArIDEpOworCQkJCX0KIAkJCQlmaW5hbCBTaW1w
bGVUeXBlIHNpbXBsZVR5cGUgPSBuZXcgU2ltcGxlVHlwZSh0aGlzLmFzdCk7CiAJCQkJc2ltcGxl
VHlwZS5zZXROYW1lKHNpbXBsZU5hbWUpOwpAQCAtNDE4MCwxNCArNDI0MiwyNCBAQAogCiAJLyoq
Ci0JICogVGhpcyBtZXRob2QgaXMgdXNlZCB0byByZXRyaWV2ZSB0aGUgcG9zaXRpb24ganVzdCBi
ZWZvcmUgdGhlIGxlZnQgYnJhY2tldC4KLQkgKiBAcmV0dXJuIGludCB0aGUgZGltZW5zaW9uIGZv
dW5kLCAtMSBpZiBub25lCisJICogVGhpcyBtZXRob2QgaXMgdXNlZCB0byByZXRyaWV2ZSB0aGUg
c3RhcnQgYW5kIGVuZCBwb3NpdGlvbiBvZiBhIG5hbWUuCisJICogCisJICogQHJldHVybiBpbnRb
XSBhIHNpbmdsZSBkaW1lbnNpb25hbCBhcnJheSwgd2l0aCB0d28gZWxlbWVudHMsIGZvciB0aGUg
c3RhcnQgYW5kIGVuZCBwb3NpdGlvbnMgb2YgdGhlIG5hbWUgcmVzcGVjdGl2ZWx5CiAJICovCi0J
cHJvdGVjdGVkIGludCByZXRyaWV2ZUVuZE9mRWxlbWVudFR5cGVOYW1lUG9zaXRpb24oaW50IHN0
YXJ0LCBpbnQgZW5kKSB7CisJcHJvdGVjdGVkIGludFtdIHJldHJpZXZlRW5kT2ZFbGVtZW50VHlw
ZU5hbWVQb3NpdGlvbihpbnQgc3RhcnQsIGludCBlbmQpIHsKIAkJdGhpcy5zY2FubmVyLnJlc2V0
VG8oc3RhcnQsIGVuZCk7CisJCWJvb2xlYW4gaXNBbm5vdGF0aW9uID0gZmFsc2U7CiAJCXRyeSB7
CiAJCQlpbnQgdG9rZW47CiAJCQl3aGlsZSAoKHRva2VuID0gdGhpcy5zY2FubmVyLmdldE5leHRU
b2tlbigpKSAhPSBUZXJtaW5hbFRva2Vucy5Ub2tlbk5hbWVFT0YpIHsKIAkJCQlzd2l0Y2godG9r
ZW4pIHsKKwkJCQkJY2FzZSBUZXJtaW5hbFRva2Vucy5Ub2tlbk5hbWVBVDoKKwkJCQkJCWlzQW5u
b3RhdGlvbiA9IHRydWU7CisJCQkJCQlicmVhazsKIAkJCQkJY2FzZSBUZXJtaW5hbFRva2Vucy5U
b2tlbk5hbWVJZGVudGlmaWVyOgorCQkJCQkJaWYgKGlzQW5ub3RhdGlvbikgeworCQkJCQkJCWlz
QW5ub3RhdGlvbiA9IGZhbHNlOworCQkJCQkJCWJyZWFrOworCQkJCQkJfQorCQkJCQkJLy8kRkFM
TC1USFJPVUdIJAogCQkJCQljYXNlIFRlcm1pbmFsVG9rZW5zLlRva2VuTmFtZWJ5dGU6CiAJCQkJ
CWNhc2UgVGVybWluYWxUb2tlbnMuVG9rZW5OYW1lY2hhcjoKQEAgLTQxOTgsNSArNDI3MCw1IEBA
CiAJCQkJCWNhc2UgVGVybWluYWxUb2tlbnMuVG9rZW5OYW1lc2hvcnQ6CiAJCQkJCWNhc2UgVGVy
bWluYWxUb2tlbnMuVG9rZW5OYW1lYm9vbGVhbjoKLQkJCQkJCXJldHVybiB0aGlzLnNjYW5uZXIu
Y3VycmVudFBvc2l0aW9uIC0gMTsKKwkJCQkJCXJldHVybiBuZXcgaW50W117dGhpcy5zY2FubmVy
LnN0YXJ0UG9zaXRpb24sIHRoaXMuc2Nhbm5lci5jdXJyZW50UG9zaXRpb24gLSAxfTsKIAkJCQl9
CiAJCQl9CkBAIC00MjA0LDUgKzQyNzYsNSBAQAogCQkJLy8gaWdub3JlCiAJCX0KLQkJcmV0dXJu
IC0xOworCQlyZXR1cm4gbmV3IGludFtdey0xLCAtMX07CiAJfQogCkBAIC00MjQwLDQgKzQzMTIs
NSBAQAogCQl0cnkgewogCQkJaW50IHRva2VuOworCQkJYm9vbGVhbiBpc0Fubm90YXRpb24gPSBm
YWxzZTsKIAkJCXdoaWxlICgodG9rZW4gPSB0aGlzLnNjYW5uZXIuZ2V0TmV4dFRva2VuKCkpICE9
IFRlcm1pbmFsVG9rZW5zLlRva2VuTmFtZUVPRikgewogCQkJCXN3aXRjaCh0b2tlbikgewpAQCAt
NDI0Niw2ICs0MzE5LDE3IEBACiAJCQkJCWNhc2UgVGVybWluYWxUb2tlbnMuVG9rZW5OYW1lQ09N
TUVOVF9KQVZBRE9DOgogCQkJCQljYXNlIFRlcm1pbmFsVG9rZW5zLlRva2VuTmFtZUNPTU1FTlRf
TElORToKKwkJCQkJCWlzQW5ub3RhdGlvbiA9IGZhbHNlOworCQkJCQkJYnJlYWs7CisJCQkJCWNh
c2UgVGVybWluYWxUb2tlbnMuVG9rZW5OYW1lQVQ6CisJCQkJCQlpc0Fubm90YXRpb24gPSB0cnVl
OworCQkJCQkJYnJlYWs7CisJCQkJCWNhc2UgVGVybWluYWxUb2tlbnMuVG9rZW5OYW1lSWRlbnRp
ZmllcjoKKwkJCQkJCWlmICghaXNBbm5vdGF0aW9uKSB7CisJCQkJCQkJcmV0dXJuIGRpbWVuc2lv
bnM7CisJCQkJCQl9CisJCQkJCQlpc0Fubm90YXRpb24gPSBmYWxzZTsKIAkJCQkJCWJyZWFrOwog
CQkJCQljYXNlIFRlcm1pbmFsVG9rZW5zLlRva2VuTmFtZVJCUkFDS0VUOi8vMTY2CisJCQkJCQlp
c0Fubm90YXRpb24gPSBmYWxzZTsKIAkJCQkJCWRpbWVuc2lvbnMrKzsKIAkJCQkJCWJyZWFrOwpA
QCAtNDI2MCw0ICs0MzQ0LDMwIEBACiAJfQogCisJcHJvdGVjdGVkIHZvaWQgcmV0cmlldmVEaW1l
bnNpb25BbmRTZXRQb3NpdGlvbnMoaW50IHN0YXJ0LCBpbnQgZW5kLCBEaW1lbnNpb25UeXBlIGRp
bSkgeworCQl0aGlzLnNjYW5uZXIucmVzZXRUbyhzdGFydCwgZW5kKTsKKwkJaW50IHRva2VuOwor
CQlib29sZWFuIHN0YXJ0U2V0ID0gZmFsc2U7CisJCXRyeSB7CisJCQl3aGlsZSgodG9rZW4gPSB0
aGlzLnNjYW5uZXIuZ2V0TmV4dFRva2VuKCkpICE9IFRlcm1pbmFsVG9rZW5zLlRva2VuTmFtZUVP
RikgIHsKKwkJCQlzd2l0Y2godG9rZW4pIHsKKwkJCQkJY2FzZSBUZXJtaW5hbFRva2Vucy5Ub2tl
bk5hbWVXSElURVNQQUNFOgorCQkJCQkJYnJlYWs7CisJCQkJCWNhc2UgVGVybWluYWxUb2tlbnMu
VG9rZW5OYW1lUkJSQUNLRVQ6CisJCQkJCQlpbnQgZW5kRGltID0gdGhpcy5zY2FubmVyLmN1cnJl
bnRQb3NpdGlvbiAtIDE7CisJCQkJCQlkaW0uc2V0U291cmNlUmFuZ2Uoc3RhcnQsIGVuZERpbSAt
IHN0YXJ0ICsgMSk7CisJCQkJCQlyZXR1cm47CisJCQkJCWRlZmF1bHQ6CisJCQkJCQlpZiAoIXN0
YXJ0U2V0KSB7CisJCQkJCQkJc3RhcnQgPSB0aGlzLnNjYW5uZXIuc3RhcnRQb3NpdGlvbjsKKwkJ
CQkJCQlzdGFydFNldCA9IHRydWU7CisJCQkJCQl9CisJCQkJCQlicmVhazsKKwkJCQkJCQorCQkJ
CX0KKwkJCX0KKwkJfSBjYXRjaChJbnZhbGlkSW5wdXRFeGNlcHRpb24gZSkgeworCQkJLy8gaWdu
b3JlCisJCX0KKwl9CiAJcHJvdGVjdGVkIHZvaWQgcmV0cmlldmVJZGVudGlmaWVyQW5kU2V0UG9z
aXRpb25zKGludCBzdGFydCwgaW50IGVuZCwgTmFtZSBuYW1lKSB7CiAJCXRoaXMuc2Nhbm5lci5y
ZXNldFRvKHN0YXJ0LCBlbmQpOwpAQCAtNTE5Nyw1ICs1MzA3LDUgQEAKIAkJCQkJCWRlZmF1bHQg
OgogCQkJCQkJCW1ldGhvZERlY2xhcmF0aW9uLnNldFJldHVyblR5cGUyKHN1YmFycmF5VHlwZSk7
Ci0JCQkJCQlicmVhazsKKwkJCQkJCQlicmVhazsKIAkJCQkJfQogCQkJCQl0aGlzLmFzdC5nZXRC
aW5kaW5nUmVzb2x2ZXIoKS51cGRhdGVLZXkodHlwZSwgc3ViYXJyYXlUeXBlKTsKZGlmZiAtLWdp
dCBhL29yZy5lY2xpcHNlLmpkdC5jb3JlL2RvbS9vcmcvZWNsaXBzZS9qZHQvY29yZS9kb20vQVNU
TWF0Y2hlci5qYXZhIGIvb3JnLmVjbGlwc2UuamR0LmNvcmUvZG9tL29yZy9lY2xpcHNlL2pkdC9j
b3JlL2RvbS9BU1RNYXRjaGVyLmphdmEKaW5kZXggZDkxNzgzMC4uMzcwNjQ0MCAxMDA2NDQKLS0t
IGEvb3JnLmVjbGlwc2UuamR0LmNvcmUvZG9tL29yZy9lY2xpcHNlL2pkdC9jb3JlL2RvbS9BU1RN
YXRjaGVyLmphdmEKKysrIGIvb3JnLmVjbGlwc2UuamR0LmNvcmUvZG9tL29yZy9lY2xpcHNlL2pk
dC9jb3JlL2RvbS9BU1RNYXRjaGVyLmphdmEKQEAgLTM1NSw0ICszNTUsMjcgQEAKIAkgKiAgIDxj
b2RlPmZhbHNlPC9jb2RlPiBpZiB0aGV5IGRvIG5vdCBtYXRjaCBvciB0aGUgb3RoZXIgb2JqZWN0
IGhhcyBhCiAJICogICBkaWZmZXJlbnQgbm9kZSB0eXBlIG9yIGlzIDxjb2RlPm51bGw8L2NvZGU+
CisJICogQHNpbmNlIDMuOQorCSAqLworCXB1YmxpYyBib29sZWFuIG1hdGNoKERpbWVuc2lvblR5
cGUgbm9kZSwgT2JqZWN0IG90aGVyKSB7CisJCWlmICghKG90aGVyIGluc3RhbmNlb2YgRGltZW5z
aW9uVHlwZSkpCisJCQlyZXR1cm4gZmFsc2U7CisJCURpbWVuc2lvblR5cGUgbyA9IChEaW1lbnNp
b25UeXBlKSBvdGhlcjsKKwkJcmV0dXJuIHNhZmVTdWJ0cmVlTGlzdE1hdGNoKG5vZGUuYW5ub3Rh
dGlvbnMoKSwgby5hbm5vdGF0aW9ucygpKQorCQkJCSYmIHNhZmVTdWJ0cmVlTWF0Y2gobm9kZS5l
eHByZXNzaW9uKCksIG8uZXhwcmVzc2lvbigpKTsKKwl9CisKKwkvKioKKwkgKiBSZXR1cm5zIHdo
ZXRoZXIgdGhlIGdpdmVuIG5vZGUgYW5kIHRoZSBvdGhlciBvYmplY3QgbWF0Y2guCisJICogPHA+
CisJICogVGhlIGRlZmF1bHQgaW1wbGVtZW50YXRpb24gcHJvdmlkZWQgYnkgdGhpcyBjbGFzcyB0
ZXN0cyB3aGV0aGVyIHRoZQorCSAqIG90aGVyIG9iamVjdCBpcyBhIG5vZGUgb2YgdGhlIHNhbWUg
dHlwZSB3aXRoIHN0cnVjdHVyYWxseSBpc29tb3JwaGljCisJICogY2hpbGQgc3VidHJlZXMuIFN1
YmNsYXNzZXMgbWF5IG92ZXJyaWRlIHRoaXMgbWV0aG9kIGFzIG5lZWRlZC4KKwkgKiA8L3A+CisJ
ICoKKwkgKiBAcGFyYW0gbm9kZSB0aGUgbm9kZQorCSAqIEBwYXJhbSBvdGhlciB0aGUgb3RoZXIg
b2JqZWN0LCBvciA8Y29kZT5udWxsPC9jb2RlPgorCSAqIEByZXR1cm4gPGNvZGU+dHJ1ZTwvY29k
ZT4gaWYgdGhlIHN1YnRyZWUgbWF0Y2hlcywgb3IKKwkgKiAgIDxjb2RlPmZhbHNlPC9jb2RlPiBp
ZiB0aGV5IGRvIG5vdCBtYXRjaCBvciB0aGUgb3RoZXIgb2JqZWN0IGhhcyBhCisJICogICBkaWZm
ZXJlbnQgbm9kZSB0eXBlIG9yIGlzIDxjb2RlPm51bGw8L2NvZGU+CiAJICovCiAJcHVibGljIGJv
b2xlYW4gbWF0Y2goQXNzZXJ0U3RhdGVtZW50IG5vZGUsIE9iamVjdCBvdGhlcikgewpAQCAtMTM5
Miw4ICsxNDE1LDkgQEAKIAkJCQkvLyBuLmIuIGNvbXBhcmUgcmV0dXJuIHR5cGUgZXZlbiBmb3Ig
Y29uc3RydWN0b3JzCiAJCQkJJiYgc2FmZVN1YnRyZWVMaXN0TWF0Y2gobm9kZS5wYXJhbWV0ZXJz
KCksIG8ucGFyYW1ldGVycygpKQotCSAJCQkmJiBub2RlLmdldEV4dHJhRGltZW5zaW9ucygpID09
IG8uZ2V0RXh0cmFEaW1lbnNpb25zKCkKLQkJCQkmJiAobm9kZS5nZXRBU1QoKS5hcGlMZXZlbCgp
IDwgQVNULkpMUzggPyAKLQkJCQkJCXNhZmVTdWJ0cmVlTGlzdE1hdGNoKG5vZGUudGhyb3duRXhj
ZXB0aW9ucygpLCBvLnRocm93bkV4Y2VwdGlvbnMoKSkgOgotCQkJCQkJc2FmZVN1YnRyZWVMaXN0
TWF0Y2gobm9kZS50aHJvd25FeGNlcHRpb25UeXBlcygpLCBvLnRocm93bkV4Y2VwdGlvblR5cGVz
KCkpKQorCQkJCSYmICgobm9kZS5nZXRBU1QoKS5hcGlMZXZlbCA8IEFTVC5KTFM4KSA/CisJCQkJ
CQkJKG5vZGUuZ2V0RXh0cmFEaW1lbnNpb25zKCkgPT0gby5nZXRFeHRyYURpbWVuc2lvbnMoKQor
CQkJCQkJCQkmJiBzYWZlU3VidHJlZUxpc3RNYXRjaChub2RlLnRocm93bkV4Y2VwdGlvbnMoKSwg
by50aHJvd25FeGNlcHRpb25zKCkpKSA6CisJCQkJCQkJKHNhZmVTdWJ0cmVlTGlzdE1hdGNoKG5v
ZGUuZ2V0ZXh0cmFEaW1lbnNpb25UeXBlcygpLCBvLmdldGV4dHJhRGltZW5zaW9uVHlwZXMoKSkK
KwkJCQkJCQkJJiYgc2FmZVN1YnRyZWVMaXN0TWF0Y2gobm9kZS50aHJvd25FeGNlcHRpb25UeXBl
cygpLCBvLnRocm93bkV4Y2VwdGlvblR5cGVzKCkpKSkKIAkJCQkmJiBzYWZlU3VidHJlZU1hdGNo
KG5vZGUuZ2V0Qm9keSgpLCBvLmdldEJvZHkoKSkpOwogCX0KQEAgLTE4ODcsNSArMTkxMSw3IEBA
CiAJCSAgICBzYWZlU3VidHJlZU1hdGNoKG5vZGUuZ2V0VHlwZSgpLCBvLmdldFR5cGUoKSkKIAkJ
CQkmJiBzYWZlU3VidHJlZU1hdGNoKG5vZGUuZ2V0TmFtZSgpLCBvLmdldE5hbWUoKSkKLQkgCQkJ
JiYgbm9kZS5nZXRFeHRyYURpbWVuc2lvbnMoKSA9PSBvLmdldEV4dHJhRGltZW5zaW9ucygpCisJ
IAkJCSYmICgobm9kZS5nZXRBU1QoKS5hcGlMZXZlbCA8IEFTVC5KTFM4KSA/CisJIAkJCQkJKG5v
ZGUuZ2V0RXh0cmFEaW1lbnNpb25zKCkgPT0gby5nZXRFeHRyYURpbWVuc2lvbnMoKSkgOgorCSAJ
CQkJCQlzYWZlU3VidHJlZUxpc3RNYXRjaChub2RlLmdldEV4dHJhRGltZW5zaW9uVHlwZXMoKSwg
by5nZXRFeHRyYURpbWVuc2lvblR5cGVzKCkpKQogCQkJCSYmIHNhZmVTdWJ0cmVlTWF0Y2gobm9k
ZS5nZXRJbml0aWFsaXplcigpLCBvLmdldEluaXRpYWxpemVyKCkpCiAJCQkJJiYgKGxldmVsID49
IEFTVC5KTFM4ICYmIG5vZGUuaXNWYXJhcmdzKCkpID8gc2FmZVN1YnRyZWVMaXN0TWF0Y2gobm9k
ZS52YXJhcmdzQW5ub3RhdGlvbnMoKSwgby52YXJhcmdzQW5ub3RhdGlvbnMoKSkgOiB0cnVlOwkJ
CkBAIC0yMzgwLDUgKzI0MDYsNyBAQAogCQlWYXJpYWJsZURlY2xhcmF0aW9uRnJhZ21lbnQgbyA9
IChWYXJpYWJsZURlY2xhcmF0aW9uRnJhZ21lbnQpIG90aGVyOwogCQlyZXR1cm4gc2FmZVN1YnRy
ZWVNYXRjaChub2RlLmdldE5hbWUoKSwgby5nZXROYW1lKCkpCi0JCQkmJiBub2RlLmdldEV4dHJh
RGltZW5zaW9ucygpID09IG8uZ2V0RXh0cmFEaW1lbnNpb25zKCkKKwkJCSYmICgobm9kZS5nZXRB
U1QoKS5hcGlMZXZlbCA8IEFTVC5KTFM4KSA/CisJCQkJCShub2RlLmdldEV4dHJhRGltZW5zaW9u
cygpID09IG8uZ2V0RXh0cmFEaW1lbnNpb25zKCkpIDoKKwkJCQkJCXNhZmVTdWJ0cmVlTGlzdE1h
dGNoKG5vZGUuZ2V0RXh0cmFEaW1lbnNpb25UeXBlcygpLCBvLmdldEV4dHJhRGltZW5zaW9uVHlw
ZXMoKSkpCiAJCQkmJiBzYWZlU3VidHJlZU1hdGNoKG5vZGUuZ2V0SW5pdGlhbGl6ZXIoKSwgby5n
ZXRJbml0aWFsaXplcigpKTsKIAl9CmRpZmYgLS1naXQgYS9vcmcuZWNsaXBzZS5qZHQuY29yZS9k
b20vb3JnL2VjbGlwc2UvamR0L2NvcmUvZG9tL0FTVE5vZGUuamF2YSBiL29yZy5lY2xpcHNlLmpk
dC5jb3JlL2RvbS9vcmcvZWNsaXBzZS9qZHQvY29yZS9kb20vQVNUTm9kZS5qYXZhCmluZGV4IDZl
YTQzYmEuLjc4MTg3NDggMTAwNjQ0Ci0tLSBhL29yZy5lY2xpcHNlLmpkdC5jb3JlL2RvbS9vcmcv
ZWNsaXBzZS9qZHQvY29yZS9kb20vQVNUTm9kZS5qYXZhCisrKyBiL29yZy5lY2xpcHNlLmpkdC5j
b3JlL2RvbS9vcmcvZWNsaXBzZS9qZHQvY29yZS9kb20vQVNUTm9kZS5qYXZhCkBAIC03NzIsNCAr
NzcyLDEzIEBACiAJICovCiAJcHVibGljIHN0YXRpYyBmaW5hbCBpbnQgVU5JT05fVFlQRSA9IDg0
OworCQorCS8qKgorCSAqIE5vZGUgdHlwZSBjb25zdGFudCBpbmRpY2F0aW5nIGEgbm9kZSBvZiB0
eXBlCisJICogPGNvZGU+RGltZW5zaW9uPC9jb2RlPi4KKwkgKiAKKwkgKiBAc2VlIERpbWVuc2lv
blR5cGUKKwkgKiBAc2luY2UgMy45CisJICovCisJcHVibGljIHN0YXRpYyBmaW5hbCBpbnQgRElN
RU5TSU9OX1RZUEUgPSA4NTsKIAogCS8qKgpAQCAtMTg0MSw1ICsxODUwLDUgQEAKIAkgIH0KIAl9
Ci0KKwkKIAkvKioKICAgICAgKiBDaGVja3MgdGhhdCB0aGlzIEFTVCBvcGVyYXRpb24gaXMgb25s
eSB1c2VkIHdoZW4KZGlmZiAtLWdpdCBhL29yZy5lY2xpcHNlLmpkdC5jb3JlL2RvbS9vcmcvZWNs
aXBzZS9qZHQvY29yZS9kb20vQVNUVmlzaXRvci5qYXZhIGIvb3JnLmVjbGlwc2UuamR0LmNvcmUv
ZG9tL29yZy9lY2xpcHNlL2pkdC9jb3JlL2RvbS9BU1RWaXNpdG9yLmphdmEKaW5kZXggYjI5MzA1
My4uZjhkMTZhYSAxMDA2NDQKLS0tIGEvb3JnLmVjbGlwc2UuamR0LmNvcmUvZG9tL29yZy9lY2xp
cHNlL2pkdC9jb3JlL2RvbS9BU1RWaXNpdG9yLmphdmEKKysrIGIvb3JnLmVjbGlwc2UuamR0LmNv
cmUvZG9tL29yZy9lY2xpcHNlL2pkdC9jb3JlL2RvbS9BU1RWaXNpdG9yLmphdmEKQEAgLTIwMCw0
ICsyMDAsMjAgQEAKIAl9CiAKKwkvKioKKwkgKiBWaXNpdHMgdGhlIGdpdmVuIHR5cGUtc3BlY2lm
aWMgQVNUIG5vZGUuCisJICogPHA+CisJICogVGhlIGRlZmF1bHQgaW1wbGVtZW50YXRpb24gZG9l
cyBub3RoaW5nIGFuZCByZXR1cm4gdHJ1ZS4KKwkgKiBTdWJjbGFzc2VzIG1heSByZWltcGxlbWVu
dC4KKwkgKiA8L3A+CisJICoKKwkgKiBAcGFyYW0gbm9kZSB0aGUgbm9kZSB0byB2aXNpdAorCSAq
IEByZXR1cm4gPGNvZGU+dHJ1ZTwvY29kZT4gaWYgdGhlIGNoaWxkcmVuIG9mIHRoaXMgbm9kZSBz
aG91bGQgYmUKKwkgKiB2aXNpdGVkLCBhbmQgPGNvZGU+ZmFsc2U8L2NvZGU+IGlmIHRoZSBjaGls
ZHJlbiBvZiB0aGlzIG5vZGUgc2hvdWxkCisJICogYmUgc2tpcHBlZAorCSAqIEBzaW5jZSAzLjkK
KwkgKi8KKwlwdWJsaWMgYm9vbGVhbiB2aXNpdChEaW1lbnNpb25UeXBlIG5vZGUpIHsKKwkJcmV0
dXJuIHRydWU7CisJfQogCiAJLyoqCkBAIC0xNTkzLDQgKzE2MDksMTcgQEAKIAkJLy8gZGVmYXVs
dCBpbXBsZW1lbnRhdGlvbjogZG8gbm90aGluZwogCX0KKwkKKwkvKioKKwkgKiBFbmQgb2Ygdmlz
aXQgdGhlIGdpdmVuIHR5cGUtc3BlY2lmaWMgQVNUIG5vZGUuCisJICogPHA+CisJICogVGhlIGRl
ZmF1bHQgaW1wbGVtZW50YXRpb24gZG9lcyBub3RoaW5nLiBTdWJjbGFzc2VzIG1heSByZWltcGxl
bWVudC4KKwkgKiA8L3A+CisJICoKKwkgKiBAcGFyYW0gbm9kZSB0aGUgbm9kZSB0byB2aXNpdAor
CSAqIEBzaW5jZSAzLjkKKwkgKi8KKwlwdWJsaWMgdm9pZCBlbmRWaXNpdChEaW1lbnNpb25UeXBl
IG5vZGUpIHsKKwkJLy8gZG8gbm90aGluZyBieSBkZWZhdWx0CisJfQogCiAJLyoqCmRpZmYgLS1n
aXQgYS9vcmcuZWNsaXBzZS5qZHQuY29yZS9kb20vb3JnL2VjbGlwc2UvamR0L2NvcmUvZG9tL0Fu
bm90YXRhYmxlVHlwZS5qYXZhIGIvb3JnLmVjbGlwc2UuamR0LmNvcmUvZG9tL29yZy9lY2xpcHNl
L2pkdC9jb3JlL2RvbS9Bbm5vdGF0YWJsZVR5cGUuamF2YQpuZXcgZmlsZSBtb2RlIDEwMDY0NApp
bmRleCAwMDAwMDAwLi4zZjNjYjJkCi0tLSAvZGV2L251bGwKKysrIGIvb3JnLmVjbGlwc2UuamR0
LmNvcmUvZG9tL29yZy9lY2xpcHNlL2pkdC9jb3JlL2RvbS9Bbm5vdGF0YWJsZVR5cGUuamF2YQpA
QCAtMCwwICsxLDU3IEBACisvKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioq
KioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKgorICogQ29weXJpZ2h0IChj
KSAyMDAwLCAyMDEzIElCTSBDb3Jwb3JhdGlvbiBhbmQgb3RoZXJzLgorICogQWxsIHJpZ2h0cyBy
ZXNlcnZlZC4gVGhpcyBwcm9ncmFtIGFuZCB0aGUgYWNjb21wYW55aW5nIG1hdGVyaWFscworICog
YXJlIG1hZGUgYXZhaWxhYmxlIHVuZGVyIHRoZSB0ZXJtcyBvZiB0aGUgRWNsaXBzZSBQdWJsaWMg
TGljZW5zZSB2MS4wCisgKiB3aGljaCBhY2NvbXBhbmllcyB0aGlzIGRpc3RyaWJ1dGlvbiwgYW5k
IGlzIGF2YWlsYWJsZSBhdAorICogaHR0cDovL3d3dy5lY2xpcHNlLm9yZy9sZWdhbC9lcGwtdjEw
Lmh0bWwKKyAqCisgKiBUaGlzIGlzIGFuIGltcGxlbWVudGF0aW9uIG9mIGFuIGVhcmx5LWRyYWZ0
IHNwZWNpZmljYXRpb24gZGV2ZWxvcGVkIHVuZGVyIHRoZSBKYXZhCisgKiBDb21tdW5pdHkgUHJv
Y2VzcyAoSkNQKSBhbmQgaXMgbWFkZSBhdmFpbGFibGUgZm9yIHRlc3RpbmcgYW5kIGV2YWx1YXRp
b24gcHVycG9zZXMKKyAqIG9ubHkuIFRoZSBjb2RlIGlzIG5vdCBjb21wYXRpYmxlIHdpdGggYW55
IHNwZWNpZmljYXRpb24gb2YgdGhlIEpDUC4KKyAqIAorICogQ29udHJpYnV0b3JzOgorICogICAg
IElCTSBDb3Jwb3JhdGlvbiAtIGluaXRpYWwgQVBJIGFuZCBpbXBsZW1lbnRhdGlvbgorICoqKioq
KioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioq
KioqKioqKioqKioqKioqKiovCitwYWNrYWdlIG9yZy5lY2xpcHNlLmpkdC5jb3JlLmRvbTsKKwor
aW1wb3J0IGphdmEudXRpbC5MaXN0OworCisvKioKKyAqIFR5cGUgbm9kZSBmb3IgYW4gYW5ub3Rh
dGFibGUgdHlwZS4KKyAqIDxwPgorICogSW50cm9kdWNlZCBpbiBKTFM4LCB0eXBlIHJlZmVyZW5j
ZXMgdGhhdCBjYW4gYmUgYW5ub3RhdGVkIGFyZSByZXByZXNlbnRlZCBieSAKKyAqIEFubm90YXRh
YmxlVHlwZS4gRm9yIHRoZSBsaXN0IG9mIHR5cGVzIGV4dGVuZGluZyBBbm5vdGF0YWJsZVR5cGUs
IHNlZSB7QGxpbmsgVHlwZX08L3A+CisgKgorICogQHNpbmNlIDMuOQorICovCitwdWJsaWMgYWJz
dHJhY3QgY2xhc3MgQW5ub3RhdGFibGVUeXBlIGV4dGVuZHMgVHlwZSB7CisKKwkvKioKKwkgKiBD
cmVhdGVzIGEgbmV3IHVucGFyZW50ZWQgbm9kZSBmb3IgYW4gYW5ub3RhdGFibGUgdHlwZSBvd25l
ZCBieSB0aGUgZ2l2ZW4gQVNULgorCSAqIDxwPgorCSAqIE4uQi4gVGhpcyBjb25zdHJ1Y3RvciBp
cyBwYWNrYWdlLXByaXZhdGUuCisJICogPC9wPgorCSAqCisJICogQHBhcmFtIGFzdCB0aGUgQVNU
IHRoYXQgaXMgdG8gb3duIHRoaXMgbm9kZQorCSAqLworCUFubm90YXRhYmxlVHlwZShBU1QgYXN0
KSB7CisJCXN1cGVyKGFzdCk7CisJfQorCQorCUFTVE5vZGUuTm9kZUxpc3QgYW5ub3RhdGlvbnMg
PSBudWxsOworCQorCS8qKgorCSAqIFJldHVybnMgdGhlIGxpdmUgb3JkZXJlZCBsaXN0IG9mIGFu
bm90YXRpb25zIGZvciB0aGlzIFR5cGUgbm9kZS4KKwkgKgorCSAqIEByZXR1cm4gdGhlIGxpdmUg
bGlzdCBvZiBhbm5vdGF0aW9ucyAoZWxlbWVudCB0eXBlOiB7QGxpbmsgQW5ub3RhdGlvbn0pCisJ
ICogQGV4Y2VwdGlvbiBVbnN1cHBvcnRlZE9wZXJhdGlvbkV4Y2VwdGlvbiBpZiB0aGlzIG9wZXJh
dGlvbiBpcyB1c2VkCisJICogICAgICAgICAgICBpbiBhIEpMUzIsIEpMUzMgb3IgSkxTNCBBU1QK
KwkgKiBAc2luY2UgMy45CisJICovCisJcHVibGljIExpc3QgYW5ub3RhdGlvbnMoKSB7CisJCWlm
ICh0aGlzLmFubm90YXRpb25zID09IG51bGwpIHsKKwkJCXVuc3VwcG9ydGVkSW4yXzNfNCgpOwor
CQl9CisJCXJldHVybiB0aGlzLmFubm90YXRpb25zOworCX0KK30KZGlmZiAtLWdpdCBhL29yZy5l
Y2xpcHNlLmpkdC5jb3JlL2RvbS9vcmcvZWNsaXBzZS9qZHQvY29yZS9kb20vQXJyYXlUeXBlLmph
dmEgYi9vcmcuZWNsaXBzZS5qZHQuY29yZS9kb20vb3JnL2VjbGlwc2UvamR0L2NvcmUvZG9tL0Fy
cmF5VHlwZS5qYXZhCmluZGV4IDNlODdlNmYuLmEwMWQ5NTIgMTAwNjQ0Ci0tLSBhL29yZy5lY2xp
cHNlLmpkdC5jb3JlL2RvbS9vcmcvZWNsaXBzZS9qZHQvY29yZS9kb20vQXJyYXlUeXBlLmphdmEK
KysrIGIvb3JnLmVjbGlwc2UuamR0LmNvcmUvZG9tL29yZy9lY2xpcHNlL2pkdC9jb3JlL2RvbS9B
cnJheVR5cGUuamF2YQpAQCAtMSw0ICsxLDQgQEAKIC8qKioqKioqKioqKioqKioqKioqKioqKioq
KioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqCi0g
KiBDb3B5cmlnaHQgKGMpIDIwMDAsIDIwMTIgSUJNIENvcnBvcmF0aW9uIGFuZCBvdGhlcnMuCisg
KiBDb3B5cmlnaHQgKGMpIDIwMDAsIDIwMTMgSUJNIENvcnBvcmF0aW9uIGFuZCBvdGhlcnMuCiAg
KiBBbGwgcmlnaHRzIHJlc2VydmVkLiBUaGlzIHByb2dyYW0gYW5kIHRoZSBhY2NvbXBhbnlpbmcg
bWF0ZXJpYWxzCiAgKiBhcmUgbWFkZSBhdmFpbGFibGUgdW5kZXIgdGhlIHRlcm1zIG9mIHRoZSBF
Y2xpcHNlIFB1YmxpYyBMaWNlbnNlIHYxLjAKQEAgLTM4LDUgKzM4LDUgQEAKICAqIEBub2luc3Rh
bnRpYXRlIFRoaXMgY2xhc3MgaXMgbm90IGludGVuZGVkIHRvIGJlIGluc3RhbnRpYXRlZCBieSBj
bGllbnRzLgogICovCi1wdWJsaWMgY2xhc3MgQXJyYXlUeXBlIGV4dGVuZHMgVHlwZSB7CitwdWJs
aWMgY2xhc3MgQXJyYXlUeXBlIGV4dGVuZHMgQW5ub3RhdGFibGVUeXBlIHsKIAogCS8qKgpAQCAt
MTczLDUgKzE3Myw0IEBACiAJCXJlc3VsdC5zZXRDb21wb25lbnRUeXBlKChUeXBlKSBnZXRDb21w
b25lbnRUeXBlKCkuY2xvbmUodGFyZ2V0KSk7CiAJCWlmICh0aGlzLmFzdC5hcGlMZXZlbCA+PSBB
U1QuSkxTOCkgewotCQkJcmVzdWx0LmFubm90YXRpb25zID0gbmV3IEFTVE5vZGUuTm9kZUxpc3Qo
QU5OT1RBVElPTlNfUFJPUEVSVFkpOwogCQkJcmVzdWx0LmFubm90YXRpb25zLmFkZEFsbCgKIAkJ
CQkJQVNUTm9kZS5jb3B5U3VidHJlZXModGFyZ2V0LCBhbm5vdGF0aW9ucygpKSk7CmRpZmYgLS1n
aXQgYS9vcmcuZWNsaXBzZS5qZHQuY29yZS9kb20vb3JnL2VjbGlwc2UvamR0L2NvcmUvZG9tL0Rp
bWVuc2lvblR5cGUuamF2YSBiL29yZy5lY2xpcHNlLmpkdC5jb3JlL2RvbS9vcmcvZWNsaXBzZS9q
ZHQvY29yZS9kb20vRGltZW5zaW9uVHlwZS5qYXZhCm5ldyBmaWxlIG1vZGUgMTAwNjQ0CmluZGV4
IDAwMDAwMDAuLjU0Y2EyNGMKLS0tIC9kZXYvbnVsbAorKysgYi9vcmcuZWNsaXBzZS5qZHQuY29y
ZS9kb20vb3JnL2VjbGlwc2UvamR0L2NvcmUvZG9tL0RpbWVuc2lvblR5cGUuamF2YQpAQCAtMCww
ICsxLDE5NyBAQAorLyoqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioq
KioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioKKyAqIENvcHlyaWdodCAoYykgMjAw
MCwgMjAxMyBJQk0gQ29ycG9yYXRpb24gYW5kIG90aGVycy4KKyAqIEFsbCByaWdodHMgcmVzZXJ2
ZWQuIFRoaXMgcHJvZ3JhbSBhbmQgdGhlIGFjY29tcGFueWluZyBtYXRlcmlhbHMKKyAqIGFyZSBt
YWRlIGF2YWlsYWJsZSB1bmRlciB0aGUgdGVybXMgb2YgdGhlIEVjbGlwc2UgUHVibGljIExpY2Vu
c2UgdjEuMAorICogd2hpY2ggYWNjb21wYW5pZXMgdGhpcyBkaXN0cmlidXRpb24sIGFuZCBpcyBh
dmFpbGFibGUgYXQKKyAqIGh0dHA6Ly93d3cuZWNsaXBzZS5vcmcvbGVnYWwvZXBsLXYxMC5odG1s
CisgKgorICogVGhpcyBpcyBhbiBpbXBsZW1lbnRhdGlvbiBvZiBhbiBlYXJseS1kcmFmdCBzcGVj
aWZpY2F0aW9uIGRldmVsb3BlZCB1bmRlciB0aGUgSmF2YQorICogQ29tbXVuaXR5IFByb2Nlc3Mg
KEpDUCkgYW5kIGlzIG1hZGUgYXZhaWxhYmxlIGZvciB0ZXN0aW5nIGFuZCBldmFsdWF0aW9uIHB1
cnBvc2VzCisgKiBvbmx5LiBUaGUgY29kZSBpcyBub3QgY29tcGF0aWJsZSB3aXRoIGFueSBzcGVj
aWZpY2F0aW9uIG9mIHRoZSBKQ1AuCisgKiAKKyAqIENvbnRyaWJ1dG9yczoKKyAqICAgICBJQk0g
Q29ycG9yYXRpb24gLSBpbml0aWFsIEFQSSBhbmQgaW1wbGVtZW50YXRpb24KKyAqKioqKioqKioq
KioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioq
KioqKioqKioqKioqLworcGFja2FnZSBvcmcuZWNsaXBzZS5qZHQuY29yZS5kb207CisKK2ltcG9y
dCBqYXZhLnV0aWwuQXJyYXlMaXN0OworaW1wb3J0IGphdmEudXRpbC5MaXN0OworCisvKioKKyAq
IFRoZSBhcnJheSBkaW1lbnNpb24gdHlwZSBub2RlLiBUaGUgYXJyYXkgZGltZW5zaW9uLCByZXBy
ZXNlbnRlZCBhcyA8Yj5bXTwvYj4sIG1heSBub3QgbWF5IG5vdCAKKyAqIGluY2x1ZGUgYW4gPGNv
ZGU+RXhwcmVzc2lvbjwvY29kZT4gZGVwZW5kaW5nIG9uIHdoZXJlIGl0IGFwcGVhcnMuIFRoZSBv
bmx5IAorICogbm9kZSB0aGF0IHN1cHBvcnRzIGEgZGltZW5zaW9uIHR5cGUgd2l0aCBhbiBleHBy
ZXNzaW9uIGlzIDxjb2RlPkFycmF5Q3JlYXRpb248L2NvZGU+LgorICogVGhpcyBub2RlIHR5cGUg
aXMgc3VwcG9ydGVkIG9ubHkgaW4gSkxTOCBvciBsYXRlci4KKyAqIAorICogRm9yIEpMUzg6Cisg
KiA8cHJlPgorICogRGltZW5zaW9uVHlwZToKKyAqIAk8Yj5bPC9iPiB7RXhwcmVzc2lvbn0gPGI+
XTwvYj4gCisgKiA8L3ByZT4KKyAqIAorICogQHNpbmNlIDMuOQorICovCitwdWJsaWMgY2xhc3Mg
RGltZW5zaW9uVHlwZSBleHRlbmRzIEFubm90YXRhYmxlVHlwZSB7CisKKwkKKwkvKioKKwkgKiBU
aGUgImFubm90YXRpb25zIiBzdHJ1Y3R1cmFsIHByb3BlcnR5IG9mIHRoaXMgbm9kZSB0eXBlIChj
aGlsZCB0eXBlOiB7QGxpbmsgQW5ub3RhdGlvbn0pLgorCSAqIEBzaW5jZSAzLjkKKwkgKi8KKwlw
dWJsaWMgc3RhdGljIGZpbmFsIENoaWxkTGlzdFByb3BlcnR5RGVzY3JpcHRvciBBTk5PVEFUSU9O
U19QUk9QRVJUWSA9CisJCW5ldyBDaGlsZExpc3RQcm9wZXJ0eURlc2NyaXB0b3IoRGltZW5zaW9u
VHlwZS5jbGFzcywgImFubm90YXRpb25zIiwgQW5ub3RhdGlvbi5jbGFzcywgTk9fQ1lDTEVfUklT
Syk7IC8vJE5PTi1OTFMtMSQKKwkKKworCS8qKgorCSAqIFRoZSAiZGltZW5zaW9ucyIgc3RydWN0
dXJhbCBwcm9wZXJ0eSBvZiB0aGlzIG5vZGUgdHlwZSAoZWxlbWVudCB0eXBlOiB7QGxpbmsgRXhw
cmVzc2lvbn0pLgorCSAqIEBzaW5jZSAzLjkKKwkgKi8KKwlwdWJsaWMgc3RhdGljIGZpbmFsIENo
aWxkUHJvcGVydHlEZXNjcmlwdG9yIEVYUFJFU1NJT05fUFJPUEVSVFkgPQorCQkJbmV3IENoaWxk
UHJvcGVydHlEZXNjcmlwdG9yKERpbWVuc2lvblR5cGUuY2xhc3MsICJleHByZXNzaW9uIiwgRXhw
cmVzc2lvbi5jbGFzcywgTUFOREFUT1JZLCBOT19DWUNMRV9SSVNLKTsgLy8kTk9OLU5MUy0xJAor
CQorCQorCS8qKgorCSAqIEEgbGlzdCBvZiBwcm9wZXJ0eSBkZXNjcmlwdG9ycyAoZWxlbWVudCB0
eXBlOgorCSAqIHtAbGluayBTdHJ1Y3R1cmFsUHJvcGVydHlEZXNjcmlwdG9yfSksCisJICogb3Ig
bnVsbCBpZiB1bmluaXRpYWxpemVkLgorCSAqIEBzaW5jZSAzLjkKKwkgKi8KKwlwcml2YXRlIHN0
YXRpYyBmaW5hbCBMaXN0IFBST1BFUlRZX0RFU0NSSVBUT1JTXzhfMDsKKwkKKwlzdGF0aWMgewor
CQlMaXN0IHByb3BlcnR5TGlzdCA9IG5ldyBBcnJheUxpc3QoMyk7CisJCWNyZWF0ZVByb3BlcnR5
TGlzdChEaW1lbnNpb25UeXBlLmNsYXNzLCBwcm9wZXJ0eUxpc3QpOworCQlhZGRQcm9wZXJ0eShB
Tk5PVEFUSU9OU19QUk9QRVJUWSwgcHJvcGVydHlMaXN0KTsKKwkJYWRkUHJvcGVydHkoRVhQUkVT
U0lPTl9QUk9QRVJUWSwgcHJvcGVydHlMaXN0KTsKKwkJUFJPUEVSVFlfREVTQ1JJUFRPUlNfOF8w
ID0gcmVhcFByb3BlcnR5TGlzdChwcm9wZXJ0eUxpc3QpOworCX0KKwkKKwkvKioKKwkgKiBSZXR1
cm5zIGEgbGlzdCBvZiBzdHJ1Y3R1cmFsIHByb3BlcnR5IGRlc2NyaXB0b3JzIGZvciB0aGlzIG5v
ZGUgdHlwZS4KKwkgKiBDbGllbnRzIG11c3Qgbm90IG1vZGlmeSB0aGUgcmVzdWx0LgorCSAqCisJ
ICogQHBhcmFtIGFwaUxldmVsIHRoZSBBUEkgbGV2ZWw7IG9uZSBvZiB0aGUKKwkgKiA8Y29kZT5B
U1QuSkxTKjwvY29kZT4gY29uc3RhbnRzCisJICogQHJldHVybiBhIGxpc3Qgb2YgcHJvcGVydHkg
ZGVzY3JpcHRvcnMgKGVsZW1lbnQgdHlwZToKKwkgKiB7QGxpbmsgU3RydWN0dXJhbFByb3BlcnR5
RGVzY3JpcHRvcn0pCisJICogQHNpbmNlIDMuOQorCSAqLworCXB1YmxpYyBzdGF0aWMgTGlzdCBw
cm9wZXJ0eURlc2NyaXB0b3JzKGludCBhcGlMZXZlbCkgeworCQlyZXR1cm4gUFJPUEVSVFlfREVT
Q1JJUFRPUlNfOF8wOworCX0KKwkKKwlwdWJsaWMgRGltZW5zaW9uVHlwZShBU1QgYXN0KSB7CisJ
CXN1cGVyKGFzdCk7CisJCXVuc3VwcG9ydGVkSW4yXzNfNCgpOworCQl0aGlzLmFubm90YXRpb25z
ID0gbmV3IEFTVE5vZGUuTm9kZUxpc3QoQU5OT1RBVElPTlNfUFJPUEVSVFkpOworCX0KKwkKKwkv
KioKKwkgKiBUaGUgbGlzdCBvZiBkaW1lbnNpb24gZXhwcmVzc2lvbnMgKGVsZW1lbnQgdHlwZToK
KwkgKiB7QGxpbmsgRXhwcmVzc2lvbn0pLiBEZWZhdWx0cyB0byBhbiBlbXB0eSBsaXN0LgorCSAq
LworCXByaXZhdGUgRXhwcmVzc2lvbiBleHByZXNzaW9uID0gbnVsbDsKKwkKKwkvKioKKwkgKiBT
ZXRzIHRoZSBhcnJheSB0eXBlIGluIHRoaXMgYXJyYXkgY3JlYXRpb24gZXhwcmVzc2lvbi4KKwkg
KgorCSAqIEBwYXJhbSBleHByZXNzaW9uIHRoZSBuZXcgYXJyYXkgdHlwZQorCSAqIEBleGNlcHRp
b24gSWxsZWdhbEFyZ3VtZW50RXhjZXB0aW9uIGlmOgorCSAqIDx1bD4KKwkgKiA8bGk+dGhlIG5v
ZGUgYmVsb25ncyB0byBhIGRpZmZlcmVudCBBU1Q8L2xpPgorCSAqIDxsaT50aGUgbm9kZSBhbHJl
YWR5IGhhcyBhIHBhcmVudDwvbGk+CisJICogPC91bD4KKwkgKiAKKwkgKiBAc2luY2UgMy45CisJ
ICovCisJcHVibGljIHZvaWQgc2V0RXhwcmVzc2lvbihFeHByZXNzaW9uIGV4cHJlc3Npb24pIHsK
KwkJLy8gYW4gQXJyYXlDcmVhdGlvbiBjYW5ub3Qgb2NjdXIgaW5zaWRlIGEgQXJyYXlUeXBlIC0g
Y3ljbGVzIG5vdCBwb3NzaWJsZQorCQlBU1ROb2RlIG9sZENoaWxkID0gdGhpcy5leHByZXNzaW9u
OworCQlwcmVSZXBsYWNlQ2hpbGQob2xkQ2hpbGQsIGV4cHJlc3Npb24sIEVYUFJFU1NJT05fUFJP
UEVSVFkpOworCQl0aGlzLmV4cHJlc3Npb24gPSBleHByZXNzaW9uOworCQlwb3N0UmVwbGFjZUNo
aWxkKG9sZENoaWxkLCBleHByZXNzaW9uLCBFWFBSRVNTSU9OX1BST1BFUlRZKTsKKwl9CisJCisJ
LyoqCisJICogUmV0dXJucyB0aGUgZXhwcmVzc2lvbiBpbiB0aGUgZGltZW5zaW9uIHR5cGUuCisJ
ICoKKwkgKiBAcmV0dXJuIHRoZSBleHByZXNzaW9uCisJICogQHNpbmNlIDMuOQorCSAqLworCXB1
YmxpYyBFeHByZXNzaW9uIGV4cHJlc3Npb24oKSB7CisJCXJldHVybiB0aGlzLmV4cHJlc3Npb247
CisJfQorCQorCUxpc3QgaW50ZXJuYWxTdHJ1Y3R1cmFsUHJvcGVydGllc0ZvclR5cGUoaW50IGFw
aUxldmVsKSB7CisJCXJldHVybiBwcm9wZXJ0eURlc2NyaXB0b3JzKGFwaUxldmVsKTsKKwl9CisK
KwkvKiAob21pdCBqYXZhZG9jIGZvciB0aGlzIG1ldGhvZCkKKwkgKiBNZXRob2QgZGVjbGFyZWQg
b24gQVNUTm9kZS4KKwkgKi8KKwlmaW5hbCBBU1ROb2RlIGludGVybmFsR2V0U2V0Q2hpbGRQcm9w
ZXJ0eShDaGlsZFByb3BlcnR5RGVzY3JpcHRvciBwcm9wZXJ0eSwgYm9vbGVhbiBnZXQsIEFTVE5v
ZGUgY2hpbGQpIHsKKwkJaWYgKHByb3BlcnR5ID09IEVYUFJFU1NJT05fUFJPUEVSVFkpIHsKKwkJ
CWlmIChnZXQpIHsKKwkJCQlyZXR1cm4gZXhwcmVzc2lvbigpOworCQkJfSBlbHNlIHsKKwkJCQlz
ZXRFeHByZXNzaW9uKChFeHByZXNzaW9uKSBjaGlsZCk7CisJCQkJcmV0dXJuIG51bGw7CisJCQl9
CisJCX0KKwkJLy8gYWxsb3cgZGVmYXVsdCBpbXBsZW1lbnRhdGlvbiB0byBmbGFnIHRoZSBlcnJv
cgorCQlyZXR1cm4gc3VwZXIuaW50ZXJuYWxHZXRTZXRDaGlsZFByb3BlcnR5KHByb3BlcnR5LCBn
ZXQsIGNoaWxkKTsKKwl9CisKKwkvKiAob21pdCBqYXZhZG9jIGZvciB0aGlzIG1ldGhvZCkKKwkg
KiBNZXRob2QgZGVjbGFyZWQgb24gQVNUTm9kZS4KKwkgKi8KKwlmaW5hbCBMaXN0IGludGVybmFs
R2V0Q2hpbGRMaXN0UHJvcGVydHkoQ2hpbGRMaXN0UHJvcGVydHlEZXNjcmlwdG9yIHByb3BlcnR5
KSB7CisJCWlmIChwcm9wZXJ0eSA9PSBBTk5PVEFUSU9OU19QUk9QRVJUWSkgeworCQkJcmV0dXJu
IGFubm90YXRpb25zKCk7CisJCX0KKwkJLy8gYWxsb3cgZGVmYXVsdCBpbXBsZW1lbnRhdGlvbiB0
byBmbGFnIHRoZSBlcnJvcgorCQlyZXR1cm4gc3VwZXIuaW50ZXJuYWxHZXRDaGlsZExpc3RQcm9w
ZXJ0eShwcm9wZXJ0eSk7CisJfQorCisJaW50IGdldE5vZGVUeXBlMCgpIHsKKwkJcmV0dXJuIERJ
TUVOU0lPTl9UWVBFOworCX0KKworCWJvb2xlYW4gc3VidHJlZU1hdGNoMChBU1RNYXRjaGVyIG1h
dGNoZXIsIE9iamVjdCBvdGhlcikgeworCQlyZXR1cm4gbWF0Y2hlci5tYXRjaCh0aGlzLCBvdGhl
cik7CisJfQorCisJQVNUTm9kZSBjbG9uZTAoQVNUIHRhcmdldCkgeworCQlEaW1lbnNpb25UeXBl
IHJlc3VsdCA9IG5ldyBEaW1lbnNpb25UeXBlKHRhcmdldCk7CisJCXJlc3VsdC5hbm5vdGF0aW9u
cy5hZGRBbGwoCisJCQkJQVNUTm9kZS5jb3B5U3VidHJlZXModGFyZ2V0LCBhbm5vdGF0aW9ucygp
KSk7CisJCWlmICh0aGlzLmV4cHJlc3Npb24gIT0gbnVsbCkgeworCQkJcmVzdWx0LnNldEV4cHJl
c3Npb24oKEV4cHJlc3Npb24pZXhwcmVzc2lvbigpLmNsb25lKHRhcmdldCkpOworCQl9CisJCXJl
dHVybiByZXN1bHQ7CisJfQorCisJdm9pZCBhY2NlcHQwKEFTVFZpc2l0b3IgdmlzaXRvcikgewor
CQlib29sZWFuIHZpc2l0Q2hpbGRyZW4gPSB2aXNpdG9yLnZpc2l0KHRoaXMpOworCQlpZiAodmlz
aXRDaGlsZHJlbikgeworCQkJYWNjZXB0Q2hpbGRyZW4odmlzaXRvciwgdGhpcy5hbm5vdGF0aW9u
cyk7CisJCQlpZiAodGhpcy5leHByZXNzaW9uICE9IG51bGwpIHsKKwkJCQlhY2NlcHRDaGlsZCh2
aXNpdG9yLCB0aGlzLmV4cHJlc3Npb24pOworCQkJfQorCQl9CisJCXZpc2l0b3IuZW5kVmlzaXQo
dGhpcyk7CisKKwl9CisKKwlpbnQgdHJlZVNpemUoKSB7CisJCWludCBzaXplID0gbWVtU2l6ZSgp
CisJCQkJKyB0aGlzLmFubm90YXRpb25zLmxpc3RTaXplKCkKKwkJCQkrICh0aGlzLmV4cHJlc3Np
b24gPT0gbnVsbCA/IDAgOiB0aGlzLmV4cHJlc3Npb24udHJlZVNpemUoKSk7CisJCQlyZXR1cm4g
c2l6ZTsKKwl9CisKKwlpbnQgbWVtU2l6ZSgpIHsKKwkJcmV0dXJuIEJBU0VfTk9ERV9TSVpFICsg
MiAqIDQ7CisJfQorCit9CmRpZmYgLS1naXQgYS9vcmcuZWNsaXBzZS5qZHQuY29yZS9kb20vb3Jn
L2VjbGlwc2UvamR0L2NvcmUvZG9tL01ldGhvZERlY2xhcmF0aW9uLmphdmEgYi9vcmcuZWNsaXBz
ZS5qZHQuY29yZS9kb20vb3JnL2VjbGlwc2UvamR0L2NvcmUvZG9tL01ldGhvZERlY2xhcmF0aW9u
LmphdmEKaW5kZXggM2M1YWJjYi4uY2MwMDA5MSAxMDA2NDQKLS0tIGEvb3JnLmVjbGlwc2UuamR0
LmNvcmUvZG9tL29yZy9lY2xpcHNlL2pkdC9jb3JlL2RvbS9NZXRob2REZWNsYXJhdGlvbi5qYXZh
CisrKyBiL29yZy5lY2xpcHNlLmpkdC5jb3JlL2RvbS9vcmcvZWNsaXBzZS9qZHQvY29yZS9kb20v
TWV0aG9kRGVjbGFyYXRpb24uamF2YQpAQCAtMTI5LDQgKzEyOSwxMSBAQAogCiAJLyoqCisJICog
VGhlICJleHRyYURpbWVuc2lvblR5cGVzIiBzdHJ1Y3R1cmFsIHByb3BlcnR5IG9mIHRoaXMgbm9k
ZSB0eXBlIChjaGlsZCB0eXBlOiB7QGxpbmsgRGltZW5zaW9uVHlwZX0pLgorCSAqIEBzaW5jZSAz
LjkKKwkgKi8KKwlwdWJsaWMgc3RhdGljIGZpbmFsIENoaWxkTGlzdFByb3BlcnR5RGVzY3JpcHRv
ciBFWFRSQV9ESU1FTlNJT05fVFlQRVNfUFJPUEVSVFkgPQorCQkJbmV3IENoaWxkTGlzdFByb3Bl
cnR5RGVzY3JpcHRvcihNZXRob2REZWNsYXJhdGlvbi5jbGFzcywgImV4dHJhRGltZW5zaW9uVHlw
ZXMiLCBEaW1lbnNpb25UeXBlLmNsYXNzLCBOT19DWUNMRV9SSVNLKTsgLy8kTk9OLU5MUy0xJAor
CisJLyoqCiAJICogVGhlICJ0eXBlUGFyYW1ldGVycyIgc3RydWN0dXJhbCBwcm9wZXJ0eSBvZiB0
aGlzIG5vZGUgdHlwZSAoZWxlbWVudCB0eXBlOiB7QGxpbmsgVHlwZVBhcmFtZXRlcn0pIChhZGRl
ZCBpbiBKTFMzIEFQSSkuCiAJICogQHNpbmNlIDMuMQpAQCAtMzAwLDQgKzMwNywxMSBAQAogCiAJ
LyoqCisJICogVGhlIGV4dHJhIGRpbWVuc2lvbiB0eXBlcyB0aGlzIG5vZGUgaGFzIHdpdGggYW5u
b3RhdGlvbnMgaWYgYW55LgorCSAqIAorCSAqIEBzaW5jZSAzLjkKKwkgKi8KKwlwcm90ZWN0ZWQg
QVNUTm9kZS5Ob2RlTGlzdCBleHRyYURpbWVuc2lvblR5cGVzID0gbnVsbDsKKworCS8qKgogCSAq
IFRoZSBsaXN0IG9mIHRocm93biBleGNlcHRpb24gbmFtZXMgKGVsZW1lbnQgdHlwZToge0BsaW5r
IE5hbWV9KS4KIAkgKiBEZWZhdWx0cyB0byBhbiBlbXB0eSBsaXN0IGZvciBhcGkgbGV2ZWxzIGJl
bG93IEpMUzguCkBAIC0zMzYsNCArMzUwLDcgQEAKIAkJaWYgKGFzdC5hcGlMZXZlbCA+PSBBU1Qu
SkxTM19JTlRFUk5BTCkgewogCQkJdGhpcy50eXBlUGFyYW1ldGVycyA9IG5ldyBBU1ROb2RlLk5v
ZGVMaXN0KFRZUEVfUEFSQU1FVEVSU19QUk9QRVJUWSk7CisJCX0gCisJCWlmIChhc3QuYXBpTGV2
ZWwgPj0gQVNULkpMUzgpIHsKKwkJCXRoaXMuZXh0cmFEaW1lbnNpb25UeXBlcyA9IG5ldyBBU1RO
b2RlLk5vZGVMaXN0KEVYVFJBX0RJTUVOU0lPTl9UWVBFU19QUk9QRVJUWSk7CiAJCX0KIAkJaWYg
KGFzdC5hcGlMZXZlbCgpIDwgQVNULkpMUzgpIHsKQEAgLTQ1OSw0ICs0NzYsNyBAQAogCQkJcmV0
dXJuIHRocm93bkV4Y2VwdGlvblR5cGVzKCk7CiAJCX0JCQorCQlpZiAocHJvcGVydHkgPT0gRVhU
UkFfRElNRU5TSU9OX1RZUEVTX1BST1BFUlRZKSB7CisJCQlyZXR1cm4gdGhpcy5leHRyYURpbWVu
c2lvblR5cGVzOworCQl9CiAJCS8vIGFsbG93IGRlZmF1bHQgaW1wbGVtZW50YXRpb24gdG8gZmxh
ZyB0aGUgZXJyb3IKIAkJcmV0dXJuIHN1cGVyLmludGVybmFsR2V0Q2hpbGRMaXN0UHJvcGVydHko
cHJvcGVydHkpOwpAQCAtNTEzLDQgKzUzMyw5IEBACiAJCXJlc3VsdC5zZXRDb25zdHJ1Y3Rvcihp
c0NvbnN0cnVjdG9yKCkpOwogCQlyZXN1bHQuc2V0RXh0cmFEaW1lbnNpb25zKGdldEV4dHJhRGlt
ZW5zaW9ucygpKTsKKwkJaWYgKHRoaXMuYXN0LmFwaUxldmVsID49IEFTVC5KTFM4KSB7CisJCQly
ZXN1bHQuZXh0cmFEaW1lbnNpb25UeXBlcyA9IG5ldyBBU1ROb2RlLk5vZGVMaXN0KEVYVFJBX0RJ
TUVOU0lPTl9UWVBFU19QUk9QRVJUWSk7CisJCQlyZXN1bHQuZXh0cmFEaW1lbnNpb25UeXBlcy5h
ZGRBbGwoCisJCQkJCUFTVE5vZGUuY29weVN1YnRyZWVzKHRhcmdldCwgdGhpcy5leHRyYURpbWVu
c2lvblR5cGVzKSk7CisJCX0KIAkJcmVzdWx0LnNldE5hbWUoKFNpbXBsZU5hbWUpIGdldE5hbWUo
KS5jbG9uZSh0YXJnZXQpKTsKIAkJcmVzdWx0LnBhcmFtZXRlcnMoKS5hZGRBbGwoCkBAIC05MDcs
NCArOTMyLDE1IEBACiAKIAkvKioKKwkgKiBSZXR1cm5zIHRoZSBsaXZlIG9yZGVyZWQgbGlzdCBv
ZiBleHRyYSBkaW1lbnNpb25zIHdpdGggYW5ub3RhdGlvbnMgaWYgYW55LgorCSAqIAorCSAqIEBy
ZXR1cm4gdGhlIGxpdmUgbGlzdCBvZiBleHRyYSBkaW1lbnNpb25zIHdpdGggYW5ub3RhdGlvbnMg
aWYgYW55IChlbGVtZW50IHR5cGU6IHtAbGluayBEaW1lbnNpb25UeXBlfVtdKQorCSAqIEBzaW5j
ZSAzLjkKKwkgKi8KKwlwdWJsaWMgTGlzdCBnZXRleHRyYURpbWVuc2lvblR5cGVzKCkgeworCQl1
bnN1cHBvcnRlZEluMl8zXzQoKTsKKwkJcmV0dXJuIHRoaXMuZXh0cmFEaW1lbnNpb25UeXBlczsK
Kwl9CisKKwkvKioKIAkgKiBSZXR1cm5zIHRoZSBib2R5IG9mIHRoaXMgbWV0aG9kIGRlY2xhcmF0
aW9uLCBvciA8Y29kZT5udWxsPC9jb2RlPiBpZgogCSAqIHRoaXMgbWV0aG9kIGhhcyA8Yj5ubzwv
Yj4gYm9keS4KZGlmZiAtLWdpdCBhL29yZy5lY2xpcHNlLmpkdC5jb3JlL2RvbS9vcmcvZWNsaXBz
ZS9qZHQvY29yZS9kb20vUHJpbWl0aXZlVHlwZS5qYXZhIGIvb3JnLmVjbGlwc2UuamR0LmNvcmUv
ZG9tL29yZy9lY2xpcHNlL2pkdC9jb3JlL2RvbS9QcmltaXRpdmVUeXBlLmphdmEKaW5kZXggNTAx
ZTg2OS4uMzMyMGU5ZSAxMDA2NDQKLS0tIGEvb3JnLmVjbGlwc2UuamR0LmNvcmUvZG9tL29yZy9l
Y2xpcHNlL2pkdC9jb3JlL2RvbS9QcmltaXRpdmVUeXBlLmphdmEKKysrIGIvb3JnLmVjbGlwc2Uu
amR0LmNvcmUvZG9tL29yZy9lY2xpcHNlL2pkdC9jb3JlL2RvbS9QcmltaXRpdmVUeXBlLmphdmEK
QEAgLTEsNCArMSw0IEBACiAvKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioq
KioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKgotICogQ29weXJpZ2h0IChj
KSAyMDAwLCAyMDEyIElCTSBDb3Jwb3JhdGlvbiBhbmQgb3RoZXJzLgorICogQ29weXJpZ2h0IChj
KSAyMDAwLCAyMDEzIElCTSBDb3Jwb3JhdGlvbiBhbmQgb3RoZXJzLgogICogQWxsIHJpZ2h0cyBy
ZXNlcnZlZC4gVGhpcyBwcm9ncmFtIGFuZCB0aGUgYWNjb21wYW55aW5nIG1hdGVyaWFscwogICog
YXJlIG1hZGUgYXZhaWxhYmxlIHVuZGVyIHRoZSB0ZXJtcyBvZiB0aGUgRWNsaXBzZSBQdWJsaWMg
TGljZW5zZSB2MS4wCkBAIC00NSw1ICs0NSw1IEBACiAgKiBAbm9pbnN0YW50aWF0ZSBUaGlzIGNs
YXNzIGlzIG5vdCBpbnRlbmRlZCB0byBiZSBpbnN0YW50aWF0ZWQgYnkgY2xpZW50cy4KICAqLwot
cHVibGljIGNsYXNzIFByaW1pdGl2ZVR5cGUgZXh0ZW5kcyBUeXBlIHsKK3B1YmxpYyBjbGFzcyBQ
cmltaXRpdmVUeXBlIGV4dGVuZHMgQW5ub3RhdGFibGVUeXBlIHsKIAogCS8qKgpAQCAtMjg2LDUg
KzI4Niw0IEBACiAJCXJlc3VsdC5zZXRQcmltaXRpdmVUeXBlQ29kZShnZXRQcmltaXRpdmVUeXBl
Q29kZSgpKTsKIAkJaWYgKHRoaXMuYXN0LmFwaUxldmVsID49IEFTVC5KTFM4KSB7Ci0JCQlyZXN1
bHQuYW5ub3RhdGlvbnMgPSBuZXcgQVNUTm9kZS5Ob2RlTGlzdChBTk5PVEFUSU9OU19QUk9QRVJU
WSk7CiAJCQlyZXN1bHQuYW5ub3RhdGlvbnMuYWRkQWxsKAogCQkJCQlBU1ROb2RlLmNvcHlTdWJ0
cmVlcyh0YXJnZXQsIGFubm90YXRpb25zKCkpKTsKZGlmZiAtLWdpdCBhL29yZy5lY2xpcHNlLmpk
dC5jb3JlL2RvbS9vcmcvZWNsaXBzZS9qZHQvY29yZS9kb20vUXVhbGlmaWVkVHlwZS5qYXZhIGIv
b3JnLmVjbGlwc2UuamR0LmNvcmUvZG9tL29yZy9lY2xpcHNlL2pkdC9jb3JlL2RvbS9RdWFsaWZp
ZWRUeXBlLmphdmEKaW5kZXggMjJlMDFlMC4uMmVlZDg5ZSAxMDA2NDQKLS0tIGEvb3JnLmVjbGlw
c2UuamR0LmNvcmUvZG9tL29yZy9lY2xpcHNlL2pkdC9jb3JlL2RvbS9RdWFsaWZpZWRUeXBlLmph
dmEKKysrIGIvb3JnLmVjbGlwc2UuamR0LmNvcmUvZG9tL29yZy9lY2xpcHNlL2pkdC9jb3JlL2Rv
bS9RdWFsaWZpZWRUeXBlLmphdmEKQEAgLTEsNCArMSw0IEBACiAvKioqKioqKioqKioqKioqKioq
KioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioq
KioqKgotICogQ29weXJpZ2h0IChjKSAyMDAzLCAyMDEyIElCTSBDb3Jwb3JhdGlvbiBhbmQgb3Ro
ZXJzLgorICogQ29weXJpZ2h0IChjKSAyMDAzLCAyMDEzIElCTSBDb3Jwb3JhdGlvbiBhbmQgb3Ro
ZXJzLgogICogQWxsIHJpZ2h0cyByZXNlcnZlZC4gVGhpcyBwcm9ncmFtIGFuZCB0aGUgYWNjb21w
YW55aW5nIG1hdGVyaWFscwogICogYXJlIG1hZGUgYXZhaWxhYmxlIHVuZGVyIHRoZSB0ZXJtcyBv
ZiB0aGUgRWNsaXBzZSBQdWJsaWMgTGljZW5zZSB2MS4wCkBAIC01Niw1ICs1Niw1IEBACiAgKiBA
bm9pbnN0YW50aWF0ZSBUaGlzIGNsYXNzIGlzIG5vdCBpbnRlbmRlZCB0byBiZSBpbnN0YW50aWF0
ZWQgYnkgY2xpZW50cy4KICAqLwotcHVibGljIGNsYXNzIFF1YWxpZmllZFR5cGUgZXh0ZW5kcyBU
eXBlIHsKK3B1YmxpYyBjbGFzcyBRdWFsaWZpZWRUeXBlIGV4dGVuZHMgQW5ub3RhdGFibGVUeXBl
IHsKICAgICAvKioKICAgICAgKiBUaGlzIGluZGV4IHJlcHJlc2VudHMgdGhlIHBvc2l0aW9uIGlu
c2lkZSBhIHBhcmFtZXRlcml6ZWQgcXVhbGlmaWVkIHR5cGUuCkBAIC0yMTcsNSArMjE3LDQgQEAK
IAkJcmVzdWx0LnNldE5hbWUoKFNpbXBsZU5hbWUpICgoQVNUTm9kZSkgZ2V0TmFtZSgpKS5jbG9u
ZSh0YXJnZXQpKTsKIAkJaWYgKHRoaXMuYXN0LmFwaUxldmVsID49IEFTVC5KTFM4KSB7Ci0JCQly
ZXN1bHQuYW5ub3RhdGlvbnMgPSBuZXcgQVNUTm9kZS5Ob2RlTGlzdChBTk5PVEFUSU9OU19QUk9Q
RVJUWSk7CiAJCQlyZXN1bHQuYW5ub3RhdGlvbnMuYWRkQWxsKAogCQkJCQlBU1ROb2RlLmNvcHlT
dWJ0cmVlcyh0YXJnZXQsIGFubm90YXRpb25zKCkpKTsKZGlmZiAtLWdpdCBhL29yZy5lY2xpcHNl
LmpkdC5jb3JlL2RvbS9vcmcvZWNsaXBzZS9qZHQvY29yZS9kb20vUmVjb3ZlcmVkVmFyaWFibGVC
aW5kaW5nLmphdmEgYi9vcmcuZWNsaXBzZS5qZHQuY29yZS9kb20vb3JnL2VjbGlwc2UvamR0L2Nv
cmUvZG9tL1JlY292ZXJlZFZhcmlhYmxlQmluZGluZy5qYXZhCmluZGV4IGJhNTEyZmMuLmIwODlh
NTIgMTAwNjQ0Ci0tLSBhL29yZy5lY2xpcHNlLmpkdC5jb3JlL2RvbS9vcmcvZWNsaXBzZS9qZHQv
Y29yZS9kb20vUmVjb3ZlcmVkVmFyaWFibGVCaW5kaW5nLmphdmEKKysrIGIvb3JnLmVjbGlwc2Uu
amR0LmNvcmUvZG9tL29yZy9lY2xpcHNlL2pkdC9jb3JlL2RvbS9SZWNvdmVyZWRWYXJpYWJsZUJp
bmRpbmcuamF2YQpAQCAtOTUsNSArOTUsNiBAQAogCQkJCS5hcHBlbmQodGhpcy52YXJpYWJsZURl
Y2xhcmF0aW9uLmdldENsYXNzKCkpCiAJCQkJLmFwcGVuZCh0aGlzLnZhcmlhYmxlRGVjbGFyYXRp
b24uZ2V0TmFtZSgpLmdldElkZW50aWZpZXIoKSkKLQkJCQkuYXBwZW5kKHRoaXMudmFyaWFibGVE
ZWNsYXJhdGlvbi5nZXRFeHRyYURpbWVuc2lvbnMoKSk7CisJCQkJLmFwcGVuZCgodGhpcy52YXJp
YWJsZURlY2xhcmF0aW9uLmFzdC5hcGlMZXZlbCA8IEFTVC5KTFM4KSA/IAorCQkJCQkJdGhpcy52
YXJpYWJsZURlY2xhcmF0aW9uLmdldEV4dHJhRGltZW5zaW9ucygpIDogdGhpcy52YXJpYWJsZURl
Y2xhcmF0aW9uLmdldEV4dHJhRGltZW5zaW9uVHlwZXMoKS5zaXplKCkpOwogCQl9CiAJCXJldHVy
biBTdHJpbmcudmFsdWVPZihidWZmZXIpOwpkaWZmIC0tZ2l0IGEvb3JnLmVjbGlwc2UuamR0LmNv
cmUvZG9tL29yZy9lY2xpcHNlL2pkdC9jb3JlL2RvbS9TaW1wbGVUeXBlLmphdmEgYi9vcmcuZWNs
aXBzZS5qZHQuY29yZS9kb20vb3JnL2VjbGlwc2UvamR0L2NvcmUvZG9tL1NpbXBsZVR5cGUuamF2
YQppbmRleCA4MTljOTA1Li5hZmYyYjlhIDEwMDY0NAotLS0gYS9vcmcuZWNsaXBzZS5qZHQuY29y
ZS9kb20vb3JnL2VjbGlwc2UvamR0L2NvcmUvZG9tL1NpbXBsZVR5cGUuamF2YQorKysgYi9vcmcu
ZWNsaXBzZS5qZHQuY29yZS9kb20vb3JnL2VjbGlwc2UvamR0L2NvcmUvZG9tL1NpbXBsZVR5cGUu
amF2YQpAQCAtMSw0ICsxLDQgQEAKIC8qKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioq
KioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqCi0gKiBDb3B5cmln
aHQgKGMpIDIwMDAsIDIwMTIgSUJNIENvcnBvcmF0aW9uIGFuZCBvdGhlcnMuCisgKiBDb3B5cmln
aHQgKGMpIDIwMDAsIDIwMTMgSUJNIENvcnBvcmF0aW9uIGFuZCBvdGhlcnMuCiAgKiBBbGwgcmln
aHRzIHJlc2VydmVkLiBUaGlzIHByb2dyYW0gYW5kIHRoZSBhY2NvbXBhbnlpbmcgbWF0ZXJpYWxz
CiAgKiBhcmUgbWFkZSBhdmFpbGFibGUgdW5kZXIgdGhlIHRlcm1zIG9mIHRoZSBFY2xpcHNlIFB1
YmxpYyBMaWNlbnNlIHYxLjAKQEAgLTMxLDUgKzMxLDUgQEAKICAqIEBub2luc3RhbnRpYXRlIFRo
aXMgY2xhc3MgaXMgbm90IGludGVuZGVkIHRvIGJlIGluc3RhbnRpYXRlZCBieSBjbGllbnRzLgog
ICovCi1wdWJsaWMgY2xhc3MgU2ltcGxlVHlwZSBleHRlbmRzIFR5cGUgeworcHVibGljIGNsYXNz
IFNpbXBsZVR5cGUgZXh0ZW5kcyBBbm5vdGF0YWJsZVR5cGUgewogCiAJLyoqCkBAIC0xNjYsNSAr
MTY2LDQgQEAKIAkJcmVzdWx0LnNldE5hbWUoKE5hbWUpIChnZXROYW1lKCkpLmNsb25lKHRhcmdl
dCkpOwogCQlpZiAodGhpcy5hc3QuYXBpTGV2ZWwgPj0gQVNULkpMUzgpIHsKLQkJCXJlc3VsdC5h
bm5vdGF0aW9ucyA9IG5ldyBBU1ROb2RlLk5vZGVMaXN0KEFOTk9UQVRJT05TX1BST1BFUlRZKTsK
IAkJCXJlc3VsdC5hbm5vdGF0aW9ucy5hZGRBbGwoCiAJCQkJCUFTVE5vZGUuY29weVN1YnRyZWVz
KHRhcmdldCwgYW5ub3RhdGlvbnMoKSkpOwpkaWZmIC0tZ2l0IGEvb3JnLmVjbGlwc2UuamR0LmNv
cmUvZG9tL29yZy9lY2xpcHNlL2pkdC9jb3JlL2RvbS9TaW5nbGVWYXJpYWJsZURlY2xhcmF0aW9u
LmphdmEgYi9vcmcuZWNsaXBzZS5qZHQuY29yZS9kb20vb3JnL2VjbGlwc2UvamR0L2NvcmUvZG9t
L1NpbmdsZVZhcmlhYmxlRGVjbGFyYXRpb24uamF2YQppbmRleCA1YzI4YjA4Li45OTAyZTE0IDEw
MDY0NAotLS0gYS9vcmcuZWNsaXBzZS5qZHQuY29yZS9kb20vb3JnL2VjbGlwc2UvamR0L2NvcmUv
ZG9tL1NpbmdsZVZhcmlhYmxlRGVjbGFyYXRpb24uamF2YQorKysgYi9vcmcuZWNsaXBzZS5qZHQu
Y29yZS9kb20vb3JnL2VjbGlwc2UvamR0L2NvcmUvZG9tL1NpbmdsZVZhcmlhYmxlRGVjbGFyYXRp
b24uamF2YQpAQCAtOTEsOSArOTEsMTcgQEAKIAogCS8qKgotCSAqIFRoZSAiZXh0cmFEaW1lbnNp
b25zIiBzdHJ1Y3R1cmFsIHByb3BlcnR5IG9mIHRoaXMgbm9kZSB0eXBlICh0eXBlOiB7QGxpbmsg
SW50ZWdlcn0pLgorCSAqIFRoZSAiZXh0cmFEaW1lbnNpb25zIiBzdHJ1Y3R1cmFsIHByb3BlcnR5
IG9mIHRoaXMgbm9kZSB0eXBlICh0eXBlOiB7QGxpbmsgSW50ZWdlcn0pLiBUaGlzIHByb3BlcnR5
IGlzIHN1cHBvcnRlZAorCSAqIG9ubHkgaW4gSkxTNCBvciBsb3dlciBsZXZlbC4gRm9yIEpMUzgg
YW5kIGFib3ZlLCB1c2UgPGNvZGU+RVhUUkFfRElNRU5TSU9OX1RZUEVTX1BST1BFUlRZPC9jb2Rl
Pi4KIAkgKiBAc2luY2UgMy4wCiAJICovCiAJcHVibGljIHN0YXRpYyBmaW5hbCBTaW1wbGVQcm9w
ZXJ0eURlc2NyaXB0b3IgRVhUUkFfRElNRU5TSU9OU19QUk9QRVJUWSA9CiAJCW5ldyBTaW1wbGVQ
cm9wZXJ0eURlc2NyaXB0b3IoU2luZ2xlVmFyaWFibGVEZWNsYXJhdGlvbi5jbGFzcywgImV4dHJh
RGltZW5zaW9ucyIsIGludC5jbGFzcywgTUFOREFUT1JZKTsgLy8kTk9OLU5MUy0xJAorCisJLyoq
CisJICogVGhlICJleHRyYUFubm90YXRlZERpbWVuc2lvbnMiIHN0cnVjdHVyYWwgcHJvcGVydHkg
b2YgdGhpcyBub2RlIHR5cGUgKGNoaWxkIHR5cGU6IHtAbGluayBEaW1lbnNpb25UeXBlfSkuCisJ
ICogQHNpbmNlIDMuOQorCSAqLworCXB1YmxpYyBzdGF0aWMgZmluYWwgQ2hpbGRMaXN0UHJvcGVy
dHlEZXNjcmlwdG9yIEVYVFJBX0RJTUVOU0lPTl9UWVBFU19QUk9QRVJUWSA9CisJCQluZXcgQ2hp
bGRMaXN0UHJvcGVydHlEZXNjcmlwdG9yKFNpbmdsZVZhcmlhYmxlRGVjbGFyYXRpb24uY2xhc3Ms
ICJleHRyYURpbWVuc2lvblR5cGVzIiwgRGltZW5zaW9uVHlwZS5jbGFzcywgTk9fQ1lDTEVfUklT
Syk7IC8vJE5PTi1OTFMtMSQKIAogCS8qKgpAQCAtMjI2LDQgKzIzNCwxMSBAQAogCiAJLyoqCisJ
ICogVGhlIGV4dHJhIGRpbWVuc2lvbiB0eXBlcyB0aGlzIG5vZGUgaGFzIHdpdGggYW5ub3RhdGlv
bnMgaWYgYW55LgorCSAqIAorCSAqIEBzaW5jZSAzLjkKKwkgKi8KKwlwcm90ZWN0ZWQgQVNUTm9k
ZS5Ob2RlTGlzdCBleHRyYURpbWVuc2lvblR5cGVzID0gbnVsbDsKKworCS8qKgogCSAqIFRoZSBp
bml0aWFsaXplciBleHByZXNzaW9uLCBvciA8Y29kZT5udWxsPC9jb2RlPiBpZiBub25lOwogCSAq
IGRlZmF1bHRzIHRvIG5vbmUuCkBAIC0yNTQsNCArMjY5LDUgQEAKIAkJCWlmIChhc3QuYXBpTGV2
ZWwgPj0gQVNULkpMUzgpIHsKIAkJCQl0aGlzLnZhcmFyZ3NBbm5vdGF0aW9ucyA9IG5ldyBBU1RO
b2RlLk5vZGVMaXN0KFZBUkFSR1NfQU5OT1RBVElPTlNfUFJPUEVSVFkpOworCQkJCXRoaXMuZXh0
cmFEaW1lbnNpb25UeXBlcyA9IG5ldyBBU1ROb2RlLk5vZGVMaXN0KEVYVFJBX0RJTUVOU0lPTl9U
WVBFU19QUk9QRVJUWSk7CiAJCQl9CiAJCX0KQEAgLTM5NSw1ICs0MTEsMTEgQEAKIAkJfQogCQly
ZXN1bHQuc2V0VHlwZSgoVHlwZSkgZ2V0VHlwZSgpLmNsb25lKHRhcmdldCkpOwotCQlyZXN1bHQu
c2V0RXh0cmFEaW1lbnNpb25zKGdldEV4dHJhRGltZW5zaW9ucygpKTsKKwkJaWYgKHRoaXMuYXN0
LmFwaUxldmVsID49IEFTVC5KTFM4KSB7CisJCQlyZXN1bHQuZXh0cmFEaW1lbnNpb25UeXBlcyA9
IG5ldyBBU1ROb2RlLk5vZGVMaXN0KEVYVFJBX0RJTUVOU0lPTl9UWVBFU19QUk9QRVJUWSk7CisJ
CQlyZXN1bHQuZXh0cmFEaW1lbnNpb25UeXBlcy5hZGRBbGwoCisJCQkJCUFTVE5vZGUuY29weVN1
YnRyZWVzKHRhcmdldCwgdGhpcy5leHRyYURpbWVuc2lvblR5cGVzKSk7CisJCX0gZWxzZSB7CisJ
CQlyZXN1bHQuc2V0RXh0cmFEaW1lbnNpb25zKGdldEV4dHJhRGltZW5zaW9ucygpKTsKKwkJfQog
CQlyZXN1bHQuc2V0TmFtZSgoU2ltcGxlTmFtZSkgZ2V0TmFtZSgpLmNsb25lKHRhcmdldCkpOwog
CQlyZXN1bHQuc2V0SW5pdGlhbGl6ZXIoCkBAIC02MzksNCArNjYxLDUgQEAKIAkgKi8KIAlwdWJs
aWMgaW50IGdldEV4dHJhRGltZW5zaW9ucygpIHsKKwkJc3VwcG9ydGVkT25seUluMl8zXzQoKTsK
IAkJcmV0dXJuIHRoaXMuZXh0cmFBcnJheURpbWVuc2lvbnM7CiAJfQpAQCAtNjQ3LDQgKzY3MCw1
IEBACiAJICovCiAJcHVibGljIHZvaWQgc2V0RXh0cmFEaW1lbnNpb25zKGludCBkaW1lbnNpb25z
KSB7CisJCXN1cHBvcnRlZE9ubHlJbjJfM180KCk7CiAJCWlmIChkaW1lbnNpb25zIDwgMCkgewog
CQkJdGhyb3cgbmV3IElsbGVnYWxBcmd1bWVudEV4Y2VwdGlvbigpOwpAQCAtNjU1LDQgKzY3OSwx
NSBAQAogCX0KIAorCS8qKgorCSAqIFJldHVybnMgdGhlIGxpdmUgb3JkZXJlZCBsaXN0IG9mIGV4
dHJhIGRpbWVuc2lvbnMgd2l0aCBhbm5vdGF0aW9ucyBpZiBhbnkuCisJICogCisJICogQHJldHVy
biB0aGUgbGl2ZSBsaXN0IG9mIGV4dHJhIGRpbWVuc2lvbnMgd2l0aCBhbm5vdGF0aW9ucyBpZiBh
bnkgKGVsZW1lbnQgdHlwZToge0BsaW5rIERpbWVuc2lvblR5cGV9W10pCisJICogQHNpbmNlIDMu
OQorCSAqLworCXB1YmxpYyBMaXN0IGdldEV4dHJhRGltZW5zaW9uVHlwZXMoKSB7CisJCXVuc3Vw
cG9ydGVkSW4yXzNfNCgpOworCQlyZXR1cm4gdGhpcy5leHRyYURpbWVuc2lvblR5cGVzOworCX0K
KwkKIAkvKiAob21pdCBqYXZhZG9jIGZvciB0aGlzIG1ldGhvZCkKIAkgKiBNZXRob2QgZGVjbGFy
ZWQgb24gVmFyaWFibGVEZWNsYXJhdGlvbi4KZGlmZiAtLWdpdCBhL29yZy5lY2xpcHNlLmpkdC5j
b3JlL2RvbS9vcmcvZWNsaXBzZS9qZHQvY29yZS9kb20vVHlwZS5qYXZhIGIvb3JnLmVjbGlwc2Uu
amR0LmNvcmUvZG9tL29yZy9lY2xpcHNlL2pkdC9jb3JlL2RvbS9UeXBlLmphdmEKaW5kZXggYWYx
OGFmOC4uZTk4NjBlZSAxMDA2NDQKLS0tIGEvb3JnLmVjbGlwc2UuamR0LmNvcmUvZG9tL29yZy9l
Y2xpcHNlL2pkdC9jb3JlL2RvbS9UeXBlLmphdmEKKysrIGIvb3JnLmVjbGlwc2UuamR0LmNvcmUv
ZG9tL29yZy9lY2xpcHNlL2pkdC9jb3JlL2RvbS9UeXBlLmphdmEKQEAgLTEsNCArMSw0IEBACiAv
KioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioq
KioqKioqKioqKioqKioqKioqKioqKgotICogQ29weXJpZ2h0IChjKSAyMDAwLCAyMDEyIElCTSBD
b3Jwb3JhdGlvbiBhbmQgb3RoZXJzLgorICogQ29weXJpZ2h0IChjKSAyMDAwLCAyMDEzIElCTSBD
b3Jwb3JhdGlvbiBhbmQgb3RoZXJzLgogICogQWxsIHJpZ2h0cyByZXNlcnZlZC4gVGhpcyBwcm9n
cmFtIGFuZCB0aGUgYWNjb21wYW55aW5nIG1hdGVyaWFscwogICogYXJlIG1hZGUgYXZhaWxhYmxl
IHVuZGVyIHRoZSB0ZXJtcyBvZiB0aGUgRWNsaXBzZSBQdWJsaWMgTGljZW5zZSB2MS4wCkBAIC0x
Niw1ICsxNiw0IEBACiBwYWNrYWdlIG9yZy5lY2xpcHNlLmpkdC5jb3JlLmRvbTsKIAotaW1wb3J0
IGphdmEudXRpbC5MaXN0OwogCiAvKioKQEAgLTMxLDI0ICszMCwyNSBAQAogICogPHByZT4KICAq
IFR5cGU6Ci0gKiAgICBQcmltaXRpdmVUeXBlCi0gKiAgICBBcnJheVR5cGUKLSAqICAgIFNpbXBs
ZVR5cGUKLSAqICAgIFF1YWxpZmllZFR5cGUKKyAqICAgIEFubm90YXRhYmxlVHlwZToKKyAqICAg
ICAgIFByaW1pdGl2ZVR5cGUKKyAqICAgICAgIEFycmF5VHlwZQorICogICAgICAgU2ltcGxlVHlw
ZQorICogICAgICAgUXVhbGlmaWVkVHlwZQorICogICAgICAgV2lsZGNhcmRUeXBlCiAgKiAgICBQ
YXJhbWV0ZXJpemVkVHlwZQotICogICAgV2lsZGNhcmRUeXBlCiAgKiAgICBVbmlvblR5cGUgIAog
ICogICAgCiAgKiBQcmltaXRpdmVUeXBlOgotICogICAgPGI+e0Fubm90YXRpb259IGJ5dGU8L2I+
Ci0gKiAgICA8Yj57QW5ub3RhdGlvbn0gc2hvcnQ8L2I+Ci0gKiAgICA8Yj57QW5ub3RhdGlvbn0g
Y2hhcjwvYj4KLSAqICAgIDxiPntBbm5vdGF0aW9ufSBpbnQ8L2I+Ci0gKiAgICA8Yj57QW5ub3Rh
dGlvbn0gbG9uZzwvYj4KLSAqICAgIDxiPntBbm5vdGF0aW9ufSBmbG9hdDwvYj4KLSAqICAgIDxi
PntBbm5vdGF0aW9ufSBkb3VibGU8L2I+Ci0gKiAgICA8Yj57QW5ub3RhdGlvbn0gYm9vbGVhbjwv
Yj4KLSAqICAgIDxiPntBbm5vdGF0aW9ufSB2b2lkPC9iPgorICogICAge0Fubm90YXRpb259IDxi
PmJ5dGU8L2I+CisgKiAgICB7QW5ub3RhdGlvbn0gPGI+c2hvcnQ8L2I+CisgKiAgICB7QW5ub3Rh
dGlvbn0gPGI+Y2hhcjwvYj4KKyAqICAgIHtBbm5vdGF0aW9ufSA8Yj5pbnQ8L2I+CisgKiAgICB7
QW5ub3RhdGlvbn0gPGI+bG9uZzwvYj4KKyAqICAgIHtBbm5vdGF0aW9ufSA8Yj5mbG9hdDwvYj4K
KyAqICAgIHtBbm5vdGF0aW9ufSA8Yj5kb3VibGU8L2I+CisgKiAgICB7QW5ub3RhdGlvbn0gPGI+
Ym9vbGVhbjwvYj4KKyAqICAgIHtBbm5vdGF0aW9ufSA8Yj52b2lkPC9iPgogICogQXJyYXlUeXBl
OgotICogICAgVHlwZSA8Yj57QW5ub3RhdGlvbn0gWzwvYj4gPGI+XTwvYj4KKyAqICAgIFR5cGUg
e0Fubm90YXRpb259IDxiPidbJzwvYj4gPGI+J10nPC9iPgogICogU2ltcGxlVHlwZToKICAqICAg
IHtBbm5vdGF0aW9ufSBUeXBlTmFtZQpAQCAtNjUsMTAgKzY1LDQgQEAKICAqLwogcHVibGljIGFi
c3RyYWN0IGNsYXNzIFR5cGUgZXh0ZW5kcyBBU1ROb2RlIHsKLQotCS8qKgotCSAqIFRoZSB0eXBl
IGFubm90YXRpb25zIChlbGVtZW50IHR5cGU6IHtAbGluayBBbm5vdGF0aW9ufSkuCi0JICogQHNp
bmNlIDMuOQotCSAqLwotCXByb3RlY3RlZCBBU1ROb2RlLk5vZGVMaXN0IGFubm90YXRpb25zID0g
bnVsbDsKIAkKIAkvKioKQEAgLTE4NCw0ICsxNzgsMTcgQEAKIAkJcmV0dXJuICh0aGlzIGluc3Rh
bmNlb2YgV2lsZGNhcmRUeXBlKTsKIAl9CisJCisJLyoqCisJICogUmV0dXJucyB3aGV0aGVyIHRo
aXMgdHlwZSBjYW4gYmUgYW5ub3RhdGVkLiBBbGwgc3ViLWNsYXNzZXMgb2YKKwkgKiB7QGxpbmsg
QW5ub3RhdGFibGVUeXBlfSBjYW4gYmUgYW5ub3RhdGVkLgorCSAqCisJICogQHJldHVybiA8Y29k
ZT50cnVlPC9jb2RlPiBpZiB0aGlzIHR5cGUgaXMgYW4gaW5zdGFuY2Ugb2Yge0BsaW5rIEFubm90
YXRhYmxlVHlwZX0sIGFuZAorCSAqIDxjb2RlPmZhbHNlPC9jb2RlPiBvdGhlcndpc2UKKwkgKiAJ
CQkKKwkgKiBAc2luY2UgMy45CisJICovCisJcHVibGljIGJvb2xlYW4gaXNBbm5vdGF0YWJsZSgp
IHsKKwkJcmV0dXJuICh0aGlzIGluc3RhbmNlb2YgQW5ub3RhdGFibGVUeXBlKTsKKwl9CiAKIAkv
KioKQEAgLTE5NywxOSArMjA0LDQgQEAKIAlwdWJsaWMgZmluYWwgSVR5cGVCaW5kaW5nIHJlc29s
dmVCaW5kaW5nKCkgewogCQlyZXR1cm4gdGhpcy5hc3QuZ2V0QmluZGluZ1Jlc29sdmVyKCkucmVz
b2x2ZVR5cGUodGhpcyk7Ci0JfQotCQotCS8qKgotCSAqIFJldHVybnMgdGhlIGxpdmUgb3JkZXJl
ZCBsaXN0IG9mIGFubm90YXRpb25zIGZvciB0aGlzIFR5cGUgbm9kZS4KLQkgKgotCSAqIEByZXR1
cm4gdGhlIGxpdmUgbGlzdCBvZiBhbm5vdGF0aW9ucyAoZWxlbWVudCB0eXBlOiB7QGxpbmsgQW5u
b3RhdGlvbn0pCi0JICogQGV4Y2VwdGlvbiBVbnN1cHBvcnRlZE9wZXJhdGlvbkV4Y2VwdGlvbiBp
ZiB0aGlzIG9wZXJhdGlvbiBpcyB1c2VkCi0JICogICAgICAgICAgICBpbiBhIEpMUzIsIEpMUzMg
b3IgSkxTNCBBU1QKLQkgKiBAc2luY2UgMy45Ci0JICovCi0JcHVibGljIExpc3QgYW5ub3RhdGlv
bnMoKSB7Ci0JCWlmICh0aGlzLmFubm90YXRpb25zID09IG51bGwpIHsKLQkJCXVuc3VwcG9ydGVk
SW4yXzNfNCgpOyAKLQkJfQotCQlyZXR1cm4gdGhpcy5hbm5vdGF0aW9uczsKIAl9CiB9CmRpZmYg
LS1naXQgYS9vcmcuZWNsaXBzZS5qZHQuY29yZS9kb20vb3JnL2VjbGlwc2UvamR0L2NvcmUvZG9t
L1ZhcmlhYmxlRGVjbGFyYXRpb24uamF2YSBiL29yZy5lY2xpcHNlLmpkdC5jb3JlL2RvbS9vcmcv
ZWNsaXBzZS9qZHQvY29yZS9kb20vVmFyaWFibGVEZWNsYXJhdGlvbi5qYXZhCmluZGV4IGZjMzg4
ZTguLjg5Y2YyODEgMTAwNjQ0Ci0tLSBhL29yZy5lY2xpcHNlLmpkdC5jb3JlL2RvbS9vcmcvZWNs
aXBzZS9qZHQvY29yZS9kb20vVmFyaWFibGVEZWNsYXJhdGlvbi5qYXZhCisrKyBiL29yZy5lY2xp
cHNlLmpkdC5jb3JlL2RvbS9vcmcvZWNsaXBzZS9qZHQvY29yZS9kb20vVmFyaWFibGVEZWNsYXJh
dGlvbi5qYXZhCkBAIC0xMiw0ICsxMiw2IEBACiBwYWNrYWdlIG9yZy5lY2xpcHNlLmpkdC5jb3Jl
LmRvbTsKIAoraW1wb3J0IGphdmEudXRpbC5MaXN0OworCiAvKioKICAqIEFic3RyYWN0IGJhc2Ug
Y2xhc3Mgb2YgYWxsIEFTVCBub2RlIHR5cGVzIHRoYXQgZGVjbGFyZSBhIHNpbmdsZSBsb2NhbApA
QCAtMTU3LDQgKzE1OSwxNCBAQAogCXB1YmxpYyBhYnN0cmFjdCB2b2lkIHNldEV4dHJhRGltZW5z
aW9ucyhpbnQgZGltZW5zaW9ucyk7CiAKKwkKKwkvKioKKwkgKiBSZXR1cm5zIHRoZSBleHRyYSBh
bm5vdGF0YWJsZSBkaW1lbnNpb24gdHlwZXMgb2YgdGhlIHNwZWNpZmllZCB0eXBlLiAoSkxTOCBv
bmx5KQorCSAqIAorCSAqIEByZXR1cm4gdGhlIGxpc3Qgb2YgZXh0cmEgZGltZW5zaW9uIHR5cGVz
CisJICogQGV4Y2VwdGlvbiBJbGxlZ2FsQXJndW1lbnRFeGNlcHRpb24gaWYgc3BlY2lmaWVkIGFw
aSBsZXZlbCBpcyBsb3dlciB0aGFuIEpMUzguCisJICogQHNpbmNlIDMuOQorCSAqLworCXB1Ymxp
YyBhYnN0cmFjdCBMaXN0IGdldEV4dHJhRGltZW5zaW9uVHlwZXMoKTsKKwkKIAkvKioKIAkgKiBS
ZXR1cm5zIHRoZSBpbml0aWFsaXplciBvZiB0aGlzIHZhcmlhYmxlIGRlY2xhcmF0aW9uLCBvcgpk
aWZmIC0tZ2l0IGEvb3JnLmVjbGlwc2UuamR0LmNvcmUvZG9tL29yZy9lY2xpcHNlL2pkdC9jb3Jl
L2RvbS9WYXJpYWJsZURlY2xhcmF0aW9uRnJhZ21lbnQuamF2YSBiL29yZy5lY2xpcHNlLmpkdC5j
b3JlL2RvbS9vcmcvZWNsaXBzZS9qZHQvY29yZS9kb20vVmFyaWFibGVEZWNsYXJhdGlvbkZyYWdt
ZW50LmphdmEKaW5kZXggZTlkZTdjOC4uYTU5ZmU1OSAxMDA2NDQKLS0tIGEvb3JnLmVjbGlwc2Uu
amR0LmNvcmUvZG9tL29yZy9lY2xpcHNlL2pkdC9jb3JlL2RvbS9WYXJpYWJsZURlY2xhcmF0aW9u
RnJhZ21lbnQuamF2YQorKysgYi9vcmcuZWNsaXBzZS5qZHQuY29yZS9kb20vb3JnL2VjbGlwc2Uv
amR0L2NvcmUvZG9tL1ZhcmlhYmxlRGVjbGFyYXRpb25GcmFnbWVudC5qYXZhCkBAIC00Nyw0ICs0
NywxMSBAQAogCiAJLyoqCisJICogVGhlICJleHRyYUFubm90YXRlZERpbWVuc2lvbnMiIHN0cnVj
dHVyYWwgcHJvcGVydHkgb2YgdGhpcyBub2RlIHR5cGUgKGNoaWxkIHR5cGU6IHtAbGluayBEaW1l
bnNpb25UeXBlfSkuCisJICogQHNpbmNlIDMuOQorCSAqLworCXB1YmxpYyBzdGF0aWMgZmluYWwg
Q2hpbGRMaXN0UHJvcGVydHlEZXNjcmlwdG9yIEVYVFJBX0RJTUVOU0lPTl9UWVBFU19QUk9QRVJU
WSA9CisJCQluZXcgQ2hpbGRMaXN0UHJvcGVydHlEZXNjcmlwdG9yKFZhcmlhYmxlRGVjbGFyYXRp
b25GcmFnbWVudC5jbGFzcywgImV4dHJhRGltZW5zaW9uVHlwZXMiLCBEaW1lbnNpb25UeXBlLmNs
YXNzLCBOT19DWUNMRV9SSVNLKTsgLy8kTk9OLU5MUy0xJAorCisJLyoqCiAJICogVGhlICJpbml0
aWFsaXplciIgc3RydWN0dXJhbCBwcm9wZXJ0eSBvZiB0aGlzIG5vZGUgdHlwZSAoY2hpbGQgdHlw
ZToge0BsaW5rIEV4cHJlc3Npb259KS4KIAkgKiBAc2luY2UgMy4wCkBAIC02MCwxMiArNjcsMzAg
QEAKIAkgKi8KIAlwcml2YXRlIHN0YXRpYyBmaW5hbCBMaXN0IFBST1BFUlRZX0RFU0NSSVBUT1JT
OworCQorCS8qKgorCSAqIEEgbGlzdCBvZiBwcm9wZXJ0eSBkZXNjcmlwdG9ycyAoZWxlbWVudCB0
eXBlOgorCSAqIHtAbGluayBTdHJ1Y3R1cmFsUHJvcGVydHlEZXNjcmlwdG9yfSksCisJICogb3Ig
bnVsbCBpZiB1bmluaXRpYWxpemVkLgorCSAqIEBzaW5jZSAzLjkKKwkgKi8KKwlwcml2YXRlIHN0
YXRpYyBmaW5hbCBMaXN0IFBST1BFUlRZX0RFU0NSSVBUT1JTXzhfMDsKIAogCXN0YXRpYyB7CiAJ
CUxpc3QgcHJvcGVydHlMaXN0ID0gbmV3IEFycmF5TGlzdCg0KTsKIAkJY3JlYXRlUHJvcGVydHlM
aXN0KFZhcmlhYmxlRGVjbGFyYXRpb25GcmFnbWVudC5jbGFzcywgcHJvcGVydHlMaXN0KTsKLQkJ
YWRkUHJvcGVydHkoTkFNRV9QUk9QRVJUWSwgcHJvcGVydHlMaXN0KTsKKwkJYWRkSkxTM1Byb3Bl
cnRpZXMocHJvcGVydHlMaXN0KTsKIAkJYWRkUHJvcGVydHkoRVhUUkFfRElNRU5TSU9OU19QUk9Q
RVJUWSwgcHJvcGVydHlMaXN0KTsKLQkJYWRkUHJvcGVydHkoSU5JVElBTElaRVJfUFJPUEVSVFks
IHByb3BlcnR5TGlzdCk7CiAJCVBST1BFUlRZX0RFU0NSSVBUT1JTID0gcmVhcFByb3BlcnR5TGlz
dChwcm9wZXJ0eUxpc3QpOworCQkKKwkJcHJvcGVydHlMaXN0ID0gbmV3IEFycmF5TGlzdCg0KTsK
KwkJY3JlYXRlUHJvcGVydHlMaXN0KFZhcmlhYmxlRGVjbGFyYXRpb25GcmFnbWVudC5jbGFzcywg
cHJvcGVydHlMaXN0KTsKKwkJYWRkSkxTM1Byb3BlcnRpZXMocHJvcGVydHlMaXN0KTsKKwkJYWRk
UHJvcGVydHkoRVhUUkFfRElNRU5TSU9OX1RZUEVTX1BST1BFUlRZLCBwcm9wZXJ0eUxpc3QpOwor
CQlQUk9QRVJUWV9ERVNDUklQVE9SU184XzAgPSByZWFwUHJvcGVydHlMaXN0KHByb3BlcnR5TGlz
dCk7CisJfQorCisJcHJpdmF0ZSBzdGF0aWMgdm9pZCBhZGRKTFMzUHJvcGVydGllcyhMaXN0IHBy
b3BlcnR5TGlzdCkgeworCQlhZGRQcm9wZXJ0eShOQU1FX1BST1BFUlRZLCBwcm9wZXJ0eUxpc3Qp
OworCQlhZGRQcm9wZXJ0eShJTklUSUFMSVpFUl9QUk9QRVJUWSwgcHJvcGVydHlMaXN0KTsKIAl9
CiAKQEAgLTgxLDUgKzEwNiw5IEBACiAJICovCiAJcHVibGljIHN0YXRpYyBMaXN0IHByb3BlcnR5
RGVzY3JpcHRvcnMoaW50IGFwaUxldmVsKSB7Ci0JCXJldHVybiBQUk9QRVJUWV9ERVNDUklQVE9S
UzsKKwkJaWYgKGFwaUxldmVsID49IEFTVC5KTFM4KSB7CisJCQlyZXR1cm4gUFJPUEVSVFlfREVT
Q1JJUFRPUlNfOF8wOworCQl9IGVsc2UgeworCQkJcmV0dXJuIFBST1BFUlRZX0RFU0NSSVBUT1JT
OworCQl9CiAJfQogCkBAIC05NSw0ICsxMjQsMTEgQEAKIAkgKi8KIAlwcml2YXRlIGludCBleHRy
YUFycmF5RGltZW5zaW9ucyA9IDA7CisJCisJLyoqCisJICogVGhlIGV4dHJhIGRpbWVuc2lvbiB0
eXBlcyB0aGlzIG5vZGUgaGFzIHdpdGggYW5ub3RhdGlvbnMgaWYgYW55LgorCSAqIAorCSAqIEBz
aW5jZSAzLjkKKwkgKi8KKwlwcm90ZWN0ZWQgQVNUTm9kZS5Ob2RlTGlzdCBleHRyYURpbWVuc2lv
blR5cGVzID0gbnVsbDsKIAogCS8qKgpAQCAtMTE0LDQgKzE1MCw3IEBACiAJVmFyaWFibGVEZWNs
YXJhdGlvbkZyYWdtZW50KEFTVCBhc3QpIHsKIAkJc3VwZXIoYXN0KTsKKwkJaWYgKGFzdC5hcGlM
ZXZlbCA+PSBBU1QuSkxTOCkgeworCQkJdGhpcy5leHRyYURpbWVuc2lvblR5cGVzID0gbmV3IEFT
VE5vZGUuTm9kZUxpc3QoRVhUUkFfRElNRU5TSU9OX1RZUEVTX1BST1BFUlRZKTsKKwkJfQogCX0K
IApAQCAtMTkwLDQgKzIyOSwxNSBAQAogCSAqIE1ldGhvZCBkZWNsYXJlZCBvbiBBU1ROb2RlLgog
CSAqLworCWZpbmFsIExpc3QgaW50ZXJuYWxHZXRDaGlsZExpc3RQcm9wZXJ0eShDaGlsZExpc3RQ
cm9wZXJ0eURlc2NyaXB0b3IgcHJvcGVydHkpIHsKKwkJaWYgKHByb3BlcnR5ID09IEVYVFJBX0RJ
TUVOU0lPTl9UWVBFU19QUk9QRVJUWSkgeworCQkJcmV0dXJuIHRoaXMuZXh0cmFEaW1lbnNpb25U
eXBlczsKKwkJfQorCQkvLyBhbGxvdyBkZWZhdWx0IGltcGxlbWVudGF0aW9uIHRvIGZsYWcgdGhl
IGVycm9yCisJCXJldHVybiBzdXBlci5pbnRlcm5hbEdldENoaWxkTGlzdFByb3BlcnR5KHByb3Bl
cnR5KTsKKwl9CisKKwkvKiAob21pdCBqYXZhZG9jIGZvciB0aGlzIG1ldGhvZCkKKwkgKiBNZXRo
b2QgZGVjbGFyZWQgb24gQVNUTm9kZS4KKwkgKi8KIAlmaW5hbCBpbnQgZ2V0Tm9kZVR5cGUwKCkg
ewogCQlyZXR1cm4gVkFSSUFCTEVfREVDTEFSQVRJT05fRlJBR01FTlQ7CkBAIC0yMDEsNSArMjUx
LDExIEBACiAJCXJlc3VsdC5zZXRTb3VyY2VSYW5nZShnZXRTdGFydFBvc2l0aW9uKCksIGdldExl
bmd0aCgpKTsKIAkJcmVzdWx0LnNldE5hbWUoKFNpbXBsZU5hbWUpIGdldE5hbWUoKS5jbG9uZSh0
YXJnZXQpKTsKLQkJcmVzdWx0LnNldEV4dHJhRGltZW5zaW9ucyhnZXRFeHRyYURpbWVuc2lvbnMo
KSk7CisJCWlmICh0aGlzLmFzdC5hcGlMZXZlbCA+PSBBU1QuSkxTOCkgeworCQkJcmVzdWx0LmV4
dHJhRGltZW5zaW9uVHlwZXMgPSBuZXcgQVNUTm9kZS5Ob2RlTGlzdChFWFRSQV9ESU1FTlNJT05f
VFlQRVNfUFJPUEVSVFkpOworCQkJcmVzdWx0LmV4dHJhRGltZW5zaW9uVHlwZXMuYWRkQWxsKAor
CQkJCQlBU1ROb2RlLmNvcHlTdWJ0cmVlcyh0YXJnZXQsIHRoaXMuZXh0cmFEaW1lbnNpb25UeXBl
cykpOworCQl9IGVsc2UgeworCQkJcmVzdWx0LnNldEV4dHJhRGltZW5zaW9ucyhnZXRFeHRyYURp
bWVuc2lvbnMoKSk7CisJCX0KIAkJcmVzdWx0LnNldEluaXRpYWxpemVyKAogCQkJKEV4cHJlc3Np
b24pIEFTVE5vZGUuY29weVN1YnRyZWUodGFyZ2V0LCBnZXRJbml0aWFsaXplcigpKSk7CkBAIC0y
MjQsNCArMjgwLDggQEAKIAkJCWFjY2VwdENoaWxkKHZpc2l0b3IsIGdldE5hbWUoKSk7CiAJCQlh
Y2NlcHRDaGlsZCh2aXNpdG9yLCBnZXRJbml0aWFsaXplcigpKTsKKwkJCQorCQkJaWYgKHRoaXMu
YXN0LmFwaUxldmVsID49IEFTVC5KTFM4KSB7CisJCQkJYWNjZXB0Q2hpbGRyZW4odmlzaXRvciwg
dGhpcy5leHRyYURpbWVuc2lvblR5cGVzKTsKKwkJCX0KIAkJfQogCQl2aXNpdG9yLmVuZFZpc2l0
KHRoaXMpOwpAQCAtMjczLDQgKzMzMyw1IEBACiAJICovCiAJcHVibGljIGludCBnZXRFeHRyYURp
bWVuc2lvbnMoKSB7CisJCXN1cHBvcnRlZE9ubHlJbjJfM180KCk7CiAJCXJldHVybiB0aGlzLmV4
dHJhQXJyYXlEaW1lbnNpb25zOwogCX0KQEAgLTI5MCw0ICszNTEsNSBAQAogCSAqLwogCXB1Ymxp
YyB2b2lkIHNldEV4dHJhRGltZW5zaW9ucyhpbnQgZGltZW5zaW9ucykgeworCQlzdXBwb3J0ZWRP
bmx5SW4yXzNfNCgpOwogCQlpZiAoZGltZW5zaW9ucyA8IDApIHsKIAkJCXRocm93IG5ldyBJbGxl
Z2FsQXJndW1lbnRFeGNlcHRpb24oKTsKQEAgLTI5Nyw1ICszNTksMTYgQEAKIAkJcG9zdFZhbHVl
Q2hhbmdlKEVYVFJBX0RJTUVOU0lPTlNfUFJPUEVSVFkpOwogCX0KLQorCQorCS8qKgorCSAqIFJl
dHVybnMgdGhlIGxpdmUgb3JkZXJlZCBsaXN0IG9mIGV4dHJhIGRpbWVuc2lvbnMgd2l0aCBhbm5v
dGF0aW9ucyBpZiBhbnkuCisJICogCisJICogQHJldHVybiB0aGUgbGl2ZSBsaXN0IG9mIGV4dHJh
IGRpbWVuc2lvbnMgd2l0aCBhbm5vdGF0aW9ucyBpZiBhbnkgKGVsZW1lbnQgdHlwZToge0BsaW5r
IERpbWVuc2lvblR5cGV9W10pCisJICogQHNpbmNlIDMuOQorCSAqLworCXB1YmxpYyBMaXN0IGdl
dEV4dHJhRGltZW5zaW9uVHlwZXMoKSB7CisJCXVuc3VwcG9ydGVkSW4yXzNfNCgpOworCQlyZXR1
cm4gdGhpcy5leHRyYURpbWVuc2lvblR5cGVzOworCX0KKwkKIAkvKiAob21pdCBqYXZhZG9jIGZv
ciB0aGlzIG1ldGhvZCkKIAkgKiBNZXRob2QgZGVjbGFyZWQgb24gVmFyaWFibGVEZWNsYXJhdGlv
bi4KZGlmZiAtLWdpdCBhL29yZy5lY2xpcHNlLmpkdC5jb3JlL2RvbS9vcmcvZWNsaXBzZS9qZHQv
Y29yZS9kb20vV2lsZGNhcmRUeXBlLmphdmEgYi9vcmcuZWNsaXBzZS5qZHQuY29yZS9kb20vb3Jn
L2VjbGlwc2UvamR0L2NvcmUvZG9tL1dpbGRjYXJkVHlwZS5qYXZhCmluZGV4IDhhNGQ5MmIuLjlm
MjIyMjMgMTAwNjQ0Ci0tLSBhL29yZy5lY2xpcHNlLmpkdC5jb3JlL2RvbS9vcmcvZWNsaXBzZS9q
ZHQvY29yZS9kb20vV2lsZGNhcmRUeXBlLmphdmEKKysrIGIvb3JnLmVjbGlwc2UuamR0LmNvcmUv
ZG9tL29yZy9lY2xpcHNlL2pkdC9jb3JlL2RvbS9XaWxkY2FyZFR5cGUuamF2YQpAQCAtMSw0ICsx
LDQgQEAKIC8qKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioq
KioqKioqKioqKioqKioqKioqKioqKioqKioqKioqCi0gKiBDb3B5cmlnaHQgKGMpIDIwMDMsIDIw
MTIgSUJNIENvcnBvcmF0aW9uIGFuZCBvdGhlcnMuCisgKiBDb3B5cmlnaHQgKGMpIDIwMDMsIDIw
MTMgSUJNIENvcnBvcmF0aW9uIGFuZCBvdGhlcnMuCiAgKiBBbGwgcmlnaHRzIHJlc2VydmVkLiBU
aGlzIHByb2dyYW0gYW5kIHRoZSBhY2NvbXBhbnlpbmcgbWF0ZXJpYWxzCiAgKiBhcmUgbWFkZSBh
dmFpbGFibGUgdW5kZXIgdGhlIHRlcm1zIG9mIHRoZSBFY2xpcHNlIFB1YmxpYyBMaWNlbnNlIHYx
LjAKQEAgLTQwLDUgKzQwLDUgQEAKICAqIEBub2luc3RhbnRpYXRlIFRoaXMgY2xhc3MgaXMgbm90
IGludGVuZGVkIHRvIGJlIGluc3RhbnRpYXRlZCBieSBjbGllbnRzLgogICovCi1wdWJsaWMgY2xh
c3MgV2lsZGNhcmRUeXBlIGV4dGVuZHMgVHlwZSB7CitwdWJsaWMgY2xhc3MgV2lsZGNhcmRUeXBl
IGV4dGVuZHMgQW5ub3RhdGFibGVUeXBlIHsKIAogCS8qKgpAQCAtMjA2LDUgKzIwNiw0IEBACiAJ
CXJlc3VsdC5zZXRCb3VuZCgoVHlwZSkgQVNUTm9kZS5jb3B5U3VidHJlZSh0YXJnZXQsIGdldEJv
dW5kKCkpLCBpc1VwcGVyQm91bmQoKSk7CiAJCWlmICh0aGlzLmFzdC5hcGlMZXZlbCA+PSBBU1Qu
SkxTOCkgewotCQkJcmVzdWx0LmFubm90YXRpb25zID0gbmV3IEFTVE5vZGUuTm9kZUxpc3QoQU5O
T1RBVElPTlNfUFJPUEVSVFkpOwogCQkJcmVzdWx0LmFubm90YXRpb25zLmFkZEFsbCgKIAkJCQkJ
QVNUTm9kZS5jb3B5U3VidHJlZXModGFyZ2V0LCBhbm5vdGF0aW9ucygpKSk7CmRpZmYgLS1naXQg
YS9vcmcuZWNsaXBzZS5qZHQuY29yZS9kb20vb3JnL2VjbGlwc2UvamR0L2ludGVybmFsL2NvcmUv
ZG9tL05haXZlQVNURmxhdHRlbmVyLmphdmEgYi9vcmcuZWNsaXBzZS5qZHQuY29yZS9kb20vb3Jn
L2VjbGlwc2UvamR0L2ludGVybmFsL2NvcmUvZG9tL05haXZlQVNURmxhdHRlbmVyLmphdmEKaW5k
ZXggYThkZGFiMi4uNTM3MjZiYSAxMDA2NDQKLS0tIGEvb3JnLmVjbGlwc2UuamR0LmNvcmUvZG9t
L29yZy9lY2xpcHNlL2pkdC9pbnRlcm5hbC9jb3JlL2RvbS9OYWl2ZUFTVEZsYXR0ZW5lci5qYXZh
CisrKyBiL29yZy5lY2xpcHNlLmpkdC5jb3JlL2RvbS9vcmcvZWNsaXBzZS9qZHQvaW50ZXJuYWwv
Y29yZS9kb20vTmFpdmVBU1RGbGF0dGVuZXIuamF2YQpAQCAtMjIsNCArMjIsNSBAQAogaW1wb3J0
IG9yZy5lY2xpcHNlLmpkdC5jb3JlLmRvbS5BU1RWaXNpdG9yOwogaW1wb3J0IG9yZy5lY2xpcHNl
LmpkdC5jb3JlLmRvbS5BYnN0cmFjdFR5cGVEZWNsYXJhdGlvbjsKK2ltcG9ydCBvcmcuZWNsaXBz
ZS5qZHQuY29yZS5kb20uQW5ub3RhdGFibGVUeXBlOwogaW1wb3J0IG9yZy5lY2xpcHNlLmpkdC5j
b3JlLmRvbS5Bbm5vdGF0aW9uOwogaW1wb3J0IG9yZy5lY2xpcHNlLmpkdC5jb3JlLmRvbS5Bbm5v
dGF0aW9uVHlwZURlY2xhcmF0aW9uOwpAQCAtNDUsNCArNDYsNSBAQAogaW1wb3J0IG9yZy5lY2xp
cHNlLmpkdC5jb3JlLmRvbS5Db25zdHJ1Y3Rvckludm9jYXRpb247CiBpbXBvcnQgb3JnLmVjbGlw
c2UuamR0LmNvcmUuZG9tLkNvbnRpbnVlU3RhdGVtZW50OworaW1wb3J0IG9yZy5lY2xpcHNlLmpk
dC5jb3JlLmRvbS5EaW1lbnNpb25UeXBlOwogaW1wb3J0IG9yZy5lY2xpcHNlLmpkdC5jb3JlLmRv
bS5VbmlvblR5cGU7CiBpbXBvcnQgb3JnLmVjbGlwc2UuamR0LmNvcmUuZG9tLkRvU3RhdGVtZW50
OwpAQCAtNDEzLDQgKzQxNSwxNCBAQAogCQl2aXNpdFR5cGVBbm5vdGF0aW9ucyhub2RlKTsKIAkJ
dGhpcy5idWZmZXIuYXBwZW5kKCJbXSIpOy8vJE5PTi1OTFMtMSQKKwkJcmV0dXJuIGZhbHNlOwor
CX0KKworCXB1YmxpYyBib29sZWFuIHZpc2l0KERpbWVuc2lvblR5cGUgbm9kZSkgeworCQl2aXNp
dFR5cGVBbm5vdGF0aW9ucyhub2RlKTsKKwkJdGhpcy5idWZmZXIuYXBwZW5kKCJbIik7IC8vJE5P
Ti1OTFMtMSQKKwkJaWYgKG5vZGUuZXhwcmVzc2lvbigpICE9IG51bGwpIHsKKwkJCW5vZGUuZXhw
cmVzc2lvbigpLmFjY2VwdCh0aGlzKTsKKwkJfQorCQl0aGlzLmJ1ZmZlci5hcHBlbmQoIl0iKTsg
Ly8kTk9OLU5MUy0xJAogCQlyZXR1cm4gZmFsc2U7CiAJfQpAQCAtMTAyMSw2ICsxMDMzLDkgQEAK
IAkJfQogCQl0aGlzLmJ1ZmZlci5hcHBlbmQoIikiKTsvLyROT04tTkxTLTEkCi0JCWZvciAoaW50
IGkgPSAwOyBpIDwgbm9kZS5nZXRFeHRyYURpbWVuc2lvbnMoKTsgaSsrKSB7Ci0JCQl0aGlzLmJ1
ZmZlci5hcHBlbmQoIltdIik7IC8vJE5PTi1OTFMtMSQKKwkJaWYgKG5vZGUuZ2V0QVNUKCkuYXBp
TGV2ZWwoKSA+PSBBU1QuSkxTOCkgeworCQkJTGlzdCBkaW1lbnNpb25zID0gbm9kZS5nZXRleHRy
YURpbWVuc2lvblR5cGVzKCk7CisJCQlmb3IgKGludCBpID0gMDsgaSA8IGRpbWVuc2lvbnMuc2l6
ZSgpOyBpKyspIHsKKwkJCQl2aXNpdCgoRGltZW5zaW9uVHlwZSkgZGltZW5zaW9ucy5nZXQoaSkp
OworCQkJfQogCQl9CiAJCWlmIChub2RlLmdldEFTVCgpLmFwaUxldmVsKCkgPCBBU1QuSkxTOCkg
ewpAQCAtMTM1MCw2ICsxMzY1LDkgQEAKIAkJdGhpcy5idWZmZXIuYXBwZW5kKCIgIik7Ly8kTk9O
LU5MUy0xJAogCQlub2RlLmdldE5hbWUoKS5hY2NlcHQodGhpcyk7Ci0JCWZvciAoaW50IGkgPSAw
OyBpIDwgbm9kZS5nZXRFeHRyYURpbWVuc2lvbnMoKTsgaSsrKSB7Ci0JCQl0aGlzLmJ1ZmZlci5h
cHBlbmQoIltdIik7IC8vJE5PTi1OTFMtMSQKKwkJaWYgKG5vZGUuZ2V0QVNUKCkuYXBpTGV2ZWwo
KSA+PSBBU1QuSkxTOCkgeworCQkJTGlzdCBkaW1lbnNpb25zID0gbm9kZS5nZXRFeHRyYURpbWVu
c2lvblR5cGVzKCk7CisJCQlmb3IgKGludCBpID0gMDsgaSA8IGRpbWVuc2lvbnMuc2l6ZSgpOyBp
KyspIHsKKwkJCQl2aXNpdCgoRGltZW5zaW9uVHlwZSkgZGltZW5zaW9ucy5nZXQoaSkpOworCQkJ
fQogCQl9CiAJCWlmIChub2RlLmdldEluaXRpYWxpemVyKCkgIT0gbnVsbCkgewpAQCAtMTc3MSw2
ICsxNzg5LDkgQEAKIAlwdWJsaWMgYm9vbGVhbiB2aXNpdChWYXJpYWJsZURlY2xhcmF0aW9uRnJh
Z21lbnQgbm9kZSkgewogCQlub2RlLmdldE5hbWUoKS5hY2NlcHQodGhpcyk7Ci0JCWZvciAoaW50
IGkgPSAwOyBpIDwgbm9kZS5nZXRFeHRyYURpbWVuc2lvbnMoKTsgaSsrKSB7Ci0JCQl0aGlzLmJ1
ZmZlci5hcHBlbmQoIltdIik7Ly8kTk9OLU5MUy0xJAorCQlpZiAobm9kZS5nZXRBU1QoKS5hcGlM
ZXZlbCgpID49IEFTVC5KTFM4KSB7CisJCQlMaXN0IGRpbWVuc2lvbnMgPSBub2RlLmdldEV4dHJh
RGltZW5zaW9uVHlwZXMoKTsKKwkJCWZvciAoaW50IGkgPSAwOyBpIDwgZGltZW5zaW9ucy5zaXpl
KCk7IGkrKykgeworCQkJCXZpc2l0KChEaW1lbnNpb25UeXBlKSBkaW1lbnNpb25zLmdldChpKSk7
CisJCQl9CiAJCX0KIAkJaWYgKG5vZGUuZ2V0SW5pdGlhbGl6ZXIoKSAhPSBudWxsKSB7CkBAIC0x
ODM1LDggKzE4NTYsOCBAQAogCQlyZXR1cm4gZmFsc2U7CiAJfQotCXByaXZhdGUgdm9pZCB2aXNp
dFR5cGVBbm5vdGF0aW9ucyhUeXBlIG5vZGUpIHsKKwlwcml2YXRlIHZvaWQgdmlzaXRUeXBlQW5u
b3RhdGlvbnMoQW5ub3RhdGFibGVUeXBlIG5vZGUpIHsKIAkJaWYgKG5vZGUuZ2V0QVNUKCkuYXBp
TGV2ZWwoKSA+PSBBU1QuSkxTOCkgewogCQkJTGlzdCBhbm5vdGF0aW9ucyA9IG5vZGUuYW5ub3Rh
dGlvbnMoKTsKLQkJCWlmIChhbm5vdGF0aW9ucyAhPSBudWxsKSB7CisJCQlpZiAoYW5ub3RhdGlv
bnMgIT0gbnVsbCAmJiBhbm5vdGF0aW9ucy5zaXplKCkgPiAwKSB7CiAJCQkJZm9yIChJdGVyYXRv
ciBpdCA9IGFubm90YXRpb25zLml0ZXJhdG9yKCk7IGl0Lmhhc05leHQoKTsgKSB7CiAJCQkJCUFu
bm90YXRpb24gYW5ub3RhdGlvbiA9IChBbm5vdGF0aW9uKSBpdC5uZXh0KCk7CkBAIC0xODUwLDUg
KzE4NzEsNSBAQAogCQlpZiAobm9kZS5nZXRBU1QoKS5hcGlMZXZlbCgpID49IEFTVC5KTFM4KSB7
CiAJCQlMaXN0IGFubm90YXRpb25zID0gbm9kZS5hbm5vdGF0aW9ucygpOwotCQkJaWYgKGFubm90
YXRpb25zICE9IG51bGwpIHsKKwkJCWlmIChhbm5vdGF0aW9ucyAhPSBudWxsICYmIGFubm90YXRp
b25zLnNpemUoKSA+IDApIHsKIAkJCQlmb3IgKEl0ZXJhdG9yIGl0ID0gYW5ub3RhdGlvbnMuaXRl
cmF0b3IoKTsgaXQuaGFzTmV4dCgpOyApIHsKIAkJCQkJQW5ub3RhdGlvbiBhbm5vdGF0aW9uID0g
KEFubm90YXRpb24pIGl0Lm5leHQoKTsKZGlmZiAtLWdpdCBhL29yZy5lY2xpcHNlLmpkdC5jb3Jl
L2RvbS9vcmcvZWNsaXBzZS9qZHQvaW50ZXJuYWwvY29yZS9kb20vcmV3cml0ZS9BU1RSZXdyaXRl
RmxhdHRlbmVyLmphdmEgYi9vcmcuZWNsaXBzZS5qZHQuY29yZS9kb20vb3JnL2VjbGlwc2UvamR0
L2ludGVybmFsL2NvcmUvZG9tL3Jld3JpdGUvQVNUUmV3cml0ZUZsYXR0ZW5lci5qYXZhCmluZGV4
IDE0ZDJiNTkuLjU4YWIyZTAgMTAwNjQ0Ci0tLSBhL29yZy5lY2xpcHNlLmpkdC5jb3JlL2RvbS9v
cmcvZWNsaXBzZS9qZHQvaW50ZXJuYWwvY29yZS9kb20vcmV3cml0ZS9BU1RSZXdyaXRlRmxhdHRl
bmVyLmphdmEKKysrIGIvb3JnLmVjbGlwc2UuamR0LmNvcmUvZG9tL29yZy9lY2xpcHNlL2pkdC9p
bnRlcm5hbC9jb3JlL2RvbS9yZXdyaXRlL0FTVFJld3JpdGVGbGF0dGVuZXIuamF2YQpAQCAtMSw0
ICsxLDQgQEAKIC8qKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioq
KioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqCi0gKiBDb3B5cmlnaHQgKGMpIDIwMDAs
IDIwMTIgSUJNIENvcnBvcmF0aW9uIGFuZCBvdGhlcnMuCisgKiBDb3B5cmlnaHQgKGMpIDIwMDAs
IDIwMTMgSUJNIENvcnBvcmF0aW9uIGFuZCBvdGhlcnMuCiAgKiBBbGwgcmlnaHRzIHJlc2VydmVk
LiBUaGlzIHByb2dyYW0gYW5kIHRoZSBhY2NvbXBhbnlpbmcgbWF0ZXJpYWxzCiAgKiBhcmUgbWFk
ZSBhdmFpbGFibGUgdW5kZXIgdGhlIHRlcm1zIG9mIHRoZSBFY2xpcHNlIFB1YmxpYyBMaWNlbnNl
IHYxLjAKQEAgLTIyNyw3ICsyMjcsMTcgQEAKIAkJZ2V0Q2hpbGROb2RlKG5vZGUsIEFycmF5VHlw
ZS5DT01QT05FTlRfVFlQRV9QUk9QRVJUWSkuYWNjZXB0KHRoaXMpOwogCQlpZiAobm9kZS5nZXRB
U1QoKS5hcGlMZXZlbCgpID49IEFTVC5KTFM4KSB7Ci0JCQl2aXNpdExpc3Qobm9kZSwgQXJyYXlU
eXBlLkFOTk9UQVRJT05TX1BST1BFUlRZLCBTdHJpbmcudmFsdWVPZignICcpLCBVdGlsLkVNUFRZ
X1NUUklORywgU3RyaW5nLnZhbHVlT2YoJyAnKSk7CisJCQl2aXNpdExpc3Qobm9kZSwgQXJyYXlU
eXBlLkFOTk9UQVRJT05TX1BST1BFUlRZLCBTdHJpbmcudmFsdWVPZignICcpLCBVdGlsLkVNUFRZ
X1NUUklORywgVXRpbC5FTVBUWV9TVFJJTkcpOwogCQl9CiAJCXRoaXMucmVzdWx0LmFwcGVuZCgi
W10iKTsgLy8kTk9OLU5MUy0xJAorCQlyZXR1cm4gZmFsc2U7CisJfQorCQorCXB1YmxpYyBib29s
ZWFuIHZpc2l0KERpbWVuc2lvblR5cGUgbm9kZSkgeworCQl2aXNpdExpc3Qobm9kZSwgQXJyYXlU
eXBlLkFOTk9UQVRJT05TX1BST1BFUlRZLCBTdHJpbmcudmFsdWVPZignICcpLCBVdGlsLkVNUFRZ
X1NUUklORywgVXRpbC5FTVBUWV9TVFJJTkcpOworCQl0aGlzLnJlc3VsdC5hcHBlbmQoIlsiKTsg
Ly8kTk9OLU5MUy0xJAorCQlpZiAobm9kZS5leHByZXNzaW9uKCkgIT0gbnVsbCkgeworCQkJbm9k
ZS5leHByZXNzaW9uKCkuYWNjZXB0KHRoaXMpOworCQl9CisJCXRoaXMucmVzdWx0LmFwcGVuZCgi
XSIpOyAvLyROT04tTkxTLTEkCiAJCXJldHVybiBmYWxzZTsKIAl9CkBAIC03OTUsNyArODA1LDEx
IEBACiAJCXRoaXMucmVzdWx0LmFwcGVuZCgnICcpOwogCQlnZXRDaGlsZE5vZGUobm9kZSwgU2lu
Z2xlVmFyaWFibGVEZWNsYXJhdGlvbi5OQU1FX1BST1BFUlRZKS5hY2NlcHQodGhpcyk7Ci0JCWlu
dCBleHRyYURpbWVuc2lvbnM9IGdldEludEF0dHJpYnV0ZShub2RlLCBTaW5nbGVWYXJpYWJsZURl
Y2xhcmF0aW9uLkVYVFJBX0RJTUVOU0lPTlNfUFJPUEVSVFkpOwotCQlmb3IgKGludCBpID0gMDsg
aSA8IGV4dHJhRGltZW5zaW9uczsgaSsrKSB7Ci0JCQl0aGlzLnJlc3VsdC5hcHBlbmQoIltdIik7
IC8vJE5PTi1OTFMtMSQKKwkJaWYgKG5vZGUuZ2V0QVNUKCkuYXBpTGV2ZWwoKSA+PSBBU1QuSkxT
OCkgeworCQkJdmlzaXRMaXN0KG5vZGUsIFNpbmdsZVZhcmlhYmxlRGVjbGFyYXRpb24uRVhUUkFf
RElNRU5TSU9OX1RZUEVTX1BST1BFUlRZLCBTdHJpbmcudmFsdWVPZignICcpLCBVdGlsLkVNUFRZ
X1NUUklORywgVXRpbC5FTVBUWV9TVFJJTkcpOworCQl9IGVsc2UgeworCQkJaW50IGV4dHJhRGlt
ZW5zaW9ucz0gZ2V0SW50QXR0cmlidXRlKG5vZGUsIFNpbmdsZVZhcmlhYmxlRGVjbGFyYXRpb24u
RVhUUkFfRElNRU5TSU9OU19QUk9QRVJUWSk7CisJCQlmb3IgKGludCBpID0gMDsgaSA8IGV4dHJh
RGltZW5zaW9uczsgaSsrKSB7CisJCQkJdGhpcy5yZXN1bHQuYXBwZW5kKCJbXSIpOyAvLyROT04t
TkxTLTEkCisJCQl9CiAJCX0KIAkJQVNUTm9kZSBpbml0aWFsaXplcj0gZ2V0Q2hpbGROb2RlKG5v
ZGUsIFNpbmdsZVZhcmlhYmxlRGVjbGFyYXRpb24uSU5JVElBTElaRVJfUFJPUEVSVFkpOwpAQCAt
MTA0MCw3ICsxMDU0LDExIEBACiAJcHVibGljIGJvb2xlYW4gdmlzaXQoVmFyaWFibGVEZWNsYXJh
dGlvbkZyYWdtZW50IG5vZGUpIHsKIAkJZ2V0Q2hpbGROb2RlKG5vZGUsIFZhcmlhYmxlRGVjbGFy
YXRpb25GcmFnbWVudC5OQU1FX1BST1BFUlRZKS5hY2NlcHQodGhpcyk7Ci0JCWludCBleHRyYURp
bWVuc2lvbnM9IGdldEludEF0dHJpYnV0ZShub2RlLCBWYXJpYWJsZURlY2xhcmF0aW9uRnJhZ21l
bnQuRVhUUkFfRElNRU5TSU9OU19QUk9QRVJUWSk7Ci0JCWZvciAoaW50IGkgPSAwOyBpIDwgZXh0
cmFEaW1lbnNpb25zOyBpKyspIHsKLQkJCXRoaXMucmVzdWx0LmFwcGVuZCgiW10iKTsgLy8kTk9O
LU5MUy0xJAorCQlpZiAobm9kZS5nZXRBU1QoKS5hcGlMZXZlbCgpID49IEFTVC5KTFM4KSB7CisJ
CQl2aXNpdExpc3Qobm9kZSwgVmFyaWFibGVEZWNsYXJhdGlvbkZyYWdtZW50LkVYVFJBX0RJTUVO
U0lPTl9UWVBFU19QUk9QRVJUWSwgU3RyaW5nLnZhbHVlT2YoJyAnKSwgVXRpbC5FTVBUWV9TVFJJ
TkcsIFV0aWwuRU1QVFlfU1RSSU5HKTsKKwkJfSBlbHNlIHsKKwkJCWludCBleHRyYURpbWVuc2lv
bnM9IGdldEludEF0dHJpYnV0ZShub2RlLCBWYXJpYWJsZURlY2xhcmF0aW9uRnJhZ21lbnQuRVhU
UkFfRElNRU5TSU9OU19QUk9QRVJUWSk7CisJCQlmb3IgKGludCBpID0gMDsgaSA8IGV4dHJhRGlt
ZW5zaW9uczsgaSsrKSB7CisJCQkJdGhpcy5yZXN1bHQuYXBwZW5kKCJbXSIpOyAvLyROT04tTkxT
LTEkCisJCQl9CiAJCX0KIAkJQVNUTm9kZSBpbml0aWFsaXplcj0gZ2V0Q2hpbGROb2RlKG5vZGUs
IFZhcmlhYmxlRGVjbGFyYXRpb25GcmFnbWVudC5JTklUSUFMSVpFUl9QUk9QRVJUWSk7
</data>

          </attachment>
          <attachment
              isobsolete="1"
              ispatch="1"
              isprivate="0"
          >
            <attachid>226075</attachid>
            <date>2013-01-25 01:07:00 -0500</date>
            <delta_ts>2013-01-25 11:44:16 -0500</delta_ts>
            <desc>Updated patch</desc>
            <filename>Fix-for-bug-391895.patch</filename>
            <type>text/plain</type>
            <size>66564</size>
            <attacher name="Jay Arthanareeswaran">jarthana</attacher>
            
              <data encoding="base64">ZGlmZiAtLWdpdCBhL29yZy5lY2xpcHNlLmpkdC5jb3JlLnRlc3RzLm1vZGVsL3NyYy9vcmcvZWNs
aXBzZS9qZHQvY29yZS90ZXN0cy9kb20vQVNUQ29udmVydGVyMTVKTFM4VGVzdC5qYXZhIGIvb3Jn
LmVjbGlwc2UuamR0LmNvcmUudGVzdHMubW9kZWwvc3JjL29yZy9lY2xpcHNlL2pkdC9jb3JlL3Rl
c3RzL2RvbS9BU1RDb252ZXJ0ZXIxNUpMUzhUZXN0LmphdmEKaW5kZXggZjRiMTUyOC4uMmU1ZDM5
ZCAxMDA2NDQKLS0tIGEvb3JnLmVjbGlwc2UuamR0LmNvcmUudGVzdHMubW9kZWwvc3JjL29yZy9l
Y2xpcHNlL2pkdC9jb3JlL3Rlc3RzL2RvbS9BU1RDb252ZXJ0ZXIxNUpMUzhUZXN0LmphdmEKKysr
IGIvb3JnLmVjbGlwc2UuamR0LmNvcmUudGVzdHMubW9kZWwvc3JjL29yZy9lY2xpcHNlL2pkdC9j
b3JlL3Rlc3RzL2RvbS9BU1RDb252ZXJ0ZXIxNUpMUzhUZXN0LmphdmEKQEAgLTEsNSArMSw1IEBA
CiAvKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioq
KioqKioqKioqKioqKioqKioqKioqKioqKgotICogQ29weXJpZ2h0IChjKSAyMDExLCAyMDEyIElC
TSBDb3Jwb3JhdGlvbiBhbmQgb3RoZXJzLgorICogQ29weXJpZ2h0IChjKSAyMDExLCAyMDEzIElC
TSBDb3Jwb3JhdGlvbiBhbmQgb3RoZXJzLgogICogQWxsIHJpZ2h0cyByZXNlcnZlZC4gVGhpcyBw
cm9ncmFtIGFuZCB0aGUgYWNjb21wYW55aW5nIG1hdGVyaWFscwogICogYXJlIG1hZGUgYXZhaWxh
YmxlIHVuZGVyIHRoZSB0ZXJtcyBvZiB0aGUgRWNsaXBzZSBQdWJsaWMgTGljZW5zZSB2MS4wCiAg
KiB3aGljaCBhY2NvbXBhbmllcyB0aGlzIGRpc3RyaWJ1dGlvbiwgYW5kIGlzIGF2YWlsYWJsZSBh
dApAQCAtNTE2LDcgKzUxNiw3IEBACiAJCWNoZWNrU291cmNlUmFuZ2UoKEFTVE5vZGUpIG1vZGlm
aWVyLCAiQEZvbyIsIHNvdXJjZSk7CiAJCW1vZGlmaWVyID0gKElFeHRlbmRlZE1vZGlmaWVyKSBt
b2RpZmllcnMuZ2V0KDEpOwogCQljaGVja1NvdXJjZVJhbmdlKChBU1ROb2RlKSBtb2RpZmllciwg
ImZpbmFsIiwgc291cmNlKTsKLQkJYXNzZXJ0RXF1YWxzKCJXcm9uZyBkaW1lbnNpb24iLCAxLCBz
aW5nbGVWYXJpYWJsZURlY2xhcmF0aW9uLmdldEV4dHJhRGltZW5zaW9ucygpKTsKKwkJYXNzZXJ0
RXF1YWxzKCJXcm9uZyBkaW1lbnNpb24iLCAxLCBzaW5nbGVWYXJpYWJsZURlY2xhcmF0aW9uLmdl
dEV4dHJhRGltZW5zaW9uVHlwZXMoKS5zaXplKCkpOwogCQlUeXBlIHR5cGUgPSBzaW5nbGVWYXJp
YWJsZURlY2xhcmF0aW9uLmdldFR5cGUoKTsKIAkJY2hlY2tTb3VyY2VSYW5nZSh0eXBlLCAiU3Ry
aW5nIiwgc291cmNlKTsKIAkJYXNzZXJ0RXF1YWxzKCJXcm9uZyBuYW1lIiwgInMiLCBzaW1wbGVO
YW1lLmdldElkZW50aWZpZXIoKSk7CkBAIC0xNzA5LDcgKzE3MDksNyBAQAogCQlhc3NlcnRUcnVl
KCJub3QgYW4gYXJyYXkgdHlwZSIsIHR5cGUuaXNBcnJheVR5cGUoKSk7CiAJCUFycmF5VHlwZSBh
cnJheVR5cGUgPSAoQXJyYXlUeXBlKSB0eXBlOwogCQljaGVja1NvdXJjZVJhbmdlKGFycmF5VHlw
ZS5nZXRDb21wb25lbnRUeXBlKCksICJTdHJpbmciLCBzb3VyY2UpOwotCQlhc3NlcnRFcXVhbHMo
Ildyb25nIGV4dHJhIGRpbWVuc2lvbnMiLCAxLCBzaW5nbGVWYXJpYWJsZURlY2xhcmF0aW9uLmdl
dEV4dHJhRGltZW5zaW9ucygpKTsKKwkJYXNzZXJ0RXF1YWxzKCJXcm9uZyBleHRyYSBkaW1lbnNp
b25zIiwgMSwgc2luZ2xlVmFyaWFibGVEZWNsYXJhdGlvbi5nZXRFeHRyYURpbWVuc2lvblR5cGVz
KCkuc2l6ZSgpKTsKIAl9CiAKIAkvKioKQEAgLTE3MzcsNyArMTczNyw3IEBACiAJCWFzc2VydFRy
dWUoIm5vdCBhbiBhcnJheSB0eXBlIiwgdHlwZS5pc0FycmF5VHlwZSgpKTsKIAkJQXJyYXlUeXBl
IGFycmF5VHlwZSA9IChBcnJheVR5cGUpIHR5cGU7CiAJCWNoZWNrU291cmNlUmFuZ2UoYXJyYXlU
eXBlLmdldENvbXBvbmVudFR5cGUoKSwgIlN0cmluZyIsIHNvdXJjZSk7Ci0JCWFzc2VydEVxdWFs
cygiV3JvbmcgZXh0cmEgZGltZW5zaW9ucyIsIDAsIHNpbmdsZVZhcmlhYmxlRGVjbGFyYXRpb24u
Z2V0RXh0cmFEaW1lbnNpb25zKCkpOworCQlhc3NlcnRFcXVhbHMoIldyb25nIGV4dHJhIGRpbWVu
c2lvbnMiLCAwLCBzaW5nbGVWYXJpYWJsZURlY2xhcmF0aW9uLmdldEV4dHJhRGltZW5zaW9uVHlw
ZXMoKS5zaXplKCkpOwogCX0KIAkvKioKIAkgKiBodHRwczovL2J1Z3MuZWNsaXBzZS5vcmcvYnVn
cy9zaG93X2J1Zy5jZ2k/aWQ9NzYxMDMKZGlmZiAtLWdpdCBhL29yZy5lY2xpcHNlLmpkdC5jb3Jl
LnRlc3RzLm1vZGVsL3NyYy9vcmcvZWNsaXBzZS9qZHQvY29yZS90ZXN0cy9kb20vQVNUQ29udmVy
dGVyMThUZXN0LmphdmEgYi9vcmcuZWNsaXBzZS5qZHQuY29yZS50ZXN0cy5tb2RlbC9zcmMvb3Jn
L2VjbGlwc2UvamR0L2NvcmUvdGVzdHMvZG9tL0FTVENvbnZlcnRlcjE4VGVzdC5qYXZhCmluZGV4
IDA2MWM5MTYuLjZhYjY5YmIgMTAwNjQ0Ci0tLSBhL29yZy5lY2xpcHNlLmpkdC5jb3JlLnRlc3Rz
Lm1vZGVsL3NyYy9vcmcvZWNsaXBzZS9qZHQvY29yZS90ZXN0cy9kb20vQVNUQ29udmVydGVyMThU
ZXN0LmphdmEKKysrIGIvb3JnLmVjbGlwc2UuamR0LmNvcmUudGVzdHMubW9kZWwvc3JjL29yZy9l
Y2xpcHNlL2pkdC9jb3JlL3Rlc3RzL2RvbS9BU1RDb252ZXJ0ZXIxOFRlc3QuamF2YQpAQCAtNjQs
NyArNjQsNyBAQAogCSAqIFR5cGUgQW5ub3RhdGlvbnMgb24gVmFyaWFibGUgQXJndW1lbnRzCiAJ
ICovCiAJLy8gaHR0cHM6Ly9idWdzLmVjbGlwc2Uub3JnL2J1Z3Mvc2hvd19idWcuY2dpP2lkPTM5
MTg5OAotCXB1YmxpYyB2b2lkIHRlc3QwMDAxKCkgdGhyb3dzIEphdmFNb2RlbEV4Y2VwdGlvbiB7
CisJcHVibGljIHZvaWQgdGVzdEJ1ZzM5MTg5OCgpIHRocm93cyBKYXZhTW9kZWxFeGNlcHRpb24g
ewogCQlTdHJpbmcgY29udGVudHMgPQogCQkJIiAgICBAamF2YS5sYW5nLmFubm90YXRpb24uVGFy
Z2V0IChqYXZhLmxhbmcuYW5ub3RhdGlvbi5FbGVtZW50VHlwZS5UWVBFX1VTRSlcbiIgKwogCQkJ
IiAgICBAaW50ZXJmYWNlIE1hcmtlciB7XG4iICsKZGlmZiAtLWdpdCBhL29yZy5lY2xpcHNlLmpk
dC5jb3JlLnRlc3RzLm1vZGVsL3NyYy9vcmcvZWNsaXBzZS9qZHQvY29yZS90ZXN0cy9kb20vQVNU
Q29udmVydGVyQVNUOFRlc3QuamF2YSBiL29yZy5lY2xpcHNlLmpkdC5jb3JlLnRlc3RzLm1vZGVs
L3NyYy9vcmcvZWNsaXBzZS9qZHQvY29yZS90ZXN0cy9kb20vQVNUQ29udmVydGVyQVNUOFRlc3Qu
amF2YQppbmRleCA5MjdhYjNmLi5iMDM0ZGE1IDEwMDY0NAotLS0gYS9vcmcuZWNsaXBzZS5qZHQu
Y29yZS50ZXN0cy5tb2RlbC9zcmMvb3JnL2VjbGlwc2UvamR0L2NvcmUvdGVzdHMvZG9tL0FTVENv
bnZlcnRlckFTVDhUZXN0LmphdmEKKysrIGIvb3JnLmVjbGlwc2UuamR0LmNvcmUudGVzdHMubW9k
ZWwvc3JjL29yZy9lY2xpcHNlL2pkdC9jb3JlL3Rlc3RzL2RvbS9BU1RDb252ZXJ0ZXJBU1Q4VGVz
dC5qYXZhCkBAIC0zNyw2ICszNyw3IEBACiAKIAlzdGF0aWMgewogLy8JCVRFU1RTX05VTUJFUlMg
PSBuZXcgaW50W10geyAzNTYgfTsKKy8vCQlURVNUU19OQU1FUyA9IG5ldyBTdHJpbmdbXXsgInRl
c3QwMzkzIiB9OwogCX0KIAlwdWJsaWMgc3RhdGljIFRlc3Qgc3VpdGUoKSB7CiAJCXJldHVybiBi
dWlsZE1vZGVsVGVzdFN1aXRlKEFTVENvbnZlcnRlckFTVDhUZXN0LmNsYXNzKTsKQEAgLTE5OTIs
NyArMTk5Myw3IEBACiAJCXZhcmlhYmxlRGVjbGFyYXRpb24uc2V0TmFtZSh0aGlzLmFzdC5uZXdT
aW1wbGVOYW1lKCJzIikpOyAvLyROT04tTkxTLTEkCiAJCWFzc2VydFRydWUoIkJvdGggQVNUIHRy
ZWVzIHNob3VsZCBiZSBpZGVudGljYWwiLCB2YXJpYWJsZURlY2xhcmF0aW9uLnN1YnRyZWVNYXRj
aChuZXcgQVNUTWF0Y2hlcigpLCBub2RlKSk7CQkvLyROT04tTkxTLTEkCiAJCWNoZWNrU291cmNl
UmFuZ2Uobm9kZSwgImZpbmFsIFN0cmluZyBzIiwgc291cmNlKTsgLy8kTk9OLU5MUy0xJAotCQlh
c3NlcnRFcXVhbHMoIldyb25nIGRpbWVuc2lvbiIsIDAsIG5vZGUuZ2V0RXh0cmFEaW1lbnNpb25z
KCkpOyAvLyROT04tTkxTLTEkCisJCWFzc2VydEVxdWFscygiV3JvbmcgZGltZW5zaW9uIiwgMCwg
bm9kZS5nZXRFeHRyYURpbWVuc2lvblR5cGVzKCkuc2l6ZSgpKTsgLy8kTk9OLU5MUy0xJAogCX0K
IAogCS8qKgpAQCAtMjcxOCwyMCArMjcxOSwyMyBAQAogCQlOdW1iZXJMaXRlcmFsIGxpdGVyYWwg
PSB0aGlzLmFzdC5uZXdOdW1iZXJMaXRlcmFsKCk7CiAJCWxpdGVyYWwuc2V0VG9rZW4oIjEwIik7
Ly8kTk9OLU5MUy0xJAogCQlmcmFnbWVudC5zZXRJbml0aWFsaXplcihsaXRlcmFsKTsKLQkJZnJh
Z21lbnQuc2V0RXh0cmFEaW1lbnNpb25zKDApOworCQlmcmFnbWVudC5nZXRFeHRyYURpbWVuc2lv
blR5cGVzKCkuY2xlYXIoKTsKIAkJVmFyaWFibGVEZWNsYXJhdGlvblN0YXRlbWVudCBzdGF0ZW1l
bnQgPSB0aGlzLmFzdC5uZXdWYXJpYWJsZURlY2xhcmF0aW9uU3RhdGVtZW50KGZyYWdtZW50KTsK
IAkJZnJhZ21lbnQgPSB0aGlzLmFzdC5uZXdWYXJpYWJsZURlY2xhcmF0aW9uRnJhZ21lbnQoKTsK
IAkJZnJhZ21lbnQuc2V0TmFtZSh0aGlzLmFzdC5uZXdTaW1wbGVOYW1lKCJ6IikpOy8vJE5PTi1O
TFMtMSQKIAkJZnJhZ21lbnQuc2V0SW5pdGlhbGl6ZXIodGhpcy5hc3QubmV3TnVsbExpdGVyYWwo
KSk7Ci0JCWZyYWdtZW50LnNldEV4dHJhRGltZW5zaW9ucygxKTsKKwkJZnJhZ21lbnQuZ2V0RXh0
cmFEaW1lbnNpb25UeXBlcygpLmNsZWFyKCk7CisJCWZyYWdtZW50LmdldEV4dHJhRGltZW5zaW9u
VHlwZXMoKS5hZGQodGhpcy5hc3QubmV3RGltZW5zaW9uVHlwZShudWxsKSk7CiAJCXN0YXRlbWVu
dC5mcmFnbWVudHMoKS5hZGQoZnJhZ21lbnQpOwogCQlmcmFnbWVudCA9IHRoaXMuYXN0Lm5ld1Zh
cmlhYmxlRGVjbGFyYXRpb25GcmFnbWVudCgpOwogCQlmcmFnbWVudC5zZXROYW1lKHRoaXMuYXN0
Lm5ld1NpbXBsZU5hbWUoImkiKSk7Ly8kTk9OLU5MUy0xJAotCQlmcmFnbWVudC5zZXRFeHRyYURp
bWVuc2lvbnMoMCk7CisJCWZyYWdtZW50LmdldEV4dHJhRGltZW5zaW9uVHlwZXMoKS5jbGVhcigp
OwogCQlzdGF0ZW1lbnQuZnJhZ21lbnRzKCkuYWRkKGZyYWdtZW50KTsKIAkJZnJhZ21lbnQgPSB0
aGlzLmFzdC5uZXdWYXJpYWJsZURlY2xhcmF0aW9uRnJhZ21lbnQoKTsKIAkJZnJhZ21lbnQuc2V0
TmFtZSh0aGlzLmFzdC5uZXdTaW1wbGVOYW1lKCJqIikpOy8vJE5PTi1OTFMtMSQKLQkJZnJhZ21l
bnQuc2V0RXh0cmFEaW1lbnNpb25zKDIpOworCQlmcmFnbWVudC5nZXRFeHRyYURpbWVuc2lvblR5
cGVzKCkuY2xlYXIoKTsKKwkJZnJhZ21lbnQuZ2V0RXh0cmFEaW1lbnNpb25UeXBlcygpLmFkZCh0
aGlzLmFzdC5uZXdEaW1lbnNpb25UeXBlKG51bGwpKTsKKwkJZnJhZ21lbnQuZ2V0RXh0cmFEaW1l
bnNpb25UeXBlcygpLmFkZCh0aGlzLmFzdC5uZXdEaW1lbnNpb25UeXBlKG51bGwpKTsKIAkJc3Rh
dGVtZW50LmZyYWdtZW50cygpLmFkZChmcmFnbWVudCk7CiAJCXN0YXRlbWVudC5zZXRUeXBlKHRo
aXMuYXN0Lm5ld1ByaW1pdGl2ZVR5cGUoUHJpbWl0aXZlVHlwZS5JTlQpKTsKIAkJYXNzZXJ0VHJ1
ZSgiQm90aCBBU1QgdHJlZXMgc2hvdWxkIGJlIGlkZW50aWNhbCIsIHN0YXRlbWVudC5zdWJ0cmVl
TWF0Y2gobmV3IEFTVE1hdGNoZXIoKSwgbm9kZSkpOwkJLy8kTk9OLU5MUy0xJApAQCAtMjc1OCwy
MCArMjc2MiwyMyBAQAogCQlOdW1iZXJMaXRlcmFsIGxpdGVyYWwgPSB0aGlzLmFzdC5uZXdOdW1i
ZXJMaXRlcmFsKCk7CiAJCWxpdGVyYWwuc2V0VG9rZW4oIjEwIik7Ly8kTk9OLU5MUy0xJAogCQlm
cmFnbWVudC5zZXRJbml0aWFsaXplcihsaXRlcmFsKTsKLQkJZnJhZ21lbnQuc2V0RXh0cmFEaW1l
bnNpb25zKDApOworCQlmcmFnbWVudC5nZXRFeHRyYURpbWVuc2lvblR5cGVzKCkuY2xlYXIoKTsK
IAkJVmFyaWFibGVEZWNsYXJhdGlvblN0YXRlbWVudCBzdGF0ZW1lbnQgPSB0aGlzLmFzdC5uZXdW
YXJpYWJsZURlY2xhcmF0aW9uU3RhdGVtZW50KGZyYWdtZW50KTsKIAkJZnJhZ21lbnQgPSB0aGlz
LmFzdC5uZXdWYXJpYWJsZURlY2xhcmF0aW9uRnJhZ21lbnQoKTsKIAkJZnJhZ21lbnQuc2V0TmFt
ZSh0aGlzLmFzdC5uZXdTaW1wbGVOYW1lKCJ6IikpOy8vJE5PTi1OTFMtMSQKIAkJZnJhZ21lbnQu
c2V0SW5pdGlhbGl6ZXIodGhpcy5hc3QubmV3TnVsbExpdGVyYWwoKSk7Ci0JCWZyYWdtZW50LnNl
dEV4dHJhRGltZW5zaW9ucygxKTsKKwkJZnJhZ21lbnQuZ2V0RXh0cmFEaW1lbnNpb25UeXBlcygp
LmNsZWFyKCk7CisJCWZyYWdtZW50LmdldEV4dHJhRGltZW5zaW9uVHlwZXMoKS5hZGQodGhpcy5h
c3QubmV3RGltZW5zaW9uVHlwZShudWxsKSk7CiAJCXN0YXRlbWVudC5mcmFnbWVudHMoKS5hZGQo
ZnJhZ21lbnQpOwogCQlmcmFnbWVudCA9IHRoaXMuYXN0Lm5ld1ZhcmlhYmxlRGVjbGFyYXRpb25G
cmFnbWVudCgpOwogCQlmcmFnbWVudC5zZXROYW1lKHRoaXMuYXN0Lm5ld1NpbXBsZU5hbWUoImki
KSk7Ly8kTk9OLU5MUy0xJAotCQlmcmFnbWVudC5zZXRFeHRyYURpbWVuc2lvbnMoMCk7CisJCWZy
YWdtZW50LmdldEV4dHJhRGltZW5zaW9uVHlwZXMoKS5jbGVhcigpOwogCQlzdGF0ZW1lbnQuZnJh
Z21lbnRzKCkuYWRkKGZyYWdtZW50KTsKIAkJZnJhZ21lbnQgPSB0aGlzLmFzdC5uZXdWYXJpYWJs
ZURlY2xhcmF0aW9uRnJhZ21lbnQoKTsKIAkJZnJhZ21lbnQuc2V0TmFtZSh0aGlzLmFzdC5uZXdT
aW1wbGVOYW1lKCJqIikpOy8vJE5PTi1OTFMtMSQKLQkJZnJhZ21lbnQuc2V0RXh0cmFEaW1lbnNp
b25zKDIpOworCQlmcmFnbWVudC5nZXRFeHRyYURpbWVuc2lvblR5cGVzKCkuY2xlYXIoKTsKKwkJ
ZnJhZ21lbnQuZ2V0RXh0cmFEaW1lbnNpb25UeXBlcygpLmFkZCh0aGlzLmFzdC5uZXdEaW1lbnNp
b25UeXBlKG51bGwpKTsKKwkJZnJhZ21lbnQuZ2V0RXh0cmFEaW1lbnNpb25UeXBlcygpLmFkZCh0
aGlzLmFzdC5uZXdEaW1lbnNpb25UeXBlKG51bGwpKTsKIAkJc3RhdGVtZW50LmZyYWdtZW50cygp
LmFkZChmcmFnbWVudCk7CiAJCXN0YXRlbWVudC5zZXRUeXBlKHRoaXMuYXN0Lm5ld0FycmF5VHlw
ZSh0aGlzLmFzdC5uZXdQcmltaXRpdmVUeXBlKFByaW1pdGl2ZVR5cGUuSU5UKSwgMSkpOwogCQlh
c3NlcnRUcnVlKCJCb3RoIEFTVCB0cmVlcyBzaG91bGQgYmUgaWRlbnRpY2FsIiwgc3RhdGVtZW50
LnN1YnRyZWVNYXRjaChuZXcgQVNUTWF0Y2hlcigpLCBub2RlKSk7CQkvLyROT04tTkxTLTEkCkBA
IC0yNzk3LDcgKzI4MDQsOCBAQAogCQlWYXJpYWJsZURlY2xhcmF0aW9uRnJhZ21lbnQgdmFyaWFi
bGVEZWNsYXJhdGlvbkZyYWdtZW50ID0gdGhpcy5hc3QubmV3VmFyaWFibGVEZWNsYXJhdGlvbkZy
YWdtZW50KCk7CiAJCXZhcmlhYmxlRGVjbGFyYXRpb25GcmFnbWVudC5zZXROYW1lKHRoaXMuYXN0
Lm5ld1NpbXBsZU5hbWUoInRhYiIpKTsgLy8kTk9OLU5MUy0xJAogCQl2YXJpYWJsZURlY2xhcmF0
aW9uRnJhZ21lbnQuc2V0SW5pdGlhbGl6ZXIodGhpcy5hc3QubmV3TnVsbExpdGVyYWwoKSk7Ly8k
Tk9OLU5MUy0xJAotCQl2YXJpYWJsZURlY2xhcmF0aW9uRnJhZ21lbnQuc2V0RXh0cmFEaW1lbnNp
b25zKDEpOworCQl2YXJpYWJsZURlY2xhcmF0aW9uRnJhZ21lbnQuZ2V0RXh0cmFEaW1lbnNpb25U
eXBlcygpLmNsZWFyKCk7CisJCXZhcmlhYmxlRGVjbGFyYXRpb25GcmFnbWVudC5nZXRFeHRyYURp
bWVuc2lvblR5cGVzKCkuYWRkKHRoaXMuYXN0Lm5ld0RpbWVuc2lvblR5cGUobnVsbCkpOwogCQlW
YXJpYWJsZURlY2xhcmF0aW9uRXhwcmVzc2lvbiB2YXJpYWJsZURlY2xhcmF0aW9uRXhwcmVzc2lv
biA9IHRoaXMuYXN0Lm5ld1ZhcmlhYmxlRGVjbGFyYXRpb25FeHByZXNzaW9uKHZhcmlhYmxlRGVj
bGFyYXRpb25GcmFnbWVudCk7CiAJCXZhcmlhYmxlRGVjbGFyYXRpb25FeHByZXNzaW9uLnNldFR5
cGUodGhpcy5hc3QubmV3QXJyYXlUeXBlKHRoaXMuYXN0Lm5ld1NpbXBsZVR5cGUodGhpcy5hc3Qu
bmV3U2ltcGxlTmFtZSgiU3RyaW5nIikpLCAxKSk7Ly8kTk9OLU5MUy0xJAogCQlmb3JTdGF0ZW1l
bnQuaW5pdGlhbGl6ZXJzKCkuYWRkKHZhcmlhYmxlRGVjbGFyYXRpb25FeHByZXNzaW9uKTsKQEAg
LTI4MjUsNyArMjgzMyw4IEBACiAJCVZhcmlhYmxlRGVjbGFyYXRpb25GcmFnbWVudCB2YXJpYWJs
ZURlY2xhcmF0aW9uRnJhZ21lbnQgPSB0aGlzLmFzdC5uZXdWYXJpYWJsZURlY2xhcmF0aW9uRnJh
Z21lbnQoKTsKIAkJdmFyaWFibGVEZWNsYXJhdGlvbkZyYWdtZW50LnNldE5hbWUodGhpcy5hc3Qu
bmV3U2ltcGxlTmFtZSgidGFiIikpOyAvLyROT04tTkxTLTEkCiAJCXZhcmlhYmxlRGVjbGFyYXRp
b25GcmFnbWVudC5zZXRJbml0aWFsaXplcih0aGlzLmFzdC5uZXdOdWxsTGl0ZXJhbCgpKTsvLyRO
T04tTkxTLTEkCi0JCXZhcmlhYmxlRGVjbGFyYXRpb25GcmFnbWVudC5zZXRFeHRyYURpbWVuc2lv
bnMoMSk7CisJCXZhcmlhYmxlRGVjbGFyYXRpb25GcmFnbWVudC5nZXRFeHRyYURpbWVuc2lvblR5
cGVzKCkuY2xlYXIoKTsKKwkJdmFyaWFibGVEZWNsYXJhdGlvbkZyYWdtZW50LmdldEV4dHJhRGlt
ZW5zaW9uVHlwZXMoKS5hZGQodGhpcy5hc3QubmV3RGltZW5zaW9uVHlwZShudWxsKSk7CiAJCVZh
cmlhYmxlRGVjbGFyYXRpb25FeHByZXNzaW9uIHZhcmlhYmxlRGVjbGFyYXRpb25FeHByZXNzaW9u
ID0gdGhpcy5hc3QubmV3VmFyaWFibGVEZWNsYXJhdGlvbkV4cHJlc3Npb24odmFyaWFibGVEZWNs
YXJhdGlvbkZyYWdtZW50KTsKIAkJdmFyaWFibGVEZWNsYXJhdGlvbkV4cHJlc3Npb24uc2V0VHlw
ZSh0aGlzLmFzdC5uZXdTaW1wbGVUeXBlKHRoaXMuYXN0Lm5ld1NpbXBsZU5hbWUoIlN0cmluZyIp
KSk7Ly8kTk9OLU5MUy0xJAogCQlmb3JTdGF0ZW1lbnQuaW5pdGlhbGl6ZXJzKCkuYWRkKHZhcmlh
YmxlRGVjbGFyYXRpb25FeHByZXNzaW9uKTsKQEAgLTI4NTMsNyArMjg2Miw4IEBACiAJCVZhcmlh
YmxlRGVjbGFyYXRpb25GcmFnbWVudCB2YXJpYWJsZURlY2xhcmF0aW9uRnJhZ21lbnQgPSB0aGlz
LmFzdC5uZXdWYXJpYWJsZURlY2xhcmF0aW9uRnJhZ21lbnQoKTsKIAkJdmFyaWFibGVEZWNsYXJh
dGlvbkZyYWdtZW50LnNldE5hbWUodGhpcy5hc3QubmV3U2ltcGxlTmFtZSgidGFiIikpOyAvLyRO
T04tTkxTLTEkCiAJCXZhcmlhYmxlRGVjbGFyYXRpb25GcmFnbWVudC5zZXRJbml0aWFsaXplcih0
aGlzLmFzdC5uZXdOdWxsTGl0ZXJhbCgpKTsvLyROT04tTkxTLTEkCi0JCXZhcmlhYmxlRGVjbGFy
YXRpb25GcmFnbWVudC5zZXRFeHRyYURpbWVuc2lvbnMoMSk7CisJCXZhcmlhYmxlRGVjbGFyYXRp
b25GcmFnbWVudC5nZXRFeHRyYURpbWVuc2lvblR5cGVzKCkuY2xlYXIoKTsKKwkJdmFyaWFibGVE
ZWNsYXJhdGlvbkZyYWdtZW50LmdldEV4dHJhRGltZW5zaW9uVHlwZXMoKS5hZGQodGhpcy5hc3Qu
bmV3RGltZW5zaW9uVHlwZShudWxsKSk7CiAJCVZhcmlhYmxlRGVjbGFyYXRpb25FeHByZXNzaW9u
IHZhcmlhYmxlRGVjbGFyYXRpb25FeHByZXNzaW9uID0gdGhpcy5hc3QubmV3VmFyaWFibGVEZWNs
YXJhdGlvbkV4cHJlc3Npb24odmFyaWFibGVEZWNsYXJhdGlvbkZyYWdtZW50KTsKIAkJdmFyaWFi
bGVEZWNsYXJhdGlvbkV4cHJlc3Npb24uc2V0VHlwZSh0aGlzLmFzdC5uZXdTaW1wbGVUeXBlKHRo
aXMuYXN0Lm5ld1NpbXBsZU5hbWUoIlN0cmluZyIpKSk7Ly8kTk9OLU5MUy0xJAogCQlmb3JTdGF0
ZW1lbnQuaW5pdGlhbGl6ZXJzKCkuYWRkKHZhcmlhYmxlRGVjbGFyYXRpb25FeHByZXNzaW9uKTsK
QEAgLTI4ODIsNyArMjg5Miw3IEBACiAJCWFzc2VydFRydWUoIk5vdCBhIGRlY2xhcmF0aW9uIiwg
ZnJhZy5nZXROYW1lKCkuaXNEZWNsYXJhdGlvbigpKTsgLy8kTk9OLU5MUy0xJAogCQlWYXJpYWJs
ZURlY2xhcmF0aW9uRnJhZ21lbnQgZnJhZ21lbnQgPSB0aGlzLmFzdC5uZXdWYXJpYWJsZURlY2xh
cmF0aW9uRnJhZ21lbnQoKTsKIAkJZnJhZ21lbnQuc2V0TmFtZSh0aGlzLmFzdC5uZXdTaW1wbGVO
YW1lKCJpIikpOyAvLyROT04tTkxTLTEkCi0JCWZyYWdtZW50LnNldEV4dHJhRGltZW5zaW9ucygw
KTsKKwkJZnJhZ21lbnQuZ2V0RXh0cmFEaW1lbnNpb25UeXBlcygpLmNsZWFyKCk7CiAJCUZpZWxk
RGVjbGFyYXRpb24gZmllbGREZWNsYXJhdGlvbiA9IHRoaXMuYXN0Lm5ld0ZpZWxkRGVjbGFyYXRp
b24oZnJhZ21lbnQpOwogCQlmaWVsZERlY2xhcmF0aW9uLnNldFR5cGUodGhpcy5hc3QubmV3UHJp
bWl0aXZlVHlwZShQcmltaXRpdmVUeXBlLklOVCkpOwogCQlhc3NlcnRUcnVlKCJCb3RoIEFTVCB0
cmVlcyBzaG91bGQgYmUgaWRlbnRpY2FsIiwgZmllbGREZWNsYXJhdGlvbi5zdWJ0cmVlTWF0Y2go
bmV3IEFTVE1hdGNoZXIoKSwgbm9kZSkpOwkJLy8kTk9OLU5MUy0xJApAQCAtMjkwNCwyMiArMjkx
NCwyNSBAQAogCQlOdW1iZXJMaXRlcmFsIGxpdGVyYWwgPSB0aGlzLmFzdC5uZXdOdW1iZXJMaXRl
cmFsKCk7CiAJCWxpdGVyYWwuc2V0VG9rZW4oIjEwIik7IC8vJE5PTi1OTFMtMSQKIAkJZnJhZ21l
bnQuc2V0SW5pdGlhbGl6ZXIobGl0ZXJhbCk7Ci0JCWZyYWdtZW50LnNldEV4dHJhRGltZW5zaW9u
cygwKTsKKwkJZnJhZ21lbnQuZ2V0RXh0cmFEaW1lbnNpb25UeXBlcygpLmNsZWFyKCk7CiAJCUZp
ZWxkRGVjbGFyYXRpb24gZmllbGREZWNsYXJhdGlvbiA9IHRoaXMuYXN0Lm5ld0ZpZWxkRGVjbGFy
YXRpb24oZnJhZ21lbnQpOwogCQlmaWVsZERlY2xhcmF0aW9uLm1vZGlmaWVycygpLmFkZCh0aGlz
LmFzdC5uZXdNb2RpZmllcihNb2RpZmllci5Nb2RpZmllcktleXdvcmQuUFVCTElDX0tFWVdPUkQp
KTsKIAkJZmllbGREZWNsYXJhdGlvbi5zZXRUeXBlKHRoaXMuYXN0Lm5ld1ByaW1pdGl2ZVR5cGUo
UHJpbWl0aXZlVHlwZS5JTlQpKTsKIAkJZnJhZ21lbnQgPSB0aGlzLmFzdC5uZXdWYXJpYWJsZURl
Y2xhcmF0aW9uRnJhZ21lbnQoKTsKIAkJZnJhZ21lbnQuc2V0TmFtZSh0aGlzLmFzdC5uZXdTaW1w
bGVOYW1lKCJ5IikpOy8vJE5PTi1OTFMtMSQKLQkJZnJhZ21lbnQuc2V0RXh0cmFEaW1lbnNpb25z
KDEpOworCQlmcmFnbWVudC5nZXRFeHRyYURpbWVuc2lvblR5cGVzKCkuY2xlYXIoKTsKKwkJZnJh
Z21lbnQuZ2V0RXh0cmFEaW1lbnNpb25UeXBlcygpLmFkZCh0aGlzLmFzdC5uZXdEaW1lbnNpb25U
eXBlKG51bGwpKTsKIAkJZnJhZ21lbnQuc2V0SW5pdGlhbGl6ZXIodGhpcy5hc3QubmV3TnVsbExp
dGVyYWwoKSk7CiAJCWZpZWxkRGVjbGFyYXRpb24uZnJhZ21lbnRzKCkuYWRkKGZyYWdtZW50KTsK
IAkJZnJhZ21lbnQgPSB0aGlzLmFzdC5uZXdWYXJpYWJsZURlY2xhcmF0aW9uRnJhZ21lbnQoKTsK
IAkJZnJhZ21lbnQuc2V0TmFtZSh0aGlzLmFzdC5uZXdTaW1wbGVOYW1lKCJpIikpOy8vJE5PTi1O
TFMtMSQKLQkJZnJhZ21lbnQuc2V0RXh0cmFEaW1lbnNpb25zKDApOworCQlmcmFnbWVudC5nZXRF
eHRyYURpbWVuc2lvblR5cGVzKCkuY2xlYXIoKTsKIAkJZmllbGREZWNsYXJhdGlvbi5mcmFnbWVu
dHMoKS5hZGQoZnJhZ21lbnQpOwogCQlmcmFnbWVudCA9IHRoaXMuYXN0Lm5ld1ZhcmlhYmxlRGVj
bGFyYXRpb25GcmFnbWVudCgpOwogCQlmcmFnbWVudC5zZXROYW1lKHRoaXMuYXN0Lm5ld1NpbXBs
ZU5hbWUoImoiKSk7Ly8kTk9OLU5MUy0xJAotCQlmcmFnbWVudC5zZXRFeHRyYURpbWVuc2lvbnMo
Mik7CisJCWZyYWdtZW50LmdldEV4dHJhRGltZW5zaW9uVHlwZXMoKS5jbGVhcigpOworCQlmcmFn
bWVudC5nZXRFeHRyYURpbWVuc2lvblR5cGVzKCkuYWRkKHRoaXMuYXN0Lm5ld0RpbWVuc2lvblR5
cGUobnVsbCkpOworCQlmcmFnbWVudC5nZXRFeHRyYURpbWVuc2lvblR5cGVzKCkuYWRkKHRoaXMu
YXN0Lm5ld0RpbWVuc2lvblR5cGUobnVsbCkpOwogCQlmaWVsZERlY2xhcmF0aW9uLmZyYWdtZW50
cygpLmFkZChmcmFnbWVudCk7CiAJCWFzc2VydFRydWUoIkJvdGggQVNUIHRyZWVzIHNob3VsZCBi
ZSBpZGVudGljYWwiLCBmaWVsZERlY2xhcmF0aW9uLnN1YnRyZWVNYXRjaChuZXcgQVNUTWF0Y2hl
cigpLCBub2RlKSk7CQkvLyROT04tTkxTLTEkCiAJCWNoZWNrU291cmNlUmFuZ2Uobm9kZSwgInB1
YmxpYyBpbnQgeD0gMTAsIHlbXSA9IG51bGwsIGksIGpbXVtdOyIsIHNvdXJjZSk7IC8vJE5PTi1O
TFMtMSQKQEAgLTk1OTEsNiArOTYwNCw4IEBACiAJCWFzc2VydE5vdE51bGwoIk5vIHR5cGUgYmlu
ZGluZyIsIHR5cGVCaW5kaW5nMik7IC8vJE5PTi1OTFMtMSQKIAkJYXNzZXJ0RXF1YWxzKCJXcm9u
ZyBxdWFsaWZpZWQgbmFtZSIsICJqYXZhLmxhbmcuU3RyaW5nW10iLCB0eXBlQmluZGluZzIuZ2V0
UXVhbGlmaWVkTmFtZSgpKTsgLy8kTk9OLU5MUy0xJCAvLyROT04tTkxTLTIkCiAJCWFzc2VydEVx
dWFscygiV3JvbmcgZGltZW5zaW9uIiwgMSwgdHlwZUJpbmRpbmcyLmdldERpbWVuc2lvbnMoKSk7
IC8vJE5PTi1OTFMtMSQKKwkJTGlzdCBleHRyYURpbWVuc2lvbnMgPSBtZXRob2REZWNsYXJhdGlv
bi5nZXRleHRyYURpbWVuc2lvblR5cGVzKCk7CisJCWFzc2VydEV4dHJhRGltZW5zaW9uc0VxdWFs
KCJXcm9uZyBleHRyYSBkaW1lbnNpb24gaW5mbyIsIGV4dHJhRGltZW5zaW9ucywgIltdICIpOwog
CX0KIAogCS8qKgpAQCAtOTY2Myw3ICs5Njc4LDcgQEAKIAkJY2hlY2tTb3VyY2VSYW5nZShzaW5n
bGVWYXJpYWJsZURlY2xhcmF0aW9uLCAiZmluYWwgU3RyaW5nIHNbXSIsIHNvdXJjZSk7IC8vJE5P
Ti1OTFMtMSQKIAkJVHlwZSB0eXBlID0gc2luZ2xlVmFyaWFibGVEZWNsYXJhdGlvbi5nZXRUeXBl
KCk7CiAJCWNoZWNrU291cmNlUmFuZ2UodHlwZSwgIlN0cmluZyIsIHNvdXJjZSk7IC8vJE5PTi1O
TFMtMSQKLQkJYXNzZXJ0RXF1YWxzKCJXcm9uZyBkaW1lbnNpb24iLCAxLCBzaW5nbGVWYXJpYWJs
ZURlY2xhcmF0aW9uLmdldEV4dHJhRGltZW5zaW9ucygpKTsgLy8kTk9OLU5MUy0xJAorCQlhc3Nl
cnRFcXVhbHMoIldyb25nIGRpbWVuc2lvbiIsIDEsIHNpbmdsZVZhcmlhYmxlRGVjbGFyYXRpb24u
Z2V0RXh0cmFEaW1lbnNpb25UeXBlcygpLnNpemUoKSk7IC8vJE5PTi1OTFMtMSQKIAkJSVR5cGVC
aW5kaW5nIHR5cGVCaW5kaW5nID0gdHlwZS5yZXNvbHZlQmluZGluZygpOwogCQlhc3NlcnROb3RO
dWxsKCJObyB0eXBlIGJpbmRpbmciLCB0eXBlQmluZGluZyk7IC8vJE5PTi1OTFMtMSQKIAkJYXNz
ZXJ0VHJ1ZSgiQW4gYXJyYXkgYmluZGluZyIsICF0eXBlQmluZGluZy5pc0FycmF5KCkpOyAvLyRO
T04tTkxTLTEkCkBAIC05Njc3LDYgKzk2OTIsOCBAQAogCQlhc3NlcnRUcnVlKCJOb3QgYW4gYXJy
YXkgYmluZGluZyIsIHR5cGVCaW5kaW5nMi5pc0FycmF5KCkpOyAvLyROT04tTkxTLTEkCiAJCWFz
c2VydEVxdWFscygiV3JvbmcgZGltZW5zaW9uIiwgMSwgdHlwZUJpbmRpbmcyLmdldERpbWVuc2lv
bnMoKSk7IC8vJE5PTi1OTFMtMSQKIAkJYXNzZXJ0RXF1YWxzKCJ3cm9uZyBmdWxseSBxdWFsaWZp
ZWQgbmFtZSIsICJqYXZhLmxhbmcuU3RyaW5nW10iLCB0eXBlQmluZGluZzIuZ2V0UXVhbGlmaWVk
TmFtZSgpKTsgLy8kTk9OLU5MUy0xJCAvLyROT04tTkxTLTIkCisJCUxpc3QgZXh0cmFEaW1lbnNp
b25zID0gc2luZ2xlVmFyaWFibGVEZWNsYXJhdGlvbi5nZXRFeHRyYURpbWVuc2lvblR5cGVzKCk7
CisJCWFzc2VydEV4dHJhRGltZW5zaW9uc0VxdWFsKCJXcm9uZyBleHRyYSBkaW1lbnNpb24gaW5m
byIsIGV4dHJhRGltZW5zaW9ucywgIltdICIpOwogCX0KIAogCS8qKgpAQCAtOTY5NSw3ICs5NzEy
LDcgQEAKIAkJY2hlY2tTb3VyY2VSYW5nZShzaW5nbGVWYXJpYWJsZURlY2xhcmF0aW9uLCAiZmlu
YWwgU3RyaW5nW10gXFx1MDA3M1xcdTAwNUJdW10iLCBzb3VyY2UpOyAvLyROT04tTkxTLTEkCiAJ
CVR5cGUgdHlwZSA9IHNpbmdsZVZhcmlhYmxlRGVjbGFyYXRpb24uZ2V0VHlwZSgpOwogCQljaGVj
a1NvdXJjZVJhbmdlKHR5cGUsICJTdHJpbmdbXSIsIHNvdXJjZSk7IC8vJE5PTi1OTFMtMSQKLQkJ
YXNzZXJ0RXF1YWxzKCJXcm9uZyBkaW1lbnNpb24iLCAyLCBzaW5nbGVWYXJpYWJsZURlY2xhcmF0
aW9uLmdldEV4dHJhRGltZW5zaW9ucygpKTsgLy8kTk9OLU5MUy0xJAorCQlhc3NlcnRFcXVhbHMo
Ildyb25nIGRpbWVuc2lvbiIsIDIsIHNpbmdsZVZhcmlhYmxlRGVjbGFyYXRpb24uZ2V0RXh0cmFE
aW1lbnNpb25UeXBlcygpLnNpemUoKSk7IC8vJE5PTi1OTFMtMSQKIAkJSVR5cGVCaW5kaW5nIHR5
cGVCaW5kaW5nID0gdHlwZS5yZXNvbHZlQmluZGluZygpOwogCQlhc3NlcnROb3ROdWxsKCJObyB0
eXBlIGJpbmRpbmciLCB0eXBlQmluZGluZyk7IC8vJE5PTi1OTFMtMSQKIAkJYXNzZXJ0VHJ1ZSgi
Tm90IGFuIGFycmF5IGJpbmRpbmciLCB0eXBlQmluZGluZy5pc0FycmF5KCkpOyAvLyROT04tTkxT
LTEkCmRpZmYgLS1naXQgYS9vcmcuZWNsaXBzZS5qZHQuY29yZS50ZXN0cy5tb2RlbC9zcmMvb3Jn
L2VjbGlwc2UvamR0L2NvcmUvdGVzdHMvZG9tL0FTVENvbnZlcnRlclRlc3RBU1Q4XzIuamF2YSBi
L29yZy5lY2xpcHNlLmpkdC5jb3JlLnRlc3RzLm1vZGVsL3NyYy9vcmcvZWNsaXBzZS9qZHQvY29y
ZS90ZXN0cy9kb20vQVNUQ29udmVydGVyVGVzdEFTVDhfMi5qYXZhCmluZGV4IGM3MjVjYjcuLjFj
N2M2MWIgMTAwNjQ0Ci0tLSBhL29yZy5lY2xpcHNlLmpkdC5jb3JlLnRlc3RzLm1vZGVsL3NyYy9v
cmcvZWNsaXBzZS9qZHQvY29yZS90ZXN0cy9kb20vQVNUQ29udmVydGVyVGVzdEFTVDhfMi5qYXZh
CisrKyBiL29yZy5lY2xpcHNlLmpkdC5jb3JlLnRlc3RzLm1vZGVsL3NyYy9vcmcvZWNsaXBzZS9q
ZHQvY29yZS90ZXN0cy9kb20vQVNUQ29udmVydGVyVGVzdEFTVDhfMi5qYXZhCkBAIC0yNzgzLDcg
KzI3ODMsNyBAQAogCQlMaXN0IGZyYWdtZW50cyA9IGZpZWxkRGVjbGFyYXRpb24uZnJhZ21lbnRz
KCk7CiAJCWFzc2VydEVxdWFscygid3Jvbmcgc2l6ZSIsIDEsIGZyYWdtZW50cy5zaXplKCkpOwog
CQlWYXJpYWJsZURlY2xhcmF0aW9uRnJhZ21lbnQgZnJhZ21lbnQgPSAoVmFyaWFibGVEZWNsYXJh
dGlvbkZyYWdtZW50KSBmcmFnbWVudHMuZ2V0KDApOwotCQlhc3NlcnRFcXVhbHMoIndyb25nIGV4
dHJhIGRpbWVuc2lvbiIsIDEsIGZyYWdtZW50LmdldEV4dHJhRGltZW5zaW9ucygpKTsKKwkJYXNz
ZXJ0RXF1YWxzKCJ3cm9uZyBleHRyYSBkaW1lbnNpb24iLCAxLCBmcmFnbWVudC5nZXRFeHRyYURp
bWVuc2lvblR5cGVzKCkuc2l6ZSgpKTsKIAl9CiAKIAkvKioKZGlmZiAtLWdpdCBhL29yZy5lY2xp
cHNlLmpkdC5jb3JlLnRlc3RzLm1vZGVsL3NyYy9vcmcvZWNsaXBzZS9qZHQvY29yZS90ZXN0cy9k
b20vQ29udmVydGVyVGVzdFNldHVwLmphdmEgYi9vcmcuZWNsaXBzZS5qZHQuY29yZS50ZXN0cy5t
b2RlbC9zcmMvb3JnL2VjbGlwc2UvamR0L2NvcmUvdGVzdHMvZG9tL0NvbnZlcnRlclRlc3RTZXR1
cC5qYXZhCmluZGV4IGNkYmM0YTAuLmQxMjFmOTEgMTAwNjQ0Ci0tLSBhL29yZy5lY2xpcHNlLmpk
dC5jb3JlLnRlc3RzLm1vZGVsL3NyYy9vcmcvZWNsaXBzZS9qZHQvY29yZS90ZXN0cy9kb20vQ29u
dmVydGVyVGVzdFNldHVwLmphdmEKKysrIGIvb3JnLmVjbGlwc2UuamR0LmNvcmUudGVzdHMubW9k
ZWwvc3JjL29yZy9lY2xpcHNlL2pkdC9jb3JlL3Rlc3RzL2RvbS9Db252ZXJ0ZXJUZXN0U2V0dXAu
amF2YQpAQCAtMSw1ICsxLDUgQEAKIC8qKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioq
KioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqCi0gKiBDb3B5cmln
aHQgKGMpIDIwMDAsIDIwMTIgSUJNIENvcnBvcmF0aW9uIGFuZCBvdGhlcnMuCisgKiBDb3B5cmln
aHQgKGMpIDIwMDAsIDIwMTMgSUJNIENvcnBvcmF0aW9uIGFuZCBvdGhlcnMuCiAgKiBBbGwgcmln
aHRzIHJlc2VydmVkLiBUaGlzIHByb2dyYW0gYW5kIHRoZSBhY2NvbXBhbnlpbmcgbWF0ZXJpYWxz
CiAgKiBhcmUgbWFkZSBhdmFpbGFibGUgdW5kZXIgdGhlIHRlcm1zIG9mIHRoZSBFY2xpcHNlIFB1
YmxpYyBMaWNlbnNlIHYxLjAKICAqIHdoaWNoIGFjY29tcGFuaWVzIHRoaXMgZGlzdHJpYnV0aW9u
LCBhbmQgaXMgYXZhaWxhYmxlIGF0CkBAIC0xNSw2ICsxNSw3IEBACiBwYWNrYWdlIG9yZy5lY2xp
cHNlLmpkdC5jb3JlLnRlc3RzLmRvbTsKIAogaW1wb3J0IGphdmEuaW8uSU9FeGNlcHRpb247Citp
bXBvcnQgamF2YS51dGlsLkl0ZXJhdG9yOwogaW1wb3J0IGphdmEudXRpbC5MaXN0OwogaW1wb3J0
IGphdmEudXRpbC5NYXA7CiAKQEAgLTE0MSw2ICsxNDIsMjIgQEAKIAkJfQogCX0KIAorCXByb3Rl
Y3RlZCB2b2lkIGFzc2VydEV4dHJhRGltZW5zaW9uc0VxdWFsKFN0cmluZyBtZXNzYWdlLCBMaXN0
IGRpbWVuc2lvbnMsIFN0cmluZyBleHBlY3RlZCkgeworCQlTdHJpbmdCdWZmZXIgYnVmZmVyID0g
bmV3IFN0cmluZ0J1ZmZlcigpOworCQlJdGVyYXRvciBpdGVyID0gZGltZW5zaW9ucy5pdGVyYXRv
cigpOworCQl3aGlsZShpdGVyLmhhc05leHQoKSkgeworCQkJRGltZW5zaW9uVHlwZSBkaW0gPSAo
RGltZW5zaW9uVHlwZSkgaXRlci5uZXh0KCk7CisJCQlJdGVyYXRvciBhbm5vdGF0aW9ucyA9IGRp
bS5hbm5vdGF0aW9ucygpLml0ZXJhdG9yKCk7CisJCQl3aGlsZSAoYW5ub3RhdGlvbnMuaGFzTmV4
dCgpKSB7CisJCQkJYnVmZmVyLmFwcGVuZCgnQCcpOworCQkJCWJ1ZmZlci5hcHBlbmQoKChBbm5v
dGF0aW9uKSBhbm5vdGF0aW9ucy5uZXh0KCkpLmdldFR5cGVOYW1lKCkuZ2V0RnVsbHlRdWFsaWZp
ZWROYW1lKCkpOworCQkJCWJ1ZmZlci5hcHBlbmQoJyAnKTsKKwkJCX0KKwkJCWJ1ZmZlci5hcHBl
bmQoIltdICIpOworCQl9CisJCWFzc2VydEVxdWFscyhtZXNzYWdlLCBleHBlY3RlZCwgYnVmZmVy
LnRvU3RyaW5nKCkpOworCX0KKwogCXB1YmxpYyBBU1ROb2RlIHJ1bkNvbnZlcnNpb24oSUNvbXBp
bGF0aW9uVW5pdCB1bml0LCBib29sZWFuIHJlc29sdmVCaW5kaW5ncywKIAkJCWJvb2xlYW4gYmlu
ZGluZ3NSZWNvdmVyeSkgewogCQlyZXR1cm4gcnVuQ29udmVyc2lvbihhc3RJbnRlcm5hbEpMUzIo
KSwgdW5pdCwgcmVzb2x2ZUJpbmRpbmdzLCBmYWxzZSwgYmluZGluZ3NSZWNvdmVyeSk7CmRpZmYg
LS1naXQgYS9vcmcuZWNsaXBzZS5qZHQuY29yZS50ZXN0cy5tb2RlbC93b3Jrc3BhY2UvQ29udmVy
dGVyMTgvc3JjL1guamF2YSBiL29yZy5lY2xpcHNlLmpkdC5jb3JlLnRlc3RzLm1vZGVsL3dvcmtz
cGFjZS9Db252ZXJ0ZXIxOC9zcmMvWC5qYXZhCm5ldyBmaWxlIG1vZGUgMTAwNjQ0CmluZGV4IDAw
MDAwMDAuLjVhMWE4ODgKLS0tIC9kZXYvbnVsbAorKysgYi9vcmcuZWNsaXBzZS5qZHQuY29yZS50
ZXN0cy5tb2RlbC93b3Jrc3BhY2UvQ29udmVydGVyMTgvc3JjL1guamF2YQpAQCAtMCwwICsxLDQg
QEAKK3B1YmxpYyBjbGFzcyBYIHsKKwlwdWJsaWMgdm9pZCBmb28oWCB0aGlzKSB7CisJfQorfQpk
aWZmIC0tZ2l0IGEvb3JnLmVjbGlwc2UuamR0LmNvcmUvZG9tL29yZy9lY2xpcHNlL2pkdC9jb3Jl
L2RvbS9BU1QuamF2YSBiL29yZy5lY2xpcHNlLmpkdC5jb3JlL2RvbS9vcmcvZWNsaXBzZS9qZHQv
Y29yZS9kb20vQVNULmphdmEKaW5kZXggMGQ1YWVkNS4uYTkyY2JlOSAxMDA2NDQKLS0tIGEvb3Jn
LmVjbGlwc2UuamR0LmNvcmUvZG9tL29yZy9lY2xpcHNlL2pkdC9jb3JlL2RvbS9BU1QuamF2YQor
KysgYi9vcmcuZWNsaXBzZS5qZHQuY29yZS9kb20vb3JnL2VjbGlwc2UvamR0L2NvcmUvZG9tL0FT
VC5qYXZhCkBAIC0xLDUgKzEsNSBAQAogLyoqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioq
KioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioKLSAqIENvcHly
aWdodCAoYykgMjAwMCwgMjAxMiBJQk0gQ29ycG9yYXRpb24gYW5kIG90aGVycy4KKyAqIENvcHly
aWdodCAoYykgMjAwMCwgMjAxMyBJQk0gQ29ycG9yYXRpb24gYW5kIG90aGVycy4KICAqIEFsbCBy
aWdodHMgcmVzZXJ2ZWQuIFRoaXMgcHJvZ3JhbSBhbmQgdGhlIGFjY29tcGFueWluZyBtYXRlcmlh
bHMKICAqIGFyZSBtYWRlIGF2YWlsYWJsZSB1bmRlciB0aGUgdGVybXMgb2YgdGhlIEVjbGlwc2Ug
UHVibGljIExpY2Vuc2UgdjEuMAogICogd2hpY2ggYWNjb21wYW5pZXMgdGhpcyBkaXN0cmlidXRp
b24sIGFuZCBpcyBhdmFpbGFibGUgYXQKQEAgLTExMTQsNiArMTExNCwyOCBAQAogCQlyZXN1bHQu
c2V0Q29tcG9uZW50VHlwZShjb21wb25lbnRUeXBlKTsKIAkJcmV0dXJuIHJlc3VsdDsKIAl9CisJ
CisJLyoqCisJICogQ3JlYXRlcyBhbmQgcmV0dXJucyBhIG5ldyB1bnBhcmVudGVkIGFubm90YXRh
YmxlIGRpbWVuc2lvbiB0eXBlIG5vZGUgd2l0aCB0aGUgZ2l2ZW4KKwkgKiBhcnJheSBvZiBhbm5v
dGF0aW9ucy4KKwkgKgorCSAqIEBwYXJhbSBhbm5vdGF0aW9ucyB0aGUgbGlzdCBvZiBhbm5vdGF0
aW9ucyB0aGF0IHdpbGwgYmUgYWRkZWQgdG8gdGhpcyBkaW1lbnNpb24gdHlwZQorCSAqIEByZXR1
cm4gYSBuZXcgdW5wYXJlbnRlZCBhbm5vdGF0YWJsZSBkaW1lbnNpb24gdHlwZSBub2RlCisJICog
QGV4Y2VwdGlvbiBJbGxlZ2FsQXJndW1lbnRFeGNlcHRpb24gaWY6CisJICogPHVsPgorCSAqIDxs
aT50aGUgbm9kZSBiZWxvbmdzIHRvIGEgZGlmZmVyZW50IEFTVDwvbGk+CisJICogPGxpPnRoZSBu
b2RlIGFscmVhZHkgaGFzIGEgcGFyZW50PC9saT4KKwkgKiA8L3VsPgorCSAqIEBzaW5jZSAzLjkK
KwkgKi8KKwlwdWJsaWMgRGltZW5zaW9uVHlwZSBuZXdEaW1lbnNpb25UeXBlKEFubm90YXRpb25b
XSBhbm5vdGF0aW9ucykgeworCQlEaW1lbnNpb25UeXBlIHJlc3VsdCA9IG5ldyBEaW1lbnNpb25U
eXBlKHRoaXMpOworCQlpbnQgbGVuZ3RoID0gKGFubm90YXRpb25zID09IG51bGwpID8gMCA6IGFu
bm90YXRpb25zLmxlbmd0aDsKKwkJZm9yIChpbnQgaSA9IDA7IGkgPCBsZW5ndGg7IGkrKykgewor
CQkJcmVzdWx0LmFubm90YXRpb25zLmFkZChhbm5vdGF0aW9uc1tpXSk7CisJCX0KKwkJcmV0dXJu
IHJlc3VsdDsKKwl9CiAKIAkvKioKIAkgKiBDcmVhdGVzIGFuZCByZXR1cm5zIGEgbmV3IHVucGFy
ZW50ZWQgYXJyYXkgdHlwZSBub2RlIHdpdGggdGhlIGdpdmVuCmRpZmYgLS1naXQgYS9vcmcuZWNs
aXBzZS5qZHQuY29yZS9kb20vb3JnL2VjbGlwc2UvamR0L2NvcmUvZG9tL0FTVENvbnZlcnRlci5q
YXZhIGIvb3JnLmVjbGlwc2UuamR0LmNvcmUvZG9tL29yZy9lY2xpcHNlL2pkdC9jb3JlL2RvbS9B
U1RDb252ZXJ0ZXIuamF2YQppbmRleCAzNjFhY2U2Li5lNDFmOWE5IDEwMDY0NAotLS0gYS9vcmcu
ZWNsaXBzZS5qZHQuY29yZS9kb20vb3JnL2VjbGlwc2UvamR0L2NvcmUvZG9tL0FTVENvbnZlcnRl
ci5qYXZhCisrKyBiL29yZy5lY2xpcHNlLmpkdC5jb3JlL2RvbS9vcmcvZWNsaXBzZS9qZHQvY29y
ZS9kb20vQVNUQ29udmVydGVyLmphdmEKQEAgLTUwOSw2ICs1MDksMTAgQEAKIAkJCQlpbnQgcmln
aHRQYXJlbnRoZXNpc1Bvc2l0aW9uID0gcmV0cmlldmVFbmRPZlJpZ2h0UGFyZW50aGVzaXNQb3Np
dGlvbihlbmQsIG1ldGhvZC5ib2R5RW5kKTsKIAkJCQlpbnQgZXh0cmFEaW1lbnNpb25zID0gcmV0
cmlldmVFeHRyYURpbWVuc2lvbihyaWdodFBhcmVudGhlc2lzUG9zaXRpb24sIG1ldGhvZC5ib2R5
RW5kKTsKIAkJCQltZXRob2REZWNsLnNldEV4dHJhRGltZW5zaW9ucyhleHRyYURpbWVuc2lvbnMp
OworCQkJCS8vIFRPRE86IEFubm90YXRpb25zIG9uIGV4dHJhIGRpbWVuc2lvbnMgdG8gYmUgcmVt
b3ZlZCAoYnVnIDM5MTg5NSwgY29tbWVudCA2KSA/CisJCQkJaWYgKHRoaXMuYXN0LmFwaUxldmVs
ID49IEFTVC5KTFM4KSB7CisJCQkJCXNldEV4dHJhQW5ub3RhdGVkRGltZW5zaW9ucyhyaWdodFBh
cmVudGhlc2lzUG9zaXRpb24sIHRoaXMuc2Nhbm5lci5jdXJyZW50UG9zaXRpb24sICB0eXBlUmVm
ZXJlbmNlLCBtZXRob2REZWNsLmV4dHJhRGltZW5zaW9uVHlwZXMsIGV4dHJhRGltZW5zaW9ucyk7
CisJCQkJfQogCQkJCXNldFR5cGVGb3JNZXRob2REZWNsYXJhdGlvbihtZXRob2REZWNsLCByZXR1
cm5UeXBlLCBleHRyYURpbWVuc2lvbnMpOwogCQkJfSBlbHNlIHsKIAkJCQkvLyBubyByZXR1cm4g
dHlwZSBmb3IgYSBtZXRob2QgdGhhdCBpcyBub3QgYSBjb25zdHJ1Y3RvcgpAQCAtODI5LDcgKzgz
MywxMSBAQAogCQl2YXJpYWJsZURlY2wuc2V0TmFtZShuYW1lKTsKIAkJZmluYWwgaW50IHR5cGVT
b3VyY2VFbmQgPSBhcmd1bWVudC50eXBlLnNvdXJjZUVuZDsKIAkJZmluYWwgaW50IGV4dHJhRGlt
ZW5zaW9ucyA9IHJldHJpZXZlRXh0cmFEaW1lbnNpb24obmFtZUVuZCArIDEsIHR5cGVTb3VyY2VF
bmQpOwotCQl2YXJpYWJsZURlY2wuc2V0RXh0cmFEaW1lbnNpb25zKGV4dHJhRGltZW5zaW9ucyk7
CisJCWlmICh0aGlzLmFzdC5hcGlMZXZlbCA+PSBBU1QuSkxTOCkgeworCQkJc2V0RXh0cmFBbm5v
dGF0ZWREaW1lbnNpb25zKG5hbWVFbmQgKyAxLCB0aGlzLnNjYW5uZXIuY3VycmVudFBvc2l0aW9u
LCAgYXJndW1lbnQudHlwZSwgdmFyaWFibGVEZWNsLmV4dHJhRGltZW5zaW9uVHlwZXMsIGV4dHJh
RGltZW5zaW9ucyk7CisJCX0gZWxzZSB7CisJCQl2YXJpYWJsZURlY2wuc2V0RXh0cmFEaW1lbnNp
b25zKGV4dHJhRGltZW5zaW9ucyk7CisJCX0KIAkJZmluYWwgYm9vbGVhbiBpc1ZhckFyZ3MgPSBh
cmd1bWVudC5pc1ZhckFyZ3MoKTsKIAkJaWYgKGlzVmFyQXJncyAmJiBleHRyYURpbWVuc2lvbnMg
PT0gMCkgewogCQkJLy8gcmVtb3ZlIHRoZSBlbGxpcHNpcyBmcm9tIHRoZSB0eXBlIHNvdXJjZSBl
bmQKQEAgLTI5NDQsNyArMjk1Miw4IEBACiAJCX0KIAkJZmllbGREZWNsYXJhdGlvbi5zZXRTb3Vy
Y2VSYW5nZShmaWVsZERlY2wuZGVjbGFyYXRpb25Tb3VyY2VTdGFydCwgZmllbGREZWNsLmRlY2xh
cmF0aW9uRW5kIC0gZmllbGREZWNsLmRlY2xhcmF0aW9uU291cmNlU3RhcnQgKyAxKTsKIAkJVHlw
ZSB0eXBlID0gY29udmVydFR5cGUoZmllbGREZWNsLnR5cGUpOwotCQlzZXRUeXBlRm9yRmllbGQo
ZmllbGREZWNsYXJhdGlvbiwgdHlwZSwgdmFyaWFibGVEZWNsYXJhdGlvbkZyYWdtZW50LmdldEV4
dHJhRGltZW5zaW9ucygpKTsKKwkJc2V0VHlwZUZvckZpZWxkKGZpZWxkRGVjbGFyYXRpb24sIHR5
cGUsIAorCQkJCSh0aGlzLmFzdC5hcGlMZXZlbCA8IEFTVC5KTFM4KSA/IHZhcmlhYmxlRGVjbGFy
YXRpb25GcmFnbWVudC5nZXRFeHRyYURpbWVuc2lvbnMoKSA6IHZhcmlhYmxlRGVjbGFyYXRpb25G
cmFnbWVudC5nZXRFeHRyYURpbWVuc2lvblR5cGVzKCkuc2l6ZSgpKTsKIAkJc2V0TW9kaWZpZXJz
KGZpZWxkRGVjbGFyYXRpb24sIGZpZWxkRGVjbCk7CiAJCWNvbnZlcnQoZmllbGREZWNsLmphdmFk
b2MsIGZpZWxkRGVjbGFyYXRpb24pOwogCQlyZXR1cm4gZmllbGREZWNsYXJhdGlvbjsKQEAgLTI5
NzUsNyArMjk4NCw4IEBACiAJCX0KIAkJdmFyaWFibGVEZWNsYXJhdGlvbkV4cHJlc3Npb24uc2V0
U291cmNlUmFuZ2UobG9jYWxEZWNsYXJhdGlvbi5kZWNsYXJhdGlvblNvdXJjZVN0YXJ0LCBsb2Nh
bERlY2xhcmF0aW9uLmRlY2xhcmF0aW9uU291cmNlRW5kIC0gbG9jYWxEZWNsYXJhdGlvbi5kZWNs
YXJhdGlvblNvdXJjZVN0YXJ0ICsgMSk7CiAJCVR5cGUgdHlwZSA9IGNvbnZlcnRUeXBlKGxvY2Fs
RGVjbGFyYXRpb24udHlwZSk7Ci0JCXNldFR5cGVGb3JWYXJpYWJsZURlY2xhcmF0aW9uRXhwcmVz
c2lvbih2YXJpYWJsZURlY2xhcmF0aW9uRXhwcmVzc2lvbiwgdHlwZSwgdmFyaWFibGVEZWNsYXJh
dGlvbkZyYWdtZW50LmdldEV4dHJhRGltZW5zaW9ucygpKTsKKwkJc2V0VHlwZUZvclZhcmlhYmxl
RGVjbGFyYXRpb25FeHByZXNzaW9uKHZhcmlhYmxlRGVjbGFyYXRpb25FeHByZXNzaW9uLCB0eXBl
LCAKKwkJCQkodGhpcy5hc3QuYXBpTGV2ZWwgPCBBU1QuSkxTOCkgPyB2YXJpYWJsZURlY2xhcmF0
aW9uRnJhZ21lbnQuZ2V0RXh0cmFEaW1lbnNpb25zKCkgOiB2YXJpYWJsZURlY2xhcmF0aW9uRnJh
Z21lbnQuZ2V0RXh0cmFEaW1lbnNpb25UeXBlcygpLnNpemUoKSk7CiAJCWlmIChsb2NhbERlY2xh
cmF0aW9uLm1vZGlmaWVyc1NvdXJjZVN0YXJ0ICE9IC0xKSB7CiAJCQlzZXRNb2RpZmllcnModmFy
aWFibGVEZWNsYXJhdGlvbkV4cHJlc3Npb24sIGxvY2FsRGVjbGFyYXRpb24pOwogCQl9CkBAIC0y
OTkyLDcgKzMwMDIsMTEgQEAKIAkJbmFtZS5zZXRTb3VyY2VSYW5nZShzdGFydCwgbmFtZUVuZCAt
IHN0YXJ0ICsgMSk7CiAJCXZhcmlhYmxlRGVjbC5zZXROYW1lKG5hbWUpOwogCQlmaW5hbCBpbnQg
ZXh0cmFEaW1lbnNpb25zID0gcmV0cmlldmVFeHRyYURpbWVuc2lvbihuYW1lRW5kICsgMSwgbG9j
YWxEZWNsYXJhdGlvbi50eXBlLnNvdXJjZUVuZCk7Ci0JCXZhcmlhYmxlRGVjbC5zZXRFeHRyYURp
bWVuc2lvbnMoZXh0cmFEaW1lbnNpb25zKTsKKwkJaWYgKHRoaXMuYXN0LmFwaUxldmVsID49IEFT
VC5KTFM4KSB7CisJCQlzZXRFeHRyYUFubm90YXRlZERpbWVuc2lvbnMobmFtZUVuZCArIDEsIHRo
aXMuc2Nhbm5lci5jdXJyZW50UG9zaXRpb24sICBsb2NhbERlY2xhcmF0aW9uLnR5cGUsIHZhcmlh
YmxlRGVjbC5leHRyYURpbWVuc2lvblR5cGVzLCBleHRyYURpbWVuc2lvbnMpOworCQl9IGVsc2Ug
eworCQkJdmFyaWFibGVEZWNsLnNldEV4dHJhRGltZW5zaW9ucyhleHRyYURpbWVuc2lvbnMpOwor
CQl9CiAJCVR5cGUgdHlwZSA9IGNvbnZlcnRUeXBlKGxvY2FsRGVjbGFyYXRpb24udHlwZSk7CiAJ
CWludCB0eXBlRW5kID0gdHlwZS5nZXRTdGFydFBvc2l0aW9uKCkgKyB0eXBlLmdldExlbmd0aCgp
IC0gMTsKIAkJaW50IHJpZ2h0RW5kID0gTWF0aC5tYXgodHlwZUVuZCwgbG9jYWxEZWNsYXJhdGlv
bi5kZWNsYXJhdGlvblNvdXJjZUVuZCk7CkBAIC0zMDEwLDYgKzMwMjQsMTcgQEAKIAkJcmV0dXJu
IHZhcmlhYmxlRGVjbDsKIAl9CiAKKwlwcml2YXRlIERpbWVuc2lvblR5cGUgY29udmVydFRvRGlt
ZW5zaW9uKGludCBzdGFydCwgaW50IGVuZCwgb3JnLmVjbGlwc2UuamR0LmludGVybmFsLmNvbXBp
bGVyLmFzdC5Bbm5vdGF0aW9uW10gYW5ub3RhdGlvbikgeworCQlpbnQgbGVuZ3RoID0gYW5ub3Rh
dGlvbiA9PSBudWxsID8gMCA6IGFubm90YXRpb24ubGVuZ3RoOworCQlBbm5vdGF0aW9uW10gYW5u
b3RhdGlvbnMgPSBuZXcgQW5ub3RhdGlvbltsZW5ndGhdOworCQlmb3IgKGludCBpID0gMDsgaSA8
IGxlbmd0aDsgaSsrKSB7CisJCQlhbm5vdGF0aW9uc1tpXSA9IGNvbnZlcnQoYW5ub3RhdGlvbltp
XSk7CisJCX0KKwkJRGltZW5zaW9uVHlwZSBkaW1lbnNpb24gPSB0aGlzLmFzdC5uZXdEaW1lbnNp
b25UeXBlKGFubm90YXRpb25zKTsKKwkJcmV0cmlldmVEaW1lbnNpb25BbmRTZXRQb3NpdGlvbnMo
c3RhcnQsIGVuZCwgZGltZW5zaW9uKTsKKwkJcmV0dXJuIGRpbWVuc2lvbjsKKwl9CisKIAlwcm90
ZWN0ZWQgVmFyaWFibGVEZWNsYXJhdGlvbkZyYWdtZW50IGNvbnZlcnRUb1ZhcmlhYmxlRGVjbGFy
YXRpb25GcmFnbWVudChvcmcuZWNsaXBzZS5qZHQuaW50ZXJuYWwuY29tcGlsZXIuYXN0LkZpZWxk
RGVjbGFyYXRpb24gZmllbGREZWNsYXJhdGlvbikgewogCQlmaW5hbCBWYXJpYWJsZURlY2xhcmF0
aW9uRnJhZ21lbnQgdmFyaWFibGVEZWNsYXJhdGlvbkZyYWdtZW50ID0gbmV3IFZhcmlhYmxlRGVj
bGFyYXRpb25GcmFnbWVudCh0aGlzLmFzdCk7CiAJCWZpbmFsIFNpbXBsZU5hbWUgbmFtZSA9IG5l
dyBTaW1wbGVOYW1lKHRoaXMuYXN0KTsKQEAgLTMwMTksNyArMzA0NCwxMSBAQAogCQlpbnQgc3Rh
cnQgPSBmaWVsZERlY2xhcmF0aW9uLnNvdXJjZUVuZDsKIAkJaW50IGVuZCA9IHN0YXJ0OwogCQlp
bnQgZXh0cmFEaW1lbnNpb25zID0gcmV0cmlldmVFeHRyYURpbWVuc2lvbihmaWVsZERlY2xhcmF0
aW9uLnNvdXJjZUVuZCArIDEsIGZpZWxkRGVjbGFyYXRpb24uZGVjbGFyYXRpb25Tb3VyY2VFbmQg
KTsKLQkJdmFyaWFibGVEZWNsYXJhdGlvbkZyYWdtZW50LnNldEV4dHJhRGltZW5zaW9ucyhleHRy
YURpbWVuc2lvbnMpOworCQlpZiAodGhpcy5hc3QuYXBpTGV2ZWwgPj0gQVNULkpMUzgpIHsKKwkJ
CXNldEV4dHJhQW5ub3RhdGVkRGltZW5zaW9ucyhmaWVsZERlY2xhcmF0aW9uLnNvdXJjZUVuZCAr
IDEsIHRoaXMuc2Nhbm5lci5jdXJyZW50UG9zaXRpb24sIGZpZWxkRGVjbGFyYXRpb24udHlwZSwg
dmFyaWFibGVEZWNsYXJhdGlvbkZyYWdtZW50LmV4dHJhRGltZW5zaW9uVHlwZXMsIGV4dHJhRGlt
ZW5zaW9ucyk7CisJCX0gZWxzZSB7CisJCQl2YXJpYWJsZURlY2xhcmF0aW9uRnJhZ21lbnQuc2V0
RXh0cmFEaW1lbnNpb25zKGV4dHJhRGltZW5zaW9ucyk7CisJCX0KIAkJaWYgKGZpZWxkRGVjbGFy
YXRpb24uaW5pdGlhbGl6YXRpb24gIT0gbnVsbCkgewogCQkJZmluYWwgRXhwcmVzc2lvbiBleHBy
ZXNzaW9uID0gY29udmVydChmaWVsZERlY2xhcmF0aW9uLmluaXRpYWxpemF0aW9uKTsKIAkJCXZh
cmlhYmxlRGVjbGFyYXRpb25GcmFnbWVudC5zZXRJbml0aWFsaXplcihleHByZXNzaW9uKTsKQEAg
LTMwNTcsNyArMzA4NiwxMiBAQAogCQlpbnQgc3RhcnQgPSBsb2NhbERlY2xhcmF0aW9uLnNvdXJj
ZUVuZDsKIAkJb3JnLmVjbGlwc2UuamR0LmludGVybmFsLmNvbXBpbGVyLmFzdC5FeHByZXNzaW9u
IGluaXRpYWxpemF0aW9uID0gbG9jYWxEZWNsYXJhdGlvbi5pbml0aWFsaXphdGlvbjsKIAkJaW50
IGV4dHJhRGltZW5zaW9uID0gcmV0cmlldmVFeHRyYURpbWVuc2lvbihsb2NhbERlY2xhcmF0aW9u
LnNvdXJjZUVuZCArIDEsIHRoaXMuY29tcGlsYXRpb25Vbml0U291cmNlTGVuZ3RoKTsKLQkJdmFy
aWFibGVEZWNsYXJhdGlvbkZyYWdtZW50LnNldEV4dHJhRGltZW5zaW9ucyhleHRyYURpbWVuc2lv
bik7CisJCWlmICh0aGlzLmFzdC5hcGlMZXZlbCA+PSBBU1QuSkxTOCkgeworCQkJc2V0RXh0cmFB
bm5vdGF0ZWREaW1lbnNpb25zKGxvY2FsRGVjbGFyYXRpb24uc291cmNlRW5kICsgMSwgdGhpcy5z
Y2FubmVyLmN1cnJlbnRQb3NpdGlvbiwgbG9jYWxEZWNsYXJhdGlvbi50eXBlLCB2YXJpYWJsZURl
Y2xhcmF0aW9uRnJhZ21lbnQuZXh0cmFEaW1lbnNpb25UeXBlcywgZXh0cmFEaW1lbnNpb24pOwor
CQl9IGVsc2UgeworCQkJdmFyaWFibGVEZWNsYXJhdGlvbkZyYWdtZW50LnNldEV4dHJhRGltZW5z
aW9ucyhleHRyYURpbWVuc2lvbik7CisJCX0KKwkJCiAJCWJvb2xlYW4gaGFzSW5pdGlhbGl6YXRp
b24gPSBpbml0aWFsaXphdGlvbiAhPSBudWxsOwogCQlpbnQgZW5kOwogCQlpZiAoaGFzSW5pdGlh
bGl6YXRpb24pIHsKQEAgLTMwODgsNiArMzEyMiwxOCBAQAogCQlyZXR1cm4gdmFyaWFibGVEZWNs
YXJhdGlvbkZyYWdtZW50OwogCX0KIAorCXByb3RlY3RlZCB2b2lkIHNldEV4dHJhQW5ub3RhdGVk
RGltZW5zaW9ucyhpbnQgc3RhcnQsIGludCBlbmQsIFR5cGVSZWZlcmVuY2UgdHlwZSwgZmluYWwg
TGlzdCBleHRyYUFubm90YXRlZERpbWVuc2lvbnMsIGludCBleHRyYURpbWVuc2lvbikgeworCQlp
ZiAoZXh0cmFEaW1lbnNpb24gPiAwKSB7CisJCQlvcmcuZWNsaXBzZS5qZHQuaW50ZXJuYWwuY29t
cGlsZXIuYXN0LkFubm90YXRpb25bXVtdIGFubm90YXRpb25zT25EaW1zID0gdHlwZS5nZXRBbm5v
dGF0aW9uc09uRGltZW5zaW9ucygpOworCQkJaW50IGxlbmd0aCA9IChhbm5vdGF0aW9uc09uRGlt
cyA9PSBudWxsKSA/IDAgOiBhbm5vdGF0aW9uc09uRGltcy5sZW5ndGg7CisJCQlmb3IgKGludCBp
ID0gKGxlbmd0aCAtIGV4dHJhRGltZW5zaW9uKTsgaSA8IGxlbmd0aDsgaSsrKSB7CisJCQkJRGlt
ZW5zaW9uVHlwZSBkaW0gPSBjb252ZXJ0VG9EaW1lbnNpb24oc3RhcnQsIGVuZCwgKGFubm90YXRp
b25zT25EaW1zID09IG51bGwpID8gbnVsbCA6IGFubm90YXRpb25zT25EaW1zW2ldKTsKKwkJCQll
eHRyYUFubm90YXRlZERpbWVuc2lvbnMuYWRkKGRpbSk7CisJCQkJc3RhcnQgPSBkaW0uZ2V0U3Rh
cnRQb3NpdGlvbigpICsgZGltLmdldExlbmd0aCgpOworCQkJfQorCQl9CisJfQorCiAJcHJvdGVj
dGVkIFZhcmlhYmxlRGVjbGFyYXRpb25TdGF0ZW1lbnQgY29udmVydFRvVmFyaWFibGVEZWNsYXJh
dGlvblN0YXRlbWVudChvcmcuZWNsaXBzZS5qZHQuaW50ZXJuYWwuY29tcGlsZXIuYXN0LkxvY2Fs
RGVjbGFyYXRpb24gbG9jYWxEZWNsYXJhdGlvbikgewogCQlmaW5hbCBWYXJpYWJsZURlY2xhcmF0
aW9uRnJhZ21lbnQgdmFyaWFibGVEZWNsYXJhdGlvbkZyYWdtZW50ID0gY29udmVydFRvVmFyaWFi
bGVEZWNsYXJhdGlvbkZyYWdtZW50KGxvY2FsRGVjbGFyYXRpb24pOwogCQlmaW5hbCBWYXJpYWJs
ZURlY2xhcmF0aW9uU3RhdGVtZW50IHZhcmlhYmxlRGVjbGFyYXRpb25TdGF0ZW1lbnQgPSBuZXcg
VmFyaWFibGVEZWNsYXJhdGlvblN0YXRlbWVudCh0aGlzLmFzdCk7CkBAIC0zMDk3LDcgKzMxNDMs
OCBAQAogCQl9CiAJCXZhcmlhYmxlRGVjbGFyYXRpb25TdGF0ZW1lbnQuc2V0U291cmNlUmFuZ2Uo
bG9jYWxEZWNsYXJhdGlvbi5kZWNsYXJhdGlvblNvdXJjZVN0YXJ0LCBsb2NhbERlY2xhcmF0aW9u
LmRlY2xhcmF0aW9uU291cmNlRW5kIC0gbG9jYWxEZWNsYXJhdGlvbi5kZWNsYXJhdGlvblNvdXJj
ZVN0YXJ0ICsgMSk7CiAJCVR5cGUgdHlwZSA9IGNvbnZlcnRUeXBlKGxvY2FsRGVjbGFyYXRpb24u
dHlwZSk7Ci0JCXNldFR5cGVGb3JWYXJpYWJsZURlY2xhcmF0aW9uU3RhdGVtZW50KHZhcmlhYmxl
RGVjbGFyYXRpb25TdGF0ZW1lbnQsIHR5cGUsIHZhcmlhYmxlRGVjbGFyYXRpb25GcmFnbWVudC5n
ZXRFeHRyYURpbWVuc2lvbnMoKSk7CisJCXNldFR5cGVGb3JWYXJpYWJsZURlY2xhcmF0aW9uU3Rh
dGVtZW50KHZhcmlhYmxlRGVjbGFyYXRpb25TdGF0ZW1lbnQsIHR5cGUsIAorCQkJCSh0aGlzLmFz
dC5hcGlMZXZlbCA8IEFTVC5KTFM4KSA/IHZhcmlhYmxlRGVjbGFyYXRpb25GcmFnbWVudC5nZXRF
eHRyYURpbWVuc2lvbnMoKSA6IHZhcmlhYmxlRGVjbGFyYXRpb25GcmFnbWVudC5nZXRFeHRyYURp
bWVuc2lvblR5cGVzKCkuc2l6ZSgpKTsKIAkJaWYgKGxvY2FsRGVjbGFyYXRpb24ubW9kaWZpZXJz
U291cmNlU3RhcnQgIT0gLTEpIHsKIAkJCXNldE1vZGlmaWVycyh2YXJpYWJsZURlY2xhcmF0aW9u
U3RhdGVtZW50LCBsb2NhbERlY2xhcmF0aW9uKTsKIAkJfQpAQCAtNDM0NCwxNCArNDM5MSwyNiBA
QAogCQlpbnQgZGltZW5zaW9ucyA9IDA7CiAJCXRyeSB7CiAJCQlpbnQgdG9rZW47CisJCQlib29s
ZWFuIGlzQW5ub3RhdGlvbiA9IGZhbHNlOwogCQkJd2hpbGUgKCh0b2tlbiA9IHRoaXMuc2Nhbm5l
ci5nZXROZXh0VG9rZW4oKSkgIT0gVGVybWluYWxUb2tlbnMuVG9rZW5OYW1lRU9GKSB7CiAJCQkJ
c3dpdGNoKHRva2VuKSB7CiAJCQkJCWNhc2UgVGVybWluYWxUb2tlbnMuVG9rZW5OYW1lTEJSQUNL
RVQ6CiAJCQkJCWNhc2UgVGVybWluYWxUb2tlbnMuVG9rZW5OYW1lQ09NTUVOVF9CTE9DSzoKIAkJ
CQkJY2FzZSBUZXJtaW5hbFRva2Vucy5Ub2tlbk5hbWVDT01NRU5UX0pBVkFET0M6CiAJCQkJCWNh
c2UgVGVybWluYWxUb2tlbnMuVG9rZW5OYW1lQ09NTUVOVF9MSU5FOgorCQkJCQkJaXNBbm5vdGF0
aW9uID0gZmFsc2U7CisJCQkJCQlicmVhazsKKwkJCQkJY2FzZSBUZXJtaW5hbFRva2Vucy5Ub2tl
bk5hbWVBVDoKKwkJCQkJCWlzQW5ub3RhdGlvbiA9IHRydWU7CisJCQkJCQlicmVhazsKKwkJCQkJ
Y2FzZSBUZXJtaW5hbFRva2Vucy5Ub2tlbk5hbWVJZGVudGlmaWVyOgorCQkJCQkJaWYgKCFpc0Fu
bm90YXRpb24pIHsKKwkJCQkJCQlyZXR1cm4gZGltZW5zaW9uczsKKwkJCQkJCX0KKwkJCQkJCWlz
QW5ub3RhdGlvbiA9IGZhbHNlOwogCQkJCQkJYnJlYWs7CiAJCQkJCWNhc2UgVGVybWluYWxUb2tl
bnMuVG9rZW5OYW1lUkJSQUNLRVQ6Ly8xNjYKKwkJCQkJCWlzQW5ub3RhdGlvbiA9IGZhbHNlOwog
CQkJCQkJZGltZW5zaW9ucysrOwogCQkJCQkJYnJlYWs7CiAJCQkJCWRlZmF1bHQ6CkBAIC00MzY0
LDYgKzQ0MjMsMzIgQEAKIAkJcmV0dXJuIGRpbWVuc2lvbnM7CiAJfQogCisJcHJvdGVjdGVkIHZv
aWQgcmV0cmlldmVEaW1lbnNpb25BbmRTZXRQb3NpdGlvbnMoaW50IHN0YXJ0LCBpbnQgZW5kLCBE
aW1lbnNpb25UeXBlIGRpbSkgeworCQl0aGlzLnNjYW5uZXIucmVzZXRUbyhzdGFydCwgZW5kKTsK
KwkJaW50IHRva2VuOworCQlib29sZWFuIHN0YXJ0U2V0ID0gZmFsc2U7CisJCXRyeSB7CisJCQl3
aGlsZSgodG9rZW4gPSB0aGlzLnNjYW5uZXIuZ2V0TmV4dFRva2VuKCkpICE9IFRlcm1pbmFsVG9r
ZW5zLlRva2VuTmFtZUVPRikgIHsKKwkJCQlzd2l0Y2godG9rZW4pIHsKKwkJCQkJY2FzZSBUZXJt
aW5hbFRva2Vucy5Ub2tlbk5hbWVXSElURVNQQUNFOgorCQkJCQkJYnJlYWs7CisJCQkJCWNhc2Ug
VGVybWluYWxUb2tlbnMuVG9rZW5OYW1lUkJSQUNLRVQ6CisJCQkJCQlpbnQgZW5kRGltID0gdGhp
cy5zY2FubmVyLmN1cnJlbnRQb3NpdGlvbiAtIDE7CisJCQkJCQlkaW0uc2V0U291cmNlUmFuZ2Uo
c3RhcnQsIGVuZERpbSAtIHN0YXJ0ICsgMSk7CisJCQkJCQlyZXR1cm47CisJCQkJCWRlZmF1bHQ6
CisJCQkJCQlpZiAoIXN0YXJ0U2V0KSB7CisJCQkJCQkJc3RhcnQgPSB0aGlzLnNjYW5uZXIuc3Rh
cnRQb3NpdGlvbjsKKwkJCQkJCQlzdGFydFNldCA9IHRydWU7CisJCQkJCQl9CisJCQkJCQlicmVh
azsKKwkJCQkJCQorCQkJCX0KKwkJCX0KKwkJfSBjYXRjaChJbnZhbGlkSW5wdXRFeGNlcHRpb24g
ZSkgeworCQkJLy8gaWdub3JlCisJCX0KKwl9CiAJcHJvdGVjdGVkIHZvaWQgcmV0cmlldmVJZGVu
dGlmaWVyQW5kU2V0UG9zaXRpb25zKGludCBzdGFydCwgaW50IGVuZCwgTmFtZSBuYW1lKSB7CiAJ
CXRoaXMuc2Nhbm5lci5yZXNldFRvKHN0YXJ0LCBlbmQpOwogCQlpbnQgdG9rZW47CkBAIC01Mjc3
LDcgKzUzNjIsNyBAQAogCQkJCQkJCWJyZWFrOwogCQkJCQkJZGVmYXVsdCA6CiAJCQkJCQkJbWV0
aG9kRGVjbGFyYXRpb24uc2V0UmV0dXJuVHlwZTIoc3ViYXJyYXlUeXBlKTsKLQkJCQkJCWJyZWFr
OworCQkJCQkJCWJyZWFrOwogCQkJCQl9CiAJCQkJCXRoaXMuYXN0LmdldEJpbmRpbmdSZXNvbHZl
cigpLnVwZGF0ZUtleSh0eXBlLCBzdWJhcnJheVR5cGUpOwogCQkJCX0KZGlmZiAtLWdpdCBhL29y
Zy5lY2xpcHNlLmpkdC5jb3JlL2RvbS9vcmcvZWNsaXBzZS9qZHQvY29yZS9kb20vQVNUTWF0Y2hl
ci5qYXZhIGIvb3JnLmVjbGlwc2UuamR0LmNvcmUvZG9tL29yZy9lY2xpcHNlL2pkdC9jb3JlL2Rv
bS9BU1RNYXRjaGVyLmphdmEKaW5kZXggOTVjMmU0Ny4uZjZmY2Y5NyAxMDA2NDQKLS0tIGEvb3Jn
LmVjbGlwc2UuamR0LmNvcmUvZG9tL29yZy9lY2xpcHNlL2pkdC9jb3JlL2RvbS9BU1RNYXRjaGVy
LmphdmEKKysrIGIvb3JnLmVjbGlwc2UuamR0LmNvcmUvZG9tL29yZy9lY2xpcHNlL2pkdC9jb3Jl
L2RvbS9BU1RNYXRjaGVyLmphdmEKQEAgLTM1NCw2ICszNTQsMjkgQEAKIAkgKiBAcmV0dXJuIDxj
b2RlPnRydWU8L2NvZGU+IGlmIHRoZSBzdWJ0cmVlIG1hdGNoZXMsIG9yCiAJICogICA8Y29kZT5m
YWxzZTwvY29kZT4gaWYgdGhleSBkbyBub3QgbWF0Y2ggb3IgdGhlIG90aGVyIG9iamVjdCBoYXMg
YQogCSAqICAgZGlmZmVyZW50IG5vZGUgdHlwZSBvciBpcyA8Y29kZT5udWxsPC9jb2RlPgorCSAq
IEBzaW5jZSAzLjkKKwkgKi8KKwlwdWJsaWMgYm9vbGVhbiBtYXRjaChEaW1lbnNpb25UeXBlIG5v
ZGUsIE9iamVjdCBvdGhlcikgeworCQlpZiAoIShvdGhlciBpbnN0YW5jZW9mIERpbWVuc2lvblR5
cGUpKQorCQkJcmV0dXJuIGZhbHNlOworCQlEaW1lbnNpb25UeXBlIG8gPSAoRGltZW5zaW9uVHlw
ZSkgb3RoZXI7CisJCXJldHVybiBzYWZlU3VidHJlZUxpc3RNYXRjaChub2RlLmFubm90YXRpb25z
KCksIG8uYW5ub3RhdGlvbnMoKSkKKwkJCQkmJiBzYWZlU3VidHJlZU1hdGNoKG5vZGUuZXhwcmVz
c2lvbigpLCBvLmV4cHJlc3Npb24oKSk7CisJfQorCisJLyoqCisJICogUmV0dXJucyB3aGV0aGVy
IHRoZSBnaXZlbiBub2RlIGFuZCB0aGUgb3RoZXIgb2JqZWN0IG1hdGNoLgorCSAqIDxwPgorCSAq
IFRoZSBkZWZhdWx0IGltcGxlbWVudGF0aW9uIHByb3ZpZGVkIGJ5IHRoaXMgY2xhc3MgdGVzdHMg
d2hldGhlciB0aGUKKwkgKiBvdGhlciBvYmplY3QgaXMgYSBub2RlIG9mIHRoZSBzYW1lIHR5cGUg
d2l0aCBzdHJ1Y3R1cmFsbHkgaXNvbW9ycGhpYworCSAqIGNoaWxkIHN1YnRyZWVzLiBTdWJjbGFz
c2VzIG1heSBvdmVycmlkZSB0aGlzIG1ldGhvZCBhcyBuZWVkZWQuCisJICogPC9wPgorCSAqCisJ
ICogQHBhcmFtIG5vZGUgdGhlIG5vZGUKKwkgKiBAcGFyYW0gb3RoZXIgdGhlIG90aGVyIG9iamVj
dCwgb3IgPGNvZGU+bnVsbDwvY29kZT4KKwkgKiBAcmV0dXJuIDxjb2RlPnRydWU8L2NvZGU+IGlm
IHRoZSBzdWJ0cmVlIG1hdGNoZXMsIG9yCisJICogICA8Y29kZT5mYWxzZTwvY29kZT4gaWYgdGhl
eSBkbyBub3QgbWF0Y2ggb3IgdGhlIG90aGVyIG9iamVjdCBoYXMgYQorCSAqICAgZGlmZmVyZW50
IG5vZGUgdHlwZSBvciBpcyA8Y29kZT5udWxsPC9jb2RlPgogCSAqLwogCXB1YmxpYyBib29sZWFu
IG1hdGNoKEFzc2VydFN0YXRlbWVudCBub2RlLCBPYmplY3Qgb3RoZXIpIHsKIAkJaWYgKCEob3Ro
ZXIgaW5zdGFuY2VvZiBBc3NlcnRTdGF0ZW1lbnQpKSB7CkBAIC0xMzk5LDEwICsxNDIyLDExIEBA
CiAJCQkJJiYgc2FmZVN1YnRyZWVNYXRjaChub2RlLmdldE5hbWUoKSwgby5nZXROYW1lKCkpCiAJ
CQkJLy8gbi5iLiBjb21wYXJlIHJldHVybiB0eXBlIGV2ZW4gZm9yIGNvbnN0cnVjdG9ycwogCQkJ
CSYmIHNhZmVTdWJ0cmVlTGlzdE1hdGNoKG5vZGUucGFyYW1ldGVycygpLCBvLnBhcmFtZXRlcnMo
KSkKLQkgCQkJJiYgbm9kZS5nZXRFeHRyYURpbWVuc2lvbnMoKSA9PSBvLmdldEV4dHJhRGltZW5z
aW9ucygpCi0JCQkJJiYgKG5vZGUuZ2V0QVNUKCkuYXBpTGV2ZWwoKSA8IEFTVC5KTFM4ID8gCi0J
CQkJCQlzYWZlU3VidHJlZUxpc3RNYXRjaChub2RlLnRocm93bkV4Y2VwdGlvbnMoKSwgby50aHJv
d25FeGNlcHRpb25zKCkpIDoKLQkJCQkJCXNhZmVTdWJ0cmVlTGlzdE1hdGNoKG5vZGUudGhyb3du
RXhjZXB0aW9uVHlwZXMoKSwgby50aHJvd25FeGNlcHRpb25UeXBlcygpKSkKKwkJCQkmJiAoKG5v
ZGUuZ2V0QVNUKCkuYXBpTGV2ZWwgPCBBU1QuSkxTOCkgPworCQkJCQkJCShub2RlLmdldEV4dHJh
RGltZW5zaW9ucygpID09IG8uZ2V0RXh0cmFEaW1lbnNpb25zKCkKKwkJCQkJCQkJJiYgc2FmZVN1
YnRyZWVMaXN0TWF0Y2gobm9kZS50aHJvd25FeGNlcHRpb25zKCksIG8udGhyb3duRXhjZXB0aW9u
cygpKSkgOgorCQkJCQkJCShzYWZlU3VidHJlZUxpc3RNYXRjaChub2RlLmdldGV4dHJhRGltZW5z
aW9uVHlwZXMoKSwgby5nZXRleHRyYURpbWVuc2lvblR5cGVzKCkpCisJCQkJCQkJCSYmIHNhZmVT
dWJ0cmVlTGlzdE1hdGNoKG5vZGUudGhyb3duRXhjZXB0aW9uVHlwZXMoKSwgby50aHJvd25FeGNl
cHRpb25UeXBlcygpKSkpCiAJCQkJJiYgc2FmZVN1YnRyZWVNYXRjaChub2RlLmdldEJvZHkoKSwg
by5nZXRCb2R5KCkpKTsKIAl9CiAKQEAgLTE4NzgsNyArMTkwMiw5IEBACiAJCXJldHVybgogCQkg
ICAgc2FmZVN1YnRyZWVNYXRjaChub2RlLmdldFR5cGUoKSwgby5nZXRUeXBlKCkpCiAJCQkJJiYg
c2FmZVN1YnRyZWVNYXRjaChub2RlLmdldE5hbWUoKSwgby5nZXROYW1lKCkpCi0JIAkJCSYmIG5v
ZGUuZ2V0RXh0cmFEaW1lbnNpb25zKCkgPT0gby5nZXRFeHRyYURpbWVuc2lvbnMoKQorCSAJCQkm
JiAoKG5vZGUuZ2V0QVNUKCkuYXBpTGV2ZWwgPCBBU1QuSkxTOCkgPworCSAJCQkJCShub2RlLmdl
dEV4dHJhRGltZW5zaW9ucygpID09IG8uZ2V0RXh0cmFEaW1lbnNpb25zKCkpIDoKKwkgCQkJCQkJ
c2FmZVN1YnRyZWVMaXN0TWF0Y2gobm9kZS5nZXRFeHRyYURpbWVuc2lvblR5cGVzKCksIG8uZ2V0
RXh0cmFEaW1lbnNpb25UeXBlcygpKSkKIAkJCQkmJiBzYWZlU3VidHJlZU1hdGNoKG5vZGUuZ2V0
SW5pdGlhbGl6ZXIoKSwgby5nZXRJbml0aWFsaXplcigpKQogCQkJCSYmIChsZXZlbCA+PSBBU1Qu
SkxTOCAmJiBub2RlLmlzVmFyYXJncygpKSA/IHNhZmVTdWJ0cmVlTGlzdE1hdGNoKG5vZGUudmFy
YXJnc0Fubm90YXRpb25zKCksIG8udmFyYXJnc0Fubm90YXRpb25zKCkpIDogdHJ1ZTsJCQogCX0K
QEAgLTIzNzEsNyArMjM5Nyw5IEBACiAJCX0KIAkJVmFyaWFibGVEZWNsYXJhdGlvbkZyYWdtZW50
IG8gPSAoVmFyaWFibGVEZWNsYXJhdGlvbkZyYWdtZW50KSBvdGhlcjsKIAkJcmV0dXJuIHNhZmVT
dWJ0cmVlTWF0Y2gobm9kZS5nZXROYW1lKCksIG8uZ2V0TmFtZSgpKQotCQkJJiYgbm9kZS5nZXRF
eHRyYURpbWVuc2lvbnMoKSA9PSBvLmdldEV4dHJhRGltZW5zaW9ucygpCisJCQkmJiAoKG5vZGUu
Z2V0QVNUKCkuYXBpTGV2ZWwgPCBBU1QuSkxTOCkgPworCQkJCQkobm9kZS5nZXRFeHRyYURpbWVu
c2lvbnMoKSA9PSBvLmdldEV4dHJhRGltZW5zaW9ucygpKSA6CisJCQkJCQlzYWZlU3VidHJlZUxp
c3RNYXRjaChub2RlLmdldEV4dHJhRGltZW5zaW9uVHlwZXMoKSwgby5nZXRFeHRyYURpbWVuc2lv
blR5cGVzKCkpKQogCQkJJiYgc2FmZVN1YnRyZWVNYXRjaChub2RlLmdldEluaXRpYWxpemVyKCks
IG8uZ2V0SW5pdGlhbGl6ZXIoKSk7CiAJfQogCmRpZmYgLS1naXQgYS9vcmcuZWNsaXBzZS5qZHQu
Y29yZS9kb20vb3JnL2VjbGlwc2UvamR0L2NvcmUvZG9tL0FTVE5vZGUuamF2YSBiL29yZy5lY2xp
cHNlLmpkdC5jb3JlL2RvbS9vcmcvZWNsaXBzZS9qZHQvY29yZS9kb20vQVNUTm9kZS5qYXZhCmlu
ZGV4IDZlYTQzYmEuLjQ3MWNhODEgMTAwNjQ0Ci0tLSBhL29yZy5lY2xpcHNlLmpkdC5jb3JlL2Rv
bS9vcmcvZWNsaXBzZS9qZHQvY29yZS9kb20vQVNUTm9kZS5qYXZhCisrKyBiL29yZy5lY2xpcHNl
LmpkdC5jb3JlL2RvbS9vcmcvZWNsaXBzZS9qZHQvY29yZS9kb20vQVNUTm9kZS5qYXZhCkBAIC0x
LDUgKzEsNSBAQAogLyoqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioq
KioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioKLSAqIENvcHlyaWdodCAoYykgMjAw
MCwgMjAxMiBJQk0gQ29ycG9yYXRpb24gYW5kIG90aGVycy4KKyAqIENvcHlyaWdodCAoYykgMjAw
MCwgMjAxMyBJQk0gQ29ycG9yYXRpb24gYW5kIG90aGVycy4KICAqIEFsbCByaWdodHMgcmVzZXJ2
ZWQuIFRoaXMgcHJvZ3JhbSBhbmQgdGhlIGFjY29tcGFueWluZyBtYXRlcmlhbHMKICAqIGFyZSBt
YWRlIGF2YWlsYWJsZSB1bmRlciB0aGUgdGVybXMgb2YgdGhlIEVjbGlwc2UgUHVibGljIExpY2Vu
c2UgdjEuMAogICogd2hpY2ggYWNjb21wYW5pZXMgdGhpcyBkaXN0cmlidXRpb24sIGFuZCBpcyBh
dmFpbGFibGUgYXQKQEAgLTc3MSw2ICs3NzEsMTUgQEAKIAkgKiBAc2luY2UgMy43LjEKIAkgKi8K
IAlwdWJsaWMgc3RhdGljIGZpbmFsIGludCBVTklPTl9UWVBFID0gODQ7CisJCisJLyoqCisJICog
Tm9kZSB0eXBlIGNvbnN0YW50IGluZGljYXRpbmcgYSBub2RlIG9mIHR5cGUKKwkgKiA8Y29kZT5E
aW1lbnNpb248L2NvZGU+LgorCSAqIAorCSAqIEBzZWUgRGltZW5zaW9uVHlwZQorCSAqIEBzaW5j
ZSAzLjkKKwkgKi8KKwlwdWJsaWMgc3RhdGljIGZpbmFsIGludCBESU1FTlNJT05fVFlQRSA9IDg1
OwogCiAJLyoqCiAJICogUmV0dXJucyB0aGUgbm9kZSBjbGFzcyBmb3IgdGhlIGNvcnJlc3BvbmRp
bmcgbm9kZSB0eXBlLgpkaWZmIC0tZ2l0IGEvb3JnLmVjbGlwc2UuamR0LmNvcmUvZG9tL29yZy9l
Y2xpcHNlL2pkdC9jb3JlL2RvbS9BU1RWaXNpdG9yLmphdmEgYi9vcmcuZWNsaXBzZS5qZHQuY29y
ZS9kb20vb3JnL2VjbGlwc2UvamR0L2NvcmUvZG9tL0FTVFZpc2l0b3IuamF2YQppbmRleCBiMjkz
MDUzLi42ZmIxMTY3IDEwMDY0NAotLS0gYS9vcmcuZWNsaXBzZS5qZHQuY29yZS9kb20vb3JnL2Vj
bGlwc2UvamR0L2NvcmUvZG9tL0FTVFZpc2l0b3IuamF2YQorKysgYi9vcmcuZWNsaXBzZS5qZHQu
Y29yZS9kb20vb3JnL2VjbGlwc2UvamR0L2NvcmUvZG9tL0FTVFZpc2l0b3IuamF2YQpAQCAtMSw1
ICsxLDUgQEAKIC8qKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioq
KioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqCi0gKiBDb3B5cmlnaHQgKGMpIDIwMDAs
IDIwMTEgSUJNIENvcnBvcmF0aW9uIGFuZCBvdGhlcnMuCisgKiBDb3B5cmlnaHQgKGMpIDIwMDAs
IDIwMTMgSUJNIENvcnBvcmF0aW9uIGFuZCBvdGhlcnMuCiAgKiBBbGwgcmlnaHRzIHJlc2VydmVk
LiBUaGlzIHByb2dyYW0gYW5kIHRoZSBhY2NvbXBhbnlpbmcgbWF0ZXJpYWxzCiAgKiBhcmUgbWFk
ZSBhdmFpbGFibGUgdW5kZXIgdGhlIHRlcm1zIG9mIHRoZSBFY2xpcHNlIFB1YmxpYyBMaWNlbnNl
IHYxLjAKICAqIHdoaWNoIGFjY29tcGFuaWVzIHRoaXMgZGlzdHJpYnV0aW9uLCBhbmQgaXMgYXZh
aWxhYmxlIGF0CkBAIC0xOTksNiArMTk5LDIyIEBACiAJCXJldHVybiB0cnVlOwogCX0KIAorCS8q
KgorCSAqIFZpc2l0cyB0aGUgZ2l2ZW4gdHlwZS1zcGVjaWZpYyBBU1Qgbm9kZS4KKwkgKiA8cD4K
KwkgKiBUaGUgZGVmYXVsdCBpbXBsZW1lbnRhdGlvbiBkb2VzIG5vdGhpbmcgYW5kIHJldHVybiB0
cnVlLgorCSAqIFN1YmNsYXNzZXMgbWF5IHJlaW1wbGVtZW50LgorCSAqIDwvcD4KKwkgKgorCSAq
IEBwYXJhbSBub2RlIHRoZSBub2RlIHRvIHZpc2l0CisJICogQHJldHVybiA8Y29kZT50cnVlPC9j
b2RlPiBpZiB0aGUgY2hpbGRyZW4gb2YgdGhpcyBub2RlIHNob3VsZCBiZQorCSAqIHZpc2l0ZWQs
IGFuZCA8Y29kZT5mYWxzZTwvY29kZT4gaWYgdGhlIGNoaWxkcmVuIG9mIHRoaXMgbm9kZSBzaG91
bGQKKwkgKiBiZSBza2lwcGVkCisJICogQHNpbmNlIDMuOQorCSAqLworCXB1YmxpYyBib29sZWFu
IHZpc2l0KERpbWVuc2lvblR5cGUgbm9kZSkgeworCQlyZXR1cm4gdHJ1ZTsKKwl9CiAKIAkvKioK
IAkgKiBWaXNpdHMgdGhlIGdpdmVuIHR5cGUtc3BlY2lmaWMgQVNUIG5vZGUuCkBAIC0xNTkyLDYg
KzE2MDgsMTkgQEAKIAlwdWJsaWMgdm9pZCBlbmRWaXNpdChBbm5vdGF0aW9uVHlwZURlY2xhcmF0
aW9uIG5vZGUpIHsKIAkJLy8gZGVmYXVsdCBpbXBsZW1lbnRhdGlvbjogZG8gbm90aGluZwogCX0K
KwkKKwkvKioKKwkgKiBFbmQgb2YgdmlzaXQgdGhlIGdpdmVuIHR5cGUtc3BlY2lmaWMgQVNUIG5v
ZGUuCisJICogPHA+CisJICogVGhlIGRlZmF1bHQgaW1wbGVtZW50YXRpb24gZG9lcyBub3RoaW5n
LiBTdWJjbGFzc2VzIG1heSByZWltcGxlbWVudC4KKwkgKiA8L3A+CisJICoKKwkgKiBAcGFyYW0g
bm9kZSB0aGUgbm9kZSB0byB2aXNpdAorCSAqIEBzaW5jZSAzLjkKKwkgKi8KKwlwdWJsaWMgdm9p
ZCBlbmRWaXNpdChEaW1lbnNpb25UeXBlIG5vZGUpIHsKKwkJLy8gZG8gbm90aGluZyBieSBkZWZh
dWx0CisJfQogCiAJLyoqCiAJICogRW5kIG9mIHZpc2l0IHRoZSBnaXZlbiB0eXBlLXNwZWNpZmlj
IEFTVCBub2RlLgpkaWZmIC0tZ2l0IGEvb3JnLmVjbGlwc2UuamR0LmNvcmUvZG9tL29yZy9lY2xp
cHNlL2pkdC9jb3JlL2RvbS9BcnJheVR5cGUuamF2YSBiL29yZy5lY2xpcHNlLmpkdC5jb3JlL2Rv
bS9vcmcvZWNsaXBzZS9qZHQvY29yZS9kb20vQXJyYXlUeXBlLmphdmEKaW5kZXggZDQ5ZWY1YS4u
YTAxZDk1MiAxMDA2NDQKLS0tIGEvb3JnLmVjbGlwc2UuamR0LmNvcmUvZG9tL29yZy9lY2xpcHNl
L2pkdC9jb3JlL2RvbS9BcnJheVR5cGUuamF2YQorKysgYi9vcmcuZWNsaXBzZS5qZHQuY29yZS9k
b20vb3JnL2VjbGlwc2UvamR0L2NvcmUvZG9tL0FycmF5VHlwZS5qYXZhCkBAIC0xNzIsNyArMTcy
LDYgQEAKIAkJcmVzdWx0LnNldFNvdXJjZVJhbmdlKGdldFN0YXJ0UG9zaXRpb24oKSwgZ2V0TGVu
Z3RoKCkpOwogCQlyZXN1bHQuc2V0Q29tcG9uZW50VHlwZSgoVHlwZSkgZ2V0Q29tcG9uZW50VHlw
ZSgpLmNsb25lKHRhcmdldCkpOwogCQlpZiAodGhpcy5hc3QuYXBpTGV2ZWwgPj0gQVNULkpMUzgp
IHsKLQkJCXJlc3VsdC5hbm5vdGF0aW9ucyA9IG5ldyBBU1ROb2RlLk5vZGVMaXN0KEFOTk9UQVRJ
T05TX1BST1BFUlRZKTsKIAkJCXJlc3VsdC5hbm5vdGF0aW9ucy5hZGRBbGwoCiAJCQkJCUFTVE5v
ZGUuY29weVN1YnRyZWVzKHRhcmdldCwgYW5ub3RhdGlvbnMoKSkpOwogCQl9CmRpZmYgLS1naXQg
YS9vcmcuZWNsaXBzZS5qZHQuY29yZS9kb20vb3JnL2VjbGlwc2UvamR0L2NvcmUvZG9tL0RpbWVu
c2lvblR5cGUuamF2YSBiL29yZy5lY2xpcHNlLmpkdC5jb3JlL2RvbS9vcmcvZWNsaXBzZS9qZHQv
Y29yZS9kb20vRGltZW5zaW9uVHlwZS5qYXZhCm5ldyBmaWxlIG1vZGUgMTAwNjQ0CmluZGV4IDAw
MDAwMDAuLjgwNDk0MzkKLS0tIC9kZXYvbnVsbAorKysgYi9vcmcuZWNsaXBzZS5qZHQuY29yZS9k
b20vb3JnL2VjbGlwc2UvamR0L2NvcmUvZG9tL0RpbWVuc2lvblR5cGUuamF2YQpAQCAtMCwwICsx
LDE5OSBAQAorLyoqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioq
KioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioKKyAqIENvcHlyaWdodCAoYykgMjAwMCwg
MjAxMyBJQk0gQ29ycG9yYXRpb24gYW5kIG90aGVycy4KKyAqIEFsbCByaWdodHMgcmVzZXJ2ZWQu
IFRoaXMgcHJvZ3JhbSBhbmQgdGhlIGFjY29tcGFueWluZyBtYXRlcmlhbHMKKyAqIGFyZSBtYWRl
IGF2YWlsYWJsZSB1bmRlciB0aGUgdGVybXMgb2YgdGhlIEVjbGlwc2UgUHVibGljIExpY2Vuc2Ug
djEuMAorICogd2hpY2ggYWNjb21wYW5pZXMgdGhpcyBkaXN0cmlidXRpb24sIGFuZCBpcyBhdmFp
bGFibGUgYXQKKyAqIGh0dHA6Ly93d3cuZWNsaXBzZS5vcmcvbGVnYWwvZXBsLXYxMC5odG1sCisg
KgorICogVGhpcyBpcyBhbiBpbXBsZW1lbnRhdGlvbiBvZiBhbiBlYXJseS1kcmFmdCBzcGVjaWZp
Y2F0aW9uIGRldmVsb3BlZCB1bmRlciB0aGUgSmF2YQorICogQ29tbXVuaXR5IFByb2Nlc3MgKEpD
UCkgYW5kIGlzIG1hZGUgYXZhaWxhYmxlIGZvciB0ZXN0aW5nIGFuZCBldmFsdWF0aW9uIHB1cnBv
c2VzCisgKiBvbmx5LiBUaGUgY29kZSBpcyBub3QgY29tcGF0aWJsZSB3aXRoIGFueSBzcGVjaWZp
Y2F0aW9uIG9mIHRoZSBKQ1AuCisgKiAKKyAqIENvbnRyaWJ1dG9yczoKKyAqICAgICBJQk0gQ29y
cG9yYXRpb24gLSBpbml0aWFsIEFQSSBhbmQgaW1wbGVtZW50YXRpb24KKyAqKioqKioqKioqKioq
KioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioq
KioqKioqKioqLworcGFja2FnZSBvcmcuZWNsaXBzZS5qZHQuY29yZS5kb207CisKK2ltcG9ydCBq
YXZhLnV0aWwuQXJyYXlMaXN0OworaW1wb3J0IGphdmEudXRpbC5MaXN0OworCisvKioKKyAqIFRo
ZSBhcnJheSBkaW1lbnNpb24gdHlwZSBub2RlLiBUaGUgYXJyYXkgZGltZW5zaW9uLCByZXByZXNl
bnRlZCBhcyA8Yj5bXTwvYj4sIG1heSAKKyAqIGluY2x1ZGUgYW4gPGNvZGU+RXhwcmVzc2lvbjwv
Y29kZT4gZGVwZW5kaW5nIG9uIHdoZXJlIGl0IGFwcGVhcnMuIFRoZSBvbmx5IAorICogbm9kZSB0
aGF0IHN1cHBvcnRzIGEgZGltZW5zaW9uIHR5cGUgd2l0aCBhbiBleHByZXNzaW9uIGlzIDxjb2Rl
PkFycmF5Q3JlYXRpb248L2NvZGU+LgorICogVGhpcyBub2RlIHR5cGUgaXMgc3VwcG9ydGVkIG9u
bHkgaW4gSkxTOCBvciBsYXRlci4KKyAqIAorICogRm9yIEpMUzg6CisgKiA8cHJlPgorICogRGlt
ZW5zaW9uVHlwZToKKyAqIAk8Yj5bPC9iPiB7RXhwcmVzc2lvbn0gPGI+XTwvYj4gCisgKiA8L3By
ZT4KKyAqIAorICogQHNpbmNlIDMuOQorICovCitwdWJsaWMgY2xhc3MgRGltZW5zaW9uVHlwZSBl
eHRlbmRzIEFubm90YXRhYmxlVHlwZSB7CisKKwkKKwkvKioKKwkgKiBUaGUgImFubm90YXRpb25z
IiBzdHJ1Y3R1cmFsIHByb3BlcnR5IG9mIHRoaXMgbm9kZSB0eXBlIChjaGlsZCB0eXBlOiB7QGxp
bmsgQW5ub3RhdGlvbn0pLgorCSAqIEBzaW5jZSAzLjkKKwkgKi8KKwlwdWJsaWMgc3RhdGljIGZp
bmFsIENoaWxkTGlzdFByb3BlcnR5RGVzY3JpcHRvciBBTk5PVEFUSU9OU19QUk9QRVJUWSA9CisJ
CW5ldyBDaGlsZExpc3RQcm9wZXJ0eURlc2NyaXB0b3IoRGltZW5zaW9uVHlwZS5jbGFzcywgImFu
bm90YXRpb25zIiwgQW5ub3RhdGlvbi5jbGFzcywgTk9fQ1lDTEVfUklTSyk7IC8vJE5PTi1OTFMt
MSQKKwkKKworCS8qKgorCSAqIFRoZSAiZGltZW5zaW9ucyIgc3RydWN0dXJhbCBwcm9wZXJ0eSBv
ZiB0aGlzIG5vZGUgdHlwZSAoZWxlbWVudCB0eXBlOiB7QGxpbmsgRXhwcmVzc2lvbn0pLgorCSAq
IEBzaW5jZSAzLjkKKwkgKi8KKwlwdWJsaWMgc3RhdGljIGZpbmFsIENoaWxkUHJvcGVydHlEZXNj
cmlwdG9yIEVYUFJFU1NJT05fUFJPUEVSVFkgPQorCQkJbmV3IENoaWxkUHJvcGVydHlEZXNjcmlw
dG9yKERpbWVuc2lvblR5cGUuY2xhc3MsICJleHByZXNzaW9uIiwgRXhwcmVzc2lvbi5jbGFzcywg
TUFOREFUT1JZLCBOT19DWUNMRV9SSVNLKTsgLy8kTk9OLU5MUy0xJAorCQorCQorCS8qKgorCSAq
IEEgbGlzdCBvZiBwcm9wZXJ0eSBkZXNjcmlwdG9ycyAoZWxlbWVudCB0eXBlOgorCSAqIHtAbGlu
ayBTdHJ1Y3R1cmFsUHJvcGVydHlEZXNjcmlwdG9yfSksCisJICogb3IgbnVsbCBpZiB1bmluaXRp
YWxpemVkLgorCSAqIEBzaW5jZSAzLjkKKwkgKi8KKwlwcml2YXRlIHN0YXRpYyBmaW5hbCBMaXN0
IFBST1BFUlRZX0RFU0NSSVBUT1JTXzhfMDsKKwkKKwlzdGF0aWMgeworCQlMaXN0IHByb3BlcnR5
TGlzdCA9IG5ldyBBcnJheUxpc3QoMyk7CisJCWNyZWF0ZVByb3BlcnR5TGlzdChEaW1lbnNpb25U
eXBlLmNsYXNzLCBwcm9wZXJ0eUxpc3QpOworCQlhZGRQcm9wZXJ0eShBTk5PVEFUSU9OU19QUk9Q
RVJUWSwgcHJvcGVydHlMaXN0KTsKKwkJYWRkUHJvcGVydHkoRVhQUkVTU0lPTl9QUk9QRVJUWSwg
cHJvcGVydHlMaXN0KTsKKwkJUFJPUEVSVFlfREVTQ1JJUFRPUlNfOF8wID0gcmVhcFByb3BlcnR5
TGlzdChwcm9wZXJ0eUxpc3QpOworCX0KKwkKKwkvKioKKwkgKiBSZXR1cm5zIGEgbGlzdCBvZiBz
dHJ1Y3R1cmFsIHByb3BlcnR5IGRlc2NyaXB0b3JzIGZvciB0aGlzIG5vZGUgdHlwZS4KKwkgKiBD
bGllbnRzIG11c3Qgbm90IG1vZGlmeSB0aGUgcmVzdWx0LgorCSAqCisJICogQHBhcmFtIGFwaUxl
dmVsIHRoZSBBUEkgbGV2ZWw7IG9uZSBvZiB0aGUKKwkgKiA8Y29kZT5BU1QuSkxTKjwvY29kZT4g
Y29uc3RhbnRzCisJICogQHJldHVybiBhIGxpc3Qgb2YgcHJvcGVydHkgZGVzY3JpcHRvcnMgKGVs
ZW1lbnQgdHlwZToKKwkgKiB7QGxpbmsgU3RydWN0dXJhbFByb3BlcnR5RGVzY3JpcHRvcn0pCisJ
ICogQHNpbmNlIDMuOQorCSAqLworCXB1YmxpYyBzdGF0aWMgTGlzdCBwcm9wZXJ0eURlc2NyaXB0
b3JzKGludCBhcGlMZXZlbCkgeworCQlyZXR1cm4gUFJPUEVSVFlfREVTQ1JJUFRPUlNfOF8wOwor
CX0KKwkKKwlwdWJsaWMgRGltZW5zaW9uVHlwZShBU1QgYXN0KSB7CisJCXN1cGVyKGFzdCk7CisJ
CXVuc3VwcG9ydGVkSW4yXzNfNCgpOworCQl0aGlzLmFubm90YXRpb25zID0gbmV3IEFTVE5vZGUu
Tm9kZUxpc3QoQU5OT1RBVElPTlNfUFJPUEVSVFkpOworCX0KKwkKKwkvKioKKwkgKiBUaGUgZXhw
cmVzc2lvbnMgZm9yIHRoaXMgZGltZW5zaW9uIHR5cGUgKGVsZW1lbnQgdHlwZToKKwkgKiB7QGxp
bmsgRXhwcmVzc2lvbn0pLiBEZWZhdWx0cyB0byBhbiBlbXB0eSBsaXN0LgorCSAqLworCXByaXZh
dGUgRXhwcmVzc2lvbiBleHByZXNzaW9uID0gbnVsbDsKKwkKKwkvKioKKwkgKiBTZXRzIHRoZSBl
eHByZXNzaW9uIHRvIHRoaXMgZGltZW5zaW9uLiBUaGlzIG9wZXJhdGlvbiB3aWxsIGhhdmUKKwkg
KiBlZmZlY3Qgb25seSBpZiB0aGlzIGRpbWVuc2lvbiB0eXBlIG5vZGUgaXMgcGFydCBvZiBhbiBh
cnJheSBjcmVhdGlvbgorCSAqIG5vZGUuIAorCSAqCisJICogQHBhcmFtIGV4cHJlc3Npb24gdGhl
IG5ldyBhcnJheSB0eXBlCisJICogQGV4Y2VwdGlvbiBJbGxlZ2FsQXJndW1lbnRFeGNlcHRpb24g
aWY6CisJICogPHVsPgorCSAqIDxsaT50aGUgbm9kZSBiZWxvbmdzIHRvIGEgZGlmZmVyZW50IEFT
VDwvbGk+CisJICogPGxpPnRoZSBub2RlIGFscmVhZHkgaGFzIGEgcGFyZW50PC9saT4KKwkgKiA8
L3VsPgorCSAqIAorCSAqIEBzaW5jZSAzLjkKKwkgKi8KKwlwdWJsaWMgdm9pZCBzZXRFeHByZXNz
aW9uKEV4cHJlc3Npb24gZXhwcmVzc2lvbikgeworCQkvLyBhbiBBcnJheUNyZWF0aW9uIGNhbm5v
dCBvY2N1ciBpbnNpZGUgYSBBcnJheVR5cGUgLSBjeWNsZXMgbm90IHBvc3NpYmxlCisJCUFTVE5v
ZGUgb2xkQ2hpbGQgPSB0aGlzLmV4cHJlc3Npb247CisJCXByZVJlcGxhY2VDaGlsZChvbGRDaGls
ZCwgZXhwcmVzc2lvbiwgRVhQUkVTU0lPTl9QUk9QRVJUWSk7CisJCXRoaXMuZXhwcmVzc2lvbiA9
IGV4cHJlc3Npb247CisJCXBvc3RSZXBsYWNlQ2hpbGQob2xkQ2hpbGQsIGV4cHJlc3Npb24sIEVY
UFJFU1NJT05fUFJPUEVSVFkpOworCX0KKwkKKwkvKioKKwkgKiBSZXR1cm5zIHRoZSBleHByZXNz
aW9uIGluIHRoZSBkaW1lbnNpb24gdHlwZS4KKwkgKgorCSAqIEByZXR1cm4gdGhlIGV4cHJlc3Np
b24KKwkgKiBAc2luY2UgMy45CisJICovCisJcHVibGljIEV4cHJlc3Npb24gZXhwcmVzc2lvbigp
IHsKKwkJcmV0dXJuIHRoaXMuZXhwcmVzc2lvbjsKKwl9CisJCisJTGlzdCBpbnRlcm5hbFN0cnVj
dHVyYWxQcm9wZXJ0aWVzRm9yVHlwZShpbnQgYXBpTGV2ZWwpIHsKKwkJcmV0dXJuIHByb3BlcnR5
RGVzY3JpcHRvcnMoYXBpTGV2ZWwpOworCX0KKworCS8qIChvbWl0IGphdmFkb2MgZm9yIHRoaXMg
bWV0aG9kKQorCSAqIE1ldGhvZCBkZWNsYXJlZCBvbiBBU1ROb2RlLgorCSAqLworCWZpbmFsIEFT
VE5vZGUgaW50ZXJuYWxHZXRTZXRDaGlsZFByb3BlcnR5KENoaWxkUHJvcGVydHlEZXNjcmlwdG9y
IHByb3BlcnR5LCBib29sZWFuIGdldCwgQVNUTm9kZSBjaGlsZCkgeworCQlpZiAocHJvcGVydHkg
PT0gRVhQUkVTU0lPTl9QUk9QRVJUWSkgeworCQkJaWYgKGdldCkgeworCQkJCXJldHVybiBleHBy
ZXNzaW9uKCk7CisJCQl9IGVsc2UgeworCQkJCXNldEV4cHJlc3Npb24oKEV4cHJlc3Npb24pIGNo
aWxkKTsKKwkJCQlyZXR1cm4gbnVsbDsKKwkJCX0KKwkJfQorCQkvLyBhbGxvdyBkZWZhdWx0IGlt
cGxlbWVudGF0aW9uIHRvIGZsYWcgdGhlIGVycm9yCisJCXJldHVybiBzdXBlci5pbnRlcm5hbEdl
dFNldENoaWxkUHJvcGVydHkocHJvcGVydHksIGdldCwgY2hpbGQpOworCX0KKworCS8qIChvbWl0
IGphdmFkb2MgZm9yIHRoaXMgbWV0aG9kKQorCSAqIE1ldGhvZCBkZWNsYXJlZCBvbiBBU1ROb2Rl
LgorCSAqLworCWZpbmFsIExpc3QgaW50ZXJuYWxHZXRDaGlsZExpc3RQcm9wZXJ0eShDaGlsZExp
c3RQcm9wZXJ0eURlc2NyaXB0b3IgcHJvcGVydHkpIHsKKwkJaWYgKHByb3BlcnR5ID09IEFOTk9U
QVRJT05TX1BST1BFUlRZKSB7CisJCQlyZXR1cm4gYW5ub3RhdGlvbnMoKTsKKwkJfQorCQkvLyBh
bGxvdyBkZWZhdWx0IGltcGxlbWVudGF0aW9uIHRvIGZsYWcgdGhlIGVycm9yCisJCXJldHVybiBz
dXBlci5pbnRlcm5hbEdldENoaWxkTGlzdFByb3BlcnR5KHByb3BlcnR5KTsKKwl9CisKKwlpbnQg
Z2V0Tm9kZVR5cGUwKCkgeworCQlyZXR1cm4gRElNRU5TSU9OX1RZUEU7CisJfQorCisJYm9vbGVh
biBzdWJ0cmVlTWF0Y2gwKEFTVE1hdGNoZXIgbWF0Y2hlciwgT2JqZWN0IG90aGVyKSB7CisJCXJl
dHVybiBtYXRjaGVyLm1hdGNoKHRoaXMsIG90aGVyKTsKKwl9CisKKwlBU1ROb2RlIGNsb25lMChB
U1QgdGFyZ2V0KSB7CisJCURpbWVuc2lvblR5cGUgcmVzdWx0ID0gbmV3IERpbWVuc2lvblR5cGUo
dGFyZ2V0KTsKKwkJcmVzdWx0LmFubm90YXRpb25zLmFkZEFsbCgKKwkJCQlBU1ROb2RlLmNvcHlT
dWJ0cmVlcyh0YXJnZXQsIGFubm90YXRpb25zKCkpKTsKKwkJaWYgKHRoaXMuZXhwcmVzc2lvbiAh
PSBudWxsKSB7CisJCQlyZXN1bHQuc2V0RXhwcmVzc2lvbigoRXhwcmVzc2lvbilleHByZXNzaW9u
KCkuY2xvbmUodGFyZ2V0KSk7CisJCX0KKwkJcmV0dXJuIHJlc3VsdDsKKwl9CisKKwl2b2lkIGFj
Y2VwdDAoQVNUVmlzaXRvciB2aXNpdG9yKSB7CisJCWJvb2xlYW4gdmlzaXRDaGlsZHJlbiA9IHZp
c2l0b3IudmlzaXQodGhpcyk7CisJCWlmICh2aXNpdENoaWxkcmVuKSB7CisJCQlhY2NlcHRDaGls
ZHJlbih2aXNpdG9yLCB0aGlzLmFubm90YXRpb25zKTsKKwkJCWlmICh0aGlzLmV4cHJlc3Npb24g
IT0gbnVsbCkgeworCQkJCWFjY2VwdENoaWxkKHZpc2l0b3IsIHRoaXMuZXhwcmVzc2lvbik7CisJ
CQl9CisJCX0KKwkJdmlzaXRvci5lbmRWaXNpdCh0aGlzKTsKKworCX0KKworCWludCB0cmVlU2l6
ZSgpIHsKKwkJaW50IHNpemUgPSBtZW1TaXplKCkKKwkJCQkrIHRoaXMuYW5ub3RhdGlvbnMubGlz
dFNpemUoKQorCQkJCSsgKHRoaXMuZXhwcmVzc2lvbiA9PSBudWxsID8gMCA6IHRoaXMuZXhwcmVz
c2lvbi50cmVlU2l6ZSgpKTsKKwkJCXJldHVybiBzaXplOworCX0KKworCWludCBtZW1TaXplKCkg
eworCQlyZXR1cm4gQkFTRV9OT0RFX1NJWkUgKyAyICogNDsKKwl9CisKK30KZGlmZiAtLWdpdCBh
L29yZy5lY2xpcHNlLmpkdC5jb3JlL2RvbS9vcmcvZWNsaXBzZS9qZHQvY29yZS9kb20vTWV0aG9k
RGVjbGFyYXRpb24uamF2YSBiL29yZy5lY2xpcHNlLmpkdC5jb3JlL2RvbS9vcmcvZWNsaXBzZS9q
ZHQvY29yZS9kb20vTWV0aG9kRGVjbGFyYXRpb24uamF2YQppbmRleCAxOTQ2YzAwLi4yYjQ1N2U2
IDEwMDY0NAotLS0gYS9vcmcuZWNsaXBzZS5qZHQuY29yZS9kb20vb3JnL2VjbGlwc2UvamR0L2Nv
cmUvZG9tL01ldGhvZERlY2xhcmF0aW9uLmphdmEKKysrIGIvb3JnLmVjbGlwc2UuamR0LmNvcmUv
ZG9tL29yZy9lY2xpcHNlL2pkdC9jb3JlL2RvbS9NZXRob2REZWNsYXJhdGlvbi5qYXZhCkBAIC0x
NDUsNiArMTQ1LDEzIEBACiAJCW5ldyBTaW1wbGVQcm9wZXJ0eURlc2NyaXB0b3IoTWV0aG9kRGVj
bGFyYXRpb24uY2xhc3MsICJleHRyYURpbWVuc2lvbnMiLCBpbnQuY2xhc3MsIE1BTkRBVE9SWSk7
IC8vJE5PTi1OTFMtMSQKIAogCS8qKgorCSAqIFRoZSAiZXh0cmFEaW1lbnNpb25UeXBlcyIgc3Ry
dWN0dXJhbCBwcm9wZXJ0eSBvZiB0aGlzIG5vZGUgdHlwZSAoY2hpbGQgdHlwZToge0BsaW5rIERp
bWVuc2lvblR5cGV9KS4KKwkgKiBAc2luY2UgMy45CisJICovCisJcHVibGljIHN0YXRpYyBmaW5h
bCBDaGlsZExpc3RQcm9wZXJ0eURlc2NyaXB0b3IgRVhUUkFfRElNRU5TSU9OX1RZUEVTX1BST1BF
UlRZID0KKwkJCW5ldyBDaGlsZExpc3RQcm9wZXJ0eURlc2NyaXB0b3IoTWV0aG9kRGVjbGFyYXRp
b24uY2xhc3MsICJleHRyYURpbWVuc2lvblR5cGVzIiwgRGltZW5zaW9uVHlwZS5jbGFzcywgTk9f
Q1lDTEVfUklTSyk7IC8vJE5PTi1OTFMtMSQKKworCS8qKgogCSAqIFRoZSAidHlwZVBhcmFtZXRl
cnMiIHN0cnVjdHVyYWwgcHJvcGVydHkgb2YgdGhpcyBub2RlIHR5cGUgKGVsZW1lbnQgdHlwZTog
e0BsaW5rIFR5cGVQYXJhbWV0ZXJ9KSAoYWRkZWQgaW4gSkxTMyBBUEkpLgogCSAqIEBzaW5jZSAz
LjEKIAkgKi8KQEAgLTI1OCw3ICsyNjUsNyBAQAogCQlhZGRQcm9wZXJ0eShSRUNFSVZFUl9UWVBF
X1BST1BFUlRZLCBwcm9wZXJ0eUxpc3QpOwogCQlhZGRQcm9wZXJ0eShSRUNFSVZFUl9RVUFMSUZJ
RVJfUFJPUEVSVFksIHByb3BlcnR5TGlzdCk7CiAJCWFkZFByb3BlcnR5KFBBUkFNRVRFUlNfUFJP
UEVSVFksIHByb3BlcnR5TGlzdCk7Ci0JCWFkZFByb3BlcnR5KEVYVFJBX0RJTUVOU0lPTlNfUFJP
UEVSVFksIHByb3BlcnR5TGlzdCk7CisJCWFkZFByb3BlcnR5KEVYVFJBX0RJTUVOU0lPTl9UWVBF
U19QUk9QRVJUWSwgcHJvcGVydHlMaXN0KTsKIAkJYWRkUHJvcGVydHkoVEhST1dOX0VYQ0VQVElP
Tl9UWVBFU19QUk9QRVJUWSwgcHJvcGVydHlMaXN0KTsKIAkJYWRkUHJvcGVydHkoQk9EWV9QUk9Q
RVJUWSwgcHJvcGVydHlMaXN0KTsKIAkJUFJPUEVSVFlfREVTQ1JJUFRPUlNfOF8wID0gcmVhcFBy
b3BlcnR5TGlzdChwcm9wZXJ0eUxpc3QpOwkKQEAgLTM0NCw2ICszNTEsMTMgQEAKIAlwcml2YXRl
IGludCBleHRyYUFycmF5RGltZW5zaW9ucyA9IDA7CiAKIAkvKioKKwkgKiBUaGUgZXh0cmEgZGlt
ZW5zaW9uIHR5cGVzIHRoaXMgbm9kZSBoYXMgaWYgYW55LgorCSAqIAorCSAqIEBzaW5jZSAzLjkK
KwkgKi8KKwlwcm90ZWN0ZWQgQVNUTm9kZS5Ob2RlTGlzdCBleHRyYURpbWVuc2lvblR5cGVzID0g
bnVsbDsKKworCS8qKgogCSAqIFRoZSBsaXN0IG9mIHRocm93biBleGNlcHRpb24gbmFtZXMgKGVs
ZW1lbnQgdHlwZToge0BsaW5rIE5hbWV9KS4KIAkgKiBEZWZhdWx0cyB0byBhbiBlbXB0eSBsaXN0
IGZvciBhcGkgbGV2ZWxzIGJlbG93IEpMUzguCiAJICovCkBAIC0zODAsNiArMzk0LDkgQEAKIAkJ
c3VwZXIoYXN0KTsKIAkJaWYgKGFzdC5hcGlMZXZlbCA+PSBBU1QuSkxTM19JTlRFUk5BTCkgewog
CQkJdGhpcy50eXBlUGFyYW1ldGVycyA9IG5ldyBBU1ROb2RlLk5vZGVMaXN0KFRZUEVfUEFSQU1F
VEVSU19QUk9QRVJUWSk7CisJCX0gCisJCWlmIChhc3QuYXBpTGV2ZWwgPj0gQVNULkpMUzgpIHsK
KwkJCXRoaXMuZXh0cmFEaW1lbnNpb25UeXBlcyA9IG5ldyBBU1ROb2RlLk5vZGVMaXN0KEVYVFJB
X0RJTUVOU0lPTl9UWVBFU19QUk9QRVJUWSk7CiAJCX0KIAkJaWYgKGFzdC5hcGlMZXZlbCgpIDwg
QVNULkpMUzgpIHsKIAkJCXRoaXMudGhyb3duRXhjZXB0aW9ucyA9IG5ldyBBU1ROb2RlLk5vZGVM
aXN0KFRIUk9XTl9FWENFUFRJT05TX1BST1BFUlRZKTsKQEAgLTUxNyw2ICs1MzQsOSBAQAogCQlp
ZiAocHJvcGVydHkgPT0gVEhST1dOX0VYQ0VQVElPTl9UWVBFU19QUk9QRVJUWSkgewogCQkJcmV0
dXJuIHRocm93bkV4Y2VwdGlvblR5cGVzKCk7CiAJCX0JCQorCQlpZiAocHJvcGVydHkgPT0gRVhU
UkFfRElNRU5TSU9OX1RZUEVTX1BST1BFUlRZKSB7CisJCQlyZXR1cm4gdGhpcy5leHRyYURpbWVu
c2lvblR5cGVzOworCQl9CiAJCS8vIGFsbG93IGRlZmF1bHQgaW1wbGVtZW50YXRpb24gdG8gZmxh
ZyB0aGUgZXJyb3IKIAkJcmV0dXJuIHN1cGVyLmludGVybmFsR2V0Q2hpbGRMaXN0UHJvcGVydHko
cHJvcGVydHkpOwogCX0KQEAgLTU3NSw2ICs1OTUsMTEgQEAKIAkJfQogCQlyZXN1bHQuc2V0Q29u
c3RydWN0b3IoaXNDb25zdHJ1Y3RvcigpKTsKIAkJcmVzdWx0LnNldEV4dHJhRGltZW5zaW9ucyhn
ZXRFeHRyYURpbWVuc2lvbnMoKSk7CisJCWlmICh0aGlzLmFzdC5hcGlMZXZlbCA+PSBBU1QuSkxT
OCkgeworCQkJcmVzdWx0LmV4dHJhRGltZW5zaW9uVHlwZXMgPSBuZXcgQVNUTm9kZS5Ob2RlTGlz
dChFWFRSQV9ESU1FTlNJT05fVFlQRVNfUFJPUEVSVFkpOworCQkJcmVzdWx0LmV4dHJhRGltZW5z
aW9uVHlwZXMuYWRkQWxsKAorCQkJCQlBU1ROb2RlLmNvcHlTdWJ0cmVlcyh0YXJnZXQsIGdldGV4
dHJhRGltZW5zaW9uVHlwZXMoKSkpOworCQl9CiAJCXJlc3VsdC5zZXROYW1lKChTaW1wbGVOYW1l
KSBnZXROYW1lKCkuY2xvbmUodGFyZ2V0KSk7CiAJCXJlc3VsdC5wYXJhbWV0ZXJzKCkuYWRkQWxs
KAogCQkJQVNUTm9kZS5jb3B5U3VidHJlZXModGFyZ2V0LCBwYXJhbWV0ZXJzKCkpKTsKQEAgLTEw
MzUsNiArMTA2MCwxNyBAQAogCX0KIAogCS8qKgorCSAqIFJldHVybnMgdGhlIGxpdmUgb3JkZXJl
ZCBsaXN0IG9mIGV4dHJhIGRpbWVuc2lvbiB0eXBlcyBpZiBhbnkuCisJICogCisJICogQHJldHVy
biB0aGUgbGl2ZSBsaXN0IG9mIGV4dHJhIGRpbWVuc2lvbnMgaWYgYW55IChlbGVtZW50IHR5cGU6
IHtAbGluayBEaW1lbnNpb25UeXBlfVtdKQorCSAqIEBzaW5jZSAzLjkKKwkgKi8KKwlwdWJsaWMg
TGlzdCBnZXRleHRyYURpbWVuc2lvblR5cGVzKCkgeworCQl1bnN1cHBvcnRlZEluMl8zXzQoKTsK
KwkJcmV0dXJuIHRoaXMuZXh0cmFEaW1lbnNpb25UeXBlczsKKwl9CisKKwkvKioKIAkgKiBSZXR1
cm5zIHRoZSBib2R5IG9mIHRoaXMgbWV0aG9kIGRlY2xhcmF0aW9uLCBvciA8Y29kZT5udWxsPC9j
b2RlPiBpZgogCSAqIHRoaXMgbWV0aG9kIGhhcyA8Yj5ubzwvYj4gYm9keS4KIAkgKiA8cD4KZGlm
ZiAtLWdpdCBhL29yZy5lY2xpcHNlLmpkdC5jb3JlL2RvbS9vcmcvZWNsaXBzZS9qZHQvY29yZS9k
b20vUHJpbWl0aXZlVHlwZS5qYXZhIGIvb3JnLmVjbGlwc2UuamR0LmNvcmUvZG9tL29yZy9lY2xp
cHNlL2pkdC9jb3JlL2RvbS9QcmltaXRpdmVUeXBlLmphdmEKaW5kZXggMjI5MGM1OC4uMzMyMGU5
ZSAxMDA2NDQKLS0tIGEvb3JnLmVjbGlwc2UuamR0LmNvcmUvZG9tL29yZy9lY2xpcHNlL2pkdC9j
b3JlL2RvbS9QcmltaXRpdmVUeXBlLmphdmEKKysrIGIvb3JnLmVjbGlwc2UuamR0LmNvcmUvZG9t
L29yZy9lY2xpcHNlL2pkdC9jb3JlL2RvbS9QcmltaXRpdmVUeXBlLmphdmEKQEAgLTI4NSw3ICsy
ODUsNiBAQAogCQlyZXN1bHQuc2V0U291cmNlUmFuZ2UoZ2V0U3RhcnRQb3NpdGlvbigpLCBnZXRM
ZW5ndGgoKSk7CiAJCXJlc3VsdC5zZXRQcmltaXRpdmVUeXBlQ29kZShnZXRQcmltaXRpdmVUeXBl
Q29kZSgpKTsKIAkJaWYgKHRoaXMuYXN0LmFwaUxldmVsID49IEFTVC5KTFM4KSB7Ci0JCQlyZXN1
bHQuYW5ub3RhdGlvbnMgPSBuZXcgQVNUTm9kZS5Ob2RlTGlzdChBTk5PVEFUSU9OU19QUk9QRVJU
WSk7CiAJCQlyZXN1bHQuYW5ub3RhdGlvbnMuYWRkQWxsKAogCQkJCQlBU1ROb2RlLmNvcHlTdWJ0
cmVlcyh0YXJnZXQsIGFubm90YXRpb25zKCkpKTsKIAkJfQpkaWZmIC0tZ2l0IGEvb3JnLmVjbGlw
c2UuamR0LmNvcmUvZG9tL29yZy9lY2xpcHNlL2pkdC9jb3JlL2RvbS9RdWFsaWZpZWRUeXBlLmph
dmEgYi9vcmcuZWNsaXBzZS5qZHQuY29yZS9kb20vb3JnL2VjbGlwc2UvamR0L2NvcmUvZG9tL1F1
YWxpZmllZFR5cGUuamF2YQppbmRleCA5NjdiNWMyLi4yZWVkODllIDEwMDY0NAotLS0gYS9vcmcu
ZWNsaXBzZS5qZHQuY29yZS9kb20vb3JnL2VjbGlwc2UvamR0L2NvcmUvZG9tL1F1YWxpZmllZFR5
cGUuamF2YQorKysgYi9vcmcuZWNsaXBzZS5qZHQuY29yZS9kb20vb3JnL2VjbGlwc2UvamR0L2Nv
cmUvZG9tL1F1YWxpZmllZFR5cGUuamF2YQpAQCAtMjE2LDcgKzIxNiw2IEBACiAJCXJlc3VsdC5z
ZXRRdWFsaWZpZXIoKFR5cGUpICgoQVNUTm9kZSkgZ2V0UXVhbGlmaWVyKCkpLmNsb25lKHRhcmdl
dCkpOwogCQlyZXN1bHQuc2V0TmFtZSgoU2ltcGxlTmFtZSkgKChBU1ROb2RlKSBnZXROYW1lKCkp
LmNsb25lKHRhcmdldCkpOwogCQlpZiAodGhpcy5hc3QuYXBpTGV2ZWwgPj0gQVNULkpMUzgpIHsK
LQkJCXJlc3VsdC5hbm5vdGF0aW9ucyA9IG5ldyBBU1ROb2RlLk5vZGVMaXN0KEFOTk9UQVRJT05T
X1BST1BFUlRZKTsKIAkJCXJlc3VsdC5hbm5vdGF0aW9ucy5hZGRBbGwoCiAJCQkJCUFTVE5vZGUu
Y29weVN1YnRyZWVzKHRhcmdldCwgYW5ub3RhdGlvbnMoKSkpOwogCQl9CmRpZmYgLS1naXQgYS9v
cmcuZWNsaXBzZS5qZHQuY29yZS9kb20vb3JnL2VjbGlwc2UvamR0L2NvcmUvZG9tL1JlY292ZXJl
ZFZhcmlhYmxlQmluZGluZy5qYXZhIGIvb3JnLmVjbGlwc2UuamR0LmNvcmUvZG9tL29yZy9lY2xp
cHNlL2pkdC9jb3JlL2RvbS9SZWNvdmVyZWRWYXJpYWJsZUJpbmRpbmcuamF2YQppbmRleCBiYTUx
MmZjLi43Y2MxZjA5IDEwMDY0NAotLS0gYS9vcmcuZWNsaXBzZS5qZHQuY29yZS9kb20vb3JnL2Vj
bGlwc2UvamR0L2NvcmUvZG9tL1JlY292ZXJlZFZhcmlhYmxlQmluZGluZy5qYXZhCisrKyBiL29y
Zy5lY2xpcHNlLmpkdC5jb3JlL2RvbS9vcmcvZWNsaXBzZS9qZHQvY29yZS9kb20vUmVjb3ZlcmVk
VmFyaWFibGVCaW5kaW5nLmphdmEKQEAgLTEsNSArMSw1IEBACiAvKioqKioqKioqKioqKioqKioq
KioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioq
KioqKgotICogQ29weXJpZ2h0IChjKSAyMDA3LCAyMDA5IElCTSBDb3Jwb3JhdGlvbiBhbmQgb3Ro
ZXJzLgorICogQ29weXJpZ2h0IChjKSAyMDA3LCAyMDEzIElCTSBDb3Jwb3JhdGlvbiBhbmQgb3Ro
ZXJzLgogICogQWxsIHJpZ2h0cyByZXNlcnZlZC4gVGhpcyBwcm9ncmFtIGFuZCB0aGUgYWNjb21w
YW55aW5nIG1hdGVyaWFscwogICogYXJlIG1hZGUgYXZhaWxhYmxlIHVuZGVyIHRoZSB0ZXJtcyBv
ZiB0aGUgRWNsaXBzZSBQdWJsaWMgTGljZW5zZSB2MS4wCiAgKiB3aGljaCBhY2NvbXBhbmllcyB0
aGlzIGRpc3RyaWJ1dGlvbiwgYW5kIGlzIGF2YWlsYWJsZSBhdApAQCAtOTQsNyArOTQsOCBAQAog
CQkJCS5hcHBlbmQoInZhcmlhYmxlRGVjbGFyYXRpb24iKSAvLyROT04tTkxTLTEkCiAJCQkJLmFw
cGVuZCh0aGlzLnZhcmlhYmxlRGVjbGFyYXRpb24uZ2V0Q2xhc3MoKSkKIAkJCQkuYXBwZW5kKHRo
aXMudmFyaWFibGVEZWNsYXJhdGlvbi5nZXROYW1lKCkuZ2V0SWRlbnRpZmllcigpKQotCQkJCS5h
cHBlbmQodGhpcy52YXJpYWJsZURlY2xhcmF0aW9uLmdldEV4dHJhRGltZW5zaW9ucygpKTsKKwkJ
CQkuYXBwZW5kKCh0aGlzLnZhcmlhYmxlRGVjbGFyYXRpb24uYXN0LmFwaUxldmVsIDwgQVNULkpM
UzgpID8gCisJCQkJCQl0aGlzLnZhcmlhYmxlRGVjbGFyYXRpb24uZ2V0RXh0cmFEaW1lbnNpb25z
KCkgOiB0aGlzLnZhcmlhYmxlRGVjbGFyYXRpb24uZ2V0RXh0cmFEaW1lbnNpb25UeXBlcygpLnNp
emUoKSk7CiAJCX0KIAkJcmV0dXJuIFN0cmluZy52YWx1ZU9mKGJ1ZmZlcik7CiAJfQpkaWZmIC0t
Z2l0IGEvb3JnLmVjbGlwc2UuamR0LmNvcmUvZG9tL29yZy9lY2xpcHNlL2pkdC9jb3JlL2RvbS9T
aW1wbGVUeXBlLmphdmEgYi9vcmcuZWNsaXBzZS5qZHQuY29yZS9kb20vb3JnL2VjbGlwc2UvamR0
L2NvcmUvZG9tL1NpbXBsZVR5cGUuamF2YQppbmRleCBmZTUwM2FhLi5hZmYyYjlhIDEwMDY0NAot
LS0gYS9vcmcuZWNsaXBzZS5qZHQuY29yZS9kb20vb3JnL2VjbGlwc2UvamR0L2NvcmUvZG9tL1Np
bXBsZVR5cGUuamF2YQorKysgYi9vcmcuZWNsaXBzZS5qZHQuY29yZS9kb20vb3JnL2VjbGlwc2Uv
amR0L2NvcmUvZG9tL1NpbXBsZVR5cGUuamF2YQpAQCAtMTY1LDcgKzE2NSw2IEBACiAJCXJlc3Vs
dC5zZXRTb3VyY2VSYW5nZShnZXRTdGFydFBvc2l0aW9uKCksIGdldExlbmd0aCgpKTsKIAkJcmVz
dWx0LnNldE5hbWUoKE5hbWUpIChnZXROYW1lKCkpLmNsb25lKHRhcmdldCkpOwogCQlpZiAodGhp
cy5hc3QuYXBpTGV2ZWwgPj0gQVNULkpMUzgpIHsKLQkJCXJlc3VsdC5hbm5vdGF0aW9ucyA9IG5l
dyBBU1ROb2RlLk5vZGVMaXN0KEFOTk9UQVRJT05TX1BST1BFUlRZKTsKIAkJCXJlc3VsdC5hbm5v
dGF0aW9ucy5hZGRBbGwoCiAJCQkJCUFTVE5vZGUuY29weVN1YnRyZWVzKHRhcmdldCwgYW5ub3Rh
dGlvbnMoKSkpOwogCQl9CmRpZmYgLS1naXQgYS9vcmcuZWNsaXBzZS5qZHQuY29yZS9kb20vb3Jn
L2VjbGlwc2UvamR0L2NvcmUvZG9tL1NpbmdsZVZhcmlhYmxlRGVjbGFyYXRpb24uamF2YSBiL29y
Zy5lY2xpcHNlLmpkdC5jb3JlL2RvbS9vcmcvZWNsaXBzZS9qZHQvY29yZS9kb20vU2luZ2xlVmFy
aWFibGVEZWNsYXJhdGlvbi5qYXZhCmluZGV4IDVjMjhiMDguLjU0ZWQwYmEgMTAwNjQ0Ci0tLSBh
L29yZy5lY2xpcHNlLmpkdC5jb3JlL2RvbS9vcmcvZWNsaXBzZS9qZHQvY29yZS9kb20vU2luZ2xl
VmFyaWFibGVEZWNsYXJhdGlvbi5qYXZhCisrKyBiL29yZy5lY2xpcHNlLmpkdC5jb3JlL2RvbS9v
cmcvZWNsaXBzZS9qZHQvY29yZS9kb20vU2luZ2xlVmFyaWFibGVEZWNsYXJhdGlvbi5qYXZhCkBA
IC05MCwxMSArOTAsMTkgQEAKIAkJbmV3IENoaWxkTGlzdFByb3BlcnR5RGVzY3JpcHRvcihTaW5n
bGVWYXJpYWJsZURlY2xhcmF0aW9uLmNsYXNzLCAidmFyYXJnc0Fubm90YXRpb25zIiwgQW5ub3Rh
dGlvbi5jbGFzcywgTk9fQ1lDTEVfUklTSyk7IC8vJE5PTi1OTFMtMSQKIAogCS8qKgotCSAqIFRo
ZSAiZXh0cmFEaW1lbnNpb25zIiBzdHJ1Y3R1cmFsIHByb3BlcnR5IG9mIHRoaXMgbm9kZSB0eXBl
ICh0eXBlOiB7QGxpbmsgSW50ZWdlcn0pLgorCSAqIFRoZSAiZXh0cmFEaW1lbnNpb25zIiBzdHJ1
Y3R1cmFsIHByb3BlcnR5IG9mIHRoaXMgbm9kZSB0eXBlICh0eXBlOiB7QGxpbmsgSW50ZWdlcn0p
LiBUaGlzIHByb3BlcnR5IGlzIHN1cHBvcnRlZAorCSAqIG9ubHkgaW4gSkxTNCBvciBsb3dlciBs
ZXZlbC4gRm9yIEpMUzggYW5kIGFib3ZlLCB1c2UgPGNvZGU+RVhUUkFfRElNRU5TSU9OX1RZUEVT
X1BST1BFUlRZPC9jb2RlPi4KIAkgKiBAc2luY2UgMy4wCiAJICovCiAJcHVibGljIHN0YXRpYyBm
aW5hbCBTaW1wbGVQcm9wZXJ0eURlc2NyaXB0b3IgRVhUUkFfRElNRU5TSU9OU19QUk9QRVJUWSA9
CiAJCW5ldyBTaW1wbGVQcm9wZXJ0eURlc2NyaXB0b3IoU2luZ2xlVmFyaWFibGVEZWNsYXJhdGlv
bi5jbGFzcywgImV4dHJhRGltZW5zaW9ucyIsIGludC5jbGFzcywgTUFOREFUT1JZKTsgLy8kTk9O
LU5MUy0xJAorCisJLyoqCisJICogVGhlICJleHRyYURpbWVuc2lvblR5cGVzIiBzdHJ1Y3R1cmFs
IHByb3BlcnR5IG9mIHRoaXMgbm9kZSB0eXBlIChjaGlsZCB0eXBlOiB7QGxpbmsgRGltZW5zaW9u
VHlwZX0pLgorCSAqIEBzaW5jZSAzLjkKKwkgKi8KKwlwdWJsaWMgc3RhdGljIGZpbmFsIENoaWxk
TGlzdFByb3BlcnR5RGVzY3JpcHRvciBFWFRSQV9ESU1FTlNJT05fVFlQRVNfUFJPUEVSVFkgPQor
CQkJbmV3IENoaWxkTGlzdFByb3BlcnR5RGVzY3JpcHRvcihTaW5nbGVWYXJpYWJsZURlY2xhcmF0
aW9uLmNsYXNzLCAiZXh0cmFEaW1lbnNpb25UeXBlcyIsIERpbWVuc2lvblR5cGUuY2xhc3MsIE5P
X0NZQ0xFX1JJU0spOyAvLyROT04tTkxTLTEkCiAKIAkvKioKIAkgKiBUaGUgImluaXRpYWxpemVy
IiBzdHJ1Y3R1cmFsIHByb3BlcnR5IG9mIHRoaXMgbm9kZSB0eXBlIChjaGlsZCB0eXBlOiB7QGxp
bmsgRXhwcmVzc2lvbn0pLgpAQCAtMTU1LDcgKzE2Myw3IEBACiAJCWFkZFByb3BlcnR5KFZBUkFS
R1NfQU5OT1RBVElPTlNfUFJPUEVSVFksIHByb3BlcnR5TGlzdCk7CiAJCWFkZFByb3BlcnR5KFZB
UkFSR1NfUFJPUEVSVFksIHByb3BlcnR5TGlzdCk7CiAJCWFkZFByb3BlcnR5KE5BTUVfUFJPUEVS
VFksIHByb3BlcnR5TGlzdCk7Ci0JCWFkZFByb3BlcnR5KEVYVFJBX0RJTUVOU0lPTlNfUFJPUEVS
VFksIHByb3BlcnR5TGlzdCk7CisJCWFkZFByb3BlcnR5KEVYVFJBX0RJTUVOU0lPTl9UWVBFU19Q
Uk9QRVJUWSwgcHJvcGVydHlMaXN0KTsKIAkJYWRkUHJvcGVydHkoSU5JVElBTElaRVJfUFJPUEVS
VFksIHByb3BlcnR5TGlzdCk7CiAJCVBST1BFUlRZX0RFU0NSSVBUT1JTXzhfMCA9IHJlYXBQcm9w
ZXJ0eUxpc3QocHJvcGVydHlMaXN0KTsJCQogCQpAQCAtMjI1LDYgKzIzMywxMyBAQAogCXByaXZh
dGUgaW50IGV4dHJhQXJyYXlEaW1lbnNpb25zID0gMDsKIAogCS8qKgorCSAqIExpc3Qgb2YgZXh0
cmEgZGltZW5zaW9uIHR5cGVzIHRoaXMgbm9kZSBoYXMuCisJICogCisJICogQHNpbmNlIDMuOQor
CSAqLworCXByb3RlY3RlZCBBU1ROb2RlLk5vZGVMaXN0IGV4dHJhRGltZW5zaW9uVHlwZXMgPSBu
dWxsOworCisJLyoqCiAJICogVGhlIGluaXRpYWxpemVyIGV4cHJlc3Npb24sIG9yIDxjb2RlPm51
bGw8L2NvZGU+IGlmIG5vbmU7CiAJICogZGVmYXVsdHMgdG8gbm9uZS4KIAkgKi8KQEAgLTI1Myw2
ICsyNjgsNyBAQAogCQkJdGhpcy5tb2RpZmllcnMgPSBuZXcgQVNUTm9kZS5Ob2RlTGlzdChNT0RJ
RklFUlMyX1BST1BFUlRZKTsKIAkJCWlmIChhc3QuYXBpTGV2ZWwgPj0gQVNULkpMUzgpIHsKIAkJ
CQl0aGlzLnZhcmFyZ3NBbm5vdGF0aW9ucyA9IG5ldyBBU1ROb2RlLk5vZGVMaXN0KFZBUkFSR1Nf
QU5OT1RBVElPTlNfUFJPUEVSVFkpOworCQkJCXRoaXMuZXh0cmFEaW1lbnNpb25UeXBlcyA9IG5l
dyBBU1ROb2RlLk5vZGVMaXN0KEVYVFJBX0RJTUVOU0lPTl9UWVBFU19QUk9QRVJUWSk7CiAJCQl9
CiAJCX0KIAl9CkBAIC0zNzAsNiArMzg2LDkgQEAKIAkJaWYgKHByb3BlcnR5ID09IFZBUkFSR1Nf
QU5OT1RBVElPTlNfUFJPUEVSVFkpIHsKIAkJCXJldHVybiB2YXJhcmdzQW5ub3RhdGlvbnMoKTsK
IAkJfQorCQlpZiAocHJvcGVydHkgPT0gRVhUUkFfRElNRU5TSU9OX1RZUEVTX1BST1BFUlRZKSB7
CisJCQlyZXR1cm4gdGhpcy5leHRyYURpbWVuc2lvblR5cGVzOworCQl9CiAJCS8vIGFsbG93IGRl
ZmF1bHQgaW1wbGVtZW50YXRpb24gdG8gZmxhZyB0aGUgZXJyb3IKIAkJcmV0dXJuIHN1cGVyLmlu
dGVybmFsR2V0Q2hpbGRMaXN0UHJvcGVydHkocHJvcGVydHkpOwogCX0KQEAgLTM5NCw3ICs0MTMs
MTIgQEAKIAkJCXJlc3VsdC5zZXRWYXJhcmdzKGlzVmFyYXJncygpKTsKIAkJfQogCQlyZXN1bHQu
c2V0VHlwZSgoVHlwZSkgZ2V0VHlwZSgpLmNsb25lKHRhcmdldCkpOwotCQlyZXN1bHQuc2V0RXh0
cmFEaW1lbnNpb25zKGdldEV4dHJhRGltZW5zaW9ucygpKTsKKwkJaWYgKHRoaXMuYXN0LmFwaUxl
dmVsID49IEFTVC5KTFM4KSB7CisJCQlyZXN1bHQuZXh0cmFEaW1lbnNpb25UeXBlcy5hZGRBbGwo
CisJCQkJCUFTVE5vZGUuY29weVN1YnRyZWVzKHRhcmdldCwgdGhpcy5leHRyYURpbWVuc2lvblR5
cGVzKSk7CisJCX0gZWxzZSB7CisJCQlyZXN1bHQuc2V0RXh0cmFEaW1lbnNpb25zKGdldEV4dHJh
RGltZW5zaW9ucygpKTsKKwkJfQogCQlyZXN1bHQuc2V0TmFtZSgoU2ltcGxlTmFtZSkgZ2V0TmFt
ZSgpLmNsb25lKHRhcmdldCkpOwogCQlyZXN1bHQuc2V0SW5pdGlhbGl6ZXIoCiAJCQkoRXhwcmVz
c2lvbikgQVNUTm9kZS5jb3B5U3VidHJlZSh0YXJnZXQsIGdldEluaXRpYWxpemVyKCkpKTsKQEAg
LTYzOCw2ICs2NjIsNyBAQAogCSAqIEBzaW5jZSAyLjEKIAkgKi8KIAlwdWJsaWMgaW50IGdldEV4
dHJhRGltZW5zaW9ucygpIHsKKwkJc3VwcG9ydGVkT25seUluMl8zXzQoKTsKIAkJcmV0dXJuIHRo
aXMuZXh0cmFBcnJheURpbWVuc2lvbnM7CiAJfQogCkBAIC02NDYsNiArNjcxLDcgQEAKIAkgKiBA
c2luY2UgMi4xCiAJICovCiAJcHVibGljIHZvaWQgc2V0RXh0cmFEaW1lbnNpb25zKGludCBkaW1l
bnNpb25zKSB7CisJCXN1cHBvcnRlZE9ubHlJbjJfM180KCk7CiAJCWlmIChkaW1lbnNpb25zIDwg
MCkgewogCQkJdGhyb3cgbmV3IElsbGVnYWxBcmd1bWVudEV4Y2VwdGlvbigpOwogCQl9CkBAIC02
NTQsNiArNjgwLDE3IEBACiAJCXBvc3RWYWx1ZUNoYW5nZShFWFRSQV9ESU1FTlNJT05TX1BST1BF
UlRZKTsKIAl9CiAKKwkvKioKKwkgKiBSZXR1cm5zIHRoZSBsaXZlIG9yZGVyZWQgbGlzdCBvZiBl
eHRyYSBkaW1lbnNpb25zLgorCSAqIAorCSAqIEByZXR1cm4gdGhlIGxpdmUgbGlzdCBvZiBleHRy
YSBkaW1lbnNpb25zIChlbGVtZW50IHR5cGU6IHtAbGluayBEaW1lbnNpb25UeXBlfVtdKQorCSAq
IEBzaW5jZSAzLjkKKwkgKi8KKwlwdWJsaWMgTGlzdCBnZXRFeHRyYURpbWVuc2lvblR5cGVzKCkg
eworCQl1bnN1cHBvcnRlZEluMl8zXzQoKTsKKwkJcmV0dXJuIHRoaXMuZXh0cmFEaW1lbnNpb25U
eXBlczsKKwl9CisJCiAJLyogKG9taXQgamF2YWRvYyBmb3IgdGhpcyBtZXRob2QpCiAJICogTWV0
aG9kIGRlY2xhcmVkIG9uIFZhcmlhYmxlRGVjbGFyYXRpb24uCiAJICovCmRpZmYgLS1naXQgYS9v
cmcuZWNsaXBzZS5qZHQuY29yZS9kb20vb3JnL2VjbGlwc2UvamR0L2NvcmUvZG9tL1ZhcmlhYmxl
RGVjbGFyYXRpb24uamF2YSBiL29yZy5lY2xpcHNlLmpkdC5jb3JlL2RvbS9vcmcvZWNsaXBzZS9q
ZHQvY29yZS9kb20vVmFyaWFibGVEZWNsYXJhdGlvbi5qYXZhCmluZGV4IGZjMzg4ZTguLmYyYzg2
YjMgMTAwNjQ0Ci0tLSBhL29yZy5lY2xpcHNlLmpkdC5jb3JlL2RvbS9vcmcvZWNsaXBzZS9qZHQv
Y29yZS9kb20vVmFyaWFibGVEZWNsYXJhdGlvbi5qYXZhCisrKyBiL29yZy5lY2xpcHNlLmpkdC5j
b3JlL2RvbS9vcmcvZWNsaXBzZS9qZHQvY29yZS9kb20vVmFyaWFibGVEZWNsYXJhdGlvbi5qYXZh
CkBAIC0xLDUgKzEsNSBAQAogLyoqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioq
KioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioKLSAqIENvcHlyaWdodCAo
YykgMjAwMCwgMjAxMCBJQk0gQ29ycG9yYXRpb24gYW5kIG90aGVycy4KKyAqIENvcHlyaWdodCAo
YykgMjAwMCwgMjAxMyBJQk0gQ29ycG9yYXRpb24gYW5kIG90aGVycy4KICAqIEFsbCByaWdodHMg
cmVzZXJ2ZWQuIFRoaXMgcHJvZ3JhbSBhbmQgdGhlIGFjY29tcGFueWluZyBtYXRlcmlhbHMKICAq
IGFyZSBtYWRlIGF2YWlsYWJsZSB1bmRlciB0aGUgdGVybXMgb2YgdGhlIEVjbGlwc2UgUHVibGlj
IExpY2Vuc2UgdjEuMAogICogd2hpY2ggYWNjb21wYW5pZXMgdGhpcyBkaXN0cmlidXRpb24sIGFu
ZCBpcyBhdmFpbGFibGUgYXQKQEAgLTEwLDYgKzEwLDggQEAKICAqKioqKioqKioqKioqKioqKioq
KioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioq
KioqLwogCiBwYWNrYWdlIG9yZy5lY2xpcHNlLmpkdC5jb3JlLmRvbTsKKworaW1wb3J0IGphdmEu
dXRpbC5MaXN0OwogCiAvKioKICAqIEFic3RyYWN0IGJhc2UgY2xhc3Mgb2YgYWxsIEFTVCBub2Rl
IHR5cGVzIHRoYXQgZGVjbGFyZSBhIHNpbmdsZSBsb2NhbApAQCAtMTU2LDYgKzE1OCwxNiBAQAog
CSAqLwogCXB1YmxpYyBhYnN0cmFjdCB2b2lkIHNldEV4dHJhRGltZW5zaW9ucyhpbnQgZGltZW5z
aW9ucyk7CiAKKwkKKwkvKioKKwkgKiBSZXR1cm5zIHRoZSBleHRyYSBhbm5vdGF0YWJsZSBkaW1l
bnNpb24gdHlwZXMgb2YgdGhlIHNwZWNpZmllZCB0eXBlLiAoSkxTOCBvbmx5KQorCSAqIAorCSAq
IEByZXR1cm4gdGhlIGxpc3Qgb2YgZXh0cmEgZGltZW5zaW9uIHR5cGVzCisJICogQGV4Y2VwdGlv
biBJbGxlZ2FsQXJndW1lbnRFeGNlcHRpb24gaWYgc3BlY2lmaWVkIGFwaSBsZXZlbCBpcyBsb3dl
ciB0aGFuIEpMUzguCisJICogQHNpbmNlIDMuOQorCSAqLworCXB1YmxpYyBhYnN0cmFjdCBMaXN0
IGdldEV4dHJhRGltZW5zaW9uVHlwZXMoKTsKKwkKIAkvKioKIAkgKiBSZXR1cm5zIHRoZSBpbml0
aWFsaXplciBvZiB0aGlzIHZhcmlhYmxlIGRlY2xhcmF0aW9uLCBvcgogCSAqIDxjb2RlPm51bGw8
L2NvZGU+IGlmIHRoZXJlIGlzIG5vbmUuCmRpZmYgLS1naXQgYS9vcmcuZWNsaXBzZS5qZHQuY29y
ZS9kb20vb3JnL2VjbGlwc2UvamR0L2NvcmUvZG9tL1ZhcmlhYmxlRGVjbGFyYXRpb25GcmFnbWVu
dC5qYXZhIGIvb3JnLmVjbGlwc2UuamR0LmNvcmUvZG9tL29yZy9lY2xpcHNlL2pkdC9jb3JlL2Rv
bS9WYXJpYWJsZURlY2xhcmF0aW9uRnJhZ21lbnQuamF2YQppbmRleCBlOWRlN2M4Li4xYmQ4ODdh
IDEwMDY0NAotLS0gYS9vcmcuZWNsaXBzZS5qZHQuY29yZS9kb20vb3JnL2VjbGlwc2UvamR0L2Nv
cmUvZG9tL1ZhcmlhYmxlRGVjbGFyYXRpb25GcmFnbWVudC5qYXZhCisrKyBiL29yZy5lY2xpcHNl
LmpkdC5jb3JlL2RvbS9vcmcvZWNsaXBzZS9qZHQvY29yZS9kb20vVmFyaWFibGVEZWNsYXJhdGlv
bkZyYWdtZW50LmphdmEKQEAgLTQ2LDYgKzQ2LDEzIEBACiAJCW5ldyBTaW1wbGVQcm9wZXJ0eURl
c2NyaXB0b3IoVmFyaWFibGVEZWNsYXJhdGlvbkZyYWdtZW50LmNsYXNzLCAiZXh0cmFEaW1lbnNp
b25zIiwgaW50LmNsYXNzLCBNQU5EQVRPUlkpOyAvLyROT04tTkxTLTEkCiAKIAkvKioKKwkgKiBU
aGUgImV4dHJhRGltZW5zaW9uVHlwZXMiIHN0cnVjdHVyYWwgcHJvcGVydHkgb2YgdGhpcyBub2Rl
IHR5cGUgKGNoaWxkIHR5cGU6IHtAbGluayBEaW1lbnNpb25UeXBlfSkuCisJICogQHNpbmNlIDMu
OQorCSAqLworCXB1YmxpYyBzdGF0aWMgZmluYWwgQ2hpbGRMaXN0UHJvcGVydHlEZXNjcmlwdG9y
IEVYVFJBX0RJTUVOU0lPTl9UWVBFU19QUk9QRVJUWSA9CisJCQluZXcgQ2hpbGRMaXN0UHJvcGVy
dHlEZXNjcmlwdG9yKFZhcmlhYmxlRGVjbGFyYXRpb25GcmFnbWVudC5jbGFzcywgImV4dHJhRGlt
ZW5zaW9uVHlwZXMiLCBEaW1lbnNpb25UeXBlLmNsYXNzLCBOT19DWUNMRV9SSVNLKTsgLy8kTk9O
LU5MUy0xJAorCisJLyoqCiAJICogVGhlICJpbml0aWFsaXplciIgc3RydWN0dXJhbCBwcm9wZXJ0
eSBvZiB0aGlzIG5vZGUgdHlwZSAoY2hpbGQgdHlwZToge0BsaW5rIEV4cHJlc3Npb259KS4KIAkg
KiBAc2luY2UgMy4wCiAJICovCkBAIC01OSw2ICs2NiwxNCBAQAogCSAqIEBzaW5jZSAzLjAKIAkg
Ki8KIAlwcml2YXRlIHN0YXRpYyBmaW5hbCBMaXN0IFBST1BFUlRZX0RFU0NSSVBUT1JTOworCQor
CS8qKgorCSAqIEEgbGlzdCBvZiBwcm9wZXJ0eSBkZXNjcmlwdG9ycyAoZWxlbWVudCB0eXBlOgor
CSAqIHtAbGluayBTdHJ1Y3R1cmFsUHJvcGVydHlEZXNjcmlwdG9yfSksCisJICogb3IgbnVsbCBp
ZiB1bmluaXRpYWxpemVkLgorCSAqIEBzaW5jZSAzLjkKKwkgKi8KKwlwcml2YXRlIHN0YXRpYyBm
aW5hbCBMaXN0IFBST1BFUlRZX0RFU0NSSVBUT1JTXzhfMDsKIAogCXN0YXRpYyB7CiAJCUxpc3Qg
cHJvcGVydHlMaXN0ID0gbmV3IEFycmF5TGlzdCg0KTsKQEAgLTY3LDYgKzgyLDEzIEBACiAJCWFk
ZFByb3BlcnR5KEVYVFJBX0RJTUVOU0lPTlNfUFJPUEVSVFksIHByb3BlcnR5TGlzdCk7CiAJCWFk
ZFByb3BlcnR5KElOSVRJQUxJWkVSX1BST1BFUlRZLCBwcm9wZXJ0eUxpc3QpOwogCQlQUk9QRVJU
WV9ERVNDUklQVE9SUyA9IHJlYXBQcm9wZXJ0eUxpc3QocHJvcGVydHlMaXN0KTsKKwkJCisJCXBy
b3BlcnR5TGlzdCA9IG5ldyBBcnJheUxpc3QoNCk7CisJCWNyZWF0ZVByb3BlcnR5TGlzdChWYXJp
YWJsZURlY2xhcmF0aW9uRnJhZ21lbnQuY2xhc3MsIHByb3BlcnR5TGlzdCk7CisJCWFkZFByb3Bl
cnR5KE5BTUVfUFJPUEVSVFksIHByb3BlcnR5TGlzdCk7CisJCWFkZFByb3BlcnR5KEVYVFJBX0RJ
TUVOU0lPTl9UWVBFU19QUk9QRVJUWSwgcHJvcGVydHlMaXN0KTsKKwkJYWRkUHJvcGVydHkoSU5J
VElBTElaRVJfUFJPUEVSVFksIHByb3BlcnR5TGlzdCk7CisJCVBST1BFUlRZX0RFU0NSSVBUT1JT
XzhfMCA9IHJlYXBQcm9wZXJ0eUxpc3QocHJvcGVydHlMaXN0KTsKIAl9CiAKIAkvKioKQEAgLTgw
LDcgKzEwMiwxMSBAQAogCSAqIEBzaW5jZSAzLjAKIAkgKi8KIAlwdWJsaWMgc3RhdGljIExpc3Qg
cHJvcGVydHlEZXNjcmlwdG9ycyhpbnQgYXBpTGV2ZWwpIHsKLQkJcmV0dXJuIFBST1BFUlRZX0RF
U0NSSVBUT1JTOworCQlpZiAoYXBpTGV2ZWwgPj0gQVNULkpMUzgpIHsKKwkJCXJldHVybiBQUk9Q
RVJUWV9ERVNDUklQVE9SU184XzA7CisJCX0gZWxzZSB7CisJCQlyZXR1cm4gUFJPUEVSVFlfREVT
Q1JJUFRPUlM7CisJCX0KIAl9CiAKIAkvKioKQEAgLTk0LDYgKzEyMCwxMyBAQAogCSAqIGRlZmF1
bHRzIHRvIDAuCiAJICovCiAJcHJpdmF0ZSBpbnQgZXh0cmFBcnJheURpbWVuc2lvbnMgPSAwOwor
CQorCS8qKgorCSAqIFRoZSBleHRyYSBkaW1lbnNpb24gdHlwZXMgdGhpcyBub2RlIGhhcyB3aXRo
IGFubm90YXRpb25zIGlmIGFueS4KKwkgKiAKKwkgKiBAc2luY2UgMy45CisJICovCisJcHJvdGVj
dGVkIEFTVE5vZGUuTm9kZUxpc3QgZXh0cmFEaW1lbnNpb25UeXBlcyA9IG51bGw7CiAKIAkvKioK
IAkgKiBUaGUgaW5pdGlhbGl6ZXIgZXhwcmVzc2lvbiwgb3IgPGNvZGU+bnVsbDwvY29kZT4gaWYg
bm9uZTsKQEAgLTExMyw2ICsxNDYsOSBAQAogCSAqLwogCVZhcmlhYmxlRGVjbGFyYXRpb25GcmFn
bWVudChBU1QgYXN0KSB7CiAJCXN1cGVyKGFzdCk7CisJCWlmIChhc3QuYXBpTGV2ZWwgPj0gQVNU
LkpMUzgpIHsKKwkJCXRoaXMuZXh0cmFEaW1lbnNpb25UeXBlcyA9IG5ldyBBU1ROb2RlLk5vZGVM
aXN0KEVYVFJBX0RJTUVOU0lPTl9UWVBFU19QUk9QRVJUWSk7CisJCX0KIAl9CiAKIAkvKiAob21p
dCBqYXZhZG9jIGZvciB0aGlzIG1ldGhvZCkKQEAgLTE4OSw2ICsyMjUsMTcgQEAKIAkvKiAob21p
dCBqYXZhZG9jIGZvciB0aGlzIG1ldGhvZCkKIAkgKiBNZXRob2QgZGVjbGFyZWQgb24gQVNUTm9k
ZS4KIAkgKi8KKwlmaW5hbCBMaXN0IGludGVybmFsR2V0Q2hpbGRMaXN0UHJvcGVydHkoQ2hpbGRM
aXN0UHJvcGVydHlEZXNjcmlwdG9yIHByb3BlcnR5KSB7CisJCWlmIChwcm9wZXJ0eSA9PSBFWFRS
QV9ESU1FTlNJT05fVFlQRVNfUFJPUEVSVFkpIHsKKwkJCXJldHVybiB0aGlzLmV4dHJhRGltZW5z
aW9uVHlwZXM7CisJCX0KKwkJLy8gYWxsb3cgZGVmYXVsdCBpbXBsZW1lbnRhdGlvbiB0byBmbGFn
IHRoZSBlcnJvcgorCQlyZXR1cm4gc3VwZXIuaW50ZXJuYWxHZXRDaGlsZExpc3RQcm9wZXJ0eShw
cm9wZXJ0eSk7CisJfQorCisJLyogKG9taXQgamF2YWRvYyBmb3IgdGhpcyBtZXRob2QpCisJICog
TWV0aG9kIGRlY2xhcmVkIG9uIEFTVE5vZGUuCisJICovCiAJZmluYWwgaW50IGdldE5vZGVUeXBl
MCgpIHsKIAkJcmV0dXJuIFZBUklBQkxFX0RFQ0xBUkFUSU9OX0ZSQUdNRU5UOwogCX0KQEAgLTIw
MCw3ICsyNDcsMTMgQEAKIAkJVmFyaWFibGVEZWNsYXJhdGlvbkZyYWdtZW50IHJlc3VsdCA9IG5l
dyBWYXJpYWJsZURlY2xhcmF0aW9uRnJhZ21lbnQodGFyZ2V0KTsKIAkJcmVzdWx0LnNldFNvdXJj
ZVJhbmdlKGdldFN0YXJ0UG9zaXRpb24oKSwgZ2V0TGVuZ3RoKCkpOwogCQlyZXN1bHQuc2V0TmFt
ZSgoU2ltcGxlTmFtZSkgZ2V0TmFtZSgpLmNsb25lKHRhcmdldCkpOwotCQlyZXN1bHQuc2V0RXh0
cmFEaW1lbnNpb25zKGdldEV4dHJhRGltZW5zaW9ucygpKTsKKwkJaWYgKHRoaXMuYXN0LmFwaUxl
dmVsID49IEFTVC5KTFM4KSB7CisJCQlyZXN1bHQuZXh0cmFEaW1lbnNpb25UeXBlcyA9IG5ldyBB
U1ROb2RlLk5vZGVMaXN0KEVYVFJBX0RJTUVOU0lPTl9UWVBFU19QUk9QRVJUWSk7CisJCQlyZXN1
bHQuZXh0cmFEaW1lbnNpb25UeXBlcy5hZGRBbGwoCisJCQkJCUFTVE5vZGUuY29weVN1YnRyZWVz
KHRhcmdldCwgdGhpcy5leHRyYURpbWVuc2lvblR5cGVzKSk7CisJCX0gZWxzZSB7CisJCQlyZXN1
bHQuc2V0RXh0cmFEaW1lbnNpb25zKGdldEV4dHJhRGltZW5zaW9ucygpKTsKKwkJfQogCQlyZXN1
bHQuc2V0SW5pdGlhbGl6ZXIoCiAJCQkoRXhwcmVzc2lvbikgQVNUTm9kZS5jb3B5U3VidHJlZSh0
YXJnZXQsIGdldEluaXRpYWxpemVyKCkpKTsKIAkJcmV0dXJuIHJlc3VsdDsKQEAgLTIyMyw2ICsy
NzYsMTAgQEAKIAkJCS8vIHZpc2l0IGNoaWxkcmVuIGluIG5vcm1hbCBsZWZ0IHRvIHJpZ2h0IHJl
YWRpbmcgb3JkZXIKIAkJCWFjY2VwdENoaWxkKHZpc2l0b3IsIGdldE5hbWUoKSk7CiAJCQlhY2Nl
cHRDaGlsZCh2aXNpdG9yLCBnZXRJbml0aWFsaXplcigpKTsKKwkJCQorCQkJaWYgKHRoaXMuYXN0
LmFwaUxldmVsID49IEFTVC5KTFM4KSB7CisJCQkJYWNjZXB0Q2hpbGRyZW4odmlzaXRvciwgdGhp
cy5leHRyYURpbWVuc2lvblR5cGVzKTsKKwkJCX0KIAkJfQogCQl2aXNpdG9yLmVuZFZpc2l0KHRo
aXMpOwogCX0KQEAgLTI3Miw2ICszMjksNyBAQAogCSAqIEBzaW5jZSAyLjAKIAkgKi8KIAlwdWJs
aWMgaW50IGdldEV4dHJhRGltZW5zaW9ucygpIHsKKwkJc3VwcG9ydGVkT25seUluMl8zXzQoKTsK
IAkJcmV0dXJuIHRoaXMuZXh0cmFBcnJheURpbWVuc2lvbnM7CiAJfQogCkBAIC0yODksNiArMzQ3
LDcgQEAKIAkgKiBAc2luY2UgMi4wCiAJICovCiAJcHVibGljIHZvaWQgc2V0RXh0cmFEaW1lbnNp
b25zKGludCBkaW1lbnNpb25zKSB7CisJCXN1cHBvcnRlZE9ubHlJbjJfM180KCk7CiAJCWlmIChk
aW1lbnNpb25zIDwgMCkgewogCQkJdGhyb3cgbmV3IElsbGVnYWxBcmd1bWVudEV4Y2VwdGlvbigp
OwogCQl9CkBAIC0yOTYsNyArMzU1LDE4IEBACiAJCXRoaXMuZXh0cmFBcnJheURpbWVuc2lvbnMg
PSBkaW1lbnNpb25zOwogCQlwb3N0VmFsdWVDaGFuZ2UoRVhUUkFfRElNRU5TSU9OU19QUk9QRVJU
WSk7CiAJfQotCisJCisJLyoqCisJICogUmV0dXJucyB0aGUgbGl2ZSBvcmRlcmVkIGxpc3Qgb2Yg
ZXh0cmEgZGltZW5zaW9ucyB3aXRoIGFubm90YXRpb25zIGlmIGFueS4KKwkgKiAKKwkgKiBAcmV0
dXJuIHRoZSBsaXZlIGxpc3Qgb2YgZXh0cmEgZGltZW5zaW9ucyB3aXRoIGFubm90YXRpb25zIGlm
IGFueSAoZWxlbWVudCB0eXBlOiB7QGxpbmsgRGltZW5zaW9uVHlwZX1bXSkKKwkgKiBAc2luY2Ug
My45CisJICovCisJcHVibGljIExpc3QgZ2V0RXh0cmFEaW1lbnNpb25UeXBlcygpIHsKKwkJdW5z
dXBwb3J0ZWRJbjJfM180KCk7CisJCXJldHVybiB0aGlzLmV4dHJhRGltZW5zaW9uVHlwZXM7CisJ
fQorCQogCS8qIChvbWl0IGphdmFkb2MgZm9yIHRoaXMgbWV0aG9kKQogCSAqIE1ldGhvZCBkZWNs
YXJlZCBvbiBWYXJpYWJsZURlY2xhcmF0aW9uLgogCSAqLwpkaWZmIC0tZ2l0IGEvb3JnLmVjbGlw
c2UuamR0LmNvcmUvZG9tL29yZy9lY2xpcHNlL2pkdC9jb3JlL2RvbS9XaWxkY2FyZFR5cGUuamF2
YSBiL29yZy5lY2xpcHNlLmpkdC5jb3JlL2RvbS9vcmcvZWNsaXBzZS9qZHQvY29yZS9kb20vV2ls
ZGNhcmRUeXBlLmphdmEKaW5kZXggYWQ4ZmU4Yy4uOWYyMjIyMyAxMDA2NDQKLS0tIGEvb3JnLmVj
bGlwc2UuamR0LmNvcmUvZG9tL29yZy9lY2xpcHNlL2pkdC9jb3JlL2RvbS9XaWxkY2FyZFR5cGUu
amF2YQorKysgYi9vcmcuZWNsaXBzZS5qZHQuY29yZS9kb20vb3JnL2VjbGlwc2UvamR0L2NvcmUv
ZG9tL1dpbGRjYXJkVHlwZS5qYXZhCkBAIC0yMDUsNyArMjA1LDYgQEAKIAkJcmVzdWx0LnNldFNv
dXJjZVJhbmdlKGdldFN0YXJ0UG9zaXRpb24oKSwgZ2V0TGVuZ3RoKCkpOwogCQlyZXN1bHQuc2V0
Qm91bmQoKFR5cGUpIEFTVE5vZGUuY29weVN1YnRyZWUodGFyZ2V0LCBnZXRCb3VuZCgpKSwgaXNV
cHBlckJvdW5kKCkpOwogCQlpZiAodGhpcy5hc3QuYXBpTGV2ZWwgPj0gQVNULkpMUzgpIHsKLQkJ
CXJlc3VsdC5hbm5vdGF0aW9ucyA9IG5ldyBBU1ROb2RlLk5vZGVMaXN0KEFOTk9UQVRJT05TX1BS
T1BFUlRZKTsKIAkJCXJlc3VsdC5hbm5vdGF0aW9ucy5hZGRBbGwoCiAJCQkJCUFTVE5vZGUuY29w
eVN1YnRyZWVzKHRhcmdldCwgYW5ub3RhdGlvbnMoKSkpOwogCQl9CmRpZmYgLS1naXQgYS9vcmcu
ZWNsaXBzZS5qZHQuY29yZS9kb20vb3JnL2VjbGlwc2UvamR0L2ludGVybmFsL2NvcmUvZG9tL05h
aXZlQVNURmxhdHRlbmVyLmphdmEgYi9vcmcuZWNsaXBzZS5qZHQuY29yZS9kb20vb3JnL2VjbGlw
c2UvamR0L2ludGVybmFsL2NvcmUvZG9tL05haXZlQVNURmxhdHRlbmVyLmphdmEKaW5kZXggZWNj
ZWRhOS4uYWY2N2IwYSAxMDA2NDQKLS0tIGEvb3JnLmVjbGlwc2UuamR0LmNvcmUvZG9tL29yZy9l
Y2xpcHNlL2pkdC9pbnRlcm5hbC9jb3JlL2RvbS9OYWl2ZUFTVEZsYXR0ZW5lci5qYXZhCisrKyBi
L29yZy5lY2xpcHNlLmpkdC5jb3JlL2RvbS9vcmcvZWNsaXBzZS9qZHQvaW50ZXJuYWwvY29yZS9k
b20vTmFpdmVBU1RGbGF0dGVuZXIuamF2YQpAQCAtNDUsNiArNDUsNyBAQAogaW1wb3J0IG9yZy5l
Y2xpcHNlLmpkdC5jb3JlLmRvbS5Db25kaXRpb25hbEV4cHJlc3Npb247CiBpbXBvcnQgb3JnLmVj
bGlwc2UuamR0LmNvcmUuZG9tLkNvbnN0cnVjdG9ySW52b2NhdGlvbjsKIGltcG9ydCBvcmcuZWNs
aXBzZS5qZHQuY29yZS5kb20uQ29udGludWVTdGF0ZW1lbnQ7CitpbXBvcnQgb3JnLmVjbGlwc2Uu
amR0LmNvcmUuZG9tLkRpbWVuc2lvblR5cGU7CiBpbXBvcnQgb3JnLmVjbGlwc2UuamR0LmNvcmUu
ZG9tLlVuaW9uVHlwZTsKIGltcG9ydCBvcmcuZWNsaXBzZS5qZHQuY29yZS5kb20uRG9TdGF0ZW1l
bnQ7CiBpbXBvcnQgb3JnLmVjbGlwc2UuamR0LmNvcmUuZG9tLkVtcHR5U3RhdGVtZW50OwpAQCAt
NDEzLDYgKzQxNCwxNiBAQAogCQlub2RlLmdldENvbXBvbmVudFR5cGUoKS5hY2NlcHQodGhpcyk7
CiAJCXZpc2l0VHlwZUFubm90YXRpb25zKG5vZGUpOwogCQl0aGlzLmJ1ZmZlci5hcHBlbmQoIltd
Iik7Ly8kTk9OLU5MUy0xJAorCQlyZXR1cm4gZmFsc2U7CisJfQorCisJcHVibGljIGJvb2xlYW4g
dmlzaXQoRGltZW5zaW9uVHlwZSBub2RlKSB7CisJCXZpc2l0VHlwZUFubm90YXRpb25zKG5vZGUp
OworCQl0aGlzLmJ1ZmZlci5hcHBlbmQoIlsiKTsgLy8kTk9OLU5MUy0xJAorCQlpZiAobm9kZS5l
eHByZXNzaW9uKCkgIT0gbnVsbCkgeworCQkJbm9kZS5leHByZXNzaW9uKCkuYWNjZXB0KHRoaXMp
OworCQl9CisJCXRoaXMuYnVmZmVyLmFwcGVuZCgiXSIpOyAvLyROT04tTkxTLTEkCiAJCXJldHVy
biBmYWxzZTsKIAl9CiAKQEAgLTEwMzcsOCArMTA0OCwxNSBAQAogCQkJfQogCQl9CiAJCXRoaXMu
YnVmZmVyLmFwcGVuZCgiKSIpOy8vJE5PTi1OTFMtMSQKLQkJZm9yIChpbnQgaSA9IDA7IGkgPCBu
b2RlLmdldEV4dHJhRGltZW5zaW9ucygpOyBpKyspIHsKLQkJCXRoaXMuYnVmZmVyLmFwcGVuZCgi
W10iKTsgLy8kTk9OLU5MUy0xJAorCQlpZiAobm9kZS5nZXRBU1QoKS5hcGlMZXZlbCgpID49IEFT
VC5KTFM4KSB7CisJCQlMaXN0IGRpbWVuc2lvbnMgPSBub2RlLmdldGV4dHJhRGltZW5zaW9uVHlw
ZXMoKTsKKwkJCWZvciAoaW50IGkgPSAwOyBpIDwgZGltZW5zaW9ucy5zaXplKCk7IGkrKykgewor
CQkJCXZpc2l0KChEaW1lbnNpb25UeXBlKSBkaW1lbnNpb25zLmdldChpKSk7CisJCQl9CisJCX0g
ZWxzZSB7CisJCQlmb3IgKGludCBpID0gMDsgaSA8IG5vZGUuZ2V0RXh0cmFEaW1lbnNpb25zKCk7
IGkrKykgeworCQkJCXRoaXMuYnVmZmVyLmFwcGVuZCgiW10iKTsgLy8kTk9OLU5MUy0xJAorCQkJ
fQogCQl9CiAJCWlmIChub2RlLmdldEFTVCgpLmFwaUxldmVsKCkgPCBBU1QuSkxTOCkgewogCQkJ
aWYgKCFub2RlLnRocm93bkV4Y2VwdGlvbnMoKS5pc0VtcHR5KCkpIHsKQEAgLTEzNzMsOCArMTM5
MSwxNSBAQAogCQl9CiAJCXRoaXMuYnVmZmVyLmFwcGVuZCgiICIpOy8vJE5PTi1OTFMtMSQKIAkJ
bm9kZS5nZXROYW1lKCkuYWNjZXB0KHRoaXMpOwotCQlmb3IgKGludCBpID0gMDsgaSA8IG5vZGUu
Z2V0RXh0cmFEaW1lbnNpb25zKCk7IGkrKykgewotCQkJdGhpcy5idWZmZXIuYXBwZW5kKCJbXSIp
OyAvLyROT04tTkxTLTEkCisJCWlmIChub2RlLmdldEFTVCgpLmFwaUxldmVsKCkgPj0gQVNULkpM
UzgpIHsKKwkJCUxpc3QgZGltZW5zaW9ucyA9IG5vZGUuZ2V0RXh0cmFEaW1lbnNpb25UeXBlcygp
OworCQkJZm9yIChpbnQgaSA9IDA7IGkgPCBkaW1lbnNpb25zLnNpemUoKTsgaSsrKSB7CisJCQkJ
dmlzaXQoKERpbWVuc2lvblR5cGUpIGRpbWVuc2lvbnMuZ2V0KGkpKTsKKwkJCX0KKwkJfSBlbHNl
IHsKKwkJCWZvciAoaW50IGkgPSAwOyBpIDwgbm9kZS5nZXRFeHRyYURpbWVuc2lvbnMoKTsgaSsr
KSB7CisJCQkJdGhpcy5idWZmZXIuYXBwZW5kKCJbXSIpOyAvLyROT04tTkxTLTEkCisJCQl9CiAJ
CX0KIAkJaWYgKG5vZGUuZ2V0SW5pdGlhbGl6ZXIoKSAhPSBudWxsKSB7CiAJCQl0aGlzLmJ1ZmZl
ci5hcHBlbmQoIj0iKTsvLyROT04tTkxTLTEkCkBAIC0xNzk0LDggKzE4MTksMTUgQEAKIAkgKi8K
IAlwdWJsaWMgYm9vbGVhbiB2aXNpdChWYXJpYWJsZURlY2xhcmF0aW9uRnJhZ21lbnQgbm9kZSkg
ewogCQlub2RlLmdldE5hbWUoKS5hY2NlcHQodGhpcyk7Ci0JCWZvciAoaW50IGkgPSAwOyBpIDwg
bm9kZS5nZXRFeHRyYURpbWVuc2lvbnMoKTsgaSsrKSB7Ci0JCQl0aGlzLmJ1ZmZlci5hcHBlbmQo
IltdIik7Ly8kTk9OLU5MUy0xJAorCQlpZiAobm9kZS5nZXRBU1QoKS5hcGlMZXZlbCgpID49IEFT
VC5KTFM4KSB7CisJCQlMaXN0IGRpbWVuc2lvbnMgPSBub2RlLmdldEV4dHJhRGltZW5zaW9uVHlw
ZXMoKTsKKwkJCWZvciAoaW50IGkgPSAwOyBpIDwgZGltZW5zaW9ucy5zaXplKCk7IGkrKykgewor
CQkJCXZpc2l0KChEaW1lbnNpb25UeXBlKSBkaW1lbnNpb25zLmdldChpKSk7CisJCQl9CisJCX0g
ZWxzZSB7CisJCQlmb3IgKGludCBpID0gMDsgaSA8IG5vZGUuZ2V0RXh0cmFEaW1lbnNpb25zKCk7
IGkrKykgeworCQkJCXRoaXMuYnVmZmVyLmFwcGVuZCgiW10iKTsvLyROT04tTkxTLTEkCisJCQl9
CiAJCX0KIAkJaWYgKG5vZGUuZ2V0SW5pdGlhbGl6ZXIoKSAhPSBudWxsKSB7CiAJCQl0aGlzLmJ1
ZmZlci5hcHBlbmQoIj0iKTsvLyROT04tTkxTLTEkCmRpZmYgLS1naXQgYS9vcmcuZWNsaXBzZS5q
ZHQuY29yZS9kb20vb3JnL2VjbGlwc2UvamR0L2ludGVybmFsL2NvcmUvZG9tL3Jld3JpdGUvQVNU
UmV3cml0ZUZsYXR0ZW5lci5qYXZhIGIvb3JnLmVjbGlwc2UuamR0LmNvcmUvZG9tL29yZy9lY2xp
cHNlL2pkdC9pbnRlcm5hbC9jb3JlL2RvbS9yZXdyaXRlL0FTVFJld3JpdGVGbGF0dGVuZXIuamF2
YQppbmRleCBjZWYwMzAxLi44YmQzODc3IDEwMDY0NAotLS0gYS9vcmcuZWNsaXBzZS5qZHQuY29y
ZS9kb20vb3JnL2VjbGlwc2UvamR0L2ludGVybmFsL2NvcmUvZG9tL3Jld3JpdGUvQVNUUmV3cml0
ZUZsYXR0ZW5lci5qYXZhCisrKyBiL29yZy5lY2xpcHNlLmpkdC5jb3JlL2RvbS9vcmcvZWNsaXBz
ZS9qZHQvaW50ZXJuYWwvY29yZS9kb20vcmV3cml0ZS9BU1RSZXdyaXRlRmxhdHRlbmVyLmphdmEK
QEAgLTIyNiw5ICsyMjYsMTkgQEAKIAlwdWJsaWMgYm9vbGVhbiB2aXNpdChBcnJheVR5cGUgbm9k
ZSkgewogCQlnZXRDaGlsZE5vZGUobm9kZSwgQXJyYXlUeXBlLkNPTVBPTkVOVF9UWVBFX1BST1BF
UlRZKS5hY2NlcHQodGhpcyk7CiAJCWlmIChub2RlLmdldEFTVCgpLmFwaUxldmVsKCkgPj0gQVNU
LkpMUzgpIHsKLQkJCXZpc2l0TGlzdChub2RlLCBBcnJheVR5cGUuQU5OT1RBVElPTlNfUFJPUEVS
VFksIFN0cmluZy52YWx1ZU9mKCcgJyksIFV0aWwuRU1QVFlfU1RSSU5HLCBTdHJpbmcudmFsdWVP
ZignICcpKTsKKwkJCXZpc2l0TGlzdChub2RlLCBBcnJheVR5cGUuQU5OT1RBVElPTlNfUFJPUEVS
VFksIFN0cmluZy52YWx1ZU9mKCcgJyksIFV0aWwuRU1QVFlfU1RSSU5HLCBVdGlsLkVNUFRZX1NU
UklORyk7CiAJCX0KIAkJdGhpcy5yZXN1bHQuYXBwZW5kKCJbXSIpOyAvLyROT04tTkxTLTEkCisJ
CXJldHVybiBmYWxzZTsKKwl9CisJCisJcHVibGljIGJvb2xlYW4gdmlzaXQoRGltZW5zaW9uVHlw
ZSBub2RlKSB7CisJCXZpc2l0TGlzdChub2RlLCBBcnJheVR5cGUuQU5OT1RBVElPTlNfUFJPUEVS
VFksIFN0cmluZy52YWx1ZU9mKCcgJyksIFV0aWwuRU1QVFlfU1RSSU5HLCBVdGlsLkVNUFRZX1NU
UklORyk7CisJCXRoaXMucmVzdWx0LmFwcGVuZCgiWyIpOyAvLyROT04tTkxTLTEkCisJCWlmIChu
b2RlLmV4cHJlc3Npb24oKSAhPSBudWxsKSB7CisJCQlub2RlLmV4cHJlc3Npb24oKS5hY2NlcHQo
dGhpcyk7CisJCX0KKwkJdGhpcy5yZXN1bHQuYXBwZW5kKCJdIik7IC8vJE5PTi1OTFMtMSQKIAkJ
cmV0dXJuIGZhbHNlOwogCX0KIApAQCAtNzg4LDkgKzc5OCwxMyBAQAogCQl9CiAJCXRoaXMucmVz
dWx0LmFwcGVuZCgnICcpOwogCQlnZXRDaGlsZE5vZGUobm9kZSwgU2luZ2xlVmFyaWFibGVEZWNs
YXJhdGlvbi5OQU1FX1BST1BFUlRZKS5hY2NlcHQodGhpcyk7Ci0JCWludCBleHRyYURpbWVuc2lv
bnM9IGdldEludEF0dHJpYnV0ZShub2RlLCBTaW5nbGVWYXJpYWJsZURlY2xhcmF0aW9uLkVYVFJB
X0RJTUVOU0lPTlNfUFJPUEVSVFkpOwotCQlmb3IgKGludCBpID0gMDsgaSA8IGV4dHJhRGltZW5z
aW9uczsgaSsrKSB7Ci0JCQl0aGlzLnJlc3VsdC5hcHBlbmQoIltdIik7IC8vJE5PTi1OTFMtMSQK
KwkJaWYgKG5vZGUuZ2V0QVNUKCkuYXBpTGV2ZWwoKSA+PSBBU1QuSkxTOCkgeworCQkJdmlzaXRM
aXN0KG5vZGUsIFNpbmdsZVZhcmlhYmxlRGVjbGFyYXRpb24uRVhUUkFfRElNRU5TSU9OX1RZUEVT
X1BST1BFUlRZLCBTdHJpbmcudmFsdWVPZignICcpLCBVdGlsLkVNUFRZX1NUUklORywgVXRpbC5F
TVBUWV9TVFJJTkcpOworCQl9IGVsc2UgeworCQkJaW50IGV4dHJhRGltZW5zaW9ucz0gZ2V0SW50
QXR0cmlidXRlKG5vZGUsIFNpbmdsZVZhcmlhYmxlRGVjbGFyYXRpb24uRVhUUkFfRElNRU5TSU9O
U19QUk9QRVJUWSk7CisJCQlmb3IgKGludCBpID0gMDsgaSA8IGV4dHJhRGltZW5zaW9uczsgaSsr
KSB7CisJCQkJdGhpcy5yZXN1bHQuYXBwZW5kKCJbXSIpOyAvLyROT04tTkxTLTEkCisJCQl9CiAJ
CX0KIAkJQVNUTm9kZSBpbml0aWFsaXplcj0gZ2V0Q2hpbGROb2RlKG5vZGUsIFNpbmdsZVZhcmlh
YmxlRGVjbGFyYXRpb24uSU5JVElBTElaRVJfUFJPUEVSVFkpOwogCQlpZiAoaW5pdGlhbGl6ZXIg
IT0gbnVsbCkgewpAQCAtMTAzMyw5ICsxMDQ3LDEzIEBACiAJICovCiAJcHVibGljIGJvb2xlYW4g
dmlzaXQoVmFyaWFibGVEZWNsYXJhdGlvbkZyYWdtZW50IG5vZGUpIHsKIAkJZ2V0Q2hpbGROb2Rl
KG5vZGUsIFZhcmlhYmxlRGVjbGFyYXRpb25GcmFnbWVudC5OQU1FX1BST1BFUlRZKS5hY2NlcHQo
dGhpcyk7Ci0JCWludCBleHRyYURpbWVuc2lvbnM9IGdldEludEF0dHJpYnV0ZShub2RlLCBWYXJp
YWJsZURlY2xhcmF0aW9uRnJhZ21lbnQuRVhUUkFfRElNRU5TSU9OU19QUk9QRVJUWSk7Ci0JCWZv
ciAoaW50IGkgPSAwOyBpIDwgZXh0cmFEaW1lbnNpb25zOyBpKyspIHsKLQkJCXRoaXMucmVzdWx0
LmFwcGVuZCgiW10iKTsgLy8kTk9OLU5MUy0xJAorCQlpZiAobm9kZS5nZXRBU1QoKS5hcGlMZXZl
bCgpID49IEFTVC5KTFM4KSB7CisJCQl2aXNpdExpc3Qobm9kZSwgVmFyaWFibGVEZWNsYXJhdGlv
bkZyYWdtZW50LkVYVFJBX0RJTUVOU0lPTl9UWVBFU19QUk9QRVJUWSwgU3RyaW5nLnZhbHVlT2Yo
JyAnKSwgVXRpbC5FTVBUWV9TVFJJTkcsIFV0aWwuRU1QVFlfU1RSSU5HKTsKKwkJfSBlbHNlIHsK
KwkJCWludCBleHRyYURpbWVuc2lvbnM9IGdldEludEF0dHJpYnV0ZShub2RlLCBWYXJpYWJsZURl
Y2xhcmF0aW9uRnJhZ21lbnQuRVhUUkFfRElNRU5TSU9OU19QUk9QRVJUWSk7CisJCQlmb3IgKGlu
dCBpID0gMDsgaSA8IGV4dHJhRGltZW5zaW9uczsgaSsrKSB7CisJCQkJdGhpcy5yZXN1bHQuYXBw
ZW5kKCJbXSIpOyAvLyROT04tTkxTLTEkCisJCQl9CiAJCX0KIAkJQVNUTm9kZSBpbml0aWFsaXpl
cj0gZ2V0Q2hpbGROb2RlKG5vZGUsIFZhcmlhYmxlRGVjbGFyYXRpb25GcmFnbWVudC5JTklUSUFM
SVpFUl9QUk9QRVJUWSk7CiAJCWlmIChpbml0aWFsaXplciAhPSBudWxsKSB7
</data>

          </attachment>
          <attachment
              isobsolete="1"
              ispatch="1"
              isprivate="0"
          >
            <attachid>226117</attachid>
            <date>2013-01-25 11:44:00 -0500</date>
            <delta_ts>2013-01-28 01:34:07 -0500</delta_ts>
            <desc>Updated patch</desc>
            <filename>Fix-for-bug-391895.patch</filename>
            <type>text/plain</type>
            <size>72282</size>
            <attacher name="Jay Arthanareeswaran">jarthana</attacher>
            
              <data encoding="base64">ZGlmZiAtLWdpdCBhL29yZy5lY2xpcHNlLmpkdC5jb3JlLnRlc3RzLm1vZGVsL3NyYy9vcmcvZWNs
aXBzZS9qZHQvY29yZS90ZXN0cy9kb20vQVNUQ29udmVydGVyMTVKTFM4VGVzdC5qYXZhIGIvb3Jn
LmVjbGlwc2UuamR0LmNvcmUudGVzdHMubW9kZWwvc3JjL29yZy9lY2xpcHNlL2pkdC9jb3JlL3Rl
c3RzL2RvbS9BU1RDb252ZXJ0ZXIxNUpMUzhUZXN0LmphdmEKaW5kZXggZjRiMTUyOC4uMmU1ZDM5
ZCAxMDA2NDQKLS0tIGEvb3JnLmVjbGlwc2UuamR0LmNvcmUudGVzdHMubW9kZWwvc3JjL29yZy9l
Y2xpcHNlL2pkdC9jb3JlL3Rlc3RzL2RvbS9BU1RDb252ZXJ0ZXIxNUpMUzhUZXN0LmphdmEKKysr
IGIvb3JnLmVjbGlwc2UuamR0LmNvcmUudGVzdHMubW9kZWwvc3JjL29yZy9lY2xpcHNlL2pkdC9j
b3JlL3Rlc3RzL2RvbS9BU1RDb252ZXJ0ZXIxNUpMUzhUZXN0LmphdmEKQEAgLTEsNSArMSw1IEBA
CiAvKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioq
KioqKioqKioqKioqKioqKioqKioqKioqKgotICogQ29weXJpZ2h0IChjKSAyMDExLCAyMDEyIElC
TSBDb3Jwb3JhdGlvbiBhbmQgb3RoZXJzLgorICogQ29weXJpZ2h0IChjKSAyMDExLCAyMDEzIElC
TSBDb3Jwb3JhdGlvbiBhbmQgb3RoZXJzLgogICogQWxsIHJpZ2h0cyByZXNlcnZlZC4gVGhpcyBw
cm9ncmFtIGFuZCB0aGUgYWNjb21wYW55aW5nIG1hdGVyaWFscwogICogYXJlIG1hZGUgYXZhaWxh
YmxlIHVuZGVyIHRoZSB0ZXJtcyBvZiB0aGUgRWNsaXBzZSBQdWJsaWMgTGljZW5zZSB2MS4wCiAg
KiB3aGljaCBhY2NvbXBhbmllcyB0aGlzIGRpc3RyaWJ1dGlvbiwgYW5kIGlzIGF2YWlsYWJsZSBh
dApAQCAtNTE2LDcgKzUxNiw3IEBACiAJCWNoZWNrU291cmNlUmFuZ2UoKEFTVE5vZGUpIG1vZGlm
aWVyLCAiQEZvbyIsIHNvdXJjZSk7CiAJCW1vZGlmaWVyID0gKElFeHRlbmRlZE1vZGlmaWVyKSBt
b2RpZmllcnMuZ2V0KDEpOwogCQljaGVja1NvdXJjZVJhbmdlKChBU1ROb2RlKSBtb2RpZmllciwg
ImZpbmFsIiwgc291cmNlKTsKLQkJYXNzZXJ0RXF1YWxzKCJXcm9uZyBkaW1lbnNpb24iLCAxLCBz
aW5nbGVWYXJpYWJsZURlY2xhcmF0aW9uLmdldEV4dHJhRGltZW5zaW9ucygpKTsKKwkJYXNzZXJ0
RXF1YWxzKCJXcm9uZyBkaW1lbnNpb24iLCAxLCBzaW5nbGVWYXJpYWJsZURlY2xhcmF0aW9uLmdl
dEV4dHJhRGltZW5zaW9uVHlwZXMoKS5zaXplKCkpOwogCQlUeXBlIHR5cGUgPSBzaW5nbGVWYXJp
YWJsZURlY2xhcmF0aW9uLmdldFR5cGUoKTsKIAkJY2hlY2tTb3VyY2VSYW5nZSh0eXBlLCAiU3Ry
aW5nIiwgc291cmNlKTsKIAkJYXNzZXJ0RXF1YWxzKCJXcm9uZyBuYW1lIiwgInMiLCBzaW1wbGVO
YW1lLmdldElkZW50aWZpZXIoKSk7CkBAIC0xNzA5LDcgKzE3MDksNyBAQAogCQlhc3NlcnRUcnVl
KCJub3QgYW4gYXJyYXkgdHlwZSIsIHR5cGUuaXNBcnJheVR5cGUoKSk7CiAJCUFycmF5VHlwZSBh
cnJheVR5cGUgPSAoQXJyYXlUeXBlKSB0eXBlOwogCQljaGVja1NvdXJjZVJhbmdlKGFycmF5VHlw
ZS5nZXRDb21wb25lbnRUeXBlKCksICJTdHJpbmciLCBzb3VyY2UpOwotCQlhc3NlcnRFcXVhbHMo
Ildyb25nIGV4dHJhIGRpbWVuc2lvbnMiLCAxLCBzaW5nbGVWYXJpYWJsZURlY2xhcmF0aW9uLmdl
dEV4dHJhRGltZW5zaW9ucygpKTsKKwkJYXNzZXJ0RXF1YWxzKCJXcm9uZyBleHRyYSBkaW1lbnNp
b25zIiwgMSwgc2luZ2xlVmFyaWFibGVEZWNsYXJhdGlvbi5nZXRFeHRyYURpbWVuc2lvblR5cGVz
KCkuc2l6ZSgpKTsKIAl9CiAKIAkvKioKQEAgLTE3MzcsNyArMTczNyw3IEBACiAJCWFzc2VydFRy
dWUoIm5vdCBhbiBhcnJheSB0eXBlIiwgdHlwZS5pc0FycmF5VHlwZSgpKTsKIAkJQXJyYXlUeXBl
IGFycmF5VHlwZSA9IChBcnJheVR5cGUpIHR5cGU7CiAJCWNoZWNrU291cmNlUmFuZ2UoYXJyYXlU
eXBlLmdldENvbXBvbmVudFR5cGUoKSwgIlN0cmluZyIsIHNvdXJjZSk7Ci0JCWFzc2VydEVxdWFs
cygiV3JvbmcgZXh0cmEgZGltZW5zaW9ucyIsIDAsIHNpbmdsZVZhcmlhYmxlRGVjbGFyYXRpb24u
Z2V0RXh0cmFEaW1lbnNpb25zKCkpOworCQlhc3NlcnRFcXVhbHMoIldyb25nIGV4dHJhIGRpbWVu
c2lvbnMiLCAwLCBzaW5nbGVWYXJpYWJsZURlY2xhcmF0aW9uLmdldEV4dHJhRGltZW5zaW9uVHlw
ZXMoKS5zaXplKCkpOwogCX0KIAkvKioKIAkgKiBodHRwczovL2J1Z3MuZWNsaXBzZS5vcmcvYnVn
cy9zaG93X2J1Zy5jZ2k/aWQ9NzYxMDMKZGlmZiAtLWdpdCBhL29yZy5lY2xpcHNlLmpkdC5jb3Jl
LnRlc3RzLm1vZGVsL3NyYy9vcmcvZWNsaXBzZS9qZHQvY29yZS90ZXN0cy9kb20vQVNUQ29udmVy
dGVyMThUZXN0LmphdmEgYi9vcmcuZWNsaXBzZS5qZHQuY29yZS50ZXN0cy5tb2RlbC9zcmMvb3Jn
L2VjbGlwc2UvamR0L2NvcmUvdGVzdHMvZG9tL0FTVENvbnZlcnRlcjE4VGVzdC5qYXZhCmluZGV4
IDA2MWM5MTYuLmE0OGUzZGIgMTAwNjQ0Ci0tLSBhL29yZy5lY2xpcHNlLmpkdC5jb3JlLnRlc3Rz
Lm1vZGVsL3NyYy9vcmcvZWNsaXBzZS9qZHQvY29yZS90ZXN0cy9kb20vQVNUQ29udmVydGVyMThU
ZXN0LmphdmEKKysrIGIvb3JnLmVjbGlwc2UuamR0LmNvcmUudGVzdHMubW9kZWwvc3JjL29yZy9l
Y2xpcHNlL2pkdC9jb3JlL3Rlc3RzL2RvbS9BU1RDb252ZXJ0ZXIxOFRlc3QuamF2YQpAQCAtMTAx
Nyw0ICsxMDE3LDU3IEBACiAJCWFzc2VydE5vdE51bGwoIkluY29ycmVjdCByZWNlaXZlciBxdWFs
ZmllciIsIG1ldGhvZC5nZXRSZWNlaXZlclF1YWxpZmllcigpKTsKIAkJYXNzZXJ0RXF1YWxzKCJJ
bmNvcnJlY3QgcmVjZWl2ZXIgcXVhbGZpZXIiLCAiWCIsIG1ldGhvZC5nZXRSZWNlaXZlclF1YWxp
ZmllcigpLmdldEZ1bGx5UXVhbGlmaWVkTmFtZSgpKTsKIAl9CisJLy8gaHR0cHM6Ly9idWdzLmVj
bGlwc2Uub3JnL2J1Z3Mvc2hvd19idWcuY2dpP2lkPTM5MTg5NQorCXB1YmxpYyB2b2lkIHRlc3Qw
MDA5KCkgdGhyb3dzIEphdmFNb2RlbEV4Y2VwdGlvbiB7CisJCVN0cmluZyBjb250ZW50cyA9CisJ
CQkJImltcG9ydCBqYXZhLmxhbmcuYW5ub3RhdGlvbi5FbGVtZW50VHlwZTtcbiIgKworCQkJCQkJ
InB1YmxpYyBjbGFzcyBYIHtcbiIgKworCQkJCQkJIiAJY2xhc3MgWSB7XG4iICsKKwkJCQkJCSIJ
CUBBbm5vdCBpbnQgQEFubm90MSBbXSBhIEBBbm5vdDIgQEFubm90MyBbXSBAQW5ub3QzIEBBbm5v
dDIgW10gQEFubm90NCBbXSwgYiBAQW5ub3QyIEBBbm5vdDMgW10gQEFubm90NCBbXSwgYyBbXVtd
W107XG4iICsgIAorCQkJCQkJIgkJcHVibGljIHZvaWQgZm9vMShAQW5ub3QgaW50IEBBbm5vdDEg
W10gcCBAQW5ub3QyIEBBbm5vdDMgW10gQEFubm90MyBAQW5ub3QyIFtdIEBBbm5vdDQgQEFubm90
MyBbXSkge31cbiIgKworCQkJCQkJIgkJcHVibGljIHZvaWQgZm9vMihAQW5ub3QgaW50IHAgW11b
XSkge31cbiIgKworCQkJCQkJIgkJQEFubm90IFN0cmluZyBAQW5ub3QxIFtdIGZvbzMoKSBAQW5u
b3QxIEBBbm5vdDIgW11bXSB7IHJldHVybiBudWxsOyB9XG4iICsgCisJCQkJCQkiCX1cbiIgKwor
CQkJCQkJIn1cbiIgKworCQkJCQkJIkBqYXZhLmxhbmcuYW5ub3RhdGlvbi5UYXJnZXQodmFsdWUg
PSB7RWxlbWVudFR5cGUuVFlQRV9VU0V9KVxuIiArIAorCQkJCQkJIkBpbnRlcmZhY2UgQW5ub3Qg
e31cbiIgKworCQkJCQkJIkBqYXZhLmxhbmcuYW5ub3RhdGlvbi5UYXJnZXQodmFsdWUgPSB7RWxl
bWVudFR5cGUuVFlQRV9VU0V9KVxuIiArIAorCQkJCQkJIkBpbnRlcmZhY2UgQW5ub3QxIHt9XG4i
ICsKKwkJCQkJCSJAamF2YS5sYW5nLmFubm90YXRpb24uVGFyZ2V0KHZhbHVlID0ge0VsZW1lbnRU
eXBlLlRZUEVfVVNFfSlcbiIgKworCQkJCQkJIkBpbnRlcmZhY2UgQW5ub3QyIHt9XG4iICsKKwkJ
CQkJCSJAamF2YS5sYW5nLmFubm90YXRpb24uVGFyZ2V0KHZhbHVlID0ge0VsZW1lbnRUeXBlLlRZ
UEVfVVNFfSlcbiIgKyAKKwkJCQkJCSJAaW50ZXJmYWNlIEFubm90MyB7fVxuIiArCisJCQkJCQki
QGphdmEubGFuZy5hbm5vdGF0aW9uLlRhcmdldCh2YWx1ZSA9IHtFbGVtZW50VHlwZS5UWVBFX1VT
RX0pXG4iICsKKwkJCQkJCSJAaW50ZXJmYWNlIEFubm90NCB7fSI7CisJCXRoaXMud29ya2luZ0Nv
cHkgPSBnZXRXb3JraW5nQ29weSgiL0NvbnZlcnRlcjE4L3NyYy9YLmphdmEiLCB0cnVlKTsKKwkJ
QVNUTm9kZSBub2RlID0gYnVpbGRBU1QoY29udGVudHMsIHRoaXMud29ya2luZ0NvcHkpOworCQlh
c3NlcnRFcXVhbHMoIk5vdCBhIGNvbXBpbGF0aW9uIHVuaXQiLCBBU1ROb2RlLkNPTVBJTEFUSU9O
X1VOSVQsIG5vZGUuZ2V0Tm9kZVR5cGUoKSk7CisJCUNvbXBpbGF0aW9uVW5pdCB1bml0ID0gKENv
bXBpbGF0aW9uVW5pdCkgbm9kZTsKKwkJbm9kZSA9IGdldEFTVE5vZGUodW5pdCwgMCwgMCk7CisJ
CWFzc2VydEVxdWFscygiTm90IGEgdHlwZSBEZWNsYXJhdGlvbiIsIEFTVE5vZGUuVFlQRV9ERUNM
QVJBVElPTiwgbm9kZS5nZXROb2RlVHlwZSgpKTsKKwkJVHlwZURlY2xhcmF0aW9uIHR5cGUgPSAo
VHlwZURlY2xhcmF0aW9uKSBub2RlOworCQlGaWVsZERlY2xhcmF0aW9uIGZpZWxkID0gdHlwZS5n
ZXRGaWVsZHMoKVswXTsKKwkJTGlzdCBmcmFnbWVudHMgPSBmaWVsZC5mcmFnbWVudHMoKTsKKwkJ
YXNzZXJ0RXF1YWxzKCJJbmNvcnJlY3Qgbm8gb2YgZnJhZ21lbnRzIiwgMywgZnJhZ21lbnRzLnNp
emUoKSk7CisJCVZhcmlhYmxlRGVjbGFyYXRpb25GcmFnbWVudCBmcmFnbWVudCA9IChWYXJpYWJs
ZURlY2xhcmF0aW9uRnJhZ21lbnQpIGZyYWdtZW50cy5nZXQoMCk7CisJCWFzc2VydEV4dHJhRGlt
ZW5zaW9uc0VxdWFsKCJJbmNvcnJlY3QgZGltZW5zaW9uIHR5cGUiLCBmcmFnbWVudC5nZXRFeHRy
YURpbWVuc2lvblR5cGVzKCksICJAQW5ub3QyIEBBbm5vdDMgW10gQEFubm90MyBAQW5ub3QyIFtd
IEBBbm5vdDQgW10iKTsKKwkJZnJhZ21lbnQgPSAoVmFyaWFibGVEZWNsYXJhdGlvbkZyYWdtZW50
KSBmcmFnbWVudHMuZ2V0KDEpOworCQlhc3NlcnRFeHRyYURpbWVuc2lvbnNFcXVhbCgiSW5jb3Jy
ZWN0IGRpbWVuc2lvbiB0eXBlIiwgZnJhZ21lbnQuZ2V0RXh0cmFEaW1lbnNpb25UeXBlcygpLCAi
QEFubm90MiBAQW5ub3QzIFtdIEBBbm5vdDQgW10iKTsJCQorCQlmcmFnbWVudCA9IChWYXJpYWJs
ZURlY2xhcmF0aW9uRnJhZ21lbnQpIGZyYWdtZW50cy5nZXQoMik7CisJCWFzc2VydEV4dHJhRGlt
ZW5zaW9uc0VxdWFsKCJJbmNvcnJlY3QgZGltZW5zaW9uIHR5cGUiLCBmcmFnbWVudC5nZXRFeHRy
YURpbWVuc2lvblR5cGVzKCksICJbXSBbXSBbXSIpOworCQlNZXRob2REZWNsYXJhdGlvbltdIG1l
dGhvZHMgPSB0eXBlLmdldE1ldGhvZHMoKTsKKwkJYXNzZXJ0RXF1YWxzKCJJbmNvcnJlY3Qgbm8g
b2YgbWV0aG9kcyIsIDMsIG1ldGhvZHMubGVuZ3RoKTsKKwkJTWV0aG9kRGVjbGFyYXRpb24gbWV0
aG9kID0gbWV0aG9kc1swXTsKKwkJTGlzdCBwYXJhbWV0ZXJzID0gbWV0aG9kLnBhcmFtZXRlcnMo
KTsKKwkJYXNzZXJ0RXF1YWxzKCJJbmNvcnJlY3Qgbm8gb2YgcGFyYW1ldGVycyIsIDEsIHBhcmFt
ZXRlcnMuc2l6ZSgpKTsKKwkJYXNzZXJ0RXh0cmFEaW1lbnNpb25zRXF1YWwoIkluY29ycmVjdCBk
aW1lbnNpb24gdHlwZSIsICgoU2luZ2xlVmFyaWFibGVEZWNsYXJhdGlvbikgcGFyYW1ldGVycy5n
ZXQoMCkpLmdldEV4dHJhRGltZW5zaW9uVHlwZXMoKSwgIkBBbm5vdDIgQEFubm90MyBbXSBAQW5u
b3QzIEBBbm5vdDIgW10gQEFubm90NCBAQW5ub3QzIFtdIik7CisKKwkJbWV0aG9kID0gbWV0aG9k
c1sxXTsKKwkJcGFyYW1ldGVycyA9IG1ldGhvZC5wYXJhbWV0ZXJzKCk7CisJCWFzc2VydEVxdWFs
cygiSW5jb3JyZWN0IG5vIG9mIHBhcmFtZXRlcnMiLCAxLCBwYXJhbWV0ZXJzLnNpemUoKSk7CisJ
CWFzc2VydEV4dHJhRGltZW5zaW9uc0VxdWFsKCJJbmNvcnJlY3QgZGltZW5zaW9uIHR5cGUiLCAo
KFNpbmdsZVZhcmlhYmxlRGVjbGFyYXRpb24pIHBhcmFtZXRlcnMuZ2V0KDApKS5nZXRFeHRyYURp
bWVuc2lvblR5cGVzKCksICJbXSBbXSIpOworCisJCW1ldGhvZCA9IG1ldGhvZHNbMl07CisJCWFz
c2VydEV4dHJhRGltZW5zaW9uc0VxdWFsKCJJbmNvcnJlY3QgZGltZW5zaW9uIHR5cGUiLCBtZXRo
b2QuZ2V0RXh0cmFEaW1lbnNpb25UeXBlcygpLCAiQEFubm90MSBAQW5ub3QyIFtdIFtdIik7CisJ
fQogfQpkaWZmIC0tZ2l0IGEvb3JnLmVjbGlwc2UuamR0LmNvcmUudGVzdHMubW9kZWwvc3JjL29y
Zy9lY2xpcHNlL2pkdC9jb3JlL3Rlc3RzL2RvbS9BU1RDb252ZXJ0ZXJBU1Q4VGVzdC5qYXZhIGIv
b3JnLmVjbGlwc2UuamR0LmNvcmUudGVzdHMubW9kZWwvc3JjL29yZy9lY2xpcHNlL2pkdC9jb3Jl
L3Rlc3RzL2RvbS9BU1RDb252ZXJ0ZXJBU1Q4VGVzdC5qYXZhCmluZGV4IDkyN2FiM2YuLjI0NWQ5
ZWYgMTAwNjQ0Ci0tLSBhL29yZy5lY2xpcHNlLmpkdC5jb3JlLnRlc3RzLm1vZGVsL3NyYy9vcmcv
ZWNsaXBzZS9qZHQvY29yZS90ZXN0cy9kb20vQVNUQ29udmVydGVyQVNUOFRlc3QuamF2YQorKysg
Yi9vcmcuZWNsaXBzZS5qZHQuY29yZS50ZXN0cy5tb2RlbC9zcmMvb3JnL2VjbGlwc2UvamR0L2Nv
cmUvdGVzdHMvZG9tL0FTVENvbnZlcnRlckFTVDhUZXN0LmphdmEKQEAgLTM3LDYgKzM3LDcgQEAK
IAogCXN0YXRpYyB7CiAvLwkJVEVTVFNfTlVNQkVSUyA9IG5ldyBpbnRbXSB7IDM1NiB9OworLy8J
CVRFU1RTX05BTUVTID0gbmV3IFN0cmluZ1tdeyAidGVzdDAzOTMiIH07CiAJfQogCXB1YmxpYyBz
dGF0aWMgVGVzdCBzdWl0ZSgpIHsKIAkJcmV0dXJuIGJ1aWxkTW9kZWxUZXN0U3VpdGUoQVNUQ29u
dmVydGVyQVNUOFRlc3QuY2xhc3MpOwpAQCAtMTk5Miw3ICsxOTkzLDcgQEAKIAkJdmFyaWFibGVE
ZWNsYXJhdGlvbi5zZXROYW1lKHRoaXMuYXN0Lm5ld1NpbXBsZU5hbWUoInMiKSk7IC8vJE5PTi1O
TFMtMSQKIAkJYXNzZXJ0VHJ1ZSgiQm90aCBBU1QgdHJlZXMgc2hvdWxkIGJlIGlkZW50aWNhbCIs
IHZhcmlhYmxlRGVjbGFyYXRpb24uc3VidHJlZU1hdGNoKG5ldyBBU1RNYXRjaGVyKCksIG5vZGUp
KTsJCS8vJE5PTi1OTFMtMSQKIAkJY2hlY2tTb3VyY2VSYW5nZShub2RlLCAiZmluYWwgU3RyaW5n
IHMiLCBzb3VyY2UpOyAvLyROT04tTkxTLTEkCi0JCWFzc2VydEVxdWFscygiV3JvbmcgZGltZW5z
aW9uIiwgMCwgbm9kZS5nZXRFeHRyYURpbWVuc2lvbnMoKSk7IC8vJE5PTi1OTFMtMSQKKwkJYXNz
ZXJ0RXF1YWxzKCJXcm9uZyBkaW1lbnNpb24iLCAwLCBub2RlLmdldEV4dHJhRGltZW5zaW9uVHlw
ZXMoKS5zaXplKCkpOyAvLyROT04tTkxTLTEkCiAJfQogCiAJLyoqCkBAIC0yNzE4LDIwICsyNzE5
LDIzIEBACiAJCU51bWJlckxpdGVyYWwgbGl0ZXJhbCA9IHRoaXMuYXN0Lm5ld051bWJlckxpdGVy
YWwoKTsKIAkJbGl0ZXJhbC5zZXRUb2tlbigiMTAiKTsvLyROT04tTkxTLTEkCiAJCWZyYWdtZW50
LnNldEluaXRpYWxpemVyKGxpdGVyYWwpOwotCQlmcmFnbWVudC5zZXRFeHRyYURpbWVuc2lvbnMo
MCk7CisJCWZyYWdtZW50LmdldEV4dHJhRGltZW5zaW9uVHlwZXMoKS5jbGVhcigpOwogCQlWYXJp
YWJsZURlY2xhcmF0aW9uU3RhdGVtZW50IHN0YXRlbWVudCA9IHRoaXMuYXN0Lm5ld1ZhcmlhYmxl
RGVjbGFyYXRpb25TdGF0ZW1lbnQoZnJhZ21lbnQpOwogCQlmcmFnbWVudCA9IHRoaXMuYXN0Lm5l
d1ZhcmlhYmxlRGVjbGFyYXRpb25GcmFnbWVudCgpOwogCQlmcmFnbWVudC5zZXROYW1lKHRoaXMu
YXN0Lm5ld1NpbXBsZU5hbWUoInoiKSk7Ly8kTk9OLU5MUy0xJAogCQlmcmFnbWVudC5zZXRJbml0
aWFsaXplcih0aGlzLmFzdC5uZXdOdWxsTGl0ZXJhbCgpKTsKLQkJZnJhZ21lbnQuc2V0RXh0cmFE
aW1lbnNpb25zKDEpOworCQlmcmFnbWVudC5nZXRFeHRyYURpbWVuc2lvblR5cGVzKCkuY2xlYXIo
KTsKKwkJZnJhZ21lbnQuZ2V0RXh0cmFEaW1lbnNpb25UeXBlcygpLmFkZCh0aGlzLmFzdC5uZXdE
aW1lbnNpb25UeXBlKG51bGwpKTsKIAkJc3RhdGVtZW50LmZyYWdtZW50cygpLmFkZChmcmFnbWVu
dCk7CiAJCWZyYWdtZW50ID0gdGhpcy5hc3QubmV3VmFyaWFibGVEZWNsYXJhdGlvbkZyYWdtZW50
KCk7CiAJCWZyYWdtZW50LnNldE5hbWUodGhpcy5hc3QubmV3U2ltcGxlTmFtZSgiaSIpKTsvLyRO
T04tTkxTLTEkCi0JCWZyYWdtZW50LnNldEV4dHJhRGltZW5zaW9ucygwKTsKKwkJZnJhZ21lbnQu
Z2V0RXh0cmFEaW1lbnNpb25UeXBlcygpLmNsZWFyKCk7CiAJCXN0YXRlbWVudC5mcmFnbWVudHMo
KS5hZGQoZnJhZ21lbnQpOwogCQlmcmFnbWVudCA9IHRoaXMuYXN0Lm5ld1ZhcmlhYmxlRGVjbGFy
YXRpb25GcmFnbWVudCgpOwogCQlmcmFnbWVudC5zZXROYW1lKHRoaXMuYXN0Lm5ld1NpbXBsZU5h
bWUoImoiKSk7Ly8kTk9OLU5MUy0xJAotCQlmcmFnbWVudC5zZXRFeHRyYURpbWVuc2lvbnMoMik7
CisJCWZyYWdtZW50LmdldEV4dHJhRGltZW5zaW9uVHlwZXMoKS5jbGVhcigpOworCQlmcmFnbWVu
dC5nZXRFeHRyYURpbWVuc2lvblR5cGVzKCkuYWRkKHRoaXMuYXN0Lm5ld0RpbWVuc2lvblR5cGUo
bnVsbCkpOworCQlmcmFnbWVudC5nZXRFeHRyYURpbWVuc2lvblR5cGVzKCkuYWRkKHRoaXMuYXN0
Lm5ld0RpbWVuc2lvblR5cGUobnVsbCkpOwogCQlzdGF0ZW1lbnQuZnJhZ21lbnRzKCkuYWRkKGZy
YWdtZW50KTsKIAkJc3RhdGVtZW50LnNldFR5cGUodGhpcy5hc3QubmV3UHJpbWl0aXZlVHlwZShQ
cmltaXRpdmVUeXBlLklOVCkpOwogCQlhc3NlcnRUcnVlKCJCb3RoIEFTVCB0cmVlcyBzaG91bGQg
YmUgaWRlbnRpY2FsIiwgc3RhdGVtZW50LnN1YnRyZWVNYXRjaChuZXcgQVNUTWF0Y2hlcigpLCBu
b2RlKSk7CQkvLyROT04tTkxTLTEkCkBAIC0yNzU4LDIwICsyNzYyLDIzIEBACiAJCU51bWJlckxp
dGVyYWwgbGl0ZXJhbCA9IHRoaXMuYXN0Lm5ld051bWJlckxpdGVyYWwoKTsKIAkJbGl0ZXJhbC5z
ZXRUb2tlbigiMTAiKTsvLyROT04tTkxTLTEkCiAJCWZyYWdtZW50LnNldEluaXRpYWxpemVyKGxp
dGVyYWwpOwotCQlmcmFnbWVudC5zZXRFeHRyYURpbWVuc2lvbnMoMCk7CisJCWZyYWdtZW50Lmdl
dEV4dHJhRGltZW5zaW9uVHlwZXMoKS5jbGVhcigpOwogCQlWYXJpYWJsZURlY2xhcmF0aW9uU3Rh
dGVtZW50IHN0YXRlbWVudCA9IHRoaXMuYXN0Lm5ld1ZhcmlhYmxlRGVjbGFyYXRpb25TdGF0ZW1l
bnQoZnJhZ21lbnQpOwogCQlmcmFnbWVudCA9IHRoaXMuYXN0Lm5ld1ZhcmlhYmxlRGVjbGFyYXRp
b25GcmFnbWVudCgpOwogCQlmcmFnbWVudC5zZXROYW1lKHRoaXMuYXN0Lm5ld1NpbXBsZU5hbWUo
InoiKSk7Ly8kTk9OLU5MUy0xJAogCQlmcmFnbWVudC5zZXRJbml0aWFsaXplcih0aGlzLmFzdC5u
ZXdOdWxsTGl0ZXJhbCgpKTsKLQkJZnJhZ21lbnQuc2V0RXh0cmFEaW1lbnNpb25zKDEpOworCQlm
cmFnbWVudC5nZXRFeHRyYURpbWVuc2lvblR5cGVzKCkuY2xlYXIoKTsKKwkJZnJhZ21lbnQuZ2V0
RXh0cmFEaW1lbnNpb25UeXBlcygpLmFkZCh0aGlzLmFzdC5uZXdEaW1lbnNpb25UeXBlKG51bGwp
KTsKIAkJc3RhdGVtZW50LmZyYWdtZW50cygpLmFkZChmcmFnbWVudCk7CiAJCWZyYWdtZW50ID0g
dGhpcy5hc3QubmV3VmFyaWFibGVEZWNsYXJhdGlvbkZyYWdtZW50KCk7CiAJCWZyYWdtZW50LnNl
dE5hbWUodGhpcy5hc3QubmV3U2ltcGxlTmFtZSgiaSIpKTsvLyROT04tTkxTLTEkCi0JCWZyYWdt
ZW50LnNldEV4dHJhRGltZW5zaW9ucygwKTsKKwkJZnJhZ21lbnQuZ2V0RXh0cmFEaW1lbnNpb25U
eXBlcygpLmNsZWFyKCk7CiAJCXN0YXRlbWVudC5mcmFnbWVudHMoKS5hZGQoZnJhZ21lbnQpOwog
CQlmcmFnbWVudCA9IHRoaXMuYXN0Lm5ld1ZhcmlhYmxlRGVjbGFyYXRpb25GcmFnbWVudCgpOwog
CQlmcmFnbWVudC5zZXROYW1lKHRoaXMuYXN0Lm5ld1NpbXBsZU5hbWUoImoiKSk7Ly8kTk9OLU5M
Uy0xJAotCQlmcmFnbWVudC5zZXRFeHRyYURpbWVuc2lvbnMoMik7CisJCWZyYWdtZW50LmdldEV4
dHJhRGltZW5zaW9uVHlwZXMoKS5jbGVhcigpOworCQlmcmFnbWVudC5nZXRFeHRyYURpbWVuc2lv
blR5cGVzKCkuYWRkKHRoaXMuYXN0Lm5ld0RpbWVuc2lvblR5cGUobnVsbCkpOworCQlmcmFnbWVu
dC5nZXRFeHRyYURpbWVuc2lvblR5cGVzKCkuYWRkKHRoaXMuYXN0Lm5ld0RpbWVuc2lvblR5cGUo
bnVsbCkpOwogCQlzdGF0ZW1lbnQuZnJhZ21lbnRzKCkuYWRkKGZyYWdtZW50KTsKIAkJc3RhdGVt
ZW50LnNldFR5cGUodGhpcy5hc3QubmV3QXJyYXlUeXBlKHRoaXMuYXN0Lm5ld1ByaW1pdGl2ZVR5
cGUoUHJpbWl0aXZlVHlwZS5JTlQpLCAxKSk7CiAJCWFzc2VydFRydWUoIkJvdGggQVNUIHRyZWVz
IHNob3VsZCBiZSBpZGVudGljYWwiLCBzdGF0ZW1lbnQuc3VidHJlZU1hdGNoKG5ldyBBU1RNYXRj
aGVyKCksIG5vZGUpKTsJCS8vJE5PTi1OTFMtMSQKQEAgLTI3OTcsNyArMjgwNCw4IEBACiAJCVZh
cmlhYmxlRGVjbGFyYXRpb25GcmFnbWVudCB2YXJpYWJsZURlY2xhcmF0aW9uRnJhZ21lbnQgPSB0
aGlzLmFzdC5uZXdWYXJpYWJsZURlY2xhcmF0aW9uRnJhZ21lbnQoKTsKIAkJdmFyaWFibGVEZWNs
YXJhdGlvbkZyYWdtZW50LnNldE5hbWUodGhpcy5hc3QubmV3U2ltcGxlTmFtZSgidGFiIikpOyAv
LyROT04tTkxTLTEkCiAJCXZhcmlhYmxlRGVjbGFyYXRpb25GcmFnbWVudC5zZXRJbml0aWFsaXpl
cih0aGlzLmFzdC5uZXdOdWxsTGl0ZXJhbCgpKTsvLyROT04tTkxTLTEkCi0JCXZhcmlhYmxlRGVj
bGFyYXRpb25GcmFnbWVudC5zZXRFeHRyYURpbWVuc2lvbnMoMSk7CisJCXZhcmlhYmxlRGVjbGFy
YXRpb25GcmFnbWVudC5nZXRFeHRyYURpbWVuc2lvblR5cGVzKCkuY2xlYXIoKTsKKwkJdmFyaWFi
bGVEZWNsYXJhdGlvbkZyYWdtZW50LmdldEV4dHJhRGltZW5zaW9uVHlwZXMoKS5hZGQodGhpcy5h
c3QubmV3RGltZW5zaW9uVHlwZShudWxsKSk7CiAJCVZhcmlhYmxlRGVjbGFyYXRpb25FeHByZXNz
aW9uIHZhcmlhYmxlRGVjbGFyYXRpb25FeHByZXNzaW9uID0gdGhpcy5hc3QubmV3VmFyaWFibGVE
ZWNsYXJhdGlvbkV4cHJlc3Npb24odmFyaWFibGVEZWNsYXJhdGlvbkZyYWdtZW50KTsKIAkJdmFy
aWFibGVEZWNsYXJhdGlvbkV4cHJlc3Npb24uc2V0VHlwZSh0aGlzLmFzdC5uZXdBcnJheVR5cGUo
dGhpcy5hc3QubmV3U2ltcGxlVHlwZSh0aGlzLmFzdC5uZXdTaW1wbGVOYW1lKCJTdHJpbmciKSks
IDEpKTsvLyROT04tTkxTLTEkCiAJCWZvclN0YXRlbWVudC5pbml0aWFsaXplcnMoKS5hZGQodmFy
aWFibGVEZWNsYXJhdGlvbkV4cHJlc3Npb24pOwpAQCAtMjgyNSw3ICsyODMzLDggQEAKIAkJVmFy
aWFibGVEZWNsYXJhdGlvbkZyYWdtZW50IHZhcmlhYmxlRGVjbGFyYXRpb25GcmFnbWVudCA9IHRo
aXMuYXN0Lm5ld1ZhcmlhYmxlRGVjbGFyYXRpb25GcmFnbWVudCgpOwogCQl2YXJpYWJsZURlY2xh
cmF0aW9uRnJhZ21lbnQuc2V0TmFtZSh0aGlzLmFzdC5uZXdTaW1wbGVOYW1lKCJ0YWIiKSk7IC8v
JE5PTi1OTFMtMSQKIAkJdmFyaWFibGVEZWNsYXJhdGlvbkZyYWdtZW50LnNldEluaXRpYWxpemVy
KHRoaXMuYXN0Lm5ld051bGxMaXRlcmFsKCkpOy8vJE5PTi1OTFMtMSQKLQkJdmFyaWFibGVEZWNs
YXJhdGlvbkZyYWdtZW50LnNldEV4dHJhRGltZW5zaW9ucygxKTsKKwkJdmFyaWFibGVEZWNsYXJh
dGlvbkZyYWdtZW50LmdldEV4dHJhRGltZW5zaW9uVHlwZXMoKS5jbGVhcigpOworCQl2YXJpYWJs
ZURlY2xhcmF0aW9uRnJhZ21lbnQuZ2V0RXh0cmFEaW1lbnNpb25UeXBlcygpLmFkZCh0aGlzLmFz
dC5uZXdEaW1lbnNpb25UeXBlKG51bGwpKTsKIAkJVmFyaWFibGVEZWNsYXJhdGlvbkV4cHJlc3Np
b24gdmFyaWFibGVEZWNsYXJhdGlvbkV4cHJlc3Npb24gPSB0aGlzLmFzdC5uZXdWYXJpYWJsZURl
Y2xhcmF0aW9uRXhwcmVzc2lvbih2YXJpYWJsZURlY2xhcmF0aW9uRnJhZ21lbnQpOwogCQl2YXJp
YWJsZURlY2xhcmF0aW9uRXhwcmVzc2lvbi5zZXRUeXBlKHRoaXMuYXN0Lm5ld1NpbXBsZVR5cGUo
dGhpcy5hc3QubmV3U2ltcGxlTmFtZSgiU3RyaW5nIikpKTsvLyROT04tTkxTLTEkCiAJCWZvclN0
YXRlbWVudC5pbml0aWFsaXplcnMoKS5hZGQodmFyaWFibGVEZWNsYXJhdGlvbkV4cHJlc3Npb24p
OwpAQCAtMjg1Myw3ICsyODYyLDggQEAKIAkJVmFyaWFibGVEZWNsYXJhdGlvbkZyYWdtZW50IHZh
cmlhYmxlRGVjbGFyYXRpb25GcmFnbWVudCA9IHRoaXMuYXN0Lm5ld1ZhcmlhYmxlRGVjbGFyYXRp
b25GcmFnbWVudCgpOwogCQl2YXJpYWJsZURlY2xhcmF0aW9uRnJhZ21lbnQuc2V0TmFtZSh0aGlz
LmFzdC5uZXdTaW1wbGVOYW1lKCJ0YWIiKSk7IC8vJE5PTi1OTFMtMSQKIAkJdmFyaWFibGVEZWNs
YXJhdGlvbkZyYWdtZW50LnNldEluaXRpYWxpemVyKHRoaXMuYXN0Lm5ld051bGxMaXRlcmFsKCkp
Oy8vJE5PTi1OTFMtMSQKLQkJdmFyaWFibGVEZWNsYXJhdGlvbkZyYWdtZW50LnNldEV4dHJhRGlt
ZW5zaW9ucygxKTsKKwkJdmFyaWFibGVEZWNsYXJhdGlvbkZyYWdtZW50LmdldEV4dHJhRGltZW5z
aW9uVHlwZXMoKS5jbGVhcigpOworCQl2YXJpYWJsZURlY2xhcmF0aW9uRnJhZ21lbnQuZ2V0RXh0
cmFEaW1lbnNpb25UeXBlcygpLmFkZCh0aGlzLmFzdC5uZXdEaW1lbnNpb25UeXBlKG51bGwpKTsK
IAkJVmFyaWFibGVEZWNsYXJhdGlvbkV4cHJlc3Npb24gdmFyaWFibGVEZWNsYXJhdGlvbkV4cHJl
c3Npb24gPSB0aGlzLmFzdC5uZXdWYXJpYWJsZURlY2xhcmF0aW9uRXhwcmVzc2lvbih2YXJpYWJs
ZURlY2xhcmF0aW9uRnJhZ21lbnQpOwogCQl2YXJpYWJsZURlY2xhcmF0aW9uRXhwcmVzc2lvbi5z
ZXRUeXBlKHRoaXMuYXN0Lm5ld1NpbXBsZVR5cGUodGhpcy5hc3QubmV3U2ltcGxlTmFtZSgiU3Ry
aW5nIikpKTsvLyROT04tTkxTLTEkCiAJCWZvclN0YXRlbWVudC5pbml0aWFsaXplcnMoKS5hZGQo
dmFyaWFibGVEZWNsYXJhdGlvbkV4cHJlc3Npb24pOwpAQCAtMjg4Miw3ICsyODkyLDcgQEAKIAkJ
YXNzZXJ0VHJ1ZSgiTm90IGEgZGVjbGFyYXRpb24iLCBmcmFnLmdldE5hbWUoKS5pc0RlY2xhcmF0
aW9uKCkpOyAvLyROT04tTkxTLTEkCiAJCVZhcmlhYmxlRGVjbGFyYXRpb25GcmFnbWVudCBmcmFn
bWVudCA9IHRoaXMuYXN0Lm5ld1ZhcmlhYmxlRGVjbGFyYXRpb25GcmFnbWVudCgpOwogCQlmcmFn
bWVudC5zZXROYW1lKHRoaXMuYXN0Lm5ld1NpbXBsZU5hbWUoImkiKSk7IC8vJE5PTi1OTFMtMSQK
LQkJZnJhZ21lbnQuc2V0RXh0cmFEaW1lbnNpb25zKDApOworCQlmcmFnbWVudC5nZXRFeHRyYURp
bWVuc2lvblR5cGVzKCkuY2xlYXIoKTsKIAkJRmllbGREZWNsYXJhdGlvbiBmaWVsZERlY2xhcmF0
aW9uID0gdGhpcy5hc3QubmV3RmllbGREZWNsYXJhdGlvbihmcmFnbWVudCk7CiAJCWZpZWxkRGVj
bGFyYXRpb24uc2V0VHlwZSh0aGlzLmFzdC5uZXdQcmltaXRpdmVUeXBlKFByaW1pdGl2ZVR5cGUu
SU5UKSk7CiAJCWFzc2VydFRydWUoIkJvdGggQVNUIHRyZWVzIHNob3VsZCBiZSBpZGVudGljYWwi
LCBmaWVsZERlY2xhcmF0aW9uLnN1YnRyZWVNYXRjaChuZXcgQVNUTWF0Y2hlcigpLCBub2RlKSk7
CQkvLyROT04tTkxTLTEkCkBAIC0yOTA0LDIyICsyOTE0LDI1IEBACiAJCU51bWJlckxpdGVyYWwg
bGl0ZXJhbCA9IHRoaXMuYXN0Lm5ld051bWJlckxpdGVyYWwoKTsKIAkJbGl0ZXJhbC5zZXRUb2tl
bigiMTAiKTsgLy8kTk9OLU5MUy0xJAogCQlmcmFnbWVudC5zZXRJbml0aWFsaXplcihsaXRlcmFs
KTsKLQkJZnJhZ21lbnQuc2V0RXh0cmFEaW1lbnNpb25zKDApOworCQlmcmFnbWVudC5nZXRFeHRy
YURpbWVuc2lvblR5cGVzKCkuY2xlYXIoKTsKIAkJRmllbGREZWNsYXJhdGlvbiBmaWVsZERlY2xh
cmF0aW9uID0gdGhpcy5hc3QubmV3RmllbGREZWNsYXJhdGlvbihmcmFnbWVudCk7CiAJCWZpZWxk
RGVjbGFyYXRpb24ubW9kaWZpZXJzKCkuYWRkKHRoaXMuYXN0Lm5ld01vZGlmaWVyKE1vZGlmaWVy
Lk1vZGlmaWVyS2V5d29yZC5QVUJMSUNfS0VZV09SRCkpOwogCQlmaWVsZERlY2xhcmF0aW9uLnNl
dFR5cGUodGhpcy5hc3QubmV3UHJpbWl0aXZlVHlwZShQcmltaXRpdmVUeXBlLklOVCkpOwogCQlm
cmFnbWVudCA9IHRoaXMuYXN0Lm5ld1ZhcmlhYmxlRGVjbGFyYXRpb25GcmFnbWVudCgpOwogCQlm
cmFnbWVudC5zZXROYW1lKHRoaXMuYXN0Lm5ld1NpbXBsZU5hbWUoInkiKSk7Ly8kTk9OLU5MUy0x
JAotCQlmcmFnbWVudC5zZXRFeHRyYURpbWVuc2lvbnMoMSk7CisJCWZyYWdtZW50LmdldEV4dHJh
RGltZW5zaW9uVHlwZXMoKS5jbGVhcigpOworCQlmcmFnbWVudC5nZXRFeHRyYURpbWVuc2lvblR5
cGVzKCkuYWRkKHRoaXMuYXN0Lm5ld0RpbWVuc2lvblR5cGUobnVsbCkpOwogCQlmcmFnbWVudC5z
ZXRJbml0aWFsaXplcih0aGlzLmFzdC5uZXdOdWxsTGl0ZXJhbCgpKTsKIAkJZmllbGREZWNsYXJh
dGlvbi5mcmFnbWVudHMoKS5hZGQoZnJhZ21lbnQpOwogCQlmcmFnbWVudCA9IHRoaXMuYXN0Lm5l
d1ZhcmlhYmxlRGVjbGFyYXRpb25GcmFnbWVudCgpOwogCQlmcmFnbWVudC5zZXROYW1lKHRoaXMu
YXN0Lm5ld1NpbXBsZU5hbWUoImkiKSk7Ly8kTk9OLU5MUy0xJAotCQlmcmFnbWVudC5zZXRFeHRy
YURpbWVuc2lvbnMoMCk7CisJCWZyYWdtZW50LmdldEV4dHJhRGltZW5zaW9uVHlwZXMoKS5jbGVh
cigpOwogCQlmaWVsZERlY2xhcmF0aW9uLmZyYWdtZW50cygpLmFkZChmcmFnbWVudCk7CiAJCWZy
YWdtZW50ID0gdGhpcy5hc3QubmV3VmFyaWFibGVEZWNsYXJhdGlvbkZyYWdtZW50KCk7CiAJCWZy
YWdtZW50LnNldE5hbWUodGhpcy5hc3QubmV3U2ltcGxlTmFtZSgiaiIpKTsvLyROT04tTkxTLTEk
Ci0JCWZyYWdtZW50LnNldEV4dHJhRGltZW5zaW9ucygyKTsKKwkJZnJhZ21lbnQuZ2V0RXh0cmFE
aW1lbnNpb25UeXBlcygpLmNsZWFyKCk7CisJCWZyYWdtZW50LmdldEV4dHJhRGltZW5zaW9uVHlw
ZXMoKS5hZGQodGhpcy5hc3QubmV3RGltZW5zaW9uVHlwZShudWxsKSk7CisJCWZyYWdtZW50Lmdl
dEV4dHJhRGltZW5zaW9uVHlwZXMoKS5hZGQodGhpcy5hc3QubmV3RGltZW5zaW9uVHlwZShudWxs
KSk7CiAJCWZpZWxkRGVjbGFyYXRpb24uZnJhZ21lbnRzKCkuYWRkKGZyYWdtZW50KTsKIAkJYXNz
ZXJ0VHJ1ZSgiQm90aCBBU1QgdHJlZXMgc2hvdWxkIGJlIGlkZW50aWNhbCIsIGZpZWxkRGVjbGFy
YXRpb24uc3VidHJlZU1hdGNoKG5ldyBBU1RNYXRjaGVyKCksIG5vZGUpKTsJCS8vJE5PTi1OTFMt
MSQKIAkJY2hlY2tTb3VyY2VSYW5nZShub2RlLCAicHVibGljIGludCB4PSAxMCwgeVtdID0gbnVs
bCwgaSwgaltdW107Iiwgc291cmNlKTsgLy8kTk9OLU5MUy0xJApAQCAtOTU4NCwxMyArOTU5Nywx
NSBAQAogCQlhc3NlcnROb3ROdWxsKCJObyB0eXBlIGJpbmRpbmciLCB0eXBlQmluZGluZyk7IC8v
JE5PTi1OTFMtMSQKIAkJYXNzZXJ0RXF1YWxzKCJXcm9uZyBkaW1lbnNpb24iLCAwLCB0eXBlQmlu
ZGluZy5nZXREaW1lbnNpb25zKCkpOyAvLyROT04tTkxTLTEkCiAJCWFzc2VydEVxdWFscygiV3Jv
bmcgcXVhbGlmaWVkIG5hbWUiLCAiamF2YS5sYW5nLlN0cmluZyIsIHR5cGVCaW5kaW5nLmdldFF1
YWxpZmllZE5hbWUoKSk7IC8vJE5PTi1OTFMtMSQgLy8kTk9OLU5MUy0yJAotCQlhc3NlcnRFcXVh
bHMoIldyb25nIGRpbWVuc2lvbiIsIDEsIG1ldGhvZERlY2xhcmF0aW9uLmdldEV4dHJhRGltZW5z
aW9ucygpKTsgLy8kTk9OLU5MUy0xJAorCQlhc3NlcnRFcXVhbHMoIldyb25nIGRpbWVuc2lvbiIs
IDEsIG1ldGhvZERlY2xhcmF0aW9uLmdldEV4dHJhRGltZW5zaW9uVHlwZXMoKS5zaXplKCkpOyAv
LyROT04tTkxTLTEkCiAJCUlNZXRob2RCaW5kaW5nIG1ldGhvZEJpbmRpbmcgPSBtZXRob2REZWNs
YXJhdGlvbi5yZXNvbHZlQmluZGluZygpOwogCQlhc3NlcnROb3ROdWxsKCJObyBtZXRob2QgYmlu
ZGluZyIsIG1ldGhvZEJpbmRpbmcpOyAvLyROT04tTkxTLTEkCiAJCUlUeXBlQmluZGluZyB0eXBl
QmluZGluZzIgPSBtZXRob2RCaW5kaW5nLmdldFJldHVyblR5cGUoKTsKIAkJYXNzZXJ0Tm90TnVs
bCgiTm8gdHlwZSBiaW5kaW5nIiwgdHlwZUJpbmRpbmcyKTsgLy8kTk9OLU5MUy0xJAogCQlhc3Nl
cnRFcXVhbHMoIldyb25nIHF1YWxpZmllZCBuYW1lIiwgImphdmEubGFuZy5TdHJpbmdbXSIsIHR5
cGVCaW5kaW5nMi5nZXRRdWFsaWZpZWROYW1lKCkpOyAvLyROT04tTkxTLTEkIC8vJE5PTi1OTFMt
MiQKIAkJYXNzZXJ0RXF1YWxzKCJXcm9uZyBkaW1lbnNpb24iLCAxLCB0eXBlQmluZGluZzIuZ2V0
RGltZW5zaW9ucygpKTsgLy8kTk9OLU5MUy0xJAorCQlMaXN0IGV4dHJhRGltZW5zaW9ucyA9IG1l
dGhvZERlY2xhcmF0aW9uLmdldEV4dHJhRGltZW5zaW9uVHlwZXMoKTsKKwkJYXNzZXJ0RXh0cmFE
aW1lbnNpb25zRXF1YWwoIldyb25nIGV4dHJhIGRpbWVuc2lvbiBpbmZvIiwgZXh0cmFEaW1lbnNp
b25zLCAiW10iKTsKIAl9CiAKIAkvKioKQEAgLTk2MTMsNyArOTYyOCw3IEBACiAJCUlUeXBlQmlu
ZGluZyB0eXBlQmluZGluZyA9IHR5cGUucmVzb2x2ZUJpbmRpbmcoKTsKIAkJYXNzZXJ0Tm90TnVs
bCgiTm8gdHlwZSBiaW5kaW5nIiwgdHlwZUJpbmRpbmcpOyAvLyROT04tTkxTLTEkCiAJCWFzc2Vy
dEVxdWFscygiV3JvbmcgcXVhbGlmaWVkIG5hbWUiLCAiamF2YS5sYW5nLlN0cmluZyIsIHR5cGVC
aW5kaW5nLmdldFF1YWxpZmllZE5hbWUoKSk7IC8vJE5PTi1OTFMtMSQgLy8kTk9OLU5MUy0yJAot
CQlhc3NlcnRFcXVhbHMoIldyb25nIGRpbWVuc2lvbiIsIDAsIG1ldGhvZERlY2xhcmF0aW9uLmdl
dEV4dHJhRGltZW5zaW9ucygpKTsgLy8kTk9OLU5MUy0xJAorCQlhc3NlcnRFcXVhbHMoIldyb25n
IGRpbWVuc2lvbiIsIDAsIG1ldGhvZERlY2xhcmF0aW9uLmdldEV4dHJhRGltZW5zaW9uVHlwZXMo
KS5zaXplKCkpOyAvLyROT04tTkxTLTEkCiAJfQogCiAKQEAgLTk2MzgsNyArOTY1Myw3IEBACiAJ
CWFzc2VydE5vdE51bGwoIk5vIHR5cGUgYmluZGluZyIsIHR5cGVCaW5kaW5nKTsgLy8kTk9OLU5M
Uy0xJAogCQlhc3NlcnRFcXVhbHMoIldyb25nIGRpbWVuc2lvbiIsIDEsIHR5cGVCaW5kaW5nLmdl
dERpbWVuc2lvbnMoKSk7IC8vJE5PTi1OTFMtMSQKIAkJYXNzZXJ0RXF1YWxzKCJXcm9uZyBxdWFs
aWZpZWQgbmFtZSIsICJqYXZhLmxhbmcuU3RyaW5nW10iLCB0eXBlQmluZGluZy5nZXRRdWFsaWZp
ZWROYW1lKCkpOyAvLyROT04tTkxTLTEkIC8vJE5PTi1OTFMtMiQKLQkJYXNzZXJ0RXF1YWxzKCJX
cm9uZyBkaW1lbnNpb24iLCAxLCBtZXRob2REZWNsYXJhdGlvbi5nZXRFeHRyYURpbWVuc2lvbnMo
KSk7IC8vJE5PTi1OTFMtMSQKKwkJYXNzZXJ0RXF1YWxzKCJXcm9uZyBkaW1lbnNpb24iLCAxLCBt
ZXRob2REZWNsYXJhdGlvbi5nZXRFeHRyYURpbWVuc2lvblR5cGVzKCkuc2l6ZSgpKTsgLy8kTk9O
LU5MUy0xJAogCQlJTWV0aG9kQmluZGluZyBtZXRob2RCaW5kaW5nID0gbWV0aG9kRGVjbGFyYXRp
b24ucmVzb2x2ZUJpbmRpbmcoKTsKIAkJYXNzZXJ0Tm90TnVsbCgiTm8gbWV0aG9kIGJpbmRpbmci
LCBtZXRob2RCaW5kaW5nKTsgLy8kTk9OLU5MUy0xJAogCQlJVHlwZUJpbmRpbmcgdHlwZUJpbmRp
bmcyID0gbWV0aG9kQmluZGluZy5nZXRSZXR1cm5UeXBlKCk7CkBAIC05NjYzLDcgKzk2NzgsNyBA
QAogCQljaGVja1NvdXJjZVJhbmdlKHNpbmdsZVZhcmlhYmxlRGVjbGFyYXRpb24sICJmaW5hbCBT
dHJpbmcgc1tdIiwgc291cmNlKTsgLy8kTk9OLU5MUy0xJAogCQlUeXBlIHR5cGUgPSBzaW5nbGVW
YXJpYWJsZURlY2xhcmF0aW9uLmdldFR5cGUoKTsKIAkJY2hlY2tTb3VyY2VSYW5nZSh0eXBlLCAi
U3RyaW5nIiwgc291cmNlKTsgLy8kTk9OLU5MUy0xJAotCQlhc3NlcnRFcXVhbHMoIldyb25nIGRp
bWVuc2lvbiIsIDEsIHNpbmdsZVZhcmlhYmxlRGVjbGFyYXRpb24uZ2V0RXh0cmFEaW1lbnNpb25z
KCkpOyAvLyROT04tTkxTLTEkCisJCWFzc2VydEVxdWFscygiV3JvbmcgZGltZW5zaW9uIiwgMSwg
c2luZ2xlVmFyaWFibGVEZWNsYXJhdGlvbi5nZXRFeHRyYURpbWVuc2lvblR5cGVzKCkuc2l6ZSgp
KTsgLy8kTk9OLU5MUy0xJAogCQlJVHlwZUJpbmRpbmcgdHlwZUJpbmRpbmcgPSB0eXBlLnJlc29s
dmVCaW5kaW5nKCk7CiAJCWFzc2VydE5vdE51bGwoIk5vIHR5cGUgYmluZGluZyIsIHR5cGVCaW5k
aW5nKTsgLy8kTk9OLU5MUy0xJAogCQlhc3NlcnRUcnVlKCJBbiBhcnJheSBiaW5kaW5nIiwgIXR5
cGVCaW5kaW5nLmlzQXJyYXkoKSk7IC8vJE5PTi1OTFMtMSQKQEAgLTk2NzcsNiArOTY5Miw4IEBA
CiAJCWFzc2VydFRydWUoIk5vdCBhbiBhcnJheSBiaW5kaW5nIiwgdHlwZUJpbmRpbmcyLmlzQXJy
YXkoKSk7IC8vJE5PTi1OTFMtMSQKIAkJYXNzZXJ0RXF1YWxzKCJXcm9uZyBkaW1lbnNpb24iLCAx
LCB0eXBlQmluZGluZzIuZ2V0RGltZW5zaW9ucygpKTsgLy8kTk9OLU5MUy0xJAogCQlhc3NlcnRF
cXVhbHMoIndyb25nIGZ1bGx5IHF1YWxpZmllZCBuYW1lIiwgImphdmEubGFuZy5TdHJpbmdbXSIs
IHR5cGVCaW5kaW5nMi5nZXRRdWFsaWZpZWROYW1lKCkpOyAvLyROT04tTkxTLTEkIC8vJE5PTi1O
TFMtMiQKKwkJTGlzdCBleHRyYURpbWVuc2lvbnMgPSBzaW5nbGVWYXJpYWJsZURlY2xhcmF0aW9u
LmdldEV4dHJhRGltZW5zaW9uVHlwZXMoKTsKKwkJYXNzZXJ0RXh0cmFEaW1lbnNpb25zRXF1YWwo
Ildyb25nIGV4dHJhIGRpbWVuc2lvbiBpbmZvIiwgZXh0cmFEaW1lbnNpb25zLCAiW10iKTsKIAl9
CiAKIAkvKioKQEAgLTk2OTUsNyArOTcxMiw3IEBACiAJCWNoZWNrU291cmNlUmFuZ2Uoc2luZ2xl
VmFyaWFibGVEZWNsYXJhdGlvbiwgImZpbmFsIFN0cmluZ1tdIFxcdTAwNzNcXHUwMDVCXVtdIiwg
c291cmNlKTsgLy8kTk9OLU5MUy0xJAogCQlUeXBlIHR5cGUgPSBzaW5nbGVWYXJpYWJsZURlY2xh
cmF0aW9uLmdldFR5cGUoKTsKIAkJY2hlY2tTb3VyY2VSYW5nZSh0eXBlLCAiU3RyaW5nW10iLCBz
b3VyY2UpOyAvLyROT04tTkxTLTEkCi0JCWFzc2VydEVxdWFscygiV3JvbmcgZGltZW5zaW9uIiwg
Miwgc2luZ2xlVmFyaWFibGVEZWNsYXJhdGlvbi5nZXRFeHRyYURpbWVuc2lvbnMoKSk7IC8vJE5P
Ti1OTFMtMSQKKwkJYXNzZXJ0RXF1YWxzKCJXcm9uZyBkaW1lbnNpb24iLCAyLCBzaW5nbGVWYXJp
YWJsZURlY2xhcmF0aW9uLmdldEV4dHJhRGltZW5zaW9uVHlwZXMoKS5zaXplKCkpOyAvLyROT04t
TkxTLTEkCiAJCUlUeXBlQmluZGluZyB0eXBlQmluZGluZyA9IHR5cGUucmVzb2x2ZUJpbmRpbmco
KTsKIAkJYXNzZXJ0Tm90TnVsbCgiTm8gdHlwZSBiaW5kaW5nIiwgdHlwZUJpbmRpbmcpOyAvLyRO
T04tTkxTLTEkCiAJCWFzc2VydFRydWUoIk5vdCBhbiBhcnJheSBiaW5kaW5nIiwgdHlwZUJpbmRp
bmcuaXNBcnJheSgpKTsgLy8kTk9OLU5MUy0xJApkaWZmIC0tZ2l0IGEvb3JnLmVjbGlwc2UuamR0
LmNvcmUudGVzdHMubW9kZWwvc3JjL29yZy9lY2xpcHNlL2pkdC9jb3JlL3Rlc3RzL2RvbS9BU1RD
b252ZXJ0ZXJUZXN0QVNUOF8yLmphdmEgYi9vcmcuZWNsaXBzZS5qZHQuY29yZS50ZXN0cy5tb2Rl
bC9zcmMvb3JnL2VjbGlwc2UvamR0L2NvcmUvdGVzdHMvZG9tL0FTVENvbnZlcnRlclRlc3RBU1Q4
XzIuamF2YQppbmRleCBjNzI1Y2I3Li4xYzdjNjFiIDEwMDY0NAotLS0gYS9vcmcuZWNsaXBzZS5q
ZHQuY29yZS50ZXN0cy5tb2RlbC9zcmMvb3JnL2VjbGlwc2UvamR0L2NvcmUvdGVzdHMvZG9tL0FT
VENvbnZlcnRlclRlc3RBU1Q4XzIuamF2YQorKysgYi9vcmcuZWNsaXBzZS5qZHQuY29yZS50ZXN0
cy5tb2RlbC9zcmMvb3JnL2VjbGlwc2UvamR0L2NvcmUvdGVzdHMvZG9tL0FTVENvbnZlcnRlclRl
c3RBU1Q4XzIuamF2YQpAQCAtMjc4Myw3ICsyNzgzLDcgQEAKIAkJTGlzdCBmcmFnbWVudHMgPSBm
aWVsZERlY2xhcmF0aW9uLmZyYWdtZW50cygpOwogCQlhc3NlcnRFcXVhbHMoIndyb25nIHNpemUi
LCAxLCBmcmFnbWVudHMuc2l6ZSgpKTsKIAkJVmFyaWFibGVEZWNsYXJhdGlvbkZyYWdtZW50IGZy
YWdtZW50ID0gKFZhcmlhYmxlRGVjbGFyYXRpb25GcmFnbWVudCkgZnJhZ21lbnRzLmdldCgwKTsK
LQkJYXNzZXJ0RXF1YWxzKCJ3cm9uZyBleHRyYSBkaW1lbnNpb24iLCAxLCBmcmFnbWVudC5nZXRF
eHRyYURpbWVuc2lvbnMoKSk7CisJCWFzc2VydEVxdWFscygid3JvbmcgZXh0cmEgZGltZW5zaW9u
IiwgMSwgZnJhZ21lbnQuZ2V0RXh0cmFEaW1lbnNpb25UeXBlcygpLnNpemUoKSk7CiAJfQogCiAJ
LyoqCmRpZmYgLS1naXQgYS9vcmcuZWNsaXBzZS5qZHQuY29yZS50ZXN0cy5tb2RlbC9zcmMvb3Jn
L2VjbGlwc2UvamR0L2NvcmUvdGVzdHMvZG9tL0FTVFN0cnVjdHVyYWxQcm9wZXJ0eVRlc3QuamF2
YSBiL29yZy5lY2xpcHNlLmpkdC5jb3JlLnRlc3RzLm1vZGVsL3NyYy9vcmcvZWNsaXBzZS9qZHQv
Y29yZS90ZXN0cy9kb20vQVNUU3RydWN0dXJhbFByb3BlcnR5VGVzdC5qYXZhCmluZGV4IDI0MDNl
OWQuLjQ3ODM2ZjAgMTAwNjQ0Ci0tLSBhL29yZy5lY2xpcHNlLmpkdC5jb3JlLnRlc3RzLm1vZGVs
L3NyYy9vcmcvZWNsaXBzZS9qZHQvY29yZS90ZXN0cy9kb20vQVNUU3RydWN0dXJhbFByb3BlcnR5
VGVzdC5qYXZhCisrKyBiL29yZy5lY2xpcHNlLmpkdC5jb3JlLnRlc3RzLm1vZGVsL3NyYy9vcmcv
ZWNsaXBzZS9qZHQvY29yZS90ZXN0cy9kb20vQVNUU3RydWN0dXJhbFByb3BlcnR5VGVzdC5qYXZh
CkBAIC0zNDYsNyArMzQ2LDcgQEAKIAkJCQkvLyBvb3BzIC0gZ3Vlc3MgdGhhdCdzIG5vdCB2YWxp
ZAogCQkJfQogCQl9Ci0JCWFzc2VydEVxdWFscygiV3JvbmcgbGFzdCBrbm93biB0eXBlIiwgODQs
IGhpKTsgLy8gbGFzdCBrbm93biBvbmUKKwkJYXNzZXJ0RXF1YWxzKCJXcm9uZyBsYXN0IGtub3du
IHR5cGUiLCA4NSwgaGkpOyAvLyBsYXN0IGtub3duIG9uZQogCQlhc3NlcnRFcXVhbHMoIldyb25n
IG51bWJlciBvZiBkaXN0aW5jdCB0eXBlcyIsICBoaSwgY2xhc3Nlcy5zaXplKCkpOyAvLyBhbGwg
Y2xhc3NlcyBhcmUgZGlzdGluY3QKIAl9CiB9CmRpZmYgLS1naXQgYS9vcmcuZWNsaXBzZS5qZHQu
Y29yZS50ZXN0cy5tb2RlbC9zcmMvb3JnL2VjbGlwc2UvamR0L2NvcmUvdGVzdHMvZG9tL0NvbnZl
cnRlclRlc3RTZXR1cC5qYXZhIGIvb3JnLmVjbGlwc2UuamR0LmNvcmUudGVzdHMubW9kZWwvc3Jj
L29yZy9lY2xpcHNlL2pkdC9jb3JlL3Rlc3RzL2RvbS9Db252ZXJ0ZXJUZXN0U2V0dXAuamF2YQpp
bmRleCBjZGJjNGEwLi4xOTg0YjA3IDEwMDY0NAotLS0gYS9vcmcuZWNsaXBzZS5qZHQuY29yZS50
ZXN0cy5tb2RlbC9zcmMvb3JnL2VjbGlwc2UvamR0L2NvcmUvdGVzdHMvZG9tL0NvbnZlcnRlclRl
c3RTZXR1cC5qYXZhCisrKyBiL29yZy5lY2xpcHNlLmpkdC5jb3JlLnRlc3RzLm1vZGVsL3NyYy9v
cmcvZWNsaXBzZS9qZHQvY29yZS90ZXN0cy9kb20vQ29udmVydGVyVGVzdFNldHVwLmphdmEKQEAg
LTEsNSArMSw1IEBACiAvKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioq
KioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKgotICogQ29weXJpZ2h0IChjKSAy
MDAwLCAyMDEyIElCTSBDb3Jwb3JhdGlvbiBhbmQgb3RoZXJzLgorICogQ29weXJpZ2h0IChjKSAy
MDAwLCAyMDEzIElCTSBDb3Jwb3JhdGlvbiBhbmQgb3RoZXJzLgogICogQWxsIHJpZ2h0cyByZXNl
cnZlZC4gVGhpcyBwcm9ncmFtIGFuZCB0aGUgYWNjb21wYW55aW5nIG1hdGVyaWFscwogICogYXJl
IG1hZGUgYXZhaWxhYmxlIHVuZGVyIHRoZSB0ZXJtcyBvZiB0aGUgRWNsaXBzZSBQdWJsaWMgTGlj
ZW5zZSB2MS4wCiAgKiB3aGljaCBhY2NvbXBhbmllcyB0aGlzIGRpc3RyaWJ1dGlvbiwgYW5kIGlz
IGF2YWlsYWJsZSBhdApAQCAtMTUsNiArMTUsNyBAQAogcGFja2FnZSBvcmcuZWNsaXBzZS5qZHQu
Y29yZS50ZXN0cy5kb207CiAKIGltcG9ydCBqYXZhLmlvLklPRXhjZXB0aW9uOworaW1wb3J0IGph
dmEudXRpbC5JdGVyYXRvcjsKIGltcG9ydCBqYXZhLnV0aWwuTGlzdDsKIGltcG9ydCBqYXZhLnV0
aWwuTWFwOwogCkBAIC0xNDEsNiArMTQyLDI2IEBACiAJCX0KIAl9CiAKKwlwcm90ZWN0ZWQgdm9p
ZCBhc3NlcnRFeHRyYURpbWVuc2lvbnNFcXVhbChTdHJpbmcgbWVzc2FnZSwgTGlzdCBkaW1lbnNp
b25zLCBTdHJpbmcgZXhwZWN0ZWQpIHsKKwkJU3RyaW5nQnVmZmVyIGJ1ZmZlciA9IG5ldyBTdHJp
bmdCdWZmZXIoKTsKKwkJSXRlcmF0b3IgaXRlciA9IGRpbWVuc2lvbnMuaXRlcmF0b3IoKTsKKwkJ
d2hpbGUoaXRlci5oYXNOZXh0KCkpIHsKKwkJCURpbWVuc2lvblR5cGUgZGltID0gKERpbWVuc2lv
blR5cGUpIGl0ZXIubmV4dCgpOworCQkJSXRlcmF0b3IgYW5ub3RhdGlvbnMgPSBkaW0uYW5ub3Rh
dGlvbnMoKS5pdGVyYXRvcigpOworCQkJd2hpbGUgKGFubm90YXRpb25zLmhhc05leHQoKSkgewor
CQkJCWJ1ZmZlci5hcHBlbmQoJ0AnKTsKKwkJCQlidWZmZXIuYXBwZW5kKCgoQW5ub3RhdGlvbikg
YW5ub3RhdGlvbnMubmV4dCgpKS5nZXRUeXBlTmFtZSgpLmdldEZ1bGx5UXVhbGlmaWVkTmFtZSgp
KTsKKwkJCQlidWZmZXIuYXBwZW5kKCcgJyk7CisJCQl9CisJCQlpZiAoaXRlci5oYXNOZXh0KCkp
IHsKKwkJCQlidWZmZXIuYXBwZW5kKCJbXSAiKTsKKwkJCX0gZWxzZSB7CisJCQkJYnVmZmVyLmFw
cGVuZCgiW10iKTsKKwkJCX0KKwkJfQorCQlhc3NlcnRFcXVhbHMobWVzc2FnZSwgZXhwZWN0ZWQs
IGJ1ZmZlci50b1N0cmluZygpKTsKKwl9CisKIAlwdWJsaWMgQVNUTm9kZSBydW5Db252ZXJzaW9u
KElDb21waWxhdGlvblVuaXQgdW5pdCwgYm9vbGVhbiByZXNvbHZlQmluZGluZ3MsCiAJCQlib29s
ZWFuIGJpbmRpbmdzUmVjb3ZlcnkpIHsKIAkJcmV0dXJuIHJ1bkNvbnZlcnNpb24oYXN0SW50ZXJu
YWxKTFMyKCksIHVuaXQsIHJlc29sdmVCaW5kaW5ncywgZmFsc2UsIGJpbmRpbmdzUmVjb3Zlcnkp
OwpkaWZmIC0tZ2l0IGEvb3JnLmVjbGlwc2UuamR0LmNvcmUudGVzdHMubW9kZWwvd29ya3NwYWNl
L0NvbnZlcnRlcjE4L3NyYy9YLmphdmEgYi9vcmcuZWNsaXBzZS5qZHQuY29yZS50ZXN0cy5tb2Rl
bC93b3Jrc3BhY2UvQ29udmVydGVyMTgvc3JjL1guamF2YQpuZXcgZmlsZSBtb2RlIDEwMDY0NApp
bmRleCAwMDAwMDAwLi41YTFhODg4Ci0tLSAvZGV2L251bGwKKysrIGIvb3JnLmVjbGlwc2UuamR0
LmNvcmUudGVzdHMubW9kZWwvd29ya3NwYWNlL0NvbnZlcnRlcjE4L3NyYy9YLmphdmEKQEAgLTAs
MCArMSw0IEBACitwdWJsaWMgY2xhc3MgWCB7CisJcHVibGljIHZvaWQgZm9vKFggdGhpcykgewor
CX0KK30KZGlmZiAtLWdpdCBhL29yZy5lY2xpcHNlLmpkdC5jb3JlL2RvbS9vcmcvZWNsaXBzZS9q
ZHQvY29yZS9kb20vQVNULmphdmEgYi9vcmcuZWNsaXBzZS5qZHQuY29yZS9kb20vb3JnL2VjbGlw
c2UvamR0L2NvcmUvZG9tL0FTVC5qYXZhCmluZGV4IDBkNWFlZDUuLjEzOTQ5NTQgMTAwNjQ0Ci0t
LSBhL29yZy5lY2xpcHNlLmpkdC5jb3JlL2RvbS9vcmcvZWNsaXBzZS9qZHQvY29yZS9kb20vQVNU
LmphdmEKKysrIGIvb3JnLmVjbGlwc2UuamR0LmNvcmUvZG9tL29yZy9lY2xpcHNlL2pkdC9jb3Jl
L2RvbS9BU1QuamF2YQpAQCAtMSw1ICsxLDUgQEAKIC8qKioqKioqKioqKioqKioqKioqKioqKioq
KioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqCi0g
KiBDb3B5cmlnaHQgKGMpIDIwMDAsIDIwMTIgSUJNIENvcnBvcmF0aW9uIGFuZCBvdGhlcnMuCisg
KiBDb3B5cmlnaHQgKGMpIDIwMDAsIDIwMTMgSUJNIENvcnBvcmF0aW9uIGFuZCBvdGhlcnMuCiAg
KiBBbGwgcmlnaHRzIHJlc2VydmVkLiBUaGlzIHByb2dyYW0gYW5kIHRoZSBhY2NvbXBhbnlpbmcg
bWF0ZXJpYWxzCiAgKiBhcmUgbWFkZSBhdmFpbGFibGUgdW5kZXIgdGhlIHRlcm1zIG9mIHRoZSBF
Y2xpcHNlIFB1YmxpYyBMaWNlbnNlIHYxLjAKICAqIHdoaWNoIGFjY29tcGFuaWVzIHRoaXMgZGlz
dHJpYnV0aW9uLCBhbmQgaXMgYXZhaWxhYmxlIGF0CkBAIC0xMTE2LDYgKzExMTYsMjggQEAKIAl9
CiAKIAkvKioKKwkgKiBDcmVhdGVzIGFuZCByZXR1cm5zIGEgbmV3IHVucGFyZW50ZWQgYW5ub3Rh
dGFibGUgZGltZW5zaW9uIHR5cGUgbm9kZSB3aXRoIHRoZSBnaXZlbgorCSAqIGFycmF5IG9mIGFu
bm90YXRpb25zLgorCSAqCisJICogQHBhcmFtIGFubm90YXRpb25zIHRoZSBsaXN0IG9mIGFubm90
YXRpb25zIHRoYXQgd2lsbCBiZSBhZGRlZCB0byB0aGlzIGRpbWVuc2lvbiB0eXBlCisJICogQHJl
dHVybiBhIG5ldyB1bnBhcmVudGVkIGFubm90YXRhYmxlIGRpbWVuc2lvbiB0eXBlIG5vZGUKKwkg
KiBAZXhjZXB0aW9uIElsbGVnYWxBcmd1bWVudEV4Y2VwdGlvbiBpZjoKKwkgKiA8dWw+CisJICog
PGxpPnRoZSBub2RlIGJlbG9uZ3MgdG8gYSBkaWZmZXJlbnQgQVNUPC9saT4KKwkgKiA8bGk+dGhl
IG5vZGUgYWxyZWFkeSBoYXMgYSBwYXJlbnQ8L2xpPgorCSAqIDwvdWw+CisJICogQHNpbmNlIDMu
OQorCSAqLworCXB1YmxpYyBEaW1lbnNpb25UeXBlIG5ld0RpbWVuc2lvblR5cGUoQW5ub3RhdGlv
bltdIGFubm90YXRpb25zKSB7CisJCURpbWVuc2lvblR5cGUgcmVzdWx0ID0gbmV3IERpbWVuc2lv
blR5cGUodGhpcyk7CisJCWludCBsZW5ndGggPSAoYW5ub3RhdGlvbnMgPT0gbnVsbCkgPyAwIDog
YW5ub3RhdGlvbnMubGVuZ3RoOworCQlmb3IgKGludCBpID0gMDsgaSA8IGxlbmd0aDsgaSsrKSB7
CisJCQlyZXN1bHQuYW5ub3RhdGlvbnMuYWRkKGFubm90YXRpb25zW2ldKTsKKwkJfQorCQlyZXR1
cm4gcmVzdWx0OworCX0KKworCS8qKgogCSAqIENyZWF0ZXMgYW5kIHJldHVybnMgYSBuZXcgdW5w
YXJlbnRlZCBhcnJheSB0eXBlIG5vZGUgd2l0aCB0aGUgZ2l2ZW4KIAkgKiBlbGVtZW50IHR5cGUg
YW5kIG51bWJlciBvZiAoYWRkaXRpb25hbCkgZGltZW5zaW9ucy4KIAkgKiA8cD4KZGlmZiAtLWdp
dCBhL29yZy5lY2xpcHNlLmpkdC5jb3JlL2RvbS9vcmcvZWNsaXBzZS9qZHQvY29yZS9kb20vQVNU
Q29udmVydGVyLmphdmEgYi9vcmcuZWNsaXBzZS5qZHQuY29yZS9kb20vb3JnL2VjbGlwc2UvamR0
L2NvcmUvZG9tL0FTVENvbnZlcnRlci5qYXZhCmluZGV4IDM2MWFjZTYuLjJhY2RiNDkgMTAwNjQ0
Ci0tLSBhL29yZy5lY2xpcHNlLmpkdC5jb3JlL2RvbS9vcmcvZWNsaXBzZS9qZHQvY29yZS9kb20v
QVNUQ29udmVydGVyLmphdmEKKysrIGIvb3JnLmVjbGlwc2UuamR0LmNvcmUvZG9tL29yZy9lY2xp
cHNlL2pkdC9jb3JlL2RvbS9BU1RDb252ZXJ0ZXIuamF2YQpAQCAtNTA4LDcgKzUwOCwxMiBAQAog
CQkJCS8vIGdldCB0aGUgcG9zaXRpb25zIG9mIHRoZSByaWdodCBwYXJlbnRoZXNpcwogCQkJCWlu
dCByaWdodFBhcmVudGhlc2lzUG9zaXRpb24gPSByZXRyaWV2ZUVuZE9mUmlnaHRQYXJlbnRoZXNp
c1Bvc2l0aW9uKGVuZCwgbWV0aG9kLmJvZHlFbmQpOwogCQkJCWludCBleHRyYURpbWVuc2lvbnMg
PSByZXRyaWV2ZUV4dHJhRGltZW5zaW9uKHJpZ2h0UGFyZW50aGVzaXNQb3NpdGlvbiwgbWV0aG9k
LmJvZHlFbmQpOwotCQkJCW1ldGhvZERlY2wuc2V0RXh0cmFEaW1lbnNpb25zKGV4dHJhRGltZW5z
aW9ucyk7CisJCQkJaWYgKHRoaXMuYXN0LmFwaUxldmVsID49IEFTVC5KTFM4KSB7CisJCQkJCXNl
dEV4dHJhQW5ub3RhdGVkRGltZW5zaW9ucyhyaWdodFBhcmVudGhlc2lzUG9zaXRpb24sIHRoaXMu
c2Nhbm5lci5jdXJyZW50UG9zaXRpb24sIHR5cGVSZWZlcmVuY2UsCisJCQkJCQkJCQkJCQltZXRo
b2REZWNsLmV4dHJhRGltZW5zaW9uVHlwZXMsIGV4dHJhRGltZW5zaW9ucyk7CisJCQkJfSBlbHNl
IHsKKwkJCQkJbWV0aG9kRGVjbC5zZXRFeHRyYURpbWVuc2lvbnMoZXh0cmFEaW1lbnNpb25zKTsK
KwkJCQl9CiAJCQkJc2V0VHlwZUZvck1ldGhvZERlY2xhcmF0aW9uKG1ldGhvZERlY2wsIHJldHVy
blR5cGUsIGV4dHJhRGltZW5zaW9ucyk7CiAJCQl9IGVsc2UgewogCQkJCS8vIG5vIHJldHVybiB0
eXBlIGZvciBhIG1ldGhvZCB0aGF0IGlzIG5vdCBhIGNvbnN0cnVjdG9yCkBAIC04MjksNyArODM0
LDEyIEBACiAJCXZhcmlhYmxlRGVjbC5zZXROYW1lKG5hbWUpOwogCQlmaW5hbCBpbnQgdHlwZVNv
dXJjZUVuZCA9IGFyZ3VtZW50LnR5cGUuc291cmNlRW5kOwogCQlmaW5hbCBpbnQgZXh0cmFEaW1l
bnNpb25zID0gcmV0cmlldmVFeHRyYURpbWVuc2lvbihuYW1lRW5kICsgMSwgdHlwZVNvdXJjZUVu
ZCk7Ci0JCXZhcmlhYmxlRGVjbC5zZXRFeHRyYURpbWVuc2lvbnMoZXh0cmFEaW1lbnNpb25zKTsK
KwkJaWYgKHRoaXMuYXN0LmFwaUxldmVsID49IEFTVC5KTFM4KSB7CisJCQlzZXRFeHRyYUFubm90
YXRlZERpbWVuc2lvbnMobmFtZUVuZCArIDEsIHRoaXMuc2Nhbm5lci5jdXJyZW50UG9zaXRpb24s
IGFyZ3VtZW50LnR5cGUsCisJCQkJCQkJCQkJdmFyaWFibGVEZWNsLmV4dHJhRGltZW5zaW9uVHlw
ZXMsIGV4dHJhRGltZW5zaW9ucyk7CisJCX0gZWxzZSB7CisJCQl2YXJpYWJsZURlY2wuc2V0RXh0
cmFEaW1lbnNpb25zKGV4dHJhRGltZW5zaW9ucyk7CisJCX0KIAkJZmluYWwgYm9vbGVhbiBpc1Zh
ckFyZ3MgPSBhcmd1bWVudC5pc1ZhckFyZ3MoKTsKIAkJaWYgKGlzVmFyQXJncyAmJiBleHRyYURp
bWVuc2lvbnMgPT0gMCkgewogCQkJLy8gcmVtb3ZlIHRoZSBlbGxpcHNpcyBmcm9tIHRoZSB0eXBl
IHNvdXJjZSBlbmQKQEAgLTI5NDQsNyArMjk1NCw5IEBACiAJCX0KIAkJZmllbGREZWNsYXJhdGlv
bi5zZXRTb3VyY2VSYW5nZShmaWVsZERlY2wuZGVjbGFyYXRpb25Tb3VyY2VTdGFydCwgZmllbGRE
ZWNsLmRlY2xhcmF0aW9uRW5kIC0gZmllbGREZWNsLmRlY2xhcmF0aW9uU291cmNlU3RhcnQgKyAx
KTsKIAkJVHlwZSB0eXBlID0gY29udmVydFR5cGUoZmllbGREZWNsLnR5cGUpOwotCQlzZXRUeXBl
Rm9yRmllbGQoZmllbGREZWNsYXJhdGlvbiwgdHlwZSwgdmFyaWFibGVEZWNsYXJhdGlvbkZyYWdt
ZW50LmdldEV4dHJhRGltZW5zaW9ucygpKTsKKwkJc2V0VHlwZUZvckZpZWxkKGZpZWxkRGVjbGFy
YXRpb24sIHR5cGUsIAorCQkJCSh0aGlzLmFzdC5hcGlMZXZlbCA8IEFTVC5KTFM4KSA/IHZhcmlh
YmxlRGVjbGFyYXRpb25GcmFnbWVudC5nZXRFeHRyYURpbWVuc2lvbnMoKSAKKwkJCQkJCTogdmFy
aWFibGVEZWNsYXJhdGlvbkZyYWdtZW50LmdldEV4dHJhRGltZW5zaW9uVHlwZXMoKS5zaXplKCkp
OwogCQlzZXRNb2RpZmllcnMoZmllbGREZWNsYXJhdGlvbiwgZmllbGREZWNsKTsKIAkJY29udmVy
dChmaWVsZERlY2wuamF2YWRvYywgZmllbGREZWNsYXJhdGlvbik7CiAJCXJldHVybiBmaWVsZERl
Y2xhcmF0aW9uOwpAQCAtMjk3NSw3ICsyOTg3LDEwIEBACiAJCX0KIAkJdmFyaWFibGVEZWNsYXJh
dGlvbkV4cHJlc3Npb24uc2V0U291cmNlUmFuZ2UobG9jYWxEZWNsYXJhdGlvbi5kZWNsYXJhdGlv
blNvdXJjZVN0YXJ0LCBsb2NhbERlY2xhcmF0aW9uLmRlY2xhcmF0aW9uU291cmNlRW5kIC0gbG9j
YWxEZWNsYXJhdGlvbi5kZWNsYXJhdGlvblNvdXJjZVN0YXJ0ICsgMSk7CiAJCVR5cGUgdHlwZSA9
IGNvbnZlcnRUeXBlKGxvY2FsRGVjbGFyYXRpb24udHlwZSk7Ci0JCXNldFR5cGVGb3JWYXJpYWJs
ZURlY2xhcmF0aW9uRXhwcmVzc2lvbih2YXJpYWJsZURlY2xhcmF0aW9uRXhwcmVzc2lvbiwgdHlw
ZSwgdmFyaWFibGVEZWNsYXJhdGlvbkZyYWdtZW50LmdldEV4dHJhRGltZW5zaW9ucygpKTsKKwkJ
c2V0VHlwZUZvclZhcmlhYmxlRGVjbGFyYXRpb25FeHByZXNzaW9uKAorCQkJCQl2YXJpYWJsZURl
Y2xhcmF0aW9uRXhwcmVzc2lvbiwgdHlwZSwKKwkJCQkJKHRoaXMuYXN0LmFwaUxldmVsIDwgQVNU
LkpMUzgpID8gdmFyaWFibGVEZWNsYXJhdGlvbkZyYWdtZW50LmdldEV4dHJhRGltZW5zaW9ucygp
CisJCQkJCTogdmFyaWFibGVEZWNsYXJhdGlvbkZyYWdtZW50LmdldEV4dHJhRGltZW5zaW9uVHlw
ZXMoKS5zaXplKCkpOwogCQlpZiAobG9jYWxEZWNsYXJhdGlvbi5tb2RpZmllcnNTb3VyY2VTdGFy
dCAhPSAtMSkgewogCQkJc2V0TW9kaWZpZXJzKHZhcmlhYmxlRGVjbGFyYXRpb25FeHByZXNzaW9u
LCBsb2NhbERlY2xhcmF0aW9uKTsKIAkJfQpAQCAtMjk5Miw3ICszMDA3LDEyIEBACiAJCW5hbWUu
c2V0U291cmNlUmFuZ2Uoc3RhcnQsIG5hbWVFbmQgLSBzdGFydCArIDEpOwogCQl2YXJpYWJsZURl
Y2wuc2V0TmFtZShuYW1lKTsKIAkJZmluYWwgaW50IGV4dHJhRGltZW5zaW9ucyA9IHJldHJpZXZl
RXh0cmFEaW1lbnNpb24obmFtZUVuZCArIDEsIGxvY2FsRGVjbGFyYXRpb24udHlwZS5zb3VyY2VF
bmQpOwotCQl2YXJpYWJsZURlY2wuc2V0RXh0cmFEaW1lbnNpb25zKGV4dHJhRGltZW5zaW9ucyk7
CisJCWlmICh0aGlzLmFzdC5hcGlMZXZlbCA+PSBBU1QuSkxTOCkgeworCQkJc2V0RXh0cmFBbm5v
dGF0ZWREaW1lbnNpb25zKG5hbWVFbmQgKyAxLCB0aGlzLnNjYW5uZXIuY3VycmVudFBvc2l0aW9u
LCBsb2NhbERlY2xhcmF0aW9uLnR5cGUsCisJCQkJCXZhcmlhYmxlRGVjbC5leHRyYURpbWVuc2lv
blR5cGVzLCBleHRyYURpbWVuc2lvbnMpOworCQl9IGVsc2UgeworCQkJdmFyaWFibGVEZWNsLnNl
dEV4dHJhRGltZW5zaW9ucyhleHRyYURpbWVuc2lvbnMpOworCQl9CiAJCVR5cGUgdHlwZSA9IGNv
bnZlcnRUeXBlKGxvY2FsRGVjbGFyYXRpb24udHlwZSk7CiAJCWludCB0eXBlRW5kID0gdHlwZS5n
ZXRTdGFydFBvc2l0aW9uKCkgKyB0eXBlLmdldExlbmd0aCgpIC0gMTsKIAkJaW50IHJpZ2h0RW5k
ID0gTWF0aC5tYXgodHlwZUVuZCwgbG9jYWxEZWNsYXJhdGlvbi5kZWNsYXJhdGlvblNvdXJjZUVu
ZCk7CkBAIC0zMDEwLDYgKzMwMzAsMTcgQEAKIAkJcmV0dXJuIHZhcmlhYmxlRGVjbDsKIAl9CiAK
Kwlwcml2YXRlIERpbWVuc2lvblR5cGUgY29udmVydFRvRGltZW5zaW9uVHlwZShpbnQgc3RhcnQs
IGludCBlbmQsIG9yZy5lY2xpcHNlLmpkdC5pbnRlcm5hbC5jb21waWxlci5hc3QuQW5ub3RhdGlv
bltdIGFubm90YXRpb24pIHsKKwkJaW50IGxlbmd0aCA9IGFubm90YXRpb24gPT0gbnVsbCA/IDAg
OiBhbm5vdGF0aW9uLmxlbmd0aDsKKwkJQW5ub3RhdGlvbltdIGFubm90YXRpb25zID0gbmV3IEFu
bm90YXRpb25bbGVuZ3RoXTsKKwkJZm9yIChpbnQgaSA9IDA7IGkgPCBsZW5ndGg7IGkrKykgewor
CQkJYW5ub3RhdGlvbnNbaV0gPSBjb252ZXJ0KGFubm90YXRpb25baV0pOworCQl9CisJCURpbWVu
c2lvblR5cGUgZGltZW5zaW9uID0gdGhpcy5hc3QubmV3RGltZW5zaW9uVHlwZShhbm5vdGF0aW9u
cyk7CisJCXJldHJpZXZlRGltZW5zaW9uQW5kU2V0UG9zaXRpb25zKHN0YXJ0LCBlbmQsIGRpbWVu
c2lvbik7CisJCXJldHVybiBkaW1lbnNpb247CisJfQorCiAJcHJvdGVjdGVkIFZhcmlhYmxlRGVj
bGFyYXRpb25GcmFnbWVudCBjb252ZXJ0VG9WYXJpYWJsZURlY2xhcmF0aW9uRnJhZ21lbnQob3Jn
LmVjbGlwc2UuamR0LmludGVybmFsLmNvbXBpbGVyLmFzdC5GaWVsZERlY2xhcmF0aW9uIGZpZWxk
RGVjbGFyYXRpb24pIHsKIAkJZmluYWwgVmFyaWFibGVEZWNsYXJhdGlvbkZyYWdtZW50IHZhcmlh
YmxlRGVjbGFyYXRpb25GcmFnbWVudCA9IG5ldyBWYXJpYWJsZURlY2xhcmF0aW9uRnJhZ21lbnQo
dGhpcy5hc3QpOwogCQlmaW5hbCBTaW1wbGVOYW1lIG5hbWUgPSBuZXcgU2ltcGxlTmFtZSh0aGlz
LmFzdCk7CkBAIC0zMDE5LDcgKzMwNTAsMTIgQEAKIAkJaW50IHN0YXJ0ID0gZmllbGREZWNsYXJh
dGlvbi5zb3VyY2VFbmQ7CiAJCWludCBlbmQgPSBzdGFydDsKIAkJaW50IGV4dHJhRGltZW5zaW9u
cyA9IHJldHJpZXZlRXh0cmFEaW1lbnNpb24oZmllbGREZWNsYXJhdGlvbi5zb3VyY2VFbmQgKyAx
LCBmaWVsZERlY2xhcmF0aW9uLmRlY2xhcmF0aW9uU291cmNlRW5kICk7Ci0JCXZhcmlhYmxlRGVj
bGFyYXRpb25GcmFnbWVudC5zZXRFeHRyYURpbWVuc2lvbnMoZXh0cmFEaW1lbnNpb25zKTsKKwkJ
aWYgKHRoaXMuYXN0LmFwaUxldmVsID49IEFTVC5KTFM4KSB7CisJCQlzZXRFeHRyYUFubm90YXRl
ZERpbWVuc2lvbnMoZmllbGREZWNsYXJhdGlvbi5zb3VyY2VFbmQgKyAxLCB0aGlzLnNjYW5uZXIu
Y3VycmVudFBvc2l0aW9uLAorCQkJCQlmaWVsZERlY2xhcmF0aW9uLnR5cGUsIHZhcmlhYmxlRGVj
bGFyYXRpb25GcmFnbWVudC5leHRyYURpbWVuc2lvblR5cGVzLCBleHRyYURpbWVuc2lvbnMpOwor
CQl9IGVsc2UgeworCQkJdmFyaWFibGVEZWNsYXJhdGlvbkZyYWdtZW50LnNldEV4dHJhRGltZW5z
aW9ucyhleHRyYURpbWVuc2lvbnMpOworCQl9CiAJCWlmIChmaWVsZERlY2xhcmF0aW9uLmluaXRp
YWxpemF0aW9uICE9IG51bGwpIHsKIAkJCWZpbmFsIEV4cHJlc3Npb24gZXhwcmVzc2lvbiA9IGNv
bnZlcnQoZmllbGREZWNsYXJhdGlvbi5pbml0aWFsaXphdGlvbik7CiAJCQl2YXJpYWJsZURlY2xh
cmF0aW9uRnJhZ21lbnQuc2V0SW5pdGlhbGl6ZXIoZXhwcmVzc2lvbik7CkBAIC0zMDU3LDcgKzMw
OTMsMTMgQEAKIAkJaW50IHN0YXJ0ID0gbG9jYWxEZWNsYXJhdGlvbi5zb3VyY2VFbmQ7CiAJCW9y
Zy5lY2xpcHNlLmpkdC5pbnRlcm5hbC5jb21waWxlci5hc3QuRXhwcmVzc2lvbiBpbml0aWFsaXph
dGlvbiA9IGxvY2FsRGVjbGFyYXRpb24uaW5pdGlhbGl6YXRpb247CiAJCWludCBleHRyYURpbWVu
c2lvbiA9IHJldHJpZXZlRXh0cmFEaW1lbnNpb24obG9jYWxEZWNsYXJhdGlvbi5zb3VyY2VFbmQg
KyAxLCB0aGlzLmNvbXBpbGF0aW9uVW5pdFNvdXJjZUxlbmd0aCk7Ci0JCXZhcmlhYmxlRGVjbGFy
YXRpb25GcmFnbWVudC5zZXRFeHRyYURpbWVuc2lvbnMoZXh0cmFEaW1lbnNpb24pOworCQlpZiAo
dGhpcy5hc3QuYXBpTGV2ZWwgPj0gQVNULkpMUzgpIHsKKwkJCXNldEV4dHJhQW5ub3RhdGVkRGlt
ZW5zaW9ucyhsb2NhbERlY2xhcmF0aW9uLnNvdXJjZUVuZCArIDEsIHRoaXMuc2Nhbm5lci5jdXJy
ZW50UG9zaXRpb24sCisJCQkJCWxvY2FsRGVjbGFyYXRpb24udHlwZSwgdmFyaWFibGVEZWNsYXJh
dGlvbkZyYWdtZW50LmV4dHJhRGltZW5zaW9uVHlwZXMsIGV4dHJhRGltZW5zaW9uKTsKKwkJfSBl
bHNlIHsKKwkJCXZhcmlhYmxlRGVjbGFyYXRpb25GcmFnbWVudC5zZXRFeHRyYURpbWVuc2lvbnMo
ZXh0cmFEaW1lbnNpb24pOworCQl9CisKIAkJYm9vbGVhbiBoYXNJbml0aWFsaXphdGlvbiA9IGlu
aXRpYWxpemF0aW9uICE9IG51bGw7CiAJCWludCBlbmQ7CiAJCWlmIChoYXNJbml0aWFsaXphdGlv
bikgewpAQCAtMzA4OCw2ICszMTMwLDE4IEBACiAJCXJldHVybiB2YXJpYWJsZURlY2xhcmF0aW9u
RnJhZ21lbnQ7CiAJfQogCisJcHJvdGVjdGVkIHZvaWQgc2V0RXh0cmFBbm5vdGF0ZWREaW1lbnNp
b25zKGludCBzdGFydCwgaW50IGVuZCwgVHlwZVJlZmVyZW5jZSB0eXBlLCBmaW5hbCBMaXN0IGV4
dHJhQW5ub3RhdGVkRGltZW5zaW9ucywgaW50IGV4dHJhRGltZW5zaW9uKSB7CisJCWlmIChleHRy
YURpbWVuc2lvbiA+IDApIHsKKwkJCW9yZy5lY2xpcHNlLmpkdC5pbnRlcm5hbC5jb21waWxlci5h
c3QuQW5ub3RhdGlvbltdW10gYW5ub3RhdGlvbnNPbkRpbXMgPSB0eXBlLmdldEFubm90YXRpb25z
T25EaW1lbnNpb25zKCk7CisJCQlpbnQgbGVuZ3RoID0gKGFubm90YXRpb25zT25EaW1zID09IG51
bGwpID8gMCA6IGFubm90YXRpb25zT25EaW1zLmxlbmd0aDsKKwkJCWZvciAoaW50IGkgPSAobGVu
Z3RoIC0gZXh0cmFEaW1lbnNpb24pOyBpIDwgbGVuZ3RoOyBpKyspIHsKKwkJCQlEaW1lbnNpb25U
eXBlIGRpbSA9IGNvbnZlcnRUb0RpbWVuc2lvblR5cGUoc3RhcnQsIGVuZCwgKGFubm90YXRpb25z
T25EaW1zID09IG51bGwpID8gbnVsbCA6IGFubm90YXRpb25zT25EaW1zW2ldKTsKKwkJCQlleHRy
YUFubm90YXRlZERpbWVuc2lvbnMuYWRkKGRpbSk7CisJCQkJc3RhcnQgPSBkaW0uZ2V0U3RhcnRQ
b3NpdGlvbigpICsgZGltLmdldExlbmd0aCgpOworCQkJfQorCQl9CisJfQorCiAJcHJvdGVjdGVk
IFZhcmlhYmxlRGVjbGFyYXRpb25TdGF0ZW1lbnQgY29udmVydFRvVmFyaWFibGVEZWNsYXJhdGlv
blN0YXRlbWVudChvcmcuZWNsaXBzZS5qZHQuaW50ZXJuYWwuY29tcGlsZXIuYXN0LkxvY2FsRGVj
bGFyYXRpb24gbG9jYWxEZWNsYXJhdGlvbikgewogCQlmaW5hbCBWYXJpYWJsZURlY2xhcmF0aW9u
RnJhZ21lbnQgdmFyaWFibGVEZWNsYXJhdGlvbkZyYWdtZW50ID0gY29udmVydFRvVmFyaWFibGVE
ZWNsYXJhdGlvbkZyYWdtZW50KGxvY2FsRGVjbGFyYXRpb24pOwogCQlmaW5hbCBWYXJpYWJsZURl
Y2xhcmF0aW9uU3RhdGVtZW50IHZhcmlhYmxlRGVjbGFyYXRpb25TdGF0ZW1lbnQgPSBuZXcgVmFy
aWFibGVEZWNsYXJhdGlvblN0YXRlbWVudCh0aGlzLmFzdCk7CkBAIC0zMDk3LDcgKzMxNTEsOSBA
QAogCQl9CiAJCXZhcmlhYmxlRGVjbGFyYXRpb25TdGF0ZW1lbnQuc2V0U291cmNlUmFuZ2UobG9j
YWxEZWNsYXJhdGlvbi5kZWNsYXJhdGlvblNvdXJjZVN0YXJ0LCBsb2NhbERlY2xhcmF0aW9uLmRl
Y2xhcmF0aW9uU291cmNlRW5kIC0gbG9jYWxEZWNsYXJhdGlvbi5kZWNsYXJhdGlvblNvdXJjZVN0
YXJ0ICsgMSk7CiAJCVR5cGUgdHlwZSA9IGNvbnZlcnRUeXBlKGxvY2FsRGVjbGFyYXRpb24udHlw
ZSk7Ci0JCXNldFR5cGVGb3JWYXJpYWJsZURlY2xhcmF0aW9uU3RhdGVtZW50KHZhcmlhYmxlRGVj
bGFyYXRpb25TdGF0ZW1lbnQsIHR5cGUsIHZhcmlhYmxlRGVjbGFyYXRpb25GcmFnbWVudC5nZXRF
eHRyYURpbWVuc2lvbnMoKSk7CisJCXNldFR5cGVGb3JWYXJpYWJsZURlY2xhcmF0aW9uU3RhdGVt
ZW50KHZhcmlhYmxlRGVjbGFyYXRpb25TdGF0ZW1lbnQsIHR5cGUsIAorCQkJCSh0aGlzLmFzdC5h
cGlMZXZlbCA8IEFTVC5KTFM4KSA/IHZhcmlhYmxlRGVjbGFyYXRpb25GcmFnbWVudC5nZXRFeHRy
YURpbWVuc2lvbnMoKSAKKwkJCQkJCTogdmFyaWFibGVEZWNsYXJhdGlvbkZyYWdtZW50LmdldEV4
dHJhRGltZW5zaW9uVHlwZXMoKS5zaXplKCkpOwogCQlpZiAobG9jYWxEZWNsYXJhdGlvbi5tb2Rp
ZmllcnNTb3VyY2VTdGFydCAhPSAtMSkgewogCQkJc2V0TW9kaWZpZXJzKHZhcmlhYmxlRGVjbGFy
YXRpb25TdGF0ZW1lbnQsIGxvY2FsRGVjbGFyYXRpb24pOwogCQl9CkBAIC00MzQ0LDE0ICs0NDAw
LDI2IEBACiAJCWludCBkaW1lbnNpb25zID0gMDsKIAkJdHJ5IHsKIAkJCWludCB0b2tlbjsKKwkJ
CWJvb2xlYW4gaXNBbm5vdGF0aW9uID0gZmFsc2U7CiAJCQl3aGlsZSAoKHRva2VuID0gdGhpcy5z
Y2FubmVyLmdldE5leHRUb2tlbigpKSAhPSBUZXJtaW5hbFRva2Vucy5Ub2tlbk5hbWVFT0YpIHsK
IAkJCQlzd2l0Y2godG9rZW4pIHsKIAkJCQkJY2FzZSBUZXJtaW5hbFRva2Vucy5Ub2tlbk5hbWVM
QlJBQ0tFVDoKIAkJCQkJY2FzZSBUZXJtaW5hbFRva2Vucy5Ub2tlbk5hbWVDT01NRU5UX0JMT0NL
OgogCQkJCQljYXNlIFRlcm1pbmFsVG9rZW5zLlRva2VuTmFtZUNPTU1FTlRfSkFWQURPQzoKIAkJ
CQkJY2FzZSBUZXJtaW5hbFRva2Vucy5Ub2tlbk5hbWVDT01NRU5UX0xJTkU6CisJCQkJCQlpc0Fu
bm90YXRpb24gPSBmYWxzZTsKKwkJCQkJCWJyZWFrOworCQkJCQljYXNlIFRlcm1pbmFsVG9rZW5z
LlRva2VuTmFtZUFUOgorCQkJCQkJaXNBbm5vdGF0aW9uID0gdHJ1ZTsKKwkJCQkJCWJyZWFrOwor
CQkJCQljYXNlIFRlcm1pbmFsVG9rZW5zLlRva2VuTmFtZUlkZW50aWZpZXI6CisJCQkJCQlpZiAo
IWlzQW5ub3RhdGlvbikgeworCQkJCQkJCXJldHVybiBkaW1lbnNpb25zOworCQkJCQkJfQorCQkJ
CQkJaXNBbm5vdGF0aW9uID0gZmFsc2U7CiAJCQkJCQlicmVhazsKIAkJCQkJY2FzZSBUZXJtaW5h
bFRva2Vucy5Ub2tlbk5hbWVSQlJBQ0tFVDovLzE2NgorCQkJCQkJaXNBbm5vdGF0aW9uID0gZmFs
c2U7CiAJCQkJCQlkaW1lbnNpb25zKys7CiAJCQkJCQlicmVhazsKIAkJCQkJZGVmYXVsdDoKQEAg
LTQzNjQsNiArNDQzMiwzMSBAQAogCQlyZXR1cm4gZGltZW5zaW9uczsKIAl9CiAKKwlwcm90ZWN0
ZWQgdm9pZCByZXRyaWV2ZURpbWVuc2lvbkFuZFNldFBvc2l0aW9ucyhpbnQgc3RhcnQsIGludCBl
bmQsIERpbWVuc2lvblR5cGUgZGltKSB7CisJCXRoaXMuc2Nhbm5lci5yZXNldFRvKHN0YXJ0LCBl
bmQpOworCQlpbnQgdG9rZW47CisJCWJvb2xlYW4gc3RhcnRTZXQgPSBmYWxzZTsKKwkJdHJ5IHsK
KwkJCXdoaWxlKCh0b2tlbiA9IHRoaXMuc2Nhbm5lci5nZXROZXh0VG9rZW4oKSkgIT0gVGVybWlu
YWxUb2tlbnMuVG9rZW5OYW1lRU9GKSAgeworCQkJCXN3aXRjaCh0b2tlbikgeworCQkJCQljYXNl
IFRlcm1pbmFsVG9rZW5zLlRva2VuTmFtZVdISVRFU1BBQ0U6CisJCQkJCQlicmVhazsKKwkJCQkJ
Y2FzZSBUZXJtaW5hbFRva2Vucy5Ub2tlbk5hbWVSQlJBQ0tFVDoKKwkJCQkJCWludCBlbmREaW0g
PSB0aGlzLnNjYW5uZXIuY3VycmVudFBvc2l0aW9uIC0gMTsKKwkJCQkJCWRpbS5zZXRTb3VyY2VS
YW5nZShzdGFydCwgZW5kRGltIC0gc3RhcnQgKyAxKTsKKwkJCQkJCXJldHVybjsKKwkJCQkJZGVm
YXVsdDoKKwkJCQkJCWlmICghc3RhcnRTZXQpIHsKKwkJCQkJCQlzdGFydCA9IHRoaXMuc2Nhbm5l
ci5zdGFydFBvc2l0aW9uOworCQkJCQkJCXN0YXJ0U2V0ID0gdHJ1ZTsKKwkJCQkJCX0KKwkJCQkJ
CWJyZWFrOworCQkJCX0KKwkJCX0KKwkJfSBjYXRjaChJbnZhbGlkSW5wdXRFeGNlcHRpb24gZSkg
eworCQkJLy8gaWdub3JlCisJCX0KKwl9CiAJcHJvdGVjdGVkIHZvaWQgcmV0cmlldmVJZGVudGlm
aWVyQW5kU2V0UG9zaXRpb25zKGludCBzdGFydCwgaW50IGVuZCwgTmFtZSBuYW1lKSB7CiAJCXRo
aXMuc2Nhbm5lci5yZXNldFRvKHN0YXJ0LCBlbmQpOwogCQlpbnQgdG9rZW47CkBAIC01Mjc3LDcg
KzUzNzAsNyBAQAogCQkJCQkJCWJyZWFrOwogCQkJCQkJZGVmYXVsdCA6CiAJCQkJCQkJbWV0aG9k
RGVjbGFyYXRpb24uc2V0UmV0dXJuVHlwZTIoc3ViYXJyYXlUeXBlKTsKLQkJCQkJCWJyZWFrOwor
CQkJCQkJCWJyZWFrOwogCQkJCQl9CiAJCQkJCXRoaXMuYXN0LmdldEJpbmRpbmdSZXNvbHZlcigp
LnVwZGF0ZUtleSh0eXBlLCBzdWJhcnJheVR5cGUpOwogCQkJCX0KZGlmZiAtLWdpdCBhL29yZy5l
Y2xpcHNlLmpkdC5jb3JlL2RvbS9vcmcvZWNsaXBzZS9qZHQvY29yZS9kb20vQVNUTWF0Y2hlci5q
YXZhIGIvb3JnLmVjbGlwc2UuamR0LmNvcmUvZG9tL29yZy9lY2xpcHNlL2pkdC9jb3JlL2RvbS9B
U1RNYXRjaGVyLmphdmEKaW5kZXggOTVjMmU0Ny4uMzc4MjZjYiAxMDA2NDQKLS0tIGEvb3JnLmVj
bGlwc2UuamR0LmNvcmUvZG9tL29yZy9lY2xpcHNlL2pkdC9jb3JlL2RvbS9BU1RNYXRjaGVyLmph
dmEKKysrIGIvb3JnLmVjbGlwc2UuamR0LmNvcmUvZG9tL29yZy9lY2xpcHNlL2pkdC9jb3JlL2Rv
bS9BU1RNYXRjaGVyLmphdmEKQEAgLTM1NCw2ICszNTQsMjkgQEAKIAkgKiBAcmV0dXJuIDxjb2Rl
PnRydWU8L2NvZGU+IGlmIHRoZSBzdWJ0cmVlIG1hdGNoZXMsIG9yCiAJICogICA8Y29kZT5mYWxz
ZTwvY29kZT4gaWYgdGhleSBkbyBub3QgbWF0Y2ggb3IgdGhlIG90aGVyIG9iamVjdCBoYXMgYQog
CSAqICAgZGlmZmVyZW50IG5vZGUgdHlwZSBvciBpcyA8Y29kZT5udWxsPC9jb2RlPgorCSAqIEBz
aW5jZSAzLjkKKwkgKi8KKwlwdWJsaWMgYm9vbGVhbiBtYXRjaChEaW1lbnNpb25UeXBlIG5vZGUs
IE9iamVjdCBvdGhlcikgeworCQlpZiAoIShvdGhlciBpbnN0YW5jZW9mIERpbWVuc2lvblR5cGUp
KQorCQkJcmV0dXJuIGZhbHNlOworCQlEaW1lbnNpb25UeXBlIG8gPSAoRGltZW5zaW9uVHlwZSkg
b3RoZXI7CisJCXJldHVybiBzYWZlU3VidHJlZUxpc3RNYXRjaChub2RlLmFubm90YXRpb25zKCks
IG8uYW5ub3RhdGlvbnMoKSkKKwkJCQkmJiBzYWZlU3VidHJlZU1hdGNoKG5vZGUuZXhwcmVzc2lv
bigpLCBvLmV4cHJlc3Npb24oKSk7CisJfQorCisJLyoqCisJICogUmV0dXJucyB3aGV0aGVyIHRo
ZSBnaXZlbiBub2RlIGFuZCB0aGUgb3RoZXIgb2JqZWN0IG1hdGNoLgorCSAqIDxwPgorCSAqIFRo
ZSBkZWZhdWx0IGltcGxlbWVudGF0aW9uIHByb3ZpZGVkIGJ5IHRoaXMgY2xhc3MgdGVzdHMgd2hl
dGhlciB0aGUKKwkgKiBvdGhlciBvYmplY3QgaXMgYSBub2RlIG9mIHRoZSBzYW1lIHR5cGUgd2l0
aCBzdHJ1Y3R1cmFsbHkgaXNvbW9ycGhpYworCSAqIGNoaWxkIHN1YnRyZWVzLiBTdWJjbGFzc2Vz
IG1heSBvdmVycmlkZSB0aGlzIG1ldGhvZCBhcyBuZWVkZWQuCisJICogPC9wPgorCSAqCisJICog
QHBhcmFtIG5vZGUgdGhlIG5vZGUKKwkgKiBAcGFyYW0gb3RoZXIgdGhlIG90aGVyIG9iamVjdCwg
b3IgPGNvZGU+bnVsbDwvY29kZT4KKwkgKiBAcmV0dXJuIDxjb2RlPnRydWU8L2NvZGU+IGlmIHRo
ZSBzdWJ0cmVlIG1hdGNoZXMsIG9yCisJICogICA8Y29kZT5mYWxzZTwvY29kZT4gaWYgdGhleSBk
byBub3QgbWF0Y2ggb3IgdGhlIG90aGVyIG9iamVjdCBoYXMgYQorCSAqICAgZGlmZmVyZW50IG5v
ZGUgdHlwZSBvciBpcyA8Y29kZT5udWxsPC9jb2RlPgogCSAqLwogCXB1YmxpYyBib29sZWFuIG1h
dGNoKEFzc2VydFN0YXRlbWVudCBub2RlLCBPYmplY3Qgb3RoZXIpIHsKIAkJaWYgKCEob3RoZXIg
aW5zdGFuY2VvZiBBc3NlcnRTdGF0ZW1lbnQpKSB7CkBAIC0xMzk5LDEwICsxNDIyLDExIEBACiAJ
CQkJJiYgc2FmZVN1YnRyZWVNYXRjaChub2RlLmdldE5hbWUoKSwgby5nZXROYW1lKCkpCiAJCQkJ
Ly8gbi5iLiBjb21wYXJlIHJldHVybiB0eXBlIGV2ZW4gZm9yIGNvbnN0cnVjdG9ycwogCQkJCSYm
IHNhZmVTdWJ0cmVlTGlzdE1hdGNoKG5vZGUucGFyYW1ldGVycygpLCBvLnBhcmFtZXRlcnMoKSkK
LQkgCQkJJiYgbm9kZS5nZXRFeHRyYURpbWVuc2lvbnMoKSA9PSBvLmdldEV4dHJhRGltZW5zaW9u
cygpCi0JCQkJJiYgKG5vZGUuZ2V0QVNUKCkuYXBpTGV2ZWwoKSA8IEFTVC5KTFM4ID8gCi0JCQkJ
CQlzYWZlU3VidHJlZUxpc3RNYXRjaChub2RlLnRocm93bkV4Y2VwdGlvbnMoKSwgby50aHJvd25F
eGNlcHRpb25zKCkpIDoKLQkJCQkJCXNhZmVTdWJ0cmVlTGlzdE1hdGNoKG5vZGUudGhyb3duRXhj
ZXB0aW9uVHlwZXMoKSwgby50aHJvd25FeGNlcHRpb25UeXBlcygpKSkKKwkJCQkmJiAoKG5vZGUu
Z2V0QVNUKCkuYXBpTGV2ZWwgPCBBU1QuSkxTOCkgPworCQkJCQkJCShub2RlLmdldEV4dHJhRGlt
ZW5zaW9ucygpID09IG8uZ2V0RXh0cmFEaW1lbnNpb25zKCkKKwkJCQkJCQkJJiYgc2FmZVN1YnRy
ZWVMaXN0TWF0Y2gobm9kZS50aHJvd25FeGNlcHRpb25zKCksIG8udGhyb3duRXhjZXB0aW9ucygp
KSkgOgorCQkJCQkJCShzYWZlU3VidHJlZUxpc3RNYXRjaChub2RlLmdldEV4dHJhRGltZW5zaW9u
VHlwZXMoKSwgby5nZXRFeHRyYURpbWVuc2lvblR5cGVzKCkpCisJCQkJCQkJCSYmIHNhZmVTdWJ0
cmVlTGlzdE1hdGNoKG5vZGUudGhyb3duRXhjZXB0aW9uVHlwZXMoKSwgby50aHJvd25FeGNlcHRp
b25UeXBlcygpKSkpCiAJCQkJJiYgc2FmZVN1YnRyZWVNYXRjaChub2RlLmdldEJvZHkoKSwgby5n
ZXRCb2R5KCkpKTsKIAl9CiAKQEAgLTE4NzgsNyArMTkwMiw5IEBACiAJCXJldHVybgogCQkgICAg
c2FmZVN1YnRyZWVNYXRjaChub2RlLmdldFR5cGUoKSwgby5nZXRUeXBlKCkpCiAJCQkJJiYgc2Fm
ZVN1YnRyZWVNYXRjaChub2RlLmdldE5hbWUoKSwgby5nZXROYW1lKCkpCi0JIAkJCSYmIG5vZGUu
Z2V0RXh0cmFEaW1lbnNpb25zKCkgPT0gby5nZXRFeHRyYURpbWVuc2lvbnMoKQorCSAJCQkmJiAo
KG5vZGUuZ2V0QVNUKCkuYXBpTGV2ZWwgPCBBU1QuSkxTOCkgPworCSAJCQkJCShub2RlLmdldEV4
dHJhRGltZW5zaW9ucygpID09IG8uZ2V0RXh0cmFEaW1lbnNpb25zKCkpIDoKKwkgCQkJCQkJc2Fm
ZVN1YnRyZWVMaXN0TWF0Y2gobm9kZS5nZXRFeHRyYURpbWVuc2lvblR5cGVzKCksIG8uZ2V0RXh0
cmFEaW1lbnNpb25UeXBlcygpKSkKIAkJCQkmJiBzYWZlU3VidHJlZU1hdGNoKG5vZGUuZ2V0SW5p
dGlhbGl6ZXIoKSwgby5nZXRJbml0aWFsaXplcigpKQogCQkJCSYmIChsZXZlbCA+PSBBU1QuSkxT
OCAmJiBub2RlLmlzVmFyYXJncygpKSA/IHNhZmVTdWJ0cmVlTGlzdE1hdGNoKG5vZGUudmFyYXJn
c0Fubm90YXRpb25zKCksIG8udmFyYXJnc0Fubm90YXRpb25zKCkpIDogdHJ1ZTsJCQogCX0KQEAg
LTIzNzEsNyArMjM5Nyw5IEBACiAJCX0KIAkJVmFyaWFibGVEZWNsYXJhdGlvbkZyYWdtZW50IG8g
PSAoVmFyaWFibGVEZWNsYXJhdGlvbkZyYWdtZW50KSBvdGhlcjsKIAkJcmV0dXJuIHNhZmVTdWJ0
cmVlTWF0Y2gobm9kZS5nZXROYW1lKCksIG8uZ2V0TmFtZSgpKQotCQkJJiYgbm9kZS5nZXRFeHRy
YURpbWVuc2lvbnMoKSA9PSBvLmdldEV4dHJhRGltZW5zaW9ucygpCisJCQkmJiAoKG5vZGUuZ2V0
QVNUKCkuYXBpTGV2ZWwgPCBBU1QuSkxTOCkgPworCQkJCQkobm9kZS5nZXRFeHRyYURpbWVuc2lv
bnMoKSA9PSBvLmdldEV4dHJhRGltZW5zaW9ucygpKSA6CisJCQkJCQlzYWZlU3VidHJlZUxpc3RN
YXRjaChub2RlLmdldEV4dHJhRGltZW5zaW9uVHlwZXMoKSwgby5nZXRFeHRyYURpbWVuc2lvblR5
cGVzKCkpKQogCQkJJiYgc2FmZVN1YnRyZWVNYXRjaChub2RlLmdldEluaXRpYWxpemVyKCksIG8u
Z2V0SW5pdGlhbGl6ZXIoKSk7CiAJfQogCmRpZmYgLS1naXQgYS9vcmcuZWNsaXBzZS5qZHQuY29y
ZS9kb20vb3JnL2VjbGlwc2UvamR0L2NvcmUvZG9tL0FTVE5vZGUuamF2YSBiL29yZy5lY2xpcHNl
LmpkdC5jb3JlL2RvbS9vcmcvZWNsaXBzZS9qZHQvY29yZS9kb20vQVNUTm9kZS5qYXZhCmluZGV4
IDZlYTQzYmEuLjE2MjFlYTEgMTAwNjQ0Ci0tLSBhL29yZy5lY2xpcHNlLmpkdC5jb3JlL2RvbS9v
cmcvZWNsaXBzZS9qZHQvY29yZS9kb20vQVNUTm9kZS5qYXZhCisrKyBiL29yZy5lY2xpcHNlLmpk
dC5jb3JlL2RvbS9vcmcvZWNsaXBzZS9qZHQvY29yZS9kb20vQVNUTm9kZS5qYXZhCkBAIC0xLDUg
KzEsNSBAQAogLyoqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioq
KioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioKLSAqIENvcHlyaWdodCAoYykgMjAwMCwg
MjAxMiBJQk0gQ29ycG9yYXRpb24gYW5kIG90aGVycy4KKyAqIENvcHlyaWdodCAoYykgMjAwMCwg
MjAxMyBJQk0gQ29ycG9yYXRpb24gYW5kIG90aGVycy4KICAqIEFsbCByaWdodHMgcmVzZXJ2ZWQu
IFRoaXMgcHJvZ3JhbSBhbmQgdGhlIGFjY29tcGFueWluZyBtYXRlcmlhbHMKICAqIGFyZSBtYWRl
IGF2YWlsYWJsZSB1bmRlciB0aGUgdGVybXMgb2YgdGhlIEVjbGlwc2UgUHVibGljIExpY2Vuc2Ug
djEuMAogICogd2hpY2ggYWNjb21wYW5pZXMgdGhpcyBkaXN0cmlidXRpb24sIGFuZCBpcyBhdmFp
bGFibGUgYXQKQEAgLTc3Myw2ICs3NzMsMTUgQEAKIAlwdWJsaWMgc3RhdGljIGZpbmFsIGludCBV
TklPTl9UWVBFID0gODQ7CiAKIAkvKioKKwkgKiBOb2RlIHR5cGUgY29uc3RhbnQgaW5kaWNhdGlu
ZyBhIG5vZGUgb2YgdHlwZQorCSAqIDxjb2RlPkRpbWVuc2lvblR5cGU8L2NvZGU+LgorCSAqCisJ
ICogQHNlZSBEaW1lbnNpb25UeXBlCisJICogQHNpbmNlIDMuOQorCSAqLworCXB1YmxpYyBzdGF0
aWMgZmluYWwgaW50IERJTUVOU0lPTl9UWVBFID0gODU7CisKKwkvKioKIAkgKiBSZXR1cm5zIHRo
ZSBub2RlIGNsYXNzIGZvciB0aGUgY29ycmVzcG9uZGluZyBub2RlIHR5cGUuCiAJICoKIAkgKiBA
cGFyYW0gbm9kZVR5cGUgQVNUIG5vZGUgdHlwZQpAQCAtOTUyLDYgKzk2MSw4IEBACiAJCQkJcmV0
dXJuIFdoaWxlU3RhdGVtZW50LmNsYXNzOwogCQkJY2FzZSBXSUxEQ0FSRF9UWVBFIDoKIAkJCQly
ZXR1cm4gV2lsZGNhcmRUeXBlLmNsYXNzOworCQkJY2FzZSBESU1FTlNJT05fVFlQRToKKwkJCQly
ZXR1cm4gRGltZW5zaW9uVHlwZS5jbGFzczsKIAkJfQogCQl0aHJvdyBuZXcgSWxsZWdhbEFyZ3Vt
ZW50RXhjZXB0aW9uKCk7CiAJfQpkaWZmIC0tZ2l0IGEvb3JnLmVjbGlwc2UuamR0LmNvcmUvZG9t
L29yZy9lY2xpcHNlL2pkdC9jb3JlL2RvbS9BU1RWaXNpdG9yLmphdmEgYi9vcmcuZWNsaXBzZS5q
ZHQuY29yZS9kb20vb3JnL2VjbGlwc2UvamR0L2NvcmUvZG9tL0FTVFZpc2l0b3IuamF2YQppbmRl
eCBiMjkzMDUzLi5lMmU1ODc3IDEwMDY0NAotLS0gYS9vcmcuZWNsaXBzZS5qZHQuY29yZS9kb20v
b3JnL2VjbGlwc2UvamR0L2NvcmUvZG9tL0FTVFZpc2l0b3IuamF2YQorKysgYi9vcmcuZWNsaXBz
ZS5qZHQuY29yZS9kb20vb3JnL2VjbGlwc2UvamR0L2NvcmUvZG9tL0FTVFZpc2l0b3IuamF2YQpA
QCAtMSw5ICsxLDEzIEBACiAvKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioq
KioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKgotICogQ29weXJpZ2h0IChj
KSAyMDAwLCAyMDExIElCTSBDb3Jwb3JhdGlvbiBhbmQgb3RoZXJzLgorICogQ29weXJpZ2h0IChj
KSAyMDAwLCAyMDEzIElCTSBDb3Jwb3JhdGlvbiBhbmQgb3RoZXJzLgogICogQWxsIHJpZ2h0cyBy
ZXNlcnZlZC4gVGhpcyBwcm9ncmFtIGFuZCB0aGUgYWNjb21wYW55aW5nIG1hdGVyaWFscwogICog
YXJlIG1hZGUgYXZhaWxhYmxlIHVuZGVyIHRoZSB0ZXJtcyBvZiB0aGUgRWNsaXBzZSBQdWJsaWMg
TGljZW5zZSB2MS4wCiAgKiB3aGljaCBhY2NvbXBhbmllcyB0aGlzIGRpc3RyaWJ1dGlvbiwgYW5k
IGlzIGF2YWlsYWJsZSBhdAogICogaHR0cDovL3d3dy5lY2xpcHNlLm9yZy9sZWdhbC9lcGwtdjEw
Lmh0bWwKKyAqCisgKiBUaGlzIGlzIGFuIGltcGxlbWVudGF0aW9uIG9mIGFuIGVhcmx5LWRyYWZ0
IHNwZWNpZmljYXRpb24gZGV2ZWxvcGVkIHVuZGVyIHRoZSBKYXZhCisgKiBDb21tdW5pdHkgUHJv
Y2VzcyAoSkNQKSBhbmQgaXMgbWFkZSBhdmFpbGFibGUgZm9yIHRlc3RpbmcgYW5kIGV2YWx1YXRp
b24gcHVycG9zZXMKKyAqIG9ubHkuIFRoZSBjb2RlIGlzIG5vdCBjb21wYXRpYmxlIHdpdGggYW55
IHNwZWNpZmljYXRpb24gb2YgdGhlIEpDUC4KICAqCiAgKiBDb250cmlidXRvcnM6CiAgKiAgICAg
SUJNIENvcnBvcmF0aW9uIC0gaW5pdGlhbCBBUEkgYW5kIGltcGxlbWVudGF0aW9uCkBAIC0xOTks
NiArMjAzLDIyIEBACiAJCXJldHVybiB0cnVlOwogCX0KIAorCS8qKgorCSAqIFZpc2l0cyB0aGUg
Z2l2ZW4gdHlwZS1zcGVjaWZpYyBBU1Qgbm9kZS4KKwkgKiA8cD4KKwkgKiBUaGUgZGVmYXVsdCBp
bXBsZW1lbnRhdGlvbiBkb2VzIG5vdGhpbmcgYW5kIHJldHVybiB0cnVlLgorCSAqIFN1YmNsYXNz
ZXMgbWF5IHJlaW1wbGVtZW50LgorCSAqIDwvcD4KKwkgKgorCSAqIEBwYXJhbSBub2RlIHRoZSBu
b2RlIHRvIHZpc2l0CisJICogQHJldHVybiA8Y29kZT50cnVlPC9jb2RlPiBpZiB0aGUgY2hpbGRy
ZW4gb2YgdGhpcyBub2RlIHNob3VsZCBiZQorCSAqIHZpc2l0ZWQsIGFuZCA8Y29kZT5mYWxzZTwv
Y29kZT4gaWYgdGhlIGNoaWxkcmVuIG9mIHRoaXMgbm9kZSBzaG91bGQKKwkgKiBiZSBza2lwcGVk
CisJICogQHNpbmNlIDMuOQorCSAqLworCXB1YmxpYyBib29sZWFuIHZpc2l0KERpbWVuc2lvblR5
cGUgbm9kZSkgeworCQlyZXR1cm4gdHJ1ZTsKKwl9CiAKIAkvKioKIAkgKiBWaXNpdHMgdGhlIGdp
dmVuIHR5cGUtc3BlY2lmaWMgQVNUIG5vZGUuCkBAIC0xNjAwLDYgKzE2MjAsMTkgQEAKIAkgKiA8
L3A+CiAJICoKIAkgKiBAcGFyYW0gbm9kZSB0aGUgbm9kZSB0byB2aXNpdAorCSAqIEBzaW5jZSAz
LjkKKwkgKi8KKwlwdWJsaWMgdm9pZCBlbmRWaXNpdChEaW1lbnNpb25UeXBlIG5vZGUpIHsKKwkJ
Ly8gZG8gbm90aGluZyBieSBkZWZhdWx0CisJfQorCisJLyoqCisJICogRW5kIG9mIHZpc2l0IHRo
ZSBnaXZlbiB0eXBlLXNwZWNpZmljIEFTVCBub2RlLgorCSAqIDxwPgorCSAqIFRoZSBkZWZhdWx0
IGltcGxlbWVudGF0aW9uIGRvZXMgbm90aGluZy4gU3ViY2xhc3NlcyBtYXkgcmVpbXBsZW1lbnQu
CisJICogPC9wPgorCSAqCisJICogQHBhcmFtIG5vZGUgdGhlIG5vZGUgdG8gdmlzaXQKIAkgKiBA
c2luY2UgMy4xCiAJICovCiAJcHVibGljIHZvaWQgZW5kVmlzaXQoQW5ub3RhdGlvblR5cGVNZW1i
ZXJEZWNsYXJhdGlvbiBub2RlKSB7CmRpZmYgLS1naXQgYS9vcmcuZWNsaXBzZS5qZHQuY29yZS9k
b20vb3JnL2VjbGlwc2UvamR0L2NvcmUvZG9tL0RpbWVuc2lvblR5cGUuamF2YSBiL29yZy5lY2xp
cHNlLmpkdC5jb3JlL2RvbS9vcmcvZWNsaXBzZS9qZHQvY29yZS9kb20vRGltZW5zaW9uVHlwZS5q
YXZhCm5ldyBmaWxlIG1vZGUgMTAwNjQ0CmluZGV4IDAwMDAwMDAuLmNmZWRjZjkKLS0tIC9kZXYv
bnVsbAorKysgYi9vcmcuZWNsaXBzZS5qZHQuY29yZS9kb20vb3JnL2VjbGlwc2UvamR0L2NvcmUv
ZG9tL0RpbWVuc2lvblR5cGUuamF2YQpAQCAtMCwwICsxLDE5NyBAQAorLyoqKioqKioqKioqKioq
KioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioq
KioqKioqKioKKyAqIENvcHlyaWdodCAoYykgMjAwMCwgMjAxMyBJQk0gQ29ycG9yYXRpb24gYW5k
IG90aGVycy4KKyAqIEFsbCByaWdodHMgcmVzZXJ2ZWQuIFRoaXMgcHJvZ3JhbSBhbmQgdGhlIGFj
Y29tcGFueWluZyBtYXRlcmlhbHMKKyAqIGFyZSBtYWRlIGF2YWlsYWJsZSB1bmRlciB0aGUgdGVy
bXMgb2YgdGhlIEVjbGlwc2UgUHVibGljIExpY2Vuc2UgdjEuMAorICogd2hpY2ggYWNjb21wYW5p
ZXMgdGhpcyBkaXN0cmlidXRpb24sIGFuZCBpcyBhdmFpbGFibGUgYXQKKyAqIGh0dHA6Ly93d3cu
ZWNsaXBzZS5vcmcvbGVnYWwvZXBsLXYxMC5odG1sCisgKgorICogVGhpcyBpcyBhbiBpbXBsZW1l
bnRhdGlvbiBvZiBhbiBlYXJseS1kcmFmdCBzcGVjaWZpY2F0aW9uIGRldmVsb3BlZCB1bmRlciB0
aGUgSmF2YQorICogQ29tbXVuaXR5IFByb2Nlc3MgKEpDUCkgYW5kIGlzIG1hZGUgYXZhaWxhYmxl
IGZvciB0ZXN0aW5nIGFuZCBldmFsdWF0aW9uIHB1cnBvc2VzCisgKiBvbmx5LiBUaGUgY29kZSBp
cyBub3QgY29tcGF0aWJsZSB3aXRoIGFueSBzcGVjaWZpY2F0aW9uIG9mIHRoZSBKQ1AuCisgKgor
ICogQ29udHJpYnV0b3JzOgorICogICAgIElCTSBDb3Jwb3JhdGlvbiAtIGluaXRpYWwgQVBJIGFu
ZCBpbXBsZW1lbnRhdGlvbgorICoqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioq
KioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKiovCitwYWNrYWdlIG9yZy5l
Y2xpcHNlLmpkdC5jb3JlLmRvbTsKKworaW1wb3J0IGphdmEudXRpbC5BcnJheUxpc3Q7CitpbXBv
cnQgamF2YS51dGlsLkxpc3Q7CisKKy8qKgorICogVGhlIGFycmF5IGRpbWVuc2lvbiB0eXBlIG5v
ZGUuIFRoZSBhcnJheSBkaW1lbnNpb24sIHJlcHJlc2VudGVkIGFzIDxiPltdPC9iPiwgbWF5IAor
ICogaW5jbHVkZSBhbiA8Y29kZT5FeHByZXNzaW9uPC9jb2RlPiBkZXBlbmRpbmcgb24gd2hlcmUg
aXQgYXBwZWFycy4gVGhlIG9ubHkgCisgKiBub2RlIHRoYXQgc3VwcG9ydHMgYSBkaW1lbnNpb24g
dHlwZSB3aXRoIGFuIGV4cHJlc3Npb24gaXMgPGNvZGU+QXJyYXlDcmVhdGlvbjwvY29kZT4uCisg
KiBUaGlzIG5vZGUgdHlwZSBpcyBzdXBwb3J0ZWQgb25seSBpbiBKTFM4IG9yIGxhdGVyLgorICoK
KyAqIEZvciBKTFM4OgorICogPHByZT4KKyAqIERpbWVuc2lvblR5cGU6CisgKiAJPGI+WzwvYj4g
e0V4cHJlc3Npb259IDxiPl08L2I+CisgKiA8L3ByZT4KKyAqCisgKiBAc2luY2UgMy45CisgKi8K
K3B1YmxpYyBjbGFzcyBEaW1lbnNpb25UeXBlIGV4dGVuZHMgQW5ub3RhdGFibGVUeXBlIHsKKwor
CisJLyoqCisJICogVGhlICJhbm5vdGF0aW9ucyIgc3RydWN0dXJhbCBwcm9wZXJ0eSBvZiB0aGlz
IG5vZGUgdHlwZSAoY2hpbGQgdHlwZToge0BsaW5rIEFubm90YXRpb259KS4KKwkgKiBAc2luY2Ug
My45CisJICovCisJcHVibGljIHN0YXRpYyBmaW5hbCBDaGlsZExpc3RQcm9wZXJ0eURlc2NyaXB0
b3IgQU5OT1RBVElPTlNfUFJPUEVSVFkgPQorCQluZXcgQ2hpbGRMaXN0UHJvcGVydHlEZXNjcmlw
dG9yKERpbWVuc2lvblR5cGUuY2xhc3MsICJhbm5vdGF0aW9ucyIsIEFubm90YXRpb24uY2xhc3Ms
IE5PX0NZQ0xFX1JJU0spOyAvLyROT04tTkxTLTEkCisKKworCS8qKgorCSAqIFRoZSAiZXhwcmVz
c2lvbiIgc3RydWN0dXJhbCBwcm9wZXJ0eSBvZiB0aGlzIG5vZGUgdHlwZSAoZWxlbWVudCB0eXBl
OiB7QGxpbmsgRXhwcmVzc2lvbn0pLgorCSAqIEBzaW5jZSAzLjkKKwkgKi8KKwlwdWJsaWMgc3Rh
dGljIGZpbmFsIENoaWxkUHJvcGVydHlEZXNjcmlwdG9yIEVYUFJFU1NJT05fUFJPUEVSVFkgPQor
CQkJbmV3IENoaWxkUHJvcGVydHlEZXNjcmlwdG9yKERpbWVuc2lvblR5cGUuY2xhc3MsICJleHBy
ZXNzaW9uIiwgRXhwcmVzc2lvbi5jbGFzcywgTUFOREFUT1JZLCBOT19DWUNMRV9SSVNLKTsgLy8k
Tk9OLU5MUy0xJAorCisKKwkvKioKKwkgKiBBIGxpc3Qgb2YgcHJvcGVydHkgZGVzY3JpcHRvcnMg
KGVsZW1lbnQgdHlwZToKKwkgKiB7QGxpbmsgU3RydWN0dXJhbFByb3BlcnR5RGVzY3JpcHRvcn0p
LAorCSAqIG9yIG51bGwgaWYgdW5pbml0aWFsaXplZC4KKwkgKiBAc2luY2UgMy45CisJICovCisJ
cHJpdmF0ZSBzdGF0aWMgZmluYWwgTGlzdCBQUk9QRVJUWV9ERVNDUklQVE9SU184XzA7CisKKwlz
dGF0aWMgeworCQlMaXN0IHByb3BlcnR5TGlzdCA9IG5ldyBBcnJheUxpc3QoMyk7CisJCWNyZWF0
ZVByb3BlcnR5TGlzdChEaW1lbnNpb25UeXBlLmNsYXNzLCBwcm9wZXJ0eUxpc3QpOworCQlhZGRQ
cm9wZXJ0eShBTk5PVEFUSU9OU19QUk9QRVJUWSwgcHJvcGVydHlMaXN0KTsKKwkJYWRkUHJvcGVy
dHkoRVhQUkVTU0lPTl9QUk9QRVJUWSwgcHJvcGVydHlMaXN0KTsKKwkJUFJPUEVSVFlfREVTQ1JJ
UFRPUlNfOF8wID0gcmVhcFByb3BlcnR5TGlzdChwcm9wZXJ0eUxpc3QpOworCX0KKworCS8qKgor
CSAqIFJldHVybnMgYSBsaXN0IG9mIHN0cnVjdHVyYWwgcHJvcGVydHkgZGVzY3JpcHRvcnMgZm9y
IHRoaXMgbm9kZSB0eXBlLgorCSAqIENsaWVudHMgbXVzdCBub3QgbW9kaWZ5IHRoZSByZXN1bHQu
CisJICoKKwkgKiBAcGFyYW0gYXBpTGV2ZWwgdGhlIEFQSSBsZXZlbDsgb25lIG9mIHRoZQorCSAq
IDxjb2RlPkFTVC5KTFMqPC9jb2RlPiBjb25zdGFudHMKKwkgKiBAcmV0dXJuIGEgbGlzdCBvZiBw
cm9wZXJ0eSBkZXNjcmlwdG9ycyAoZWxlbWVudCB0eXBlOgorCSAqIHtAbGluayBTdHJ1Y3R1cmFs
UHJvcGVydHlEZXNjcmlwdG9yfSkKKwkgKiBAc2luY2UgMy45CisJICovCisJcHVibGljIHN0YXRp
YyBMaXN0IHByb3BlcnR5RGVzY3JpcHRvcnMoaW50IGFwaUxldmVsKSB7CisJCXJldHVybiBQUk9Q
RVJUWV9ERVNDUklQVE9SU184XzA7CisJfQorCisJcHVibGljIERpbWVuc2lvblR5cGUoQVNUIGFz
dCkgeworCQlzdXBlcihhc3QpOworCQl1bnN1cHBvcnRlZEluMl8zXzQoKTsKKwkJdGhpcy5hbm5v
dGF0aW9ucyA9IG5ldyBBU1ROb2RlLk5vZGVMaXN0KEFOTk9UQVRJT05TX1BST1BFUlRZKTsKKwl9
CisKKwkvKioKKwkgKiBUaGUgZXhwcmVzc2lvbiBmb3IgdGhpcyBkaW1lbnNpb24gdHlwZSAoZWxl
bWVudCB0eXBlOgorCSAqIHtAbGluayBFeHByZXNzaW9ufSkuCisJICovCisJcHJpdmF0ZSBFeHBy
ZXNzaW9uIGV4cHJlc3Npb24gPSBudWxsOworCisJLyoqCisJICogU2V0cyB0aGUgZXhwcmVzc2lv
biB0byB0aGlzIGRpbWVuc2lvbi4gVGhpcyBvcGVyYXRpb24gd2lsbCBoYXZlCisJICogZWZmZWN0
IG9ubHkgaWYgdGhpcyBkaW1lbnNpb24gdHlwZSBub2RlIGlzIHBhcnQgb2YgYW4gYXJyYXkgY3Jl
YXRpb24KKwkgKiBub2RlLgorCSAqCisJICogQHBhcmFtIGV4cHJlc3Npb24gdGhlIG5ldyBhcnJh
eSB0eXBlCisJICogQGV4Y2VwdGlvbiBJbGxlZ2FsQXJndW1lbnRFeGNlcHRpb24gaWY6CisJICog
PHVsPgorCSAqIDxsaT50aGUgbm9kZSBiZWxvbmdzIHRvIGEgZGlmZmVyZW50IEFTVDwvbGk+CisJ
ICogPGxpPnRoZSBub2RlIGFscmVhZHkgaGFzIGEgcGFyZW50PC9saT4KKwkgKiA8L3VsPgorCSAq
CisJICogQHNpbmNlIDMuOQorCSAqLworCXB1YmxpYyB2b2lkIHNldEV4cHJlc3Npb24oRXhwcmVz
c2lvbiBleHByZXNzaW9uKSB7CisJCS8vIGFuIEFycmF5Q3JlYXRpb24gY2Fubm90IG9jY3VyIGlu
c2lkZSBhIEFycmF5VHlwZSAtIGN5Y2xlcyBub3QgcG9zc2libGUKKwkJQVNUTm9kZSBvbGRDaGls
ZCA9IHRoaXMuZXhwcmVzc2lvbjsKKwkJcHJlUmVwbGFjZUNoaWxkKG9sZENoaWxkLCBleHByZXNz
aW9uLCBFWFBSRVNTSU9OX1BST1BFUlRZKTsKKwkJdGhpcy5leHByZXNzaW9uID0gZXhwcmVzc2lv
bjsKKwkJcG9zdFJlcGxhY2VDaGlsZChvbGRDaGlsZCwgZXhwcmVzc2lvbiwgRVhQUkVTU0lPTl9Q
Uk9QRVJUWSk7CisJfQorCisJLyoqCisJICogUmV0dXJucyB0aGUgZXhwcmVzc2lvbiBpbiB0aGUg
ZGltZW5zaW9uIHR5cGUgb3IgbnVsbCBpZiBub3QgYXBwbGljYWJsZS4KKwkgKgorCSAqIEByZXR1
cm4gdGhlIGV4cHJlc3Npb24KKwkgKiBAc2luY2UgMy45CisJICovCisJcHVibGljIEV4cHJlc3Np
b24gZXhwcmVzc2lvbigpIHsKKwkJcmV0dXJuIHRoaXMuZXhwcmVzc2lvbjsKKwl9CisKKwlMaXN0
IGludGVybmFsU3RydWN0dXJhbFByb3BlcnRpZXNGb3JUeXBlKGludCBhcGlMZXZlbCkgeworCQly
ZXR1cm4gcHJvcGVydHlEZXNjcmlwdG9ycyhhcGlMZXZlbCk7CisJfQorCisJLyogKG9taXQgamF2
YWRvYyBmb3IgdGhpcyBtZXRob2QpCisJICogTWV0aG9kIGRlY2xhcmVkIG9uIEFTVE5vZGUuCisJ
ICovCisJZmluYWwgQVNUTm9kZSBpbnRlcm5hbEdldFNldENoaWxkUHJvcGVydHkoQ2hpbGRQcm9w
ZXJ0eURlc2NyaXB0b3IgcHJvcGVydHksIGJvb2xlYW4gZ2V0LCBBU1ROb2RlIGNoaWxkKSB7CisJ
CWlmIChwcm9wZXJ0eSA9PSBFWFBSRVNTSU9OX1BST1BFUlRZKSB7CisJCQlpZiAoZ2V0KSB7CisJ
CQkJcmV0dXJuIGV4cHJlc3Npb24oKTsKKwkJCX0gZWxzZSB7CisJCQkJc2V0RXhwcmVzc2lvbigo
RXhwcmVzc2lvbikgY2hpbGQpOworCQkJCXJldHVybiBudWxsOworCQkJfQorCQl9CisJCS8vIGFs
bG93IGRlZmF1bHQgaW1wbGVtZW50YXRpb24gdG8gZmxhZyB0aGUgZXJyb3IKKwkJcmV0dXJuIHN1
cGVyLmludGVybmFsR2V0U2V0Q2hpbGRQcm9wZXJ0eShwcm9wZXJ0eSwgZ2V0LCBjaGlsZCk7CisJ
fQorCisJLyogKG9taXQgamF2YWRvYyBmb3IgdGhpcyBtZXRob2QpCisJICogTWV0aG9kIGRlY2xh
cmVkIG9uIEFTVE5vZGUuCisJICovCisJZmluYWwgTGlzdCBpbnRlcm5hbEdldENoaWxkTGlzdFBy
b3BlcnR5KENoaWxkTGlzdFByb3BlcnR5RGVzY3JpcHRvciBwcm9wZXJ0eSkgeworCQlpZiAocHJv
cGVydHkgPT0gQU5OT1RBVElPTlNfUFJPUEVSVFkpIHsKKwkJCXJldHVybiBhbm5vdGF0aW9ucygp
OworCQl9CisJCS8vIGFsbG93IGRlZmF1bHQgaW1wbGVtZW50YXRpb24gdG8gZmxhZyB0aGUgZXJy
b3IKKwkJcmV0dXJuIHN1cGVyLmludGVybmFsR2V0Q2hpbGRMaXN0UHJvcGVydHkocHJvcGVydHkp
OworCX0KKworCWludCBnZXROb2RlVHlwZTAoKSB7CisJCXJldHVybiBESU1FTlNJT05fVFlQRTsK
Kwl9CisKKwlib29sZWFuIHN1YnRyZWVNYXRjaDAoQVNUTWF0Y2hlciBtYXRjaGVyLCBPYmplY3Qg
b3RoZXIpIHsKKwkJcmV0dXJuIG1hdGNoZXIubWF0Y2godGhpcywgb3RoZXIpOworCX0KKworCUFT
VE5vZGUgY2xvbmUwKEFTVCB0YXJnZXQpIHsKKwkJRGltZW5zaW9uVHlwZSByZXN1bHQgPSBuZXcg
RGltZW5zaW9uVHlwZSh0YXJnZXQpOworCQlyZXN1bHQuYW5ub3RhdGlvbnMuYWRkQWxsKAorCQkJ
CUFTVE5vZGUuY29weVN1YnRyZWVzKHRhcmdldCwgYW5ub3RhdGlvbnMoKSkpOworCQlpZiAodGhp
cy5leHByZXNzaW9uICE9IG51bGwpIHsKKwkJCXJlc3VsdC5zZXRFeHByZXNzaW9uKChFeHByZXNz
aW9uKWV4cHJlc3Npb24oKS5jbG9uZSh0YXJnZXQpKTsKKwkJfQorCQlyZXR1cm4gcmVzdWx0Owor
CX0KKworCXZvaWQgYWNjZXB0MChBU1RWaXNpdG9yIHZpc2l0b3IpIHsKKwkJYm9vbGVhbiB2aXNp
dENoaWxkcmVuID0gdmlzaXRvci52aXNpdCh0aGlzKTsKKwkJaWYgKHZpc2l0Q2hpbGRyZW4pIHsK
KwkJCWFjY2VwdENoaWxkcmVuKHZpc2l0b3IsIHRoaXMuYW5ub3RhdGlvbnMpOworCQkJaWYgKHRo
aXMuZXhwcmVzc2lvbiAhPSBudWxsKSB7CisJCQkJYWNjZXB0Q2hpbGQodmlzaXRvciwgdGhpcy5l
eHByZXNzaW9uKTsKKwkJCX0KKwkJfQorCQl2aXNpdG9yLmVuZFZpc2l0KHRoaXMpOworCX0KKwor
CWludCB0cmVlU2l6ZSgpIHsKKwkJaW50IHNpemUgPSBtZW1TaXplKCkKKwkJCQkrIHRoaXMuYW5u
b3RhdGlvbnMubGlzdFNpemUoKQorCQkJCSsgKHRoaXMuZXhwcmVzc2lvbiA9PSBudWxsID8gMCA6
IHRoaXMuZXhwcmVzc2lvbi50cmVlU2l6ZSgpKTsKKwkJCXJldHVybiBzaXplOworCX0KKworCWlu
dCBtZW1TaXplKCkgeworCQlyZXR1cm4gQkFTRV9OT0RFX1NJWkUgKyAyICogNDsKKwl9Cit9CmRp
ZmYgLS1naXQgYS9vcmcuZWNsaXBzZS5qZHQuY29yZS9kb20vb3JnL2VjbGlwc2UvamR0L2NvcmUv
ZG9tL01ldGhvZERlY2xhcmF0aW9uLmphdmEgYi9vcmcuZWNsaXBzZS5qZHQuY29yZS9kb20vb3Jn
L2VjbGlwc2UvamR0L2NvcmUvZG9tL01ldGhvZERlY2xhcmF0aW9uLmphdmEKaW5kZXggMTk0NmMw
MC4uNzBmNGM1OCAxMDA2NDQKLS0tIGEvb3JnLmVjbGlwc2UuamR0LmNvcmUvZG9tL29yZy9lY2xp
cHNlL2pkdC9jb3JlL2RvbS9NZXRob2REZWNsYXJhdGlvbi5qYXZhCisrKyBiL29yZy5lY2xpcHNl
LmpkdC5jb3JlL2RvbS9vcmcvZWNsaXBzZS9qZHQvY29yZS9kb20vTWV0aG9kRGVjbGFyYXRpb24u
amF2YQpAQCAtMTM4LDExICsxMzgsMTkgQEAKIAkJbmV3IENoaWxkUHJvcGVydHlEZXNjcmlwdG9y
KE1ldGhvZERlY2xhcmF0aW9uLmNsYXNzLCAicmV0dXJuVHlwZTIiLCBUeXBlLmNsYXNzLCBPUFRJ
T05BTCwgTk9fQ1lDTEVfUklTSyk7IC8vJE5PTi1OTFMtMSQKIAogCS8qKgotCSAqIFRoZSAiZXh0
cmFEaW1lbnNpb25zIiBzdHJ1Y3R1cmFsIHByb3BlcnR5IG9mIHRoaXMgbm9kZSB0eXBlICh0eXBl
OiB7QGxpbmsgSW50ZWdlcn0pLgorCSAqIFRoZSAiZXh0cmFEaW1lbnNpb25zIiBzdHJ1Y3R1cmFs
IHByb3BlcnR5IG9mIHRoaXMgbm9kZSB0eXBlICh0eXBlOiB7QGxpbmsgSW50ZWdlcn0pLiBUaGlz
IHByb3BlcnR5IGlzIHN1cHBvcnRlZAorCSAqIG9ubHkgaW4gSkxTNCBvciBiZWxvdy4gRm9yIEpM
UzggYW5kIGFib3ZlLCB1c2UgPGNvZGU+RVhUUkFfRElNRU5TSU9OX1RZUEVTX1BST1BFUlRZPC9j
b2RlPi4KIAkgKiBAc2luY2UgMy4wCiAJICovCiAJcHVibGljIHN0YXRpYyBmaW5hbCBTaW1wbGVQ
cm9wZXJ0eURlc2NyaXB0b3IgRVhUUkFfRElNRU5TSU9OU19QUk9QRVJUWSA9CiAJCW5ldyBTaW1w
bGVQcm9wZXJ0eURlc2NyaXB0b3IoTWV0aG9kRGVjbGFyYXRpb24uY2xhc3MsICJleHRyYURpbWVu
c2lvbnMiLCBpbnQuY2xhc3MsIE1BTkRBVE9SWSk7IC8vJE5PTi1OTFMtMSQKKworCS8qKgorCSAq
IFRoZSAiZXh0cmFEaW1lbnNpb25UeXBlcyIgc3RydWN0dXJhbCBwcm9wZXJ0eSBvZiB0aGlzIG5v
ZGUgdHlwZSAoY2hpbGQgdHlwZToge0BsaW5rIERpbWVuc2lvblR5cGV9KSAoYWRkZWQgaW4gSkxT
OCBBUEkpLgorCSAqIEBzaW5jZSAzLjkKKwkgKi8KKwlwdWJsaWMgc3RhdGljIGZpbmFsIENoaWxk
TGlzdFByb3BlcnR5RGVzY3JpcHRvciBFWFRSQV9ESU1FTlNJT05fVFlQRVNfUFJPUEVSVFkgPQor
CQkJbmV3IENoaWxkTGlzdFByb3BlcnR5RGVzY3JpcHRvcihNZXRob2REZWNsYXJhdGlvbi5jbGFz
cywgImV4dHJhRGltZW5zaW9uVHlwZXMiLCBEaW1lbnNpb25UeXBlLmNsYXNzLCBOT19DWUNMRV9S
SVNLKTsgLy8kTk9OLU5MUy0xJAogCiAJLyoqCiAJICogVGhlICJ0eXBlUGFyYW1ldGVycyIgc3Ry
dWN0dXJhbCBwcm9wZXJ0eSBvZiB0aGlzIG5vZGUgdHlwZSAoZWxlbWVudCB0eXBlOiB7QGxpbmsg
VHlwZVBhcmFtZXRlcn0pIChhZGRlZCBpbiBKTFMzIEFQSSkuCkBAIC0yNTgsNyArMjY2LDcgQEAK
IAkJYWRkUHJvcGVydHkoUkVDRUlWRVJfVFlQRV9QUk9QRVJUWSwgcHJvcGVydHlMaXN0KTsKIAkJ
YWRkUHJvcGVydHkoUkVDRUlWRVJfUVVBTElGSUVSX1BST1BFUlRZLCBwcm9wZXJ0eUxpc3QpOwog
CQlhZGRQcm9wZXJ0eShQQVJBTUVURVJTX1BST1BFUlRZLCBwcm9wZXJ0eUxpc3QpOwotCQlhZGRQ
cm9wZXJ0eShFWFRSQV9ESU1FTlNJT05TX1BST1BFUlRZLCBwcm9wZXJ0eUxpc3QpOworCQlhZGRQ
cm9wZXJ0eShFWFRSQV9ESU1FTlNJT05fVFlQRVNfUFJPUEVSVFksIHByb3BlcnR5TGlzdCk7CiAJ
CWFkZFByb3BlcnR5KFRIUk9XTl9FWENFUFRJT05fVFlQRVNfUFJPUEVSVFksIHByb3BlcnR5TGlz
dCk7CiAJCWFkZFByb3BlcnR5KEJPRFlfUFJPUEVSVFksIHByb3BlcnR5TGlzdCk7CiAJCVBST1BF
UlRZX0RFU0NSSVBUT1JTXzhfMCA9IHJlYXBQcm9wZXJ0eUxpc3QocHJvcGVydHlMaXN0KTsJCkBA
IC0zNDQsNiArMzUyLDEzIEBACiAJcHJpdmF0ZSBpbnQgZXh0cmFBcnJheURpbWVuc2lvbnMgPSAw
OwogCiAJLyoqCisJICogVGhlIGV4dHJhIGRpbWVuc2lvbiB0eXBlcyB0aGlzIG5vZGUgaGFzIGlm
IGFueS4KKwkgKiAKKwkgKiBAc2luY2UgMy45CisJICovCisJcHJvdGVjdGVkIEFTVE5vZGUuTm9k
ZUxpc3QgZXh0cmFEaW1lbnNpb25UeXBlcyA9IG51bGw7CisKKwkvKioKIAkgKiBUaGUgbGlzdCBv
ZiB0aHJvd24gZXhjZXB0aW9uIG5hbWVzIChlbGVtZW50IHR5cGU6IHtAbGluayBOYW1lfSkuCiAJ
ICogRGVmYXVsdHMgdG8gYW4gZW1wdHkgbGlzdCBmb3IgYXBpIGxldmVscyBiZWxvdyBKTFM4Lgog
CSAqLwpAQCAtMzgwLDEwICszOTUsMTEgQEAKIAkJc3VwZXIoYXN0KTsKIAkJaWYgKGFzdC5hcGlM
ZXZlbCA+PSBBU1QuSkxTM19JTlRFUk5BTCkgewogCQkJdGhpcy50eXBlUGFyYW1ldGVycyA9IG5l
dyBBU1ROb2RlLk5vZGVMaXN0KFRZUEVfUEFSQU1FVEVSU19QUk9QRVJUWSk7Ci0JCX0KLQkJaWYg
KGFzdC5hcGlMZXZlbCgpIDwgQVNULkpMUzgpIHsKKwkJfSAKKwkJaWYgKGFzdC5hcGlMZXZlbCA8
IEFTVC5KTFM4KSB7CiAJCQl0aGlzLnRocm93bkV4Y2VwdGlvbnMgPSBuZXcgQVNUTm9kZS5Ob2Rl
TGlzdChUSFJPV05fRVhDRVBUSU9OU19QUk9QRVJUWSk7CiAJCX0gZWxzZSB7CisJCQl0aGlzLmV4
dHJhRGltZW5zaW9uVHlwZXMgPSBuZXcgQVNUTm9kZS5Ob2RlTGlzdChFWFRSQV9ESU1FTlNJT05f
VFlQRVNfUFJPUEVSVFkpOwogCQkJdGhpcy50aHJvd25FeGNlcHRpb25UeXBlcyA9IG5ldyBBU1RO
b2RlLk5vZGVMaXN0KFRIUk9XTl9FWENFUFRJT05fVFlQRVNfUFJPUEVSVFkpOwogCQl9CiAJfQpA
QCAtNTE3LDYgKzUzMyw5IEBACiAJCWlmIChwcm9wZXJ0eSA9PSBUSFJPV05fRVhDRVBUSU9OX1RZ
UEVTX1BST1BFUlRZKSB7CiAJCQlyZXR1cm4gdGhyb3duRXhjZXB0aW9uVHlwZXMoKTsKIAkJfQkJ
CisJCWlmIChwcm9wZXJ0eSA9PSBFWFRSQV9ESU1FTlNJT05fVFlQRVNfUFJPUEVSVFkpIHsKKwkJ
CXJldHVybiB0aGlzLmV4dHJhRGltZW5zaW9uVHlwZXM7CisJCX0KIAkJLy8gYWxsb3cgZGVmYXVs
dCBpbXBsZW1lbnRhdGlvbiB0byBmbGFnIHRoZSBlcnJvcgogCQlyZXR1cm4gc3VwZXIuaW50ZXJu
YWxHZXRDaGlsZExpc3RQcm9wZXJ0eShwcm9wZXJ0eSk7CiAJfQpAQCAtNTc0LDcgKzU5MywxMiBA
QAogCQkJcmVzdWx0LnNldFJlY2VpdmVyUXVhbGlmaWVyKChTaW1wbGVOYW1lKSBBU1ROb2RlLmNv
cHlTdWJ0cmVlKHRhcmdldCwgdGhpcy5yZWNlaXZlclF1YWxpZmllcikpOwogCQl9CiAJCXJlc3Vs
dC5zZXRDb25zdHJ1Y3Rvcihpc0NvbnN0cnVjdG9yKCkpOwotCQlyZXN1bHQuc2V0RXh0cmFEaW1l
bnNpb25zKGdldEV4dHJhRGltZW5zaW9ucygpKTsKKwkJaWYgKHRoaXMuYXN0LmFwaUxldmVsID49
IEFTVC5KTFM4KSB7CisJCQlyZXN1bHQuZXh0cmFEaW1lbnNpb25UeXBlcy5hZGRBbGwoCisJCQkJ
CUFTVE5vZGUuY29weVN1YnRyZWVzKHRhcmdldCwgZ2V0RXh0cmFEaW1lbnNpb25UeXBlcygpKSk7
CisJCX0gZWxzZSB7CisJCQlyZXN1bHQuc2V0RXh0cmFEaW1lbnNpb25zKGdldEV4dHJhRGltZW5z
aW9ucygpKTsKKwkJfQogCQlyZXN1bHQuc2V0TmFtZSgoU2ltcGxlTmFtZSkgZ2V0TmFtZSgpLmNs
b25lKHRhcmdldCkpOwogCQlyZXN1bHQucGFyYW1ldGVycygpLmFkZEFsbCgKIAkJCUFTVE5vZGUu
Y29weVN1YnRyZWVzKHRhcmdldCwgcGFyYW1ldGVycygpKSk7CkBAIC05OTEsNyArMTAxNSw3IEBA
CiAKIAkvKioKIAkgKiBSZXR1cm5zIHRoZSBudW1iZXIgb2YgZXh0cmEgYXJyYXkgZGltZW5zaW9u
cyBvdmVyIGFuZCBhYm92ZSB0aGUKLQkgKiBleHBsaWNpdGx5LXNwZWNpZmllZCByZXR1cm4gdHlw
ZS4KKwkgKiBleHBsaWNpdGx5LXNwZWNpZmllZCByZXR1cm4gdHlwZSAoTm90IHN1cHBvcnRlZCBp
biBKTFM4IGFuZCBhYm92ZSkuCiAJICogPHA+CiAJICogRm9yIGV4YW1wbGUsIDxjb2RlPmludCBm
b28oKVtdW108L2NvZGU+IGhhcyBhIHJldHVybiB0eXBlIG9mCiAJICogPGNvZGU+aW50PC9jb2Rl
PiBhbmQgdHdvIGV4dHJhIGFycmF5IGRpbWVuc2lvbnM7CkBAIC0xMDA1LDEyICsxMDI5LDEzIEBA
CiAJICogQHNpbmNlIDIuMQogCSAqLwogCXB1YmxpYyBpbnQgZ2V0RXh0cmFEaW1lbnNpb25zKCkg
eworCQlzdXBwb3J0ZWRPbmx5SW4yXzNfNCgpOwogCQlyZXR1cm4gdGhpcy5leHRyYUFycmF5RGlt
ZW5zaW9uczsKIAl9CiAKIAkvKioKIAkgKiBTZXRzIHRoZSBudW1iZXIgb2YgZXh0cmEgYXJyYXkg
ZGltZW5zaW9ucyBvdmVyIGFuZCBhYm92ZSB0aGUKLQkgKiBleHBsaWNpdGx5LXNwZWNpZmllZCBy
ZXR1cm4gdHlwZS4KKwkgKiBleHBsaWNpdGx5LXNwZWNpZmllZCByZXR1cm4gdHlwZSAoTm90IHN1
cHBvcnRlZCBpbiBKTFM4IGFuZCBhYm92ZSkuCiAJICogPHA+CiAJICogRm9yIGV4YW1wbGUsIDxj
b2RlPmludCBmb28oKVtdW108L2NvZGU+IGlzIHJlbmRlcmVkIGFzIGEgcmV0dXJuCiAJICogdHlw
ZSBvZiA8Y29kZT5pbnQ8L2NvZGU+IHdpdGggdHdvIGV4dHJhIGFycmF5IGRpbWVuc2lvbnM7CkBA
IC0xMDI2LDEyICsxMDUxLDI0IEBACiAJICogQHNpbmNlIDIuMQogCSAqLwogCXB1YmxpYyB2b2lk
IHNldEV4dHJhRGltZW5zaW9ucyhpbnQgZGltZW5zaW9ucykgeworCQlzdXBwb3J0ZWRPbmx5SW4y
XzNfNCgpOwogCQlpZiAoZGltZW5zaW9ucyA8IDApIHsKIAkJCXRocm93IG5ldyBJbGxlZ2FsQXJn
dW1lbnRFeGNlcHRpb24oKTsKIAkJfQogCQlwcmVWYWx1ZUNoYW5nZShFWFRSQV9ESU1FTlNJT05T
X1BST1BFUlRZKTsKIAkJdGhpcy5leHRyYUFycmF5RGltZW5zaW9ucyA9IGRpbWVuc2lvbnM7CiAJ
CXBvc3RWYWx1ZUNoYW5nZShFWFRSQV9ESU1FTlNJT05TX1BST1BFUlRZKTsKKwl9CisKKwkvKioK
KwkgKiBSZXR1cm5zIHRoZSBsaXZlIG9yZGVyZWQgbGlzdCBvZiBleHRyYSBkaW1lbnNpb24gdHlw
ZXMgaWYgYW55IChKTFM4IEFQSSBvbmx5KS4KKwkgKiAKKwkgKiBAcmV0dXJuIHRoZSBsaXZlIGxp
c3Qgb2YgZXh0cmEgZGltZW5zaW9ucyBpZiBhbnkgKGVsZW1lbnQgdHlwZToge0BsaW5rIERpbWVu
c2lvblR5cGV9W10pCisJICogQHNpbmNlIDMuOQorCSAqLworCXB1YmxpYyBMaXN0IGdldEV4dHJh
RGltZW5zaW9uVHlwZXMoKSB7CisJCXVuc3VwcG9ydGVkSW4yXzNfNCgpOworCQlyZXR1cm4gdGhp
cy5leHRyYURpbWVuc2lvblR5cGVzOwogCX0KIAogCS8qKgpAQCAtMTA5NCw3ICsxMTMxLDcgQEAK
IAkgKiBNZXRob2QgZGVjbGFyZWQgb24gQVNUTm9kZS4KIAkgKi8KIAlpbnQgbWVtU2l6ZSgpIHsK
LQkJcmV0dXJuIHN1cGVyLm1lbVNpemUoKSArIDEyICogNDsKKwkJcmV0dXJuIHN1cGVyLm1lbVNp
emUoKSArIDEzICogNDsKIAl9CiAKIAkvKiAob21pdCBqYXZhZG9jIGZvciB0aGlzIG1ldGhvZCkK
QEAgLTExMTEsNyArMTE0OCw5IEBACiAJCQkrICh0aGlzLnJlY2VpdmVyUXVhbGlmaWVyID09IG51
bGwgPyAwIDogdGhpcy5yZWNlaXZlclF1YWxpZmllci50cmVlU2l6ZSgpKQogCQkJKyAodGhpcy5y
ZXR1cm5UeXBlID09IG51bGwgPyAwIDogdGhpcy5yZXR1cm5UeXBlLnRyZWVTaXplKCkpCiAJCQkr
IHRoaXMucGFyYW1ldGVycy5saXN0U2l6ZSgpCi0JCQkrICh0aGlzLmFzdC5hcGlMZXZlbCA8IEFT
VC5KTFM4ID8gdGhpcy50aHJvd25FeGNlcHRpb25zLmxpc3RTaXplKCkgOiB0aGlzLnRocm93bkV4
Y2VwdGlvblR5cGVzLmxpc3RTaXplKCkpCisJCQkrICh0aGlzLmFzdC5hcGlMZXZlbCA8IEFTVC5K
TFM4ID8gCisJCQkJCXRoaXMudGhyb3duRXhjZXB0aW9ucy5saXN0U2l6ZSgpIAorCQkJCQk6IHRo
aXMuZXh0cmFEaW1lbnNpb25UeXBlcy5saXN0U2l6ZSgpICsgdGhpcy50aHJvd25FeGNlcHRpb25U
eXBlcy5saXN0U2l6ZSgpKQogCQkJKyAodGhpcy5vcHRpb25hbEJvZHkgPT0gbnVsbCA/IDAgOiBn
ZXRCb2R5KCkudHJlZVNpemUoKSk7CiAJfQogfQpkaWZmIC0tZ2l0IGEvb3JnLmVjbGlwc2UuamR0
LmNvcmUvZG9tL29yZy9lY2xpcHNlL2pkdC9jb3JlL2RvbS9SZWNvdmVyZWRWYXJpYWJsZUJpbmRp
bmcuamF2YSBiL29yZy5lY2xpcHNlLmpkdC5jb3JlL2RvbS9vcmcvZWNsaXBzZS9qZHQvY29yZS9k
b20vUmVjb3ZlcmVkVmFyaWFibGVCaW5kaW5nLmphdmEKaW5kZXggYmE1MTJmYy4uMjEzN2Y0NCAx
MDA2NDQKLS0tIGEvb3JnLmVjbGlwc2UuamR0LmNvcmUvZG9tL29yZy9lY2xpcHNlL2pkdC9jb3Jl
L2RvbS9SZWNvdmVyZWRWYXJpYWJsZUJpbmRpbmcuamF2YQorKysgYi9vcmcuZWNsaXBzZS5qZHQu
Y29yZS9kb20vb3JnL2VjbGlwc2UvamR0L2NvcmUvZG9tL1JlY292ZXJlZFZhcmlhYmxlQmluZGlu
Zy5qYXZhCkBAIC0xLDUgKzEsNSBAQAogLyoqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioq
KioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioKLSAqIENvcHly
aWdodCAoYykgMjAwNywgMjAwOSBJQk0gQ29ycG9yYXRpb24gYW5kIG90aGVycy4KKyAqIENvcHly
aWdodCAoYykgMjAwNywgMjAxMyBJQk0gQ29ycG9yYXRpb24gYW5kIG90aGVycy4KICAqIEFsbCBy
aWdodHMgcmVzZXJ2ZWQuIFRoaXMgcHJvZ3JhbSBhbmQgdGhlIGFjY29tcGFueWluZyBtYXRlcmlh
bHMKICAqIGFyZSBtYWRlIGF2YWlsYWJsZSB1bmRlciB0aGUgdGVybXMgb2YgdGhlIEVjbGlwc2Ug
UHVibGljIExpY2Vuc2UgdjEuMAogICogd2hpY2ggYWNjb21wYW5pZXMgdGhpcyBkaXN0cmlidXRp
b24sIGFuZCBpcyBhdmFpbGFibGUgYXQKQEAgLTc3LDcgKzc3LDE2IEBACiAJcHVibGljIGJvb2xl
YW4gaXNQYXJhbWV0ZXIoKSB7CiAJCXJldHVybiB0aGlzLnZhcmlhYmxlRGVjbGFyYXRpb24gaW5z
dGFuY2VvZiBTaW5nbGVWYXJpYWJsZURlY2xhcmF0aW9uOwogCX0KLQorCXB1YmxpYyBpbnQgZ2V0
RXh0cmFEaW1lbnNpb25zKCkgeworCQlpZiAodGhpcy52YXJpYWJsZURlY2xhcmF0aW9uLmFzdC5h
cGlMZXZlbCA+PSBBU1QuSkxTOCkgeworCQkJaWYgKHRoaXMudmFyaWFibGVEZWNsYXJhdGlvbiBp
bnN0YW5jZW9mIFZhcmlhYmxlRGVjbGFyYXRpb25GcmFnbWVudCkgeworCQkJCXJldHVybiAoKFZh
cmlhYmxlRGVjbGFyYXRpb25GcmFnbWVudCkgdGhpcy52YXJpYWJsZURlY2xhcmF0aW9uKS5nZXRF
eHRyYURpbWVuc2lvblR5cGVzKCkuc2l6ZSgpOworCQkJfSBlbHNlIGlmICh0aGlzLnZhcmlhYmxl
RGVjbGFyYXRpb24gaW5zdGFuY2VvZiBTaW5nbGVWYXJpYWJsZURlY2xhcmF0aW9uKSB7CisJCQkJ
cmV0dXJuICgoU2luZ2xlVmFyaWFibGVEZWNsYXJhdGlvbikgdGhpcy52YXJpYWJsZURlY2xhcmF0
aW9uKS5nZXRFeHRyYURpbWVuc2lvblR5cGVzKCkuc2l6ZSgpOworCQkJfQorCQl9CisJCXJldHVy
biB0aGlzLnZhcmlhYmxlRGVjbGFyYXRpb24uZ2V0RXh0cmFEaW1lbnNpb25zKCk7CisJfQogCXB1
YmxpYyBJQW5ub3RhdGlvbkJpbmRpbmdbXSBnZXRBbm5vdGF0aW9ucygpIHsKIAkJcmV0dXJuIEFu
bm90YXRpb25CaW5kaW5nLk5vQW5ub3RhdGlvbnM7CiAJfQpAQCAtOTQsNyArMTAzLDcgQEAKIAkJ
CQkuYXBwZW5kKCJ2YXJpYWJsZURlY2xhcmF0aW9uIikgLy8kTk9OLU5MUy0xJAogCQkJCS5hcHBl
bmQodGhpcy52YXJpYWJsZURlY2xhcmF0aW9uLmdldENsYXNzKCkpCiAJCQkJLmFwcGVuZCh0aGlz
LnZhcmlhYmxlRGVjbGFyYXRpb24uZ2V0TmFtZSgpLmdldElkZW50aWZpZXIoKSkKLQkJCQkuYXBw
ZW5kKHRoaXMudmFyaWFibGVEZWNsYXJhdGlvbi5nZXRFeHRyYURpbWVuc2lvbnMoKSk7CisJCQkJ
LmFwcGVuZChnZXRFeHRyYURpbWVuc2lvbnMoKSk7CiAJCX0KIAkJcmV0dXJuIFN0cmluZy52YWx1
ZU9mKGJ1ZmZlcik7CiAJfQpkaWZmIC0tZ2l0IGEvb3JnLmVjbGlwc2UuamR0LmNvcmUvZG9tL29y
Zy9lY2xpcHNlL2pkdC9jb3JlL2RvbS9TaW5nbGVWYXJpYWJsZURlY2xhcmF0aW9uLmphdmEgYi9v
cmcuZWNsaXBzZS5qZHQuY29yZS9kb20vb3JnL2VjbGlwc2UvamR0L2NvcmUvZG9tL1NpbmdsZVZh
cmlhYmxlRGVjbGFyYXRpb24uamF2YQppbmRleCA1YzI4YjA4Li5lYWZmZDhjIDEwMDY0NAotLS0g
YS9vcmcuZWNsaXBzZS5qZHQuY29yZS9kb20vb3JnL2VjbGlwc2UvamR0L2NvcmUvZG9tL1Npbmds
ZVZhcmlhYmxlRGVjbGFyYXRpb24uamF2YQorKysgYi9vcmcuZWNsaXBzZS5qZHQuY29yZS9kb20v
b3JnL2VjbGlwc2UvamR0L2NvcmUvZG9tL1NpbmdsZVZhcmlhYmxlRGVjbGFyYXRpb24uamF2YQpA
QCAtOTAsMTEgKzkwLDE5IEBACiAJCW5ldyBDaGlsZExpc3RQcm9wZXJ0eURlc2NyaXB0b3IoU2lu
Z2xlVmFyaWFibGVEZWNsYXJhdGlvbi5jbGFzcywgInZhcmFyZ3NBbm5vdGF0aW9ucyIsIEFubm90
YXRpb24uY2xhc3MsIE5PX0NZQ0xFX1JJU0spOyAvLyROT04tTkxTLTEkCiAKIAkvKioKLQkgKiBU
aGUgImV4dHJhRGltZW5zaW9ucyIgc3RydWN0dXJhbCBwcm9wZXJ0eSBvZiB0aGlzIG5vZGUgdHlw
ZSAodHlwZToge0BsaW5rIEludGVnZXJ9KS4KKwkgKiBUaGUgImV4dHJhRGltZW5zaW9ucyIgc3Ry
dWN0dXJhbCBwcm9wZXJ0eSBvZiB0aGlzIG5vZGUgdHlwZSAodHlwZToge0BsaW5rIEludGVnZXJ9
KS4gVGhpcyBwcm9wZXJ0eSBpcyBzdXBwb3J0ZWQKKwkgKiBvbmx5IGluIEpMUzQgb3IgYmVsb3cu
IEZvciBKTFM4IGFuZCBhYm92ZSwgdXNlIDxjb2RlPkVYVFJBX0RJTUVOU0lPTl9UWVBFU19QUk9Q
RVJUWTwvY29kZT4uCiAJICogQHNpbmNlIDMuMAogCSAqLwogCXB1YmxpYyBzdGF0aWMgZmluYWwg
U2ltcGxlUHJvcGVydHlEZXNjcmlwdG9yIEVYVFJBX0RJTUVOU0lPTlNfUFJPUEVSVFkgPQogCQlu
ZXcgU2ltcGxlUHJvcGVydHlEZXNjcmlwdG9yKFNpbmdsZVZhcmlhYmxlRGVjbGFyYXRpb24uY2xh
c3MsICJleHRyYURpbWVuc2lvbnMiLCBpbnQuY2xhc3MsIE1BTkRBVE9SWSk7IC8vJE5PTi1OTFMt
MSQKKworCS8qKgorCSAqIFRoZSAiZXh0cmFEaW1lbnNpb25UeXBlcyIgc3RydWN0dXJhbCBwcm9w
ZXJ0eSBvZiB0aGlzIG5vZGUgdHlwZSAoY2hpbGQgdHlwZToge0BsaW5rIERpbWVuc2lvblR5cGV9
KSAoYWRkZWQgaW4gSkxTOCBBUEkpLgorCSAqIEBzaW5jZSAzLjkKKwkgKi8KKwlwdWJsaWMgc3Rh
dGljIGZpbmFsIENoaWxkTGlzdFByb3BlcnR5RGVzY3JpcHRvciBFWFRSQV9ESU1FTlNJT05fVFlQ
RVNfUFJPUEVSVFkgPQorCQkJbmV3IENoaWxkTGlzdFByb3BlcnR5RGVzY3JpcHRvcihTaW5nbGVW
YXJpYWJsZURlY2xhcmF0aW9uLmNsYXNzLCAiZXh0cmFEaW1lbnNpb25UeXBlcyIsIERpbWVuc2lv
blR5cGUuY2xhc3MsIE5PX0NZQ0xFX1JJU0spOyAvLyROT04tTkxTLTEkCiAKIAkvKioKIAkgKiBU
aGUgImluaXRpYWxpemVyIiBzdHJ1Y3R1cmFsIHByb3BlcnR5IG9mIHRoaXMgbm9kZSB0eXBlIChj
aGlsZCB0eXBlOiB7QGxpbmsgRXhwcmVzc2lvbn0pLgpAQCAtMTU1LDcgKzE2Myw3IEBACiAJCWFk
ZFByb3BlcnR5KFZBUkFSR1NfQU5OT1RBVElPTlNfUFJPUEVSVFksIHByb3BlcnR5TGlzdCk7CiAJ
CWFkZFByb3BlcnR5KFZBUkFSR1NfUFJPUEVSVFksIHByb3BlcnR5TGlzdCk7CiAJCWFkZFByb3Bl
cnR5KE5BTUVfUFJPUEVSVFksIHByb3BlcnR5TGlzdCk7Ci0JCWFkZFByb3BlcnR5KEVYVFJBX0RJ
TUVOU0lPTlNfUFJPUEVSVFksIHByb3BlcnR5TGlzdCk7CisJCWFkZFByb3BlcnR5KEVYVFJBX0RJ
TUVOU0lPTl9UWVBFU19QUk9QRVJUWSwgcHJvcGVydHlMaXN0KTsKIAkJYWRkUHJvcGVydHkoSU5J
VElBTElaRVJfUFJPUEVSVFksIHByb3BlcnR5TGlzdCk7CiAJCVBST1BFUlRZX0RFU0NSSVBUT1JT
XzhfMCA9IHJlYXBQcm9wZXJ0eUxpc3QocHJvcGVydHlMaXN0KTsJCQogCQpAQCAtMjI1LDYgKzIz
MywxMyBAQAogCXByaXZhdGUgaW50IGV4dHJhQXJyYXlEaW1lbnNpb25zID0gMDsKIAogCS8qKgor
CSAqIExpc3Qgb2YgZXh0cmEgZGltZW5zaW9uIHR5cGVzIHRoaXMgbm9kZSBoYXMuCisJICogCisJ
ICogQHNpbmNlIDMuOQorCSAqLworCXByb3RlY3RlZCBBU1ROb2RlLk5vZGVMaXN0IGV4dHJhRGlt
ZW5zaW9uVHlwZXMgPSBudWxsOworCisJLyoqCiAJICogVGhlIGluaXRpYWxpemVyIGV4cHJlc3Np
b24sIG9yIDxjb2RlPm51bGw8L2NvZGU+IGlmIG5vbmU7CiAJICogZGVmYXVsdHMgdG8gbm9uZS4K
IAkgKi8KQEAgLTI1Myw2ICsyNjgsNyBAQAogCQkJdGhpcy5tb2RpZmllcnMgPSBuZXcgQVNUTm9k
ZS5Ob2RlTGlzdChNT0RJRklFUlMyX1BST1BFUlRZKTsKIAkJCWlmIChhc3QuYXBpTGV2ZWwgPj0g
QVNULkpMUzgpIHsKIAkJCQl0aGlzLnZhcmFyZ3NBbm5vdGF0aW9ucyA9IG5ldyBBU1ROb2RlLk5v
ZGVMaXN0KFZBUkFSR1NfQU5OT1RBVElPTlNfUFJPUEVSVFkpOworCQkJCXRoaXMuZXh0cmFEaW1l
bnNpb25UeXBlcyA9IG5ldyBBU1ROb2RlLk5vZGVMaXN0KEVYVFJBX0RJTUVOU0lPTl9UWVBFU19Q
Uk9QRVJUWSk7CiAJCQl9CiAJCX0KIAl9CkBAIC0zNzAsNiArMzg2LDkgQEAKIAkJaWYgKHByb3Bl
cnR5ID09IFZBUkFSR1NfQU5OT1RBVElPTlNfUFJPUEVSVFkpIHsKIAkJCXJldHVybiB2YXJhcmdz
QW5ub3RhdGlvbnMoKTsKIAkJfQorCQlpZiAocHJvcGVydHkgPT0gRVhUUkFfRElNRU5TSU9OX1RZ
UEVTX1BST1BFUlRZKSB7CisJCQlyZXR1cm4gdGhpcy5leHRyYURpbWVuc2lvblR5cGVzOworCQl9
CiAJCS8vIGFsbG93IGRlZmF1bHQgaW1wbGVtZW50YXRpb24gdG8gZmxhZyB0aGUgZXJyb3IKIAkJ
cmV0dXJuIHN1cGVyLmludGVybmFsR2V0Q2hpbGRMaXN0UHJvcGVydHkocHJvcGVydHkpOwogCX0K
QEAgLTM5NCw3ICs0MTMsMTIgQEAKIAkJCXJlc3VsdC5zZXRWYXJhcmdzKGlzVmFyYXJncygpKTsK
IAkJfQogCQlyZXN1bHQuc2V0VHlwZSgoVHlwZSkgZ2V0VHlwZSgpLmNsb25lKHRhcmdldCkpOwot
CQlyZXN1bHQuc2V0RXh0cmFEaW1lbnNpb25zKGdldEV4dHJhRGltZW5zaW9ucygpKTsKKwkJaWYg
KHRoaXMuYXN0LmFwaUxldmVsID49IEFTVC5KTFM4KSB7CisJCQlyZXN1bHQuZXh0cmFEaW1lbnNp
b25UeXBlcy5hZGRBbGwoCisJCQkJCUFTVE5vZGUuY29weVN1YnRyZWVzKHRhcmdldCwgdGhpcy5l
eHRyYURpbWVuc2lvblR5cGVzKSk7CisJCX0gZWxzZSB7CisJCQlyZXN1bHQuc2V0RXh0cmFEaW1l
bnNpb25zKGdldEV4dHJhRGltZW5zaW9ucygpKTsKKwkJfQogCQlyZXN1bHQuc2V0TmFtZSgoU2lt
cGxlTmFtZSkgZ2V0TmFtZSgpLmNsb25lKHRhcmdldCkpOwogCQlyZXN1bHQuc2V0SW5pdGlhbGl6
ZXIoCiAJCQkoRXhwcmVzc2lvbikgQVNUTm9kZS5jb3B5U3VidHJlZSh0YXJnZXQsIGdldEluaXRp
YWxpemVyKCkpKTsKQEAgLTYzMywyNSArNjU3LDQ4IEBACiAJCXBvc3RWYWx1ZUNoYW5nZShWQVJB
UkdTX1BST1BFUlRZKTsKIAl9CiAKLQkvKiAob21pdCBqYXZhZG9jIGZvciB0aGlzIG1ldGhvZCkK
LQkgKiBNZXRob2QgZGVjbGFyZWQgb24gVmFyaWFibGVEZWNsYXJhdGlvbi4KKwkvKioKKwkgKiBS
ZXR1cm5zIHRoZSBudW1iZXIgb2YgZXh0cmEgYXJyYXkgZGltZW5zaW9ucyBvdmVyIGFuZCBhYm92
ZSB0aGUKKwkgKiBleHBsaWNpdGx5LXNwZWNpZmllZCB0eXBlIChOb3Qgc3VwcG9ydGVkIGluIEpM
UzggYW5kIGFib3ZlKS4KKwkgKgorCSAqIEBzZWUgVmFyaWFibGVEZWNsYXJhdGlvbiNnZXRFeHRy
YURpbWVuc2lvbnMoKQorCSAqIEByZXR1cm4gdGhlIG51bWJlciBvZiBleHRyYSBhcnJheSBkaW1l
bnNpb25zCiAJICogQHNpbmNlIDIuMQogCSAqLwogCXB1YmxpYyBpbnQgZ2V0RXh0cmFEaW1lbnNp
b25zKCkgeworCQlzdXBwb3J0ZWRPbmx5SW4yXzNfNCgpOwogCQlyZXR1cm4gdGhpcy5leHRyYUFy
cmF5RGltZW5zaW9uczsKIAl9CiAKLQkvKiAob21pdCBqYXZhZG9jIGZvciB0aGlzIG1ldGhvZCkK
LQkgKiBNZXRob2QgZGVjbGFyZWQgb24gVmFyaWFibGVEZWNsYXJhdGlvbi4KKwkvKioKKwkgKiBT
ZXRzIHRoZSBudW1iZXIgb2YgZXh0cmEgYXJyYXkgZGltZW5zaW9ucyBvdmVyIGFuZCBhYm92ZSB0
aGUKKwkgKiBleHBsaWNpdGx5LXNwZWNpZmllZCB0eXBlIChOb3Qgc3VwcG9ydGVkIGluIEpMUzgg
YW5kIGFib3ZlKS4KKwkgKgorCSAqIEBzZWUgVmFyaWFibGVEZWNsYXJhdGlvbiNnZXRFeHRyYURp
bWVuc2lvbnMoKQorCSAqIEBwYXJhbSBkaW1lbnNpb25zIHRoZSBudW1iZXIgb2YgYXJyYXkgZGlt
ZW5zaW9ucworCSAqIEBleGNlcHRpb24gSWxsZWdhbEFyZ3VtZW50RXhjZXB0aW9uIGlmIHRoZSBu
dW1iZXIgb2YgZGltZW5zaW9ucyBpcworCSAqICAgIG5lZ2F0aXZlCiAJICogQHNpbmNlIDIuMQog
CSAqLwogCXB1YmxpYyB2b2lkIHNldEV4dHJhRGltZW5zaW9ucyhpbnQgZGltZW5zaW9ucykgewor
CQlzdXBwb3J0ZWRPbmx5SW4yXzNfNCgpOwogCQlpZiAoZGltZW5zaW9ucyA8IDApIHsKIAkJCXRo
cm93IG5ldyBJbGxlZ2FsQXJndW1lbnRFeGNlcHRpb24oKTsKIAkJfQogCQlwcmVWYWx1ZUNoYW5n
ZShFWFRSQV9ESU1FTlNJT05TX1BST1BFUlRZKTsKIAkJdGhpcy5leHRyYUFycmF5RGltZW5zaW9u
cyA9IGRpbWVuc2lvbnM7CiAJCXBvc3RWYWx1ZUNoYW5nZShFWFRSQV9ESU1FTlNJT05TX1BST1BF
UlRZKTsKKwl9CisKKwkvKioKKwkgKiBSZXR1cm5zIHRoZSBsaXZlIG9yZGVyZWQgbGlzdCBvZiBl
eHRyYSBkaW1lbnNpb25zIChKTFM4IEFQSSBvbmx5KS4KKwkgKgorCSAqIEByZXR1cm4gdGhlIGxp
dmUgbGlzdCBvZiBleHRyYSBkaW1lbnNpb25zIChlbGVtZW50IHR5cGU6IHtAbGluayBEaW1lbnNp
b25UeXBlfVtdKQorCSAqIEBzaW5jZSAzLjkKKwkgKi8KKwlwdWJsaWMgTGlzdCBnZXRFeHRyYURp
bWVuc2lvblR5cGVzKCkgeworCQl1bnN1cHBvcnRlZEluMl8zXzQoKTsKKwkJcmV0dXJuIHRoaXMu
ZXh0cmFEaW1lbnNpb25UeXBlczsKIAl9CiAKIAkvKiAob21pdCBqYXZhZG9jIGZvciB0aGlzIG1l
dGhvZCkKQEAgLTY5Myw3ICs3NDAsNyBAQAogCSAqLwogCWludCBtZW1TaXplKCkgewogCQkvLyB0
cmVhdCBPcGVyYXRvciBhcyBmcmVlCi0JCXJldHVybiBCQVNFX05PREVfU0laRSArIDggKiA0Owor
CQlyZXR1cm4gQkFTRV9OT0RFX1NJWkUgKyA5ICogNDsKIAl9CiAKIAkvKiAob21pdCBqYXZhZG9j
IGZvciB0aGlzIG1ldGhvZCkKQEAgLTcwNCw2ICs3NTEsNyBAQAogCQkJbWVtU2l6ZSgpCiAJCQkr
ICh0aGlzLnZhcmFyZ3NBbm5vdGF0aW9ucyA9PSBudWxsID8gMCA6IHRoaXMudmFyYXJnc0Fubm90
YXRpb25zLmxpc3RTaXplKCkpCiAJCQkrICh0aGlzLm1vZGlmaWVycyA9PSBudWxsID8gMCA6IHRo
aXMubW9kaWZpZXJzLmxpc3RTaXplKCkpCisJCQkrICh0aGlzLmV4dHJhRGltZW5zaW9uVHlwZXMg
PT0gbnVsbCA/IDAgOiB0aGlzLmV4dHJhRGltZW5zaW9uVHlwZXMubGlzdFNpemUoKSkKIAkJCSsg
KHRoaXMudHlwZSA9PSBudWxsID8gMCA6IGdldFR5cGUoKS50cmVlU2l6ZSgpKQogCQkJKyAodGhp
cy52YXJpYWJsZU5hbWUgPT0gbnVsbCA/IDAgOiBnZXROYW1lKCkudHJlZVNpemUoKSkKIAkJCSsg
KHRoaXMub3B0aW9uYWxJbml0aWFsaXplciA9PSBudWxsID8gMCA6IGdldEluaXRpYWxpemVyKCku
dHJlZVNpemUoKSk7CmRpZmYgLS1naXQgYS9vcmcuZWNsaXBzZS5qZHQuY29yZS9kb20vb3JnL2Vj
bGlwc2UvamR0L2NvcmUvZG9tL1R5cGUuamF2YSBiL29yZy5lY2xpcHNlLmpkdC5jb3JlL2RvbS9v
cmcvZWNsaXBzZS9qZHQvY29yZS9kb20vVHlwZS5qYXZhCmluZGV4IGU5ODYwZWUuLjY3NmMwZDMg
MTAwNjQ0Ci0tLSBhL29yZy5lY2xpcHNlLmpkdC5jb3JlL2RvbS9vcmcvZWNsaXBzZS9qZHQvY29y
ZS9kb20vVHlwZS5qYXZhCisrKyBiL29yZy5lY2xpcHNlLmpkdC5jb3JlL2RvbS9vcmcvZWNsaXBz
ZS9qZHQvY29yZS9kb20vVHlwZS5qYXZhCkBAIC0zNSw2ICszNSw3IEBACiAgKiAgICAgICBTaW1w
bGVUeXBlCiAgKiAgICAgICBRdWFsaWZpZWRUeXBlCiAgKiAgICAgICBXaWxkY2FyZFR5cGUKKyAq
ICAgICAgIERpbWVuc2lvblR5cGUKICAqICAgIFBhcmFtZXRlcml6ZWRUeXBlCiAgKiAgICBVbmlv
blR5cGUgIAogICogICAgCkBAIC01Nyw3ICs1OCw5IEBACiAgKiBRdWFsaWZpZWRUeXBlOgogICog
ICAgVHlwZSA8Yj4uPC9iPntBbm5vdGF0aW9ufSBTaW1wbGVOYW1lCiAgKiBXaWxkY2FyZFR5cGU6
Ci0gKiAgICA8Yj57QW5ub3RhdGlvbn0gPzwvYj4gWyAoIDxiPmV4dGVuZHM8L2I+IHwgPGI+c3Vw
ZXI8L2I+KSBUeXBlIF0KKyAqICAgIHtBbm5vdGF0aW9ufSA/IFsgKCA8Yj5leHRlbmRzPC9iPiB8
IDxiPnN1cGVyPC9iPikgVHlwZSBdCisgKiBEaW1lbnNpb25UeXBlOgorICogICAge0Fubm90YXRp
b259IDxiPls8L2I+IHtFeHByZXNzaW9ufSA8Yj5dPC9iPgogICogPC9wcmU+CiAgKiA8L3A+CiAg
KgpkaWZmIC0tZ2l0IGEvb3JnLmVjbGlwc2UuamR0LmNvcmUvZG9tL29yZy9lY2xpcHNlL2pkdC9j
b3JlL2RvbS9WYXJpYWJsZURlY2xhcmF0aW9uRnJhZ21lbnQuamF2YSBiL29yZy5lY2xpcHNlLmpk
dC5jb3JlL2RvbS9vcmcvZWNsaXBzZS9qZHQvY29yZS9kb20vVmFyaWFibGVEZWNsYXJhdGlvbkZy
YWdtZW50LmphdmEKaW5kZXggZTlkZTdjOC4uZTM4MWQxNCAxMDA2NDQKLS0tIGEvb3JnLmVjbGlw
c2UuamR0LmNvcmUvZG9tL29yZy9lY2xpcHNlL2pkdC9jb3JlL2RvbS9WYXJpYWJsZURlY2xhcmF0
aW9uRnJhZ21lbnQuamF2YQorKysgYi9vcmcuZWNsaXBzZS5qZHQuY29yZS9kb20vb3JnL2VjbGlw
c2UvamR0L2NvcmUvZG9tL1ZhcmlhYmxlRGVjbGFyYXRpb25GcmFnbWVudC5qYXZhCkBAIC0zOSwx
MSArMzksMTkgQEAKIAkJbmV3IENoaWxkUHJvcGVydHlEZXNjcmlwdG9yKFZhcmlhYmxlRGVjbGFy
YXRpb25GcmFnbWVudC5jbGFzcywgIm5hbWUiLCBTaW1wbGVOYW1lLmNsYXNzLCBNQU5EQVRPUlks
IE5PX0NZQ0xFX1JJU0spOyAvLyROT04tTkxTLTEkCiAKIAkvKioKLQkgKiBUaGUgImV4dHJhRGlt
ZW5zaW9ucyIgc3RydWN0dXJhbCBwcm9wZXJ0eSBvZiB0aGlzIG5vZGUgdHlwZSAodHlwZToge0Bs
aW5rIEludGVnZXJ9KS4KKwkgKiBUaGUgImV4dHJhRGltZW5zaW9ucyIgc3RydWN0dXJhbCBwcm9w
ZXJ0eSBvZiB0aGlzIG5vZGUgdHlwZSAodHlwZToge0BsaW5rIEludGVnZXJ9KS4gVGhpcyBwcm9w
ZXJ0eSBpcyBzdXBwb3J0ZWQKKwkgKiBvbmx5IGluIEpMUzQgb3IgYmVsb3cuIEZvciBKTFM4IGFu
ZCBhYm92ZSwgdXNlIDxjb2RlPkVYVFJBX0RJTUVOU0lPTl9UWVBFU19QUk9QRVJUWTwvY29kZT4u
CiAJICogQHNpbmNlIDMuMAogCSAqLwogCXB1YmxpYyBzdGF0aWMgZmluYWwgU2ltcGxlUHJvcGVy
dHlEZXNjcmlwdG9yIEVYVFJBX0RJTUVOU0lPTlNfUFJPUEVSVFkgPQogCQluZXcgU2ltcGxlUHJv
cGVydHlEZXNjcmlwdG9yKFZhcmlhYmxlRGVjbGFyYXRpb25GcmFnbWVudC5jbGFzcywgImV4dHJh
RGltZW5zaW9ucyIsIGludC5jbGFzcywgTUFOREFUT1JZKTsgLy8kTk9OLU5MUy0xJAorCisJLyoq
CisJICogVGhlICJleHRyYURpbWVuc2lvblR5cGVzIiBzdHJ1Y3R1cmFsIHByb3BlcnR5IG9mIHRo
aXMgbm9kZSB0eXBlIChjaGlsZCB0eXBlOiB7QGxpbmsgRGltZW5zaW9uVHlwZX0pIChBZGRlZCBp
biBKTFM4IEFQSSkuCisJICogQHNpbmNlIDMuOQorCSAqLworCXB1YmxpYyBzdGF0aWMgZmluYWwg
Q2hpbGRMaXN0UHJvcGVydHlEZXNjcmlwdG9yIEVYVFJBX0RJTUVOU0lPTl9UWVBFU19QUk9QRVJU
WSA9CisJCQluZXcgQ2hpbGRMaXN0UHJvcGVydHlEZXNjcmlwdG9yKFZhcmlhYmxlRGVjbGFyYXRp
b25GcmFnbWVudC5jbGFzcywgImV4dHJhRGltZW5zaW9uVHlwZXMiLCBEaW1lbnNpb25UeXBlLmNs
YXNzLCBOT19DWUNMRV9SSVNLKTsgLy8kTk9OLU5MUy0xJAogCiAJLyoqCiAJICogVGhlICJpbml0
aWFsaXplciIgc3RydWN0dXJhbCBwcm9wZXJ0eSBvZiB0aGlzIG5vZGUgdHlwZSAoY2hpbGQgdHlw
ZToge0BsaW5rIEV4cHJlc3Npb259KS4KQEAgLTYwLDYgKzY4LDE0IEBACiAJICovCiAJcHJpdmF0
ZSBzdGF0aWMgZmluYWwgTGlzdCBQUk9QRVJUWV9ERVNDUklQVE9SUzsKIAorCS8qKgorCSAqIEEg
bGlzdCBvZiBwcm9wZXJ0eSBkZXNjcmlwdG9ycyAoZWxlbWVudCB0eXBlOgorCSAqIHtAbGluayBT
dHJ1Y3R1cmFsUHJvcGVydHlEZXNjcmlwdG9yfSksCisJICogb3IgbnVsbCBpZiB1bmluaXRpYWxp
emVkLgorCSAqIEBzaW5jZSAzLjkKKwkgKi8KKwlwcml2YXRlIHN0YXRpYyBmaW5hbCBMaXN0IFBS
T1BFUlRZX0RFU0NSSVBUT1JTXzhfMDsKKwogCXN0YXRpYyB7CiAJCUxpc3QgcHJvcGVydHlMaXN0
ID0gbmV3IEFycmF5TGlzdCg0KTsKIAkJY3JlYXRlUHJvcGVydHlMaXN0KFZhcmlhYmxlRGVjbGFy
YXRpb25GcmFnbWVudC5jbGFzcywgcHJvcGVydHlMaXN0KTsKQEAgLTY3LDYgKzgzLDEzIEBACiAJ
CWFkZFByb3BlcnR5KEVYVFJBX0RJTUVOU0lPTlNfUFJPUEVSVFksIHByb3BlcnR5TGlzdCk7CiAJ
CWFkZFByb3BlcnR5KElOSVRJQUxJWkVSX1BST1BFUlRZLCBwcm9wZXJ0eUxpc3QpOwogCQlQUk9Q
RVJUWV9ERVNDUklQVE9SUyA9IHJlYXBQcm9wZXJ0eUxpc3QocHJvcGVydHlMaXN0KTsKKworCQlw
cm9wZXJ0eUxpc3QgPSBuZXcgQXJyYXlMaXN0KDQpOworCQljcmVhdGVQcm9wZXJ0eUxpc3QoVmFy
aWFibGVEZWNsYXJhdGlvbkZyYWdtZW50LmNsYXNzLCBwcm9wZXJ0eUxpc3QpOworCQlhZGRQcm9w
ZXJ0eShOQU1FX1BST1BFUlRZLCBwcm9wZXJ0eUxpc3QpOworCQlhZGRQcm9wZXJ0eShFWFRSQV9E
SU1FTlNJT05fVFlQRVNfUFJPUEVSVFksIHByb3BlcnR5TGlzdCk7CisJCWFkZFByb3BlcnR5KElO
SVRJQUxJWkVSX1BST1BFUlRZLCBwcm9wZXJ0eUxpc3QpOworCQlQUk9QRVJUWV9ERVNDUklQVE9S
U184XzAgPSByZWFwUHJvcGVydHlMaXN0KHByb3BlcnR5TGlzdCk7CiAJfQogCiAJLyoqCkBAIC04
MCw3ICsxMDMsMTEgQEAKIAkgKiBAc2luY2UgMy4wCiAJICovCiAJcHVibGljIHN0YXRpYyBMaXN0
IHByb3BlcnR5RGVzY3JpcHRvcnMoaW50IGFwaUxldmVsKSB7Ci0JCXJldHVybiBQUk9QRVJUWV9E
RVNDUklQVE9SUzsKKwkJaWYgKGFwaUxldmVsID49IEFTVC5KTFM4KSB7CisJCQlyZXR1cm4gUFJP
UEVSVFlfREVTQ1JJUFRPUlNfOF8wOworCQl9IGVsc2UgeworCQkJcmV0dXJuIFBST1BFUlRZX0RF
U0NSSVBUT1JTOworCQl9CiAJfQogCiAJLyoqCkBAIC05NCw2ICsxMjEsMTMgQEAKIAkgKiBkZWZh
dWx0cyB0byAwLgogCSAqLwogCXByaXZhdGUgaW50IGV4dHJhQXJyYXlEaW1lbnNpb25zID0gMDsK
KworCS8qKgorCSAqIFRoZSBleHRyYSBkaW1lbnNpb24gdHlwZXMgdGhpcyBub2RlIGhhcyB3aXRo
IGFubm90YXRpb25zIGlmIGFueS4KKwkgKgorCSAqIEBzaW5jZSAzLjkKKwkgKi8KKwlwcm90ZWN0
ZWQgQVNUTm9kZS5Ob2RlTGlzdCBleHRyYURpbWVuc2lvblR5cGVzID0gbnVsbDsKIAogCS8qKgog
CSAqIFRoZSBpbml0aWFsaXplciBleHByZXNzaW9uLCBvciA8Y29kZT5udWxsPC9jb2RlPiBpZiBu
b25lOwpAQCAtMTEzLDYgKzE0Nyw5IEBACiAJICovCiAJVmFyaWFibGVEZWNsYXJhdGlvbkZyYWdt
ZW50KEFTVCBhc3QpIHsKIAkJc3VwZXIoYXN0KTsKKwkJaWYgKGFzdC5hcGlMZXZlbCA+PSBBU1Qu
SkxTOCkgeworCQkJdGhpcy5leHRyYURpbWVuc2lvblR5cGVzID0gbmV3IEFTVE5vZGUuTm9kZUxp
c3QoRVhUUkFfRElNRU5TSU9OX1RZUEVTX1BST1BFUlRZKTsKKwkJfQogCX0KIAogCS8qIChvbWl0
IGphdmFkb2MgZm9yIHRoaXMgbWV0aG9kKQpAQCAtMTg5LDYgKzIyNiwxNyBAQAogCS8qIChvbWl0
IGphdmFkb2MgZm9yIHRoaXMgbWV0aG9kKQogCSAqIE1ldGhvZCBkZWNsYXJlZCBvbiBBU1ROb2Rl
LgogCSAqLworCWZpbmFsIExpc3QgaW50ZXJuYWxHZXRDaGlsZExpc3RQcm9wZXJ0eShDaGlsZExp
c3RQcm9wZXJ0eURlc2NyaXB0b3IgcHJvcGVydHkpIHsKKwkJaWYgKHByb3BlcnR5ID09IEVYVFJB
X0RJTUVOU0lPTl9UWVBFU19QUk9QRVJUWSkgeworCQkJcmV0dXJuIHRoaXMuZXh0cmFEaW1lbnNp
b25UeXBlczsKKwkJfQorCQkvLyBhbGxvdyBkZWZhdWx0IGltcGxlbWVudGF0aW9uIHRvIGZsYWcg
dGhlIGVycm9yCisJCXJldHVybiBzdXBlci5pbnRlcm5hbEdldENoaWxkTGlzdFByb3BlcnR5KHBy
b3BlcnR5KTsKKwl9CisKKwkvKiAob21pdCBqYXZhZG9jIGZvciB0aGlzIG1ldGhvZCkKKwkgKiBN
ZXRob2QgZGVjbGFyZWQgb24gQVNUTm9kZS4KKwkgKi8KIAlmaW5hbCBpbnQgZ2V0Tm9kZVR5cGUw
KCkgewogCQlyZXR1cm4gVkFSSUFCTEVfREVDTEFSQVRJT05fRlJBR01FTlQ7CiAJfQpAQCAtMjAw
LDcgKzI0OCwxMiBAQAogCQlWYXJpYWJsZURlY2xhcmF0aW9uRnJhZ21lbnQgcmVzdWx0ID0gbmV3
IFZhcmlhYmxlRGVjbGFyYXRpb25GcmFnbWVudCh0YXJnZXQpOwogCQlyZXN1bHQuc2V0U291cmNl
UmFuZ2UoZ2V0U3RhcnRQb3NpdGlvbigpLCBnZXRMZW5ndGgoKSk7CiAJCXJlc3VsdC5zZXROYW1l
KChTaW1wbGVOYW1lKSBnZXROYW1lKCkuY2xvbmUodGFyZ2V0KSk7Ci0JCXJlc3VsdC5zZXRFeHRy
YURpbWVuc2lvbnMoZ2V0RXh0cmFEaW1lbnNpb25zKCkpOworCQlpZiAodGhpcy5hc3QuYXBpTGV2
ZWwgPj0gQVNULkpMUzgpIHsKKwkJCXJlc3VsdC5leHRyYURpbWVuc2lvblR5cGVzLmFkZEFsbCgK
KwkJCQkJQVNUTm9kZS5jb3B5U3VidHJlZXModGFyZ2V0LCB0aGlzLmV4dHJhRGltZW5zaW9uVHlw
ZXMpKTsKKwkJfSBlbHNlIHsKKwkJCXJlc3VsdC5zZXRFeHRyYURpbWVuc2lvbnMoZ2V0RXh0cmFE
aW1lbnNpb25zKCkpOworCQl9CiAJCXJlc3VsdC5zZXRJbml0aWFsaXplcigKIAkJCShFeHByZXNz
aW9uKSBBU1ROb2RlLmNvcHlTdWJ0cmVlKHRhcmdldCwgZ2V0SW5pdGlhbGl6ZXIoKSkpOwogCQly
ZXR1cm4gcmVzdWx0OwpAQCAtMjIzLDYgKzI3NiwxMCBAQAogCQkJLy8gdmlzaXQgY2hpbGRyZW4g
aW4gbm9ybWFsIGxlZnQgdG8gcmlnaHQgcmVhZGluZyBvcmRlcgogCQkJYWNjZXB0Q2hpbGQodmlz
aXRvciwgZ2V0TmFtZSgpKTsKIAkJCWFjY2VwdENoaWxkKHZpc2l0b3IsIGdldEluaXRpYWxpemVy
KCkpOworCisJCQlpZiAodGhpcy5hc3QuYXBpTGV2ZWwgPj0gQVNULkpMUzgpIHsKKwkJCQlhY2Nl
cHRDaGlsZHJlbih2aXNpdG9yLCB0aGlzLmV4dHJhRGltZW5zaW9uVHlwZXMpOworCQkJfQogCQl9
CiAJCXZpc2l0b3IuZW5kVmlzaXQodGhpcyk7CiAJfQpAQCAtMjU5LDcgKzMxNiw4IEBACiAKIAkv
KioKIAkgKiBSZXR1cm5zIHRoZSBudW1iZXIgb2YgZXh0cmEgYXJyYXkgZGltZW5zaW9ucyB0aGlz
IHZhcmlhYmxlIGhhcyBvdmVyCi0JICogYW5kIGFib3ZlIHRoZSB0eXBlIHNwZWNpZmllZCBpbiB0
aGUgZW5jbG9zaW5nIGRlY2xhcmF0aW9uLgorCSAqIGFuZCBhYm92ZSB0aGUgdHlwZSBzcGVjaWZp
ZWQgaW4gdGhlIGVuY2xvc2luZyBkZWNsYXJhdGlvbiAoTm90IHN1cHBvcnRlZCAKKwkgKiBpbiBK
TFM4IGFuZCBhYm92ZSkuCiAJICogPHA+CiAJICogRm9yIGV4YW1wbGUsIGluIHRoZSBBU1QgZm9y
IDxjb2RlPmludFtdIGksIGpbXSwga1tdW108L2NvZGU+IHRoZQogCSAqIHZhcmlhYmxlIGRlY2xh
cmF0aW9uIGZyYWdtZW50cyBmb3IgdGhlIHZhcmlhYmxlcyA8Y29kZT5pPC9jb2RlPiwKQEAgLTI3
MiwxMiArMzMwLDE0IEBACiAJICogQHNpbmNlIDIuMAogCSAqLwogCXB1YmxpYyBpbnQgZ2V0RXh0
cmFEaW1lbnNpb25zKCkgeworCQlzdXBwb3J0ZWRPbmx5SW4yXzNfNCgpOwogCQlyZXR1cm4gdGhp
cy5leHRyYUFycmF5RGltZW5zaW9uczsKIAl9CiAKIAkvKioKIAkgKiBTZXRzIHRoZSBudW1iZXIg
b2YgZXh0cmEgYXJyYXkgZGltZW5zaW9ucyB0aGlzIHZhcmlhYmxlIGhhcyBvdmVyCi0JICogYW5k
IGFib3ZlIHRoZSB0eXBlIHNwZWNpZmllZCBpbiB0aGUgZW5jbG9zaW5nIGRlY2xhcmF0aW9uLgor
CSAqIGFuZCBhYm92ZSB0aGUgdHlwZSBzcGVjaWZpZWQgaW4gdGhlIGVuY2xvc2luZyBkZWNsYXJh
dGlvbiAoTm90IHN1cHBvcnRlZCAKKwkgKiBpbiBKTFM4IGFuZCBhYm92ZSkuCiAJICogPHA+CiAJ
ICogRm9yIGV4YW1wbGUsIGluIHRoZSBBU1QgZm9yIDxjb2RlPmludFtdIGksIGpbXSwga1tdW108
L2NvZGU+IHRoZQogCSAqIHZhcmlhYmxlIGRlY2xhcmF0aW9uIGZyYWdtZW50cyBmb3IgdGhlIHZh
cmlhYmxlcyA8Y29kZT5pPC9jb2RlPiwKQEAgLTI4OSwxMiArMzQ5LDI0IEBACiAJICogQHNpbmNl
IDIuMAogCSAqLwogCXB1YmxpYyB2b2lkIHNldEV4dHJhRGltZW5zaW9ucyhpbnQgZGltZW5zaW9u
cykgeworCQlzdXBwb3J0ZWRPbmx5SW4yXzNfNCgpOwogCQlpZiAoZGltZW5zaW9ucyA8IDApIHsK
IAkJCXRocm93IG5ldyBJbGxlZ2FsQXJndW1lbnRFeGNlcHRpb24oKTsKIAkJfQogCQlwcmVWYWx1
ZUNoYW5nZShFWFRSQV9ESU1FTlNJT05TX1BST1BFUlRZKTsKIAkJdGhpcy5leHRyYUFycmF5RGlt
ZW5zaW9ucyA9IGRpbWVuc2lvbnM7CiAJCXBvc3RWYWx1ZUNoYW5nZShFWFRSQV9ESU1FTlNJT05T
X1BST1BFUlRZKTsKKwl9CisKKwkvKioKKwkgKiBSZXR1cm5zIHRoZSBsaXZlIG9yZGVyZWQgbGlz
dCBvZiBleHRyYSBkaW1lbnNpb25zIHdpdGggYW5ub3RhdGlvbnMgaWYgYW55IChKTFM4IEFQSSBv
bmx5KS4KKwkgKgorCSAqIEByZXR1cm4gdGhlIGxpdmUgbGlzdCBvZiBleHRyYSBkaW1lbnNpb25z
IHdpdGggYW5ub3RhdGlvbnMgaWYgYW55IChlbGVtZW50IHR5cGU6IHtAbGluayBEaW1lbnNpb25U
eXBlfVtdKQorCSAqIEBzaW5jZSAzLjkKKwkgKi8KKwlwdWJsaWMgTGlzdCBnZXRFeHRyYURpbWVu
c2lvblR5cGVzKCkgeworCQl1bnN1cHBvcnRlZEluMl8zXzQoKTsKKwkJcmV0dXJuIHRoaXMuZXh0
cmFEaW1lbnNpb25UeXBlczsKIAl9CiAKIAkvKiAob21pdCBqYXZhZG9jIGZvciB0aGlzIG1ldGhv
ZCkKQEAgLTMxOSw3ICszOTEsNyBAQAogCSAqLwogCWludCBtZW1TaXplKCkgewogCQkvLyB0cmVh
dCBPcGVyYXRvciBhcyBmcmVlCi0JCXJldHVybiBCQVNFX05PREVfU0laRSArIDMgKiA0OworCQly
ZXR1cm4gQkFTRV9OT0RFX1NJWkUgKyA0ICogNDsKIAl9CiAKIAkvKiAob21pdCBqYXZhZG9jIGZv
ciB0aGlzIG1ldGhvZCkKQEAgLTMyOSw2ICs0MDEsNyBAQAogCQlyZXR1cm4KIAkJCW1lbVNpemUo
KQogCQkJKyAodGhpcy52YXJpYWJsZU5hbWUgPT0gbnVsbCA/IDAgOiBnZXROYW1lKCkudHJlZVNp
emUoKSkKLQkJCSsgKHRoaXMub3B0aW9uYWxJbml0aWFsaXplciA9PSBudWxsID8gMCA6IGdldElu
aXRpYWxpemVyKCkudHJlZVNpemUoKSk7CisJCQkrICh0aGlzLm9wdGlvbmFsSW5pdGlhbGl6ZXIg
PT0gbnVsbCA/IDAgOiBnZXRJbml0aWFsaXplcigpLnRyZWVTaXplKCkpCisJCQkrICh0aGlzLmV4
dHJhRGltZW5zaW9uVHlwZXMgPT0gbnVsbCA/IDAgOiBnZXRFeHRyYURpbWVuc2lvblR5cGVzKCku
c2l6ZSgpKTsKIAl9CiB9CmRpZmYgLS1naXQgYS9vcmcuZWNsaXBzZS5qZHQuY29yZS9kb20vb3Jn
L2VjbGlwc2UvamR0L2ludGVybmFsL2NvcmUvZG9tL05haXZlQVNURmxhdHRlbmVyLmphdmEgYi9v
cmcuZWNsaXBzZS5qZHQuY29yZS9kb20vb3JnL2VjbGlwc2UvamR0L2ludGVybmFsL2NvcmUvZG9t
L05haXZlQVNURmxhdHRlbmVyLmphdmEKaW5kZXggZWNjZWRhOS4uMDc2MTA5YiAxMDA2NDQKLS0t
IGEvb3JnLmVjbGlwc2UuamR0LmNvcmUvZG9tL29yZy9lY2xpcHNlL2pkdC9pbnRlcm5hbC9jb3Jl
L2RvbS9OYWl2ZUFTVEZsYXR0ZW5lci5qYXZhCisrKyBiL29yZy5lY2xpcHNlLmpkdC5jb3JlL2Rv
bS9vcmcvZWNsaXBzZS9qZHQvaW50ZXJuYWwvY29yZS9kb20vTmFpdmVBU1RGbGF0dGVuZXIuamF2
YQpAQCAtNDUsNiArNDUsNyBAQAogaW1wb3J0IG9yZy5lY2xpcHNlLmpkdC5jb3JlLmRvbS5Db25k
aXRpb25hbEV4cHJlc3Npb247CiBpbXBvcnQgb3JnLmVjbGlwc2UuamR0LmNvcmUuZG9tLkNvbnN0
cnVjdG9ySW52b2NhdGlvbjsKIGltcG9ydCBvcmcuZWNsaXBzZS5qZHQuY29yZS5kb20uQ29udGlu
dWVTdGF0ZW1lbnQ7CitpbXBvcnQgb3JnLmVjbGlwc2UuamR0LmNvcmUuZG9tLkRpbWVuc2lvblR5
cGU7CiBpbXBvcnQgb3JnLmVjbGlwc2UuamR0LmNvcmUuZG9tLlVuaW9uVHlwZTsKIGltcG9ydCBv
cmcuZWNsaXBzZS5qZHQuY29yZS5kb20uRG9TdGF0ZW1lbnQ7CiBpbXBvcnQgb3JnLmVjbGlwc2Uu
amR0LmNvcmUuZG9tLkVtcHR5U3RhdGVtZW50OwpAQCAtNDEzLDYgKzQxNCwxNiBAQAogCQlub2Rl
LmdldENvbXBvbmVudFR5cGUoKS5hY2NlcHQodGhpcyk7CiAJCXZpc2l0VHlwZUFubm90YXRpb25z
KG5vZGUpOwogCQl0aGlzLmJ1ZmZlci5hcHBlbmQoIltdIik7Ly8kTk9OLU5MUy0xJAorCQlyZXR1
cm4gZmFsc2U7CisJfQorCisJcHVibGljIGJvb2xlYW4gdmlzaXQoRGltZW5zaW9uVHlwZSBub2Rl
KSB7CisJCXZpc2l0VHlwZUFubm90YXRpb25zKG5vZGUpOworCQl0aGlzLmJ1ZmZlci5hcHBlbmQo
IlsiKTsgLy8kTk9OLU5MUy0xJAorCQlpZiAobm9kZS5leHByZXNzaW9uKCkgIT0gbnVsbCkgewor
CQkJbm9kZS5leHByZXNzaW9uKCkuYWNjZXB0KHRoaXMpOworCQl9CisJCXRoaXMuYnVmZmVyLmFw
cGVuZCgiXSIpOyAvLyROT04tTkxTLTEkCiAJCXJldHVybiBmYWxzZTsKIAl9CiAKQEAgLTEwMzcs
OCArMTA0OCwxNSBAQAogCQkJfQogCQl9CiAJCXRoaXMuYnVmZmVyLmFwcGVuZCgiKSIpOy8vJE5P
Ti1OTFMtMSQKLQkJZm9yIChpbnQgaSA9IDA7IGkgPCBub2RlLmdldEV4dHJhRGltZW5zaW9ucygp
OyBpKyspIHsKLQkJCXRoaXMuYnVmZmVyLmFwcGVuZCgiW10iKTsgLy8kTk9OLU5MUy0xJAorCQlp
ZiAobm9kZS5nZXRBU1QoKS5hcGlMZXZlbCgpID49IEFTVC5KTFM4KSB7CisJCQlMaXN0IGRpbWVu
c2lvbnMgPSBub2RlLmdldEV4dHJhRGltZW5zaW9uVHlwZXMoKTsKKwkJCWZvciAoaW50IGkgPSAw
OyBpIDwgZGltZW5zaW9ucy5zaXplKCk7IGkrKykgeworCQkJCXZpc2l0KChEaW1lbnNpb25UeXBl
KSBkaW1lbnNpb25zLmdldChpKSk7CisJCQl9CisJCX0gZWxzZSB7CisJCQlmb3IgKGludCBpID0g
MDsgaSA8IG5vZGUuZ2V0RXh0cmFEaW1lbnNpb25zKCk7IGkrKykgeworCQkJCXRoaXMuYnVmZmVy
LmFwcGVuZCgiW10iKTsgLy8kTk9OLU5MUy0xJAorCQkJfQogCQl9CiAJCWlmIChub2RlLmdldEFT
VCgpLmFwaUxldmVsKCkgPCBBU1QuSkxTOCkgewogCQkJaWYgKCFub2RlLnRocm93bkV4Y2VwdGlv
bnMoKS5pc0VtcHR5KCkpIHsKQEAgLTEzNzMsOCArMTM5MSwxNSBAQAogCQl9CiAJCXRoaXMuYnVm
ZmVyLmFwcGVuZCgiICIpOy8vJE5PTi1OTFMtMSQKIAkJbm9kZS5nZXROYW1lKCkuYWNjZXB0KHRo
aXMpOwotCQlmb3IgKGludCBpID0gMDsgaSA8IG5vZGUuZ2V0RXh0cmFEaW1lbnNpb25zKCk7IGkr
KykgewotCQkJdGhpcy5idWZmZXIuYXBwZW5kKCJbXSIpOyAvLyROT04tTkxTLTEkCisJCWlmIChu
b2RlLmdldEFTVCgpLmFwaUxldmVsKCkgPj0gQVNULkpMUzgpIHsKKwkJCUxpc3QgZGltZW5zaW9u
cyA9IG5vZGUuZ2V0RXh0cmFEaW1lbnNpb25UeXBlcygpOworCQkJZm9yIChpbnQgaSA9IDA7IGkg
PCBkaW1lbnNpb25zLnNpemUoKTsgaSsrKSB7CisJCQkJdmlzaXQoKERpbWVuc2lvblR5cGUpIGRp
bWVuc2lvbnMuZ2V0KGkpKTsKKwkJCX0KKwkJfSBlbHNlIHsKKwkJCWZvciAoaW50IGkgPSAwOyBp
IDwgbm9kZS5nZXRFeHRyYURpbWVuc2lvbnMoKTsgaSsrKSB7CisJCQkJdGhpcy5idWZmZXIuYXBw
ZW5kKCJbXSIpOyAvLyROT04tTkxTLTEkCisJCQl9CiAJCX0KIAkJaWYgKG5vZGUuZ2V0SW5pdGlh
bGl6ZXIoKSAhPSBudWxsKSB7CiAJCQl0aGlzLmJ1ZmZlci5hcHBlbmQoIj0iKTsvLyROT04tTkxT
LTEkCkBAIC0xNzk0LDggKzE4MTksMTUgQEAKIAkgKi8KIAlwdWJsaWMgYm9vbGVhbiB2aXNpdChW
YXJpYWJsZURlY2xhcmF0aW9uRnJhZ21lbnQgbm9kZSkgewogCQlub2RlLmdldE5hbWUoKS5hY2Nl
cHQodGhpcyk7Ci0JCWZvciAoaW50IGkgPSAwOyBpIDwgbm9kZS5nZXRFeHRyYURpbWVuc2lvbnMo
KTsgaSsrKSB7Ci0JCQl0aGlzLmJ1ZmZlci5hcHBlbmQoIltdIik7Ly8kTk9OLU5MUy0xJAorCQlp
ZiAobm9kZS5nZXRBU1QoKS5hcGlMZXZlbCgpID49IEFTVC5KTFM4KSB7CisJCQlMaXN0IGRpbWVu
c2lvbnMgPSBub2RlLmdldEV4dHJhRGltZW5zaW9uVHlwZXMoKTsKKwkJCWZvciAoaW50IGkgPSAw
OyBpIDwgZGltZW5zaW9ucy5zaXplKCk7IGkrKykgeworCQkJCXZpc2l0KChEaW1lbnNpb25UeXBl
KSBkaW1lbnNpb25zLmdldChpKSk7CisJCQl9CisJCX0gZWxzZSB7CisJCQlmb3IgKGludCBpID0g
MDsgaSA8IG5vZGUuZ2V0RXh0cmFEaW1lbnNpb25zKCk7IGkrKykgeworCQkJCXRoaXMuYnVmZmVy
LmFwcGVuZCgiW10iKTsvLyROT04tTkxTLTEkCisJCQl9CiAJCX0KIAkJaWYgKG5vZGUuZ2V0SW5p
dGlhbGl6ZXIoKSAhPSBudWxsKSB7CiAJCQl0aGlzLmJ1ZmZlci5hcHBlbmQoIj0iKTsvLyROT04t
TkxTLTEk
</data>

          </attachment>
          <attachment
              isobsolete="1"
              ispatch="1"
              isprivate="0"
          >
            <attachid>226179</attachid>
            <date>2013-01-28 01:34:00 -0500</date>
            <delta_ts>2013-01-29 07:09:09 -0500</delta_ts>
            <desc>Updated patch</desc>
            <filename>Fix-for-bug-391895.patch</filename>
            <type>text/plain</type>
            <size>75450</size>
            <attacher name="Jay Arthanareeswaran">jarthana</attacher>
            
              <data encoding="base64">ZGlmZiAtLWdpdCBhL29yZy5lY2xpcHNlLmpkdC5jb3JlLnRlc3RzLm1vZGVsL3NyYy9vcmcvZWNs
aXBzZS9qZHQvY29yZS90ZXN0cy9kb20vQVNUQ29udmVydGVyMTVKTFM4VGVzdC5qYXZhIGIvb3Jn
LmVjbGlwc2UuamR0LmNvcmUudGVzdHMubW9kZWwvc3JjL29yZy9lY2xpcHNlL2pkdC9jb3JlL3Rl
c3RzL2RvbS9BU1RDb252ZXJ0ZXIxNUpMUzhUZXN0LmphdmEKaW5kZXggZjRiMTUyOC4uMWQ2NjVj
OCAxMDA2NDQKLS0tIGEvb3JnLmVjbGlwc2UuamR0LmNvcmUudGVzdHMubW9kZWwvc3JjL29yZy9l
Y2xpcHNlL2pkdC9jb3JlL3Rlc3RzL2RvbS9BU1RDb252ZXJ0ZXIxNUpMUzhUZXN0LmphdmEKKysr
IGIvb3JnLmVjbGlwc2UuamR0LmNvcmUudGVzdHMubW9kZWwvc3JjL29yZy9lY2xpcHNlL2pkdC9j
b3JlL3Rlc3RzL2RvbS9BU1RDb252ZXJ0ZXIxNUpMUzhUZXN0LmphdmEKQEAgLTEsNSArMSw1IEBA
CiAvKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioq
KioqKioqKioqKioqKioqKioqKioqKioqKgotICogQ29weXJpZ2h0IChjKSAyMDExLCAyMDEyIElC
TSBDb3Jwb3JhdGlvbiBhbmQgb3RoZXJzLgorICogQ29weXJpZ2h0IChjKSAyMDExLCAyMDEzIElC
TSBDb3Jwb3JhdGlvbiBhbmQgb3RoZXJzLgogICogQWxsIHJpZ2h0cyByZXNlcnZlZC4gVGhpcyBw
cm9ncmFtIGFuZCB0aGUgYWNjb21wYW55aW5nIG1hdGVyaWFscwogICogYXJlIG1hZGUgYXZhaWxh
YmxlIHVuZGVyIHRoZSB0ZXJtcyBvZiB0aGUgRWNsaXBzZSBQdWJsaWMgTGljZW5zZSB2MS4wCiAg
KiB3aGljaCBhY2NvbXBhbmllcyB0aGlzIGRpc3RyaWJ1dGlvbiwgYW5kIGlzIGF2YWlsYWJsZSBh
dApAQCAtNTE2LDcgKzUxNiw3IEBACiAJCWNoZWNrU291cmNlUmFuZ2UoKEFTVE5vZGUpIG1vZGlm
aWVyLCAiQEZvbyIsIHNvdXJjZSk7CiAJCW1vZGlmaWVyID0gKElFeHRlbmRlZE1vZGlmaWVyKSBt
b2RpZmllcnMuZ2V0KDEpOwogCQljaGVja1NvdXJjZVJhbmdlKChBU1ROb2RlKSBtb2RpZmllciwg
ImZpbmFsIiwgc291cmNlKTsKLQkJYXNzZXJ0RXF1YWxzKCJXcm9uZyBkaW1lbnNpb24iLCAxLCBz
aW5nbGVWYXJpYWJsZURlY2xhcmF0aW9uLmdldEV4dHJhRGltZW5zaW9ucygpKTsKKwkJYXNzZXJ0
RXF1YWxzKCJXcm9uZyBkaW1lbnNpb24iLCAxLCBzaW5nbGVWYXJpYWJsZURlY2xhcmF0aW9uLmdl
dEV4dHJhRGltZW5zaW9uSW5mb3MoKS5zaXplKCkpOwogCQlUeXBlIHR5cGUgPSBzaW5nbGVWYXJp
YWJsZURlY2xhcmF0aW9uLmdldFR5cGUoKTsKIAkJY2hlY2tTb3VyY2VSYW5nZSh0eXBlLCAiU3Ry
aW5nIiwgc291cmNlKTsKIAkJYXNzZXJ0RXF1YWxzKCJXcm9uZyBuYW1lIiwgInMiLCBzaW1wbGVO
YW1lLmdldElkZW50aWZpZXIoKSk7CkBAIC0xNzA5LDcgKzE3MDksNyBAQAogCQlhc3NlcnRUcnVl
KCJub3QgYW4gYXJyYXkgdHlwZSIsIHR5cGUuaXNBcnJheVR5cGUoKSk7CiAJCUFycmF5VHlwZSBh
cnJheVR5cGUgPSAoQXJyYXlUeXBlKSB0eXBlOwogCQljaGVja1NvdXJjZVJhbmdlKGFycmF5VHlw
ZS5nZXRDb21wb25lbnRUeXBlKCksICJTdHJpbmciLCBzb3VyY2UpOwotCQlhc3NlcnRFcXVhbHMo
Ildyb25nIGV4dHJhIGRpbWVuc2lvbnMiLCAxLCBzaW5nbGVWYXJpYWJsZURlY2xhcmF0aW9uLmdl
dEV4dHJhRGltZW5zaW9ucygpKTsKKwkJYXNzZXJ0RXF1YWxzKCJXcm9uZyBleHRyYSBkaW1lbnNp
b25zIiwgMSwgc2luZ2xlVmFyaWFibGVEZWNsYXJhdGlvbi5nZXRFeHRyYURpbWVuc2lvbkluZm9z
KCkuc2l6ZSgpKTsKIAl9CiAKIAkvKioKQEAgLTE3MzcsNyArMTczNyw3IEBACiAJCWFzc2VydFRy
dWUoIm5vdCBhbiBhcnJheSB0eXBlIiwgdHlwZS5pc0FycmF5VHlwZSgpKTsKIAkJQXJyYXlUeXBl
IGFycmF5VHlwZSA9IChBcnJheVR5cGUpIHR5cGU7CiAJCWNoZWNrU291cmNlUmFuZ2UoYXJyYXlU
eXBlLmdldENvbXBvbmVudFR5cGUoKSwgIlN0cmluZyIsIHNvdXJjZSk7Ci0JCWFzc2VydEVxdWFs
cygiV3JvbmcgZXh0cmEgZGltZW5zaW9ucyIsIDAsIHNpbmdsZVZhcmlhYmxlRGVjbGFyYXRpb24u
Z2V0RXh0cmFEaW1lbnNpb25zKCkpOworCQlhc3NlcnRFcXVhbHMoIldyb25nIGV4dHJhIGRpbWVu
c2lvbnMiLCAwLCBzaW5nbGVWYXJpYWJsZURlY2xhcmF0aW9uLmdldEV4dHJhRGltZW5zaW9uSW5m
b3MoKS5zaXplKCkpOwogCX0KIAkvKioKIAkgKiBodHRwczovL2J1Z3MuZWNsaXBzZS5vcmcvYnVn
cy9zaG93X2J1Zy5jZ2k/aWQ9NzYxMDMKZGlmZiAtLWdpdCBhL29yZy5lY2xpcHNlLmpkdC5jb3Jl
LnRlc3RzLm1vZGVsL3NyYy9vcmcvZWNsaXBzZS9qZHQvY29yZS90ZXN0cy9kb20vQVNUQ29udmVy
dGVyMThUZXN0LmphdmEgYi9vcmcuZWNsaXBzZS5qZHQuY29yZS50ZXN0cy5tb2RlbC9zcmMvb3Jn
L2VjbGlwc2UvamR0L2NvcmUvdGVzdHMvZG9tL0FTVENvbnZlcnRlcjE4VGVzdC5qYXZhCmluZGV4
IDA2MWM5MTYuLjYwNTEwZDggMTAwNjQ0Ci0tLSBhL29yZy5lY2xpcHNlLmpkdC5jb3JlLnRlc3Rz
Lm1vZGVsL3NyYy9vcmcvZWNsaXBzZS9qZHQvY29yZS90ZXN0cy9kb20vQVNUQ29udmVydGVyMThU
ZXN0LmphdmEKKysrIGIvb3JnLmVjbGlwc2UuamR0LmNvcmUudGVzdHMubW9kZWwvc3JjL29yZy9l
Y2xpcHNlL2pkdC9jb3JlL3Rlc3RzL2RvbS9BU1RDb252ZXJ0ZXIxOFRlc3QuamF2YQpAQCAtMTAx
Nyw0ICsxMDE3LDU3IEBACiAJCWFzc2VydE5vdE51bGwoIkluY29ycmVjdCByZWNlaXZlciBxdWFs
ZmllciIsIG1ldGhvZC5nZXRSZWNlaXZlclF1YWxpZmllcigpKTsKIAkJYXNzZXJ0RXF1YWxzKCJJ
bmNvcnJlY3QgcmVjZWl2ZXIgcXVhbGZpZXIiLCAiWCIsIG1ldGhvZC5nZXRSZWNlaXZlclF1YWxp
ZmllcigpLmdldEZ1bGx5UXVhbGlmaWVkTmFtZSgpKTsKIAl9CisJLy8gaHR0cHM6Ly9idWdzLmVj
bGlwc2Uub3JnL2J1Z3Mvc2hvd19idWcuY2dpP2lkPTM5MTg5NQorCXB1YmxpYyB2b2lkIHRlc3Qw
MDA5KCkgdGhyb3dzIEphdmFNb2RlbEV4Y2VwdGlvbiB7CisJCVN0cmluZyBjb250ZW50cyA9CisJ
CQkJImltcG9ydCBqYXZhLmxhbmcuYW5ub3RhdGlvbi5FbGVtZW50VHlwZTtcbiIgKworCQkJCQkJ
InB1YmxpYyBjbGFzcyBYIHtcbiIgKworCQkJCQkJIiAJY2xhc3MgWSB7XG4iICsKKwkJCQkJCSIJ
CUBBbm5vdCBpbnQgQEFubm90MSBbXSBhIEBBbm5vdDIgQEFubm90MyBbXSBAQW5ub3QzIEBBbm5v
dDIgW10gQEFubm90NCBbXSwgYiBAQW5ub3QyIEBBbm5vdDMgW10gQEFubm90NCBbXSwgYyBbXVtd
W107XG4iICsgIAorCQkJCQkJIgkJcHVibGljIHZvaWQgZm9vMShAQW5ub3QgaW50IEBBbm5vdDEg
W10gcCBAQW5ub3QyIEBBbm5vdDMgW10gQEFubm90MyBAQW5ub3QyIFtdIEBBbm5vdDQgQEFubm90
MyBbXSkge31cbiIgKworCQkJCQkJIgkJcHVibGljIHZvaWQgZm9vMihAQW5ub3QgaW50IHAgW11b
XSkge31cbiIgKworCQkJCQkJIgkJQEFubm90IFN0cmluZyBAQW5ub3QxIFtdIGZvbzMoKSBAQW5u
b3QxIEBBbm5vdDIgW11bXSB7IHJldHVybiBudWxsOyB9XG4iICsgCisJCQkJCQkiCX1cbiIgKwor
CQkJCQkJIn1cbiIgKworCQkJCQkJIkBqYXZhLmxhbmcuYW5ub3RhdGlvbi5UYXJnZXQodmFsdWUg
PSB7RWxlbWVudFR5cGUuVFlQRV9VU0V9KVxuIiArIAorCQkJCQkJIkBpbnRlcmZhY2UgQW5ub3Qg
e31cbiIgKworCQkJCQkJIkBqYXZhLmxhbmcuYW5ub3RhdGlvbi5UYXJnZXQodmFsdWUgPSB7RWxl
bWVudFR5cGUuVFlQRV9VU0V9KVxuIiArIAorCQkJCQkJIkBpbnRlcmZhY2UgQW5ub3QxIHt9XG4i
ICsKKwkJCQkJCSJAamF2YS5sYW5nLmFubm90YXRpb24uVGFyZ2V0KHZhbHVlID0ge0VsZW1lbnRU
eXBlLlRZUEVfVVNFfSlcbiIgKworCQkJCQkJIkBpbnRlcmZhY2UgQW5ub3QyIHt9XG4iICsKKwkJ
CQkJCSJAamF2YS5sYW5nLmFubm90YXRpb24uVGFyZ2V0KHZhbHVlID0ge0VsZW1lbnRUeXBlLlRZ
UEVfVVNFfSlcbiIgKyAKKwkJCQkJCSJAaW50ZXJmYWNlIEFubm90MyB7fVxuIiArCisJCQkJCQki
QGphdmEubGFuZy5hbm5vdGF0aW9uLlRhcmdldCh2YWx1ZSA9IHtFbGVtZW50VHlwZS5UWVBFX1VT
RX0pXG4iICsKKwkJCQkJCSJAaW50ZXJmYWNlIEFubm90NCB7fSI7CisJCXRoaXMud29ya2luZ0Nv
cHkgPSBnZXRXb3JraW5nQ29weSgiL0NvbnZlcnRlcjE4L3NyYy9YLmphdmEiLCB0cnVlKTsKKwkJ
QVNUTm9kZSBub2RlID0gYnVpbGRBU1QoY29udGVudHMsIHRoaXMud29ya2luZ0NvcHkpOworCQlh
c3NlcnRFcXVhbHMoIk5vdCBhIGNvbXBpbGF0aW9uIHVuaXQiLCBBU1ROb2RlLkNPTVBJTEFUSU9O
X1VOSVQsIG5vZGUuZ2V0Tm9kZVR5cGUoKSk7CisJCUNvbXBpbGF0aW9uVW5pdCB1bml0ID0gKENv
bXBpbGF0aW9uVW5pdCkgbm9kZTsKKwkJbm9kZSA9IGdldEFTVE5vZGUodW5pdCwgMCwgMCk7CisJ
CWFzc2VydEVxdWFscygiTm90IGEgdHlwZSBEZWNsYXJhdGlvbiIsIEFTVE5vZGUuVFlQRV9ERUNM
QVJBVElPTiwgbm9kZS5nZXROb2RlVHlwZSgpKTsKKwkJVHlwZURlY2xhcmF0aW9uIHR5cGUgPSAo
VHlwZURlY2xhcmF0aW9uKSBub2RlOworCQlGaWVsZERlY2xhcmF0aW9uIGZpZWxkID0gdHlwZS5n
ZXRGaWVsZHMoKVswXTsKKwkJTGlzdCBmcmFnbWVudHMgPSBmaWVsZC5mcmFnbWVudHMoKTsKKwkJ
YXNzZXJ0RXF1YWxzKCJJbmNvcnJlY3Qgbm8gb2YgZnJhZ21lbnRzIiwgMywgZnJhZ21lbnRzLnNp
emUoKSk7CisJCVZhcmlhYmxlRGVjbGFyYXRpb25GcmFnbWVudCBmcmFnbWVudCA9IChWYXJpYWJs
ZURlY2xhcmF0aW9uRnJhZ21lbnQpIGZyYWdtZW50cy5nZXQoMCk7CisJCWFzc2VydEV4dHJhRGlt
ZW5zaW9uc0VxdWFsKCJJbmNvcnJlY3QgZGltZW5zaW9uIHR5cGUiLCBmcmFnbWVudC5nZXRFeHRy
YURpbWVuc2lvbkluZm9zKCksICJAQW5ub3QyIEBBbm5vdDMgW10gQEFubm90MyBAQW5ub3QyIFtd
IEBBbm5vdDQgW10iKTsKKwkJZnJhZ21lbnQgPSAoVmFyaWFibGVEZWNsYXJhdGlvbkZyYWdtZW50
KSBmcmFnbWVudHMuZ2V0KDEpOworCQlhc3NlcnRFeHRyYURpbWVuc2lvbnNFcXVhbCgiSW5jb3Jy
ZWN0IGRpbWVuc2lvbiB0eXBlIiwgZnJhZ21lbnQuZ2V0RXh0cmFEaW1lbnNpb25JbmZvcygpLCAi
QEFubm90MiBAQW5ub3QzIFtdIEBBbm5vdDQgW10iKTsJCQorCQlmcmFnbWVudCA9IChWYXJpYWJs
ZURlY2xhcmF0aW9uRnJhZ21lbnQpIGZyYWdtZW50cy5nZXQoMik7CisJCWFzc2VydEV4dHJhRGlt
ZW5zaW9uc0VxdWFsKCJJbmNvcnJlY3QgZGltZW5zaW9uIHR5cGUiLCBmcmFnbWVudC5nZXRFeHRy
YURpbWVuc2lvbkluZm9zKCksICJbXSBbXSBbXSIpOworCQlNZXRob2REZWNsYXJhdGlvbltdIG1l
dGhvZHMgPSB0eXBlLmdldE1ldGhvZHMoKTsKKwkJYXNzZXJ0RXF1YWxzKCJJbmNvcnJlY3Qgbm8g
b2YgbWV0aG9kcyIsIDMsIG1ldGhvZHMubGVuZ3RoKTsKKwkJTWV0aG9kRGVjbGFyYXRpb24gbWV0
aG9kID0gbWV0aG9kc1swXTsKKwkJTGlzdCBwYXJhbWV0ZXJzID0gbWV0aG9kLnBhcmFtZXRlcnMo
KTsKKwkJYXNzZXJ0RXF1YWxzKCJJbmNvcnJlY3Qgbm8gb2YgcGFyYW1ldGVycyIsIDEsIHBhcmFt
ZXRlcnMuc2l6ZSgpKTsKKwkJYXNzZXJ0RXh0cmFEaW1lbnNpb25zRXF1YWwoIkluY29ycmVjdCBk
aW1lbnNpb24gdHlwZSIsICgoU2luZ2xlVmFyaWFibGVEZWNsYXJhdGlvbikgcGFyYW1ldGVycy5n
ZXQoMCkpLmdldEV4dHJhRGltZW5zaW9uSW5mb3MoKSwgIkBBbm5vdDIgQEFubm90MyBbXSBAQW5u
b3QzIEBBbm5vdDIgW10gQEFubm90NCBAQW5ub3QzIFtdIik7CisKKwkJbWV0aG9kID0gbWV0aG9k
c1sxXTsKKwkJcGFyYW1ldGVycyA9IG1ldGhvZC5wYXJhbWV0ZXJzKCk7CisJCWFzc2VydEVxdWFs
cygiSW5jb3JyZWN0IG5vIG9mIHBhcmFtZXRlcnMiLCAxLCBwYXJhbWV0ZXJzLnNpemUoKSk7CisJ
CWFzc2VydEV4dHJhRGltZW5zaW9uc0VxdWFsKCJJbmNvcnJlY3QgZGltZW5zaW9uIHR5cGUiLCAo
KFNpbmdsZVZhcmlhYmxlRGVjbGFyYXRpb24pIHBhcmFtZXRlcnMuZ2V0KDApKS5nZXRFeHRyYURp
bWVuc2lvbkluZm9zKCksICJbXSBbXSIpOworCisJCW1ldGhvZCA9IG1ldGhvZHNbMl07CisJCWFz
c2VydEV4dHJhRGltZW5zaW9uc0VxdWFsKCJJbmNvcnJlY3QgZGltZW5zaW9uIHR5cGUiLCBtZXRo
b2QuZ2V0RXh0cmFEaW1lbnNpb25JbmZvcygpLCAiQEFubm90MSBAQW5ub3QyIFtdIFtdIik7CisJ
fQogfQpkaWZmIC0tZ2l0IGEvb3JnLmVjbGlwc2UuamR0LmNvcmUudGVzdHMubW9kZWwvc3JjL29y
Zy9lY2xpcHNlL2pkdC9jb3JlL3Rlc3RzL2RvbS9BU1RDb252ZXJ0ZXJBU1Q4VGVzdC5qYXZhIGIv
b3JnLmVjbGlwc2UuamR0LmNvcmUudGVzdHMubW9kZWwvc3JjL29yZy9lY2xpcHNlL2pkdC9jb3Jl
L3Rlc3RzL2RvbS9BU1RDb252ZXJ0ZXJBU1Q4VGVzdC5qYXZhCmluZGV4IDkyN2FiM2YuLjJiY2Uw
ZDcgMTAwNjQ0Ci0tLSBhL29yZy5lY2xpcHNlLmpkdC5jb3JlLnRlc3RzLm1vZGVsL3NyYy9vcmcv
ZWNsaXBzZS9qZHQvY29yZS90ZXN0cy9kb20vQVNUQ29udmVydGVyQVNUOFRlc3QuamF2YQorKysg
Yi9vcmcuZWNsaXBzZS5qZHQuY29yZS50ZXN0cy5tb2RlbC9zcmMvb3JnL2VjbGlwc2UvamR0L2Nv
cmUvdGVzdHMvZG9tL0FTVENvbnZlcnRlckFTVDhUZXN0LmphdmEKQEAgLTM3LDYgKzM3LDcgQEAK
IAogCXN0YXRpYyB7CiAvLwkJVEVTVFNfTlVNQkVSUyA9IG5ldyBpbnRbXSB7IDM1NiB9OworLy8J
CVRFU1RTX05BTUVTID0gbmV3IFN0cmluZ1tdeyAidGVzdDAzOTMiIH07CiAJfQogCXB1YmxpYyBz
dGF0aWMgVGVzdCBzdWl0ZSgpIHsKIAkJcmV0dXJuIGJ1aWxkTW9kZWxUZXN0U3VpdGUoQVNUQ29u
dmVydGVyQVNUOFRlc3QuY2xhc3MpOwpAQCAtMTk5Miw3ICsxOTkzLDcgQEAKIAkJdmFyaWFibGVE
ZWNsYXJhdGlvbi5zZXROYW1lKHRoaXMuYXN0Lm5ld1NpbXBsZU5hbWUoInMiKSk7IC8vJE5PTi1O
TFMtMSQKIAkJYXNzZXJ0VHJ1ZSgiQm90aCBBU1QgdHJlZXMgc2hvdWxkIGJlIGlkZW50aWNhbCIs
IHZhcmlhYmxlRGVjbGFyYXRpb24uc3VidHJlZU1hdGNoKG5ldyBBU1RNYXRjaGVyKCksIG5vZGUp
KTsJCS8vJE5PTi1OTFMtMSQKIAkJY2hlY2tTb3VyY2VSYW5nZShub2RlLCAiZmluYWwgU3RyaW5n
IHMiLCBzb3VyY2UpOyAvLyROT04tTkxTLTEkCi0JCWFzc2VydEVxdWFscygiV3JvbmcgZGltZW5z
aW9uIiwgMCwgbm9kZS5nZXRFeHRyYURpbWVuc2lvbnMoKSk7IC8vJE5PTi1OTFMtMSQKKwkJYXNz
ZXJ0RXF1YWxzKCJXcm9uZyBkaW1lbnNpb24iLCAwLCBub2RlLmdldEV4dHJhRGltZW5zaW9uSW5m
b3MoKS5zaXplKCkpOyAvLyROT04tTkxTLTEkCiAJfQogCiAJLyoqCkBAIC0yNzE4LDIwICsyNzE5
LDIzIEBACiAJCU51bWJlckxpdGVyYWwgbGl0ZXJhbCA9IHRoaXMuYXN0Lm5ld051bWJlckxpdGVy
YWwoKTsKIAkJbGl0ZXJhbC5zZXRUb2tlbigiMTAiKTsvLyROT04tTkxTLTEkCiAJCWZyYWdtZW50
LnNldEluaXRpYWxpemVyKGxpdGVyYWwpOwotCQlmcmFnbWVudC5zZXRFeHRyYURpbWVuc2lvbnMo
MCk7CisJCWZyYWdtZW50LmdldEV4dHJhRGltZW5zaW9uSW5mb3MoKS5jbGVhcigpOwogCQlWYXJp
YWJsZURlY2xhcmF0aW9uU3RhdGVtZW50IHN0YXRlbWVudCA9IHRoaXMuYXN0Lm5ld1ZhcmlhYmxl
RGVjbGFyYXRpb25TdGF0ZW1lbnQoZnJhZ21lbnQpOwogCQlmcmFnbWVudCA9IHRoaXMuYXN0Lm5l
d1ZhcmlhYmxlRGVjbGFyYXRpb25GcmFnbWVudCgpOwogCQlmcmFnbWVudC5zZXROYW1lKHRoaXMu
YXN0Lm5ld1NpbXBsZU5hbWUoInoiKSk7Ly8kTk9OLU5MUy0xJAogCQlmcmFnbWVudC5zZXRJbml0
aWFsaXplcih0aGlzLmFzdC5uZXdOdWxsTGl0ZXJhbCgpKTsKLQkJZnJhZ21lbnQuc2V0RXh0cmFE
aW1lbnNpb25zKDEpOworCQlmcmFnbWVudC5nZXRFeHRyYURpbWVuc2lvbkluZm9zKCkuY2xlYXIo
KTsKKwkJZnJhZ21lbnQuZ2V0RXh0cmFEaW1lbnNpb25JbmZvcygpLmFkZCh0aGlzLmFzdC5uZXdE
aW1lbnNpb25JbmZvKG51bGwpKTsKIAkJc3RhdGVtZW50LmZyYWdtZW50cygpLmFkZChmcmFnbWVu
dCk7CiAJCWZyYWdtZW50ID0gdGhpcy5hc3QubmV3VmFyaWFibGVEZWNsYXJhdGlvbkZyYWdtZW50
KCk7CiAJCWZyYWdtZW50LnNldE5hbWUodGhpcy5hc3QubmV3U2ltcGxlTmFtZSgiaSIpKTsvLyRO
T04tTkxTLTEkCi0JCWZyYWdtZW50LnNldEV4dHJhRGltZW5zaW9ucygwKTsKKwkJZnJhZ21lbnQu
Z2V0RXh0cmFEaW1lbnNpb25JbmZvcygpLmNsZWFyKCk7CiAJCXN0YXRlbWVudC5mcmFnbWVudHMo
KS5hZGQoZnJhZ21lbnQpOwogCQlmcmFnbWVudCA9IHRoaXMuYXN0Lm5ld1ZhcmlhYmxlRGVjbGFy
YXRpb25GcmFnbWVudCgpOwogCQlmcmFnbWVudC5zZXROYW1lKHRoaXMuYXN0Lm5ld1NpbXBsZU5h
bWUoImoiKSk7Ly8kTk9OLU5MUy0xJAotCQlmcmFnbWVudC5zZXRFeHRyYURpbWVuc2lvbnMoMik7
CisJCWZyYWdtZW50LmdldEV4dHJhRGltZW5zaW9uSW5mb3MoKS5jbGVhcigpOworCQlmcmFnbWVu
dC5nZXRFeHRyYURpbWVuc2lvbkluZm9zKCkuYWRkKHRoaXMuYXN0Lm5ld0RpbWVuc2lvbkluZm8o
bnVsbCkpOworCQlmcmFnbWVudC5nZXRFeHRyYURpbWVuc2lvbkluZm9zKCkuYWRkKHRoaXMuYXN0
Lm5ld0RpbWVuc2lvbkluZm8obnVsbCkpOwogCQlzdGF0ZW1lbnQuZnJhZ21lbnRzKCkuYWRkKGZy
YWdtZW50KTsKIAkJc3RhdGVtZW50LnNldFR5cGUodGhpcy5hc3QubmV3UHJpbWl0aXZlVHlwZShQ
cmltaXRpdmVUeXBlLklOVCkpOwogCQlhc3NlcnRUcnVlKCJCb3RoIEFTVCB0cmVlcyBzaG91bGQg
YmUgaWRlbnRpY2FsIiwgc3RhdGVtZW50LnN1YnRyZWVNYXRjaChuZXcgQVNUTWF0Y2hlcigpLCBu
b2RlKSk7CQkvLyROT04tTkxTLTEkCkBAIC0yNzU4LDIwICsyNzYyLDIzIEBACiAJCU51bWJlckxp
dGVyYWwgbGl0ZXJhbCA9IHRoaXMuYXN0Lm5ld051bWJlckxpdGVyYWwoKTsKIAkJbGl0ZXJhbC5z
ZXRUb2tlbigiMTAiKTsvLyROT04tTkxTLTEkCiAJCWZyYWdtZW50LnNldEluaXRpYWxpemVyKGxp
dGVyYWwpOwotCQlmcmFnbWVudC5zZXRFeHRyYURpbWVuc2lvbnMoMCk7CisJCWZyYWdtZW50Lmdl
dEV4dHJhRGltZW5zaW9uSW5mb3MoKS5jbGVhcigpOwogCQlWYXJpYWJsZURlY2xhcmF0aW9uU3Rh
dGVtZW50IHN0YXRlbWVudCA9IHRoaXMuYXN0Lm5ld1ZhcmlhYmxlRGVjbGFyYXRpb25TdGF0ZW1l
bnQoZnJhZ21lbnQpOwogCQlmcmFnbWVudCA9IHRoaXMuYXN0Lm5ld1ZhcmlhYmxlRGVjbGFyYXRp
b25GcmFnbWVudCgpOwogCQlmcmFnbWVudC5zZXROYW1lKHRoaXMuYXN0Lm5ld1NpbXBsZU5hbWUo
InoiKSk7Ly8kTk9OLU5MUy0xJAogCQlmcmFnbWVudC5zZXRJbml0aWFsaXplcih0aGlzLmFzdC5u
ZXdOdWxsTGl0ZXJhbCgpKTsKLQkJZnJhZ21lbnQuc2V0RXh0cmFEaW1lbnNpb25zKDEpOworCQlm
cmFnbWVudC5nZXRFeHRyYURpbWVuc2lvbkluZm9zKCkuY2xlYXIoKTsKKwkJZnJhZ21lbnQuZ2V0
RXh0cmFEaW1lbnNpb25JbmZvcygpLmFkZCh0aGlzLmFzdC5uZXdEaW1lbnNpb25JbmZvKG51bGwp
KTsKIAkJc3RhdGVtZW50LmZyYWdtZW50cygpLmFkZChmcmFnbWVudCk7CiAJCWZyYWdtZW50ID0g
dGhpcy5hc3QubmV3VmFyaWFibGVEZWNsYXJhdGlvbkZyYWdtZW50KCk7CiAJCWZyYWdtZW50LnNl
dE5hbWUodGhpcy5hc3QubmV3U2ltcGxlTmFtZSgiaSIpKTsvLyROT04tTkxTLTEkCi0JCWZyYWdt
ZW50LnNldEV4dHJhRGltZW5zaW9ucygwKTsKKwkJZnJhZ21lbnQuZ2V0RXh0cmFEaW1lbnNpb25J
bmZvcygpLmNsZWFyKCk7CiAJCXN0YXRlbWVudC5mcmFnbWVudHMoKS5hZGQoZnJhZ21lbnQpOwog
CQlmcmFnbWVudCA9IHRoaXMuYXN0Lm5ld1ZhcmlhYmxlRGVjbGFyYXRpb25GcmFnbWVudCgpOwog
CQlmcmFnbWVudC5zZXROYW1lKHRoaXMuYXN0Lm5ld1NpbXBsZU5hbWUoImoiKSk7Ly8kTk9OLU5M
Uy0xJAotCQlmcmFnbWVudC5zZXRFeHRyYURpbWVuc2lvbnMoMik7CisJCWZyYWdtZW50LmdldEV4
dHJhRGltZW5zaW9uSW5mb3MoKS5jbGVhcigpOworCQlmcmFnbWVudC5nZXRFeHRyYURpbWVuc2lv
bkluZm9zKCkuYWRkKHRoaXMuYXN0Lm5ld0RpbWVuc2lvbkluZm8obnVsbCkpOworCQlmcmFnbWVu
dC5nZXRFeHRyYURpbWVuc2lvbkluZm9zKCkuYWRkKHRoaXMuYXN0Lm5ld0RpbWVuc2lvbkluZm8o
bnVsbCkpOwogCQlzdGF0ZW1lbnQuZnJhZ21lbnRzKCkuYWRkKGZyYWdtZW50KTsKIAkJc3RhdGVt
ZW50LnNldFR5cGUodGhpcy5hc3QubmV3QXJyYXlUeXBlKHRoaXMuYXN0Lm5ld1ByaW1pdGl2ZVR5
cGUoUHJpbWl0aXZlVHlwZS5JTlQpLCAxKSk7CiAJCWFzc2VydFRydWUoIkJvdGggQVNUIHRyZWVz
IHNob3VsZCBiZSBpZGVudGljYWwiLCBzdGF0ZW1lbnQuc3VidHJlZU1hdGNoKG5ldyBBU1RNYXRj
aGVyKCksIG5vZGUpKTsJCS8vJE5PTi1OTFMtMSQKQEAgLTI3OTcsNyArMjgwNCw4IEBACiAJCVZh
cmlhYmxlRGVjbGFyYXRpb25GcmFnbWVudCB2YXJpYWJsZURlY2xhcmF0aW9uRnJhZ21lbnQgPSB0
aGlzLmFzdC5uZXdWYXJpYWJsZURlY2xhcmF0aW9uRnJhZ21lbnQoKTsKIAkJdmFyaWFibGVEZWNs
YXJhdGlvbkZyYWdtZW50LnNldE5hbWUodGhpcy5hc3QubmV3U2ltcGxlTmFtZSgidGFiIikpOyAv
LyROT04tTkxTLTEkCiAJCXZhcmlhYmxlRGVjbGFyYXRpb25GcmFnbWVudC5zZXRJbml0aWFsaXpl
cih0aGlzLmFzdC5uZXdOdWxsTGl0ZXJhbCgpKTsvLyROT04tTkxTLTEkCi0JCXZhcmlhYmxlRGVj
bGFyYXRpb25GcmFnbWVudC5zZXRFeHRyYURpbWVuc2lvbnMoMSk7CisJCXZhcmlhYmxlRGVjbGFy
YXRpb25GcmFnbWVudC5nZXRFeHRyYURpbWVuc2lvbkluZm9zKCkuY2xlYXIoKTsKKwkJdmFyaWFi
bGVEZWNsYXJhdGlvbkZyYWdtZW50LmdldEV4dHJhRGltZW5zaW9uSW5mb3MoKS5hZGQodGhpcy5h
c3QubmV3RGltZW5zaW9uSW5mbyhudWxsKSk7CiAJCVZhcmlhYmxlRGVjbGFyYXRpb25FeHByZXNz
aW9uIHZhcmlhYmxlRGVjbGFyYXRpb25FeHByZXNzaW9uID0gdGhpcy5hc3QubmV3VmFyaWFibGVE
ZWNsYXJhdGlvbkV4cHJlc3Npb24odmFyaWFibGVEZWNsYXJhdGlvbkZyYWdtZW50KTsKIAkJdmFy
aWFibGVEZWNsYXJhdGlvbkV4cHJlc3Npb24uc2V0VHlwZSh0aGlzLmFzdC5uZXdBcnJheVR5cGUo
dGhpcy5hc3QubmV3U2ltcGxlVHlwZSh0aGlzLmFzdC5uZXdTaW1wbGVOYW1lKCJTdHJpbmciKSks
IDEpKTsvLyROT04tTkxTLTEkCiAJCWZvclN0YXRlbWVudC5pbml0aWFsaXplcnMoKS5hZGQodmFy
aWFibGVEZWNsYXJhdGlvbkV4cHJlc3Npb24pOwpAQCAtMjgyNSw3ICsyODMzLDggQEAKIAkJVmFy
aWFibGVEZWNsYXJhdGlvbkZyYWdtZW50IHZhcmlhYmxlRGVjbGFyYXRpb25GcmFnbWVudCA9IHRo
aXMuYXN0Lm5ld1ZhcmlhYmxlRGVjbGFyYXRpb25GcmFnbWVudCgpOwogCQl2YXJpYWJsZURlY2xh
cmF0aW9uRnJhZ21lbnQuc2V0TmFtZSh0aGlzLmFzdC5uZXdTaW1wbGVOYW1lKCJ0YWIiKSk7IC8v
JE5PTi1OTFMtMSQKIAkJdmFyaWFibGVEZWNsYXJhdGlvbkZyYWdtZW50LnNldEluaXRpYWxpemVy
KHRoaXMuYXN0Lm5ld051bGxMaXRlcmFsKCkpOy8vJE5PTi1OTFMtMSQKLQkJdmFyaWFibGVEZWNs
YXJhdGlvbkZyYWdtZW50LnNldEV4dHJhRGltZW5zaW9ucygxKTsKKwkJdmFyaWFibGVEZWNsYXJh
dGlvbkZyYWdtZW50LmdldEV4dHJhRGltZW5zaW9uSW5mb3MoKS5jbGVhcigpOworCQl2YXJpYWJs
ZURlY2xhcmF0aW9uRnJhZ21lbnQuZ2V0RXh0cmFEaW1lbnNpb25JbmZvcygpLmFkZCh0aGlzLmFz
dC5uZXdEaW1lbnNpb25JbmZvKG51bGwpKTsKIAkJVmFyaWFibGVEZWNsYXJhdGlvbkV4cHJlc3Np
b24gdmFyaWFibGVEZWNsYXJhdGlvbkV4cHJlc3Npb24gPSB0aGlzLmFzdC5uZXdWYXJpYWJsZURl
Y2xhcmF0aW9uRXhwcmVzc2lvbih2YXJpYWJsZURlY2xhcmF0aW9uRnJhZ21lbnQpOwogCQl2YXJp
YWJsZURlY2xhcmF0aW9uRXhwcmVzc2lvbi5zZXRUeXBlKHRoaXMuYXN0Lm5ld1NpbXBsZVR5cGUo
dGhpcy5hc3QubmV3U2ltcGxlTmFtZSgiU3RyaW5nIikpKTsvLyROT04tTkxTLTEkCiAJCWZvclN0
YXRlbWVudC5pbml0aWFsaXplcnMoKS5hZGQodmFyaWFibGVEZWNsYXJhdGlvbkV4cHJlc3Npb24p
OwpAQCAtMjg1Myw3ICsyODYyLDggQEAKIAkJVmFyaWFibGVEZWNsYXJhdGlvbkZyYWdtZW50IHZh
cmlhYmxlRGVjbGFyYXRpb25GcmFnbWVudCA9IHRoaXMuYXN0Lm5ld1ZhcmlhYmxlRGVjbGFyYXRp
b25GcmFnbWVudCgpOwogCQl2YXJpYWJsZURlY2xhcmF0aW9uRnJhZ21lbnQuc2V0TmFtZSh0aGlz
LmFzdC5uZXdTaW1wbGVOYW1lKCJ0YWIiKSk7IC8vJE5PTi1OTFMtMSQKIAkJdmFyaWFibGVEZWNs
YXJhdGlvbkZyYWdtZW50LnNldEluaXRpYWxpemVyKHRoaXMuYXN0Lm5ld051bGxMaXRlcmFsKCkp
Oy8vJE5PTi1OTFMtMSQKLQkJdmFyaWFibGVEZWNsYXJhdGlvbkZyYWdtZW50LnNldEV4dHJhRGlt
ZW5zaW9ucygxKTsKKwkJdmFyaWFibGVEZWNsYXJhdGlvbkZyYWdtZW50LmdldEV4dHJhRGltZW5z
aW9uSW5mb3MoKS5jbGVhcigpOworCQl2YXJpYWJsZURlY2xhcmF0aW9uRnJhZ21lbnQuZ2V0RXh0
cmFEaW1lbnNpb25JbmZvcygpLmFkZCh0aGlzLmFzdC5uZXdEaW1lbnNpb25JbmZvKG51bGwpKTsK
IAkJVmFyaWFibGVEZWNsYXJhdGlvbkV4cHJlc3Npb24gdmFyaWFibGVEZWNsYXJhdGlvbkV4cHJl
c3Npb24gPSB0aGlzLmFzdC5uZXdWYXJpYWJsZURlY2xhcmF0aW9uRXhwcmVzc2lvbih2YXJpYWJs
ZURlY2xhcmF0aW9uRnJhZ21lbnQpOwogCQl2YXJpYWJsZURlY2xhcmF0aW9uRXhwcmVzc2lvbi5z
ZXRUeXBlKHRoaXMuYXN0Lm5ld1NpbXBsZVR5cGUodGhpcy5hc3QubmV3U2ltcGxlTmFtZSgiU3Ry
aW5nIikpKTsvLyROT04tTkxTLTEkCiAJCWZvclN0YXRlbWVudC5pbml0aWFsaXplcnMoKS5hZGQo
dmFyaWFibGVEZWNsYXJhdGlvbkV4cHJlc3Npb24pOwpAQCAtMjg4Miw3ICsyODkyLDcgQEAKIAkJ
YXNzZXJ0VHJ1ZSgiTm90IGEgZGVjbGFyYXRpb24iLCBmcmFnLmdldE5hbWUoKS5pc0RlY2xhcmF0
aW9uKCkpOyAvLyROT04tTkxTLTEkCiAJCVZhcmlhYmxlRGVjbGFyYXRpb25GcmFnbWVudCBmcmFn
bWVudCA9IHRoaXMuYXN0Lm5ld1ZhcmlhYmxlRGVjbGFyYXRpb25GcmFnbWVudCgpOwogCQlmcmFn
bWVudC5zZXROYW1lKHRoaXMuYXN0Lm5ld1NpbXBsZU5hbWUoImkiKSk7IC8vJE5PTi1OTFMtMSQK
LQkJZnJhZ21lbnQuc2V0RXh0cmFEaW1lbnNpb25zKDApOworCQlmcmFnbWVudC5nZXRFeHRyYURp
bWVuc2lvbkluZm9zKCkuY2xlYXIoKTsKIAkJRmllbGREZWNsYXJhdGlvbiBmaWVsZERlY2xhcmF0
aW9uID0gdGhpcy5hc3QubmV3RmllbGREZWNsYXJhdGlvbihmcmFnbWVudCk7CiAJCWZpZWxkRGVj
bGFyYXRpb24uc2V0VHlwZSh0aGlzLmFzdC5uZXdQcmltaXRpdmVUeXBlKFByaW1pdGl2ZVR5cGUu
SU5UKSk7CiAJCWFzc2VydFRydWUoIkJvdGggQVNUIHRyZWVzIHNob3VsZCBiZSBpZGVudGljYWwi
LCBmaWVsZERlY2xhcmF0aW9uLnN1YnRyZWVNYXRjaChuZXcgQVNUTWF0Y2hlcigpLCBub2RlKSk7
CQkvLyROT04tTkxTLTEkCkBAIC0yOTA0LDIyICsyOTE0LDI1IEBACiAJCU51bWJlckxpdGVyYWwg
bGl0ZXJhbCA9IHRoaXMuYXN0Lm5ld051bWJlckxpdGVyYWwoKTsKIAkJbGl0ZXJhbC5zZXRUb2tl
bigiMTAiKTsgLy8kTk9OLU5MUy0xJAogCQlmcmFnbWVudC5zZXRJbml0aWFsaXplcihsaXRlcmFs
KTsKLQkJZnJhZ21lbnQuc2V0RXh0cmFEaW1lbnNpb25zKDApOworCQlmcmFnbWVudC5nZXRFeHRy
YURpbWVuc2lvbkluZm9zKCkuY2xlYXIoKTsKIAkJRmllbGREZWNsYXJhdGlvbiBmaWVsZERlY2xh
cmF0aW9uID0gdGhpcy5hc3QubmV3RmllbGREZWNsYXJhdGlvbihmcmFnbWVudCk7CiAJCWZpZWxk
RGVjbGFyYXRpb24ubW9kaWZpZXJzKCkuYWRkKHRoaXMuYXN0Lm5ld01vZGlmaWVyKE1vZGlmaWVy
Lk1vZGlmaWVyS2V5d29yZC5QVUJMSUNfS0VZV09SRCkpOwogCQlmaWVsZERlY2xhcmF0aW9uLnNl
dFR5cGUodGhpcy5hc3QubmV3UHJpbWl0aXZlVHlwZShQcmltaXRpdmVUeXBlLklOVCkpOwogCQlm
cmFnbWVudCA9IHRoaXMuYXN0Lm5ld1ZhcmlhYmxlRGVjbGFyYXRpb25GcmFnbWVudCgpOwogCQlm
cmFnbWVudC5zZXROYW1lKHRoaXMuYXN0Lm5ld1NpbXBsZU5hbWUoInkiKSk7Ly8kTk9OLU5MUy0x
JAotCQlmcmFnbWVudC5zZXRFeHRyYURpbWVuc2lvbnMoMSk7CisJCWZyYWdtZW50LmdldEV4dHJh
RGltZW5zaW9uSW5mb3MoKS5jbGVhcigpOworCQlmcmFnbWVudC5nZXRFeHRyYURpbWVuc2lvbklu
Zm9zKCkuYWRkKHRoaXMuYXN0Lm5ld0RpbWVuc2lvbkluZm8obnVsbCkpOwogCQlmcmFnbWVudC5z
ZXRJbml0aWFsaXplcih0aGlzLmFzdC5uZXdOdWxsTGl0ZXJhbCgpKTsKIAkJZmllbGREZWNsYXJh
dGlvbi5mcmFnbWVudHMoKS5hZGQoZnJhZ21lbnQpOwogCQlmcmFnbWVudCA9IHRoaXMuYXN0Lm5l
d1ZhcmlhYmxlRGVjbGFyYXRpb25GcmFnbWVudCgpOwogCQlmcmFnbWVudC5zZXROYW1lKHRoaXMu
YXN0Lm5ld1NpbXBsZU5hbWUoImkiKSk7Ly8kTk9OLU5MUy0xJAotCQlmcmFnbWVudC5zZXRFeHRy
YURpbWVuc2lvbnMoMCk7CisJCWZyYWdtZW50LmdldEV4dHJhRGltZW5zaW9uSW5mb3MoKS5jbGVh
cigpOwogCQlmaWVsZERlY2xhcmF0aW9uLmZyYWdtZW50cygpLmFkZChmcmFnbWVudCk7CiAJCWZy
YWdtZW50ID0gdGhpcy5hc3QubmV3VmFyaWFibGVEZWNsYXJhdGlvbkZyYWdtZW50KCk7CiAJCWZy
YWdtZW50LnNldE5hbWUodGhpcy5hc3QubmV3U2ltcGxlTmFtZSgiaiIpKTsvLyROT04tTkxTLTEk
Ci0JCWZyYWdtZW50LnNldEV4dHJhRGltZW5zaW9ucygyKTsKKwkJZnJhZ21lbnQuZ2V0RXh0cmFE
aW1lbnNpb25JbmZvcygpLmNsZWFyKCk7CisJCWZyYWdtZW50LmdldEV4dHJhRGltZW5zaW9uSW5m
b3MoKS5hZGQodGhpcy5hc3QubmV3RGltZW5zaW9uSW5mbyhudWxsKSk7CisJCWZyYWdtZW50Lmdl
dEV4dHJhRGltZW5zaW9uSW5mb3MoKS5hZGQodGhpcy5hc3QubmV3RGltZW5zaW9uSW5mbyhudWxs
KSk7CiAJCWZpZWxkRGVjbGFyYXRpb24uZnJhZ21lbnRzKCkuYWRkKGZyYWdtZW50KTsKIAkJYXNz
ZXJ0VHJ1ZSgiQm90aCBBU1QgdHJlZXMgc2hvdWxkIGJlIGlkZW50aWNhbCIsIGZpZWxkRGVjbGFy
YXRpb24uc3VidHJlZU1hdGNoKG5ldyBBU1RNYXRjaGVyKCksIG5vZGUpKTsJCS8vJE5PTi1OTFMt
MSQKIAkJY2hlY2tTb3VyY2VSYW5nZShub2RlLCAicHVibGljIGludCB4PSAxMCwgeVtdID0gbnVs
bCwgaSwgaltdW107Iiwgc291cmNlKTsgLy8kTk9OLU5MUy0xJApAQCAtOTU4NCwxMyArOTU5Nywx
NSBAQAogCQlhc3NlcnROb3ROdWxsKCJObyB0eXBlIGJpbmRpbmciLCB0eXBlQmluZGluZyk7IC8v
JE5PTi1OTFMtMSQKIAkJYXNzZXJ0RXF1YWxzKCJXcm9uZyBkaW1lbnNpb24iLCAwLCB0eXBlQmlu
ZGluZy5nZXREaW1lbnNpb25zKCkpOyAvLyROT04tTkxTLTEkCiAJCWFzc2VydEVxdWFscygiV3Jv
bmcgcXVhbGlmaWVkIG5hbWUiLCAiamF2YS5sYW5nLlN0cmluZyIsIHR5cGVCaW5kaW5nLmdldFF1
YWxpZmllZE5hbWUoKSk7IC8vJE5PTi1OTFMtMSQgLy8kTk9OLU5MUy0yJAotCQlhc3NlcnRFcXVh
bHMoIldyb25nIGRpbWVuc2lvbiIsIDEsIG1ldGhvZERlY2xhcmF0aW9uLmdldEV4dHJhRGltZW5z
aW9ucygpKTsgLy8kTk9OLU5MUy0xJAorCQlhc3NlcnRFcXVhbHMoIldyb25nIGRpbWVuc2lvbiIs
IDEsIG1ldGhvZERlY2xhcmF0aW9uLmdldEV4dHJhRGltZW5zaW9uSW5mb3MoKS5zaXplKCkpOyAv
LyROT04tTkxTLTEkCiAJCUlNZXRob2RCaW5kaW5nIG1ldGhvZEJpbmRpbmcgPSBtZXRob2REZWNs
YXJhdGlvbi5yZXNvbHZlQmluZGluZygpOwogCQlhc3NlcnROb3ROdWxsKCJObyBtZXRob2QgYmlu
ZGluZyIsIG1ldGhvZEJpbmRpbmcpOyAvLyROT04tTkxTLTEkCiAJCUlUeXBlQmluZGluZyB0eXBl
QmluZGluZzIgPSBtZXRob2RCaW5kaW5nLmdldFJldHVyblR5cGUoKTsKIAkJYXNzZXJ0Tm90TnVs
bCgiTm8gdHlwZSBiaW5kaW5nIiwgdHlwZUJpbmRpbmcyKTsgLy8kTk9OLU5MUy0xJAogCQlhc3Nl
cnRFcXVhbHMoIldyb25nIHF1YWxpZmllZCBuYW1lIiwgImphdmEubGFuZy5TdHJpbmdbXSIsIHR5
cGVCaW5kaW5nMi5nZXRRdWFsaWZpZWROYW1lKCkpOyAvLyROT04tTkxTLTEkIC8vJE5PTi1OTFMt
MiQKIAkJYXNzZXJ0RXF1YWxzKCJXcm9uZyBkaW1lbnNpb24iLCAxLCB0eXBlQmluZGluZzIuZ2V0
RGltZW5zaW9ucygpKTsgLy8kTk9OLU5MUy0xJAorCQlMaXN0IGV4dHJhRGltZW5zaW9ucyA9IG1l
dGhvZERlY2xhcmF0aW9uLmdldEV4dHJhRGltZW5zaW9uSW5mb3MoKTsKKwkJYXNzZXJ0RXh0cmFE
aW1lbnNpb25zRXF1YWwoIldyb25nIGV4dHJhIGRpbWVuc2lvbiBpbmZvIiwgZXh0cmFEaW1lbnNp
b25zLCAiW10iKTsKIAl9CiAKIAkvKioKQEAgLTk2MTMsNyArOTYyOCw3IEBACiAJCUlUeXBlQmlu
ZGluZyB0eXBlQmluZGluZyA9IHR5cGUucmVzb2x2ZUJpbmRpbmcoKTsKIAkJYXNzZXJ0Tm90TnVs
bCgiTm8gdHlwZSBiaW5kaW5nIiwgdHlwZUJpbmRpbmcpOyAvLyROT04tTkxTLTEkCiAJCWFzc2Vy
dEVxdWFscygiV3JvbmcgcXVhbGlmaWVkIG5hbWUiLCAiamF2YS5sYW5nLlN0cmluZyIsIHR5cGVC
aW5kaW5nLmdldFF1YWxpZmllZE5hbWUoKSk7IC8vJE5PTi1OTFMtMSQgLy8kTk9OLU5MUy0yJAot
CQlhc3NlcnRFcXVhbHMoIldyb25nIGRpbWVuc2lvbiIsIDAsIG1ldGhvZERlY2xhcmF0aW9uLmdl
dEV4dHJhRGltZW5zaW9ucygpKTsgLy8kTk9OLU5MUy0xJAorCQlhc3NlcnRFcXVhbHMoIldyb25n
IGRpbWVuc2lvbiIsIDAsIG1ldGhvZERlY2xhcmF0aW9uLmdldEV4dHJhRGltZW5zaW9uSW5mb3Mo
KS5zaXplKCkpOyAvLyROT04tTkxTLTEkCiAJfQogCiAKQEAgLTk2MzgsNyArOTY1Myw3IEBACiAJ
CWFzc2VydE5vdE51bGwoIk5vIHR5cGUgYmluZGluZyIsIHR5cGVCaW5kaW5nKTsgLy8kTk9OLU5M
Uy0xJAogCQlhc3NlcnRFcXVhbHMoIldyb25nIGRpbWVuc2lvbiIsIDEsIHR5cGVCaW5kaW5nLmdl
dERpbWVuc2lvbnMoKSk7IC8vJE5PTi1OTFMtMSQKIAkJYXNzZXJ0RXF1YWxzKCJXcm9uZyBxdWFs
aWZpZWQgbmFtZSIsICJqYXZhLmxhbmcuU3RyaW5nW10iLCB0eXBlQmluZGluZy5nZXRRdWFsaWZp
ZWROYW1lKCkpOyAvLyROT04tTkxTLTEkIC8vJE5PTi1OTFMtMiQKLQkJYXNzZXJ0RXF1YWxzKCJX
cm9uZyBkaW1lbnNpb24iLCAxLCBtZXRob2REZWNsYXJhdGlvbi5nZXRFeHRyYURpbWVuc2lvbnMo
KSk7IC8vJE5PTi1OTFMtMSQKKwkJYXNzZXJ0RXF1YWxzKCJXcm9uZyBkaW1lbnNpb24iLCAxLCBt
ZXRob2REZWNsYXJhdGlvbi5nZXRFeHRyYURpbWVuc2lvbkluZm9zKCkuc2l6ZSgpKTsgLy8kTk9O
LU5MUy0xJAogCQlJTWV0aG9kQmluZGluZyBtZXRob2RCaW5kaW5nID0gbWV0aG9kRGVjbGFyYXRp
b24ucmVzb2x2ZUJpbmRpbmcoKTsKIAkJYXNzZXJ0Tm90TnVsbCgiTm8gbWV0aG9kIGJpbmRpbmci
LCBtZXRob2RCaW5kaW5nKTsgLy8kTk9OLU5MUy0xJAogCQlJVHlwZUJpbmRpbmcgdHlwZUJpbmRp
bmcyID0gbWV0aG9kQmluZGluZy5nZXRSZXR1cm5UeXBlKCk7CkBAIC05NjYzLDcgKzk2NzgsNyBA
QAogCQljaGVja1NvdXJjZVJhbmdlKHNpbmdsZVZhcmlhYmxlRGVjbGFyYXRpb24sICJmaW5hbCBT
dHJpbmcgc1tdIiwgc291cmNlKTsgLy8kTk9OLU5MUy0xJAogCQlUeXBlIHR5cGUgPSBzaW5nbGVW
YXJpYWJsZURlY2xhcmF0aW9uLmdldFR5cGUoKTsKIAkJY2hlY2tTb3VyY2VSYW5nZSh0eXBlLCAi
U3RyaW5nIiwgc291cmNlKTsgLy8kTk9OLU5MUy0xJAotCQlhc3NlcnRFcXVhbHMoIldyb25nIGRp
bWVuc2lvbiIsIDEsIHNpbmdsZVZhcmlhYmxlRGVjbGFyYXRpb24uZ2V0RXh0cmFEaW1lbnNpb25z
KCkpOyAvLyROT04tTkxTLTEkCisJCWFzc2VydEVxdWFscygiV3JvbmcgZGltZW5zaW9uIiwgMSwg
c2luZ2xlVmFyaWFibGVEZWNsYXJhdGlvbi5nZXRFeHRyYURpbWVuc2lvbkluZm9zKCkuc2l6ZSgp
KTsgLy8kTk9OLU5MUy0xJAogCQlJVHlwZUJpbmRpbmcgdHlwZUJpbmRpbmcgPSB0eXBlLnJlc29s
dmVCaW5kaW5nKCk7CiAJCWFzc2VydE5vdE51bGwoIk5vIHR5cGUgYmluZGluZyIsIHR5cGVCaW5k
aW5nKTsgLy8kTk9OLU5MUy0xJAogCQlhc3NlcnRUcnVlKCJBbiBhcnJheSBiaW5kaW5nIiwgIXR5
cGVCaW5kaW5nLmlzQXJyYXkoKSk7IC8vJE5PTi1OTFMtMSQKQEAgLTk2NzcsNiArOTY5Miw4IEBA
CiAJCWFzc2VydFRydWUoIk5vdCBhbiBhcnJheSBiaW5kaW5nIiwgdHlwZUJpbmRpbmcyLmlzQXJy
YXkoKSk7IC8vJE5PTi1OTFMtMSQKIAkJYXNzZXJ0RXF1YWxzKCJXcm9uZyBkaW1lbnNpb24iLCAx
LCB0eXBlQmluZGluZzIuZ2V0RGltZW5zaW9ucygpKTsgLy8kTk9OLU5MUy0xJAogCQlhc3NlcnRF
cXVhbHMoIndyb25nIGZ1bGx5IHF1YWxpZmllZCBuYW1lIiwgImphdmEubGFuZy5TdHJpbmdbXSIs
IHR5cGVCaW5kaW5nMi5nZXRRdWFsaWZpZWROYW1lKCkpOyAvLyROT04tTkxTLTEkIC8vJE5PTi1O
TFMtMiQKKwkJTGlzdCBleHRyYURpbWVuc2lvbnMgPSBzaW5nbGVWYXJpYWJsZURlY2xhcmF0aW9u
LmdldEV4dHJhRGltZW5zaW9uSW5mb3MoKTsKKwkJYXNzZXJ0RXh0cmFEaW1lbnNpb25zRXF1YWwo
Ildyb25nIGV4dHJhIGRpbWVuc2lvbiBpbmZvIiwgZXh0cmFEaW1lbnNpb25zLCAiW10iKTsKIAl9
CiAKIAkvKioKQEAgLTk2OTUsNyArOTcxMiw3IEBACiAJCWNoZWNrU291cmNlUmFuZ2Uoc2luZ2xl
VmFyaWFibGVEZWNsYXJhdGlvbiwgImZpbmFsIFN0cmluZ1tdIFxcdTAwNzNcXHUwMDVCXVtdIiwg
c291cmNlKTsgLy8kTk9OLU5MUy0xJAogCQlUeXBlIHR5cGUgPSBzaW5nbGVWYXJpYWJsZURlY2xh
cmF0aW9uLmdldFR5cGUoKTsKIAkJY2hlY2tTb3VyY2VSYW5nZSh0eXBlLCAiU3RyaW5nW10iLCBz
b3VyY2UpOyAvLyROT04tTkxTLTEkCi0JCWFzc2VydEVxdWFscygiV3JvbmcgZGltZW5zaW9uIiwg
Miwgc2luZ2xlVmFyaWFibGVEZWNsYXJhdGlvbi5nZXRFeHRyYURpbWVuc2lvbnMoKSk7IC8vJE5P
Ti1OTFMtMSQKKwkJYXNzZXJ0RXF1YWxzKCJXcm9uZyBkaW1lbnNpb24iLCAyLCBzaW5nbGVWYXJp
YWJsZURlY2xhcmF0aW9uLmdldEV4dHJhRGltZW5zaW9uSW5mb3MoKS5zaXplKCkpOyAvLyROT04t
TkxTLTEkCiAJCUlUeXBlQmluZGluZyB0eXBlQmluZGluZyA9IHR5cGUucmVzb2x2ZUJpbmRpbmco
KTsKIAkJYXNzZXJ0Tm90TnVsbCgiTm8gdHlwZSBiaW5kaW5nIiwgdHlwZUJpbmRpbmcpOyAvLyRO
T04tTkxTLTEkCiAJCWFzc2VydFRydWUoIk5vdCBhbiBhcnJheSBiaW5kaW5nIiwgdHlwZUJpbmRp
bmcuaXNBcnJheSgpKTsgLy8kTk9OLU5MUy0xJApkaWZmIC0tZ2l0IGEvb3JnLmVjbGlwc2UuamR0
LmNvcmUudGVzdHMubW9kZWwvc3JjL29yZy9lY2xpcHNlL2pkdC9jb3JlL3Rlc3RzL2RvbS9BU1RD
b252ZXJ0ZXJUZXN0QVNUOF8yLmphdmEgYi9vcmcuZWNsaXBzZS5qZHQuY29yZS50ZXN0cy5tb2Rl
bC9zcmMvb3JnL2VjbGlwc2UvamR0L2NvcmUvdGVzdHMvZG9tL0FTVENvbnZlcnRlclRlc3RBU1Q4
XzIuamF2YQppbmRleCBjNzI1Y2I3Li5kMTRjNDRiIDEwMDY0NAotLS0gYS9vcmcuZWNsaXBzZS5q
ZHQuY29yZS50ZXN0cy5tb2RlbC9zcmMvb3JnL2VjbGlwc2UvamR0L2NvcmUvdGVzdHMvZG9tL0FT
VENvbnZlcnRlclRlc3RBU1Q4XzIuamF2YQorKysgYi9vcmcuZWNsaXBzZS5qZHQuY29yZS50ZXN0
cy5tb2RlbC9zcmMvb3JnL2VjbGlwc2UvamR0L2NvcmUvdGVzdHMvZG9tL0FTVENvbnZlcnRlclRl
c3RBU1Q4XzIuamF2YQpAQCAtMjc4Myw3ICsyNzgzLDcgQEAKIAkJTGlzdCBmcmFnbWVudHMgPSBm
aWVsZERlY2xhcmF0aW9uLmZyYWdtZW50cygpOwogCQlhc3NlcnRFcXVhbHMoIndyb25nIHNpemUi
LCAxLCBmcmFnbWVudHMuc2l6ZSgpKTsKIAkJVmFyaWFibGVEZWNsYXJhdGlvbkZyYWdtZW50IGZy
YWdtZW50ID0gKFZhcmlhYmxlRGVjbGFyYXRpb25GcmFnbWVudCkgZnJhZ21lbnRzLmdldCgwKTsK
LQkJYXNzZXJ0RXF1YWxzKCJ3cm9uZyBleHRyYSBkaW1lbnNpb24iLCAxLCBmcmFnbWVudC5nZXRF
eHRyYURpbWVuc2lvbnMoKSk7CisJCWFzc2VydEVxdWFscygid3JvbmcgZXh0cmEgZGltZW5zaW9u
IiwgMSwgZnJhZ21lbnQuZ2V0RXh0cmFEaW1lbnNpb25JbmZvcygpLnNpemUoKSk7CiAJfQogCiAJ
LyoqCmRpZmYgLS1naXQgYS9vcmcuZWNsaXBzZS5qZHQuY29yZS50ZXN0cy5tb2RlbC9zcmMvb3Jn
L2VjbGlwc2UvamR0L2NvcmUvdGVzdHMvZG9tL0FTVFN0cnVjdHVyYWxQcm9wZXJ0eVRlc3QuamF2
YSBiL29yZy5lY2xpcHNlLmpkdC5jb3JlLnRlc3RzLm1vZGVsL3NyYy9vcmcvZWNsaXBzZS9qZHQv
Y29yZS90ZXN0cy9kb20vQVNUU3RydWN0dXJhbFByb3BlcnR5VGVzdC5qYXZhCmluZGV4IDI0MDNl
OWQuLjQ3ODM2ZjAgMTAwNjQ0Ci0tLSBhL29yZy5lY2xpcHNlLmpkdC5jb3JlLnRlc3RzLm1vZGVs
L3NyYy9vcmcvZWNsaXBzZS9qZHQvY29yZS90ZXN0cy9kb20vQVNUU3RydWN0dXJhbFByb3BlcnR5
VGVzdC5qYXZhCisrKyBiL29yZy5lY2xpcHNlLmpkdC5jb3JlLnRlc3RzLm1vZGVsL3NyYy9vcmcv
ZWNsaXBzZS9qZHQvY29yZS90ZXN0cy9kb20vQVNUU3RydWN0dXJhbFByb3BlcnR5VGVzdC5qYXZh
CkBAIC0zNDYsNyArMzQ2LDcgQEAKIAkJCQkvLyBvb3BzIC0gZ3Vlc3MgdGhhdCdzIG5vdCB2YWxp
ZAogCQkJfQogCQl9Ci0JCWFzc2VydEVxdWFscygiV3JvbmcgbGFzdCBrbm93biB0eXBlIiwgODQs
IGhpKTsgLy8gbGFzdCBrbm93biBvbmUKKwkJYXNzZXJ0RXF1YWxzKCJXcm9uZyBsYXN0IGtub3du
IHR5cGUiLCA4NSwgaGkpOyAvLyBsYXN0IGtub3duIG9uZQogCQlhc3NlcnRFcXVhbHMoIldyb25n
IG51bWJlciBvZiBkaXN0aW5jdCB0eXBlcyIsICBoaSwgY2xhc3Nlcy5zaXplKCkpOyAvLyBhbGwg
Y2xhc3NlcyBhcmUgZGlzdGluY3QKIAl9CiB9CmRpZmYgLS1naXQgYS9vcmcuZWNsaXBzZS5qZHQu
Y29yZS50ZXN0cy5tb2RlbC9zcmMvb3JnL2VjbGlwc2UvamR0L2NvcmUvdGVzdHMvZG9tL0NvbnZl
cnRlclRlc3RTZXR1cC5qYXZhIGIvb3JnLmVjbGlwc2UuamR0LmNvcmUudGVzdHMubW9kZWwvc3Jj
L29yZy9lY2xpcHNlL2pkdC9jb3JlL3Rlc3RzL2RvbS9Db252ZXJ0ZXJUZXN0U2V0dXAuamF2YQpp
bmRleCBjZGJjNGEwLi5jYzg1OWIzIDEwMDY0NAotLS0gYS9vcmcuZWNsaXBzZS5qZHQuY29yZS50
ZXN0cy5tb2RlbC9zcmMvb3JnL2VjbGlwc2UvamR0L2NvcmUvdGVzdHMvZG9tL0NvbnZlcnRlclRl
c3RTZXR1cC5qYXZhCisrKyBiL29yZy5lY2xpcHNlLmpkdC5jb3JlLnRlc3RzLm1vZGVsL3NyYy9v
cmcvZWNsaXBzZS9qZHQvY29yZS90ZXN0cy9kb20vQ29udmVydGVyVGVzdFNldHVwLmphdmEKQEAg
LTEsNSArMSw1IEBACiAvKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioq
KioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKgotICogQ29weXJpZ2h0IChjKSAy
MDAwLCAyMDEyIElCTSBDb3Jwb3JhdGlvbiBhbmQgb3RoZXJzLgorICogQ29weXJpZ2h0IChjKSAy
MDAwLCAyMDEzIElCTSBDb3Jwb3JhdGlvbiBhbmQgb3RoZXJzLgogICogQWxsIHJpZ2h0cyByZXNl
cnZlZC4gVGhpcyBwcm9ncmFtIGFuZCB0aGUgYWNjb21wYW55aW5nIG1hdGVyaWFscwogICogYXJl
IG1hZGUgYXZhaWxhYmxlIHVuZGVyIHRoZSB0ZXJtcyBvZiB0aGUgRWNsaXBzZSBQdWJsaWMgTGlj
ZW5zZSB2MS4wCiAgKiB3aGljaCBhY2NvbXBhbmllcyB0aGlzIGRpc3RyaWJ1dGlvbiwgYW5kIGlz
IGF2YWlsYWJsZSBhdApAQCAtMTUsNiArMTUsNyBAQAogcGFja2FnZSBvcmcuZWNsaXBzZS5qZHQu
Y29yZS50ZXN0cy5kb207CiAKIGltcG9ydCBqYXZhLmlvLklPRXhjZXB0aW9uOworaW1wb3J0IGph
dmEudXRpbC5JdGVyYXRvcjsKIGltcG9ydCBqYXZhLnV0aWwuTGlzdDsKIGltcG9ydCBqYXZhLnV0
aWwuTWFwOwogCkBAIC0xNDEsNiArMTQyLDI2IEBACiAJCX0KIAl9CiAKKwlwcm90ZWN0ZWQgdm9p
ZCBhc3NlcnRFeHRyYURpbWVuc2lvbnNFcXVhbChTdHJpbmcgbWVzc2FnZSwgTGlzdCBkaW1lbnNp
b25zLCBTdHJpbmcgZXhwZWN0ZWQpIHsKKwkJU3RyaW5nQnVmZmVyIGJ1ZmZlciA9IG5ldyBTdHJp
bmdCdWZmZXIoKTsKKwkJSXRlcmF0b3IgaXRlciA9IGRpbWVuc2lvbnMuaXRlcmF0b3IoKTsKKwkJ
d2hpbGUoaXRlci5oYXNOZXh0KCkpIHsKKwkJCURpbWVuc2lvbkluZm8gZGltID0gKERpbWVuc2lv
bkluZm8pIGl0ZXIubmV4dCgpOworCQkJSXRlcmF0b3IgYW5ub3RhdGlvbnMgPSBkaW0uYW5ub3Rh
dGlvbnMoKS5pdGVyYXRvcigpOworCQkJd2hpbGUgKGFubm90YXRpb25zLmhhc05leHQoKSkgewor
CQkJCWJ1ZmZlci5hcHBlbmQoJ0AnKTsKKwkJCQlidWZmZXIuYXBwZW5kKCgoQW5ub3RhdGlvbikg
YW5ub3RhdGlvbnMubmV4dCgpKS5nZXRUeXBlTmFtZSgpLmdldEZ1bGx5UXVhbGlmaWVkTmFtZSgp
KTsKKwkJCQlidWZmZXIuYXBwZW5kKCcgJyk7CisJCQl9CisJCQlpZiAoaXRlci5oYXNOZXh0KCkp
IHsKKwkJCQlidWZmZXIuYXBwZW5kKCJbXSAiKTsKKwkJCX0gZWxzZSB7CisJCQkJYnVmZmVyLmFw
cGVuZCgiW10iKTsKKwkJCX0KKwkJfQorCQlhc3NlcnRFcXVhbHMobWVzc2FnZSwgZXhwZWN0ZWQs
IGJ1ZmZlci50b1N0cmluZygpKTsKKwl9CisKIAlwdWJsaWMgQVNUTm9kZSBydW5Db252ZXJzaW9u
KElDb21waWxhdGlvblVuaXQgdW5pdCwgYm9vbGVhbiByZXNvbHZlQmluZGluZ3MsCiAJCQlib29s
ZWFuIGJpbmRpbmdzUmVjb3ZlcnkpIHsKIAkJcmV0dXJuIHJ1bkNvbnZlcnNpb24oYXN0SW50ZXJu
YWxKTFMyKCksIHVuaXQsIHJlc29sdmVCaW5kaW5ncywgZmFsc2UsIGJpbmRpbmdzUmVjb3Zlcnkp
OwpkaWZmIC0tZ2l0IGEvb3JnLmVjbGlwc2UuamR0LmNvcmUudGVzdHMubW9kZWwvd29ya3NwYWNl
L0NvbnZlcnRlcjE4L3NyYy9YLmphdmEgYi9vcmcuZWNsaXBzZS5qZHQuY29yZS50ZXN0cy5tb2Rl
bC93b3Jrc3BhY2UvQ29udmVydGVyMTgvc3JjL1guamF2YQpuZXcgZmlsZSBtb2RlIDEwMDY0NApp
bmRleCAwMDAwMDAwLi41YTFhODg4Ci0tLSAvZGV2L251bGwKKysrIGIvb3JnLmVjbGlwc2UuamR0
LmNvcmUudGVzdHMubW9kZWwvd29ya3NwYWNlL0NvbnZlcnRlcjE4L3NyYy9YLmphdmEKQEAgLTAs
MCArMSw0IEBACitwdWJsaWMgY2xhc3MgWCB7CisJcHVibGljIHZvaWQgZm9vKFggdGhpcykgewor
CX0KK30KZGlmZiAtLWdpdCBhL29yZy5lY2xpcHNlLmpkdC5jb3JlL2RvbS9vcmcvZWNsaXBzZS9q
ZHQvY29yZS9kb20vQVNULmphdmEgYi9vcmcuZWNsaXBzZS5qZHQuY29yZS9kb20vb3JnL2VjbGlw
c2UvamR0L2NvcmUvZG9tL0FTVC5qYXZhCmluZGV4IDBkNWFlZDUuLjI4NWE5YTcgMTAwNjQ0Ci0t
LSBhL29yZy5lY2xpcHNlLmpkdC5jb3JlL2RvbS9vcmcvZWNsaXBzZS9qZHQvY29yZS9kb20vQVNU
LmphdmEKKysrIGIvb3JnLmVjbGlwc2UuamR0LmNvcmUvZG9tL29yZy9lY2xpcHNlL2pkdC9jb3Jl
L2RvbS9BU1QuamF2YQpAQCAtMSw1ICsxLDUgQEAKIC8qKioqKioqKioqKioqKioqKioqKioqKioq
KioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqCi0g
KiBDb3B5cmlnaHQgKGMpIDIwMDAsIDIwMTIgSUJNIENvcnBvcmF0aW9uIGFuZCBvdGhlcnMuCisg
KiBDb3B5cmlnaHQgKGMpIDIwMDAsIDIwMTMgSUJNIENvcnBvcmF0aW9uIGFuZCBvdGhlcnMuCiAg
KiBBbGwgcmlnaHRzIHJlc2VydmVkLiBUaGlzIHByb2dyYW0gYW5kIHRoZSBhY2NvbXBhbnlpbmcg
bWF0ZXJpYWxzCiAgKiBhcmUgbWFkZSBhdmFpbGFibGUgdW5kZXIgdGhlIHRlcm1zIG9mIHRoZSBF
Y2xpcHNlIFB1YmxpYyBMaWNlbnNlIHYxLjAKICAqIHdoaWNoIGFjY29tcGFuaWVzIHRoaXMgZGlz
dHJpYnV0aW9uLCBhbmQgaXMgYXZhaWxhYmxlIGF0CkBAIC0xMTE2LDYgKzExMTYsMjggQEAKIAl9
CiAKIAkvKioKKwkgKiBDcmVhdGVzIGFuZCByZXR1cm5zIGEgbmV3IHVucGFyZW50ZWQgYW5ub3Rh
dGFibGUgZGltZW5zaW9uIGluZm8gbm9kZSB3aXRoIHRoZSBnaXZlbgorCSAqIGxpc3Qgb2YgYW5u
b3RhdGlvbnMuCisJICoKKwkgKiBAcGFyYW0gYW5ub3RhdGlvbnMgdGhlIGxpc3Qgb2YgYW5ub3Rh
dGlvbnMgdGhhdCB3aWxsIGJlIGFkZGVkIHRvIHRoaXMgZGltZW5zaW9uIGluZm8gbm9kZQorCSAq
IEByZXR1cm4gYSBuZXcgdW5wYXJlbnRlZCBhbm5vdGF0YWJsZSBkaW1lbnNpb24gdHlwZSBub2Rl
CisJICogQGV4Y2VwdGlvbiBJbGxlZ2FsQXJndW1lbnRFeGNlcHRpb24gaWY6CisJICogPHVsPgor
CSAqIDxsaT50aGUgbm9kZSBiZWxvbmdzIHRvIGEgZGlmZmVyZW50IEFTVDwvbGk+CisJICogPGxp
PnRoZSBub2RlIGFscmVhZHkgaGFzIGEgcGFyZW50PC9saT4KKwkgKiA8L3VsPgorCSAqIEBzaW5j
ZSAzLjkKKwkgKi8KKwlwdWJsaWMgRGltZW5zaW9uSW5mbyBuZXdEaW1lbnNpb25JbmZvKEFubm90
YXRpb25bXSBhbm5vdGF0aW9ucykgeworCQlEaW1lbnNpb25JbmZvIHJlc3VsdCA9IG5ldyBEaW1l
bnNpb25JbmZvKHRoaXMpOworCQlpbnQgbGVuZ3RoID0gKGFubm90YXRpb25zID09IG51bGwpID8g
MCA6IGFubm90YXRpb25zLmxlbmd0aDsKKwkJZm9yIChpbnQgaSA9IDA7IGkgPCBsZW5ndGg7IGkr
KykgeworCQkJcmVzdWx0LmFubm90YXRpb25zLmFkZChhbm5vdGF0aW9uc1tpXSk7CisJCX0KKwkJ
cmV0dXJuIHJlc3VsdDsKKwl9CisKKwkvKioKIAkgKiBDcmVhdGVzIGFuZCByZXR1cm5zIGEgbmV3
IHVucGFyZW50ZWQgYXJyYXkgdHlwZSBub2RlIHdpdGggdGhlIGdpdmVuCiAJICogZWxlbWVudCB0
eXBlIGFuZCBudW1iZXIgb2YgKGFkZGl0aW9uYWwpIGRpbWVuc2lvbnMuCiAJICogPHA+CmRpZmYg
LS1naXQgYS9vcmcuZWNsaXBzZS5qZHQuY29yZS9kb20vb3JnL2VjbGlwc2UvamR0L2NvcmUvZG9t
L0FTVENvbnZlcnRlci5qYXZhIGIvb3JnLmVjbGlwc2UuamR0LmNvcmUvZG9tL29yZy9lY2xpcHNl
L2pkdC9jb3JlL2RvbS9BU1RDb252ZXJ0ZXIuamF2YQppbmRleCAzNjFhY2U2Li42ZjI4OWJkIDEw
MDY0NAotLS0gYS9vcmcuZWNsaXBzZS5qZHQuY29yZS9kb20vb3JnL2VjbGlwc2UvamR0L2NvcmUv
ZG9tL0FTVENvbnZlcnRlci5qYXZhCisrKyBiL29yZy5lY2xpcHNlLmpkdC5jb3JlL2RvbS9vcmcv
ZWNsaXBzZS9qZHQvY29yZS9kb20vQVNUQ29udmVydGVyLmphdmEKQEAgLTUwOCw3ICs1MDgsMTIg
QEAKIAkJCQkvLyBnZXQgdGhlIHBvc2l0aW9ucyBvZiB0aGUgcmlnaHQgcGFyZW50aGVzaXMKIAkJ
CQlpbnQgcmlnaHRQYXJlbnRoZXNpc1Bvc2l0aW9uID0gcmV0cmlldmVFbmRPZlJpZ2h0UGFyZW50
aGVzaXNQb3NpdGlvbihlbmQsIG1ldGhvZC5ib2R5RW5kKTsKIAkJCQlpbnQgZXh0cmFEaW1lbnNp
b25zID0gcmV0cmlldmVFeHRyYURpbWVuc2lvbihyaWdodFBhcmVudGhlc2lzUG9zaXRpb24sIG1l
dGhvZC5ib2R5RW5kKTsKLQkJCQltZXRob2REZWNsLnNldEV4dHJhRGltZW5zaW9ucyhleHRyYURp
bWVuc2lvbnMpOworCQkJCWlmICh0aGlzLmFzdC5hcGlMZXZlbCA+PSBBU1QuSkxTOCkgeworCQkJ
CQlzZXRFeHRyYUFubm90YXRlZERpbWVuc2lvbnMocmlnaHRQYXJlbnRoZXNpc1Bvc2l0aW9uLCB0
aGlzLnNjYW5uZXIuY3VycmVudFBvc2l0aW9uLCB0eXBlUmVmZXJlbmNlLAorCQkJCQkJCQkJCQkJ
bWV0aG9kRGVjbC5leHRyYURpbWVuc2lvbkluZm9zLCBleHRyYURpbWVuc2lvbnMpOworCQkJCX0g
ZWxzZSB7CisJCQkJCW1ldGhvZERlY2wuc2V0RXh0cmFEaW1lbnNpb25zKGV4dHJhRGltZW5zaW9u
cyk7CisJCQkJfQogCQkJCXNldFR5cGVGb3JNZXRob2REZWNsYXJhdGlvbihtZXRob2REZWNsLCBy
ZXR1cm5UeXBlLCBleHRyYURpbWVuc2lvbnMpOwogCQkJfSBlbHNlIHsKIAkJCQkvLyBubyByZXR1
cm4gdHlwZSBmb3IgYSBtZXRob2QgdGhhdCBpcyBub3QgYSBjb25zdHJ1Y3RvcgpAQCAtODI5LDcg
KzgzNCwxMiBAQAogCQl2YXJpYWJsZURlY2wuc2V0TmFtZShuYW1lKTsKIAkJZmluYWwgaW50IHR5
cGVTb3VyY2VFbmQgPSBhcmd1bWVudC50eXBlLnNvdXJjZUVuZDsKIAkJZmluYWwgaW50IGV4dHJh
RGltZW5zaW9ucyA9IHJldHJpZXZlRXh0cmFEaW1lbnNpb24obmFtZUVuZCArIDEsIHR5cGVTb3Vy
Y2VFbmQpOwotCQl2YXJpYWJsZURlY2wuc2V0RXh0cmFEaW1lbnNpb25zKGV4dHJhRGltZW5zaW9u
cyk7CisJCWlmICh0aGlzLmFzdC5hcGlMZXZlbCA+PSBBU1QuSkxTOCkgeworCQkJc2V0RXh0cmFB
bm5vdGF0ZWREaW1lbnNpb25zKG5hbWVFbmQgKyAxLCB0aGlzLnNjYW5uZXIuY3VycmVudFBvc2l0
aW9uLCBhcmd1bWVudC50eXBlLAorCQkJCQkJCQkJCXZhcmlhYmxlRGVjbC5leHRyYURpbWVuc2lv
bkluZm9zLCBleHRyYURpbWVuc2lvbnMpOworCQl9IGVsc2UgeworCQkJdmFyaWFibGVEZWNsLnNl
dEV4dHJhRGltZW5zaW9ucyhleHRyYURpbWVuc2lvbnMpOworCQl9CiAJCWZpbmFsIGJvb2xlYW4g
aXNWYXJBcmdzID0gYXJndW1lbnQuaXNWYXJBcmdzKCk7CiAJCWlmIChpc1ZhckFyZ3MgJiYgZXh0
cmFEaW1lbnNpb25zID09IDApIHsKIAkJCS8vIHJlbW92ZSB0aGUgZWxsaXBzaXMgZnJvbSB0aGUg
dHlwZSBzb3VyY2UgZW5kCkBAIC0yOTQ0LDcgKzI5NTQsOSBAQAogCQl9CiAJCWZpZWxkRGVjbGFy
YXRpb24uc2V0U291cmNlUmFuZ2UoZmllbGREZWNsLmRlY2xhcmF0aW9uU291cmNlU3RhcnQsIGZp
ZWxkRGVjbC5kZWNsYXJhdGlvbkVuZCAtIGZpZWxkRGVjbC5kZWNsYXJhdGlvblNvdXJjZVN0YXJ0
ICsgMSk7CiAJCVR5cGUgdHlwZSA9IGNvbnZlcnRUeXBlKGZpZWxkRGVjbC50eXBlKTsKLQkJc2V0
VHlwZUZvckZpZWxkKGZpZWxkRGVjbGFyYXRpb24sIHR5cGUsIHZhcmlhYmxlRGVjbGFyYXRpb25G
cmFnbWVudC5nZXRFeHRyYURpbWVuc2lvbnMoKSk7CisJCXNldFR5cGVGb3JGaWVsZChmaWVsZERl
Y2xhcmF0aW9uLCB0eXBlLCAKKwkJCQkodGhpcy5hc3QuYXBpTGV2ZWwgPCBBU1QuSkxTOCkgPyB2
YXJpYWJsZURlY2xhcmF0aW9uRnJhZ21lbnQuZ2V0RXh0cmFEaW1lbnNpb25zKCkgCisJCQkJCQk6
IHZhcmlhYmxlRGVjbGFyYXRpb25GcmFnbWVudC5nZXRFeHRyYURpbWVuc2lvbkluZm9zKCkuc2l6
ZSgpKTsKIAkJc2V0TW9kaWZpZXJzKGZpZWxkRGVjbGFyYXRpb24sIGZpZWxkRGVjbCk7CiAJCWNv
bnZlcnQoZmllbGREZWNsLmphdmFkb2MsIGZpZWxkRGVjbGFyYXRpb24pOwogCQlyZXR1cm4gZmll
bGREZWNsYXJhdGlvbjsKQEAgLTI5NzUsNyArMjk4NywxMCBAQAogCQl9CiAJCXZhcmlhYmxlRGVj
bGFyYXRpb25FeHByZXNzaW9uLnNldFNvdXJjZVJhbmdlKGxvY2FsRGVjbGFyYXRpb24uZGVjbGFy
YXRpb25Tb3VyY2VTdGFydCwgbG9jYWxEZWNsYXJhdGlvbi5kZWNsYXJhdGlvblNvdXJjZUVuZCAt
IGxvY2FsRGVjbGFyYXRpb24uZGVjbGFyYXRpb25Tb3VyY2VTdGFydCArIDEpOwogCQlUeXBlIHR5
cGUgPSBjb252ZXJ0VHlwZShsb2NhbERlY2xhcmF0aW9uLnR5cGUpOwotCQlzZXRUeXBlRm9yVmFy
aWFibGVEZWNsYXJhdGlvbkV4cHJlc3Npb24odmFyaWFibGVEZWNsYXJhdGlvbkV4cHJlc3Npb24s
IHR5cGUsIHZhcmlhYmxlRGVjbGFyYXRpb25GcmFnbWVudC5nZXRFeHRyYURpbWVuc2lvbnMoKSk7
CisJCXNldFR5cGVGb3JWYXJpYWJsZURlY2xhcmF0aW9uRXhwcmVzc2lvbigKKwkJCQkJdmFyaWFi
bGVEZWNsYXJhdGlvbkV4cHJlc3Npb24sIHR5cGUsCisJCQkJCSh0aGlzLmFzdC5hcGlMZXZlbCA8
IEFTVC5KTFM4KSA/IHZhcmlhYmxlRGVjbGFyYXRpb25GcmFnbWVudC5nZXRFeHRyYURpbWVuc2lv
bnMoKQorCQkJCQk6IHZhcmlhYmxlRGVjbGFyYXRpb25GcmFnbWVudC5nZXRFeHRyYURpbWVuc2lv
bkluZm9zKCkuc2l6ZSgpKTsKIAkJaWYgKGxvY2FsRGVjbGFyYXRpb24ubW9kaWZpZXJzU291cmNl
U3RhcnQgIT0gLTEpIHsKIAkJCXNldE1vZGlmaWVycyh2YXJpYWJsZURlY2xhcmF0aW9uRXhwcmVz
c2lvbiwgbG9jYWxEZWNsYXJhdGlvbik7CiAJCX0KQEAgLTI5OTIsNyArMzAwNywxMiBAQAogCQlu
YW1lLnNldFNvdXJjZVJhbmdlKHN0YXJ0LCBuYW1lRW5kIC0gc3RhcnQgKyAxKTsKIAkJdmFyaWFi
bGVEZWNsLnNldE5hbWUobmFtZSk7CiAJCWZpbmFsIGludCBleHRyYURpbWVuc2lvbnMgPSByZXRy
aWV2ZUV4dHJhRGltZW5zaW9uKG5hbWVFbmQgKyAxLCBsb2NhbERlY2xhcmF0aW9uLnR5cGUuc291
cmNlRW5kKTsKLQkJdmFyaWFibGVEZWNsLnNldEV4dHJhRGltZW5zaW9ucyhleHRyYURpbWVuc2lv
bnMpOworCQlpZiAodGhpcy5hc3QuYXBpTGV2ZWwgPj0gQVNULkpMUzgpIHsKKwkJCXNldEV4dHJh
QW5ub3RhdGVkRGltZW5zaW9ucyhuYW1lRW5kICsgMSwgdGhpcy5zY2FubmVyLmN1cnJlbnRQb3Np
dGlvbiwgbG9jYWxEZWNsYXJhdGlvbi50eXBlLAorCQkJCQl2YXJpYWJsZURlY2wuZXh0cmFEaW1l
bnNpb25JbmZvcywgZXh0cmFEaW1lbnNpb25zKTsKKwkJfSBlbHNlIHsKKwkJCXZhcmlhYmxlRGVj
bC5zZXRFeHRyYURpbWVuc2lvbnMoZXh0cmFEaW1lbnNpb25zKTsKKwkJfQogCQlUeXBlIHR5cGUg
PSBjb252ZXJ0VHlwZShsb2NhbERlY2xhcmF0aW9uLnR5cGUpOwogCQlpbnQgdHlwZUVuZCA9IHR5
cGUuZ2V0U3RhcnRQb3NpdGlvbigpICsgdHlwZS5nZXRMZW5ndGgoKSAtIDE7CiAJCWludCByaWdo
dEVuZCA9IE1hdGgubWF4KHR5cGVFbmQsIGxvY2FsRGVjbGFyYXRpb24uZGVjbGFyYXRpb25Tb3Vy
Y2VFbmQpOwpAQCAtMzAxMCw2ICszMDMwLDE3IEBACiAJCXJldHVybiB2YXJpYWJsZURlY2w7CiAJ
fQogCisJcHJpdmF0ZSBEaW1lbnNpb25JbmZvIGNvbnZlcnRUb0RpbWVuc2lvbkluZm8oaW50IHN0
YXJ0LCBpbnQgZW5kLCBvcmcuZWNsaXBzZS5qZHQuaW50ZXJuYWwuY29tcGlsZXIuYXN0LkFubm90
YXRpb25bXSBhbm5vdGF0aW9uKSB7CisJCWludCBsZW5ndGggPSBhbm5vdGF0aW9uID09IG51bGwg
PyAwIDogYW5ub3RhdGlvbi5sZW5ndGg7CisJCUFubm90YXRpb25bXSBhbm5vdGF0aW9ucyA9IG5l
dyBBbm5vdGF0aW9uW2xlbmd0aF07CisJCWZvciAoaW50IGkgPSAwOyBpIDwgbGVuZ3RoOyBpKysp
IHsKKwkJCWFubm90YXRpb25zW2ldID0gY29udmVydChhbm5vdGF0aW9uW2ldKTsKKwkJfQorCQlE
aW1lbnNpb25JbmZvIGRpbWVuc2lvbiA9IHRoaXMuYXN0Lm5ld0RpbWVuc2lvbkluZm8oYW5ub3Rh
dGlvbnMpOworCQlyZXRyaWV2ZURpbWVuc2lvbkFuZFNldFBvc2l0aW9ucyhzdGFydCwgZW5kLCBk
aW1lbnNpb24pOworCQlyZXR1cm4gZGltZW5zaW9uOworCX0KKwogCXByb3RlY3RlZCBWYXJpYWJs
ZURlY2xhcmF0aW9uRnJhZ21lbnQgY29udmVydFRvVmFyaWFibGVEZWNsYXJhdGlvbkZyYWdtZW50
KG9yZy5lY2xpcHNlLmpkdC5pbnRlcm5hbC5jb21waWxlci5hc3QuRmllbGREZWNsYXJhdGlvbiBm
aWVsZERlY2xhcmF0aW9uKSB7CiAJCWZpbmFsIFZhcmlhYmxlRGVjbGFyYXRpb25GcmFnbWVudCB2
YXJpYWJsZURlY2xhcmF0aW9uRnJhZ21lbnQgPSBuZXcgVmFyaWFibGVEZWNsYXJhdGlvbkZyYWdt
ZW50KHRoaXMuYXN0KTsKIAkJZmluYWwgU2ltcGxlTmFtZSBuYW1lID0gbmV3IFNpbXBsZU5hbWUo
dGhpcy5hc3QpOwpAQCAtMzAxOSw3ICszMDUwLDEyIEBACiAJCWludCBzdGFydCA9IGZpZWxkRGVj
bGFyYXRpb24uc291cmNlRW5kOwogCQlpbnQgZW5kID0gc3RhcnQ7CiAJCWludCBleHRyYURpbWVu
c2lvbnMgPSByZXRyaWV2ZUV4dHJhRGltZW5zaW9uKGZpZWxkRGVjbGFyYXRpb24uc291cmNlRW5k
ICsgMSwgZmllbGREZWNsYXJhdGlvbi5kZWNsYXJhdGlvblNvdXJjZUVuZCApOwotCQl2YXJpYWJs
ZURlY2xhcmF0aW9uRnJhZ21lbnQuc2V0RXh0cmFEaW1lbnNpb25zKGV4dHJhRGltZW5zaW9ucyk7
CisJCWlmICh0aGlzLmFzdC5hcGlMZXZlbCA+PSBBU1QuSkxTOCkgeworCQkJc2V0RXh0cmFBbm5v
dGF0ZWREaW1lbnNpb25zKGZpZWxkRGVjbGFyYXRpb24uc291cmNlRW5kICsgMSwgdGhpcy5zY2Fu
bmVyLmN1cnJlbnRQb3NpdGlvbiwKKwkJCQkJZmllbGREZWNsYXJhdGlvbi50eXBlLCB2YXJpYWJs
ZURlY2xhcmF0aW9uRnJhZ21lbnQuZXh0cmFEaW1lbnNpb25JbmZvcywgZXh0cmFEaW1lbnNpb25z
KTsKKwkJfSBlbHNlIHsKKwkJCXZhcmlhYmxlRGVjbGFyYXRpb25GcmFnbWVudC5zZXRFeHRyYURp
bWVuc2lvbnMoZXh0cmFEaW1lbnNpb25zKTsKKwkJfQogCQlpZiAoZmllbGREZWNsYXJhdGlvbi5p
bml0aWFsaXphdGlvbiAhPSBudWxsKSB7CiAJCQlmaW5hbCBFeHByZXNzaW9uIGV4cHJlc3Npb24g
PSBjb252ZXJ0KGZpZWxkRGVjbGFyYXRpb24uaW5pdGlhbGl6YXRpb24pOwogCQkJdmFyaWFibGVE
ZWNsYXJhdGlvbkZyYWdtZW50LnNldEluaXRpYWxpemVyKGV4cHJlc3Npb24pOwpAQCAtMzA1Nyw3
ICszMDkzLDEzIEBACiAJCWludCBzdGFydCA9IGxvY2FsRGVjbGFyYXRpb24uc291cmNlRW5kOwog
CQlvcmcuZWNsaXBzZS5qZHQuaW50ZXJuYWwuY29tcGlsZXIuYXN0LkV4cHJlc3Npb24gaW5pdGlh
bGl6YXRpb24gPSBsb2NhbERlY2xhcmF0aW9uLmluaXRpYWxpemF0aW9uOwogCQlpbnQgZXh0cmFE
aW1lbnNpb24gPSByZXRyaWV2ZUV4dHJhRGltZW5zaW9uKGxvY2FsRGVjbGFyYXRpb24uc291cmNl
RW5kICsgMSwgdGhpcy5jb21waWxhdGlvblVuaXRTb3VyY2VMZW5ndGgpOwotCQl2YXJpYWJsZURl
Y2xhcmF0aW9uRnJhZ21lbnQuc2V0RXh0cmFEaW1lbnNpb25zKGV4dHJhRGltZW5zaW9uKTsKKwkJ
aWYgKHRoaXMuYXN0LmFwaUxldmVsID49IEFTVC5KTFM4KSB7CisJCQlzZXRFeHRyYUFubm90YXRl
ZERpbWVuc2lvbnMobG9jYWxEZWNsYXJhdGlvbi5zb3VyY2VFbmQgKyAxLCB0aGlzLnNjYW5uZXIu
Y3VycmVudFBvc2l0aW9uLAorCQkJCQlsb2NhbERlY2xhcmF0aW9uLnR5cGUsIHZhcmlhYmxlRGVj
bGFyYXRpb25GcmFnbWVudC5leHRyYURpbWVuc2lvbkluZm9zLCBleHRyYURpbWVuc2lvbik7CisJ
CX0gZWxzZSB7CisJCQl2YXJpYWJsZURlY2xhcmF0aW9uRnJhZ21lbnQuc2V0RXh0cmFEaW1lbnNp
b25zKGV4dHJhRGltZW5zaW9uKTsKKwkJfQorCiAJCWJvb2xlYW4gaGFzSW5pdGlhbGl6YXRpb24g
PSBpbml0aWFsaXphdGlvbiAhPSBudWxsOwogCQlpbnQgZW5kOwogCQlpZiAoaGFzSW5pdGlhbGl6
YXRpb24pIHsKQEAgLTMwODgsNiArMzEzMCwxOCBAQAogCQlyZXR1cm4gdmFyaWFibGVEZWNsYXJh
dGlvbkZyYWdtZW50OwogCX0KIAorCXByb3RlY3RlZCB2b2lkIHNldEV4dHJhQW5ub3RhdGVkRGlt
ZW5zaW9ucyhpbnQgc3RhcnQsIGludCBlbmQsIFR5cGVSZWZlcmVuY2UgdHlwZSwgZmluYWwgTGlz
dCBleHRyYUFubm90YXRlZERpbWVuc2lvbnMsIGludCBleHRyYURpbWVuc2lvbikgeworCQlpZiAo
ZXh0cmFEaW1lbnNpb24gPiAwKSB7CisJCQlvcmcuZWNsaXBzZS5qZHQuaW50ZXJuYWwuY29tcGls
ZXIuYXN0LkFubm90YXRpb25bXVtdIGFubm90YXRpb25zT25EaW1zID0gdHlwZS5nZXRBbm5vdGF0
aW9uc09uRGltZW5zaW9ucygpOworCQkJaW50IGxlbmd0aCA9IChhbm5vdGF0aW9uc09uRGltcyA9
PSBudWxsKSA/IDAgOiBhbm5vdGF0aW9uc09uRGltcy5sZW5ndGg7CisJCQlmb3IgKGludCBpID0g
KGxlbmd0aCAtIGV4dHJhRGltZW5zaW9uKTsgaSA8IGxlbmd0aDsgaSsrKSB7CisJCQkJRGltZW5z
aW9uSW5mbyBkaW0gPSBjb252ZXJ0VG9EaW1lbnNpb25JbmZvKHN0YXJ0LCBlbmQsIChhbm5vdGF0
aW9uc09uRGltcyA9PSBudWxsKSA/IG51bGwgOiBhbm5vdGF0aW9uc09uRGltc1tpXSk7CisJCQkJ
ZXh0cmFBbm5vdGF0ZWREaW1lbnNpb25zLmFkZChkaW0pOworCQkJCXN0YXJ0ID0gZGltLmdldFN0
YXJ0UG9zaXRpb24oKSArIGRpbS5nZXRMZW5ndGgoKTsKKwkJCX0KKwkJfQorCX0KKwogCXByb3Rl
Y3RlZCBWYXJpYWJsZURlY2xhcmF0aW9uU3RhdGVtZW50IGNvbnZlcnRUb1ZhcmlhYmxlRGVjbGFy
YXRpb25TdGF0ZW1lbnQob3JnLmVjbGlwc2UuamR0LmludGVybmFsLmNvbXBpbGVyLmFzdC5Mb2Nh
bERlY2xhcmF0aW9uIGxvY2FsRGVjbGFyYXRpb24pIHsKIAkJZmluYWwgVmFyaWFibGVEZWNsYXJh
dGlvbkZyYWdtZW50IHZhcmlhYmxlRGVjbGFyYXRpb25GcmFnbWVudCA9IGNvbnZlcnRUb1Zhcmlh
YmxlRGVjbGFyYXRpb25GcmFnbWVudChsb2NhbERlY2xhcmF0aW9uKTsKIAkJZmluYWwgVmFyaWFi
bGVEZWNsYXJhdGlvblN0YXRlbWVudCB2YXJpYWJsZURlY2xhcmF0aW9uU3RhdGVtZW50ID0gbmV3
IFZhcmlhYmxlRGVjbGFyYXRpb25TdGF0ZW1lbnQodGhpcy5hc3QpOwpAQCAtMzA5Nyw3ICszMTUx
LDkgQEAKIAkJfQogCQl2YXJpYWJsZURlY2xhcmF0aW9uU3RhdGVtZW50LnNldFNvdXJjZVJhbmdl
KGxvY2FsRGVjbGFyYXRpb24uZGVjbGFyYXRpb25Tb3VyY2VTdGFydCwgbG9jYWxEZWNsYXJhdGlv
bi5kZWNsYXJhdGlvblNvdXJjZUVuZCAtIGxvY2FsRGVjbGFyYXRpb24uZGVjbGFyYXRpb25Tb3Vy
Y2VTdGFydCArIDEpOwogCQlUeXBlIHR5cGUgPSBjb252ZXJ0VHlwZShsb2NhbERlY2xhcmF0aW9u
LnR5cGUpOwotCQlzZXRUeXBlRm9yVmFyaWFibGVEZWNsYXJhdGlvblN0YXRlbWVudCh2YXJpYWJs
ZURlY2xhcmF0aW9uU3RhdGVtZW50LCB0eXBlLCB2YXJpYWJsZURlY2xhcmF0aW9uRnJhZ21lbnQu
Z2V0RXh0cmFEaW1lbnNpb25zKCkpOworCQlzZXRUeXBlRm9yVmFyaWFibGVEZWNsYXJhdGlvblN0
YXRlbWVudCh2YXJpYWJsZURlY2xhcmF0aW9uU3RhdGVtZW50LCB0eXBlLCAKKwkJCQkodGhpcy5h
c3QuYXBpTGV2ZWwgPCBBU1QuSkxTOCkgPyB2YXJpYWJsZURlY2xhcmF0aW9uRnJhZ21lbnQuZ2V0
RXh0cmFEaW1lbnNpb25zKCkgCisJCQkJCQk6IHZhcmlhYmxlRGVjbGFyYXRpb25GcmFnbWVudC5n
ZXRFeHRyYURpbWVuc2lvbkluZm9zKCkuc2l6ZSgpKTsKIAkJaWYgKGxvY2FsRGVjbGFyYXRpb24u
bW9kaWZpZXJzU291cmNlU3RhcnQgIT0gLTEpIHsKIAkJCXNldE1vZGlmaWVycyh2YXJpYWJsZURl
Y2xhcmF0aW9uU3RhdGVtZW50LCBsb2NhbERlY2xhcmF0aW9uKTsKIAkJfQpAQCAtNDM0NCwxNCAr
NDQwMCwyNiBAQAogCQlpbnQgZGltZW5zaW9ucyA9IDA7CiAJCXRyeSB7CiAJCQlpbnQgdG9rZW47
CisJCQlib29sZWFuIGlzQW5ub3RhdGlvbiA9IGZhbHNlOwogCQkJd2hpbGUgKCh0b2tlbiA9IHRo
aXMuc2Nhbm5lci5nZXROZXh0VG9rZW4oKSkgIT0gVGVybWluYWxUb2tlbnMuVG9rZW5OYW1lRU9G
KSB7CiAJCQkJc3dpdGNoKHRva2VuKSB7CiAJCQkJCWNhc2UgVGVybWluYWxUb2tlbnMuVG9rZW5O
YW1lTEJSQUNLRVQ6CiAJCQkJCWNhc2UgVGVybWluYWxUb2tlbnMuVG9rZW5OYW1lQ09NTUVOVF9C
TE9DSzoKIAkJCQkJY2FzZSBUZXJtaW5hbFRva2Vucy5Ub2tlbk5hbWVDT01NRU5UX0pBVkFET0M6
CiAJCQkJCWNhc2UgVGVybWluYWxUb2tlbnMuVG9rZW5OYW1lQ09NTUVOVF9MSU5FOgorCQkJCQkJ
aXNBbm5vdGF0aW9uID0gZmFsc2U7CisJCQkJCQlicmVhazsKKwkJCQkJY2FzZSBUZXJtaW5hbFRv
a2Vucy5Ub2tlbk5hbWVBVDoKKwkJCQkJCWlzQW5ub3RhdGlvbiA9IHRydWU7CisJCQkJCQlicmVh
azsKKwkJCQkJY2FzZSBUZXJtaW5hbFRva2Vucy5Ub2tlbk5hbWVJZGVudGlmaWVyOgorCQkJCQkJ
aWYgKCFpc0Fubm90YXRpb24pIHsKKwkJCQkJCQlyZXR1cm4gZGltZW5zaW9uczsKKwkJCQkJCX0K
KwkJCQkJCWlzQW5ub3RhdGlvbiA9IGZhbHNlOwogCQkJCQkJYnJlYWs7CiAJCQkJCWNhc2UgVGVy
bWluYWxUb2tlbnMuVG9rZW5OYW1lUkJSQUNLRVQ6Ly8xNjYKKwkJCQkJCWlzQW5ub3RhdGlvbiA9
IGZhbHNlOwogCQkJCQkJZGltZW5zaW9ucysrOwogCQkJCQkJYnJlYWs7CiAJCQkJCWRlZmF1bHQ6
CkBAIC00MzY0LDYgKzQ0MzIsMzEgQEAKIAkJcmV0dXJuIGRpbWVuc2lvbnM7CiAJfQogCisJcHJv
dGVjdGVkIHZvaWQgcmV0cmlldmVEaW1lbnNpb25BbmRTZXRQb3NpdGlvbnMoaW50IHN0YXJ0LCBp
bnQgZW5kLCBEaW1lbnNpb25JbmZvIGRpbSkgeworCQl0aGlzLnNjYW5uZXIucmVzZXRUbyhzdGFy
dCwgZW5kKTsKKwkJaW50IHRva2VuOworCQlib29sZWFuIHN0YXJ0U2V0ID0gZmFsc2U7CisJCXRy
eSB7CisJCQl3aGlsZSgodG9rZW4gPSB0aGlzLnNjYW5uZXIuZ2V0TmV4dFRva2VuKCkpICE9IFRl
cm1pbmFsVG9rZW5zLlRva2VuTmFtZUVPRikgIHsKKwkJCQlzd2l0Y2godG9rZW4pIHsKKwkJCQkJ
Y2FzZSBUZXJtaW5hbFRva2Vucy5Ub2tlbk5hbWVXSElURVNQQUNFOgorCQkJCQkJYnJlYWs7CisJ
CQkJCWNhc2UgVGVybWluYWxUb2tlbnMuVG9rZW5OYW1lUkJSQUNLRVQ6CisJCQkJCQlpbnQgZW5k
RGltID0gdGhpcy5zY2FubmVyLmN1cnJlbnRQb3NpdGlvbiAtIDE7CisJCQkJCQlkaW0uc2V0U291
cmNlUmFuZ2Uoc3RhcnQsIGVuZERpbSAtIHN0YXJ0ICsgMSk7CisJCQkJCQlyZXR1cm47CisJCQkJ
CWRlZmF1bHQ6CisJCQkJCQlpZiAoIXN0YXJ0U2V0KSB7CisJCQkJCQkJc3RhcnQgPSB0aGlzLnNj
YW5uZXIuc3RhcnRQb3NpdGlvbjsKKwkJCQkJCQlzdGFydFNldCA9IHRydWU7CisJCQkJCQl9CisJ
CQkJCQlicmVhazsKKwkJCQl9CisJCQl9CisJCX0gY2F0Y2goSW52YWxpZElucHV0RXhjZXB0aW9u
IGUpIHsKKwkJCS8vIGlnbm9yZQorCQl9CisJfQogCXByb3RlY3RlZCB2b2lkIHJldHJpZXZlSWRl
bnRpZmllckFuZFNldFBvc2l0aW9ucyhpbnQgc3RhcnQsIGludCBlbmQsIE5hbWUgbmFtZSkgewog
CQl0aGlzLnNjYW5uZXIucmVzZXRUbyhzdGFydCwgZW5kKTsKIAkJaW50IHRva2VuOwpAQCAtNTI3
Nyw3ICs1MzcwLDcgQEAKIAkJCQkJCQlicmVhazsKIAkJCQkJCWRlZmF1bHQgOgogCQkJCQkJCW1l
dGhvZERlY2xhcmF0aW9uLnNldFJldHVyblR5cGUyKHN1YmFycmF5VHlwZSk7Ci0JCQkJCQlicmVh
azsKKwkJCQkJCQlicmVhazsKIAkJCQkJfQogCQkJCQl0aGlzLmFzdC5nZXRCaW5kaW5nUmVzb2x2
ZXIoKS51cGRhdGVLZXkodHlwZSwgc3ViYXJyYXlUeXBlKTsKIAkJCQl9CmRpZmYgLS1naXQgYS9v
cmcuZWNsaXBzZS5qZHQuY29yZS9kb20vb3JnL2VjbGlwc2UvamR0L2NvcmUvZG9tL0FTVE1hdGNo
ZXIuamF2YSBiL29yZy5lY2xpcHNlLmpkdC5jb3JlL2RvbS9vcmcvZWNsaXBzZS9qZHQvY29yZS9k
b20vQVNUTWF0Y2hlci5qYXZhCmluZGV4IDk1YzJlNDcuLmUxYmMyYTUgMTAwNjQ0Ci0tLSBhL29y
Zy5lY2xpcHNlLmpkdC5jb3JlL2RvbS9vcmcvZWNsaXBzZS9qZHQvY29yZS9kb20vQVNUTWF0Y2hl
ci5qYXZhCisrKyBiL29yZy5lY2xpcHNlLmpkdC5jb3JlL2RvbS9vcmcvZWNsaXBzZS9qZHQvY29y
ZS9kb20vQVNUTWF0Y2hlci5qYXZhCkBAIC0zNTQsNiArMzU0LDI5IEBACiAJICogQHJldHVybiA8
Y29kZT50cnVlPC9jb2RlPiBpZiB0aGUgc3VidHJlZSBtYXRjaGVzLCBvcgogCSAqICAgPGNvZGU+
ZmFsc2U8L2NvZGU+IGlmIHRoZXkgZG8gbm90IG1hdGNoIG9yIHRoZSBvdGhlciBvYmplY3QgaGFz
IGEKIAkgKiAgIGRpZmZlcmVudCBub2RlIHR5cGUgb3IgaXMgPGNvZGU+bnVsbDwvY29kZT4KKwkg
KiBAc2luY2UgMy45CisJICovCisJcHVibGljIGJvb2xlYW4gbWF0Y2goRGltZW5zaW9uSW5mbyBu
b2RlLCBPYmplY3Qgb3RoZXIpIHsKKwkJaWYgKCEob3RoZXIgaW5zdGFuY2VvZiBEaW1lbnNpb25J
bmZvKSkKKwkJCXJldHVybiBmYWxzZTsKKwkJRGltZW5zaW9uSW5mbyBvID0gKERpbWVuc2lvbklu
Zm8pIG90aGVyOworCQlyZXR1cm4gc2FmZVN1YnRyZWVMaXN0TWF0Y2gobm9kZS5hbm5vdGF0aW9u
cygpLCBvLmFubm90YXRpb25zKCkpCisJCQkJJiYgc2FmZVN1YnRyZWVNYXRjaChub2RlLmV4cHJl
c3Npb24oKSwgby5leHByZXNzaW9uKCkpOworCX0KKworCS8qKgorCSAqIFJldHVybnMgd2hldGhl
ciB0aGUgZ2l2ZW4gbm9kZSBhbmQgdGhlIG90aGVyIG9iamVjdCBtYXRjaC4KKwkgKiA8cD4KKwkg
KiBUaGUgZGVmYXVsdCBpbXBsZW1lbnRhdGlvbiBwcm92aWRlZCBieSB0aGlzIGNsYXNzIHRlc3Rz
IHdoZXRoZXIgdGhlCisJICogb3RoZXIgb2JqZWN0IGlzIGEgbm9kZSBvZiB0aGUgc2FtZSB0eXBl
IHdpdGggc3RydWN0dXJhbGx5IGlzb21vcnBoaWMKKwkgKiBjaGlsZCBzdWJ0cmVlcy4gU3ViY2xh
c3NlcyBtYXkgb3ZlcnJpZGUgdGhpcyBtZXRob2QgYXMgbmVlZGVkLgorCSAqIDwvcD4KKwkgKgor
CSAqIEBwYXJhbSBub2RlIHRoZSBub2RlCisJICogQHBhcmFtIG90aGVyIHRoZSBvdGhlciBvYmpl
Y3QsIG9yIDxjb2RlPm51bGw8L2NvZGU+CisJICogQHJldHVybiA8Y29kZT50cnVlPC9jb2RlPiBp
ZiB0aGUgc3VidHJlZSBtYXRjaGVzLCBvcgorCSAqICAgPGNvZGU+ZmFsc2U8L2NvZGU+IGlmIHRo
ZXkgZG8gbm90IG1hdGNoIG9yIHRoZSBvdGhlciBvYmplY3QgaGFzIGEKKwkgKiAgIGRpZmZlcmVu
dCBub2RlIHR5cGUgb3IgaXMgPGNvZGU+bnVsbDwvY29kZT4KIAkgKi8KIAlwdWJsaWMgYm9vbGVh
biBtYXRjaChBc3NlcnRTdGF0ZW1lbnQgbm9kZSwgT2JqZWN0IG90aGVyKSB7CiAJCWlmICghKG90
aGVyIGluc3RhbmNlb2YgQXNzZXJ0U3RhdGVtZW50KSkgewpAQCAtMTM5OSwxMCArMTQyMiwxMSBA
QAogCQkJCSYmIHNhZmVTdWJ0cmVlTWF0Y2gobm9kZS5nZXROYW1lKCksIG8uZ2V0TmFtZSgpKQog
CQkJCS8vIG4uYi4gY29tcGFyZSByZXR1cm4gdHlwZSBldmVuIGZvciBjb25zdHJ1Y3RvcnMKIAkJ
CQkmJiBzYWZlU3VidHJlZUxpc3RNYXRjaChub2RlLnBhcmFtZXRlcnMoKSwgby5wYXJhbWV0ZXJz
KCkpCi0JIAkJCSYmIG5vZGUuZ2V0RXh0cmFEaW1lbnNpb25zKCkgPT0gby5nZXRFeHRyYURpbWVu
c2lvbnMoKQotCQkJCSYmIChub2RlLmdldEFTVCgpLmFwaUxldmVsKCkgPCBBU1QuSkxTOCA/IAot
CQkJCQkJc2FmZVN1YnRyZWVMaXN0TWF0Y2gobm9kZS50aHJvd25FeGNlcHRpb25zKCksIG8udGhy
b3duRXhjZXB0aW9ucygpKSA6Ci0JCQkJCQlzYWZlU3VidHJlZUxpc3RNYXRjaChub2RlLnRocm93
bkV4Y2VwdGlvblR5cGVzKCksIG8udGhyb3duRXhjZXB0aW9uVHlwZXMoKSkpCisJCQkJJiYgKChu
b2RlLmdldEFTVCgpLmFwaUxldmVsIDwgQVNULkpMUzgpID8KKwkJCQkJCQkobm9kZS5nZXRFeHRy
YURpbWVuc2lvbnMoKSA9PSBvLmdldEV4dHJhRGltZW5zaW9ucygpCisJCQkJCQkJCSYmIHNhZmVT
dWJ0cmVlTGlzdE1hdGNoKG5vZGUudGhyb3duRXhjZXB0aW9ucygpLCBvLnRocm93bkV4Y2VwdGlv
bnMoKSkpIDoKKwkJCQkJCQkoc2FmZVN1YnRyZWVMaXN0TWF0Y2gobm9kZS5nZXRFeHRyYURpbWVu
c2lvbkluZm9zKCksIG8uZ2V0RXh0cmFEaW1lbnNpb25JbmZvcygpKQorCQkJCQkJCQkmJiBzYWZl
U3VidHJlZUxpc3RNYXRjaChub2RlLnRocm93bkV4Y2VwdGlvblR5cGVzKCksIG8udGhyb3duRXhj
ZXB0aW9uVHlwZXMoKSkpKQogCQkJCSYmIHNhZmVTdWJ0cmVlTWF0Y2gobm9kZS5nZXRCb2R5KCks
IG8uZ2V0Qm9keSgpKSk7CiAJfQogCkBAIC0xODc4LDcgKzE5MDIsOSBAQAogCQlyZXR1cm4KIAkJ
ICAgIHNhZmVTdWJ0cmVlTWF0Y2gobm9kZS5nZXRUeXBlKCksIG8uZ2V0VHlwZSgpKQogCQkJCSYm
IHNhZmVTdWJ0cmVlTWF0Y2gobm9kZS5nZXROYW1lKCksIG8uZ2V0TmFtZSgpKQotCSAJCQkmJiBu
b2RlLmdldEV4dHJhRGltZW5zaW9ucygpID09IG8uZ2V0RXh0cmFEaW1lbnNpb25zKCkKKwkgCQkJ
JiYgKChub2RlLmdldEFTVCgpLmFwaUxldmVsIDwgQVNULkpMUzgpID8KKwkgCQkJCQkobm9kZS5n
ZXRFeHRyYURpbWVuc2lvbnMoKSA9PSBvLmdldEV4dHJhRGltZW5zaW9ucygpKSA6CisJIAkJCQkJ
CXNhZmVTdWJ0cmVlTGlzdE1hdGNoKG5vZGUuZ2V0RXh0cmFEaW1lbnNpb25JbmZvcygpLCBvLmdl
dEV4dHJhRGltZW5zaW9uSW5mb3MoKSkpCiAJCQkJJiYgc2FmZVN1YnRyZWVNYXRjaChub2RlLmdl
dEluaXRpYWxpemVyKCksIG8uZ2V0SW5pdGlhbGl6ZXIoKSkKIAkJCQkmJiAobGV2ZWwgPj0gQVNU
LkpMUzggJiYgbm9kZS5pc1ZhcmFyZ3MoKSkgPyBzYWZlU3VidHJlZUxpc3RNYXRjaChub2RlLnZh
cmFyZ3NBbm5vdGF0aW9ucygpLCBvLnZhcmFyZ3NBbm5vdGF0aW9ucygpKSA6IHRydWU7CQkKIAl9
CkBAIC0yMzcxLDcgKzIzOTcsOSBAQAogCQl9CiAJCVZhcmlhYmxlRGVjbGFyYXRpb25GcmFnbWVu
dCBvID0gKFZhcmlhYmxlRGVjbGFyYXRpb25GcmFnbWVudCkgb3RoZXI7CiAJCXJldHVybiBzYWZl
U3VidHJlZU1hdGNoKG5vZGUuZ2V0TmFtZSgpLCBvLmdldE5hbWUoKSkKLQkJCSYmIG5vZGUuZ2V0
RXh0cmFEaW1lbnNpb25zKCkgPT0gby5nZXRFeHRyYURpbWVuc2lvbnMoKQorCQkJJiYgKChub2Rl
LmdldEFTVCgpLmFwaUxldmVsIDwgQVNULkpMUzgpID8KKwkJCQkJKG5vZGUuZ2V0RXh0cmFEaW1l
bnNpb25zKCkgPT0gby5nZXRFeHRyYURpbWVuc2lvbnMoKSkgOgorCQkJCQkJc2FmZVN1YnRyZWVM
aXN0TWF0Y2gobm9kZS5nZXRFeHRyYURpbWVuc2lvbkluZm9zKCksIG8uZ2V0RXh0cmFEaW1lbnNp
b25JbmZvcygpKSkKIAkJCSYmIHNhZmVTdWJ0cmVlTWF0Y2gobm9kZS5nZXRJbml0aWFsaXplcigp
LCBvLmdldEluaXRpYWxpemVyKCkpOwogCX0KIApkaWZmIC0tZ2l0IGEvb3JnLmVjbGlwc2UuamR0
LmNvcmUvZG9tL29yZy9lY2xpcHNlL2pkdC9jb3JlL2RvbS9BU1ROb2RlLmphdmEgYi9vcmcuZWNs
aXBzZS5qZHQuY29yZS9kb20vb3JnL2VjbGlwc2UvamR0L2NvcmUvZG9tL0FTVE5vZGUuamF2YQpp
bmRleCA2ZWE0M2JhLi43MTNkMWEwIDEwMDY0NAotLS0gYS9vcmcuZWNsaXBzZS5qZHQuY29yZS9k
b20vb3JnL2VjbGlwc2UvamR0L2NvcmUvZG9tL0FTVE5vZGUuamF2YQorKysgYi9vcmcuZWNsaXBz
ZS5qZHQuY29yZS9kb20vb3JnL2VjbGlwc2UvamR0L2NvcmUvZG9tL0FTVE5vZGUuamF2YQpAQCAt
MSw1ICsxLDUgQEAKIC8qKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioq
KioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqCi0gKiBDb3B5cmlnaHQgKGMpIDIw
MDAsIDIwMTIgSUJNIENvcnBvcmF0aW9uIGFuZCBvdGhlcnMuCisgKiBDb3B5cmlnaHQgKGMpIDIw
MDAsIDIwMTMgSUJNIENvcnBvcmF0aW9uIGFuZCBvdGhlcnMuCiAgKiBBbGwgcmlnaHRzIHJlc2Vy
dmVkLiBUaGlzIHByb2dyYW0gYW5kIHRoZSBhY2NvbXBhbnlpbmcgbWF0ZXJpYWxzCiAgKiBhcmUg
bWFkZSBhdmFpbGFibGUgdW5kZXIgdGhlIHRlcm1zIG9mIHRoZSBFY2xpcHNlIFB1YmxpYyBMaWNl
bnNlIHYxLjAKICAqIHdoaWNoIGFjY29tcGFuaWVzIHRoaXMgZGlzdHJpYnV0aW9uLCBhbmQgaXMg
YXZhaWxhYmxlIGF0CkBAIC03NzMsNiArNzczLDE1IEBACiAJcHVibGljIHN0YXRpYyBmaW5hbCBp
bnQgVU5JT05fVFlQRSA9IDg0OwogCiAJLyoqCisJICogTm9kZSB0eXBlIGNvbnN0YW50IGluZGlj
YXRpbmcgYSBub2RlIG9mIHR5cGUKKwkgKiA8Y29kZT5EaW1lbnNpb25JbmZvPC9jb2RlPi4KKwkg
KgorCSAqIEBzZWUgRGltZW5zaW9uSW5mbworCSAqIEBzaW5jZSAzLjkKKwkgKi8KKwlwdWJsaWMg
c3RhdGljIGZpbmFsIGludCBESU1FTlNJT05fSU5GTyA9IDg1OworCisJLyoqCiAJICogUmV0dXJu
cyB0aGUgbm9kZSBjbGFzcyBmb3IgdGhlIGNvcnJlc3BvbmRpbmcgbm9kZSB0eXBlLgogCSAqCiAJ
ICogQHBhcmFtIG5vZGVUeXBlIEFTVCBub2RlIHR5cGUKQEAgLTk1Miw2ICs5NjEsOCBAQAogCQkJ
CXJldHVybiBXaGlsZVN0YXRlbWVudC5jbGFzczsKIAkJCWNhc2UgV0lMRENBUkRfVFlQRSA6CiAJ
CQkJcmV0dXJuIFdpbGRjYXJkVHlwZS5jbGFzczsKKwkJCWNhc2UgRElNRU5TSU9OX0lORk86CisJ
CQkJcmV0dXJuIERpbWVuc2lvbkluZm8uY2xhc3M7CiAJCX0KIAkJdGhyb3cgbmV3IElsbGVnYWxB
cmd1bWVudEV4Y2VwdGlvbigpOwogCX0KZGlmZiAtLWdpdCBhL29yZy5lY2xpcHNlLmpkdC5jb3Jl
L2RvbS9vcmcvZWNsaXBzZS9qZHQvY29yZS9kb20vQVNUVmlzaXRvci5qYXZhIGIvb3JnLmVjbGlw
c2UuamR0LmNvcmUvZG9tL29yZy9lY2xpcHNlL2pkdC9jb3JlL2RvbS9BU1RWaXNpdG9yLmphdmEK
aW5kZXggYjI5MzA1My4uYjAxZmFkNyAxMDA2NDQKLS0tIGEvb3JnLmVjbGlwc2UuamR0LmNvcmUv
ZG9tL29yZy9lY2xpcHNlL2pkdC9jb3JlL2RvbS9BU1RWaXNpdG9yLmphdmEKKysrIGIvb3JnLmVj
bGlwc2UuamR0LmNvcmUvZG9tL29yZy9lY2xpcHNlL2pkdC9jb3JlL2RvbS9BU1RWaXNpdG9yLmph
dmEKQEAgLTEsOSArMSwxMyBAQAogLyoqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioq
KioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioKLSAqIENvcHlyaWdo
dCAoYykgMjAwMCwgMjAxMSBJQk0gQ29ycG9yYXRpb24gYW5kIG90aGVycy4KKyAqIENvcHlyaWdo
dCAoYykgMjAwMCwgMjAxMyBJQk0gQ29ycG9yYXRpb24gYW5kIG90aGVycy4KICAqIEFsbCByaWdo
dHMgcmVzZXJ2ZWQuIFRoaXMgcHJvZ3JhbSBhbmQgdGhlIGFjY29tcGFueWluZyBtYXRlcmlhbHMK
ICAqIGFyZSBtYWRlIGF2YWlsYWJsZSB1bmRlciB0aGUgdGVybXMgb2YgdGhlIEVjbGlwc2UgUHVi
bGljIExpY2Vuc2UgdjEuMAogICogd2hpY2ggYWNjb21wYW5pZXMgdGhpcyBkaXN0cmlidXRpb24s
IGFuZCBpcyBhdmFpbGFibGUgYXQKICAqIGh0dHA6Ly93d3cuZWNsaXBzZS5vcmcvbGVnYWwvZXBs
LXYxMC5odG1sCisgKgorICogVGhpcyBpcyBhbiBpbXBsZW1lbnRhdGlvbiBvZiBhbiBlYXJseS1k
cmFmdCBzcGVjaWZpY2F0aW9uIGRldmVsb3BlZCB1bmRlciB0aGUgSmF2YQorICogQ29tbXVuaXR5
IFByb2Nlc3MgKEpDUCkgYW5kIGlzIG1hZGUgYXZhaWxhYmxlIGZvciB0ZXN0aW5nIGFuZCBldmFs
dWF0aW9uIHB1cnBvc2VzCisgKiBvbmx5LiBUaGUgY29kZSBpcyBub3QgY29tcGF0aWJsZSB3aXRo
IGFueSBzcGVjaWZpY2F0aW9uIG9mIHRoZSBKQ1AuCiAgKgogICogQ29udHJpYnV0b3JzOgogICog
ICAgIElCTSBDb3Jwb3JhdGlvbiAtIGluaXRpYWwgQVBJIGFuZCBpbXBsZW1lbnRhdGlvbgpAQCAt
MTk5LDYgKzIwMywyMiBAQAogCQlyZXR1cm4gdHJ1ZTsKIAl9CiAKKwkvKioKKwkgKiBWaXNpdHMg
dGhlIGdpdmVuIHR5cGUtc3BlY2lmaWMgQVNUIG5vZGUuCisJICogPHA+CisJICogVGhlIGRlZmF1
bHQgaW1wbGVtZW50YXRpb24gZG9lcyBub3RoaW5nIGFuZCByZXR1cm4gdHJ1ZS4KKwkgKiBTdWJj
bGFzc2VzIG1heSByZWltcGxlbWVudC4KKwkgKiA8L3A+CisJICoKKwkgKiBAcGFyYW0gbm9kZSB0
aGUgbm9kZSB0byB2aXNpdAorCSAqIEByZXR1cm4gPGNvZGU+dHJ1ZTwvY29kZT4gaWYgdGhlIGNo
aWxkcmVuIG9mIHRoaXMgbm9kZSBzaG91bGQgYmUKKwkgKiB2aXNpdGVkLCBhbmQgPGNvZGU+ZmFs
c2U8L2NvZGU+IGlmIHRoZSBjaGlsZHJlbiBvZiB0aGlzIG5vZGUgc2hvdWxkCisJICogYmUgc2tp
cHBlZAorCSAqIEBzaW5jZSAzLjkKKwkgKi8KKwlwdWJsaWMgYm9vbGVhbiB2aXNpdChEaW1lbnNp
b25JbmZvIG5vZGUpIHsKKwkJcmV0dXJuIHRydWU7CisJfQogCiAJLyoqCiAJICogVmlzaXRzIHRo
ZSBnaXZlbiB0eXBlLXNwZWNpZmljIEFTVCBub2RlLgpAQCAtMTYwMCw2ICsxNjIwLDE5IEBACiAJ
ICogPC9wPgogCSAqCiAJICogQHBhcmFtIG5vZGUgdGhlIG5vZGUgdG8gdmlzaXQKKwkgKiBAc2lu
Y2UgMy45CisJICovCisJcHVibGljIHZvaWQgZW5kVmlzaXQoRGltZW5zaW9uSW5mbyBub2RlKSB7
CisJCS8vIGRvIG5vdGhpbmcgYnkgZGVmYXVsdAorCX0KKworCS8qKgorCSAqIEVuZCBvZiB2aXNp
dCB0aGUgZ2l2ZW4gdHlwZS1zcGVjaWZpYyBBU1Qgbm9kZS4KKwkgKiA8cD4KKwkgKiBUaGUgZGVm
YXVsdCBpbXBsZW1lbnRhdGlvbiBkb2VzIG5vdGhpbmcuIFN1YmNsYXNzZXMgbWF5IHJlaW1wbGVt
ZW50LgorCSAqIDwvcD4KKwkgKgorCSAqIEBwYXJhbSBub2RlIHRoZSBub2RlIHRvIHZpc2l0CiAJ
ICogQHNpbmNlIDMuMQogCSAqLwogCXB1YmxpYyB2b2lkIGVuZFZpc2l0KEFubm90YXRpb25UeXBl
TWVtYmVyRGVjbGFyYXRpb24gbm9kZSkgewpkaWZmIC0tZ2l0IGEvb3JnLmVjbGlwc2UuamR0LmNv
cmUvZG9tL29yZy9lY2xpcHNlL2pkdC9jb3JlL2RvbS9EaW1lbnNpb25JbmZvLmphdmEgYi9vcmcu
ZWNsaXBzZS5qZHQuY29yZS9kb20vb3JnL2VjbGlwc2UvamR0L2NvcmUvZG9tL0RpbWVuc2lvbklu
Zm8uamF2YQpuZXcgZmlsZSBtb2RlIDEwMDY0NAppbmRleCAwMDAwMDAwLi5hZTczY2YyCi0tLSAv
ZGV2L251bGwKKysrIGIvb3JnLmVjbGlwc2UuamR0LmNvcmUvZG9tL29yZy9lY2xpcHNlL2pkdC9j
b3JlL2RvbS9EaW1lbnNpb25JbmZvLmphdmEKQEAgLTAsMCArMSwyMTcgQEAKKy8qKioqKioqKioq
KioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioq
KioqKioqKioqKioqCisgKiBDb3B5cmlnaHQgKGMpIDIwMDAsIDIwMTMgSUJNIENvcnBvcmF0aW9u
IGFuZCBvdGhlcnMuCisgKiBBbGwgcmlnaHRzIHJlc2VydmVkLiBUaGlzIHByb2dyYW0gYW5kIHRo
ZSBhY2NvbXBhbnlpbmcgbWF0ZXJpYWxzCisgKiBhcmUgbWFkZSBhdmFpbGFibGUgdW5kZXIgdGhl
IHRlcm1zIG9mIHRoZSBFY2xpcHNlIFB1YmxpYyBMaWNlbnNlIHYxLjAKKyAqIHdoaWNoIGFjY29t
cGFuaWVzIHRoaXMgZGlzdHJpYnV0aW9uLCBhbmQgaXMgYXZhaWxhYmxlIGF0CisgKiBodHRwOi8v
d3d3LmVjbGlwc2Uub3JnL2xlZ2FsL2VwbC12MTAuaHRtbAorICoKKyAqIFRoaXMgaXMgYW4gaW1w
bGVtZW50YXRpb24gb2YgYW4gZWFybHktZHJhZnQgc3BlY2lmaWNhdGlvbiBkZXZlbG9wZWQgdW5k
ZXIgdGhlIEphdmEKKyAqIENvbW11bml0eSBQcm9jZXNzIChKQ1ApIGFuZCBpcyBtYWRlIGF2YWls
YWJsZSBmb3IgdGVzdGluZyBhbmQgZXZhbHVhdGlvbiBwdXJwb3NlcworICogb25seS4gVGhlIGNv
ZGUgaXMgbm90IGNvbXBhdGlibGUgd2l0aCBhbnkgc3BlY2lmaWNhdGlvbiBvZiB0aGUgSkNQLgor
ICoKKyAqIENvbnRyaWJ1dG9yczoKKyAqICAgICBJQk0gQ29ycG9yYXRpb24gLSBpbml0aWFsIEFQ
SSBhbmQgaW1wbGVtZW50YXRpb24KKyAqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioq
KioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqLworcGFja2FnZSBv
cmcuZWNsaXBzZS5qZHQuY29yZS5kb207CisKK2ltcG9ydCBqYXZhLnV0aWwuQXJyYXlMaXN0Owor
aW1wb3J0IGphdmEudXRpbC5MaXN0OworCisvKioKKyAqIFRoZSBhcnJheSBkaW1lbnNpb24gaW5m
byBub2RlLiBUaGUgYXJyYXkgZGltZW5zaW9uLCByZXByZXNlbnRlZCBhcyA8Yj5bXTwvYj4sIGNh
biBoYXZlCisgKiB0eXBlIGFubm90YXRpb25zLiBJdCBtYXkgYWxzbyBpbmNsdWRlIGFuIDxjb2Rl
PkV4cHJlc3Npb248L2NvZGU+IGRlcGVuZGluZyBvbiB3aGVyZSBpdCBhcHBlYXJzLgorICogVGhl
IG9ubHkgbm9kZSB0aGF0IHN1cHBvcnRzIGEgZGltZW5zaW9uIHR5cGUgd2l0aCBhbiBleHByZXNz
aW9uIGlzIDxjb2RlPkFycmF5Q3JlYXRpb248L2NvZGU+LgorICogVGhpcyBub2RlIHR5cGUgaXMg
c3VwcG9ydGVkIG9ubHkgaW4gSkxTOCBvciBsYXRlci4KKyAqIAorICogVGhpcyBub2RlIGlzIHVz
ZWQgdG8gcmVwcmVzZW50IGV4dHJhIGRpbWVuc2lvbnMgaW4gdGhlIGZvbGxvd2luZyBub2RlcyB0
aGF0IGNhbiBoYXZlCisgKiBleHRyYSBhbm5vdGF0YWJsZSBkaW1lbnNpb25zOgorICogCVNpbmds
ZVZhcmlhYmxlRGVjbGFyYXRpb24KKyAqIAlWYXJpYWJsZURlY2xhcmF0aW9uRnJhZ21lbnQKKyAq
IAlNZXRob2REZWNsYXJhdGlvbgorICoKKyAqIEZvciBKTFM4OgorICogPHByZT4KKyAqIERpbWVu
c2lvbkluZm86CisgKiAJeyBBbm5vdGF0aW9ucyB9IDxiPls8L2I+IFsgRXhwcmVzc2lvbiBdIDxi
Pl08L2I+CisgKiA8L3ByZT4KKyAqCisgKiBAc2luY2UgMy45CisgKi8KK3B1YmxpYyBjbGFzcyBE
aW1lbnNpb25JbmZvIGV4dGVuZHMgQVNUTm9kZSB7CisKKworCS8qKgorCSAqIFRoZSAiYW5ub3Rh
dGlvbnMiIHN0cnVjdHVyYWwgcHJvcGVydHkgb2YgdGhpcyBub2RlIHR5cGUgKGNoaWxkIHR5cGU6
IHtAbGluayBBbm5vdGF0aW9ufSkuCisJICogQHNpbmNlIDMuOQorCSAqLworCXB1YmxpYyBzdGF0
aWMgZmluYWwgQ2hpbGRMaXN0UHJvcGVydHlEZXNjcmlwdG9yIEFOTk9UQVRJT05TX1BST1BFUlRZ
ID0KKwkJbmV3IENoaWxkTGlzdFByb3BlcnR5RGVzY3JpcHRvcihEaW1lbnNpb25JbmZvLmNsYXNz
LCAiYW5ub3RhdGlvbnMiLCBBbm5vdGF0aW9uLmNsYXNzLCBOT19DWUNMRV9SSVNLKTsgLy8kTk9O
LU5MUy0xJAorCisKKwkvKioKKwkgKiBUaGUgImV4cHJlc3Npb24iIHN0cnVjdHVyYWwgcHJvcGVy
dHkgb2YgdGhpcyBub2RlIHR5cGUgKGVsZW1lbnQgdHlwZToge0BsaW5rIEV4cHJlc3Npb259KS4K
KwkgKiBAc2luY2UgMy45CisJICovCisJcHVibGljIHN0YXRpYyBmaW5hbCBDaGlsZFByb3BlcnR5
RGVzY3JpcHRvciBFWFBSRVNTSU9OX1BST1BFUlRZID0KKwkJCW5ldyBDaGlsZFByb3BlcnR5RGVz
Y3JpcHRvcihEaW1lbnNpb25JbmZvLmNsYXNzLCAiZXhwcmVzc2lvbiIsIEV4cHJlc3Npb24uY2xh
c3MsIE1BTkRBVE9SWSwgTk9fQ1lDTEVfUklTSyk7IC8vJE5PTi1OTFMtMSQKKworCisJLyoqCisJ
ICogQSBsaXN0IG9mIHByb3BlcnR5IGRlc2NyaXB0b3JzIChlbGVtZW50IHR5cGU6CisJICoge0Bs
aW5rIFN0cnVjdHVyYWxQcm9wZXJ0eURlc2NyaXB0b3J9KSwKKwkgKiBvciBudWxsIGlmIHVuaW5p
dGlhbGl6ZWQuCisJICogQHNpbmNlIDMuOQorCSAqLworCXByaXZhdGUgc3RhdGljIGZpbmFsIExp
c3QgUFJPUEVSVFlfREVTQ1JJUFRPUlNfOF8wOworCisJc3RhdGljIHsKKwkJTGlzdCBwcm9wZXJ0
eUxpc3QgPSBuZXcgQXJyYXlMaXN0KDMpOworCQljcmVhdGVQcm9wZXJ0eUxpc3QoRGltZW5zaW9u
SW5mby5jbGFzcywgcHJvcGVydHlMaXN0KTsKKwkJYWRkUHJvcGVydHkoQU5OT1RBVElPTlNfUFJP
UEVSVFksIHByb3BlcnR5TGlzdCk7CisJCWFkZFByb3BlcnR5KEVYUFJFU1NJT05fUFJPUEVSVFks
IHByb3BlcnR5TGlzdCk7CisJCVBST1BFUlRZX0RFU0NSSVBUT1JTXzhfMCA9IHJlYXBQcm9wZXJ0
eUxpc3QocHJvcGVydHlMaXN0KTsKKwl9CisKKwkvKioKKwkgKiBSZXR1cm5zIGEgbGlzdCBvZiBz
dHJ1Y3R1cmFsIHByb3BlcnR5IGRlc2NyaXB0b3JzIGZvciB0aGlzIG5vZGUgdHlwZS4KKwkgKiBD
bGllbnRzIG11c3Qgbm90IG1vZGlmeSB0aGUgcmVzdWx0LgorCSAqCisJICogQHBhcmFtIGFwaUxl
dmVsIHRoZSBBUEkgbGV2ZWw7IG9uZSBvZiB0aGUKKwkgKiA8Y29kZT5BU1QuSkxTKjwvY29kZT4g
Y29uc3RhbnRzCisJICogQHJldHVybiBhIGxpc3Qgb2YgcHJvcGVydHkgZGVzY3JpcHRvcnMgKGVs
ZW1lbnQgdHlwZToKKwkgKiB7QGxpbmsgU3RydWN0dXJhbFByb3BlcnR5RGVzY3JpcHRvcn0pCisJ
ICogQHNpbmNlIDMuOQorCSAqLworCXB1YmxpYyBzdGF0aWMgTGlzdCBwcm9wZXJ0eURlc2NyaXB0
b3JzKGludCBhcGlMZXZlbCkgeworCQlyZXR1cm4gUFJPUEVSVFlfREVTQ1JJUFRPUlNfOF8wOwor
CX0KKworCXB1YmxpYyBEaW1lbnNpb25JbmZvKEFTVCBhc3QpIHsKKwkJc3VwZXIoYXN0KTsKKwkJ
dW5zdXBwb3J0ZWRJbjJfM180KCk7CisJCXRoaXMuYW5ub3RhdGlvbnMgPSBuZXcgQVNUTm9kZS5O
b2RlTGlzdChBTk5PVEFUSU9OU19QUk9QRVJUWSk7CisJfQorCisJQVNUTm9kZS5Ob2RlTGlzdCBh
bm5vdGF0aW9ucyA9IG51bGw7CisJCisJLyoqCisJICogUmV0dXJucyB0aGUgbGl2ZSBvcmRlcmVk
IGxpc3Qgb2YgYW5ub3RhdGlvbnMgZm9yIHRoaXMgbm9kZS4KKwkgKgorCSAqIEByZXR1cm4gdGhl
IGxpdmUgbGlzdCBvZiBhbm5vdGF0aW9ucyAoZWxlbWVudCB0eXBlOiB7QGxpbmsgQW5ub3RhdGlv
bn0pCisJICogQGV4Y2VwdGlvbiBVbnN1cHBvcnRlZE9wZXJhdGlvbkV4Y2VwdGlvbiBpZiB0aGlz
IG9wZXJhdGlvbiBpcyB1c2VkCisJICogICAgICAgICAgICBpbiBhIEpMUzIsIEpMUzMgb3IgSkxT
NCBBU1QKKwkgKiBAc2luY2UgMy45CisJICovCisJcHVibGljIExpc3QgYW5ub3RhdGlvbnMoKSB7
CisJCXJldHVybiB0aGlzLmFubm90YXRpb25zOworCX0KKworCS8qKgorCSAqIFRoZSBleHByZXNz
aW9uIGZvciB0aGlzIGRpbWVuc2lvbiB0eXBlIChlbGVtZW50IHR5cGU6CisJICoge0BsaW5rIEV4
cHJlc3Npb259KS4KKwkgKi8KKwlwcml2YXRlIEV4cHJlc3Npb24gZXhwcmVzc2lvbiA9IG51bGw7
CisKKwkvKioKKwkgKiBTZXRzIHRoZSBleHByZXNzaW9uIHRvIHRoaXMgZGltZW5zaW9uLiBUaGlz
IG9wZXJhdGlvbiB3aWxsIGhhdmUKKwkgKiBlZmZlY3Qgb25seSBpZiB0aGlzIGRpbWVuc2lvbiB0
eXBlIG5vZGUgaXMgcGFydCBvZiBhbiBhcnJheSBjcmVhdGlvbgorCSAqIG5vZGUuCisJICoKKwkg
KiBAcGFyYW0gZXhwcmVzc2lvbiB0aGUgbmV3IGFycmF5IHR5cGUKKwkgKiBAZXhjZXB0aW9uIEls
bGVnYWxBcmd1bWVudEV4Y2VwdGlvbiBpZjoKKwkgKiA8dWw+CisJICogPGxpPnRoZSBub2RlIGJl
bG9uZ3MgdG8gYSBkaWZmZXJlbnQgQVNUPC9saT4KKwkgKiA8bGk+dGhlIG5vZGUgYWxyZWFkeSBo
YXMgYSBwYXJlbnQ8L2xpPgorCSAqIDwvdWw+CisJICoKKwkgKiBAc2luY2UgMy45CisJICovCisJ
cHVibGljIHZvaWQgc2V0RXhwcmVzc2lvbihFeHByZXNzaW9uIGV4cHJlc3Npb24pIHsKKwkJLy8g
YW4gQXJyYXlDcmVhdGlvbiBjYW5ub3Qgb2NjdXIgaW5zaWRlIGEgQXJyYXlUeXBlIC0gY3ljbGVz
IG5vdCBwb3NzaWJsZQorCQlBU1ROb2RlIG9sZENoaWxkID0gdGhpcy5leHByZXNzaW9uOworCQlw
cmVSZXBsYWNlQ2hpbGQob2xkQ2hpbGQsIGV4cHJlc3Npb24sIEVYUFJFU1NJT05fUFJPUEVSVFkp
OworCQl0aGlzLmV4cHJlc3Npb24gPSBleHByZXNzaW9uOworCQlwb3N0UmVwbGFjZUNoaWxkKG9s
ZENoaWxkLCBleHByZXNzaW9uLCBFWFBSRVNTSU9OX1BST1BFUlRZKTsKKwl9CisKKwkvKioKKwkg
KiBSZXR1cm5zIHRoZSBleHByZXNzaW9uIGluIHRoZSBkaW1lbnNpb24gdHlwZSBvciBudWxsIGlm
IG5vdCBhcHBsaWNhYmxlLgorCSAqCisJICogQHJldHVybiB0aGUgZXhwcmVzc2lvbgorCSAqIEBz
aW5jZSAzLjkKKwkgKi8KKwlwdWJsaWMgRXhwcmVzc2lvbiBleHByZXNzaW9uKCkgeworCQlyZXR1
cm4gdGhpcy5leHByZXNzaW9uOworCX0KKworCUxpc3QgaW50ZXJuYWxTdHJ1Y3R1cmFsUHJvcGVy
dGllc0ZvclR5cGUoaW50IGFwaUxldmVsKSB7CisJCXJldHVybiBwcm9wZXJ0eURlc2NyaXB0b3Jz
KGFwaUxldmVsKTsKKwl9CisKKwkvKiAob21pdCBqYXZhZG9jIGZvciB0aGlzIG1ldGhvZCkKKwkg
KiBNZXRob2QgZGVjbGFyZWQgb24gQVNUTm9kZS4KKwkgKi8KKwlmaW5hbCBBU1ROb2RlIGludGVy
bmFsR2V0U2V0Q2hpbGRQcm9wZXJ0eShDaGlsZFByb3BlcnR5RGVzY3JpcHRvciBwcm9wZXJ0eSwg
Ym9vbGVhbiBnZXQsIEFTVE5vZGUgY2hpbGQpIHsKKwkJaWYgKHByb3BlcnR5ID09IEVYUFJFU1NJ
T05fUFJPUEVSVFkpIHsKKwkJCWlmIChnZXQpIHsKKwkJCQlyZXR1cm4gZXhwcmVzc2lvbigpOwor
CQkJfSBlbHNlIHsKKwkJCQlzZXRFeHByZXNzaW9uKChFeHByZXNzaW9uKSBjaGlsZCk7CisJCQkJ
cmV0dXJuIG51bGw7CisJCQl9CisJCX0KKwkJLy8gYWxsb3cgZGVmYXVsdCBpbXBsZW1lbnRhdGlv
biB0byBmbGFnIHRoZSBlcnJvcgorCQlyZXR1cm4gc3VwZXIuaW50ZXJuYWxHZXRTZXRDaGlsZFBy
b3BlcnR5KHByb3BlcnR5LCBnZXQsIGNoaWxkKTsKKwl9CisKKwkvKiAob21pdCBqYXZhZG9jIGZv
ciB0aGlzIG1ldGhvZCkKKwkgKiBNZXRob2QgZGVjbGFyZWQgb24gQVNUTm9kZS4KKwkgKi8KKwlm
aW5hbCBMaXN0IGludGVybmFsR2V0Q2hpbGRMaXN0UHJvcGVydHkoQ2hpbGRMaXN0UHJvcGVydHlE
ZXNjcmlwdG9yIHByb3BlcnR5KSB7CisJCWlmIChwcm9wZXJ0eSA9PSBBTk5PVEFUSU9OU19QUk9Q
RVJUWSkgeworCQkJcmV0dXJuIGFubm90YXRpb25zKCk7CisJCX0KKwkJLy8gYWxsb3cgZGVmYXVs
dCBpbXBsZW1lbnRhdGlvbiB0byBmbGFnIHRoZSBlcnJvcgorCQlyZXR1cm4gc3VwZXIuaW50ZXJu
YWxHZXRDaGlsZExpc3RQcm9wZXJ0eShwcm9wZXJ0eSk7CisJfQorCisJaW50IGdldE5vZGVUeXBl
MCgpIHsKKwkJcmV0dXJuIERJTUVOU0lPTl9JTkZPOworCX0KKworCWJvb2xlYW4gc3VidHJlZU1h
dGNoMChBU1RNYXRjaGVyIG1hdGNoZXIsIE9iamVjdCBvdGhlcikgeworCQlyZXR1cm4gbWF0Y2hl
ci5tYXRjaCh0aGlzLCBvdGhlcik7CisJfQorCisJQVNUTm9kZSBjbG9uZTAoQVNUIHRhcmdldCkg
eworCQlEaW1lbnNpb25JbmZvIHJlc3VsdCA9IG5ldyBEaW1lbnNpb25JbmZvKHRhcmdldCk7CisJ
CXJlc3VsdC5hbm5vdGF0aW9ucy5hZGRBbGwoCisJCQkJQVNUTm9kZS5jb3B5U3VidHJlZXModGFy
Z2V0LCBhbm5vdGF0aW9ucygpKSk7CisJCWlmICh0aGlzLmV4cHJlc3Npb24gIT0gbnVsbCkgewor
CQkJcmVzdWx0LnNldEV4cHJlc3Npb24oKEV4cHJlc3Npb24pZXhwcmVzc2lvbigpLmNsb25lKHRh
cmdldCkpOworCQl9CisJCXJldHVybiByZXN1bHQ7CisJfQorCisJdm9pZCBhY2NlcHQwKEFTVFZp
c2l0b3IgdmlzaXRvcikgeworCQlib29sZWFuIHZpc2l0Q2hpbGRyZW4gPSB2aXNpdG9yLnZpc2l0
KHRoaXMpOworCQlpZiAodmlzaXRDaGlsZHJlbikgeworCQkJYWNjZXB0Q2hpbGRyZW4odmlzaXRv
ciwgdGhpcy5hbm5vdGF0aW9ucyk7CisJCQlpZiAodGhpcy5leHByZXNzaW9uICE9IG51bGwpIHsK
KwkJCQlhY2NlcHRDaGlsZCh2aXNpdG9yLCB0aGlzLmV4cHJlc3Npb24pOworCQkJfQorCQl9CisJ
CXZpc2l0b3IuZW5kVmlzaXQodGhpcyk7CisJfQorCisJaW50IHRyZWVTaXplKCkgeworCQlpbnQg
c2l6ZSA9IG1lbVNpemUoKQorCQkJCSsgdGhpcy5hbm5vdGF0aW9ucy5saXN0U2l6ZSgpCisJCQkJ
KyAodGhpcy5leHByZXNzaW9uID09IG51bGwgPyAwIDogdGhpcy5leHByZXNzaW9uLnRyZWVTaXpl
KCkpOworCQkJcmV0dXJuIHNpemU7CisJfQorCisJaW50IG1lbVNpemUoKSB7CisJCXJldHVybiBC
QVNFX05PREVfU0laRSArIDIgKiA0OworCX0KK30KZGlmZiAtLWdpdCBhL29yZy5lY2xpcHNlLmpk
dC5jb3JlL2RvbS9vcmcvZWNsaXBzZS9qZHQvY29yZS9kb20vTWV0aG9kRGVjbGFyYXRpb24uamF2
YSBiL29yZy5lY2xpcHNlLmpkdC5jb3JlL2RvbS9vcmcvZWNsaXBzZS9qZHQvY29yZS9kb20vTWV0
aG9kRGVjbGFyYXRpb24uamF2YQppbmRleCAxOTQ2YzAwLi41MTQ1ZDFhIDEwMDY0NAotLS0gYS9v
cmcuZWNsaXBzZS5qZHQuY29yZS9kb20vb3JnL2VjbGlwc2UvamR0L2NvcmUvZG9tL01ldGhvZERl
Y2xhcmF0aW9uLmphdmEKKysrIGIvb3JnLmVjbGlwc2UuamR0LmNvcmUvZG9tL29yZy9lY2xpcHNl
L2pkdC9jb3JlL2RvbS9NZXRob2REZWNsYXJhdGlvbi5qYXZhCkBAIC01MywxNCArNTMsMTUgQEAK
ICAqIAkJCSB7IDxiPiw8L2I+IEZvcm1hbFBhcmFtZXRlciB9IF0gPGI+KTwvYj4KICAqICAgICAg
ICBbPGI+dGhyb3dzPC9iPiBUeXBlTmFtZSB7IDxiPiw8L2I+IFR5cGVOYW1lIH0gXSBCbG9jawog
ICogPC9wcmU+Ci0gKiBGb3IgSkxTOCBvcHRpb25hbCByZWNlaXZlciBwYXJhbWV0ZXIgaXMgYWRk
ZWQ6CisgKiBGb3IgSkxTOCBvcHRpb25hbCByZWNlaXZlciBwYXJhbWV0ZXIgaXMgYWRkZWQgYW5k
IGV4dHJhIGRpbWVuc2lvbnMgYXJlIGFsbG93ZWQgdG8gaGF2ZSAKKyAqIHR5cGUgYW5ub3RhdGlv
bnMuIFRoZSBleHRyYSBkaW1lbnNpb25zIGFyZSByZXByZXNlbnRlZCBieSB7QGxpbmsgRGltZW5z
aW9uSW5mb30uCiAgKiA8cHJlPgogICogTWV0aG9kRGVjbGFyYXRpb246CiAgKiAgICBbIEphdmFk
b2MgXSB7IEV4dGVuZGVkTW9kaWZpZXIgfQogICoJCSAgWyA8Yj4mbHQ7PC9iPiBUeXBlUGFyYW1l
dGVyIHsgPGI+LDwvYj4gVHlwZVBhcmFtZXRlciB9IDxiPiZndDs8L2I+IF0KICAqICAgICAgICAo
IFR5cGUgfCA8Yj52b2lkPC9iPiApIElkZW50aWZpZXIgPGI+KDwvYj4KICAqICAgICAgICAJWyBS
ZWNlaXZlclBhcmFtZXRlciBdCi0gKiAgICAgICAgIAlbIDxiPiwgPC9iPiBGb3JtYWxQYXJhbWV0
ZXIgeyA8Yj4sPC9iPiBGb3JtYWxQYXJhbWV0ZXIgfSBdIDxiPik8L2I+IHs8Yj5bPC9iPiA8Yj5d
PC9iPiB9CisgKiAgICAgICAgIAlbIDxiPiwgPC9iPiBGb3JtYWxQYXJhbWV0ZXIgeyA8Yj4sPC9i
PiBGb3JtYWxQYXJhbWV0ZXIgfSBdIDxiPik8L2I+IHsgRGltZW5zaW9uSW5mbyB9CiAgKiAgICAg
ICAgWyA8Yj50aHJvd3M8L2I+IFR5cGVOYW1lIHsgPGI+LDwvYj4gVHlwZU5hbWUgfSBdICggQmxv
Y2sgfCA8Yj47PC9iPiApCiAgKiBDb25zdHJ1Y3RvckRlY2xhcmF0aW9uOgogICogICAgWyBKYXZh
ZG9jIF0geyBFeHRlbmRlZE1vZGlmaWVyIH0KQEAgLTEzOCwxMSArMTM5LDE5IEBACiAJCW5ldyBD
aGlsZFByb3BlcnR5RGVzY3JpcHRvcihNZXRob2REZWNsYXJhdGlvbi5jbGFzcywgInJldHVyblR5
cGUyIiwgVHlwZS5jbGFzcywgT1BUSU9OQUwsIE5PX0NZQ0xFX1JJU0spOyAvLyROT04tTkxTLTEk
CiAKIAkvKioKLQkgKiBUaGUgImV4dHJhRGltZW5zaW9ucyIgc3RydWN0dXJhbCBwcm9wZXJ0eSBv
ZiB0aGlzIG5vZGUgdHlwZSAodHlwZToge0BsaW5rIEludGVnZXJ9KS4KKwkgKiBUaGUgImV4dHJh
RGltZW5zaW9ucyIgc3RydWN0dXJhbCBwcm9wZXJ0eSBvZiB0aGlzIG5vZGUgdHlwZSAodHlwZTog
e0BsaW5rIEludGVnZXJ9KS4gVGhpcyBwcm9wZXJ0eSBpcyBzdXBwb3J0ZWQKKwkgKiBvbmx5IGlu
IEpMUzQgb3IgYmVsb3cuIEZvciBKTFM4IGFuZCBhYm92ZSwgdXNlIDxjb2RlPkVYVFJBX0RJTUVO
U0lPTl9UWVBFU19QUk9QRVJUWTwvY29kZT4uCiAJICogQHNpbmNlIDMuMAogCSAqLwogCXB1Ymxp
YyBzdGF0aWMgZmluYWwgU2ltcGxlUHJvcGVydHlEZXNjcmlwdG9yIEVYVFJBX0RJTUVOU0lPTlNf
UFJPUEVSVFkgPQogCQluZXcgU2ltcGxlUHJvcGVydHlEZXNjcmlwdG9yKE1ldGhvZERlY2xhcmF0
aW9uLmNsYXNzLCAiZXh0cmFEaW1lbnNpb25zIiwgaW50LmNsYXNzLCBNQU5EQVRPUlkpOyAvLyRO
T04tTkxTLTEkCisKKwkvKioKKwkgKiBUaGUgImV4dHJhRGltZW5zaW9uSW5mb3MiIHN0cnVjdHVy
YWwgcHJvcGVydHkgb2YgdGhpcyBub2RlIHR5cGUgKGNoaWxkIHR5cGU6IHtAbGluayBEaW1lbnNp
b25JbmZvfSkgKGFkZGVkIGluIEpMUzggQVBJKS4KKwkgKiBAc2luY2UgMy45CisJICovCisJcHVi
bGljIHN0YXRpYyBmaW5hbCBDaGlsZExpc3RQcm9wZXJ0eURlc2NyaXB0b3IgRVhUUkFfRElNRU5T
SU9OX0lORk9TX1BST1BFUlRZID0KKwkJCW5ldyBDaGlsZExpc3RQcm9wZXJ0eURlc2NyaXB0b3Io
TWV0aG9kRGVjbGFyYXRpb24uY2xhc3MsICJleHRyYURpbWVuc2lvbkluZm9zIiwgRGltZW5zaW9u
SW5mby5jbGFzcywgTk9fQ1lDTEVfUklTSyk7IC8vJE5PTi1OTFMtMSQKIAogCS8qKgogCSAqIFRo
ZSAidHlwZVBhcmFtZXRlcnMiIHN0cnVjdHVyYWwgcHJvcGVydHkgb2YgdGhpcyBub2RlIHR5cGUg
KGVsZW1lbnQgdHlwZToge0BsaW5rIFR5cGVQYXJhbWV0ZXJ9KSAoYWRkZWQgaW4gSkxTMyBBUEkp
LgpAQCAtMjU4LDcgKzI2Nyw3IEBACiAJCWFkZFByb3BlcnR5KFJFQ0VJVkVSX1RZUEVfUFJPUEVS
VFksIHByb3BlcnR5TGlzdCk7CiAJCWFkZFByb3BlcnR5KFJFQ0VJVkVSX1FVQUxJRklFUl9QUk9Q
RVJUWSwgcHJvcGVydHlMaXN0KTsKIAkJYWRkUHJvcGVydHkoUEFSQU1FVEVSU19QUk9QRVJUWSwg
cHJvcGVydHlMaXN0KTsKLQkJYWRkUHJvcGVydHkoRVhUUkFfRElNRU5TSU9OU19QUk9QRVJUWSwg
cHJvcGVydHlMaXN0KTsKKwkJYWRkUHJvcGVydHkoRVhUUkFfRElNRU5TSU9OX0lORk9TX1BST1BF
UlRZLCBwcm9wZXJ0eUxpc3QpOwogCQlhZGRQcm9wZXJ0eShUSFJPV05fRVhDRVBUSU9OX1RZUEVT
X1BST1BFUlRZLCBwcm9wZXJ0eUxpc3QpOwogCQlhZGRQcm9wZXJ0eShCT0RZX1BST1BFUlRZLCBw
cm9wZXJ0eUxpc3QpOwogCQlQUk9QRVJUWV9ERVNDUklQVE9SU184XzAgPSByZWFwUHJvcGVydHlM
aXN0KHByb3BlcnR5TGlzdCk7CQpAQCAtMzQ0LDYgKzM1MywxMyBAQAogCXByaXZhdGUgaW50IGV4
dHJhQXJyYXlEaW1lbnNpb25zID0gMDsKIAogCS8qKgorCSAqIFRoZSBleHRyYSBkaW1lbnNpb24g
dHlwZXMgdGhpcyBub2RlIGhhcyBpZiBhbnkuCisJICogCisJICogQHNpbmNlIDMuOQorCSAqLwor
CXByb3RlY3RlZCBBU1ROb2RlLk5vZGVMaXN0IGV4dHJhRGltZW5zaW9uSW5mb3MgPSBudWxsOwor
CisJLyoqCiAJICogVGhlIGxpc3Qgb2YgdGhyb3duIGV4Y2VwdGlvbiBuYW1lcyAoZWxlbWVudCB0
eXBlOiB7QGxpbmsgTmFtZX0pLgogCSAqIERlZmF1bHRzIHRvIGFuIGVtcHR5IGxpc3QgZm9yIGFw
aSBsZXZlbHMgYmVsb3cgSkxTOC4KIAkgKi8KQEAgLTM4MCwxMCArMzk2LDExIEBACiAJCXN1cGVy
KGFzdCk7CiAJCWlmIChhc3QuYXBpTGV2ZWwgPj0gQVNULkpMUzNfSU5URVJOQUwpIHsKIAkJCXRo
aXMudHlwZVBhcmFtZXRlcnMgPSBuZXcgQVNUTm9kZS5Ob2RlTGlzdChUWVBFX1BBUkFNRVRFUlNf
UFJPUEVSVFkpOwotCQl9Ci0JCWlmIChhc3QuYXBpTGV2ZWwoKSA8IEFTVC5KTFM4KSB7CisJCX0g
CisJCWlmIChhc3QuYXBpTGV2ZWwgPCBBU1QuSkxTOCkgewogCQkJdGhpcy50aHJvd25FeGNlcHRp
b25zID0gbmV3IEFTVE5vZGUuTm9kZUxpc3QoVEhST1dOX0VYQ0VQVElPTlNfUFJPUEVSVFkpOwog
CQl9IGVsc2UgeworCQkJdGhpcy5leHRyYURpbWVuc2lvbkluZm9zID0gbmV3IEFTVE5vZGUuTm9k
ZUxpc3QoRVhUUkFfRElNRU5TSU9OX0lORk9TX1BST1BFUlRZKTsKIAkJCXRoaXMudGhyb3duRXhj
ZXB0aW9uVHlwZXMgPSBuZXcgQVNUTm9kZS5Ob2RlTGlzdChUSFJPV05fRVhDRVBUSU9OX1RZUEVT
X1BST1BFUlRZKTsKIAkJfQogCX0KQEAgLTUxNyw2ICs1MzQsOSBAQAogCQlpZiAocHJvcGVydHkg
PT0gVEhST1dOX0VYQ0VQVElPTl9UWVBFU19QUk9QRVJUWSkgewogCQkJcmV0dXJuIHRocm93bkV4
Y2VwdGlvblR5cGVzKCk7CiAJCX0JCQorCQlpZiAocHJvcGVydHkgPT0gRVhUUkFfRElNRU5TSU9O
X0lORk9TX1BST1BFUlRZKSB7CisJCQlyZXR1cm4gdGhpcy5leHRyYURpbWVuc2lvbkluZm9zOwor
CQl9CiAJCS8vIGFsbG93IGRlZmF1bHQgaW1wbGVtZW50YXRpb24gdG8gZmxhZyB0aGUgZXJyb3IK
IAkJcmV0dXJuIHN1cGVyLmludGVybmFsR2V0Q2hpbGRMaXN0UHJvcGVydHkocHJvcGVydHkpOwog
CX0KQEAgLTU3NCw3ICs1OTQsMTIgQEAKIAkJCXJlc3VsdC5zZXRSZWNlaXZlclF1YWxpZmllcigo
U2ltcGxlTmFtZSkgQVNUTm9kZS5jb3B5U3VidHJlZSh0YXJnZXQsIHRoaXMucmVjZWl2ZXJRdWFs
aWZpZXIpKTsKIAkJfQogCQlyZXN1bHQuc2V0Q29uc3RydWN0b3IoaXNDb25zdHJ1Y3RvcigpKTsK
LQkJcmVzdWx0LnNldEV4dHJhRGltZW5zaW9ucyhnZXRFeHRyYURpbWVuc2lvbnMoKSk7CisJCWlm
ICh0aGlzLmFzdC5hcGlMZXZlbCA+PSBBU1QuSkxTOCkgeworCQkJcmVzdWx0LmV4dHJhRGltZW5z
aW9uSW5mb3MuYWRkQWxsKAorCQkJCQlBU1ROb2RlLmNvcHlTdWJ0cmVlcyh0YXJnZXQsIGdldEV4
dHJhRGltZW5zaW9uSW5mb3MoKSkpOworCQl9IGVsc2UgeworCQkJcmVzdWx0LnNldEV4dHJhRGlt
ZW5zaW9ucyhnZXRFeHRyYURpbWVuc2lvbnMoKSk7CisJCX0KIAkJcmVzdWx0LnNldE5hbWUoKFNp
bXBsZU5hbWUpIGdldE5hbWUoKS5jbG9uZSh0YXJnZXQpKTsKIAkJcmVzdWx0LnBhcmFtZXRlcnMo
KS5hZGRBbGwoCiAJCQlBU1ROb2RlLmNvcHlTdWJ0cmVlcyh0YXJnZXQsIHBhcmFtZXRlcnMoKSkp
OwpAQCAtOTkxLDcgKzEwMTYsOCBAQAogCiAJLyoqCiAJICogUmV0dXJucyB0aGUgbnVtYmVyIG9m
IGV4dHJhIGFycmF5IGRpbWVuc2lvbnMgb3ZlciBhbmQgYWJvdmUgdGhlCi0JICogZXhwbGljaXRs
eS1zcGVjaWZpZWQgcmV0dXJuIHR5cGUuCisJICogZXhwbGljaXRseS1zcGVjaWZpZWQgcmV0dXJu
IHR5cGUgKE5vdCBzdXBwb3J0ZWQgaW4gSkxTOCBhbmQgYWJvdmUpLgorCSAqIEZvciBKTFM4IGxl
dmVsIGFuZCBhYm92ZSwgc2VlOiB7QGxpbmsgI2dldEV4dHJhRGltZW5zaW9uSW5mb3MoKX0uCiAJ
ICogPHA+CiAJICogRm9yIGV4YW1wbGUsIDxjb2RlPmludCBmb28oKVtdW108L2NvZGU+IGhhcyBh
IHJldHVybiB0eXBlIG9mCiAJICogPGNvZGU+aW50PC9jb2RlPiBhbmQgdHdvIGV4dHJhIGFycmF5
IGRpbWVuc2lvbnM7CkBAIC0xMDA1LDEyICsxMDMxLDE0IEBACiAJICogQHNpbmNlIDIuMQogCSAq
LwogCXB1YmxpYyBpbnQgZ2V0RXh0cmFEaW1lbnNpb25zKCkgeworCQlzdXBwb3J0ZWRPbmx5SW4y
XzNfNCgpOwogCQlyZXR1cm4gdGhpcy5leHRyYUFycmF5RGltZW5zaW9uczsKIAl9CiAKIAkvKioK
IAkgKiBTZXRzIHRoZSBudW1iZXIgb2YgZXh0cmEgYXJyYXkgZGltZW5zaW9ucyBvdmVyIGFuZCBh
Ym92ZSB0aGUKLQkgKiBleHBsaWNpdGx5LXNwZWNpZmllZCByZXR1cm4gdHlwZS4KKwkgKiBleHBs
aWNpdGx5LXNwZWNpZmllZCByZXR1cm4gdHlwZSAoTm90IHN1cHBvcnRlZCBpbiBKTFM4IGFuZCBh
Ym92ZSkuCisJICogRm9yIEpMUzggbGV2ZWwgYW5kIGFib3ZlLCBzZWU6IHtAbGluayAjZ2V0RXh0
cmFEaW1lbnNpb25JbmZvcygpfS4KIAkgKiA8cD4KIAkgKiBGb3IgZXhhbXBsZSwgPGNvZGU+aW50
IGZvbygpW11bXTwvY29kZT4gaXMgcmVuZGVyZWQgYXMgYSByZXR1cm4KIAkgKiB0eXBlIG9mIDxj
b2RlPmludDwvY29kZT4gd2l0aCB0d28gZXh0cmEgYXJyYXkgZGltZW5zaW9uczsKQEAgLTEwMjYs
MTIgKzEwNTQsMjQgQEAKIAkgKiBAc2luY2UgMi4xCiAJICovCiAJcHVibGljIHZvaWQgc2V0RXh0
cmFEaW1lbnNpb25zKGludCBkaW1lbnNpb25zKSB7CisJCXN1cHBvcnRlZE9ubHlJbjJfM180KCk7
CiAJCWlmIChkaW1lbnNpb25zIDwgMCkgewogCQkJdGhyb3cgbmV3IElsbGVnYWxBcmd1bWVudEV4
Y2VwdGlvbigpOwogCQl9CiAJCXByZVZhbHVlQ2hhbmdlKEVYVFJBX0RJTUVOU0lPTlNfUFJPUEVS
VFkpOwogCQl0aGlzLmV4dHJhQXJyYXlEaW1lbnNpb25zID0gZGltZW5zaW9uczsKIAkJcG9zdFZh
bHVlQ2hhbmdlKEVYVFJBX0RJTUVOU0lPTlNfUFJPUEVSVFkpOworCX0KKworCS8qKgorCSAqIFJl
dHVybnMgdGhlIGxpdmUgb3JkZXJlZCBsaXN0IG9mIGV4dHJhIGRpbWVuc2lvbnMgaWYgYW55IChK
TFM4IEFQSSBvbmx5KS4KKwkgKiAKKwkgKiBAcmV0dXJuIHRoZSBsaXZlIGxpc3Qgb2YgZXh0cmEg
ZGltZW5zaW9ucyBpZiBhbnkgKGVsZW1lbnQgdHlwZToge0BsaW5rIERpbWVuc2lvbkluZm99W10p
CisJICogQHNpbmNlIDMuOQorCSAqLworCXB1YmxpYyBMaXN0IGdldEV4dHJhRGltZW5zaW9uSW5m
b3MoKSB7CisJCXVuc3VwcG9ydGVkSW4yXzNfNCgpOworCQlyZXR1cm4gdGhpcy5leHRyYURpbWVu
c2lvbkluZm9zOwogCX0KIAogCS8qKgpAQCAtMTA5NCw3ICsxMTM0LDcgQEAKIAkgKiBNZXRob2Qg
ZGVjbGFyZWQgb24gQVNUTm9kZS4KIAkgKi8KIAlpbnQgbWVtU2l6ZSgpIHsKLQkJcmV0dXJuIHN1
cGVyLm1lbVNpemUoKSArIDEyICogNDsKKwkJcmV0dXJuIHN1cGVyLm1lbVNpemUoKSArIDEzICog
NDsKIAl9CiAKIAkvKiAob21pdCBqYXZhZG9jIGZvciB0aGlzIG1ldGhvZCkKQEAgLTExMTEsNyAr
MTE1MSw5IEBACiAJCQkrICh0aGlzLnJlY2VpdmVyUXVhbGlmaWVyID09IG51bGwgPyAwIDogdGhp
cy5yZWNlaXZlclF1YWxpZmllci50cmVlU2l6ZSgpKQogCQkJKyAodGhpcy5yZXR1cm5UeXBlID09
IG51bGwgPyAwIDogdGhpcy5yZXR1cm5UeXBlLnRyZWVTaXplKCkpCiAJCQkrIHRoaXMucGFyYW1l
dGVycy5saXN0U2l6ZSgpCi0JCQkrICh0aGlzLmFzdC5hcGlMZXZlbCA8IEFTVC5KTFM4ID8gdGhp
cy50aHJvd25FeGNlcHRpb25zLmxpc3RTaXplKCkgOiB0aGlzLnRocm93bkV4Y2VwdGlvblR5cGVz
Lmxpc3RTaXplKCkpCisJCQkrICh0aGlzLmFzdC5hcGlMZXZlbCA8IEFTVC5KTFM4ID8gCisJCQkJ
CXRoaXMudGhyb3duRXhjZXB0aW9ucy5saXN0U2l6ZSgpIAorCQkJCQk6IHRoaXMuZXh0cmFEaW1l
bnNpb25JbmZvcy5saXN0U2l6ZSgpICsgdGhpcy50aHJvd25FeGNlcHRpb25UeXBlcy5saXN0U2l6
ZSgpKQogCQkJKyAodGhpcy5vcHRpb25hbEJvZHkgPT0gbnVsbCA/IDAgOiBnZXRCb2R5KCkudHJl
ZVNpemUoKSk7CiAJfQogfQpkaWZmIC0tZ2l0IGEvb3JnLmVjbGlwc2UuamR0LmNvcmUvZG9tL29y
Zy9lY2xpcHNlL2pkdC9jb3JlL2RvbS9SZWNvdmVyZWRWYXJpYWJsZUJpbmRpbmcuamF2YSBiL29y
Zy5lY2xpcHNlLmpkdC5jb3JlL2RvbS9vcmcvZWNsaXBzZS9qZHQvY29yZS9kb20vUmVjb3ZlcmVk
VmFyaWFibGVCaW5kaW5nLmphdmEKaW5kZXggYmE1MTJmYy4uNmM5MTk0YyAxMDA2NDQKLS0tIGEv
b3JnLmVjbGlwc2UuamR0LmNvcmUvZG9tL29yZy9lY2xpcHNlL2pkdC9jb3JlL2RvbS9SZWNvdmVy
ZWRWYXJpYWJsZUJpbmRpbmcuamF2YQorKysgYi9vcmcuZWNsaXBzZS5qZHQuY29yZS9kb20vb3Jn
L2VjbGlwc2UvamR0L2NvcmUvZG9tL1JlY292ZXJlZFZhcmlhYmxlQmluZGluZy5qYXZhCkBAIC0x
LDUgKzEsNSBAQAogLyoqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioq
KioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioKLSAqIENvcHlyaWdodCAoYykgMjAw
NywgMjAwOSBJQk0gQ29ycG9yYXRpb24gYW5kIG90aGVycy4KKyAqIENvcHlyaWdodCAoYykgMjAw
NywgMjAxMyBJQk0gQ29ycG9yYXRpb24gYW5kIG90aGVycy4KICAqIEFsbCByaWdodHMgcmVzZXJ2
ZWQuIFRoaXMgcHJvZ3JhbSBhbmQgdGhlIGFjY29tcGFueWluZyBtYXRlcmlhbHMKICAqIGFyZSBt
YWRlIGF2YWlsYWJsZSB1bmRlciB0aGUgdGVybXMgb2YgdGhlIEVjbGlwc2UgUHVibGljIExpY2Vu
c2UgdjEuMAogICogd2hpY2ggYWNjb21wYW5pZXMgdGhpcyBkaXN0cmlidXRpb24sIGFuZCBpcyBh
dmFpbGFibGUgYXQKQEAgLTc3LDcgKzc3LDE2IEBACiAJcHVibGljIGJvb2xlYW4gaXNQYXJhbWV0
ZXIoKSB7CiAJCXJldHVybiB0aGlzLnZhcmlhYmxlRGVjbGFyYXRpb24gaW5zdGFuY2VvZiBTaW5n
bGVWYXJpYWJsZURlY2xhcmF0aW9uOwogCX0KLQorCXB1YmxpYyBpbnQgZ2V0RXh0cmFEaW1lbnNp
b25zKCkgeworCQlpZiAodGhpcy52YXJpYWJsZURlY2xhcmF0aW9uLmFzdC5hcGlMZXZlbCA+PSBB
U1QuSkxTOCkgeworCQkJaWYgKHRoaXMudmFyaWFibGVEZWNsYXJhdGlvbiBpbnN0YW5jZW9mIFZh
cmlhYmxlRGVjbGFyYXRpb25GcmFnbWVudCkgeworCQkJCXJldHVybiAoKFZhcmlhYmxlRGVjbGFy
YXRpb25GcmFnbWVudCkgdGhpcy52YXJpYWJsZURlY2xhcmF0aW9uKS5nZXRFeHRyYURpbWVuc2lv
bkluZm9zKCkuc2l6ZSgpOworCQkJfSBlbHNlIGlmICh0aGlzLnZhcmlhYmxlRGVjbGFyYXRpb24g
aW5zdGFuY2VvZiBTaW5nbGVWYXJpYWJsZURlY2xhcmF0aW9uKSB7CisJCQkJcmV0dXJuICgoU2lu
Z2xlVmFyaWFibGVEZWNsYXJhdGlvbikgdGhpcy52YXJpYWJsZURlY2xhcmF0aW9uKS5nZXRFeHRy
YURpbWVuc2lvbkluZm9zKCkuc2l6ZSgpOworCQkJfQorCQl9CisJCXJldHVybiB0aGlzLnZhcmlh
YmxlRGVjbGFyYXRpb24uZ2V0RXh0cmFEaW1lbnNpb25zKCk7CisJfQogCXB1YmxpYyBJQW5ub3Rh
dGlvbkJpbmRpbmdbXSBnZXRBbm5vdGF0aW9ucygpIHsKIAkJcmV0dXJuIEFubm90YXRpb25CaW5k
aW5nLk5vQW5ub3RhdGlvbnM7CiAJfQpAQCAtOTQsNyArMTAzLDcgQEAKIAkJCQkuYXBwZW5kKCJ2
YXJpYWJsZURlY2xhcmF0aW9uIikgLy8kTk9OLU5MUy0xJAogCQkJCS5hcHBlbmQodGhpcy52YXJp
YWJsZURlY2xhcmF0aW9uLmdldENsYXNzKCkpCiAJCQkJLmFwcGVuZCh0aGlzLnZhcmlhYmxlRGVj
bGFyYXRpb24uZ2V0TmFtZSgpLmdldElkZW50aWZpZXIoKSkKLQkJCQkuYXBwZW5kKHRoaXMudmFy
aWFibGVEZWNsYXJhdGlvbi5nZXRFeHRyYURpbWVuc2lvbnMoKSk7CisJCQkJLmFwcGVuZChnZXRF
eHRyYURpbWVuc2lvbnMoKSk7CiAJCX0KIAkJcmV0dXJuIFN0cmluZy52YWx1ZU9mKGJ1ZmZlcik7
CiAJfQpkaWZmIC0tZ2l0IGEvb3JnLmVjbGlwc2UuamR0LmNvcmUvZG9tL29yZy9lY2xpcHNlL2pk
dC9jb3JlL2RvbS9TaW5nbGVWYXJpYWJsZURlY2xhcmF0aW9uLmphdmEgYi9vcmcuZWNsaXBzZS5q
ZHQuY29yZS9kb20vb3JnL2VjbGlwc2UvamR0L2NvcmUvZG9tL1NpbmdsZVZhcmlhYmxlRGVjbGFy
YXRpb24uamF2YQppbmRleCA1YzI4YjA4Li41ZGQzZmQ2IDEwMDY0NAotLS0gYS9vcmcuZWNsaXBz
ZS5qZHQuY29yZS9kb20vb3JnL2VjbGlwc2UvamR0L2NvcmUvZG9tL1NpbmdsZVZhcmlhYmxlRGVj
bGFyYXRpb24uamF2YQorKysgYi9vcmcuZWNsaXBzZS5qZHQuY29yZS9kb20vb3JnL2VjbGlwc2Uv
amR0L2NvcmUvZG9tL1NpbmdsZVZhcmlhYmxlRGVjbGFyYXRpb24uamF2YQpAQCAtMzYsMTAgKzM2
LDExIEBACiAgKiBTaW5nbGVWYXJpYWJsZURlY2xhcmF0aW9uOgogICogICAgeyBFeHRlbmRlZE1v
ZGlmaWVyIH0gVHlwZSBbIDxiPi4uLjwvYj4gXSBJZGVudGlmaWVyIHsgPGI+WzwvYj48Yj5dPC9i
PiB9IFsgPGI+PTwvYj4gRXhwcmVzc2lvbiBdCiAgKiA8L3ByZT4KLSAqIEZvciBKTFM4LCB2YXJp
YWJsZSBhcmd1bWVudHMgYXJlIGFsbG93ZWQgdG8gaGF2ZSBvcHRpb25hbCBhbm5vdGF0aW9uczoK
KyAqIEZvciBKTFM4LCB2YXJpYWJsZSBkZWNsYXJhdGlvbnMgYW5kIGV4dHJhIGRpbWVuc2lvbnMg
b24gdmFyaWFibGUgZGVjbGFyYXRpb25zIGFyZSBhbGxvd2VkIHRvIAorICogaGF2ZSBvcHRpb25h
bCBhbm5vdGF0aW9uczoKICAqIDxwcmU+CiAgKiBTaW5nbGVWYXJpYWJsZURlY2xhcmF0aW9uOgot
ICogICAgeyBFeHRlbmRlZE1vZGlmaWVyIH0gVHlwZSB7QW5ub3RhdGlvbn0gWyA8Yj4uLi48L2I+
IF0gSWRlbnRpZmllciB7IDxiPls8L2I+PGI+XTwvYj4gfSBbIDxiPj08L2I+IEV4cHJlc3Npb24g
XQorICogICAgeyBFeHRlbmRlZE1vZGlmaWVyIH0gVHlwZSB7QW5ub3RhdGlvbn0gWyA8Yj4uLi48
L2I+IF0gSWRlbnRpZmllciB7IERpbWVuc2lvbkluZm8gfSBbIDxiPj08L2I+IEV4cHJlc3Npb24g
XQogICogPC9wcmU+CiAgKgogICogQHNpbmNlIDIuMApAQCAtOTAsMTEgKzkxLDE5IEBACiAJCW5l
dyBDaGlsZExpc3RQcm9wZXJ0eURlc2NyaXB0b3IoU2luZ2xlVmFyaWFibGVEZWNsYXJhdGlvbi5j
bGFzcywgInZhcmFyZ3NBbm5vdGF0aW9ucyIsIEFubm90YXRpb24uY2xhc3MsIE5PX0NZQ0xFX1JJ
U0spOyAvLyROT04tTkxTLTEkCiAKIAkvKioKLQkgKiBUaGUgImV4dHJhRGltZW5zaW9ucyIgc3Ry
dWN0dXJhbCBwcm9wZXJ0eSBvZiB0aGlzIG5vZGUgdHlwZSAodHlwZToge0BsaW5rIEludGVnZXJ9
KS4KKwkgKiBUaGUgImV4dHJhRGltZW5zaW9ucyIgc3RydWN0dXJhbCBwcm9wZXJ0eSBvZiB0aGlz
IG5vZGUgdHlwZSAodHlwZToge0BsaW5rIEludGVnZXJ9KS4gVGhpcyBwcm9wZXJ0eSBpcyBzdXBw
b3J0ZWQKKwkgKiBvbmx5IGluIEpMUzQgb3IgYmVsb3cuIEZvciBKTFM4IGFuZCBhYm92ZSwgdXNl
IDxjb2RlPkVYVFJBX0RJTUVOU0lPTl9UWVBFU19QUk9QRVJUWTwvY29kZT4uCiAJICogQHNpbmNl
IDMuMAogCSAqLwogCXB1YmxpYyBzdGF0aWMgZmluYWwgU2ltcGxlUHJvcGVydHlEZXNjcmlwdG9y
IEVYVFJBX0RJTUVOU0lPTlNfUFJPUEVSVFkgPQogCQluZXcgU2ltcGxlUHJvcGVydHlEZXNjcmlw
dG9yKFNpbmdsZVZhcmlhYmxlRGVjbGFyYXRpb24uY2xhc3MsICJleHRyYURpbWVuc2lvbnMiLCBp
bnQuY2xhc3MsIE1BTkRBVE9SWSk7IC8vJE5PTi1OTFMtMSQKKworCS8qKgorCSAqIFRoZSAiZXh0
cmFEaW1lbnNpb25JbmZvcyIgc3RydWN0dXJhbCBwcm9wZXJ0eSBvZiB0aGlzIG5vZGUgdHlwZSAo
Y2hpbGQgdHlwZToge0BsaW5rIERpbWVuc2lvbkluZm99KSAoYWRkZWQgaW4gSkxTOCBBUEkpLgor
CSAqIEBzaW5jZSAzLjkKKwkgKi8KKwlwdWJsaWMgc3RhdGljIGZpbmFsIENoaWxkTGlzdFByb3Bl
cnR5RGVzY3JpcHRvciBFWFRSQV9ESU1FTlNJT05fSU5GT1NfUFJPUEVSVFkgPQorCQkJbmV3IENo
aWxkTGlzdFByb3BlcnR5RGVzY3JpcHRvcihTaW5nbGVWYXJpYWJsZURlY2xhcmF0aW9uLmNsYXNz
LCAiZXh0cmFEaW1lbnNpb25JbmZvcyIsIERpbWVuc2lvbkluZm8uY2xhc3MsIE5PX0NZQ0xFX1JJ
U0spOyAvLyROT04tTkxTLTEkCiAKIAkvKioKIAkgKiBUaGUgImluaXRpYWxpemVyIiBzdHJ1Y3R1
cmFsIHByb3BlcnR5IG9mIHRoaXMgbm9kZSB0eXBlIChjaGlsZCB0eXBlOiB7QGxpbmsgRXhwcmVz
c2lvbn0pLgpAQCAtMTU1LDcgKzE2NCw3IEBACiAJCWFkZFByb3BlcnR5KFZBUkFSR1NfQU5OT1RB
VElPTlNfUFJPUEVSVFksIHByb3BlcnR5TGlzdCk7CiAJCWFkZFByb3BlcnR5KFZBUkFSR1NfUFJP
UEVSVFksIHByb3BlcnR5TGlzdCk7CiAJCWFkZFByb3BlcnR5KE5BTUVfUFJPUEVSVFksIHByb3Bl
cnR5TGlzdCk7Ci0JCWFkZFByb3BlcnR5KEVYVFJBX0RJTUVOU0lPTlNfUFJPUEVSVFksIHByb3Bl
cnR5TGlzdCk7CisJCWFkZFByb3BlcnR5KEVYVFJBX0RJTUVOU0lPTl9JTkZPU19QUk9QRVJUWSwg
cHJvcGVydHlMaXN0KTsKIAkJYWRkUHJvcGVydHkoSU5JVElBTElaRVJfUFJPUEVSVFksIHByb3Bl
cnR5TGlzdCk7CiAJCVBST1BFUlRZX0RFU0NSSVBUT1JTXzhfMCA9IHJlYXBQcm9wZXJ0eUxpc3Qo
cHJvcGVydHlMaXN0KTsJCQogCQpAQCAtMjI1LDYgKzIzNCwxMyBAQAogCXByaXZhdGUgaW50IGV4
dHJhQXJyYXlEaW1lbnNpb25zID0gMDsKIAogCS8qKgorCSAqIExpc3Qgb2YgZXh0cmEgZGltZW5z
aW9ucyB0aGlzIG5vZGUgaGFzLgorCSAqIAorCSAqIEBzaW5jZSAzLjkKKwkgKi8KKwlwcm90ZWN0
ZWQgQVNUTm9kZS5Ob2RlTGlzdCBleHRyYURpbWVuc2lvbkluZm9zID0gbnVsbDsKKworCS8qKgog
CSAqIFRoZSBpbml0aWFsaXplciBleHByZXNzaW9uLCBvciA8Y29kZT5udWxsPC9jb2RlPiBpZiBu
b25lOwogCSAqIGRlZmF1bHRzIHRvIG5vbmUuCiAJICovCkBAIC0yNTMsNiArMjY5LDcgQEAKIAkJ
CXRoaXMubW9kaWZpZXJzID0gbmV3IEFTVE5vZGUuTm9kZUxpc3QoTU9ESUZJRVJTMl9QUk9QRVJU
WSk7CiAJCQlpZiAoYXN0LmFwaUxldmVsID49IEFTVC5KTFM4KSB7CiAJCQkJdGhpcy52YXJhcmdz
QW5ub3RhdGlvbnMgPSBuZXcgQVNUTm9kZS5Ob2RlTGlzdChWQVJBUkdTX0FOTk9UQVRJT05TX1BS
T1BFUlRZKTsKKwkJCQl0aGlzLmV4dHJhRGltZW5zaW9uSW5mb3MgPSBuZXcgQVNUTm9kZS5Ob2Rl
TGlzdChFWFRSQV9ESU1FTlNJT05fSU5GT1NfUFJPUEVSVFkpOwogCQkJfQogCQl9CiAJfQpAQCAt
MzcwLDYgKzM4Nyw5IEBACiAJCWlmIChwcm9wZXJ0eSA9PSBWQVJBUkdTX0FOTk9UQVRJT05TX1BS
T1BFUlRZKSB7CiAJCQlyZXR1cm4gdmFyYXJnc0Fubm90YXRpb25zKCk7CiAJCX0KKwkJaWYgKHBy
b3BlcnR5ID09IEVYVFJBX0RJTUVOU0lPTl9JTkZPU19QUk9QRVJUWSkgeworCQkJcmV0dXJuIHRo
aXMuZXh0cmFEaW1lbnNpb25JbmZvczsKKwkJfQogCQkvLyBhbGxvdyBkZWZhdWx0IGltcGxlbWVu
dGF0aW9uIHRvIGZsYWcgdGhlIGVycm9yCiAJCXJldHVybiBzdXBlci5pbnRlcm5hbEdldENoaWxk
TGlzdFByb3BlcnR5KHByb3BlcnR5KTsKIAl9CkBAIC0zOTQsNyArNDE0LDEyIEBACiAJCQlyZXN1
bHQuc2V0VmFyYXJncyhpc1ZhcmFyZ3MoKSk7CiAJCX0KIAkJcmVzdWx0LnNldFR5cGUoKFR5cGUp
IGdldFR5cGUoKS5jbG9uZSh0YXJnZXQpKTsKLQkJcmVzdWx0LnNldEV4dHJhRGltZW5zaW9ucyhn
ZXRFeHRyYURpbWVuc2lvbnMoKSk7CisJCWlmICh0aGlzLmFzdC5hcGlMZXZlbCA+PSBBU1QuSkxT
OCkgeworCQkJcmVzdWx0LmV4dHJhRGltZW5zaW9uSW5mb3MuYWRkQWxsKAorCQkJCQlBU1ROb2Rl
LmNvcHlTdWJ0cmVlcyh0YXJnZXQsIHRoaXMuZXh0cmFEaW1lbnNpb25JbmZvcykpOworCQl9IGVs
c2UgeworCQkJcmVzdWx0LnNldEV4dHJhRGltZW5zaW9ucyhnZXRFeHRyYURpbWVuc2lvbnMoKSk7
CisJCX0KIAkJcmVzdWx0LnNldE5hbWUoKFNpbXBsZU5hbWUpIGdldE5hbWUoKS5jbG9uZSh0YXJn
ZXQpKTsKIAkJcmVzdWx0LnNldEluaXRpYWxpemVyKAogCQkJKEV4cHJlc3Npb24pIEFTVE5vZGUu
Y29weVN1YnRyZWUodGFyZ2V0LCBnZXRJbml0aWFsaXplcigpKSk7CkBAIC02MzMsMjUgKzY1OCw1
MCBAQAogCQlwb3N0VmFsdWVDaGFuZ2UoVkFSQVJHU19QUk9QRVJUWSk7CiAJfQogCi0JLyogKG9t
aXQgamF2YWRvYyBmb3IgdGhpcyBtZXRob2QpCi0JICogTWV0aG9kIGRlY2xhcmVkIG9uIFZhcmlh
YmxlRGVjbGFyYXRpb24uCisJLyoqCisJICogUmV0dXJucyB0aGUgbnVtYmVyIG9mIGV4dHJhIGFy
cmF5IGRpbWVuc2lvbnMgb3ZlciBhbmQgYWJvdmUgdGhlCisJICogZXhwbGljaXRseS1zcGVjaWZp
ZWQgdHlwZSAoTm90IHN1cHBvcnRlZCBpbiBKTFM4IGFuZCBhYm92ZSkuIAorCSAqIEZvciBKTFM4
IGxldmVsIGFuZCBhYm92ZSwgc2VlOiB7QGxpbmsgI2dldEV4dHJhRGltZW5zaW9uSW5mb3MoKX0u
CisJICoKKwkgKiBAc2VlIFZhcmlhYmxlRGVjbGFyYXRpb24jZ2V0RXh0cmFEaW1lbnNpb25zKCkK
KwkgKiBAcmV0dXJuIHRoZSBudW1iZXIgb2YgZXh0cmEgYXJyYXkgZGltZW5zaW9ucwogCSAqIEBz
aW5jZSAyLjEKIAkgKi8KIAlwdWJsaWMgaW50IGdldEV4dHJhRGltZW5zaW9ucygpIHsKKwkJc3Vw
cG9ydGVkT25seUluMl8zXzQoKTsKIAkJcmV0dXJuIHRoaXMuZXh0cmFBcnJheURpbWVuc2lvbnM7
CiAJfQogCi0JLyogKG9taXQgamF2YWRvYyBmb3IgdGhpcyBtZXRob2QpCi0JICogTWV0aG9kIGRl
Y2xhcmVkIG9uIFZhcmlhYmxlRGVjbGFyYXRpb24uCisJLyoqCisJICogU2V0cyB0aGUgbnVtYmVy
IG9mIGV4dHJhIGFycmF5IGRpbWVuc2lvbnMgb3ZlciBhbmQgYWJvdmUgdGhlCisJICogZXhwbGlj
aXRseS1zcGVjaWZpZWQgdHlwZSAoTm90IHN1cHBvcnRlZCBpbiBKTFM4IGFuZCBhYm92ZSkuCisJ
ICogRm9yIEpMUzggbGV2ZWwgYW5kIGFib3ZlLCBzZWU6IHtAbGluayAjZ2V0RXh0cmFEaW1lbnNp
b25JbmZvcygpfS4KKwkgKgorCSAqIEBzZWUgVmFyaWFibGVEZWNsYXJhdGlvbiNnZXRFeHRyYURp
bWVuc2lvbnMoKQorCSAqIEBwYXJhbSBkaW1lbnNpb25zIHRoZSBudW1iZXIgb2YgYXJyYXkgZGlt
ZW5zaW9ucworCSAqIEBleGNlcHRpb24gSWxsZWdhbEFyZ3VtZW50RXhjZXB0aW9uIGlmIHRoZSBu
dW1iZXIgb2YgZGltZW5zaW9ucyBpcworCSAqICAgIG5lZ2F0aXZlCiAJICogQHNpbmNlIDIuMQog
CSAqLwogCXB1YmxpYyB2b2lkIHNldEV4dHJhRGltZW5zaW9ucyhpbnQgZGltZW5zaW9ucykgewor
CQlzdXBwb3J0ZWRPbmx5SW4yXzNfNCgpOwogCQlpZiAoZGltZW5zaW9ucyA8IDApIHsKIAkJCXRo
cm93IG5ldyBJbGxlZ2FsQXJndW1lbnRFeGNlcHRpb24oKTsKIAkJfQogCQlwcmVWYWx1ZUNoYW5n
ZShFWFRSQV9ESU1FTlNJT05TX1BST1BFUlRZKTsKIAkJdGhpcy5leHRyYUFycmF5RGltZW5zaW9u
cyA9IGRpbWVuc2lvbnM7CiAJCXBvc3RWYWx1ZUNoYW5nZShFWFRSQV9ESU1FTlNJT05TX1BST1BF
UlRZKTsKKwl9CisKKwkvKioKKwkgKiBSZXR1cm5zIHRoZSBsaXZlIG9yZGVyZWQgbGlzdCBvZiBl
eHRyYSBkaW1lbnNpb25zIChKTFM4IEFQSSBvbmx5KS4KKwkgKgorCSAqIEByZXR1cm4gdGhlIGxp
dmUgbGlzdCBvZiBleHRyYSBkaW1lbnNpb25zIChlbGVtZW50IHR5cGU6IHtAbGluayBEaW1lbnNp
b25JbmZvfVtdKQorCSAqIEBzaW5jZSAzLjkKKwkgKi8KKwlwdWJsaWMgTGlzdCBnZXRFeHRyYURp
bWVuc2lvbkluZm9zKCkgeworCQl1bnN1cHBvcnRlZEluMl8zXzQoKTsKKwkJcmV0dXJuIHRoaXMu
ZXh0cmFEaW1lbnNpb25JbmZvczsKIAl9CiAKIAkvKiAob21pdCBqYXZhZG9jIGZvciB0aGlzIG1l
dGhvZCkKQEAgLTY5Myw3ICs3NDMsNyBAQAogCSAqLwogCWludCBtZW1TaXplKCkgewogCQkvLyB0
cmVhdCBPcGVyYXRvciBhcyBmcmVlCi0JCXJldHVybiBCQVNFX05PREVfU0laRSArIDggKiA0Owor
CQlyZXR1cm4gQkFTRV9OT0RFX1NJWkUgKyA5ICogNDsKIAl9CiAKIAkvKiAob21pdCBqYXZhZG9j
IGZvciB0aGlzIG1ldGhvZCkKQEAgLTcwNCw2ICs3NTQsNyBAQAogCQkJbWVtU2l6ZSgpCiAJCQkr
ICh0aGlzLnZhcmFyZ3NBbm5vdGF0aW9ucyA9PSBudWxsID8gMCA6IHRoaXMudmFyYXJnc0Fubm90
YXRpb25zLmxpc3RTaXplKCkpCiAJCQkrICh0aGlzLm1vZGlmaWVycyA9PSBudWxsID8gMCA6IHRo
aXMubW9kaWZpZXJzLmxpc3RTaXplKCkpCisJCQkrICh0aGlzLmV4dHJhRGltZW5zaW9uSW5mb3Mg
PT0gbnVsbCA/IDAgOiB0aGlzLmV4dHJhRGltZW5zaW9uSW5mb3MubGlzdFNpemUoKSkKIAkJCSsg
KHRoaXMudHlwZSA9PSBudWxsID8gMCA6IGdldFR5cGUoKS50cmVlU2l6ZSgpKQogCQkJKyAodGhp
cy52YXJpYWJsZU5hbWUgPT0gbnVsbCA/IDAgOiBnZXROYW1lKCkudHJlZVNpemUoKSkKIAkJCSsg
KHRoaXMub3B0aW9uYWxJbml0aWFsaXplciA9PSBudWxsID8gMCA6IGdldEluaXRpYWxpemVyKCku
dHJlZVNpemUoKSk7CmRpZmYgLS1naXQgYS9vcmcuZWNsaXBzZS5qZHQuY29yZS9kb20vb3JnL2Vj
bGlwc2UvamR0L2NvcmUvZG9tL1ZhcmlhYmxlRGVjbGFyYXRpb25GcmFnbWVudC5qYXZhIGIvb3Jn
LmVjbGlwc2UuamR0LmNvcmUvZG9tL29yZy9lY2xpcHNlL2pkdC9jb3JlL2RvbS9WYXJpYWJsZURl
Y2xhcmF0aW9uRnJhZ21lbnQuamF2YQppbmRleCBlOWRlN2M4Li4wNTYwODBiIDEwMDY0NAotLS0g
YS9vcmcuZWNsaXBzZS5qZHQuY29yZS9kb20vb3JnL2VjbGlwc2UvamR0L2NvcmUvZG9tL1Zhcmlh
YmxlRGVjbGFyYXRpb25GcmFnbWVudC5qYXZhCisrKyBiL29yZy5lY2xpcHNlLmpkdC5jb3JlL2Rv
bS9vcmcvZWNsaXBzZS9qZHQvY29yZS9kb20vVmFyaWFibGVEZWNsYXJhdGlvbkZyYWdtZW50Lmph
dmEKQEAgLTI1LDcgKzI1LDEyIEBACiAgKiBWYXJpYWJsZURlY2xhcmF0aW9uRnJhZ21lbnQ6CiAg
KiAgICBJZGVudGlmaWVyIHsgPGI+WzwvYj48Yj5dPC9iPiB9IFsgPGI+PTwvYj4gRXhwcmVzc2lv
biBdCiAgKiA8L3ByZT4KLSAqCisgKiBGb3IgSkxTOCwgdmFyaWFibGUgZnJhZ21lbnRzIGFuZCBl
eHRyYSBkaW1lbnNpb25zIG9uIGZyYWdtZW50cyBhcmUgYWxsb3dlZCB0byBoYXZlIG9wdGlvbmFs
IGFubm90YXRpb25zCisgKiBhbmQgdGhlIGV4dHJhIGRpbWVuc2lvbnMgYXJlIHJlcHJlc2VudGVk
IGJ5IHtAbGluayBEaW1lbnNpb25JbmZvfS4KKyAqIDxwcmU+CisgKiBWYXJpYWJsZURlY2xhcmF0
aW9uRnJhZ21lbnQ6CisgKiAgICBJZGVudGlmaWVyIHsgRGltZW5zaW9uSW5mbyB9IFsgPGI+PTwv
Yj4gRXhwcmVzc2lvbiBdCisgKiA8L3ByZT4KICAqIEBzaW5jZSAyLjAKICAqIEBub2luc3RhbnRp
YXRlIFRoaXMgY2xhc3MgaXMgbm90IGludGVuZGVkIHRvIGJlIGluc3RhbnRpYXRlZCBieSBjbGll
bnRzLgogICovCkBAIC0zOSwxMSArNDQsMTkgQEAKIAkJbmV3IENoaWxkUHJvcGVydHlEZXNjcmlw
dG9yKFZhcmlhYmxlRGVjbGFyYXRpb25GcmFnbWVudC5jbGFzcywgIm5hbWUiLCBTaW1wbGVOYW1l
LmNsYXNzLCBNQU5EQVRPUlksIE5PX0NZQ0xFX1JJU0spOyAvLyROT04tTkxTLTEkCiAKIAkvKioK
LQkgKiBUaGUgImV4dHJhRGltZW5zaW9ucyIgc3RydWN0dXJhbCBwcm9wZXJ0eSBvZiB0aGlzIG5v
ZGUgdHlwZSAodHlwZToge0BsaW5rIEludGVnZXJ9KS4KKwkgKiBUaGUgImV4dHJhRGltZW5zaW9u
cyIgc3RydWN0dXJhbCBwcm9wZXJ0eSBvZiB0aGlzIG5vZGUgdHlwZSAodHlwZToge0BsaW5rIElu
dGVnZXJ9KS4gVGhpcyBwcm9wZXJ0eSBpcyBzdXBwb3J0ZWQKKwkgKiBvbmx5IGluIEpMUzQgb3Ig
YmVsb3cuIEZvciBKTFM4IGFuZCBhYm92ZSwgdXNlIDxjb2RlPkVYVFJBX0RJTUVOU0lPTl9UWVBF
U19QUk9QRVJUWTwvY29kZT4uCiAJICogQHNpbmNlIDMuMAogCSAqLwogCXB1YmxpYyBzdGF0aWMg
ZmluYWwgU2ltcGxlUHJvcGVydHlEZXNjcmlwdG9yIEVYVFJBX0RJTUVOU0lPTlNfUFJPUEVSVFkg
PQogCQluZXcgU2ltcGxlUHJvcGVydHlEZXNjcmlwdG9yKFZhcmlhYmxlRGVjbGFyYXRpb25GcmFn
bWVudC5jbGFzcywgImV4dHJhRGltZW5zaW9ucyIsIGludC5jbGFzcywgTUFOREFUT1JZKTsgLy8k
Tk9OLU5MUy0xJAorCisJLyoqCisJICogVGhlICJleHRyYURpbWVuc2lvbkluZm9zIiBzdHJ1Y3R1
cmFsIHByb3BlcnR5IG9mIHRoaXMgbm9kZSB0eXBlIChjaGlsZCB0eXBlOiB7QGxpbmsgRGltZW5z
aW9uSW5mb30pIChBZGRlZCBpbiBKTFM4IEFQSSkuCisJICogQHNpbmNlIDMuOQorCSAqLworCXB1
YmxpYyBzdGF0aWMgZmluYWwgQ2hpbGRMaXN0UHJvcGVydHlEZXNjcmlwdG9yIEVYVFJBX0RJTUVO
U0lPTl9JTkZPU19QUk9QRVJUWSA9CisJCQluZXcgQ2hpbGRMaXN0UHJvcGVydHlEZXNjcmlwdG9y
KFZhcmlhYmxlRGVjbGFyYXRpb25GcmFnbWVudC5jbGFzcywgImV4dHJhRGltZW5zaW9uSW5mb3Mi
LCBEaW1lbnNpb25JbmZvLmNsYXNzLCBOT19DWUNMRV9SSVNLKTsgLy8kTk9OLU5MUy0xJAogCiAJ
LyoqCiAJICogVGhlICJpbml0aWFsaXplciIgc3RydWN0dXJhbCBwcm9wZXJ0eSBvZiB0aGlzIG5v
ZGUgdHlwZSAoY2hpbGQgdHlwZToge0BsaW5rIEV4cHJlc3Npb259KS4KQEAgLTYwLDYgKzczLDE0
IEBACiAJICovCiAJcHJpdmF0ZSBzdGF0aWMgZmluYWwgTGlzdCBQUk9QRVJUWV9ERVNDUklQVE9S
UzsKIAorCS8qKgorCSAqIEEgbGlzdCBvZiBwcm9wZXJ0eSBkZXNjcmlwdG9ycyAoZWxlbWVudCB0
eXBlOgorCSAqIHtAbGluayBTdHJ1Y3R1cmFsUHJvcGVydHlEZXNjcmlwdG9yfSksCisJICogb3Ig
bnVsbCBpZiB1bmluaXRpYWxpemVkLgorCSAqIEBzaW5jZSAzLjkKKwkgKi8KKwlwcml2YXRlIHN0
YXRpYyBmaW5hbCBMaXN0IFBST1BFUlRZX0RFU0NSSVBUT1JTXzhfMDsKKwogCXN0YXRpYyB7CiAJ
CUxpc3QgcHJvcGVydHlMaXN0ID0gbmV3IEFycmF5TGlzdCg0KTsKIAkJY3JlYXRlUHJvcGVydHlM
aXN0KFZhcmlhYmxlRGVjbGFyYXRpb25GcmFnbWVudC5jbGFzcywgcHJvcGVydHlMaXN0KTsKQEAg
LTY3LDYgKzg4LDEzIEBACiAJCWFkZFByb3BlcnR5KEVYVFJBX0RJTUVOU0lPTlNfUFJPUEVSVFks
IHByb3BlcnR5TGlzdCk7CiAJCWFkZFByb3BlcnR5KElOSVRJQUxJWkVSX1BST1BFUlRZLCBwcm9w
ZXJ0eUxpc3QpOwogCQlQUk9QRVJUWV9ERVNDUklQVE9SUyA9IHJlYXBQcm9wZXJ0eUxpc3QocHJv
cGVydHlMaXN0KTsKKworCQlwcm9wZXJ0eUxpc3QgPSBuZXcgQXJyYXlMaXN0KDQpOworCQljcmVh
dGVQcm9wZXJ0eUxpc3QoVmFyaWFibGVEZWNsYXJhdGlvbkZyYWdtZW50LmNsYXNzLCBwcm9wZXJ0
eUxpc3QpOworCQlhZGRQcm9wZXJ0eShOQU1FX1BST1BFUlRZLCBwcm9wZXJ0eUxpc3QpOworCQlh
ZGRQcm9wZXJ0eShFWFRSQV9ESU1FTlNJT05fSU5GT1NfUFJPUEVSVFksIHByb3BlcnR5TGlzdCk7
CisJCWFkZFByb3BlcnR5KElOSVRJQUxJWkVSX1BST1BFUlRZLCBwcm9wZXJ0eUxpc3QpOworCQlQ
Uk9QRVJUWV9ERVNDUklQVE9SU184XzAgPSByZWFwUHJvcGVydHlMaXN0KHByb3BlcnR5TGlzdCk7
CiAJfQogCiAJLyoqCkBAIC04MCw3ICsxMDgsMTEgQEAKIAkgKiBAc2luY2UgMy4wCiAJICovCiAJ
cHVibGljIHN0YXRpYyBMaXN0IHByb3BlcnR5RGVzY3JpcHRvcnMoaW50IGFwaUxldmVsKSB7Ci0J
CXJldHVybiBQUk9QRVJUWV9ERVNDUklQVE9SUzsKKwkJaWYgKGFwaUxldmVsID49IEFTVC5KTFM4
KSB7CisJCQlyZXR1cm4gUFJPUEVSVFlfREVTQ1JJUFRPUlNfOF8wOworCQl9IGVsc2UgeworCQkJ
cmV0dXJuIFBST1BFUlRZX0RFU0NSSVBUT1JTOworCQl9CiAJfQogCiAJLyoqCkBAIC05NCw2ICsx
MjYsMTMgQEAKIAkgKiBkZWZhdWx0cyB0byAwLgogCSAqLwogCXByaXZhdGUgaW50IGV4dHJhQXJy
YXlEaW1lbnNpb25zID0gMDsKKworCS8qKgorCSAqIFRoZSBleHRyYSBkaW1lbnNpb25zIHRoaXMg
bm9kZSBoYXMgd2l0aCBhbm5vdGF0aW9ucyBpZiBhbnkuCisJICoKKwkgKiBAc2luY2UgMy45CisJ
ICovCisJcHJvdGVjdGVkIEFTVE5vZGUuTm9kZUxpc3QgZXh0cmFEaW1lbnNpb25JbmZvcyA9IG51
bGw7CiAKIAkvKioKIAkgKiBUaGUgaW5pdGlhbGl6ZXIgZXhwcmVzc2lvbiwgb3IgPGNvZGU+bnVs
bDwvY29kZT4gaWYgbm9uZTsKQEAgLTExMyw2ICsxNTIsOSBAQAogCSAqLwogCVZhcmlhYmxlRGVj
bGFyYXRpb25GcmFnbWVudChBU1QgYXN0KSB7CiAJCXN1cGVyKGFzdCk7CisJCWlmIChhc3QuYXBp
TGV2ZWwgPj0gQVNULkpMUzgpIHsKKwkJCXRoaXMuZXh0cmFEaW1lbnNpb25JbmZvcyA9IG5ldyBB
U1ROb2RlLk5vZGVMaXN0KEVYVFJBX0RJTUVOU0lPTl9JTkZPU19QUk9QRVJUWSk7CisJCX0KIAl9
CiAKIAkvKiAob21pdCBqYXZhZG9jIGZvciB0aGlzIG1ldGhvZCkKQEAgLTE4OSw2ICsyMzEsMTcg
QEAKIAkvKiAob21pdCBqYXZhZG9jIGZvciB0aGlzIG1ldGhvZCkKIAkgKiBNZXRob2QgZGVjbGFy
ZWQgb24gQVNUTm9kZS4KIAkgKi8KKwlmaW5hbCBMaXN0IGludGVybmFsR2V0Q2hpbGRMaXN0UHJv
cGVydHkoQ2hpbGRMaXN0UHJvcGVydHlEZXNjcmlwdG9yIHByb3BlcnR5KSB7CisJCWlmIChwcm9w
ZXJ0eSA9PSBFWFRSQV9ESU1FTlNJT05fSU5GT1NfUFJPUEVSVFkpIHsKKwkJCXJldHVybiB0aGlz
LmV4dHJhRGltZW5zaW9uSW5mb3M7CisJCX0KKwkJLy8gYWxsb3cgZGVmYXVsdCBpbXBsZW1lbnRh
dGlvbiB0byBmbGFnIHRoZSBlcnJvcgorCQlyZXR1cm4gc3VwZXIuaW50ZXJuYWxHZXRDaGlsZExp
c3RQcm9wZXJ0eShwcm9wZXJ0eSk7CisJfQorCisJLyogKG9taXQgamF2YWRvYyBmb3IgdGhpcyBt
ZXRob2QpCisJICogTWV0aG9kIGRlY2xhcmVkIG9uIEFTVE5vZGUuCisJICovCiAJZmluYWwgaW50
IGdldE5vZGVUeXBlMCgpIHsKIAkJcmV0dXJuIFZBUklBQkxFX0RFQ0xBUkFUSU9OX0ZSQUdNRU5U
OwogCX0KQEAgLTIwMCw3ICsyNTMsMTIgQEAKIAkJVmFyaWFibGVEZWNsYXJhdGlvbkZyYWdtZW50
IHJlc3VsdCA9IG5ldyBWYXJpYWJsZURlY2xhcmF0aW9uRnJhZ21lbnQodGFyZ2V0KTsKIAkJcmVz
dWx0LnNldFNvdXJjZVJhbmdlKGdldFN0YXJ0UG9zaXRpb24oKSwgZ2V0TGVuZ3RoKCkpOwogCQly
ZXN1bHQuc2V0TmFtZSgoU2ltcGxlTmFtZSkgZ2V0TmFtZSgpLmNsb25lKHRhcmdldCkpOwotCQly
ZXN1bHQuc2V0RXh0cmFEaW1lbnNpb25zKGdldEV4dHJhRGltZW5zaW9ucygpKTsKKwkJaWYgKHRo
aXMuYXN0LmFwaUxldmVsID49IEFTVC5KTFM4KSB7CisJCQlyZXN1bHQuZXh0cmFEaW1lbnNpb25J
bmZvcy5hZGRBbGwoCisJCQkJCUFTVE5vZGUuY29weVN1YnRyZWVzKHRhcmdldCwgdGhpcy5leHRy
YURpbWVuc2lvbkluZm9zKSk7CisJCX0gZWxzZSB7CisJCQlyZXN1bHQuc2V0RXh0cmFEaW1lbnNp
b25zKGdldEV4dHJhRGltZW5zaW9ucygpKTsKKwkJfQogCQlyZXN1bHQuc2V0SW5pdGlhbGl6ZXIo
CiAJCQkoRXhwcmVzc2lvbikgQVNUTm9kZS5jb3B5U3VidHJlZSh0YXJnZXQsIGdldEluaXRpYWxp
emVyKCkpKTsKIAkJcmV0dXJuIHJlc3VsdDsKQEAgLTIyMyw2ICsyODEsMTAgQEAKIAkJCS8vIHZp
c2l0IGNoaWxkcmVuIGluIG5vcm1hbCBsZWZ0IHRvIHJpZ2h0IHJlYWRpbmcgb3JkZXIKIAkJCWFj
Y2VwdENoaWxkKHZpc2l0b3IsIGdldE5hbWUoKSk7CiAJCQlhY2NlcHRDaGlsZCh2aXNpdG9yLCBn
ZXRJbml0aWFsaXplcigpKTsKKworCQkJaWYgKHRoaXMuYXN0LmFwaUxldmVsID49IEFTVC5KTFM4
KSB7CisJCQkJYWNjZXB0Q2hpbGRyZW4odmlzaXRvciwgdGhpcy5leHRyYURpbWVuc2lvbkluZm9z
KTsKKwkJCX0KIAkJfQogCQl2aXNpdG9yLmVuZFZpc2l0KHRoaXMpOwogCX0KQEAgLTI1OSw3ICsz
MjEsOCBAQAogCiAJLyoqCiAJICogUmV0dXJucyB0aGUgbnVtYmVyIG9mIGV4dHJhIGFycmF5IGRp
bWVuc2lvbnMgdGhpcyB2YXJpYWJsZSBoYXMgb3ZlcgotCSAqIGFuZCBhYm92ZSB0aGUgdHlwZSBz
cGVjaWZpZWQgaW4gdGhlIGVuY2xvc2luZyBkZWNsYXJhdGlvbi4KKwkgKiBhbmQgYWJvdmUgdGhl
IHR5cGUgc3BlY2lmaWVkIGluIHRoZSBlbmNsb3NpbmcgZGVjbGFyYXRpb24gKE5vdCBzdXBwb3J0
ZWQgCisJICogaW4gSkxTOCBhbmQgYWJvdmUpLiBGb3IgSkxTOCBsZXZlbCBhbmQgYWJvdmUsIHNl
ZToge0BsaW5rICNnZXRFeHRyYURpbWVuc2lvbkluZm9zKCl9CiAJICogPHA+CiAJICogRm9yIGV4
YW1wbGUsIGluIHRoZSBBU1QgZm9yIDxjb2RlPmludFtdIGksIGpbXSwga1tdW108L2NvZGU+IHRo
ZQogCSAqIHZhcmlhYmxlIGRlY2xhcmF0aW9uIGZyYWdtZW50cyBmb3IgdGhlIHZhcmlhYmxlcyA8
Y29kZT5pPC9jb2RlPiwKQEAgLTI3MiwxMiArMzM1LDE0IEBACiAJICogQHNpbmNlIDIuMAogCSAq
LwogCXB1YmxpYyBpbnQgZ2V0RXh0cmFEaW1lbnNpb25zKCkgeworCQlzdXBwb3J0ZWRPbmx5SW4y
XzNfNCgpOwogCQlyZXR1cm4gdGhpcy5leHRyYUFycmF5RGltZW5zaW9uczsKIAl9CiAKIAkvKioK
IAkgKiBTZXRzIHRoZSBudW1iZXIgb2YgZXh0cmEgYXJyYXkgZGltZW5zaW9ucyB0aGlzIHZhcmlh
YmxlIGhhcyBvdmVyCi0JICogYW5kIGFib3ZlIHRoZSB0eXBlIHNwZWNpZmllZCBpbiB0aGUgZW5j
bG9zaW5nIGRlY2xhcmF0aW9uLgorCSAqIGFuZCBhYm92ZSB0aGUgdHlwZSBzcGVjaWZpZWQgaW4g
dGhlIGVuY2xvc2luZyBkZWNsYXJhdGlvbiAoTm90IHN1cHBvcnRlZCAKKwkgKiBpbiBKTFM4IGFu
ZCBhYm92ZSkuIEZvciBKTFM4IGxldmVsIGFuZCBhYm92ZSwgc2VlOiB7QGxpbmsgI2dldEV4dHJh
RGltZW5zaW9uSW5mb3MoKX0uCiAJICogPHA+CiAJICogRm9yIGV4YW1wbGUsIGluIHRoZSBBU1Qg
Zm9yIDxjb2RlPmludFtdIGksIGpbXSwga1tdW108L2NvZGU+IHRoZQogCSAqIHZhcmlhYmxlIGRl
Y2xhcmF0aW9uIGZyYWdtZW50cyBmb3IgdGhlIHZhcmlhYmxlcyA8Y29kZT5pPC9jb2RlPiwKQEAg
LTI4OSwxMiArMzU0LDI0IEBACiAJICogQHNpbmNlIDIuMAogCSAqLwogCXB1YmxpYyB2b2lkIHNl
dEV4dHJhRGltZW5zaW9ucyhpbnQgZGltZW5zaW9ucykgeworCQlzdXBwb3J0ZWRPbmx5SW4yXzNf
NCgpOwogCQlpZiAoZGltZW5zaW9ucyA8IDApIHsKIAkJCXRocm93IG5ldyBJbGxlZ2FsQXJndW1l
bnRFeGNlcHRpb24oKTsKIAkJfQogCQlwcmVWYWx1ZUNoYW5nZShFWFRSQV9ESU1FTlNJT05TX1BS
T1BFUlRZKTsKIAkJdGhpcy5leHRyYUFycmF5RGltZW5zaW9ucyA9IGRpbWVuc2lvbnM7CiAJCXBv
c3RWYWx1ZUNoYW5nZShFWFRSQV9ESU1FTlNJT05TX1BST1BFUlRZKTsKKwl9CisKKwkvKioKKwkg
KiBSZXR1cm5zIHRoZSBsaXZlIG9yZGVyZWQgbGlzdCBvZiBleHRyYSBkaW1lbnNpb25zIHdpdGgg
YW5ub3RhdGlvbnMgaWYgYW55IChKTFM4IEFQSSBvbmx5KS4KKwkgKgorCSAqIEByZXR1cm4gdGhl
IGxpdmUgbGlzdCBvZiBleHRyYSBkaW1lbnNpb25zIHdpdGggYW5ub3RhdGlvbnMgaWYgYW55IChl
bGVtZW50IHR5cGU6IHtAbGluayBEaW1lbnNpb25JbmZvfVtdKQorCSAqIEBzaW5jZSAzLjkKKwkg
Ki8KKwlwdWJsaWMgTGlzdCBnZXRFeHRyYURpbWVuc2lvbkluZm9zKCkgeworCQl1bnN1cHBvcnRl
ZEluMl8zXzQoKTsKKwkJcmV0dXJuIHRoaXMuZXh0cmFEaW1lbnNpb25JbmZvczsKIAl9CiAKIAkv
KiAob21pdCBqYXZhZG9jIGZvciB0aGlzIG1ldGhvZCkKQEAgLTMxOSw3ICszOTYsNyBAQAogCSAq
LwogCWludCBtZW1TaXplKCkgewogCQkvLyB0cmVhdCBPcGVyYXRvciBhcyBmcmVlCi0JCXJldHVy
biBCQVNFX05PREVfU0laRSArIDMgKiA0OworCQlyZXR1cm4gQkFTRV9OT0RFX1NJWkUgKyA0ICog
NDsKIAl9CiAKIAkvKiAob21pdCBqYXZhZG9jIGZvciB0aGlzIG1ldGhvZCkKQEAgLTMyOSw2ICs0
MDYsNyBAQAogCQlyZXR1cm4KIAkJCW1lbVNpemUoKQogCQkJKyAodGhpcy52YXJpYWJsZU5hbWUg
PT0gbnVsbCA/IDAgOiBnZXROYW1lKCkudHJlZVNpemUoKSkKLQkJCSsgKHRoaXMub3B0aW9uYWxJ
bml0aWFsaXplciA9PSBudWxsID8gMCA6IGdldEluaXRpYWxpemVyKCkudHJlZVNpemUoKSk7CisJ
CQkrICh0aGlzLm9wdGlvbmFsSW5pdGlhbGl6ZXIgPT0gbnVsbCA/IDAgOiBnZXRJbml0aWFsaXpl
cigpLnRyZWVTaXplKCkpCisJCQkrICh0aGlzLmV4dHJhRGltZW5zaW9uSW5mb3MgPT0gbnVsbCA/
IDAgOiBnZXRFeHRyYURpbWVuc2lvbkluZm9zKCkuc2l6ZSgpKTsKIAl9CiB9CmRpZmYgLS1naXQg
YS9vcmcuZWNsaXBzZS5qZHQuY29yZS9kb20vb3JnL2VjbGlwc2UvamR0L2ludGVybmFsL2NvcmUv
ZG9tL05haXZlQVNURmxhdHRlbmVyLmphdmEgYi9vcmcuZWNsaXBzZS5qZHQuY29yZS9kb20vb3Jn
L2VjbGlwc2UvamR0L2ludGVybmFsL2NvcmUvZG9tL05haXZlQVNURmxhdHRlbmVyLmphdmEKaW5k
ZXggZWNjZWRhOS4uZTJlZjA5MCAxMDA2NDQKLS0tIGEvb3JnLmVjbGlwc2UuamR0LmNvcmUvZG9t
L29yZy9lY2xpcHNlL2pkdC9pbnRlcm5hbC9jb3JlL2RvbS9OYWl2ZUFTVEZsYXR0ZW5lci5qYXZh
CisrKyBiL29yZy5lY2xpcHNlLmpkdC5jb3JlL2RvbS9vcmcvZWNsaXBzZS9qZHQvaW50ZXJuYWwv
Y29yZS9kb20vTmFpdmVBU1RGbGF0dGVuZXIuamF2YQpAQCAtNDUsNiArNDUsNyBAQAogaW1wb3J0
IG9yZy5lY2xpcHNlLmpkdC5jb3JlLmRvbS5Db25kaXRpb25hbEV4cHJlc3Npb247CiBpbXBvcnQg
b3JnLmVjbGlwc2UuamR0LmNvcmUuZG9tLkNvbnN0cnVjdG9ySW52b2NhdGlvbjsKIGltcG9ydCBv
cmcuZWNsaXBzZS5qZHQuY29yZS5kb20uQ29udGludWVTdGF0ZW1lbnQ7CitpbXBvcnQgb3JnLmVj
bGlwc2UuamR0LmNvcmUuZG9tLkRpbWVuc2lvbkluZm87CiBpbXBvcnQgb3JnLmVjbGlwc2UuamR0
LmNvcmUuZG9tLlVuaW9uVHlwZTsKIGltcG9ydCBvcmcuZWNsaXBzZS5qZHQuY29yZS5kb20uRG9T
dGF0ZW1lbnQ7CiBpbXBvcnQgb3JnLmVjbGlwc2UuamR0LmNvcmUuZG9tLkVtcHR5U3RhdGVtZW50
OwpAQCAtNDEzLDYgKzQxNCwxNiBAQAogCQlub2RlLmdldENvbXBvbmVudFR5cGUoKS5hY2NlcHQo
dGhpcyk7CiAJCXZpc2l0VHlwZUFubm90YXRpb25zKG5vZGUpOwogCQl0aGlzLmJ1ZmZlci5hcHBl
bmQoIltdIik7Ly8kTk9OLU5MUy0xJAorCQlyZXR1cm4gZmFsc2U7CisJfQorCisJcHVibGljIGJv
b2xlYW4gdmlzaXQoRGltZW5zaW9uSW5mbyBub2RlKSB7CisJCXZpc2l0QW5ub3RhdGlvbnMobm9k
ZS5hbm5vdGF0aW9ucygpKTsKKwkJdGhpcy5idWZmZXIuYXBwZW5kKCJbIik7IC8vJE5PTi1OTFMt
MSQKKwkJaWYgKG5vZGUuZXhwcmVzc2lvbigpICE9IG51bGwpIHsKKwkJCW5vZGUuZXhwcmVzc2lv
bigpLmFjY2VwdCh0aGlzKTsKKwkJfQorCQl0aGlzLmJ1ZmZlci5hcHBlbmQoIl0iKTsgLy8kTk9O
LU5MUy0xJAogCQlyZXR1cm4gZmFsc2U7CiAJfQogCkBAIC0xMDM3LDggKzEwNDgsMTUgQEAKIAkJ
CX0KIAkJfQogCQl0aGlzLmJ1ZmZlci5hcHBlbmQoIikiKTsvLyROT04tTkxTLTEkCi0JCWZvciAo
aW50IGkgPSAwOyBpIDwgbm9kZS5nZXRFeHRyYURpbWVuc2lvbnMoKTsgaSsrKSB7Ci0JCQl0aGlz
LmJ1ZmZlci5hcHBlbmQoIltdIik7IC8vJE5PTi1OTFMtMSQKKwkJaWYgKG5vZGUuZ2V0QVNUKCku
YXBpTGV2ZWwoKSA+PSBBU1QuSkxTOCkgeworCQkJTGlzdCBkaW1lbnNpb25zID0gbm9kZS5nZXRF
eHRyYURpbWVuc2lvbkluZm9zKCk7CisJCQlmb3IgKGludCBpID0gMDsgaSA8IGRpbWVuc2lvbnMu
c2l6ZSgpOyBpKyspIHsKKwkJCQl2aXNpdCgoRGltZW5zaW9uSW5mbykgZGltZW5zaW9ucy5nZXQo
aSkpOworCQkJfQorCQl9IGVsc2UgeworCQkJZm9yIChpbnQgaSA9IDA7IGkgPCBub2RlLmdldEV4
dHJhRGltZW5zaW9ucygpOyBpKyspIHsKKwkJCQl0aGlzLmJ1ZmZlci5hcHBlbmQoIltdIik7IC8v
JE5PTi1OTFMtMSQKKwkJCX0KIAkJfQogCQlpZiAobm9kZS5nZXRBU1QoKS5hcGlMZXZlbCgpIDwg
QVNULkpMUzgpIHsKIAkJCWlmICghbm9kZS50aHJvd25FeGNlcHRpb25zKCkuaXNFbXB0eSgpKSB7
CkBAIC0xMzczLDggKzEzOTEsMTUgQEAKIAkJfQogCQl0aGlzLmJ1ZmZlci5hcHBlbmQoIiAiKTsv
LyROT04tTkxTLTEkCiAJCW5vZGUuZ2V0TmFtZSgpLmFjY2VwdCh0aGlzKTsKLQkJZm9yIChpbnQg
aSA9IDA7IGkgPCBub2RlLmdldEV4dHJhRGltZW5zaW9ucygpOyBpKyspIHsKLQkJCXRoaXMuYnVm
ZmVyLmFwcGVuZCgiW10iKTsgLy8kTk9OLU5MUy0xJAorCQlpZiAobm9kZS5nZXRBU1QoKS5hcGlM
ZXZlbCgpID49IEFTVC5KTFM4KSB7CisJCQlMaXN0IGRpbWVuc2lvbnMgPSBub2RlLmdldEV4dHJh
RGltZW5zaW9uSW5mb3MoKTsKKwkJCWZvciAoaW50IGkgPSAwOyBpIDwgZGltZW5zaW9ucy5zaXpl
KCk7IGkrKykgeworCQkJCXZpc2l0KChEaW1lbnNpb25JbmZvKSBkaW1lbnNpb25zLmdldChpKSk7
CisJCQl9CisJCX0gZWxzZSB7CisJCQlmb3IgKGludCBpID0gMDsgaSA8IG5vZGUuZ2V0RXh0cmFE
aW1lbnNpb25zKCk7IGkrKykgeworCQkJCXRoaXMuYnVmZmVyLmFwcGVuZCgiW10iKTsgLy8kTk9O
LU5MUy0xJAorCQkJfQogCQl9CiAJCWlmIChub2RlLmdldEluaXRpYWxpemVyKCkgIT0gbnVsbCkg
ewogCQkJdGhpcy5idWZmZXIuYXBwZW5kKCI9Iik7Ly8kTk9OLU5MUy0xJApAQCAtMTc5NCw4ICsx
ODE5LDE1IEBACiAJICovCiAJcHVibGljIGJvb2xlYW4gdmlzaXQoVmFyaWFibGVEZWNsYXJhdGlv
bkZyYWdtZW50IG5vZGUpIHsKIAkJbm9kZS5nZXROYW1lKCkuYWNjZXB0KHRoaXMpOwotCQlmb3Ig
KGludCBpID0gMDsgaSA8IG5vZGUuZ2V0RXh0cmFEaW1lbnNpb25zKCk7IGkrKykgewotCQkJdGhp
cy5idWZmZXIuYXBwZW5kKCJbXSIpOy8vJE5PTi1OTFMtMSQKKwkJaWYgKG5vZGUuZ2V0QVNUKCku
YXBpTGV2ZWwoKSA+PSBBU1QuSkxTOCkgeworCQkJTGlzdCBkaW1lbnNpb25zID0gbm9kZS5nZXRF
eHRyYURpbWVuc2lvbkluZm9zKCk7CisJCQlmb3IgKGludCBpID0gMDsgaSA8IGRpbWVuc2lvbnMu
c2l6ZSgpOyBpKyspIHsKKwkJCQl2aXNpdCgoRGltZW5zaW9uSW5mbykgZGltZW5zaW9ucy5nZXQo
aSkpOworCQkJfQorCQl9IGVsc2UgeworCQkJZm9yIChpbnQgaSA9IDA7IGkgPCBub2RlLmdldEV4
dHJhRGltZW5zaW9ucygpOyBpKyspIHsKKwkJCQl0aGlzLmJ1ZmZlci5hcHBlbmQoIltdIik7Ly8k
Tk9OLU5MUy0xJAorCQkJfQogCQl9CiAJCWlmIChub2RlLmdldEluaXRpYWxpemVyKCkgIT0gbnVs
bCkgewogCQkJdGhpcy5idWZmZXIuYXBwZW5kKCI9Iik7Ly8kTk9OLU5MUy0xJApAQCAtMTg2MCwx
NCArMTg5MiwxNyBAQAogCX0KIAlwcml2YXRlIHZvaWQgdmlzaXRUeXBlQW5ub3RhdGlvbnMoQW5u
b3RhdGFibGVUeXBlIG5vZGUpIHsKIAkJaWYgKG5vZGUuZ2V0QVNUKCkuYXBpTGV2ZWwoKSA+PSBB
U1QuSkxTOCkgewotCQkJTGlzdCBhbm5vdGF0aW9ucyA9IG5vZGUuYW5ub3RhdGlvbnMoKTsKLQkJ
CWlmIChhbm5vdGF0aW9ucyAhPSBudWxsKSB7Ci0JCQkJZm9yIChJdGVyYXRvciBpdCA9IGFubm90
YXRpb25zLml0ZXJhdG9yKCk7IGl0Lmhhc05leHQoKTsgKSB7Ci0JCQkJCUFubm90YXRpb24gYW5u
b3RhdGlvbiA9IChBbm5vdGF0aW9uKSBpdC5uZXh0KCk7Ci0JCQkJCWFubm90YXRpb24uYWNjZXB0
KHRoaXMpOwotCQkJCQl0aGlzLmJ1ZmZlci5hcHBlbmQoJyAnKTsKLQkJCQl9CisJCQl2aXNpdEFu
bm90YXRpb25zKG5vZGUuYW5ub3RhdGlvbnMoKSk7CisJCX0KKwl9CisKKwlwcml2YXRlIHZvaWQg
dmlzaXRBbm5vdGF0aW9ucyhMaXN0IGFubm90YXRpb25zKSB7CisJCWlmIChhbm5vdGF0aW9ucyAh
PSBudWxsKSB7CisJCQlmb3IgKEl0ZXJhdG9yIGl0ID0gYW5ub3RhdGlvbnMuaXRlcmF0b3IoKTsg
aXQuaGFzTmV4dCgpOyApIHsKKwkJCQlBbm5vdGF0aW9uIGFubm90YXRpb24gPSAoQW5ub3RhdGlv
bikgaXQubmV4dCgpOworCQkJCWFubm90YXRpb24uYWNjZXB0KHRoaXMpOworCQkJCXRoaXMuYnVm
ZmVyLmFwcGVuZCgnICcpOwogCQkJfQogCQl9Ci0JfQkKKwl9CiB9
</data>

          </attachment>
          <attachment
              isobsolete="0"
              ispatch="1"
              isprivate="0"
          >
            <attachid>226254</attachid>
            <date>2013-01-29 07:09:00 -0500</date>
            <delta_ts>2013-01-29 07:09:09 -0500</delta_ts>
            <desc>Updated patch</desc>
            <filename>Fix-for-bug-391895.patch</filename>
            <type>text/plain</type>
            <size>67037</size>
            <attacher name="Jay Arthanareeswaran">jarthana</attacher>
            
              <data encoding="base64">ZGlmZiAtLWdpdCBhL29yZy5lY2xpcHNlLmpkdC5jb3JlLnRlc3RzLm1vZGVsL3NyYy9vcmcvZWNs
aXBzZS9qZHQvY29yZS90ZXN0cy9kb20vQVNUQ29udmVydGVyMThUZXN0LmphdmEgYi9vcmcuZWNs
aXBzZS5qZHQuY29yZS50ZXN0cy5tb2RlbC9zcmMvb3JnL2VjbGlwc2UvamR0L2NvcmUvdGVzdHMv
ZG9tL0FTVENvbnZlcnRlcjE4VGVzdC5qYXZhCmluZGV4IDA2MWM5MTYuLjYwNTEwZDggMTAwNjQ0
Ci0tLSBhL29yZy5lY2xpcHNlLmpkdC5jb3JlLnRlc3RzLm1vZGVsL3NyYy9vcmcvZWNsaXBzZS9q
ZHQvY29yZS90ZXN0cy9kb20vQVNUQ29udmVydGVyMThUZXN0LmphdmEKKysrIGIvb3JnLmVjbGlw
c2UuamR0LmNvcmUudGVzdHMubW9kZWwvc3JjL29yZy9lY2xpcHNlL2pkdC9jb3JlL3Rlc3RzL2Rv
bS9BU1RDb252ZXJ0ZXIxOFRlc3QuamF2YQpAQCAtMTAxNyw0ICsxMDE3LDU3IEBACiAJCWFzc2Vy
dE5vdE51bGwoIkluY29ycmVjdCByZWNlaXZlciBxdWFsZmllciIsIG1ldGhvZC5nZXRSZWNlaXZl
clF1YWxpZmllcigpKTsKIAkJYXNzZXJ0RXF1YWxzKCJJbmNvcnJlY3QgcmVjZWl2ZXIgcXVhbGZp
ZXIiLCAiWCIsIG1ldGhvZC5nZXRSZWNlaXZlclF1YWxpZmllcigpLmdldEZ1bGx5UXVhbGlmaWVk
TmFtZSgpKTsKIAl9CisJLy8gaHR0cHM6Ly9idWdzLmVjbGlwc2Uub3JnL2J1Z3Mvc2hvd19idWcu
Y2dpP2lkPTM5MTg5NQorCXB1YmxpYyB2b2lkIHRlc3QwMDA5KCkgdGhyb3dzIEphdmFNb2RlbEV4
Y2VwdGlvbiB7CisJCVN0cmluZyBjb250ZW50cyA9CisJCQkJImltcG9ydCBqYXZhLmxhbmcuYW5u
b3RhdGlvbi5FbGVtZW50VHlwZTtcbiIgKworCQkJCQkJInB1YmxpYyBjbGFzcyBYIHtcbiIgKwor
CQkJCQkJIiAJY2xhc3MgWSB7XG4iICsKKwkJCQkJCSIJCUBBbm5vdCBpbnQgQEFubm90MSBbXSBh
IEBBbm5vdDIgQEFubm90MyBbXSBAQW5ub3QzIEBBbm5vdDIgW10gQEFubm90NCBbXSwgYiBAQW5u
b3QyIEBBbm5vdDMgW10gQEFubm90NCBbXSwgYyBbXVtdW107XG4iICsgIAorCQkJCQkJIgkJcHVi
bGljIHZvaWQgZm9vMShAQW5ub3QgaW50IEBBbm5vdDEgW10gcCBAQW5ub3QyIEBBbm5vdDMgW10g
QEFubm90MyBAQW5ub3QyIFtdIEBBbm5vdDQgQEFubm90MyBbXSkge31cbiIgKworCQkJCQkJIgkJ
cHVibGljIHZvaWQgZm9vMihAQW5ub3QgaW50IHAgW11bXSkge31cbiIgKworCQkJCQkJIgkJQEFu
bm90IFN0cmluZyBAQW5ub3QxIFtdIGZvbzMoKSBAQW5ub3QxIEBBbm5vdDIgW11bXSB7IHJldHVy
biBudWxsOyB9XG4iICsgCisJCQkJCQkiCX1cbiIgKworCQkJCQkJIn1cbiIgKworCQkJCQkJIkBq
YXZhLmxhbmcuYW5ub3RhdGlvbi5UYXJnZXQodmFsdWUgPSB7RWxlbWVudFR5cGUuVFlQRV9VU0V9
KVxuIiArIAorCQkJCQkJIkBpbnRlcmZhY2UgQW5ub3Qge31cbiIgKworCQkJCQkJIkBqYXZhLmxh
bmcuYW5ub3RhdGlvbi5UYXJnZXQodmFsdWUgPSB7RWxlbWVudFR5cGUuVFlQRV9VU0V9KVxuIiAr
IAorCQkJCQkJIkBpbnRlcmZhY2UgQW5ub3QxIHt9XG4iICsKKwkJCQkJCSJAamF2YS5sYW5nLmFu
bm90YXRpb24uVGFyZ2V0KHZhbHVlID0ge0VsZW1lbnRUeXBlLlRZUEVfVVNFfSlcbiIgKworCQkJ
CQkJIkBpbnRlcmZhY2UgQW5ub3QyIHt9XG4iICsKKwkJCQkJCSJAamF2YS5sYW5nLmFubm90YXRp
b24uVGFyZ2V0KHZhbHVlID0ge0VsZW1lbnRUeXBlLlRZUEVfVVNFfSlcbiIgKyAKKwkJCQkJCSJA
aW50ZXJmYWNlIEFubm90MyB7fVxuIiArCisJCQkJCQkiQGphdmEubGFuZy5hbm5vdGF0aW9uLlRh
cmdldCh2YWx1ZSA9IHtFbGVtZW50VHlwZS5UWVBFX1VTRX0pXG4iICsKKwkJCQkJCSJAaW50ZXJm
YWNlIEFubm90NCB7fSI7CisJCXRoaXMud29ya2luZ0NvcHkgPSBnZXRXb3JraW5nQ29weSgiL0Nv
bnZlcnRlcjE4L3NyYy9YLmphdmEiLCB0cnVlKTsKKwkJQVNUTm9kZSBub2RlID0gYnVpbGRBU1Qo
Y29udGVudHMsIHRoaXMud29ya2luZ0NvcHkpOworCQlhc3NlcnRFcXVhbHMoIk5vdCBhIGNvbXBp
bGF0aW9uIHVuaXQiLCBBU1ROb2RlLkNPTVBJTEFUSU9OX1VOSVQsIG5vZGUuZ2V0Tm9kZVR5cGUo
KSk7CisJCUNvbXBpbGF0aW9uVW5pdCB1bml0ID0gKENvbXBpbGF0aW9uVW5pdCkgbm9kZTsKKwkJ
bm9kZSA9IGdldEFTVE5vZGUodW5pdCwgMCwgMCk7CisJCWFzc2VydEVxdWFscygiTm90IGEgdHlw
ZSBEZWNsYXJhdGlvbiIsIEFTVE5vZGUuVFlQRV9ERUNMQVJBVElPTiwgbm9kZS5nZXROb2RlVHlw
ZSgpKTsKKwkJVHlwZURlY2xhcmF0aW9uIHR5cGUgPSAoVHlwZURlY2xhcmF0aW9uKSBub2RlOwor
CQlGaWVsZERlY2xhcmF0aW9uIGZpZWxkID0gdHlwZS5nZXRGaWVsZHMoKVswXTsKKwkJTGlzdCBm
cmFnbWVudHMgPSBmaWVsZC5mcmFnbWVudHMoKTsKKwkJYXNzZXJ0RXF1YWxzKCJJbmNvcnJlY3Qg
bm8gb2YgZnJhZ21lbnRzIiwgMywgZnJhZ21lbnRzLnNpemUoKSk7CisJCVZhcmlhYmxlRGVjbGFy
YXRpb25GcmFnbWVudCBmcmFnbWVudCA9IChWYXJpYWJsZURlY2xhcmF0aW9uRnJhZ21lbnQpIGZy
YWdtZW50cy5nZXQoMCk7CisJCWFzc2VydEV4dHJhRGltZW5zaW9uc0VxdWFsKCJJbmNvcnJlY3Qg
ZGltZW5zaW9uIHR5cGUiLCBmcmFnbWVudC5nZXRFeHRyYURpbWVuc2lvbkluZm9zKCksICJAQW5u
b3QyIEBBbm5vdDMgW10gQEFubm90MyBAQW5ub3QyIFtdIEBBbm5vdDQgW10iKTsKKwkJZnJhZ21l
bnQgPSAoVmFyaWFibGVEZWNsYXJhdGlvbkZyYWdtZW50KSBmcmFnbWVudHMuZ2V0KDEpOworCQlh
c3NlcnRFeHRyYURpbWVuc2lvbnNFcXVhbCgiSW5jb3JyZWN0IGRpbWVuc2lvbiB0eXBlIiwgZnJh
Z21lbnQuZ2V0RXh0cmFEaW1lbnNpb25JbmZvcygpLCAiQEFubm90MiBAQW5ub3QzIFtdIEBBbm5v
dDQgW10iKTsJCQorCQlmcmFnbWVudCA9IChWYXJpYWJsZURlY2xhcmF0aW9uRnJhZ21lbnQpIGZy
YWdtZW50cy5nZXQoMik7CisJCWFzc2VydEV4dHJhRGltZW5zaW9uc0VxdWFsKCJJbmNvcnJlY3Qg
ZGltZW5zaW9uIHR5cGUiLCBmcmFnbWVudC5nZXRFeHRyYURpbWVuc2lvbkluZm9zKCksICJbXSBb
XSBbXSIpOworCQlNZXRob2REZWNsYXJhdGlvbltdIG1ldGhvZHMgPSB0eXBlLmdldE1ldGhvZHMo
KTsKKwkJYXNzZXJ0RXF1YWxzKCJJbmNvcnJlY3Qgbm8gb2YgbWV0aG9kcyIsIDMsIG1ldGhvZHMu
bGVuZ3RoKTsKKwkJTWV0aG9kRGVjbGFyYXRpb24gbWV0aG9kID0gbWV0aG9kc1swXTsKKwkJTGlz
dCBwYXJhbWV0ZXJzID0gbWV0aG9kLnBhcmFtZXRlcnMoKTsKKwkJYXNzZXJ0RXF1YWxzKCJJbmNv
cnJlY3Qgbm8gb2YgcGFyYW1ldGVycyIsIDEsIHBhcmFtZXRlcnMuc2l6ZSgpKTsKKwkJYXNzZXJ0
RXh0cmFEaW1lbnNpb25zRXF1YWwoIkluY29ycmVjdCBkaW1lbnNpb24gdHlwZSIsICgoU2luZ2xl
VmFyaWFibGVEZWNsYXJhdGlvbikgcGFyYW1ldGVycy5nZXQoMCkpLmdldEV4dHJhRGltZW5zaW9u
SW5mb3MoKSwgIkBBbm5vdDIgQEFubm90MyBbXSBAQW5ub3QzIEBBbm5vdDIgW10gQEFubm90NCBA
QW5ub3QzIFtdIik7CisKKwkJbWV0aG9kID0gbWV0aG9kc1sxXTsKKwkJcGFyYW1ldGVycyA9IG1l
dGhvZC5wYXJhbWV0ZXJzKCk7CisJCWFzc2VydEVxdWFscygiSW5jb3JyZWN0IG5vIG9mIHBhcmFt
ZXRlcnMiLCAxLCBwYXJhbWV0ZXJzLnNpemUoKSk7CisJCWFzc2VydEV4dHJhRGltZW5zaW9uc0Vx
dWFsKCJJbmNvcnJlY3QgZGltZW5zaW9uIHR5cGUiLCAoKFNpbmdsZVZhcmlhYmxlRGVjbGFyYXRp
b24pIHBhcmFtZXRlcnMuZ2V0KDApKS5nZXRFeHRyYURpbWVuc2lvbkluZm9zKCksICJbXSBbXSIp
OworCisJCW1ldGhvZCA9IG1ldGhvZHNbMl07CisJCWFzc2VydEV4dHJhRGltZW5zaW9uc0VxdWFs
KCJJbmNvcnJlY3QgZGltZW5zaW9uIHR5cGUiLCBtZXRob2QuZ2V0RXh0cmFEaW1lbnNpb25JbmZv
cygpLCAiQEFubm90MSBAQW5ub3QyIFtdIFtdIik7CisJfQogfQpkaWZmIC0tZ2l0IGEvb3JnLmVj
bGlwc2UuamR0LmNvcmUudGVzdHMubW9kZWwvc3JjL29yZy9lY2xpcHNlL2pkdC9jb3JlL3Rlc3Rz
L2RvbS9BU1RDb252ZXJ0ZXJBU1Q4VGVzdC5qYXZhIGIvb3JnLmVjbGlwc2UuamR0LmNvcmUudGVz
dHMubW9kZWwvc3JjL29yZy9lY2xpcHNlL2pkdC9jb3JlL3Rlc3RzL2RvbS9BU1RDb252ZXJ0ZXJB
U1Q4VGVzdC5qYXZhCmluZGV4IDkyN2FiM2YuLjk3ODE1NDYgMTAwNjQ0Ci0tLSBhL29yZy5lY2xp
cHNlLmpkdC5jb3JlLnRlc3RzLm1vZGVsL3NyYy9vcmcvZWNsaXBzZS9qZHQvY29yZS90ZXN0cy9k
b20vQVNUQ29udmVydGVyQVNUOFRlc3QuamF2YQorKysgYi9vcmcuZWNsaXBzZS5qZHQuY29yZS50
ZXN0cy5tb2RlbC9zcmMvb3JnL2VjbGlwc2UvamR0L2NvcmUvdGVzdHMvZG9tL0FTVENvbnZlcnRl
ckFTVDhUZXN0LmphdmEKQEAgLTM3LDYgKzM3LDcgQEAKIAogCXN0YXRpYyB7CiAvLwkJVEVTVFNf
TlVNQkVSUyA9IG5ldyBpbnRbXSB7IDM1NiB9OworLy8JCVRFU1RTX05BTUVTID0gbmV3IFN0cmlu
Z1tdeyAidGVzdDAzOTMiIH07CiAJfQogCXB1YmxpYyBzdGF0aWMgVGVzdCBzdWl0ZSgpIHsKIAkJ
cmV0dXJuIGJ1aWxkTW9kZWxUZXN0U3VpdGUoQVNUQ29udmVydGVyQVNUOFRlc3QuY2xhc3MpOwpA
QCAtMjcxOCwyMCArMjcxOSwyMyBAQAogCQlOdW1iZXJMaXRlcmFsIGxpdGVyYWwgPSB0aGlzLmFz
dC5uZXdOdW1iZXJMaXRlcmFsKCk7CiAJCWxpdGVyYWwuc2V0VG9rZW4oIjEwIik7Ly8kTk9OLU5M
Uy0xJAogCQlmcmFnbWVudC5zZXRJbml0aWFsaXplcihsaXRlcmFsKTsKLQkJZnJhZ21lbnQuc2V0
RXh0cmFEaW1lbnNpb25zKDApOworCQlmcmFnbWVudC5nZXRFeHRyYURpbWVuc2lvbkluZm9zKCku
Y2xlYXIoKTsKIAkJVmFyaWFibGVEZWNsYXJhdGlvblN0YXRlbWVudCBzdGF0ZW1lbnQgPSB0aGlz
LmFzdC5uZXdWYXJpYWJsZURlY2xhcmF0aW9uU3RhdGVtZW50KGZyYWdtZW50KTsKIAkJZnJhZ21l
bnQgPSB0aGlzLmFzdC5uZXdWYXJpYWJsZURlY2xhcmF0aW9uRnJhZ21lbnQoKTsKIAkJZnJhZ21l
bnQuc2V0TmFtZSh0aGlzLmFzdC5uZXdTaW1wbGVOYW1lKCJ6IikpOy8vJE5PTi1OTFMtMSQKIAkJ
ZnJhZ21lbnQuc2V0SW5pdGlhbGl6ZXIodGhpcy5hc3QubmV3TnVsbExpdGVyYWwoKSk7Ci0JCWZy
YWdtZW50LnNldEV4dHJhRGltZW5zaW9ucygxKTsKKwkJZnJhZ21lbnQuZ2V0RXh0cmFEaW1lbnNp
b25JbmZvcygpLmNsZWFyKCk7CisJCWZyYWdtZW50LmdldEV4dHJhRGltZW5zaW9uSW5mb3MoKS5h
ZGQodGhpcy5hc3QubmV3RGltZW5zaW9uSW5mbygpKTsKIAkJc3RhdGVtZW50LmZyYWdtZW50cygp
LmFkZChmcmFnbWVudCk7CiAJCWZyYWdtZW50ID0gdGhpcy5hc3QubmV3VmFyaWFibGVEZWNsYXJh
dGlvbkZyYWdtZW50KCk7CiAJCWZyYWdtZW50LnNldE5hbWUodGhpcy5hc3QubmV3U2ltcGxlTmFt
ZSgiaSIpKTsvLyROT04tTkxTLTEkCi0JCWZyYWdtZW50LnNldEV4dHJhRGltZW5zaW9ucygwKTsK
KwkJZnJhZ21lbnQuZ2V0RXh0cmFEaW1lbnNpb25JbmZvcygpLmNsZWFyKCk7CiAJCXN0YXRlbWVu
dC5mcmFnbWVudHMoKS5hZGQoZnJhZ21lbnQpOwogCQlmcmFnbWVudCA9IHRoaXMuYXN0Lm5ld1Zh
cmlhYmxlRGVjbGFyYXRpb25GcmFnbWVudCgpOwogCQlmcmFnbWVudC5zZXROYW1lKHRoaXMuYXN0
Lm5ld1NpbXBsZU5hbWUoImoiKSk7Ly8kTk9OLU5MUy0xJAotCQlmcmFnbWVudC5zZXRFeHRyYURp
bWVuc2lvbnMoMik7CisJCWZyYWdtZW50LmdldEV4dHJhRGltZW5zaW9uSW5mb3MoKS5jbGVhcigp
OworCQlmcmFnbWVudC5nZXRFeHRyYURpbWVuc2lvbkluZm9zKCkuYWRkKHRoaXMuYXN0Lm5ld0Rp
bWVuc2lvbkluZm8oKSk7CisJCWZyYWdtZW50LmdldEV4dHJhRGltZW5zaW9uSW5mb3MoKS5hZGQo
dGhpcy5hc3QubmV3RGltZW5zaW9uSW5mbygpKTsKIAkJc3RhdGVtZW50LmZyYWdtZW50cygpLmFk
ZChmcmFnbWVudCk7CiAJCXN0YXRlbWVudC5zZXRUeXBlKHRoaXMuYXN0Lm5ld1ByaW1pdGl2ZVR5
cGUoUHJpbWl0aXZlVHlwZS5JTlQpKTsKIAkJYXNzZXJ0VHJ1ZSgiQm90aCBBU1QgdHJlZXMgc2hv
dWxkIGJlIGlkZW50aWNhbCIsIHN0YXRlbWVudC5zdWJ0cmVlTWF0Y2gobmV3IEFTVE1hdGNoZXIo
KSwgbm9kZSkpOwkJLy8kTk9OLU5MUy0xJApAQCAtMjc1OCwyMCArMjc2MiwyMyBAQAogCQlOdW1i
ZXJMaXRlcmFsIGxpdGVyYWwgPSB0aGlzLmFzdC5uZXdOdW1iZXJMaXRlcmFsKCk7CiAJCWxpdGVy
YWwuc2V0VG9rZW4oIjEwIik7Ly8kTk9OLU5MUy0xJAogCQlmcmFnbWVudC5zZXRJbml0aWFsaXpl
cihsaXRlcmFsKTsKLQkJZnJhZ21lbnQuc2V0RXh0cmFEaW1lbnNpb25zKDApOworCQlmcmFnbWVu
dC5nZXRFeHRyYURpbWVuc2lvbkluZm9zKCkuY2xlYXIoKTsKIAkJVmFyaWFibGVEZWNsYXJhdGlv
blN0YXRlbWVudCBzdGF0ZW1lbnQgPSB0aGlzLmFzdC5uZXdWYXJpYWJsZURlY2xhcmF0aW9uU3Rh
dGVtZW50KGZyYWdtZW50KTsKIAkJZnJhZ21lbnQgPSB0aGlzLmFzdC5uZXdWYXJpYWJsZURlY2xh
cmF0aW9uRnJhZ21lbnQoKTsKIAkJZnJhZ21lbnQuc2V0TmFtZSh0aGlzLmFzdC5uZXdTaW1wbGVO
YW1lKCJ6IikpOy8vJE5PTi1OTFMtMSQKIAkJZnJhZ21lbnQuc2V0SW5pdGlhbGl6ZXIodGhpcy5h
c3QubmV3TnVsbExpdGVyYWwoKSk7Ci0JCWZyYWdtZW50LnNldEV4dHJhRGltZW5zaW9ucygxKTsK
KwkJZnJhZ21lbnQuZ2V0RXh0cmFEaW1lbnNpb25JbmZvcygpLmNsZWFyKCk7CisJCWZyYWdtZW50
LmdldEV4dHJhRGltZW5zaW9uSW5mb3MoKS5hZGQodGhpcy5hc3QubmV3RGltZW5zaW9uSW5mbygp
KTsKIAkJc3RhdGVtZW50LmZyYWdtZW50cygpLmFkZChmcmFnbWVudCk7CiAJCWZyYWdtZW50ID0g
dGhpcy5hc3QubmV3VmFyaWFibGVEZWNsYXJhdGlvbkZyYWdtZW50KCk7CiAJCWZyYWdtZW50LnNl
dE5hbWUodGhpcy5hc3QubmV3U2ltcGxlTmFtZSgiaSIpKTsvLyROT04tTkxTLTEkCi0JCWZyYWdt
ZW50LnNldEV4dHJhRGltZW5zaW9ucygwKTsKKwkJZnJhZ21lbnQuZ2V0RXh0cmFEaW1lbnNpb25J
bmZvcygpLmNsZWFyKCk7CiAJCXN0YXRlbWVudC5mcmFnbWVudHMoKS5hZGQoZnJhZ21lbnQpOwog
CQlmcmFnbWVudCA9IHRoaXMuYXN0Lm5ld1ZhcmlhYmxlRGVjbGFyYXRpb25GcmFnbWVudCgpOwog
CQlmcmFnbWVudC5zZXROYW1lKHRoaXMuYXN0Lm5ld1NpbXBsZU5hbWUoImoiKSk7Ly8kTk9OLU5M
Uy0xJAotCQlmcmFnbWVudC5zZXRFeHRyYURpbWVuc2lvbnMoMik7CisJCWZyYWdtZW50LmdldEV4
dHJhRGltZW5zaW9uSW5mb3MoKS5jbGVhcigpOworCQlmcmFnbWVudC5nZXRFeHRyYURpbWVuc2lv
bkluZm9zKCkuYWRkKHRoaXMuYXN0Lm5ld0RpbWVuc2lvbkluZm8oKSk7CisJCWZyYWdtZW50Lmdl
dEV4dHJhRGltZW5zaW9uSW5mb3MoKS5hZGQodGhpcy5hc3QubmV3RGltZW5zaW9uSW5mbygpKTsK
IAkJc3RhdGVtZW50LmZyYWdtZW50cygpLmFkZChmcmFnbWVudCk7CiAJCXN0YXRlbWVudC5zZXRU
eXBlKHRoaXMuYXN0Lm5ld0FycmF5VHlwZSh0aGlzLmFzdC5uZXdQcmltaXRpdmVUeXBlKFByaW1p
dGl2ZVR5cGUuSU5UKSwgMSkpOwogCQlhc3NlcnRUcnVlKCJCb3RoIEFTVCB0cmVlcyBzaG91bGQg
YmUgaWRlbnRpY2FsIiwgc3RhdGVtZW50LnN1YnRyZWVNYXRjaChuZXcgQVNUTWF0Y2hlcigpLCBu
b2RlKSk7CQkvLyROT04tTkxTLTEkCkBAIC0yNzk3LDcgKzI4MDQsOCBAQAogCQlWYXJpYWJsZURl
Y2xhcmF0aW9uRnJhZ21lbnQgdmFyaWFibGVEZWNsYXJhdGlvbkZyYWdtZW50ID0gdGhpcy5hc3Qu
bmV3VmFyaWFibGVEZWNsYXJhdGlvbkZyYWdtZW50KCk7CiAJCXZhcmlhYmxlRGVjbGFyYXRpb25G
cmFnbWVudC5zZXROYW1lKHRoaXMuYXN0Lm5ld1NpbXBsZU5hbWUoInRhYiIpKTsgLy8kTk9OLU5M
Uy0xJAogCQl2YXJpYWJsZURlY2xhcmF0aW9uRnJhZ21lbnQuc2V0SW5pdGlhbGl6ZXIodGhpcy5h
c3QubmV3TnVsbExpdGVyYWwoKSk7Ly8kTk9OLU5MUy0xJAotCQl2YXJpYWJsZURlY2xhcmF0aW9u
RnJhZ21lbnQuc2V0RXh0cmFEaW1lbnNpb25zKDEpOworCQl2YXJpYWJsZURlY2xhcmF0aW9uRnJh
Z21lbnQuZ2V0RXh0cmFEaW1lbnNpb25JbmZvcygpLmNsZWFyKCk7CisJCXZhcmlhYmxlRGVjbGFy
YXRpb25GcmFnbWVudC5nZXRFeHRyYURpbWVuc2lvbkluZm9zKCkuYWRkKHRoaXMuYXN0Lm5ld0Rp
bWVuc2lvbkluZm8oKSk7CiAJCVZhcmlhYmxlRGVjbGFyYXRpb25FeHByZXNzaW9uIHZhcmlhYmxl
RGVjbGFyYXRpb25FeHByZXNzaW9uID0gdGhpcy5hc3QubmV3VmFyaWFibGVEZWNsYXJhdGlvbkV4
cHJlc3Npb24odmFyaWFibGVEZWNsYXJhdGlvbkZyYWdtZW50KTsKIAkJdmFyaWFibGVEZWNsYXJh
dGlvbkV4cHJlc3Npb24uc2V0VHlwZSh0aGlzLmFzdC5uZXdBcnJheVR5cGUodGhpcy5hc3QubmV3
U2ltcGxlVHlwZSh0aGlzLmFzdC5uZXdTaW1wbGVOYW1lKCJTdHJpbmciKSksIDEpKTsvLyROT04t
TkxTLTEkCiAJCWZvclN0YXRlbWVudC5pbml0aWFsaXplcnMoKS5hZGQodmFyaWFibGVEZWNsYXJh
dGlvbkV4cHJlc3Npb24pOwpAQCAtMjgyNSw3ICsyODMzLDggQEAKIAkJVmFyaWFibGVEZWNsYXJh
dGlvbkZyYWdtZW50IHZhcmlhYmxlRGVjbGFyYXRpb25GcmFnbWVudCA9IHRoaXMuYXN0Lm5ld1Zh
cmlhYmxlRGVjbGFyYXRpb25GcmFnbWVudCgpOwogCQl2YXJpYWJsZURlY2xhcmF0aW9uRnJhZ21l
bnQuc2V0TmFtZSh0aGlzLmFzdC5uZXdTaW1wbGVOYW1lKCJ0YWIiKSk7IC8vJE5PTi1OTFMtMSQK
IAkJdmFyaWFibGVEZWNsYXJhdGlvbkZyYWdtZW50LnNldEluaXRpYWxpemVyKHRoaXMuYXN0Lm5l
d051bGxMaXRlcmFsKCkpOy8vJE5PTi1OTFMtMSQKLQkJdmFyaWFibGVEZWNsYXJhdGlvbkZyYWdt
ZW50LnNldEV4dHJhRGltZW5zaW9ucygxKTsKKwkJdmFyaWFibGVEZWNsYXJhdGlvbkZyYWdtZW50
LmdldEV4dHJhRGltZW5zaW9uSW5mb3MoKS5jbGVhcigpOworCQl2YXJpYWJsZURlY2xhcmF0aW9u
RnJhZ21lbnQuZ2V0RXh0cmFEaW1lbnNpb25JbmZvcygpLmFkZCh0aGlzLmFzdC5uZXdEaW1lbnNp
b25JbmZvKCkpOwogCQlWYXJpYWJsZURlY2xhcmF0aW9uRXhwcmVzc2lvbiB2YXJpYWJsZURlY2xh
cmF0aW9uRXhwcmVzc2lvbiA9IHRoaXMuYXN0Lm5ld1ZhcmlhYmxlRGVjbGFyYXRpb25FeHByZXNz
aW9uKHZhcmlhYmxlRGVjbGFyYXRpb25GcmFnbWVudCk7CiAJCXZhcmlhYmxlRGVjbGFyYXRpb25F
eHByZXNzaW9uLnNldFR5cGUodGhpcy5hc3QubmV3U2ltcGxlVHlwZSh0aGlzLmFzdC5uZXdTaW1w
bGVOYW1lKCJTdHJpbmciKSkpOy8vJE5PTi1OTFMtMSQKIAkJZm9yU3RhdGVtZW50LmluaXRpYWxp
emVycygpLmFkZCh2YXJpYWJsZURlY2xhcmF0aW9uRXhwcmVzc2lvbik7CkBAIC0yODUzLDcgKzI4
NjIsOCBAQAogCQlWYXJpYWJsZURlY2xhcmF0aW9uRnJhZ21lbnQgdmFyaWFibGVEZWNsYXJhdGlv
bkZyYWdtZW50ID0gdGhpcy5hc3QubmV3VmFyaWFibGVEZWNsYXJhdGlvbkZyYWdtZW50KCk7CiAJ
CXZhcmlhYmxlRGVjbGFyYXRpb25GcmFnbWVudC5zZXROYW1lKHRoaXMuYXN0Lm5ld1NpbXBsZU5h
bWUoInRhYiIpKTsgLy8kTk9OLU5MUy0xJAogCQl2YXJpYWJsZURlY2xhcmF0aW9uRnJhZ21lbnQu
c2V0SW5pdGlhbGl6ZXIodGhpcy5hc3QubmV3TnVsbExpdGVyYWwoKSk7Ly8kTk9OLU5MUy0xJAot
CQl2YXJpYWJsZURlY2xhcmF0aW9uRnJhZ21lbnQuc2V0RXh0cmFEaW1lbnNpb25zKDEpOworCQl2
YXJpYWJsZURlY2xhcmF0aW9uRnJhZ21lbnQuZ2V0RXh0cmFEaW1lbnNpb25JbmZvcygpLmNsZWFy
KCk7CisJCXZhcmlhYmxlRGVjbGFyYXRpb25GcmFnbWVudC5nZXRFeHRyYURpbWVuc2lvbkluZm9z
KCkuYWRkKHRoaXMuYXN0Lm5ld0RpbWVuc2lvbkluZm8oKSk7CiAJCVZhcmlhYmxlRGVjbGFyYXRp
b25FeHByZXNzaW9uIHZhcmlhYmxlRGVjbGFyYXRpb25FeHByZXNzaW9uID0gdGhpcy5hc3QubmV3
VmFyaWFibGVEZWNsYXJhdGlvbkV4cHJlc3Npb24odmFyaWFibGVEZWNsYXJhdGlvbkZyYWdtZW50
KTsKIAkJdmFyaWFibGVEZWNsYXJhdGlvbkV4cHJlc3Npb24uc2V0VHlwZSh0aGlzLmFzdC5uZXdT
aW1wbGVUeXBlKHRoaXMuYXN0Lm5ld1NpbXBsZU5hbWUoIlN0cmluZyIpKSk7Ly8kTk9OLU5MUy0x
JAogCQlmb3JTdGF0ZW1lbnQuaW5pdGlhbGl6ZXJzKCkuYWRkKHZhcmlhYmxlRGVjbGFyYXRpb25F
eHByZXNzaW9uKTsKQEAgLTI4ODIsNyArMjg5Miw3IEBACiAJCWFzc2VydFRydWUoIk5vdCBhIGRl
Y2xhcmF0aW9uIiwgZnJhZy5nZXROYW1lKCkuaXNEZWNsYXJhdGlvbigpKTsgLy8kTk9OLU5MUy0x
JAogCQlWYXJpYWJsZURlY2xhcmF0aW9uRnJhZ21lbnQgZnJhZ21lbnQgPSB0aGlzLmFzdC5uZXdW
YXJpYWJsZURlY2xhcmF0aW9uRnJhZ21lbnQoKTsKIAkJZnJhZ21lbnQuc2V0TmFtZSh0aGlzLmFz
dC5uZXdTaW1wbGVOYW1lKCJpIikpOyAvLyROT04tTkxTLTEkCi0JCWZyYWdtZW50LnNldEV4dHJh
RGltZW5zaW9ucygwKTsKKwkJZnJhZ21lbnQuZ2V0RXh0cmFEaW1lbnNpb25JbmZvcygpLmNsZWFy
KCk7CiAJCUZpZWxkRGVjbGFyYXRpb24gZmllbGREZWNsYXJhdGlvbiA9IHRoaXMuYXN0Lm5ld0Zp
ZWxkRGVjbGFyYXRpb24oZnJhZ21lbnQpOwogCQlmaWVsZERlY2xhcmF0aW9uLnNldFR5cGUodGhp
cy5hc3QubmV3UHJpbWl0aXZlVHlwZShQcmltaXRpdmVUeXBlLklOVCkpOwogCQlhc3NlcnRUcnVl
KCJCb3RoIEFTVCB0cmVlcyBzaG91bGQgYmUgaWRlbnRpY2FsIiwgZmllbGREZWNsYXJhdGlvbi5z
dWJ0cmVlTWF0Y2gobmV3IEFTVE1hdGNoZXIoKSwgbm9kZSkpOwkJLy8kTk9OLU5MUy0xJApAQCAt
MjkwNCwyMiArMjkxNCwyNSBAQAogCQlOdW1iZXJMaXRlcmFsIGxpdGVyYWwgPSB0aGlzLmFzdC5u
ZXdOdW1iZXJMaXRlcmFsKCk7CiAJCWxpdGVyYWwuc2V0VG9rZW4oIjEwIik7IC8vJE5PTi1OTFMt
MSQKIAkJZnJhZ21lbnQuc2V0SW5pdGlhbGl6ZXIobGl0ZXJhbCk7Ci0JCWZyYWdtZW50LnNldEV4
dHJhRGltZW5zaW9ucygwKTsKKwkJZnJhZ21lbnQuZ2V0RXh0cmFEaW1lbnNpb25JbmZvcygpLmNs
ZWFyKCk7CiAJCUZpZWxkRGVjbGFyYXRpb24gZmllbGREZWNsYXJhdGlvbiA9IHRoaXMuYXN0Lm5l
d0ZpZWxkRGVjbGFyYXRpb24oZnJhZ21lbnQpOwogCQlmaWVsZERlY2xhcmF0aW9uLm1vZGlmaWVy
cygpLmFkZCh0aGlzLmFzdC5uZXdNb2RpZmllcihNb2RpZmllci5Nb2RpZmllcktleXdvcmQuUFVC
TElDX0tFWVdPUkQpKTsKIAkJZmllbGREZWNsYXJhdGlvbi5zZXRUeXBlKHRoaXMuYXN0Lm5ld1By
aW1pdGl2ZVR5cGUoUHJpbWl0aXZlVHlwZS5JTlQpKTsKIAkJZnJhZ21lbnQgPSB0aGlzLmFzdC5u
ZXdWYXJpYWJsZURlY2xhcmF0aW9uRnJhZ21lbnQoKTsKIAkJZnJhZ21lbnQuc2V0TmFtZSh0aGlz
LmFzdC5uZXdTaW1wbGVOYW1lKCJ5IikpOy8vJE5PTi1OTFMtMSQKLQkJZnJhZ21lbnQuc2V0RXh0
cmFEaW1lbnNpb25zKDEpOworCQlmcmFnbWVudC5nZXRFeHRyYURpbWVuc2lvbkluZm9zKCkuY2xl
YXIoKTsKKwkJZnJhZ21lbnQuZ2V0RXh0cmFEaW1lbnNpb25JbmZvcygpLmFkZCh0aGlzLmFzdC5u
ZXdEaW1lbnNpb25JbmZvKCkpOwogCQlmcmFnbWVudC5zZXRJbml0aWFsaXplcih0aGlzLmFzdC5u
ZXdOdWxsTGl0ZXJhbCgpKTsKIAkJZmllbGREZWNsYXJhdGlvbi5mcmFnbWVudHMoKS5hZGQoZnJh
Z21lbnQpOwogCQlmcmFnbWVudCA9IHRoaXMuYXN0Lm5ld1ZhcmlhYmxlRGVjbGFyYXRpb25GcmFn
bWVudCgpOwogCQlmcmFnbWVudC5zZXROYW1lKHRoaXMuYXN0Lm5ld1NpbXBsZU5hbWUoImkiKSk7
Ly8kTk9OLU5MUy0xJAotCQlmcmFnbWVudC5zZXRFeHRyYURpbWVuc2lvbnMoMCk7CisJCWZyYWdt
ZW50LmdldEV4dHJhRGltZW5zaW9uSW5mb3MoKS5jbGVhcigpOwogCQlmaWVsZERlY2xhcmF0aW9u
LmZyYWdtZW50cygpLmFkZChmcmFnbWVudCk7CiAJCWZyYWdtZW50ID0gdGhpcy5hc3QubmV3VmFy
aWFibGVEZWNsYXJhdGlvbkZyYWdtZW50KCk7CiAJCWZyYWdtZW50LnNldE5hbWUodGhpcy5hc3Qu
bmV3U2ltcGxlTmFtZSgiaiIpKTsvLyROT04tTkxTLTEkCi0JCWZyYWdtZW50LnNldEV4dHJhRGlt
ZW5zaW9ucygyKTsKKwkJZnJhZ21lbnQuZ2V0RXh0cmFEaW1lbnNpb25JbmZvcygpLmNsZWFyKCk7
CisJCWZyYWdtZW50LmdldEV4dHJhRGltZW5zaW9uSW5mb3MoKS5hZGQodGhpcy5hc3QubmV3RGlt
ZW5zaW9uSW5mbygpKTsKKwkJZnJhZ21lbnQuZ2V0RXh0cmFEaW1lbnNpb25JbmZvcygpLmFkZCh0
aGlzLmFzdC5uZXdEaW1lbnNpb25JbmZvKCkpOwogCQlmaWVsZERlY2xhcmF0aW9uLmZyYWdtZW50
cygpLmFkZChmcmFnbWVudCk7CiAJCWFzc2VydFRydWUoIkJvdGggQVNUIHRyZWVzIHNob3VsZCBi
ZSBpZGVudGljYWwiLCBmaWVsZERlY2xhcmF0aW9uLnN1YnRyZWVNYXRjaChuZXcgQVNUTWF0Y2hl
cigpLCBub2RlKSk7CQkvLyROT04tTkxTLTEkCiAJCWNoZWNrU291cmNlUmFuZ2Uobm9kZSwgInB1
YmxpYyBpbnQgeD0gMTAsIHlbXSA9IG51bGwsIGksIGpbXVtdOyIsIHNvdXJjZSk7IC8vJE5PTi1O
TFMtMSQKQEAgLTk1OTEsNiArOTYwNCw4IEBACiAJCWFzc2VydE5vdE51bGwoIk5vIHR5cGUgYmlu
ZGluZyIsIHR5cGVCaW5kaW5nMik7IC8vJE5PTi1OTFMtMSQKIAkJYXNzZXJ0RXF1YWxzKCJXcm9u
ZyBxdWFsaWZpZWQgbmFtZSIsICJqYXZhLmxhbmcuU3RyaW5nW10iLCB0eXBlQmluZGluZzIuZ2V0
UXVhbGlmaWVkTmFtZSgpKTsgLy8kTk9OLU5MUy0xJCAvLyROT04tTkxTLTIkCiAJCWFzc2VydEVx
dWFscygiV3JvbmcgZGltZW5zaW9uIiwgMSwgdHlwZUJpbmRpbmcyLmdldERpbWVuc2lvbnMoKSk7
IC8vJE5PTi1OTFMtMSQKKwkJTGlzdCBleHRyYURpbWVuc2lvbnMgPSBtZXRob2REZWNsYXJhdGlv
bi5nZXRFeHRyYURpbWVuc2lvbkluZm9zKCk7CisJCWFzc2VydEV4dHJhRGltZW5zaW9uc0VxdWFs
KCJXcm9uZyBleHRyYSBkaW1lbnNpb24gaW5mbyIsIGV4dHJhRGltZW5zaW9ucywgIltdIik7CiAJ
fQogCiAJLyoqCkBAIC05Njc3LDYgKzk2OTIsOCBAQAogCQlhc3NlcnRUcnVlKCJOb3QgYW4gYXJy
YXkgYmluZGluZyIsIHR5cGVCaW5kaW5nMi5pc0FycmF5KCkpOyAvLyROT04tTkxTLTEkCiAJCWFz
c2VydEVxdWFscygiV3JvbmcgZGltZW5zaW9uIiwgMSwgdHlwZUJpbmRpbmcyLmdldERpbWVuc2lv
bnMoKSk7IC8vJE5PTi1OTFMtMSQKIAkJYXNzZXJ0RXF1YWxzKCJ3cm9uZyBmdWxseSBxdWFsaWZp
ZWQgbmFtZSIsICJqYXZhLmxhbmcuU3RyaW5nW10iLCB0eXBlQmluZGluZzIuZ2V0UXVhbGlmaWVk
TmFtZSgpKTsgLy8kTk9OLU5MUy0xJCAvLyROT04tTkxTLTIkCisJCUxpc3QgZXh0cmFEaW1lbnNp
b25zID0gc2luZ2xlVmFyaWFibGVEZWNsYXJhdGlvbi5nZXRFeHRyYURpbWVuc2lvbkluZm9zKCk7
CisJCWFzc2VydEV4dHJhRGltZW5zaW9uc0VxdWFsKCJXcm9uZyBleHRyYSBkaW1lbnNpb24gaW5m
byIsIGV4dHJhRGltZW5zaW9ucywgIltdIik7CiAJfQogCiAJLyoqCmRpZmYgLS1naXQgYS9vcmcu
ZWNsaXBzZS5qZHQuY29yZS50ZXN0cy5tb2RlbC9zcmMvb3JnL2VjbGlwc2UvamR0L2NvcmUvdGVz
dHMvZG9tL0FTVFN0cnVjdHVyYWxQcm9wZXJ0eVRlc3QuamF2YSBiL29yZy5lY2xpcHNlLmpkdC5j
b3JlLnRlc3RzLm1vZGVsL3NyYy9vcmcvZWNsaXBzZS9qZHQvY29yZS90ZXN0cy9kb20vQVNUU3Ry
dWN0dXJhbFByb3BlcnR5VGVzdC5qYXZhCmluZGV4IDI0MDNlOWQuLjQ3ODM2ZjAgMTAwNjQ0Ci0t
LSBhL29yZy5lY2xpcHNlLmpkdC5jb3JlLnRlc3RzLm1vZGVsL3NyYy9vcmcvZWNsaXBzZS9qZHQv
Y29yZS90ZXN0cy9kb20vQVNUU3RydWN0dXJhbFByb3BlcnR5VGVzdC5qYXZhCisrKyBiL29yZy5l
Y2xpcHNlLmpkdC5jb3JlLnRlc3RzLm1vZGVsL3NyYy9vcmcvZWNsaXBzZS9qZHQvY29yZS90ZXN0
cy9kb20vQVNUU3RydWN0dXJhbFByb3BlcnR5VGVzdC5qYXZhCkBAIC0zNDYsNyArMzQ2LDcgQEAK
IAkJCQkvLyBvb3BzIC0gZ3Vlc3MgdGhhdCdzIG5vdCB2YWxpZAogCQkJfQogCQl9Ci0JCWFzc2Vy
dEVxdWFscygiV3JvbmcgbGFzdCBrbm93biB0eXBlIiwgODQsIGhpKTsgLy8gbGFzdCBrbm93biBv
bmUKKwkJYXNzZXJ0RXF1YWxzKCJXcm9uZyBsYXN0IGtub3duIHR5cGUiLCA4NSwgaGkpOyAvLyBs
YXN0IGtub3duIG9uZQogCQlhc3NlcnRFcXVhbHMoIldyb25nIG51bWJlciBvZiBkaXN0aW5jdCB0
eXBlcyIsICBoaSwgY2xhc3Nlcy5zaXplKCkpOyAvLyBhbGwgY2xhc3NlcyBhcmUgZGlzdGluY3QK
IAl9CiB9CmRpZmYgLS1naXQgYS9vcmcuZWNsaXBzZS5qZHQuY29yZS50ZXN0cy5tb2RlbC9zcmMv
b3JnL2VjbGlwc2UvamR0L2NvcmUvdGVzdHMvZG9tL0NvbnZlcnRlclRlc3RTZXR1cC5qYXZhIGIv
b3JnLmVjbGlwc2UuamR0LmNvcmUudGVzdHMubW9kZWwvc3JjL29yZy9lY2xpcHNlL2pkdC9jb3Jl
L3Rlc3RzL2RvbS9Db252ZXJ0ZXJUZXN0U2V0dXAuamF2YQppbmRleCBjZGJjNGEwLi5jYzg1OWIz
IDEwMDY0NAotLS0gYS9vcmcuZWNsaXBzZS5qZHQuY29yZS50ZXN0cy5tb2RlbC9zcmMvb3JnL2Vj
bGlwc2UvamR0L2NvcmUvdGVzdHMvZG9tL0NvbnZlcnRlclRlc3RTZXR1cC5qYXZhCisrKyBiL29y
Zy5lY2xpcHNlLmpkdC5jb3JlLnRlc3RzLm1vZGVsL3NyYy9vcmcvZWNsaXBzZS9qZHQvY29yZS90
ZXN0cy9kb20vQ29udmVydGVyVGVzdFNldHVwLmphdmEKQEAgLTEsNSArMSw1IEBACiAvKioqKioq
KioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioq
KioqKioqKioqKioqKioqKgotICogQ29weXJpZ2h0IChjKSAyMDAwLCAyMDEyIElCTSBDb3Jwb3Jh
dGlvbiBhbmQgb3RoZXJzLgorICogQ29weXJpZ2h0IChjKSAyMDAwLCAyMDEzIElCTSBDb3Jwb3Jh
dGlvbiBhbmQgb3RoZXJzLgogICogQWxsIHJpZ2h0cyByZXNlcnZlZC4gVGhpcyBwcm9ncmFtIGFu
ZCB0aGUgYWNjb21wYW55aW5nIG1hdGVyaWFscwogICogYXJlIG1hZGUgYXZhaWxhYmxlIHVuZGVy
IHRoZSB0ZXJtcyBvZiB0aGUgRWNsaXBzZSBQdWJsaWMgTGljZW5zZSB2MS4wCiAgKiB3aGljaCBh
Y2NvbXBhbmllcyB0aGlzIGRpc3RyaWJ1dGlvbiwgYW5kIGlzIGF2YWlsYWJsZSBhdApAQCAtMTUs
NiArMTUsNyBAQAogcGFja2FnZSBvcmcuZWNsaXBzZS5qZHQuY29yZS50ZXN0cy5kb207CiAKIGlt
cG9ydCBqYXZhLmlvLklPRXhjZXB0aW9uOworaW1wb3J0IGphdmEudXRpbC5JdGVyYXRvcjsKIGlt
cG9ydCBqYXZhLnV0aWwuTGlzdDsKIGltcG9ydCBqYXZhLnV0aWwuTWFwOwogCkBAIC0xNDEsNiAr
MTQyLDI2IEBACiAJCX0KIAl9CiAKKwlwcm90ZWN0ZWQgdm9pZCBhc3NlcnRFeHRyYURpbWVuc2lv
bnNFcXVhbChTdHJpbmcgbWVzc2FnZSwgTGlzdCBkaW1lbnNpb25zLCBTdHJpbmcgZXhwZWN0ZWQp
IHsKKwkJU3RyaW5nQnVmZmVyIGJ1ZmZlciA9IG5ldyBTdHJpbmdCdWZmZXIoKTsKKwkJSXRlcmF0
b3IgaXRlciA9IGRpbWVuc2lvbnMuaXRlcmF0b3IoKTsKKwkJd2hpbGUoaXRlci5oYXNOZXh0KCkp
IHsKKwkJCURpbWVuc2lvbkluZm8gZGltID0gKERpbWVuc2lvbkluZm8pIGl0ZXIubmV4dCgpOwor
CQkJSXRlcmF0b3IgYW5ub3RhdGlvbnMgPSBkaW0uYW5ub3RhdGlvbnMoKS5pdGVyYXRvcigpOwor
CQkJd2hpbGUgKGFubm90YXRpb25zLmhhc05leHQoKSkgeworCQkJCWJ1ZmZlci5hcHBlbmQoJ0An
KTsKKwkJCQlidWZmZXIuYXBwZW5kKCgoQW5ub3RhdGlvbikgYW5ub3RhdGlvbnMubmV4dCgpKS5n
ZXRUeXBlTmFtZSgpLmdldEZ1bGx5UXVhbGlmaWVkTmFtZSgpKTsKKwkJCQlidWZmZXIuYXBwZW5k
KCcgJyk7CisJCQl9CisJCQlpZiAoaXRlci5oYXNOZXh0KCkpIHsKKwkJCQlidWZmZXIuYXBwZW5k
KCJbXSAiKTsKKwkJCX0gZWxzZSB7CisJCQkJYnVmZmVyLmFwcGVuZCgiW10iKTsKKwkJCX0KKwkJ
fQorCQlhc3NlcnRFcXVhbHMobWVzc2FnZSwgZXhwZWN0ZWQsIGJ1ZmZlci50b1N0cmluZygpKTsK
Kwl9CisKIAlwdWJsaWMgQVNUTm9kZSBydW5Db252ZXJzaW9uKElDb21waWxhdGlvblVuaXQgdW5p
dCwgYm9vbGVhbiByZXNvbHZlQmluZGluZ3MsCiAJCQlib29sZWFuIGJpbmRpbmdzUmVjb3Zlcnkp
IHsKIAkJcmV0dXJuIHJ1bkNvbnZlcnNpb24oYXN0SW50ZXJuYWxKTFMyKCksIHVuaXQsIHJlc29s
dmVCaW5kaW5ncywgZmFsc2UsIGJpbmRpbmdzUmVjb3ZlcnkpOwpkaWZmIC0tZ2l0IGEvb3JnLmVj
bGlwc2UuamR0LmNvcmUudGVzdHMubW9kZWwvd29ya3NwYWNlL0NvbnZlcnRlcjE4L3NyYy9YLmph
dmEgYi9vcmcuZWNsaXBzZS5qZHQuY29yZS50ZXN0cy5tb2RlbC93b3Jrc3BhY2UvQ29udmVydGVy
MTgvc3JjL1guamF2YQpuZXcgZmlsZSBtb2RlIDEwMDY0NAppbmRleCAwMDAwMDAwLi41YTFhODg4
Ci0tLSAvZGV2L251bGwKKysrIGIvb3JnLmVjbGlwc2UuamR0LmNvcmUudGVzdHMubW9kZWwvd29y
a3NwYWNlL0NvbnZlcnRlcjE4L3NyYy9YLmphdmEKQEAgLTAsMCArMSw0IEBACitwdWJsaWMgY2xh
c3MgWCB7CisJcHVibGljIHZvaWQgZm9vKFggdGhpcykgeworCX0KK30KZGlmZiAtLWdpdCBhL29y
Zy5lY2xpcHNlLmpkdC5jb3JlL2RvbS9vcmcvZWNsaXBzZS9qZHQvY29yZS9kb20vQVNULmphdmEg
Yi9vcmcuZWNsaXBzZS5qZHQuY29yZS9kb20vb3JnL2VjbGlwc2UvamR0L2NvcmUvZG9tL0FTVC5q
YXZhCmluZGV4IDBkNWFlZDUuLmI2YzI1MTQgMTAwNjQ0Ci0tLSBhL29yZy5lY2xpcHNlLmpkdC5j
b3JlL2RvbS9vcmcvZWNsaXBzZS9qZHQvY29yZS9kb20vQVNULmphdmEKKysrIGIvb3JnLmVjbGlw
c2UuamR0LmNvcmUvZG9tL29yZy9lY2xpcHNlL2pkdC9jb3JlL2RvbS9BU1QuamF2YQpAQCAtMSw1
ICsxLDUgQEAKIC8qKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioq
KioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqCi0gKiBDb3B5cmlnaHQgKGMpIDIwMDAs
IDIwMTIgSUJNIENvcnBvcmF0aW9uIGFuZCBvdGhlcnMuCisgKiBDb3B5cmlnaHQgKGMpIDIwMDAs
IDIwMTMgSUJNIENvcnBvcmF0aW9uIGFuZCBvdGhlcnMuCiAgKiBBbGwgcmlnaHRzIHJlc2VydmVk
LiBUaGlzIHByb2dyYW0gYW5kIHRoZSBhY2NvbXBhbnlpbmcgbWF0ZXJpYWxzCiAgKiBhcmUgbWFk
ZSBhdmFpbGFibGUgdW5kZXIgdGhlIHRlcm1zIG9mIHRoZSBFY2xpcHNlIFB1YmxpYyBMaWNlbnNl
IHYxLjAKICAqIHdoaWNoIGFjY29tcGFuaWVzIHRoaXMgZGlzdHJpYnV0aW9uLCBhbmQgaXMgYXZh
aWxhYmxlIGF0CkBAIC0xMTE2LDYgKzExMTYsMjUgQEAKIAl9CiAKIAkvKioKKwkgKiBDcmVhdGVz
IGFuZCByZXR1cm5zIGEgbmV3IHVucGFyZW50ZWQgYW5ub3RhdGFibGUgZGltZW5zaW9uIGluZm8g
bm9kZQorCSAqIChTdXBwb3J0ZWQgb25seSBpbiBKTFM4IGxldmVsKS4KKwkgKgorCSAqIEByZXR1
cm4gYSBuZXcgdW5wYXJlbnRlZCBhbm5vdGF0YWJsZSBkaW1lbnNpb24gaW5mbyBub2RlCisJICog
QGV4Y2VwdGlvbiBJbGxlZ2FsQXJndW1lbnRFeGNlcHRpb24gaWY6CisJICogPHVsPgorCSAqIDxs
aT50aGUgbm9kZSBiZWxvbmdzIHRvIGEgZGlmZmVyZW50IEFTVDwvbGk+CisJICogPGxpPnRoZSBu
b2RlIGFscmVhZHkgaGFzIGEgcGFyZW50PC9saT4KKwkgKiA8L3VsPgorCSAqIEBleGNlcHRpb24g
VW5zdXBwb3J0ZWRPcGVyYXRpb25FeGNlcHRpb24gaWYgdGhpcyBvcGVyYXRpb24gaXMgdXNlZAor
CSAqICAgICAgICAgICAgaW4gYSBKTFMyLCBKTFMzIG9yIEpMUzQgQVNUCisJICogQHNpbmNlIDMu
OQorCSAqLworCXB1YmxpYyBEaW1lbnNpb25JbmZvIG5ld0RpbWVuc2lvbkluZm8oKSB7CisJCURp
bWVuc2lvbkluZm8gcmVzdWx0ID0gbmV3IERpbWVuc2lvbkluZm8odGhpcyk7CisJCXJldHVybiBy
ZXN1bHQ7CisJfQorCisJLyoqCiAJICogQ3JlYXRlcyBhbmQgcmV0dXJucyBhIG5ldyB1bnBhcmVu
dGVkIGFycmF5IHR5cGUgbm9kZSB3aXRoIHRoZSBnaXZlbgogCSAqIGVsZW1lbnQgdHlwZSBhbmQg
bnVtYmVyIG9mIChhZGRpdGlvbmFsKSBkaW1lbnNpb25zLgogCSAqIDxwPgpkaWZmIC0tZ2l0IGEv
b3JnLmVjbGlwc2UuamR0LmNvcmUvZG9tL29yZy9lY2xpcHNlL2pkdC9jb3JlL2RvbS9BU1RDb252
ZXJ0ZXIuamF2YSBiL29yZy5lY2xpcHNlLmpkdC5jb3JlL2RvbS9vcmcvZWNsaXBzZS9qZHQvY29y
ZS9kb20vQVNUQ29udmVydGVyLmphdmEKaW5kZXggMzYxYWNlNi4uYjQ4YmY0ZiAxMDA2NDQKLS0t
IGEvb3JnLmVjbGlwc2UuamR0LmNvcmUvZG9tL29yZy9lY2xpcHNlL2pkdC9jb3JlL2RvbS9BU1RD
b252ZXJ0ZXIuamF2YQorKysgYi9vcmcuZWNsaXBzZS5qZHQuY29yZS9kb20vb3JnL2VjbGlwc2Uv
amR0L2NvcmUvZG9tL0FTVENvbnZlcnRlci5qYXZhCkBAIC01MDgsNyArNTA4LDEyIEBACiAJCQkJ
Ly8gZ2V0IHRoZSBwb3NpdGlvbnMgb2YgdGhlIHJpZ2h0IHBhcmVudGhlc2lzCiAJCQkJaW50IHJp
Z2h0UGFyZW50aGVzaXNQb3NpdGlvbiA9IHJldHJpZXZlRW5kT2ZSaWdodFBhcmVudGhlc2lzUG9z
aXRpb24oZW5kLCBtZXRob2QuYm9keUVuZCk7CiAJCQkJaW50IGV4dHJhRGltZW5zaW9ucyA9IHJl
dHJpZXZlRXh0cmFEaW1lbnNpb24ocmlnaHRQYXJlbnRoZXNpc1Bvc2l0aW9uLCBtZXRob2QuYm9k
eUVuZCk7Ci0JCQkJbWV0aG9kRGVjbC5zZXRFeHRyYURpbWVuc2lvbnMoZXh0cmFEaW1lbnNpb25z
KTsKKwkJCQlpZiAodGhpcy5hc3QuYXBpTGV2ZWwgPj0gQVNULkpMUzgpIHsKKwkJCQkJc2V0RXh0
cmFBbm5vdGF0ZWREaW1lbnNpb25zKHJpZ2h0UGFyZW50aGVzaXNQb3NpdGlvbiwgdGhpcy5zY2Fu
bmVyLmN1cnJlbnRQb3NpdGlvbiwgdHlwZVJlZmVyZW5jZSwKKwkJCQkJCQkJCQkJCW1ldGhvZERl
Y2wuZXh0cmFEaW1lbnNpb25JbmZvcywgZXh0cmFEaW1lbnNpb25zKTsKKwkJCQl9IGVsc2Ugewor
CQkJCQltZXRob2REZWNsLnNldEV4dHJhRGltZW5zaW9ucyhleHRyYURpbWVuc2lvbnMpOworCQkJ
CX0KIAkJCQlzZXRUeXBlRm9yTWV0aG9kRGVjbGFyYXRpb24obWV0aG9kRGVjbCwgcmV0dXJuVHlw
ZSwgZXh0cmFEaW1lbnNpb25zKTsKIAkJCX0gZWxzZSB7CiAJCQkJLy8gbm8gcmV0dXJuIHR5cGUg
Zm9yIGEgbWV0aG9kIHRoYXQgaXMgbm90IGEgY29uc3RydWN0b3IKQEAgLTgyOSw3ICs4MzQsMTIg
QEAKIAkJdmFyaWFibGVEZWNsLnNldE5hbWUobmFtZSk7CiAJCWZpbmFsIGludCB0eXBlU291cmNl
RW5kID0gYXJndW1lbnQudHlwZS5zb3VyY2VFbmQ7CiAJCWZpbmFsIGludCBleHRyYURpbWVuc2lv
bnMgPSByZXRyaWV2ZUV4dHJhRGltZW5zaW9uKG5hbWVFbmQgKyAxLCB0eXBlU291cmNlRW5kKTsK
LQkJdmFyaWFibGVEZWNsLnNldEV4dHJhRGltZW5zaW9ucyhleHRyYURpbWVuc2lvbnMpOworCQlp
ZiAodGhpcy5hc3QuYXBpTGV2ZWwgPj0gQVNULkpMUzgpIHsKKwkJCXNldEV4dHJhQW5ub3RhdGVk
RGltZW5zaW9ucyhuYW1lRW5kICsgMSwgdGhpcy5zY2FubmVyLmN1cnJlbnRQb3NpdGlvbiwgYXJn
dW1lbnQudHlwZSwKKwkJCQkJCQkJCQl2YXJpYWJsZURlY2wuZXh0cmFEaW1lbnNpb25JbmZvcywg
ZXh0cmFEaW1lbnNpb25zKTsKKwkJfSBlbHNlIHsKKwkJCXZhcmlhYmxlRGVjbC5zZXRFeHRyYURp
bWVuc2lvbnMoZXh0cmFEaW1lbnNpb25zKTsKKwkJfQogCQlmaW5hbCBib29sZWFuIGlzVmFyQXJn
cyA9IGFyZ3VtZW50LmlzVmFyQXJncygpOwogCQlpZiAoaXNWYXJBcmdzICYmIGV4dHJhRGltZW5z
aW9ucyA9PSAwKSB7CiAJCQkvLyByZW1vdmUgdGhlIGVsbGlwc2lzIGZyb20gdGhlIHR5cGUgc291
cmNlIGVuZApAQCAtMjk0NCw3ICsyOTU0LDkgQEAKIAkJfQogCQlmaWVsZERlY2xhcmF0aW9uLnNl
dFNvdXJjZVJhbmdlKGZpZWxkRGVjbC5kZWNsYXJhdGlvblNvdXJjZVN0YXJ0LCBmaWVsZERlY2wu
ZGVjbGFyYXRpb25FbmQgLSBmaWVsZERlY2wuZGVjbGFyYXRpb25Tb3VyY2VTdGFydCArIDEpOwog
CQlUeXBlIHR5cGUgPSBjb252ZXJ0VHlwZShmaWVsZERlY2wudHlwZSk7Ci0JCXNldFR5cGVGb3JG
aWVsZChmaWVsZERlY2xhcmF0aW9uLCB0eXBlLCB2YXJpYWJsZURlY2xhcmF0aW9uRnJhZ21lbnQu
Z2V0RXh0cmFEaW1lbnNpb25zKCkpOworCQlzZXRUeXBlRm9yRmllbGQoZmllbGREZWNsYXJhdGlv
biwgdHlwZSwgCisJCQkJKHRoaXMuYXN0LmFwaUxldmVsIDwgQVNULkpMUzgpID8gdmFyaWFibGVE
ZWNsYXJhdGlvbkZyYWdtZW50LmdldEV4dHJhRGltZW5zaW9ucygpIAorCQkJCQkJOiB2YXJpYWJs
ZURlY2xhcmF0aW9uRnJhZ21lbnQuZ2V0RXh0cmFEaW1lbnNpb25JbmZvcygpLnNpemUoKSk7CiAJ
CXNldE1vZGlmaWVycyhmaWVsZERlY2xhcmF0aW9uLCBmaWVsZERlY2wpOwogCQljb252ZXJ0KGZp
ZWxkRGVjbC5qYXZhZG9jLCBmaWVsZERlY2xhcmF0aW9uKTsKIAkJcmV0dXJuIGZpZWxkRGVjbGFy
YXRpb247CkBAIC0yOTc1LDcgKzI5ODcsMTAgQEAKIAkJfQogCQl2YXJpYWJsZURlY2xhcmF0aW9u
RXhwcmVzc2lvbi5zZXRTb3VyY2VSYW5nZShsb2NhbERlY2xhcmF0aW9uLmRlY2xhcmF0aW9uU291
cmNlU3RhcnQsIGxvY2FsRGVjbGFyYXRpb24uZGVjbGFyYXRpb25Tb3VyY2VFbmQgLSBsb2NhbERl
Y2xhcmF0aW9uLmRlY2xhcmF0aW9uU291cmNlU3RhcnQgKyAxKTsKIAkJVHlwZSB0eXBlID0gY29u
dmVydFR5cGUobG9jYWxEZWNsYXJhdGlvbi50eXBlKTsKLQkJc2V0VHlwZUZvclZhcmlhYmxlRGVj
bGFyYXRpb25FeHByZXNzaW9uKHZhcmlhYmxlRGVjbGFyYXRpb25FeHByZXNzaW9uLCB0eXBlLCB2
YXJpYWJsZURlY2xhcmF0aW9uRnJhZ21lbnQuZ2V0RXh0cmFEaW1lbnNpb25zKCkpOworCQlzZXRU
eXBlRm9yVmFyaWFibGVEZWNsYXJhdGlvbkV4cHJlc3Npb24oCisJCQkJCXZhcmlhYmxlRGVjbGFy
YXRpb25FeHByZXNzaW9uLCB0eXBlLAorCQkJCQkodGhpcy5hc3QuYXBpTGV2ZWwgPCBBU1QuSkxT
OCkgPyB2YXJpYWJsZURlY2xhcmF0aW9uRnJhZ21lbnQuZ2V0RXh0cmFEaW1lbnNpb25zKCkKKwkJ
CQkJOiB2YXJpYWJsZURlY2xhcmF0aW9uRnJhZ21lbnQuZ2V0RXh0cmFEaW1lbnNpb25JbmZvcygp
LnNpemUoKSk7CiAJCWlmIChsb2NhbERlY2xhcmF0aW9uLm1vZGlmaWVyc1NvdXJjZVN0YXJ0ICE9
IC0xKSB7CiAJCQlzZXRNb2RpZmllcnModmFyaWFibGVEZWNsYXJhdGlvbkV4cHJlc3Npb24sIGxv
Y2FsRGVjbGFyYXRpb24pOwogCQl9CkBAIC0yOTkyLDcgKzMwMDcsMTIgQEAKIAkJbmFtZS5zZXRT
b3VyY2VSYW5nZShzdGFydCwgbmFtZUVuZCAtIHN0YXJ0ICsgMSk7CiAJCXZhcmlhYmxlRGVjbC5z
ZXROYW1lKG5hbWUpOwogCQlmaW5hbCBpbnQgZXh0cmFEaW1lbnNpb25zID0gcmV0cmlldmVFeHRy
YURpbWVuc2lvbihuYW1lRW5kICsgMSwgbG9jYWxEZWNsYXJhdGlvbi50eXBlLnNvdXJjZUVuZCk7
Ci0JCXZhcmlhYmxlRGVjbC5zZXRFeHRyYURpbWVuc2lvbnMoZXh0cmFEaW1lbnNpb25zKTsKKwkJ
aWYgKHRoaXMuYXN0LmFwaUxldmVsID49IEFTVC5KTFM4KSB7CisJCQlzZXRFeHRyYUFubm90YXRl
ZERpbWVuc2lvbnMobmFtZUVuZCArIDEsIHRoaXMuc2Nhbm5lci5jdXJyZW50UG9zaXRpb24sIGxv
Y2FsRGVjbGFyYXRpb24udHlwZSwKKwkJCQkJdmFyaWFibGVEZWNsLmV4dHJhRGltZW5zaW9uSW5m
b3MsIGV4dHJhRGltZW5zaW9ucyk7CisJCX0gZWxzZSB7CisJCQl2YXJpYWJsZURlY2wuc2V0RXh0
cmFEaW1lbnNpb25zKGV4dHJhRGltZW5zaW9ucyk7CisJCX0KIAkJVHlwZSB0eXBlID0gY29udmVy
dFR5cGUobG9jYWxEZWNsYXJhdGlvbi50eXBlKTsKIAkJaW50IHR5cGVFbmQgPSB0eXBlLmdldFN0
YXJ0UG9zaXRpb24oKSArIHR5cGUuZ2V0TGVuZ3RoKCkgLSAxOwogCQlpbnQgcmlnaHRFbmQgPSBN
YXRoLm1heCh0eXBlRW5kLCBsb2NhbERlY2xhcmF0aW9uLmRlY2xhcmF0aW9uU291cmNlRW5kKTsK
QEAgLTMwMTAsNiArMzAzMCwxNyBAQAogCQlyZXR1cm4gdmFyaWFibGVEZWNsOwogCX0KIAorCXBy
aXZhdGUgRGltZW5zaW9uSW5mbyBjb252ZXJ0VG9EaW1lbnNpb25JbmZvKGludCBzdGFydCwgaW50
IGVuZCwgb3JnLmVjbGlwc2UuamR0LmludGVybmFsLmNvbXBpbGVyLmFzdC5Bbm5vdGF0aW9uW10g
YW5ub3RhdGlvbikgeworCQlpbnQgbGVuZ3RoID0gYW5ub3RhdGlvbiA9PSBudWxsID8gMCA6IGFu
bm90YXRpb24ubGVuZ3RoOworCQlEaW1lbnNpb25JbmZvIGRpbWVuc2lvbiA9IHRoaXMuYXN0Lm5l
d0RpbWVuc2lvbkluZm8oKTsKKwkJZm9yIChpbnQgaSA9IDA7IGkgPCBsZW5ndGg7IGkrKykgewor
CQkJQW5ub3RhdGlvbiBhbm5vdCA9IGNvbnZlcnQoYW5ub3RhdGlvbltpXSk7CisJCQlkaW1lbnNp
b24uYW5ub3RhdGlvbnMuYWRkKGFubm90KTsKKwkJfQorCQlyZXRyaWV2ZURpbWVuc2lvbkFuZFNl
dFBvc2l0aW9ucyhzdGFydCwgZW5kLCBkaW1lbnNpb24pOworCQlyZXR1cm4gZGltZW5zaW9uOwor
CX0KKwogCXByb3RlY3RlZCBWYXJpYWJsZURlY2xhcmF0aW9uRnJhZ21lbnQgY29udmVydFRvVmFy
aWFibGVEZWNsYXJhdGlvbkZyYWdtZW50KG9yZy5lY2xpcHNlLmpkdC5pbnRlcm5hbC5jb21waWxl
ci5hc3QuRmllbGREZWNsYXJhdGlvbiBmaWVsZERlY2xhcmF0aW9uKSB7CiAJCWZpbmFsIFZhcmlh
YmxlRGVjbGFyYXRpb25GcmFnbWVudCB2YXJpYWJsZURlY2xhcmF0aW9uRnJhZ21lbnQgPSBuZXcg
VmFyaWFibGVEZWNsYXJhdGlvbkZyYWdtZW50KHRoaXMuYXN0KTsKIAkJZmluYWwgU2ltcGxlTmFt
ZSBuYW1lID0gbmV3IFNpbXBsZU5hbWUodGhpcy5hc3QpOwpAQCAtMzAxOSw3ICszMDUwLDEyIEBA
CiAJCWludCBzdGFydCA9IGZpZWxkRGVjbGFyYXRpb24uc291cmNlRW5kOwogCQlpbnQgZW5kID0g
c3RhcnQ7CiAJCWludCBleHRyYURpbWVuc2lvbnMgPSByZXRyaWV2ZUV4dHJhRGltZW5zaW9uKGZp
ZWxkRGVjbGFyYXRpb24uc291cmNlRW5kICsgMSwgZmllbGREZWNsYXJhdGlvbi5kZWNsYXJhdGlv
blNvdXJjZUVuZCApOwotCQl2YXJpYWJsZURlY2xhcmF0aW9uRnJhZ21lbnQuc2V0RXh0cmFEaW1l
bnNpb25zKGV4dHJhRGltZW5zaW9ucyk7CisJCWlmICh0aGlzLmFzdC5hcGlMZXZlbCA+PSBBU1Qu
SkxTOCkgeworCQkJc2V0RXh0cmFBbm5vdGF0ZWREaW1lbnNpb25zKGZpZWxkRGVjbGFyYXRpb24u
c291cmNlRW5kICsgMSwgdGhpcy5zY2FubmVyLmN1cnJlbnRQb3NpdGlvbiwKKwkJCQkJZmllbGRE
ZWNsYXJhdGlvbi50eXBlLCB2YXJpYWJsZURlY2xhcmF0aW9uRnJhZ21lbnQuZXh0cmFEaW1lbnNp
b25JbmZvcywgZXh0cmFEaW1lbnNpb25zKTsKKwkJfSBlbHNlIHsKKwkJCXZhcmlhYmxlRGVjbGFy
YXRpb25GcmFnbWVudC5zZXRFeHRyYURpbWVuc2lvbnMoZXh0cmFEaW1lbnNpb25zKTsKKwkJfQog
CQlpZiAoZmllbGREZWNsYXJhdGlvbi5pbml0aWFsaXphdGlvbiAhPSBudWxsKSB7CiAJCQlmaW5h
bCBFeHByZXNzaW9uIGV4cHJlc3Npb24gPSBjb252ZXJ0KGZpZWxkRGVjbGFyYXRpb24uaW5pdGlh
bGl6YXRpb24pOwogCQkJdmFyaWFibGVEZWNsYXJhdGlvbkZyYWdtZW50LnNldEluaXRpYWxpemVy
KGV4cHJlc3Npb24pOwpAQCAtMzA1Nyw3ICszMDkzLDEzIEBACiAJCWludCBzdGFydCA9IGxvY2Fs
RGVjbGFyYXRpb24uc291cmNlRW5kOwogCQlvcmcuZWNsaXBzZS5qZHQuaW50ZXJuYWwuY29tcGls
ZXIuYXN0LkV4cHJlc3Npb24gaW5pdGlhbGl6YXRpb24gPSBsb2NhbERlY2xhcmF0aW9uLmluaXRp
YWxpemF0aW9uOwogCQlpbnQgZXh0cmFEaW1lbnNpb24gPSByZXRyaWV2ZUV4dHJhRGltZW5zaW9u
KGxvY2FsRGVjbGFyYXRpb24uc291cmNlRW5kICsgMSwgdGhpcy5jb21waWxhdGlvblVuaXRTb3Vy
Y2VMZW5ndGgpOwotCQl2YXJpYWJsZURlY2xhcmF0aW9uRnJhZ21lbnQuc2V0RXh0cmFEaW1lbnNp
b25zKGV4dHJhRGltZW5zaW9uKTsKKwkJaWYgKHRoaXMuYXN0LmFwaUxldmVsID49IEFTVC5KTFM4
KSB7CisJCQlzZXRFeHRyYUFubm90YXRlZERpbWVuc2lvbnMobG9jYWxEZWNsYXJhdGlvbi5zb3Vy
Y2VFbmQgKyAxLCB0aGlzLnNjYW5uZXIuY3VycmVudFBvc2l0aW9uLAorCQkJCQlsb2NhbERlY2xh
cmF0aW9uLnR5cGUsIHZhcmlhYmxlRGVjbGFyYXRpb25GcmFnbWVudC5leHRyYURpbWVuc2lvbklu
Zm9zLCBleHRyYURpbWVuc2lvbik7CisJCX0gZWxzZSB7CisJCQl2YXJpYWJsZURlY2xhcmF0aW9u
RnJhZ21lbnQuc2V0RXh0cmFEaW1lbnNpb25zKGV4dHJhRGltZW5zaW9uKTsKKwkJfQorCiAJCWJv
b2xlYW4gaGFzSW5pdGlhbGl6YXRpb24gPSBpbml0aWFsaXphdGlvbiAhPSBudWxsOwogCQlpbnQg
ZW5kOwogCQlpZiAoaGFzSW5pdGlhbGl6YXRpb24pIHsKQEAgLTMwODgsNiArMzEzMCwxOCBAQAog
CQlyZXR1cm4gdmFyaWFibGVEZWNsYXJhdGlvbkZyYWdtZW50OwogCX0KIAorCXByb3RlY3RlZCB2
b2lkIHNldEV4dHJhQW5ub3RhdGVkRGltZW5zaW9ucyhpbnQgc3RhcnQsIGludCBlbmQsIFR5cGVS
ZWZlcmVuY2UgdHlwZSwgZmluYWwgTGlzdCBleHRyYUFubm90YXRlZERpbWVuc2lvbnMsIGludCBl
eHRyYURpbWVuc2lvbikgeworCQlpZiAoZXh0cmFEaW1lbnNpb24gPiAwKSB7CisJCQlvcmcuZWNs
aXBzZS5qZHQuaW50ZXJuYWwuY29tcGlsZXIuYXN0LkFubm90YXRpb25bXVtdIGFubm90YXRpb25z
T25EaW1zID0gdHlwZS5nZXRBbm5vdGF0aW9uc09uRGltZW5zaW9ucygpOworCQkJaW50IGxlbmd0
aCA9IChhbm5vdGF0aW9uc09uRGltcyA9PSBudWxsKSA/IDAgOiBhbm5vdGF0aW9uc09uRGltcy5s
ZW5ndGg7CisJCQlmb3IgKGludCBpID0gKGxlbmd0aCAtIGV4dHJhRGltZW5zaW9uKTsgaSA8IGxl
bmd0aDsgaSsrKSB7CisJCQkJRGltZW5zaW9uSW5mbyBkaW0gPSBjb252ZXJ0VG9EaW1lbnNpb25J
bmZvKHN0YXJ0LCBlbmQsIChhbm5vdGF0aW9uc09uRGltcyA9PSBudWxsKSA/IG51bGwgOiBhbm5v
dGF0aW9uc09uRGltc1tpXSk7CisJCQkJZXh0cmFBbm5vdGF0ZWREaW1lbnNpb25zLmFkZChkaW0p
OworCQkJCXN0YXJ0ID0gZGltLmdldFN0YXJ0UG9zaXRpb24oKSArIGRpbS5nZXRMZW5ndGgoKTsK
KwkJCX0KKwkJfQorCX0KKwogCXByb3RlY3RlZCBWYXJpYWJsZURlY2xhcmF0aW9uU3RhdGVtZW50
IGNvbnZlcnRUb1ZhcmlhYmxlRGVjbGFyYXRpb25TdGF0ZW1lbnQob3JnLmVjbGlwc2UuamR0Lmlu
dGVybmFsLmNvbXBpbGVyLmFzdC5Mb2NhbERlY2xhcmF0aW9uIGxvY2FsRGVjbGFyYXRpb24pIHsK
IAkJZmluYWwgVmFyaWFibGVEZWNsYXJhdGlvbkZyYWdtZW50IHZhcmlhYmxlRGVjbGFyYXRpb25G
cmFnbWVudCA9IGNvbnZlcnRUb1ZhcmlhYmxlRGVjbGFyYXRpb25GcmFnbWVudChsb2NhbERlY2xh
cmF0aW9uKTsKIAkJZmluYWwgVmFyaWFibGVEZWNsYXJhdGlvblN0YXRlbWVudCB2YXJpYWJsZURl
Y2xhcmF0aW9uU3RhdGVtZW50ID0gbmV3IFZhcmlhYmxlRGVjbGFyYXRpb25TdGF0ZW1lbnQodGhp
cy5hc3QpOwpAQCAtMzA5Nyw3ICszMTUxLDkgQEAKIAkJfQogCQl2YXJpYWJsZURlY2xhcmF0aW9u
U3RhdGVtZW50LnNldFNvdXJjZVJhbmdlKGxvY2FsRGVjbGFyYXRpb24uZGVjbGFyYXRpb25Tb3Vy
Y2VTdGFydCwgbG9jYWxEZWNsYXJhdGlvbi5kZWNsYXJhdGlvblNvdXJjZUVuZCAtIGxvY2FsRGVj
bGFyYXRpb24uZGVjbGFyYXRpb25Tb3VyY2VTdGFydCArIDEpOwogCQlUeXBlIHR5cGUgPSBjb252
ZXJ0VHlwZShsb2NhbERlY2xhcmF0aW9uLnR5cGUpOwotCQlzZXRUeXBlRm9yVmFyaWFibGVEZWNs
YXJhdGlvblN0YXRlbWVudCh2YXJpYWJsZURlY2xhcmF0aW9uU3RhdGVtZW50LCB0eXBlLCB2YXJp
YWJsZURlY2xhcmF0aW9uRnJhZ21lbnQuZ2V0RXh0cmFEaW1lbnNpb25zKCkpOworCQlzZXRUeXBl
Rm9yVmFyaWFibGVEZWNsYXJhdGlvblN0YXRlbWVudCh2YXJpYWJsZURlY2xhcmF0aW9uU3RhdGVt
ZW50LCB0eXBlLCAKKwkJCQkodGhpcy5hc3QuYXBpTGV2ZWwgPCBBU1QuSkxTOCkgPyB2YXJpYWJs
ZURlY2xhcmF0aW9uRnJhZ21lbnQuZ2V0RXh0cmFEaW1lbnNpb25zKCkgCisJCQkJCQk6IHZhcmlh
YmxlRGVjbGFyYXRpb25GcmFnbWVudC5nZXRFeHRyYURpbWVuc2lvbkluZm9zKCkuc2l6ZSgpKTsK
IAkJaWYgKGxvY2FsRGVjbGFyYXRpb24ubW9kaWZpZXJzU291cmNlU3RhcnQgIT0gLTEpIHsKIAkJ
CXNldE1vZGlmaWVycyh2YXJpYWJsZURlY2xhcmF0aW9uU3RhdGVtZW50LCBsb2NhbERlY2xhcmF0
aW9uKTsKIAkJfQpAQCAtNDM0NCwxNCArNDQwMCwyNiBAQAogCQlpbnQgZGltZW5zaW9ucyA9IDA7
CiAJCXRyeSB7CiAJCQlpbnQgdG9rZW47CisJCQlib29sZWFuIGlzQW5ub3RhdGlvbiA9IGZhbHNl
OwogCQkJd2hpbGUgKCh0b2tlbiA9IHRoaXMuc2Nhbm5lci5nZXROZXh0VG9rZW4oKSkgIT0gVGVy
bWluYWxUb2tlbnMuVG9rZW5OYW1lRU9GKSB7CiAJCQkJc3dpdGNoKHRva2VuKSB7CiAJCQkJCWNh
c2UgVGVybWluYWxUb2tlbnMuVG9rZW5OYW1lTEJSQUNLRVQ6CiAJCQkJCWNhc2UgVGVybWluYWxU
b2tlbnMuVG9rZW5OYW1lQ09NTUVOVF9CTE9DSzoKIAkJCQkJY2FzZSBUZXJtaW5hbFRva2Vucy5U
b2tlbk5hbWVDT01NRU5UX0pBVkFET0M6CiAJCQkJCWNhc2UgVGVybWluYWxUb2tlbnMuVG9rZW5O
YW1lQ09NTUVOVF9MSU5FOgorCQkJCQkJaXNBbm5vdGF0aW9uID0gZmFsc2U7CisJCQkJCQlicmVh
azsKKwkJCQkJY2FzZSBUZXJtaW5hbFRva2Vucy5Ub2tlbk5hbWVBVDoKKwkJCQkJCWlzQW5ub3Rh
dGlvbiA9IHRydWU7CisJCQkJCQlicmVhazsKKwkJCQkJY2FzZSBUZXJtaW5hbFRva2Vucy5Ub2tl
bk5hbWVJZGVudGlmaWVyOgorCQkJCQkJaWYgKCFpc0Fubm90YXRpb24pIHsKKwkJCQkJCQlyZXR1
cm4gZGltZW5zaW9uczsKKwkJCQkJCX0KKwkJCQkJCWlzQW5ub3RhdGlvbiA9IGZhbHNlOwogCQkJ
CQkJYnJlYWs7CiAJCQkJCWNhc2UgVGVybWluYWxUb2tlbnMuVG9rZW5OYW1lUkJSQUNLRVQ6Ly8x
NjYKKwkJCQkJCWlzQW5ub3RhdGlvbiA9IGZhbHNlOwogCQkJCQkJZGltZW5zaW9ucysrOwogCQkJ
CQkJYnJlYWs7CiAJCQkJCWRlZmF1bHQ6CkBAIC00MzY0LDYgKzQ0MzIsMzEgQEAKIAkJcmV0dXJu
IGRpbWVuc2lvbnM7CiAJfQogCisJcHJvdGVjdGVkIHZvaWQgcmV0cmlldmVEaW1lbnNpb25BbmRT
ZXRQb3NpdGlvbnMoaW50IHN0YXJ0LCBpbnQgZW5kLCBEaW1lbnNpb25JbmZvIGRpbSkgeworCQl0
aGlzLnNjYW5uZXIucmVzZXRUbyhzdGFydCwgZW5kKTsKKwkJaW50IHRva2VuOworCQlib29sZWFu
IHN0YXJ0U2V0ID0gZmFsc2U7CisJCXRyeSB7CisJCQl3aGlsZSgodG9rZW4gPSB0aGlzLnNjYW5u
ZXIuZ2V0TmV4dFRva2VuKCkpICE9IFRlcm1pbmFsVG9rZW5zLlRva2VuTmFtZUVPRikgIHsKKwkJ
CQlzd2l0Y2godG9rZW4pIHsKKwkJCQkJY2FzZSBUZXJtaW5hbFRva2Vucy5Ub2tlbk5hbWVXSElU
RVNQQUNFOgorCQkJCQkJYnJlYWs7CisJCQkJCWNhc2UgVGVybWluYWxUb2tlbnMuVG9rZW5OYW1l
UkJSQUNLRVQ6CisJCQkJCQlpbnQgZW5kRGltID0gdGhpcy5zY2FubmVyLmN1cnJlbnRQb3NpdGlv
biAtIDE7CisJCQkJCQlkaW0uc2V0U291cmNlUmFuZ2Uoc3RhcnQsIGVuZERpbSAtIHN0YXJ0ICsg
MSk7CisJCQkJCQlyZXR1cm47CisJCQkJCWRlZmF1bHQ6CisJCQkJCQlpZiAoIXN0YXJ0U2V0KSB7
CisJCQkJCQkJc3RhcnQgPSB0aGlzLnNjYW5uZXIuc3RhcnRQb3NpdGlvbjsKKwkJCQkJCQlzdGFy
dFNldCA9IHRydWU7CisJCQkJCQl9CisJCQkJCQlicmVhazsKKwkJCQl9CisJCQl9CisJCX0gY2F0
Y2goSW52YWxpZElucHV0RXhjZXB0aW9uIGUpIHsKKwkJCS8vIGlnbm9yZQorCQl9CisJfQogCXBy
b3RlY3RlZCB2b2lkIHJldHJpZXZlSWRlbnRpZmllckFuZFNldFBvc2l0aW9ucyhpbnQgc3RhcnQs
IGludCBlbmQsIE5hbWUgbmFtZSkgewogCQl0aGlzLnNjYW5uZXIucmVzZXRUbyhzdGFydCwgZW5k
KTsKIAkJaW50IHRva2VuOwpAQCAtNTI3Nyw3ICs1MzcwLDcgQEAKIAkJCQkJCQlicmVhazsKIAkJ
CQkJCWRlZmF1bHQgOgogCQkJCQkJCW1ldGhvZERlY2xhcmF0aW9uLnNldFJldHVyblR5cGUyKHN1
YmFycmF5VHlwZSk7Ci0JCQkJCQlicmVhazsKKwkJCQkJCQlicmVhazsKIAkJCQkJfQogCQkJCQl0
aGlzLmFzdC5nZXRCaW5kaW5nUmVzb2x2ZXIoKS51cGRhdGVLZXkodHlwZSwgc3ViYXJyYXlUeXBl
KTsKIAkJCQl9CmRpZmYgLS1naXQgYS9vcmcuZWNsaXBzZS5qZHQuY29yZS9kb20vb3JnL2VjbGlw
c2UvamR0L2NvcmUvZG9tL0FTVE1hdGNoZXIuamF2YSBiL29yZy5lY2xpcHNlLmpkdC5jb3JlL2Rv
bS9vcmcvZWNsaXBzZS9qZHQvY29yZS9kb20vQVNUTWF0Y2hlci5qYXZhCmluZGV4IDk1YzJlNDcu
LjI0ZGUyNWEgMTAwNjQ0Ci0tLSBhL29yZy5lY2xpcHNlLmpkdC5jb3JlL2RvbS9vcmcvZWNsaXBz
ZS9qZHQvY29yZS9kb20vQVNUTWF0Y2hlci5qYXZhCisrKyBiL29yZy5lY2xpcHNlLmpkdC5jb3Jl
L2RvbS9vcmcvZWNsaXBzZS9qZHQvY29yZS9kb20vQVNUTWF0Y2hlci5qYXZhCkBAIC0zNTQsNiAr
MzU0LDI5IEBACiAJICogQHJldHVybiA8Y29kZT50cnVlPC9jb2RlPiBpZiB0aGUgc3VidHJlZSBt
YXRjaGVzLCBvcgogCSAqICAgPGNvZGU+ZmFsc2U8L2NvZGU+IGlmIHRoZXkgZG8gbm90IG1hdGNo
IG9yIHRoZSBvdGhlciBvYmplY3QgaGFzIGEKIAkgKiAgIGRpZmZlcmVudCBub2RlIHR5cGUgb3Ig
aXMgPGNvZGU+bnVsbDwvY29kZT4KKwkgKiBAc2luY2UgMy45CisJICovCisJcHVibGljIGJvb2xl
YW4gbWF0Y2goRGltZW5zaW9uSW5mbyBub2RlLCBPYmplY3Qgb3RoZXIpIHsKKwkJaWYgKCEob3Ro
ZXIgaW5zdGFuY2VvZiBEaW1lbnNpb25JbmZvKSkKKwkJCXJldHVybiBmYWxzZTsKKwkJRGltZW5z
aW9uSW5mbyBvID0gKERpbWVuc2lvbkluZm8pIG90aGVyOworCQlyZXR1cm4gc2FmZVN1YnRyZWVM
aXN0TWF0Y2gobm9kZS5hbm5vdGF0aW9ucygpLCBvLmFubm90YXRpb25zKCkpCisJCQkJJiYgc2Fm
ZVN1YnRyZWVNYXRjaChub2RlLmV4cHJlc3Npb24oKSwgby5leHByZXNzaW9uKCkpOworCX0KKwor
CS8qKgorCSAqIFJldHVybnMgd2hldGhlciB0aGUgZ2l2ZW4gbm9kZSBhbmQgdGhlIG90aGVyIG9i
amVjdCBtYXRjaC4KKwkgKiA8cD4KKwkgKiBUaGUgZGVmYXVsdCBpbXBsZW1lbnRhdGlvbiBwcm92
aWRlZCBieSB0aGlzIGNsYXNzIHRlc3RzIHdoZXRoZXIgdGhlCisJICogb3RoZXIgb2JqZWN0IGlz
IGEgbm9kZSBvZiB0aGUgc2FtZSB0eXBlIHdpdGggc3RydWN0dXJhbGx5IGlzb21vcnBoaWMKKwkg
KiBjaGlsZCBzdWJ0cmVlcy4gU3ViY2xhc3NlcyBtYXkgb3ZlcnJpZGUgdGhpcyBtZXRob2QgYXMg
bmVlZGVkLgorCSAqIDwvcD4KKwkgKgorCSAqIEBwYXJhbSBub2RlIHRoZSBub2RlCisJICogQHBh
cmFtIG90aGVyIHRoZSBvdGhlciBvYmplY3QsIG9yIDxjb2RlPm51bGw8L2NvZGU+CisJICogQHJl
dHVybiA8Y29kZT50cnVlPC9jb2RlPiBpZiB0aGUgc3VidHJlZSBtYXRjaGVzLCBvcgorCSAqICAg
PGNvZGU+ZmFsc2U8L2NvZGU+IGlmIHRoZXkgZG8gbm90IG1hdGNoIG9yIHRoZSBvdGhlciBvYmpl
Y3QgaGFzIGEKKwkgKiAgIGRpZmZlcmVudCBub2RlIHR5cGUgb3IgaXMgPGNvZGU+bnVsbDwvY29k
ZT4KIAkgKi8KIAlwdWJsaWMgYm9vbGVhbiBtYXRjaChBc3NlcnRTdGF0ZW1lbnQgbm9kZSwgT2Jq
ZWN0IG90aGVyKSB7CiAJCWlmICghKG90aGVyIGluc3RhbmNlb2YgQXNzZXJ0U3RhdGVtZW50KSkg
ewpAQCAtMTM5OSwxMCArMTQyMiwxMSBAQAogCQkJCSYmIHNhZmVTdWJ0cmVlTWF0Y2gobm9kZS5n
ZXROYW1lKCksIG8uZ2V0TmFtZSgpKQogCQkJCS8vIG4uYi4gY29tcGFyZSByZXR1cm4gdHlwZSBl
dmVuIGZvciBjb25zdHJ1Y3RvcnMKIAkJCQkmJiBzYWZlU3VidHJlZUxpc3RNYXRjaChub2RlLnBh
cmFtZXRlcnMoKSwgby5wYXJhbWV0ZXJzKCkpCi0JIAkJCSYmIG5vZGUuZ2V0RXh0cmFEaW1lbnNp
b25zKCkgPT0gby5nZXRFeHRyYURpbWVuc2lvbnMoKQotCQkJCSYmIChub2RlLmdldEFTVCgpLmFw
aUxldmVsKCkgPCBBU1QuSkxTOCA/IAotCQkJCQkJc2FmZVN1YnRyZWVMaXN0TWF0Y2gobm9kZS50
aHJvd25FeGNlcHRpb25zKCksIG8udGhyb3duRXhjZXB0aW9ucygpKSA6Ci0JCQkJCQlzYWZlU3Vi
dHJlZUxpc3RNYXRjaChub2RlLnRocm93bkV4Y2VwdGlvblR5cGVzKCksIG8udGhyb3duRXhjZXB0
aW9uVHlwZXMoKSkpCisJCQkJJiYgKChub2RlLmdldEFTVCgpLmFwaUxldmVsIDwgQVNULkpMUzgp
ID8KKwkJCQkJCQkobm9kZS5nZXRFeHRyYURpbWVuc2lvbnMoKSA9PSBvLmdldEV4dHJhRGltZW5z
aW9ucygpCisJCQkJCQkJCSYmIHNhZmVTdWJ0cmVlTGlzdE1hdGNoKG5vZGUudGhyb3duRXhjZXB0
aW9ucygpLCBvLnRocm93bkV4Y2VwdGlvbnMoKSkpIDoKKwkJCQkJCQkoc2FmZVN1YnRyZWVMaXN0
TWF0Y2gobm9kZS5nZXRFeHRyYURpbWVuc2lvbkluZm9zKCksIG8uZ2V0RXh0cmFEaW1lbnNpb25J
bmZvcygpKQorCQkJCQkJCQkmJiBzYWZlU3VidHJlZUxpc3RNYXRjaChub2RlLnRocm93bkV4Y2Vw
dGlvblR5cGVzKCksIG8udGhyb3duRXhjZXB0aW9uVHlwZXMoKSkpKQogCQkJCSYmIHNhZmVTdWJ0
cmVlTWF0Y2gobm9kZS5nZXRCb2R5KCksIG8uZ2V0Qm9keSgpKSk7CiAJfQogCkBAIC0xODc4LDcg
KzE5MDIsOSBAQAogCQlyZXR1cm4KIAkJICAgIHNhZmVTdWJ0cmVlTWF0Y2gobm9kZS5nZXRUeXBl
KCksIG8uZ2V0VHlwZSgpKQogCQkJCSYmIHNhZmVTdWJ0cmVlTWF0Y2gobm9kZS5nZXROYW1lKCks
IG8uZ2V0TmFtZSgpKQotCSAJCQkmJiBub2RlLmdldEV4dHJhRGltZW5zaW9ucygpID09IG8uZ2V0
RXh0cmFEaW1lbnNpb25zKCkKKwkgCQkJJiYgKChub2RlLmdldEFTVCgpLmFwaUxldmVsIDwgQVNU
LkpMUzgpID8KKwkgCQkJCQlub2RlLmdldEV4dHJhRGltZW5zaW9ucygpID09IG8uZ2V0RXh0cmFE
aW1lbnNpb25zKCkgOgorCSAJCQkJCQlzYWZlU3VidHJlZUxpc3RNYXRjaChub2RlLmdldEV4dHJh
RGltZW5zaW9uSW5mb3MoKSwgby5nZXRFeHRyYURpbWVuc2lvbkluZm9zKCkpKQogCQkJCSYmIHNh
ZmVTdWJ0cmVlTWF0Y2gobm9kZS5nZXRJbml0aWFsaXplcigpLCBvLmdldEluaXRpYWxpemVyKCkp
CiAJCQkJJiYgKGxldmVsID49IEFTVC5KTFM4ICYmIG5vZGUuaXNWYXJhcmdzKCkpID8gc2FmZVN1
YnRyZWVMaXN0TWF0Y2gobm9kZS52YXJhcmdzQW5ub3RhdGlvbnMoKSwgby52YXJhcmdzQW5ub3Rh
dGlvbnMoKSkgOiB0cnVlOwkJCiAJfQpAQCAtMjM3MSw3ICsyMzk3LDkgQEAKIAkJfQogCQlWYXJp
YWJsZURlY2xhcmF0aW9uRnJhZ21lbnQgbyA9IChWYXJpYWJsZURlY2xhcmF0aW9uRnJhZ21lbnQp
IG90aGVyOwogCQlyZXR1cm4gc2FmZVN1YnRyZWVNYXRjaChub2RlLmdldE5hbWUoKSwgby5nZXRO
YW1lKCkpCi0JCQkmJiBub2RlLmdldEV4dHJhRGltZW5zaW9ucygpID09IG8uZ2V0RXh0cmFEaW1l
bnNpb25zKCkKKwkJCSYmICgobm9kZS5nZXRBU1QoKS5hcGlMZXZlbCA8IEFTVC5KTFM4KSA/CisJ
CQkJCW5vZGUuZ2V0RXh0cmFEaW1lbnNpb25zKCkgPT0gby5nZXRFeHRyYURpbWVuc2lvbnMoKSA6
CisJCQkJCQlzYWZlU3VidHJlZUxpc3RNYXRjaChub2RlLmdldEV4dHJhRGltZW5zaW9uSW5mb3Mo
KSwgby5nZXRFeHRyYURpbWVuc2lvbkluZm9zKCkpKQogCQkJJiYgc2FmZVN1YnRyZWVNYXRjaChu
b2RlLmdldEluaXRpYWxpemVyKCksIG8uZ2V0SW5pdGlhbGl6ZXIoKSk7CiAJfQogCmRpZmYgLS1n
aXQgYS9vcmcuZWNsaXBzZS5qZHQuY29yZS9kb20vb3JnL2VjbGlwc2UvamR0L2NvcmUvZG9tL0FT
VE5vZGUuamF2YSBiL29yZy5lY2xpcHNlLmpkdC5jb3JlL2RvbS9vcmcvZWNsaXBzZS9qZHQvY29y
ZS9kb20vQVNUTm9kZS5qYXZhCmluZGV4IDZlYTQzYmEuLjcxM2QxYTAgMTAwNjQ0Ci0tLSBhL29y
Zy5lY2xpcHNlLmpkdC5jb3JlL2RvbS9vcmcvZWNsaXBzZS9qZHQvY29yZS9kb20vQVNUTm9kZS5q
YXZhCisrKyBiL29yZy5lY2xpcHNlLmpkdC5jb3JlL2RvbS9vcmcvZWNsaXBzZS9qZHQvY29yZS9k
b20vQVNUTm9kZS5qYXZhCkBAIC0xLDUgKzEsNSBAQAogLyoqKioqKioqKioqKioqKioqKioqKioq
KioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioK
LSAqIENvcHlyaWdodCAoYykgMjAwMCwgMjAxMiBJQk0gQ29ycG9yYXRpb24gYW5kIG90aGVycy4K
KyAqIENvcHlyaWdodCAoYykgMjAwMCwgMjAxMyBJQk0gQ29ycG9yYXRpb24gYW5kIG90aGVycy4K
ICAqIEFsbCByaWdodHMgcmVzZXJ2ZWQuIFRoaXMgcHJvZ3JhbSBhbmQgdGhlIGFjY29tcGFueWlu
ZyBtYXRlcmlhbHMKICAqIGFyZSBtYWRlIGF2YWlsYWJsZSB1bmRlciB0aGUgdGVybXMgb2YgdGhl
IEVjbGlwc2UgUHVibGljIExpY2Vuc2UgdjEuMAogICogd2hpY2ggYWNjb21wYW5pZXMgdGhpcyBk
aXN0cmlidXRpb24sIGFuZCBpcyBhdmFpbGFibGUgYXQKQEAgLTc3Myw2ICs3NzMsMTUgQEAKIAlw
dWJsaWMgc3RhdGljIGZpbmFsIGludCBVTklPTl9UWVBFID0gODQ7CiAKIAkvKioKKwkgKiBOb2Rl
IHR5cGUgY29uc3RhbnQgaW5kaWNhdGluZyBhIG5vZGUgb2YgdHlwZQorCSAqIDxjb2RlPkRpbWVu
c2lvbkluZm88L2NvZGU+LgorCSAqCisJICogQHNlZSBEaW1lbnNpb25JbmZvCisJICogQHNpbmNl
IDMuOQorCSAqLworCXB1YmxpYyBzdGF0aWMgZmluYWwgaW50IERJTUVOU0lPTl9JTkZPID0gODU7
CisKKwkvKioKIAkgKiBSZXR1cm5zIHRoZSBub2RlIGNsYXNzIGZvciB0aGUgY29ycmVzcG9uZGlu
ZyBub2RlIHR5cGUuCiAJICoKIAkgKiBAcGFyYW0gbm9kZVR5cGUgQVNUIG5vZGUgdHlwZQpAQCAt
OTUyLDYgKzk2MSw4IEBACiAJCQkJcmV0dXJuIFdoaWxlU3RhdGVtZW50LmNsYXNzOwogCQkJY2Fz
ZSBXSUxEQ0FSRF9UWVBFIDoKIAkJCQlyZXR1cm4gV2lsZGNhcmRUeXBlLmNsYXNzOworCQkJY2Fz
ZSBESU1FTlNJT05fSU5GTzoKKwkJCQlyZXR1cm4gRGltZW5zaW9uSW5mby5jbGFzczsKIAkJfQog
CQl0aHJvdyBuZXcgSWxsZWdhbEFyZ3VtZW50RXhjZXB0aW9uKCk7CiAJfQpkaWZmIC0tZ2l0IGEv
b3JnLmVjbGlwc2UuamR0LmNvcmUvZG9tL29yZy9lY2xpcHNlL2pkdC9jb3JlL2RvbS9BU1RWaXNp
dG9yLmphdmEgYi9vcmcuZWNsaXBzZS5qZHQuY29yZS9kb20vb3JnL2VjbGlwc2UvamR0L2NvcmUv
ZG9tL0FTVFZpc2l0b3IuamF2YQppbmRleCBiMjkzMDUzLi5iMDFmYWQ3IDEwMDY0NAotLS0gYS9v
cmcuZWNsaXBzZS5qZHQuY29yZS9kb20vb3JnL2VjbGlwc2UvamR0L2NvcmUvZG9tL0FTVFZpc2l0
b3IuamF2YQorKysgYi9vcmcuZWNsaXBzZS5qZHQuY29yZS9kb20vb3JnL2VjbGlwc2UvamR0L2Nv
cmUvZG9tL0FTVFZpc2l0b3IuamF2YQpAQCAtMSw5ICsxLDEzIEBACiAvKioqKioqKioqKioqKioq
KioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioq
KioqKioqKgotICogQ29weXJpZ2h0IChjKSAyMDAwLCAyMDExIElCTSBDb3Jwb3JhdGlvbiBhbmQg
b3RoZXJzLgorICogQ29weXJpZ2h0IChjKSAyMDAwLCAyMDEzIElCTSBDb3Jwb3JhdGlvbiBhbmQg
b3RoZXJzLgogICogQWxsIHJpZ2h0cyByZXNlcnZlZC4gVGhpcyBwcm9ncmFtIGFuZCB0aGUgYWNj
b21wYW55aW5nIG1hdGVyaWFscwogICogYXJlIG1hZGUgYXZhaWxhYmxlIHVuZGVyIHRoZSB0ZXJt
cyBvZiB0aGUgRWNsaXBzZSBQdWJsaWMgTGljZW5zZSB2MS4wCiAgKiB3aGljaCBhY2NvbXBhbmll
cyB0aGlzIGRpc3RyaWJ1dGlvbiwgYW5kIGlzIGF2YWlsYWJsZSBhdAogICogaHR0cDovL3d3dy5l
Y2xpcHNlLm9yZy9sZWdhbC9lcGwtdjEwLmh0bWwKKyAqCisgKiBUaGlzIGlzIGFuIGltcGxlbWVu
dGF0aW9uIG9mIGFuIGVhcmx5LWRyYWZ0IHNwZWNpZmljYXRpb24gZGV2ZWxvcGVkIHVuZGVyIHRo
ZSBKYXZhCisgKiBDb21tdW5pdHkgUHJvY2VzcyAoSkNQKSBhbmQgaXMgbWFkZSBhdmFpbGFibGUg
Zm9yIHRlc3RpbmcgYW5kIGV2YWx1YXRpb24gcHVycG9zZXMKKyAqIG9ubHkuIFRoZSBjb2RlIGlz
IG5vdCBjb21wYXRpYmxlIHdpdGggYW55IHNwZWNpZmljYXRpb24gb2YgdGhlIEpDUC4KICAqCiAg
KiBDb250cmlidXRvcnM6CiAgKiAgICAgSUJNIENvcnBvcmF0aW9uIC0gaW5pdGlhbCBBUEkgYW5k
IGltcGxlbWVudGF0aW9uCkBAIC0xOTksNiArMjAzLDIyIEBACiAJCXJldHVybiB0cnVlOwogCX0K
IAorCS8qKgorCSAqIFZpc2l0cyB0aGUgZ2l2ZW4gdHlwZS1zcGVjaWZpYyBBU1Qgbm9kZS4KKwkg
KiA8cD4KKwkgKiBUaGUgZGVmYXVsdCBpbXBsZW1lbnRhdGlvbiBkb2VzIG5vdGhpbmcgYW5kIHJl
dHVybiB0cnVlLgorCSAqIFN1YmNsYXNzZXMgbWF5IHJlaW1wbGVtZW50LgorCSAqIDwvcD4KKwkg
KgorCSAqIEBwYXJhbSBub2RlIHRoZSBub2RlIHRvIHZpc2l0CisJICogQHJldHVybiA8Y29kZT50
cnVlPC9jb2RlPiBpZiB0aGUgY2hpbGRyZW4gb2YgdGhpcyBub2RlIHNob3VsZCBiZQorCSAqIHZp
c2l0ZWQsIGFuZCA8Y29kZT5mYWxzZTwvY29kZT4gaWYgdGhlIGNoaWxkcmVuIG9mIHRoaXMgbm9k
ZSBzaG91bGQKKwkgKiBiZSBza2lwcGVkCisJICogQHNpbmNlIDMuOQorCSAqLworCXB1YmxpYyBi
b29sZWFuIHZpc2l0KERpbWVuc2lvbkluZm8gbm9kZSkgeworCQlyZXR1cm4gdHJ1ZTsKKwl9CiAK
IAkvKioKIAkgKiBWaXNpdHMgdGhlIGdpdmVuIHR5cGUtc3BlY2lmaWMgQVNUIG5vZGUuCkBAIC0x
NjAwLDYgKzE2MjAsMTkgQEAKIAkgKiA8L3A+CiAJICoKIAkgKiBAcGFyYW0gbm9kZSB0aGUgbm9k
ZSB0byB2aXNpdAorCSAqIEBzaW5jZSAzLjkKKwkgKi8KKwlwdWJsaWMgdm9pZCBlbmRWaXNpdChE
aW1lbnNpb25JbmZvIG5vZGUpIHsKKwkJLy8gZG8gbm90aGluZyBieSBkZWZhdWx0CisJfQorCisJ
LyoqCisJICogRW5kIG9mIHZpc2l0IHRoZSBnaXZlbiB0eXBlLXNwZWNpZmljIEFTVCBub2RlLgor
CSAqIDxwPgorCSAqIFRoZSBkZWZhdWx0IGltcGxlbWVudGF0aW9uIGRvZXMgbm90aGluZy4gU3Vi
Y2xhc3NlcyBtYXkgcmVpbXBsZW1lbnQuCisJICogPC9wPgorCSAqCisJICogQHBhcmFtIG5vZGUg
dGhlIG5vZGUgdG8gdmlzaXQKIAkgKiBAc2luY2UgMy4xCiAJICovCiAJcHVibGljIHZvaWQgZW5k
VmlzaXQoQW5ub3RhdGlvblR5cGVNZW1iZXJEZWNsYXJhdGlvbiBub2RlKSB7CmRpZmYgLS1naXQg
YS9vcmcuZWNsaXBzZS5qZHQuY29yZS9kb20vb3JnL2VjbGlwc2UvamR0L2NvcmUvZG9tL0RpbWVu
c2lvbkluZm8uamF2YSBiL29yZy5lY2xpcHNlLmpkdC5jb3JlL2RvbS9vcmcvZWNsaXBzZS9qZHQv
Y29yZS9kb20vRGltZW5zaW9uSW5mby5qYXZhCm5ldyBmaWxlIG1vZGUgMTAwNjQ0CmluZGV4IDAw
MDAwMDAuLmI3YzVhZDIKLS0tIC9kZXYvbnVsbAorKysgYi9vcmcuZWNsaXBzZS5qZHQuY29yZS9k
b20vb3JnL2VjbGlwc2UvamR0L2NvcmUvZG9tL0RpbWVuc2lvbkluZm8uamF2YQpAQCAtMCwwICsx
LDIyNSBAQAorLyoqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioq
KioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioKKyAqIENvcHlyaWdodCAoYykgMjAxMyBJ
Qk0gQ29ycG9yYXRpb24gYW5kIG90aGVycy4KKyAqIEFsbCByaWdodHMgcmVzZXJ2ZWQuIFRoaXMg
cHJvZ3JhbSBhbmQgdGhlIGFjY29tcGFueWluZyBtYXRlcmlhbHMKKyAqIGFyZSBtYWRlIGF2YWls
YWJsZSB1bmRlciB0aGUgdGVybXMgb2YgdGhlIEVjbGlwc2UgUHVibGljIExpY2Vuc2UgdjEuMAor
ICogd2hpY2ggYWNjb21wYW5pZXMgdGhpcyBkaXN0cmlidXRpb24sIGFuZCBpcyBhdmFpbGFibGUg
YXQKKyAqIGh0dHA6Ly93d3cuZWNsaXBzZS5vcmcvbGVnYWwvZXBsLXYxMC5odG1sCisgKgorICog
VGhpcyBpcyBhbiBpbXBsZW1lbnRhdGlvbiBvZiBhbiBlYXJseS1kcmFmdCBzcGVjaWZpY2F0aW9u
IGRldmVsb3BlZCB1bmRlciB0aGUgSmF2YQorICogQ29tbXVuaXR5IFByb2Nlc3MgKEpDUCkgYW5k
IGlzIG1hZGUgYXZhaWxhYmxlIGZvciB0ZXN0aW5nIGFuZCBldmFsdWF0aW9uIHB1cnBvc2VzCisg
KiBvbmx5LiBUaGUgY29kZSBpcyBub3QgY29tcGF0aWJsZSB3aXRoIGFueSBzcGVjaWZpY2F0aW9u
IG9mIHRoZSBKQ1AuCisgKgorICogQ29udHJpYnV0b3JzOgorICogICAgIElCTSBDb3Jwb3JhdGlv
biAtIGluaXRpYWwgQVBJIGFuZCBpbXBsZW1lbnRhdGlvbgorICoqKioqKioqKioqKioqKioqKioq
KioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioq
KiovCitwYWNrYWdlIG9yZy5lY2xpcHNlLmpkdC5jb3JlLmRvbTsKKworaW1wb3J0IGphdmEudXRp
bC5BcnJheUxpc3Q7CitpbXBvcnQgamF2YS51dGlsLkxpc3Q7CisKKy8qKgorICogVGhlIGFycmF5
IGRpbWVuc2lvbiBpbmZvIG5vZGUuIFRoZSBhcnJheSBkaW1lbnNpb24sIHJlcHJlc2VudGVkIGFz
IDxiPltdPC9iPiwgY2FuIGhhdmUKKyAqIHR5cGUgYW5ub3RhdGlvbnMuIEl0IG1heSBhbHNvIGlu
Y2x1ZGUgYW4gPGNvZGU+RXhwcmVzc2lvbjwvY29kZT4gZGVwZW5kaW5nIG9uIHdoZXJlIGl0IGFw
cGVhcnMuCisgKiBUaGUgb25seSBub2RlIHRoYXQgc3VwcG9ydHMgYSBkaW1lbnNpb24gdHlwZSB3
aXRoIGFuIGV4cHJlc3Npb24gaXMgPGNvZGU+QXJyYXlDcmVhdGlvbjwvY29kZT4uCisgKiBUaGlz
IG5vZGUgdHlwZSBpcyBzdXBwb3J0ZWQgb25seSBpbiBKTFM4IG9yIGxhdGVyLgorICogCisgKiBU
aGUgZGltZW5zaW9uIGluZm8gbm9kZSBpcyB1c2VkIHRvIHJlcHJlc2VudCBleHRyYSBkaW1lbnNp
b25zIGluIHRoZSBmb2xsb3dpbmcgbm9kZXM6CisgKiA8cHJlPgorICogCVNpbmdsZVZhcmlhYmxl
RGVjbGFyYXRpb24KKyAqIAlWYXJpYWJsZURlY2xhcmF0aW9uRnJhZ21lbnQKKyAqIAlNZXRob2RE
ZWNsYXJhdGlvbgorICogPC9wcmU+CisgKiBGb3IgSkxTODoKKyAqIDxwcmU+CisgKiBEaW1lbnNp
b25JbmZvOgorICogCXsgQW5ub3RhdGlvbnMgfSA8Yj5bPC9iPiBbIEV4cHJlc3Npb24gXSA8Yj5d
PC9iPgorICogPC9wcmU+CisgKgorICogQHNlZSBBU1QjbmV3RGltZW5zaW9uSW5mbygpCisgKiBA
c2luY2UgMy45CisgKi8KK3B1YmxpYyBjbGFzcyBEaW1lbnNpb25JbmZvIGV4dGVuZHMgQVNUTm9k
ZSB7CisKKworCS8qKgorCSAqIFRoZSAiYW5ub3RhdGlvbnMiIHN0cnVjdHVyYWwgcHJvcGVydHkg
b2YgdGhpcyBub2RlIHR5cGUgKGNoaWxkIHR5cGU6IHtAbGluayBBbm5vdGF0aW9ufSkuCisJICog
QHNpbmNlIDMuOQorCSAqLworCXB1YmxpYyBzdGF0aWMgZmluYWwgQ2hpbGRMaXN0UHJvcGVydHlE
ZXNjcmlwdG9yIEFOTk9UQVRJT05TX1BST1BFUlRZID0KKwkJbmV3IENoaWxkTGlzdFByb3BlcnR5
RGVzY3JpcHRvcihEaW1lbnNpb25JbmZvLmNsYXNzLCAiYW5ub3RhdGlvbnMiLCBBbm5vdGF0aW9u
LmNsYXNzLCBOT19DWUNMRV9SSVNLKTsgLy8kTk9OLU5MUy0xJAorCisKKwkvKioKKwkgKiBUaGUg
ImV4cHJlc3Npb24iIHN0cnVjdHVyYWwgcHJvcGVydHkgb2YgdGhpcyBub2RlIHR5cGUgKGVsZW1l
bnQgdHlwZToge0BsaW5rIEV4cHJlc3Npb259KS4KKwkgKiBAc2luY2UgMy45CisJICovCisJcHVi
bGljIHN0YXRpYyBmaW5hbCBDaGlsZFByb3BlcnR5RGVzY3JpcHRvciBFWFBSRVNTSU9OX1BST1BF
UlRZID0KKwkJCW5ldyBDaGlsZFByb3BlcnR5RGVzY3JpcHRvcihEaW1lbnNpb25JbmZvLmNsYXNz
LCAiZXhwcmVzc2lvbiIsIEV4cHJlc3Npb24uY2xhc3MsIE1BTkRBVE9SWSwgTk9fQ1lDTEVfUklT
Syk7IC8vJE5PTi1OTFMtMSQKKworCisJLyoqCisJICogQSBsaXN0IG9mIHByb3BlcnR5IGRlc2Ny
aXB0b3JzIChlbGVtZW50IHR5cGU6CisJICoge0BsaW5rIFN0cnVjdHVyYWxQcm9wZXJ0eURlc2Ny
aXB0b3J9KSwKKwkgKiBvciBudWxsIGlmIHVuaW5pdGlhbGl6ZWQuCisJICogQHNpbmNlIDMuOQor
CSAqLworCXByaXZhdGUgc3RhdGljIGZpbmFsIExpc3QgUFJPUEVSVFlfREVTQ1JJUFRPUlNfOF8w
OworCisJc3RhdGljIHsKKwkJTGlzdCBwcm9wZXJ0eUxpc3QgPSBuZXcgQXJyYXlMaXN0KDMpOwor
CQljcmVhdGVQcm9wZXJ0eUxpc3QoRGltZW5zaW9uSW5mby5jbGFzcywgcHJvcGVydHlMaXN0KTsK
KwkJYWRkUHJvcGVydHkoQU5OT1RBVElPTlNfUFJPUEVSVFksIHByb3BlcnR5TGlzdCk7CisJCWFk
ZFByb3BlcnR5KEVYUFJFU1NJT05fUFJPUEVSVFksIHByb3BlcnR5TGlzdCk7CisJCVBST1BFUlRZ
X0RFU0NSSVBUT1JTXzhfMCA9IHJlYXBQcm9wZXJ0eUxpc3QocHJvcGVydHlMaXN0KTsKKwl9CisK
KwkvKioKKwkgKiBSZXR1cm5zIGEgbGlzdCBvZiBzdHJ1Y3R1cmFsIHByb3BlcnR5IGRlc2NyaXB0
b3JzIGZvciB0aGlzIG5vZGUgdHlwZS4KKwkgKiBDbGllbnRzIG11c3Qgbm90IG1vZGlmeSB0aGUg
cmVzdWx0LgorCSAqCisJICogQHBhcmFtIGFwaUxldmVsIHRoZSBBUEkgbGV2ZWw7IG9uZSBvZiB0
aGUKKwkgKiA8Y29kZT5BU1QuSkxTKjwvY29kZT4gY29uc3RhbnRzCisJICogQHJldHVybiBhIGxp
c3Qgb2YgcHJvcGVydHkgZGVzY3JpcHRvcnMgKGVsZW1lbnQgdHlwZToKKwkgKiB7QGxpbmsgU3Ry
dWN0dXJhbFByb3BlcnR5RGVzY3JpcHRvcn0pCisJICogQHNpbmNlIDMuOQorCSAqLworCXB1Ymxp
YyBzdGF0aWMgTGlzdCBwcm9wZXJ0eURlc2NyaXB0b3JzKGludCBhcGlMZXZlbCkgeworCQlyZXR1
cm4gUFJPUEVSVFlfREVTQ1JJUFRPUlNfOF8wOworCX0KKworCS8qKgorCSAqIENyZWF0ZSBhIG5l
dyBpbnN0YW5jZSBvZiBEaW1lbnNpb25JbmZvIG5vZGUgKFN1cHBvcnRlZCBvbmx5IGluIGxldmVs
CisJICogSkxTOCBvciBhYm92ZSkuICAKKwkgKgorCSAqIEBwYXJhbSBhc3QKKwkgKiBAZXhjZXB0
aW9uIFVuc3VwcG9ydGVkT3BlcmF0aW9uRXhjZXB0aW9uIGlmIHRoaXMgb3BlcmF0aW9uIGlzIHVz
ZWQKKwkgKiAgICAgICAgICAgIGluIGEgSkxTMiwgSkxTMyBvciBKTFM0IEFTVAorCSAqIEBzaW5j
ZSAzLjkKKwkgKi8KKwlEaW1lbnNpb25JbmZvKEFTVCBhc3QpIHsKKwkJc3VwZXIoYXN0KTsKKwkJ
dW5zdXBwb3J0ZWRJbjJfM180KCk7CisJCXRoaXMuYW5ub3RhdGlvbnMgPSBuZXcgQVNUTm9kZS5O
b2RlTGlzdChBTk5PVEFUSU9OU19QUk9QRVJUWSk7CisJfQorCisJLyoqCisJICogVGhlIGxpc3Qg
b2YgYW5ub3RhdGlvbnMgZm9yIHRoaXMgZGltZW5zaW9uIChlbGVtZW50IHR5cGU6CisJICoge0Bs
aW5rIEFubm90YXRpb259KS4KKwkgKi8KKwlBU1ROb2RlLk5vZGVMaXN0IGFubm90YXRpb25zID0g
bnVsbDsKKwkKKwkvKioKKwkgKiBSZXR1cm5zIHRoZSBsaXZlIG9yZGVyZWQgbGlzdCBvZiBhbm5v
dGF0aW9ucyBmb3IgdGhpcyBkaW1lbnNpb24uCisJICoKKwkgKiBAcmV0dXJuIHRoZSBsaXZlIGxp
c3Qgb2YgYW5ub3RhdGlvbnMgKGVsZW1lbnQgdHlwZToge0BsaW5rIEFubm90YXRpb259KQorCSAq
IEBzaW5jZSAzLjkKKwkgKi8KKwlwdWJsaWMgTGlzdCBhbm5vdGF0aW9ucygpIHsKKwkJcmV0dXJu
IHRoaXMuYW5ub3RhdGlvbnM7CisJfQorCisJcHJpdmF0ZSBFeHByZXNzaW9uIGV4cHJlc3Npb24g
PSBudWxsOworCisJLyoqCisJICogU2V0cyB0aGUgZXhwcmVzc2lvbiB0byB0aGlzIGRpbWVuc2lv
bi4gVGhpcyBvcGVyYXRpb24gd2lsbCBoYXZlCisJICogZWZmZWN0IG9ubHkgaWYgdGhpcyBkaW1l
bnNpb24gdHlwZSBub2RlIGlzIHBhcnQgb2YgYW4gYXJyYXkgY3JlYXRpb24KKwkgKiBub2RlLgor
CSAqCisJICogQHBhcmFtIGV4cHJlc3Npb24gdGhlIGV4cHJlc3Npb24gZm9yIHRoaXMgZGltZW5z
aW9uCisJICogQGV4Y2VwdGlvbiBJbGxlZ2FsQXJndW1lbnRFeGNlcHRpb24gaWY6CisJICogPHVs
PgorCSAqIDxsaT50aGUgbm9kZSBiZWxvbmdzIHRvIGEgZGlmZmVyZW50IEFTVDwvbGk+CisJICog
PGxpPnRoZSBub2RlIGFscmVhZHkgaGFzIGEgcGFyZW50PC9saT4KKwkgKiA8L3VsPgorCSAqCisJ
ICogQHNpbmNlIDMuOQorCSAqLworCXB1YmxpYyB2b2lkIHNldEV4cHJlc3Npb24oRXhwcmVzc2lv
biBleHByZXNzaW9uKSB7CisJCS8vIGFuIEFycmF5Q3JlYXRpb24gY2Fubm90IG9jY3VyIGluc2lk
ZSBhIEFycmF5VHlwZSAtIGN5Y2xlcyBub3QgcG9zc2libGUKKwkJQVNUTm9kZSBvbGRDaGlsZCA9
IHRoaXMuZXhwcmVzc2lvbjsKKwkJcHJlUmVwbGFjZUNoaWxkKG9sZENoaWxkLCBleHByZXNzaW9u
LCBFWFBSRVNTSU9OX1BST1BFUlRZKTsKKwkJdGhpcy5leHByZXNzaW9uID0gZXhwcmVzc2lvbjsK
KwkJcG9zdFJlcGxhY2VDaGlsZChvbGRDaGlsZCwgZXhwcmVzc2lvbiwgRVhQUkVTU0lPTl9QUk9Q
RVJUWSk7CisJfQorCisJLyoqCisJICogUmV0dXJucyB0aGUgZXhwcmVzc2lvbiBpbiB0aGUgZGlt
ZW5zaW9uIHR5cGUgb3IgbnVsbCBpZiBub3QgYXBwbGljYWJsZS4KKwkgKgorCSAqIEByZXR1cm4g
dGhlIGV4cHJlc3Npb24KKwkgKiBAc2luY2UgMy45CisJICovCisJcHVibGljIEV4cHJlc3Npb24g
ZXhwcmVzc2lvbigpIHsKKwkJcmV0dXJuIHRoaXMuZXhwcmVzc2lvbjsKKwl9CisKKwlMaXN0IGlu
dGVybmFsU3RydWN0dXJhbFByb3BlcnRpZXNGb3JUeXBlKGludCBhcGlMZXZlbCkgeworCQlyZXR1
cm4gcHJvcGVydHlEZXNjcmlwdG9ycyhhcGlMZXZlbCk7CisJfQorCisJLyogKG9taXQgamF2YWRv
YyBmb3IgdGhpcyBtZXRob2QpCisJICogTWV0aG9kIGRlY2xhcmVkIG9uIEFTVE5vZGUuCisJICov
CisJZmluYWwgQVNUTm9kZSBpbnRlcm5hbEdldFNldENoaWxkUHJvcGVydHkoQ2hpbGRQcm9wZXJ0
eURlc2NyaXB0b3IgcHJvcGVydHksIGJvb2xlYW4gZ2V0LCBBU1ROb2RlIGNoaWxkKSB7CisJCWlm
IChwcm9wZXJ0eSA9PSBFWFBSRVNTSU9OX1BST1BFUlRZKSB7CisJCQlpZiAoZ2V0KSB7CisJCQkJ
cmV0dXJuIGV4cHJlc3Npb24oKTsKKwkJCX0gZWxzZSB7CisJCQkJc2V0RXhwcmVzc2lvbigoRXhw
cmVzc2lvbikgY2hpbGQpOworCQkJCXJldHVybiBudWxsOworCQkJfQorCQl9CisJCS8vIGFsbG93
IGRlZmF1bHQgaW1wbGVtZW50YXRpb24gdG8gZmxhZyB0aGUgZXJyb3IKKwkJcmV0dXJuIHN1cGVy
LmludGVybmFsR2V0U2V0Q2hpbGRQcm9wZXJ0eShwcm9wZXJ0eSwgZ2V0LCBjaGlsZCk7CisJfQor
CisJLyogKG9taXQgamF2YWRvYyBmb3IgdGhpcyBtZXRob2QpCisJICogTWV0aG9kIGRlY2xhcmVk
IG9uIEFTVE5vZGUuCisJICovCisJZmluYWwgTGlzdCBpbnRlcm5hbEdldENoaWxkTGlzdFByb3Bl
cnR5KENoaWxkTGlzdFByb3BlcnR5RGVzY3JpcHRvciBwcm9wZXJ0eSkgeworCQlpZiAocHJvcGVy
dHkgPT0gQU5OT1RBVElPTlNfUFJPUEVSVFkpIHsKKwkJCXJldHVybiBhbm5vdGF0aW9ucygpOwor
CQl9CisJCS8vIGFsbG93IGRlZmF1bHQgaW1wbGVtZW50YXRpb24gdG8gZmxhZyB0aGUgZXJyb3IK
KwkJcmV0dXJuIHN1cGVyLmludGVybmFsR2V0Q2hpbGRMaXN0UHJvcGVydHkocHJvcGVydHkpOwor
CX0KKworCWludCBnZXROb2RlVHlwZTAoKSB7CisJCXJldHVybiBESU1FTlNJT05fSU5GTzsKKwl9
CisKKwlib29sZWFuIHN1YnRyZWVNYXRjaDAoQVNUTWF0Y2hlciBtYXRjaGVyLCBPYmplY3Qgb3Ro
ZXIpIHsKKwkJcmV0dXJuIG1hdGNoZXIubWF0Y2godGhpcywgb3RoZXIpOworCX0KKworCUFTVE5v
ZGUgY2xvbmUwKEFTVCB0YXJnZXQpIHsKKwkJRGltZW5zaW9uSW5mbyByZXN1bHQgPSBuZXcgRGlt
ZW5zaW9uSW5mbyh0YXJnZXQpOworCQlyZXN1bHQuYW5ub3RhdGlvbnMuYWRkQWxsKAorCQkJCUFT
VE5vZGUuY29weVN1YnRyZWVzKHRhcmdldCwgYW5ub3RhdGlvbnMoKSkpOworCQlpZiAodGhpcy5l
eHByZXNzaW9uICE9IG51bGwpIHsKKwkJCXJlc3VsdC5zZXRFeHByZXNzaW9uKChFeHByZXNzaW9u
KWV4cHJlc3Npb24oKS5jbG9uZSh0YXJnZXQpKTsKKwkJfQorCQlyZXR1cm4gcmVzdWx0OworCX0K
KworCXZvaWQgYWNjZXB0MChBU1RWaXNpdG9yIHZpc2l0b3IpIHsKKwkJYm9vbGVhbiB2aXNpdENo
aWxkcmVuID0gdmlzaXRvci52aXNpdCh0aGlzKTsKKwkJaWYgKHZpc2l0Q2hpbGRyZW4pIHsKKwkJ
CWFjY2VwdENoaWxkcmVuKHZpc2l0b3IsIHRoaXMuYW5ub3RhdGlvbnMpOworCQkJaWYgKHRoaXMu
ZXhwcmVzc2lvbiAhPSBudWxsKSB7CisJCQkJYWNjZXB0Q2hpbGQodmlzaXRvciwgdGhpcy5leHBy
ZXNzaW9uKTsKKwkJCX0KKwkJfQorCQl2aXNpdG9yLmVuZFZpc2l0KHRoaXMpOworCX0KKworCWlu
dCB0cmVlU2l6ZSgpIHsKKwkJaW50IHNpemUgPSBtZW1TaXplKCkKKwkJCQkrIHRoaXMuYW5ub3Rh
dGlvbnMubGlzdFNpemUoKQorCQkJCSsgKHRoaXMuZXhwcmVzc2lvbiA9PSBudWxsID8gMCA6IHRo
aXMuZXhwcmVzc2lvbi50cmVlU2l6ZSgpKTsKKwkJCXJldHVybiBzaXplOworCX0KKworCWludCBt
ZW1TaXplKCkgeworCQlyZXR1cm4gQkFTRV9OT0RFX1NJWkUgKyAyICogNDsKKwl9Cit9CmRpZmYg
LS1naXQgYS9vcmcuZWNsaXBzZS5qZHQuY29yZS9kb20vb3JnL2VjbGlwc2UvamR0L2NvcmUvZG9t
L01ldGhvZERlY2xhcmF0aW9uLmphdmEgYi9vcmcuZWNsaXBzZS5qZHQuY29yZS9kb20vb3JnL2Vj
bGlwc2UvamR0L2NvcmUvZG9tL01ldGhvZERlY2xhcmF0aW9uLmphdmEKaW5kZXggMTk0NmMwMC4u
NDMzNTU0NCAxMDA2NDQKLS0tIGEvb3JnLmVjbGlwc2UuamR0LmNvcmUvZG9tL29yZy9lY2xpcHNl
L2pkdC9jb3JlL2RvbS9NZXRob2REZWNsYXJhdGlvbi5qYXZhCisrKyBiL29yZy5lY2xpcHNlLmpk
dC5jb3JlL2RvbS9vcmcvZWNsaXBzZS9qZHQvY29yZS9kb20vTWV0aG9kRGVjbGFyYXRpb24uamF2
YQpAQCAtNTMsMTQgKzUzLDE1IEBACiAgKiAJCQkgeyA8Yj4sPC9iPiBGb3JtYWxQYXJhbWV0ZXIg
fSBdIDxiPik8L2I+CiAgKiAgICAgICAgWzxiPnRocm93czwvYj4gVHlwZU5hbWUgeyA8Yj4sPC9i
PiBUeXBlTmFtZSB9IF0gQmxvY2sKICAqIDwvcHJlPgotICogRm9yIEpMUzggb3B0aW9uYWwgcmVj
ZWl2ZXIgcGFyYW1ldGVyIGlzIGFkZGVkOgorICogRm9yIEpMUzggb3B0aW9uYWwgcmVjZWl2ZXIg
cGFyYW1ldGVyIGlzIGFkZGVkIGFuZCBleHRyYSBkaW1lbnNpb25zIGFyZSBhbGxvd2VkIHRvIGhh
dmUgCisgKiB0eXBlIGFubm90YXRpb25zLiBUaGUgYW5ub3RhdGFibGUgZXh0cmEgZGltZW5zaW9u
cyBhcmUgcmVwcmVzZW50ZWQgYnkge0BsaW5rIERpbWVuc2lvbkluZm99LgogICogPHByZT4KICAq
IE1ldGhvZERlY2xhcmF0aW9uOgogICogICAgWyBKYXZhZG9jIF0geyBFeHRlbmRlZE1vZGlmaWVy
IH0KICAqCQkgIFsgPGI+Jmx0OzwvYj4gVHlwZVBhcmFtZXRlciB7IDxiPiw8L2I+IFR5cGVQYXJh
bWV0ZXIgfSA8Yj4mZ3Q7PC9iPiBdCiAgKiAgICAgICAgKCBUeXBlIHwgPGI+dm9pZDwvYj4gKSBJ
ZGVudGlmaWVyIDxiPig8L2I+CiAgKiAgICAgICAgCVsgUmVjZWl2ZXJQYXJhbWV0ZXIgXQotICog
ICAgICAgICAJWyA8Yj4sIDwvYj4gRm9ybWFsUGFyYW1ldGVyIHsgPGI+LDwvYj4gRm9ybWFsUGFy
YW1ldGVyIH0gXSA8Yj4pPC9iPiB7PGI+WzwvYj4gPGI+XTwvYj4gfQorICogICAgICAgICAJWyA8
Yj4sIDwvYj4gRm9ybWFsUGFyYW1ldGVyIHsgPGI+LDwvYj4gRm9ybWFsUGFyYW1ldGVyIH0gXSA8
Yj4pPC9iPiB7IERpbWVuc2lvbkluZm8gfQogICogICAgICAgIFsgPGI+dGhyb3dzPC9iPiBUeXBl
TmFtZSB7IDxiPiw8L2I+IFR5cGVOYW1lIH0gXSAoIEJsb2NrIHwgPGI+OzwvYj4gKQogICogQ29u
c3RydWN0b3JEZWNsYXJhdGlvbjoKICAqICAgIFsgSmF2YWRvYyBdIHsgRXh0ZW5kZWRNb2RpZmll
ciB9CkBAIC0xMzksMTAgKzE0MCwxOSBAQAogCiAJLyoqCiAJICogVGhlICJleHRyYURpbWVuc2lv
bnMiIHN0cnVjdHVyYWwgcHJvcGVydHkgb2YgdGhpcyBub2RlIHR5cGUgKHR5cGU6IHtAbGluayBJ
bnRlZ2VyfSkuCisJICoKIAkgKiBAc2luY2UgMy4wCisJICogQGRlcHJlY2F0ZWQgaW4gSkxTOCwg
dXNlIHtAbGluayBNZXRob2REZWNsYXJhdGlvbiNFWFRSQV9ESU1FTlNJT05fSU5GT1NfUFJPUEVS
VFl9IGluc3RlYWQuCiAJICovCiAJcHVibGljIHN0YXRpYyBmaW5hbCBTaW1wbGVQcm9wZXJ0eURl
c2NyaXB0b3IgRVhUUkFfRElNRU5TSU9OU19QUk9QRVJUWSA9CiAJCW5ldyBTaW1wbGVQcm9wZXJ0
eURlc2NyaXB0b3IoTWV0aG9kRGVjbGFyYXRpb24uY2xhc3MsICJleHRyYURpbWVuc2lvbnMiLCBp
bnQuY2xhc3MsIE1BTkRBVE9SWSk7IC8vJE5PTi1OTFMtMSQKKworCS8qKgorCSAqIFRoZSAiZXh0
cmFEaW1lbnNpb25JbmZvcyIgc3RydWN0dXJhbCBwcm9wZXJ0eSBvZiB0aGlzIG5vZGUgdHlwZSAo
Y2hpbGQgdHlwZToge0BsaW5rIERpbWVuc2lvbkluZm99KSAoYWRkZWQgaW4gSkxTOCBBUEkpLgor
CSAqIEBzaW5jZSAzLjkKKwkgKi8KKwlwdWJsaWMgc3RhdGljIGZpbmFsIENoaWxkTGlzdFByb3Bl
cnR5RGVzY3JpcHRvciBFWFRSQV9ESU1FTlNJT05fSU5GT1NfUFJPUEVSVFkgPQorCQkJbmV3IENo
aWxkTGlzdFByb3BlcnR5RGVzY3JpcHRvcihNZXRob2REZWNsYXJhdGlvbi5jbGFzcywgImV4dHJh
RGltZW5zaW9uSW5mb3MiLCBEaW1lbnNpb25JbmZvLmNsYXNzLCBOT19DWUNMRV9SSVNLKTsgLy8k
Tk9OLU5MUy0xJAogCiAJLyoqCiAJICogVGhlICJ0eXBlUGFyYW1ldGVycyIgc3RydWN0dXJhbCBw
cm9wZXJ0eSBvZiB0aGlzIG5vZGUgdHlwZSAoZWxlbWVudCB0eXBlOiB7QGxpbmsgVHlwZVBhcmFt
ZXRlcn0pIChhZGRlZCBpbiBKTFMzIEFQSSkuCkBAIC0yNTgsNyArMjY4LDcgQEAKIAkJYWRkUHJv
cGVydHkoUkVDRUlWRVJfVFlQRV9QUk9QRVJUWSwgcHJvcGVydHlMaXN0KTsKIAkJYWRkUHJvcGVy
dHkoUkVDRUlWRVJfUVVBTElGSUVSX1BST1BFUlRZLCBwcm9wZXJ0eUxpc3QpOwogCQlhZGRQcm9w
ZXJ0eShQQVJBTUVURVJTX1BST1BFUlRZLCBwcm9wZXJ0eUxpc3QpOwotCQlhZGRQcm9wZXJ0eShF
WFRSQV9ESU1FTlNJT05TX1BST1BFUlRZLCBwcm9wZXJ0eUxpc3QpOworCQlhZGRQcm9wZXJ0eShF
WFRSQV9ESU1FTlNJT05fSU5GT1NfUFJPUEVSVFksIHByb3BlcnR5TGlzdCk7CiAJCWFkZFByb3Bl
cnR5KFRIUk9XTl9FWENFUFRJT05fVFlQRVNfUFJPUEVSVFksIHByb3BlcnR5TGlzdCk7CiAJCWFk
ZFByb3BlcnR5KEJPRFlfUFJPUEVSVFksIHByb3BlcnR5TGlzdCk7CiAJCVBST1BFUlRZX0RFU0NS
SVBUT1JTXzhfMCA9IHJlYXBQcm9wZXJ0eUxpc3QocHJvcGVydHlMaXN0KTsJCkBAIC0zNDQsNiAr
MzU0LDEzIEBACiAJcHJpdmF0ZSBpbnQgZXh0cmFBcnJheURpbWVuc2lvbnMgPSAwOwogCiAJLyoq
CisJICogVGhlIGV4dHJhIGRpbWVuc2lvbnMgdGhpcyBub2RlIGhhcyBpZiBhbnkuCisJICogCisJ
ICogQHNpbmNlIDMuOQorCSAqLworCXByb3RlY3RlZCBBU1ROb2RlLk5vZGVMaXN0IGV4dHJhRGlt
ZW5zaW9uSW5mb3MgPSBudWxsOworCisJLyoqCiAJICogVGhlIGxpc3Qgb2YgdGhyb3duIGV4Y2Vw
dGlvbiBuYW1lcyAoZWxlbWVudCB0eXBlOiB7QGxpbmsgTmFtZX0pLgogCSAqIERlZmF1bHRzIHRv
IGFuIGVtcHR5IGxpc3QgZm9yIGFwaSBsZXZlbHMgYmVsb3cgSkxTOC4KIAkgKi8KQEAgLTM4MSw5
ICszOTgsMTAgQEAKIAkJaWYgKGFzdC5hcGlMZXZlbCA+PSBBU1QuSkxTM19JTlRFUk5BTCkgewog
CQkJdGhpcy50eXBlUGFyYW1ldGVycyA9IG5ldyBBU1ROb2RlLk5vZGVMaXN0KFRZUEVfUEFSQU1F
VEVSU19QUk9QRVJUWSk7CiAJCX0KLQkJaWYgKGFzdC5hcGlMZXZlbCgpIDwgQVNULkpMUzgpIHsK
KwkJaWYgKGFzdC5hcGlMZXZlbCA8IEFTVC5KTFM4KSB7CiAJCQl0aGlzLnRocm93bkV4Y2VwdGlv
bnMgPSBuZXcgQVNUTm9kZS5Ob2RlTGlzdChUSFJPV05fRVhDRVBUSU9OU19QUk9QRVJUWSk7CiAJ
CX0gZWxzZSB7CisJCQl0aGlzLmV4dHJhRGltZW5zaW9uSW5mb3MgPSBuZXcgQVNUTm9kZS5Ob2Rl
TGlzdChFWFRSQV9ESU1FTlNJT05fSU5GT1NfUFJPUEVSVFkpOwogCQkJdGhpcy50aHJvd25FeGNl
cHRpb25UeXBlcyA9IG5ldyBBU1ROb2RlLk5vZGVMaXN0KFRIUk9XTl9FWENFUFRJT05fVFlQRVNf
UFJPUEVSVFkpOwogCQl9CiAJfQpAQCAtNTE3LDYgKzUzNSw5IEBACiAJCWlmIChwcm9wZXJ0eSA9
PSBUSFJPV05fRVhDRVBUSU9OX1RZUEVTX1BST1BFUlRZKSB7CiAJCQlyZXR1cm4gdGhyb3duRXhj
ZXB0aW9uVHlwZXMoKTsKIAkJfQkJCisJCWlmIChwcm9wZXJ0eSA9PSBFWFRSQV9ESU1FTlNJT05f
SU5GT1NfUFJPUEVSVFkpIHsKKwkJCXJldHVybiBnZXRFeHRyYURpbWVuc2lvbkluZm9zKCk7CisJ
CX0KIAkJLy8gYWxsb3cgZGVmYXVsdCBpbXBsZW1lbnRhdGlvbiB0byBmbGFnIHRoZSBlcnJvcgog
CQlyZXR1cm4gc3VwZXIuaW50ZXJuYWxHZXRDaGlsZExpc3RQcm9wZXJ0eShwcm9wZXJ0eSk7CiAJ
fQpAQCAtNTc0LDcgKzU5NSwxMiBAQAogCQkJcmVzdWx0LnNldFJlY2VpdmVyUXVhbGlmaWVyKChT
aW1wbGVOYW1lKSBBU1ROb2RlLmNvcHlTdWJ0cmVlKHRhcmdldCwgdGhpcy5yZWNlaXZlclF1YWxp
ZmllcikpOwogCQl9CiAJCXJlc3VsdC5zZXRDb25zdHJ1Y3Rvcihpc0NvbnN0cnVjdG9yKCkpOwot
CQlyZXN1bHQuc2V0RXh0cmFEaW1lbnNpb25zKGdldEV4dHJhRGltZW5zaW9ucygpKTsKKwkJaWYg
KHRoaXMuYXN0LmFwaUxldmVsID49IEFTVC5KTFM4KSB7CisJCQlyZXN1bHQuZXh0cmFEaW1lbnNp
b25JbmZvcy5hZGRBbGwoCisJCQkJCUFTVE5vZGUuY29weVN1YnRyZWVzKHRhcmdldCwgdGhpcy5l
eHRyYURpbWVuc2lvbkluZm9zKSk7CisJCX0gZWxzZSB7CisJCQlyZXN1bHQuc2V0RXh0cmFEaW1l
bnNpb25zKGdldEV4dHJhRGltZW5zaW9ucygpKTsKKwkJfQogCQlyZXN1bHQuc2V0TmFtZSgoU2lt
cGxlTmFtZSkgZ2V0TmFtZSgpLmNsb25lKHRhcmdldCkpOwogCQlyZXN1bHQucGFyYW1ldGVycygp
LmFkZEFsbCgKIAkJCUFTVE5vZGUuY29weVN1YnRyZWVzKHRhcmdldCwgcGFyYW1ldGVycygpKSk7
CkBAIC0xMDA1LDYgKzEwMzEsOSBAQAogCSAqIEBzaW5jZSAyLjEKIAkgKi8KIAlwdWJsaWMgaW50
IGdldEV4dHJhRGltZW5zaW9ucygpIHsKKwkJaWYgKHRoaXMuYXN0LmFwaUxldmVsID49IEFTVC5K
TFM4KSB7CisJCQlyZXR1cm4gdGhpcy5leHRyYURpbWVuc2lvbkluZm9zLnNpemUoKTsKKwkJfQog
CQlyZXR1cm4gdGhpcy5leHRyYUFycmF5RGltZW5zaW9uczsKIAl9CiAKQEAgLTEwMjQsMTQgKzEw
NTMsMjcgQEAKIAkgKiBAZXhjZXB0aW9uIElsbGVnYWxBcmd1bWVudEV4Y2VwdGlvbiBpZiB0aGUg
bnVtYmVyIG9mIGRpbWVuc2lvbnMgaXMKIAkgKiAgICBuZWdhdGl2ZQogCSAqIEBzaW5jZSAyLjEK
KwkgKiBAZGVwcmVjYXRlZCBJbiB0aGUgSkxTOCBBUEksIHVzZToge0BsaW5rICNnZXRFeHRyYURp
bWVuc2lvbkluZm9zKCl9LgogCSAqLwogCXB1YmxpYyB2b2lkIHNldEV4dHJhRGltZW5zaW9ucyhp
bnQgZGltZW5zaW9ucykgeworCQlzdXBwb3J0ZWRPbmx5SW4yXzNfNCgpOwogCQlpZiAoZGltZW5z
aW9ucyA8IDApIHsKIAkJCXRocm93IG5ldyBJbGxlZ2FsQXJndW1lbnRFeGNlcHRpb24oKTsKIAkJ
fQogCQlwcmVWYWx1ZUNoYW5nZShFWFRSQV9ESU1FTlNJT05TX1BST1BFUlRZKTsKIAkJdGhpcy5l
eHRyYUFycmF5RGltZW5zaW9ucyA9IGRpbWVuc2lvbnM7CiAJCXBvc3RWYWx1ZUNoYW5nZShFWFRS
QV9ESU1FTlNJT05TX1BST1BFUlRZKTsKKwl9CisKKwkvKioKKwkgKiBSZXR1cm5zIHRoZSBsaXZl
IG9yZGVyZWQgbGlzdCBvZiBleHRyYSBkaW1lbnNpb25zIGlmIGFueSAoSkxTOCBBUEkgb25seSku
CisJICogCisJICogQHJldHVybiB0aGUgbGl2ZSBsaXN0IG9mIGV4dHJhIGRpbWVuc2lvbnMgaWYg
YW55IChlbGVtZW50IHR5cGU6IHtAbGluayBEaW1lbnNpb25JbmZvfVtdKQorCSAqIEBzaW5jZSAz
LjkKKwkgKi8KKwlwdWJsaWMgTGlzdCBnZXRFeHRyYURpbWVuc2lvbkluZm9zKCkgeworCQl1bnN1
cHBvcnRlZEluMl8zXzQoKTsKKwkJcmV0dXJuIHRoaXMuZXh0cmFEaW1lbnNpb25JbmZvczsKIAl9
CiAKIAkvKioKQEAgLTEwOTQsNyArMTEzNiw3IEBACiAJICogTWV0aG9kIGRlY2xhcmVkIG9uIEFT
VE5vZGUuCiAJICovCiAJaW50IG1lbVNpemUoKSB7Ci0JCXJldHVybiBzdXBlci5tZW1TaXplKCkg
KyAxMiAqIDQ7CisJCXJldHVybiBzdXBlci5tZW1TaXplKCkgKyAxMyAqIDQ7CiAJfQogCiAJLyog
KG9taXQgamF2YWRvYyBmb3IgdGhpcyBtZXRob2QpCkBAIC0xMTExLDcgKzExNTMsOSBAQAogCQkJ
KyAodGhpcy5yZWNlaXZlclF1YWxpZmllciA9PSBudWxsID8gMCA6IHRoaXMucmVjZWl2ZXJRdWFs
aWZpZXIudHJlZVNpemUoKSkKIAkJCSsgKHRoaXMucmV0dXJuVHlwZSA9PSBudWxsID8gMCA6IHRo
aXMucmV0dXJuVHlwZS50cmVlU2l6ZSgpKQogCQkJKyB0aGlzLnBhcmFtZXRlcnMubGlzdFNpemUo
KQotCQkJKyAodGhpcy5hc3QuYXBpTGV2ZWwgPCBBU1QuSkxTOCA/IHRoaXMudGhyb3duRXhjZXB0
aW9ucy5saXN0U2l6ZSgpIDogdGhpcy50aHJvd25FeGNlcHRpb25UeXBlcy5saXN0U2l6ZSgpKQor
CQkJKyAodGhpcy5hc3QuYXBpTGV2ZWwgPCBBU1QuSkxTOCA/IAorCQkJCQl0aGlzLnRocm93bkV4
Y2VwdGlvbnMubGlzdFNpemUoKSAKKwkJCQkJOiB0aGlzLmV4dHJhRGltZW5zaW9uSW5mb3MubGlz
dFNpemUoKSArIHRoaXMudGhyb3duRXhjZXB0aW9uVHlwZXMubGlzdFNpemUoKSkKIAkJCSsgKHRo
aXMub3B0aW9uYWxCb2R5ID09IG51bGwgPyAwIDogZ2V0Qm9keSgpLnRyZWVTaXplKCkpOwogCX0K
IH0KZGlmZiAtLWdpdCBhL29yZy5lY2xpcHNlLmpkdC5jb3JlL2RvbS9vcmcvZWNsaXBzZS9qZHQv
Y29yZS9kb20vUmVjb3ZlcmVkVmFyaWFibGVCaW5kaW5nLmphdmEgYi9vcmcuZWNsaXBzZS5qZHQu
Y29yZS9kb20vb3JnL2VjbGlwc2UvamR0L2NvcmUvZG9tL1JlY292ZXJlZFZhcmlhYmxlQmluZGlu
Zy5qYXZhCmluZGV4IGJhNTEyZmMuLjg3NGI1OTggMTAwNjQ0Ci0tLSBhL29yZy5lY2xpcHNlLmpk
dC5jb3JlL2RvbS9vcmcvZWNsaXBzZS9qZHQvY29yZS9kb20vUmVjb3ZlcmVkVmFyaWFibGVCaW5k
aW5nLmphdmEKKysrIGIvb3JnLmVjbGlwc2UuamR0LmNvcmUvZG9tL29yZy9lY2xpcHNlL2pkdC9j
b3JlL2RvbS9SZWNvdmVyZWRWYXJpYWJsZUJpbmRpbmcuamF2YQpAQCAtMSw5ICsxLDEzIEBACiAv
KioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioq
KioqKioqKioqKioqKioqKioqKioqKgotICogQ29weXJpZ2h0IChjKSAyMDA3LCAyMDA5IElCTSBD
b3Jwb3JhdGlvbiBhbmQgb3RoZXJzLgorICogQ29weXJpZ2h0IChjKSAyMDA3LCAyMDEzIElCTSBD
b3Jwb3JhdGlvbiBhbmQgb3RoZXJzLgogICogQWxsIHJpZ2h0cyByZXNlcnZlZC4gVGhpcyBwcm9n
cmFtIGFuZCB0aGUgYWNjb21wYW55aW5nIG1hdGVyaWFscwogICogYXJlIG1hZGUgYXZhaWxhYmxl
IHVuZGVyIHRoZSB0ZXJtcyBvZiB0aGUgRWNsaXBzZSBQdWJsaWMgTGljZW5zZSB2MS4wCiAgKiB3
aGljaCBhY2NvbXBhbmllcyB0aGlzIGRpc3RyaWJ1dGlvbiwgYW5kIGlzIGF2YWlsYWJsZSBhdAog
ICogaHR0cDovL3d3dy5lY2xpcHNlLm9yZy9sZWdhbC9lcGwtdjEwLmh0bWwKKyAqCisgKiBUaGlz
IGlzIGFuIGltcGxlbWVudGF0aW9uIG9mIGFuIGVhcmx5LWRyYWZ0IHNwZWNpZmljYXRpb24gZGV2
ZWxvcGVkIHVuZGVyIHRoZSBKYXZhCisgKiBDb21tdW5pdHkgUHJvY2VzcyAoSkNQKSBhbmQgaXMg
bWFkZSBhdmFpbGFibGUgZm9yIHRlc3RpbmcgYW5kIGV2YWx1YXRpb24gcHVycG9zZXMKKyAqIG9u
bHkuIFRoZSBjb2RlIGlzIG5vdCBjb21wYXRpYmxlIHdpdGggYW55IHNwZWNpZmljYXRpb24gb2Yg
dGhlIEpDUC4KICAqCiAgKiBDb250cmlidXRvcnM6CiAgKiAgICAgSUJNIENvcnBvcmF0aW9uIC0g
aW5pdGlhbCBBUEkgYW5kIGltcGxlbWVudGF0aW9uCkBAIC03Nyw3ICs4MSwxNiBAQAogCXB1Ymxp
YyBib29sZWFuIGlzUGFyYW1ldGVyKCkgewogCQlyZXR1cm4gdGhpcy52YXJpYWJsZURlY2xhcmF0
aW9uIGluc3RhbmNlb2YgU2luZ2xlVmFyaWFibGVEZWNsYXJhdGlvbjsKIAl9Ci0KKwlwdWJsaWMg
aW50IGdldEV4dHJhRGltZW5zaW9ucygpIHsKKwkJaWYgKHRoaXMudmFyaWFibGVEZWNsYXJhdGlv
bi5hc3QuYXBpTGV2ZWwgPj0gQVNULkpMUzgpIHsKKwkJCWlmICh0aGlzLnZhcmlhYmxlRGVjbGFy
YXRpb24gaW5zdGFuY2VvZiBWYXJpYWJsZURlY2xhcmF0aW9uRnJhZ21lbnQpIHsKKwkJCQlyZXR1
cm4gKChWYXJpYWJsZURlY2xhcmF0aW9uRnJhZ21lbnQpIHRoaXMudmFyaWFibGVEZWNsYXJhdGlv
bikuZ2V0RXh0cmFEaW1lbnNpb25JbmZvcygpLnNpemUoKTsKKwkJCX0gZWxzZSBpZiAodGhpcy52
YXJpYWJsZURlY2xhcmF0aW9uIGluc3RhbmNlb2YgU2luZ2xlVmFyaWFibGVEZWNsYXJhdGlvbikg
eworCQkJCXJldHVybiAoKFNpbmdsZVZhcmlhYmxlRGVjbGFyYXRpb24pIHRoaXMudmFyaWFibGVE
ZWNsYXJhdGlvbikuZ2V0RXh0cmFEaW1lbnNpb25JbmZvcygpLnNpemUoKTsKKwkJCX0KKwkJfQor
CQlyZXR1cm4gdGhpcy52YXJpYWJsZURlY2xhcmF0aW9uLmdldEV4dHJhRGltZW5zaW9ucygpOwor
CX0KIAlwdWJsaWMgSUFubm90YXRpb25CaW5kaW5nW10gZ2V0QW5ub3RhdGlvbnMoKSB7CiAJCXJl
dHVybiBBbm5vdGF0aW9uQmluZGluZy5Ob0Fubm90YXRpb25zOwogCX0KQEAgLTk0LDcgKzEwNyw3
IEBACiAJCQkJLmFwcGVuZCgidmFyaWFibGVEZWNsYXJhdGlvbiIpIC8vJE5PTi1OTFMtMSQKIAkJ
CQkuYXBwZW5kKHRoaXMudmFyaWFibGVEZWNsYXJhdGlvbi5nZXRDbGFzcygpKQogCQkJCS5hcHBl
bmQodGhpcy52YXJpYWJsZURlY2xhcmF0aW9uLmdldE5hbWUoKS5nZXRJZGVudGlmaWVyKCkpCi0J
CQkJLmFwcGVuZCh0aGlzLnZhcmlhYmxlRGVjbGFyYXRpb24uZ2V0RXh0cmFEaW1lbnNpb25zKCkp
OworCQkJCS5hcHBlbmQoZ2V0RXh0cmFEaW1lbnNpb25zKCkpOwogCQl9CiAJCXJldHVybiBTdHJp
bmcudmFsdWVPZihidWZmZXIpOwogCX0KZGlmZiAtLWdpdCBhL29yZy5lY2xpcHNlLmpkdC5jb3Jl
L2RvbS9vcmcvZWNsaXBzZS9qZHQvY29yZS9kb20vU2luZ2xlVmFyaWFibGVEZWNsYXJhdGlvbi5q
YXZhIGIvb3JnLmVjbGlwc2UuamR0LmNvcmUvZG9tL29yZy9lY2xpcHNlL2pkdC9jb3JlL2RvbS9T
aW5nbGVWYXJpYWJsZURlY2xhcmF0aW9uLmphdmEKaW5kZXggNWMyOGIwOC4uZmQxNGViZCAxMDA2
NDQKLS0tIGEvb3JnLmVjbGlwc2UuamR0LmNvcmUvZG9tL29yZy9lY2xpcHNlL2pkdC9jb3JlL2Rv
bS9TaW5nbGVWYXJpYWJsZURlY2xhcmF0aW9uLmphdmEKKysrIGIvb3JnLmVjbGlwc2UuamR0LmNv
cmUvZG9tL29yZy9lY2xpcHNlL2pkdC9jb3JlL2RvbS9TaW5nbGVWYXJpYWJsZURlY2xhcmF0aW9u
LmphdmEKQEAgLTM2LDEwICszNiwxMSBAQAogICogU2luZ2xlVmFyaWFibGVEZWNsYXJhdGlvbjoK
ICAqICAgIHsgRXh0ZW5kZWRNb2RpZmllciB9IFR5cGUgWyA8Yj4uLi48L2I+IF0gSWRlbnRpZmll
ciB7IDxiPls8L2I+PGI+XTwvYj4gfSBbIDxiPj08L2I+IEV4cHJlc3Npb24gXQogICogPC9wcmU+
Ci0gKiBGb3IgSkxTOCwgdmFyaWFibGUgYXJndW1lbnRzIGFyZSBhbGxvd2VkIHRvIGhhdmUgb3B0
aW9uYWwgYW5ub3RhdGlvbnM6CisgKiBGb3IgSkxTOCwgdmFyaWFibGUgZGVjbGFyYXRpb25zIGFu
ZCBleHRyYSBkaW1lbnNpb25zIG9uIHZhcmlhYmxlIGRlY2xhcmF0aW9ucyBhcmUgYWxsb3dlZCB0
byAKKyAqIGhhdmUgb3B0aW9uYWwgYW5ub3RhdGlvbnMuIFRoZSBhbm5vdGF0YWJsZSBleHRyYSBk
aW1lbnNpb25zIGFyZSByZXByZXNlbnRlZCBieSB7QGxpbmsgRGltZW5zaW9uSW5mb30uCiAgKiA8
cHJlPgogICogU2luZ2xlVmFyaWFibGVEZWNsYXJhdGlvbjoKLSAqICAgIHsgRXh0ZW5kZWRNb2Rp
ZmllciB9IFR5cGUge0Fubm90YXRpb259IFsgPGI+Li4uPC9iPiBdIElkZW50aWZpZXIgeyA8Yj5b
PC9iPjxiPl08L2I+IH0gWyA8Yj49PC9iPiBFeHByZXNzaW9uIF0KKyAqICAgIHsgRXh0ZW5kZWRN
b2RpZmllciB9IFR5cGUge0Fubm90YXRpb259IFsgPGI+Li4uPC9iPiBdIElkZW50aWZpZXIgeyBE
aW1lbnNpb25JbmZvIH0gWyA8Yj49PC9iPiBFeHByZXNzaW9uIF0KICAqIDwvcHJlPgogICoKICAq
IEBzaW5jZSAyLjAKQEAgLTkxLDEwICs5MiwxOSBAQAogCiAJLyoqCiAJICogVGhlICJleHRyYURp
bWVuc2lvbnMiIHN0cnVjdHVyYWwgcHJvcGVydHkgb2YgdGhpcyBub2RlIHR5cGUgKHR5cGU6IHtA
bGluayBJbnRlZ2VyfSkuCisJICoKIAkgKiBAc2luY2UgMy4wCisJICogQGRlcHJlY2F0ZWQgaW4g
SkxTOCwgdXNlIHtAbGluayBTaW5nbGVWYXJpYWJsZURlY2xhcmF0aW9uI0VYVFJBX0RJTUVOU0lP
Tl9JTkZPU19QUk9QRVJUWX0gaW5zdGVhZC4KIAkgKi8KIAlwdWJsaWMgc3RhdGljIGZpbmFsIFNp
bXBsZVByb3BlcnR5RGVzY3JpcHRvciBFWFRSQV9ESU1FTlNJT05TX1BST1BFUlRZID0KIAkJbmV3
IFNpbXBsZVByb3BlcnR5RGVzY3JpcHRvcihTaW5nbGVWYXJpYWJsZURlY2xhcmF0aW9uLmNsYXNz
LCAiZXh0cmFEaW1lbnNpb25zIiwgaW50LmNsYXNzLCBNQU5EQVRPUlkpOyAvLyROT04tTkxTLTEk
CisKKwkvKioKKwkgKiBUaGUgImV4dHJhRGltZW5zaW9uSW5mb3MiIHN0cnVjdHVyYWwgcHJvcGVy
dHkgb2YgdGhpcyBub2RlIHR5cGUgKGNoaWxkIHR5cGU6IHtAbGluayBEaW1lbnNpb25JbmZvfSkg
KGFkZGVkIGluIEpMUzggQVBJKS4KKwkgKiBAc2luY2UgMy45CisJICovCisJcHVibGljIHN0YXRp
YyBmaW5hbCBDaGlsZExpc3RQcm9wZXJ0eURlc2NyaXB0b3IgRVhUUkFfRElNRU5TSU9OX0lORk9T
X1BST1BFUlRZID0KKwkJCW5ldyBDaGlsZExpc3RQcm9wZXJ0eURlc2NyaXB0b3IoU2luZ2xlVmFy
aWFibGVEZWNsYXJhdGlvbi5jbGFzcywgImV4dHJhRGltZW5zaW9uSW5mb3MiLCBEaW1lbnNpb25J
bmZvLmNsYXNzLCBOT19DWUNMRV9SSVNLKTsgLy8kTk9OLU5MUy0xJAogCiAJLyoqCiAJICogVGhl
ICJpbml0aWFsaXplciIgc3RydWN0dXJhbCBwcm9wZXJ0eSBvZiB0aGlzIG5vZGUgdHlwZSAoY2hp
bGQgdHlwZToge0BsaW5rIEV4cHJlc3Npb259KS4KQEAgLTE1NSw3ICsxNjUsNyBAQAogCQlhZGRQ
cm9wZXJ0eShWQVJBUkdTX0FOTk9UQVRJT05TX1BST1BFUlRZLCBwcm9wZXJ0eUxpc3QpOwogCQlh
ZGRQcm9wZXJ0eShWQVJBUkdTX1BST1BFUlRZLCBwcm9wZXJ0eUxpc3QpOwogCQlhZGRQcm9wZXJ0
eShOQU1FX1BST1BFUlRZLCBwcm9wZXJ0eUxpc3QpOwotCQlhZGRQcm9wZXJ0eShFWFRSQV9ESU1F
TlNJT05TX1BST1BFUlRZLCBwcm9wZXJ0eUxpc3QpOworCQlhZGRQcm9wZXJ0eShFWFRSQV9ESU1F
TlNJT05fSU5GT1NfUFJPUEVSVFksIHByb3BlcnR5TGlzdCk7CiAJCWFkZFByb3BlcnR5KElOSVRJ
QUxJWkVSX1BST1BFUlRZLCBwcm9wZXJ0eUxpc3QpOwogCQlQUk9QRVJUWV9ERVNDUklQVE9SU184
XzAgPSByZWFwUHJvcGVydHlMaXN0KHByb3BlcnR5TGlzdCk7CQkKIAkKQEAgLTIyNSw2ICsyMzUs
MTMgQEAKIAlwcml2YXRlIGludCBleHRyYUFycmF5RGltZW5zaW9ucyA9IDA7CiAKIAkvKioKKwkg
KiBMaXN0IG9mIGV4dHJhIGRpbWVuc2lvbnMgdGhpcyBub2RlIGhhcy4KKwkgKiAKKwkgKiBAc2lu
Y2UgMy45CisJICovCisJcHJvdGVjdGVkIEFTVE5vZGUuTm9kZUxpc3QgZXh0cmFEaW1lbnNpb25J
bmZvcyA9IG51bGw7CisKKwkvKioKIAkgKiBUaGUgaW5pdGlhbGl6ZXIgZXhwcmVzc2lvbiwgb3Ig
PGNvZGU+bnVsbDwvY29kZT4gaWYgbm9uZTsKIAkgKiBkZWZhdWx0cyB0byBub25lLgogCSAqLwpA
QCAtMjUzLDYgKzI3MCw3IEBACiAJCQl0aGlzLm1vZGlmaWVycyA9IG5ldyBBU1ROb2RlLk5vZGVM
aXN0KE1PRElGSUVSUzJfUFJPUEVSVFkpOwogCQkJaWYgKGFzdC5hcGlMZXZlbCA+PSBBU1QuSkxT
OCkgewogCQkJCXRoaXMudmFyYXJnc0Fubm90YXRpb25zID0gbmV3IEFTVE5vZGUuTm9kZUxpc3Qo
VkFSQVJHU19BTk5PVEFUSU9OU19QUk9QRVJUWSk7CisJCQkJdGhpcy5leHRyYURpbWVuc2lvbklu
Zm9zID0gbmV3IEFTVE5vZGUuTm9kZUxpc3QoRVhUUkFfRElNRU5TSU9OX0lORk9TX1BST1BFUlRZ
KTsKIAkJCX0KIAkJfQogCX0KQEAgLTM3MCw2ICszODgsOSBAQAogCQlpZiAocHJvcGVydHkgPT0g
VkFSQVJHU19BTk5PVEFUSU9OU19QUk9QRVJUWSkgewogCQkJcmV0dXJuIHZhcmFyZ3NBbm5vdGF0
aW9ucygpOwogCQl9CisJCWlmIChwcm9wZXJ0eSA9PSBFWFRSQV9ESU1FTlNJT05fSU5GT1NfUFJP
UEVSVFkpIHsKKwkJCXJldHVybiBnZXRFeHRyYURpbWVuc2lvbkluZm9zKCk7CisJCX0KIAkJLy8g
YWxsb3cgZGVmYXVsdCBpbXBsZW1lbnRhdGlvbiB0byBmbGFnIHRoZSBlcnJvcgogCQlyZXR1cm4g
c3VwZXIuaW50ZXJuYWxHZXRDaGlsZExpc3RQcm9wZXJ0eShwcm9wZXJ0eSk7CiAJfQpAQCAtMzk0
LDcgKzQxNSwxMiBAQAogCQkJcmVzdWx0LnNldFZhcmFyZ3MoaXNWYXJhcmdzKCkpOwogCQl9CiAJ
CXJlc3VsdC5zZXRUeXBlKChUeXBlKSBnZXRUeXBlKCkuY2xvbmUodGFyZ2V0KSk7Ci0JCXJlc3Vs
dC5zZXRFeHRyYURpbWVuc2lvbnMoZ2V0RXh0cmFEaW1lbnNpb25zKCkpOworCQlpZiAodGhpcy5h
c3QuYXBpTGV2ZWwgPj0gQVNULkpMUzgpIHsKKwkJCXJlc3VsdC5leHRyYURpbWVuc2lvbkluZm9z
LmFkZEFsbCgKKwkJCQkJQVNUTm9kZS5jb3B5U3VidHJlZXModGFyZ2V0LCB0aGlzLmV4dHJhRGlt
ZW5zaW9uSW5mb3MpKTsKKwkJfSBlbHNlIHsKKwkJCXJlc3VsdC5zZXRFeHRyYURpbWVuc2lvbnMo
Z2V0RXh0cmFEaW1lbnNpb25zKCkpOworCQl9CiAJCXJlc3VsdC5zZXROYW1lKChTaW1wbGVOYW1l
KSBnZXROYW1lKCkuY2xvbmUodGFyZ2V0KSk7CiAJCXJlc3VsdC5zZXRJbml0aWFsaXplcigKIAkJ
CShFeHByZXNzaW9uKSBBU1ROb2RlLmNvcHlTdWJ0cmVlKHRhcmdldCwgZ2V0SW5pdGlhbGl6ZXIo
KSkpOwpAQCAtNjMzLDI1ICs2NTksNDkgQEAKIAkJcG9zdFZhbHVlQ2hhbmdlKFZBUkFSR1NfUFJP
UEVSVFkpOwogCX0KIAotCS8qIChvbWl0IGphdmFkb2MgZm9yIHRoaXMgbWV0aG9kKQotCSAqIE1l
dGhvZCBkZWNsYXJlZCBvbiBWYXJpYWJsZURlY2xhcmF0aW9uLgorCS8qKgorCSAqIFJldHVybnMg
dGhlIG51bWJlciBvZiBleHRyYSBhcnJheSBkaW1lbnNpb25zIG92ZXIgYW5kIGFib3ZlIHRoZQor
CSAqIGV4cGxpY2l0bHktc3BlY2lmaWVkIHR5cGUuCisJICoKKwkgKiBAcmV0dXJuIHRoZSBudW1i
ZXIgb2YgZXh0cmEgYXJyYXkgZGltZW5zaW9ucwogCSAqIEBzaW5jZSAyLjEKIAkgKi8KIAlwdWJs
aWMgaW50IGdldEV4dHJhRGltZW5zaW9ucygpIHsKKwkJaWYgKHRoaXMuYXN0LmFwaUxldmVsID49
IEFTVC5KTFM4KSB7CisJCQlyZXR1cm4gdGhpcy5leHRyYURpbWVuc2lvbkluZm9zLnNpemUoKTsK
KwkJfQogCQlyZXR1cm4gdGhpcy5leHRyYUFycmF5RGltZW5zaW9uczsKIAl9CiAKLQkvKiAob21p
dCBqYXZhZG9jIGZvciB0aGlzIG1ldGhvZCkKLQkgKiBNZXRob2QgZGVjbGFyZWQgb24gVmFyaWFi
bGVEZWNsYXJhdGlvbi4KKwkvKioKKwkgKiBTZXRzIHRoZSBudW1iZXIgb2YgZXh0cmEgYXJyYXkg
ZGltZW5zaW9ucyBvdmVyIGFuZCBhYm92ZSB0aGUKKwkgKiBleHBsaWNpdGx5LXNwZWNpZmllZCB0
eXBlIChOb3Qgc3VwcG9ydGVkIGluIEpMUzggYW5kIGFib3ZlKS4gCisJICoKKwkgKiBAcGFyYW0g
ZGltZW5zaW9ucyB0aGUgbnVtYmVyIG9mIGFycmF5IGRpbWVuc2lvbnMKKwkgKiBAZXhjZXB0aW9u
IElsbGVnYWxBcmd1bWVudEV4Y2VwdGlvbiBpZiB0aGUgbnVtYmVyIG9mIGRpbWVuc2lvbnMgaXMK
KwkgKiAgICBuZWdhdGl2ZQogCSAqIEBzaW5jZSAyLjEKKwkgKiBAZGVwcmVjYXRlZCBJbiB0aGUg
SkxTOCBBUEksIHNlZToge0BsaW5rICNnZXRFeHRyYURpbWVuc2lvbkluZm9zKCl9LgogCSAqLwog
CXB1YmxpYyB2b2lkIHNldEV4dHJhRGltZW5zaW9ucyhpbnQgZGltZW5zaW9ucykgeworCQlzdXBw
b3J0ZWRPbmx5SW4yXzNfNCgpOwogCQlpZiAoZGltZW5zaW9ucyA8IDApIHsKIAkJCXRocm93IG5l
dyBJbGxlZ2FsQXJndW1lbnRFeGNlcHRpb24oKTsKIAkJfQogCQlwcmVWYWx1ZUNoYW5nZShFWFRS
QV9ESU1FTlNJT05TX1BST1BFUlRZKTsKIAkJdGhpcy5leHRyYUFycmF5RGltZW5zaW9ucyA9IGRp
bWVuc2lvbnM7CiAJCXBvc3RWYWx1ZUNoYW5nZShFWFRSQV9ESU1FTlNJT05TX1BST1BFUlRZKTsK
Kwl9CisKKwkvKioKKwkgKiBSZXR1cm5zIHRoZSBsaXZlIG9yZGVyZWQgbGlzdCBvZiBleHRyYSBk
aW1lbnNpb25zIChKTFM4IEFQSSBvbmx5KS4KKwkgKgorCSAqIEByZXR1cm4gdGhlIGxpdmUgbGlz
dCBvZiBleHRyYSBkaW1lbnNpb25zIChlbGVtZW50IHR5cGU6IHtAbGluayBEaW1lbnNpb25JbmZv
fVtdKQorCSAqIEBzaW5jZSAzLjkKKwkgKi8KKwlwdWJsaWMgTGlzdCBnZXRFeHRyYURpbWVuc2lv
bkluZm9zKCkgeworCQl1bnN1cHBvcnRlZEluMl8zXzQoKTsKKwkJcmV0dXJuIHRoaXMuZXh0cmFE
aW1lbnNpb25JbmZvczsKIAl9CiAKIAkvKiAob21pdCBqYXZhZG9jIGZvciB0aGlzIG1ldGhvZCkK
QEAgLTY5Myw3ICs3NDMsNyBAQAogCSAqLwogCWludCBtZW1TaXplKCkgewogCQkvLyB0cmVhdCBP
cGVyYXRvciBhcyBmcmVlCi0JCXJldHVybiBCQVNFX05PREVfU0laRSArIDggKiA0OworCQlyZXR1
cm4gQkFTRV9OT0RFX1NJWkUgKyA5ICogNDsKIAl9CiAKIAkvKiAob21pdCBqYXZhZG9jIGZvciB0
aGlzIG1ldGhvZCkKQEAgLTcwNCw2ICs3NTQsNyBAQAogCQkJbWVtU2l6ZSgpCiAJCQkrICh0aGlz
LnZhcmFyZ3NBbm5vdGF0aW9ucyA9PSBudWxsID8gMCA6IHRoaXMudmFyYXJnc0Fubm90YXRpb25z
Lmxpc3RTaXplKCkpCiAJCQkrICh0aGlzLm1vZGlmaWVycyA9PSBudWxsID8gMCA6IHRoaXMubW9k
aWZpZXJzLmxpc3RTaXplKCkpCisJCQkrICh0aGlzLmV4dHJhRGltZW5zaW9uSW5mb3MgPT0gbnVs
bCA/IDAgOiB0aGlzLmV4dHJhRGltZW5zaW9uSW5mb3MubGlzdFNpemUoKSkKIAkJCSsgKHRoaXMu
dHlwZSA9PSBudWxsID8gMCA6IGdldFR5cGUoKS50cmVlU2l6ZSgpKQogCQkJKyAodGhpcy52YXJp
YWJsZU5hbWUgPT0gbnVsbCA/IDAgOiBnZXROYW1lKCkudHJlZVNpemUoKSkKIAkJCSsgKHRoaXMu
b3B0aW9uYWxJbml0aWFsaXplciA9PSBudWxsID8gMCA6IGdldEluaXRpYWxpemVyKCkudHJlZVNp
emUoKSk7CmRpZmYgLS1naXQgYS9vcmcuZWNsaXBzZS5qZHQuY29yZS9kb20vb3JnL2VjbGlwc2Uv
amR0L2NvcmUvZG9tL1ZhcmlhYmxlRGVjbGFyYXRpb25GcmFnbWVudC5qYXZhIGIvb3JnLmVjbGlw
c2UuamR0LmNvcmUvZG9tL29yZy9lY2xpcHNlL2pkdC9jb3JlL2RvbS9WYXJpYWJsZURlY2xhcmF0
aW9uRnJhZ21lbnQuamF2YQppbmRleCBlOWRlN2M4Li4yYmNiNmEwIDEwMDY0NAotLS0gYS9vcmcu
ZWNsaXBzZS5qZHQuY29yZS9kb20vb3JnL2VjbGlwc2UvamR0L2NvcmUvZG9tL1ZhcmlhYmxlRGVj
bGFyYXRpb25GcmFnbWVudC5qYXZhCisrKyBiL29yZy5lY2xpcHNlLmpkdC5jb3JlL2RvbS9vcmcv
ZWNsaXBzZS9qZHQvY29yZS9kb20vVmFyaWFibGVEZWNsYXJhdGlvbkZyYWdtZW50LmphdmEKQEAg
LTI1LDcgKzI1LDEyIEBACiAgKiBWYXJpYWJsZURlY2xhcmF0aW9uRnJhZ21lbnQ6CiAgKiAgICBJ
ZGVudGlmaWVyIHsgPGI+WzwvYj48Yj5dPC9iPiB9IFsgPGI+PTwvYj4gRXhwcmVzc2lvbiBdCiAg
KiA8L3ByZT4KLSAqCisgKiBGb3IgSkxTOCwgdmFyaWFibGUgZnJhZ21lbnRzIGFuZCBleHRyYSBk
aW1lbnNpb25zIG9uIGZyYWdtZW50cyBhcmUgYWxsb3dlZCB0byBoYXZlIG9wdGlvbmFsIAorICog
YW5ub3RhdGlvbnMuIFRoZSBhbm5vdGF0YWJsZSBleHRyYSBkaW1lbnNpb25zIGFyZSByZXByZXNl
bnRlZCBieSB7QGxpbmsgRGltZW5zaW9uSW5mb30uCisgKiA8cHJlPgorICogVmFyaWFibGVEZWNs
YXJhdGlvbkZyYWdtZW50OgorICogICAgSWRlbnRpZmllciB7IERpbWVuc2lvbkluZm8gfSBbIDxi
Pj08L2I+IEV4cHJlc3Npb24gXQorICogPC9wcmU+CiAgKiBAc2luY2UgMi4wCiAgKiBAbm9pbnN0
YW50aWF0ZSBUaGlzIGNsYXNzIGlzIG5vdCBpbnRlbmRlZCB0byBiZSBpbnN0YW50aWF0ZWQgYnkg
Y2xpZW50cy4KICAqLwpAQCAtNDAsMTAgKzQ1LDE5IEBACiAKIAkvKioKIAkgKiBUaGUgImV4dHJh
RGltZW5zaW9ucyIgc3RydWN0dXJhbCBwcm9wZXJ0eSBvZiB0aGlzIG5vZGUgdHlwZSAodHlwZTog
e0BsaW5rIEludGVnZXJ9KS4KKwkgKgogCSAqIEBzaW5jZSAzLjAKKwkgKiBAZGVwcmVjYXRlZCBp
biBKTFM4LCB1c2Uge0BsaW5rIFZhcmlhYmxlRGVjbGFyYXRpb25GcmFnbWVudCNFWFRSQV9ESU1F
TlNJT05fSU5GT1NfUFJPUEVSVFl9IGluc3RlYWQuCiAJICovCiAJcHVibGljIHN0YXRpYyBmaW5h
bCBTaW1wbGVQcm9wZXJ0eURlc2NyaXB0b3IgRVhUUkFfRElNRU5TSU9OU19QUk9QRVJUWSA9CiAJ
CW5ldyBTaW1wbGVQcm9wZXJ0eURlc2NyaXB0b3IoVmFyaWFibGVEZWNsYXJhdGlvbkZyYWdtZW50
LmNsYXNzLCAiZXh0cmFEaW1lbnNpb25zIiwgaW50LmNsYXNzLCBNQU5EQVRPUlkpOyAvLyROT04t
TkxTLTEkCisKKwkvKioKKwkgKiBUaGUgImV4dHJhRGltZW5zaW9uSW5mb3MiIHN0cnVjdHVyYWwg
cHJvcGVydHkgb2YgdGhpcyBub2RlIHR5cGUgKGNoaWxkIHR5cGU6IHtAbGluayBEaW1lbnNpb25J
bmZvfSkgKEFkZGVkIGluIEpMUzggQVBJKS4KKwkgKiBAc2luY2UgMy45CisJICovCisJcHVibGlj
IHN0YXRpYyBmaW5hbCBDaGlsZExpc3RQcm9wZXJ0eURlc2NyaXB0b3IgRVhUUkFfRElNRU5TSU9O
X0lORk9TX1BST1BFUlRZID0KKwkJCW5ldyBDaGlsZExpc3RQcm9wZXJ0eURlc2NyaXB0b3IoVmFy
aWFibGVEZWNsYXJhdGlvbkZyYWdtZW50LmNsYXNzLCAiZXh0cmFEaW1lbnNpb25JbmZvcyIsIERp
bWVuc2lvbkluZm8uY2xhc3MsIE5PX0NZQ0xFX1JJU0spOyAvLyROT04tTkxTLTEkCiAKIAkvKioK
IAkgKiBUaGUgImluaXRpYWxpemVyIiBzdHJ1Y3R1cmFsIHByb3BlcnR5IG9mIHRoaXMgbm9kZSB0
eXBlIChjaGlsZCB0eXBlOiB7QGxpbmsgRXhwcmVzc2lvbn0pLgpAQCAtNjAsNiArNzQsMTQgQEAK
IAkgKi8KIAlwcml2YXRlIHN0YXRpYyBmaW5hbCBMaXN0IFBST1BFUlRZX0RFU0NSSVBUT1JTOwog
CisJLyoqCisJICogQSBsaXN0IG9mIHByb3BlcnR5IGRlc2NyaXB0b3JzIChlbGVtZW50IHR5cGU6
CisJICoge0BsaW5rIFN0cnVjdHVyYWxQcm9wZXJ0eURlc2NyaXB0b3J9KSwKKwkgKiBvciBudWxs
IGlmIHVuaW5pdGlhbGl6ZWQuCisJICogQHNpbmNlIDMuOQorCSAqLworCXByaXZhdGUgc3RhdGlj
IGZpbmFsIExpc3QgUFJPUEVSVFlfREVTQ1JJUFRPUlNfOF8wOworCiAJc3RhdGljIHsKIAkJTGlz
dCBwcm9wZXJ0eUxpc3QgPSBuZXcgQXJyYXlMaXN0KDQpOwogCQljcmVhdGVQcm9wZXJ0eUxpc3Qo
VmFyaWFibGVEZWNsYXJhdGlvbkZyYWdtZW50LmNsYXNzLCBwcm9wZXJ0eUxpc3QpOwpAQCAtNjcs
NiArODksMTMgQEAKIAkJYWRkUHJvcGVydHkoRVhUUkFfRElNRU5TSU9OU19QUk9QRVJUWSwgcHJv
cGVydHlMaXN0KTsKIAkJYWRkUHJvcGVydHkoSU5JVElBTElaRVJfUFJPUEVSVFksIHByb3BlcnR5
TGlzdCk7CiAJCVBST1BFUlRZX0RFU0NSSVBUT1JTID0gcmVhcFByb3BlcnR5TGlzdChwcm9wZXJ0
eUxpc3QpOworCisJCXByb3BlcnR5TGlzdCA9IG5ldyBBcnJheUxpc3QoNCk7CisJCWNyZWF0ZVBy
b3BlcnR5TGlzdChWYXJpYWJsZURlY2xhcmF0aW9uRnJhZ21lbnQuY2xhc3MsIHByb3BlcnR5TGlz
dCk7CisJCWFkZFByb3BlcnR5KE5BTUVfUFJPUEVSVFksIHByb3BlcnR5TGlzdCk7CisJCWFkZFBy
b3BlcnR5KEVYVFJBX0RJTUVOU0lPTl9JTkZPU19QUk9QRVJUWSwgcHJvcGVydHlMaXN0KTsKKwkJ
YWRkUHJvcGVydHkoSU5JVElBTElaRVJfUFJPUEVSVFksIHByb3BlcnR5TGlzdCk7CisJCVBST1BF
UlRZX0RFU0NSSVBUT1JTXzhfMCA9IHJlYXBQcm9wZXJ0eUxpc3QocHJvcGVydHlMaXN0KTsKIAl9
CiAKIAkvKioKQEAgLTgwLDcgKzEwOSwxMSBAQAogCSAqIEBzaW5jZSAzLjAKIAkgKi8KIAlwdWJs
aWMgc3RhdGljIExpc3QgcHJvcGVydHlEZXNjcmlwdG9ycyhpbnQgYXBpTGV2ZWwpIHsKLQkJcmV0
dXJuIFBST1BFUlRZX0RFU0NSSVBUT1JTOworCQlpZiAoYXBpTGV2ZWwgPj0gQVNULkpMUzgpIHsK
KwkJCXJldHVybiBQUk9QRVJUWV9ERVNDUklQVE9SU184XzA7CisJCX0gZWxzZSB7CisJCQlyZXR1
cm4gUFJPUEVSVFlfREVTQ1JJUFRPUlM7CisJCX0KIAl9CiAKIAkvKioKQEAgLTk0LDYgKzEyNywx
MyBAQAogCSAqIGRlZmF1bHRzIHRvIDAuCiAJICovCiAJcHJpdmF0ZSBpbnQgZXh0cmFBcnJheURp
bWVuc2lvbnMgPSAwOworCisJLyoqCisJICogVGhlIGV4dHJhIGRpbWVuc2lvbnMgdGhpcyBub2Rl
IGhhcyB3aXRoIGFubm90YXRpb25zIGlmIGFueS4KKwkgKgorCSAqIEBzaW5jZSAzLjkKKwkgKi8K
Kwlwcm90ZWN0ZWQgQVNUTm9kZS5Ob2RlTGlzdCBleHRyYURpbWVuc2lvbkluZm9zID0gbnVsbDsK
IAogCS8qKgogCSAqIFRoZSBpbml0aWFsaXplciBleHByZXNzaW9uLCBvciA8Y29kZT5udWxsPC9j
b2RlPiBpZiBub25lOwpAQCAtMTEzLDYgKzE1Myw5IEBACiAJICovCiAJVmFyaWFibGVEZWNsYXJh
dGlvbkZyYWdtZW50KEFTVCBhc3QpIHsKIAkJc3VwZXIoYXN0KTsKKwkJaWYgKGFzdC5hcGlMZXZl
bCA+PSBBU1QuSkxTOCkgeworCQkJdGhpcy5leHRyYURpbWVuc2lvbkluZm9zID0gbmV3IEFTVE5v
ZGUuTm9kZUxpc3QoRVhUUkFfRElNRU5TSU9OX0lORk9TX1BST1BFUlRZKTsKKwkJfQogCX0KIAog
CS8qIChvbWl0IGphdmFkb2MgZm9yIHRoaXMgbWV0aG9kKQpAQCAtMTg5LDYgKzIzMiwxNyBAQAog
CS8qIChvbWl0IGphdmFkb2MgZm9yIHRoaXMgbWV0aG9kKQogCSAqIE1ldGhvZCBkZWNsYXJlZCBv
biBBU1ROb2RlLgogCSAqLworCWZpbmFsIExpc3QgaW50ZXJuYWxHZXRDaGlsZExpc3RQcm9wZXJ0
eShDaGlsZExpc3RQcm9wZXJ0eURlc2NyaXB0b3IgcHJvcGVydHkpIHsKKwkJaWYgKHByb3BlcnR5
ID09IEVYVFJBX0RJTUVOU0lPTl9JTkZPU19QUk9QRVJUWSkgeworCQkJcmV0dXJuIGdldEV4dHJh
RGltZW5zaW9uSW5mb3MoKTsKKwkJfQorCQkvLyBhbGxvdyBkZWZhdWx0IGltcGxlbWVudGF0aW9u
IHRvIGZsYWcgdGhlIGVycm9yCisJCXJldHVybiBzdXBlci5pbnRlcm5hbEdldENoaWxkTGlzdFBy
b3BlcnR5KHByb3BlcnR5KTsKKwl9CisKKwkvKiAob21pdCBqYXZhZG9jIGZvciB0aGlzIG1ldGhv
ZCkKKwkgKiBNZXRob2QgZGVjbGFyZWQgb24gQVNUTm9kZS4KKwkgKi8KIAlmaW5hbCBpbnQgZ2V0
Tm9kZVR5cGUwKCkgewogCQlyZXR1cm4gVkFSSUFCTEVfREVDTEFSQVRJT05fRlJBR01FTlQ7CiAJ
fQpAQCAtMjAwLDcgKzI1NCwxMiBAQAogCQlWYXJpYWJsZURlY2xhcmF0aW9uRnJhZ21lbnQgcmVz
dWx0ID0gbmV3IFZhcmlhYmxlRGVjbGFyYXRpb25GcmFnbWVudCh0YXJnZXQpOwogCQlyZXN1bHQu
c2V0U291cmNlUmFuZ2UoZ2V0U3RhcnRQb3NpdGlvbigpLCBnZXRMZW5ndGgoKSk7CiAJCXJlc3Vs
dC5zZXROYW1lKChTaW1wbGVOYW1lKSBnZXROYW1lKCkuY2xvbmUodGFyZ2V0KSk7Ci0JCXJlc3Vs
dC5zZXRFeHRyYURpbWVuc2lvbnMoZ2V0RXh0cmFEaW1lbnNpb25zKCkpOworCQlpZiAodGhpcy5h
c3QuYXBpTGV2ZWwgPj0gQVNULkpMUzgpIHsKKwkJCXJlc3VsdC5leHRyYURpbWVuc2lvbkluZm9z
LmFkZEFsbCgKKwkJCQkJQVNUTm9kZS5jb3B5U3VidHJlZXModGFyZ2V0LCB0aGlzLmV4dHJhRGlt
ZW5zaW9uSW5mb3MpKTsKKwkJfSBlbHNlIHsKKwkJCXJlc3VsdC5zZXRFeHRyYURpbWVuc2lvbnMo
Z2V0RXh0cmFEaW1lbnNpb25zKCkpOworCQl9CiAJCXJlc3VsdC5zZXRJbml0aWFsaXplcigKIAkJ
CShFeHByZXNzaW9uKSBBU1ROb2RlLmNvcHlTdWJ0cmVlKHRhcmdldCwgZ2V0SW5pdGlhbGl6ZXIo
KSkpOwogCQlyZXR1cm4gcmVzdWx0OwpAQCAtMjIzLDYgKzI4MiwxMCBAQAogCQkJLy8gdmlzaXQg
Y2hpbGRyZW4gaW4gbm9ybWFsIGxlZnQgdG8gcmlnaHQgcmVhZGluZyBvcmRlcgogCQkJYWNjZXB0
Q2hpbGQodmlzaXRvciwgZ2V0TmFtZSgpKTsKIAkJCWFjY2VwdENoaWxkKHZpc2l0b3IsIGdldElu
aXRpYWxpemVyKCkpOworCisJCQlpZiAodGhpcy5hc3QuYXBpTGV2ZWwgPj0gQVNULkpMUzgpIHsK
KwkJCQlhY2NlcHRDaGlsZHJlbih2aXNpdG9yLCB0aGlzLmV4dHJhRGltZW5zaW9uSW5mb3MpOwor
CQkJfQogCQl9CiAJCXZpc2l0b3IuZW5kVmlzaXQodGhpcyk7CiAJfQpAQCAtMjcyLDYgKzMzNSw5
IEBACiAJICogQHNpbmNlIDIuMAogCSAqLwogCXB1YmxpYyBpbnQgZ2V0RXh0cmFEaW1lbnNpb25z
KCkgeworCQlpZiAodGhpcy5hc3QuYXBpTGV2ZWwgPj0gQVNULkpMUzgpIHsKKwkJCXJldHVybiB0
aGlzLmV4dHJhRGltZW5zaW9uSW5mb3Muc2l6ZSgpOworCQl9CiAJCXJldHVybiB0aGlzLmV4dHJh
QXJyYXlEaW1lbnNpb25zOwogCX0KIApAQCAtMjg3LDE0ICszNTMsMjggQEAKIAkgKgogCSAqIEBw
YXJhbSBkaW1lbnNpb25zIHRoZSBnaXZlbiBkaW1lbnNpb25zCiAJICogQHNpbmNlIDIuMAorCSAq
IEBkZXByZWNhdGVkIEluIHRoZSBKTFM4IEFQSSwgc2VlOiB7QGxpbmsgI2dldEV4dHJhRGltZW5z
aW9uSW5mb3MoKX0uCiAJICovCiAJcHVibGljIHZvaWQgc2V0RXh0cmFEaW1lbnNpb25zKGludCBk
aW1lbnNpb25zKSB7CisJCXN1cHBvcnRlZE9ubHlJbjJfM180KCk7CiAJCWlmIChkaW1lbnNpb25z
IDwgMCkgewogCQkJdGhyb3cgbmV3IElsbGVnYWxBcmd1bWVudEV4Y2VwdGlvbigpOwogCQl9CiAJ
CXByZVZhbHVlQ2hhbmdlKEVYVFJBX0RJTUVOU0lPTlNfUFJPUEVSVFkpOwogCQl0aGlzLmV4dHJh
QXJyYXlEaW1lbnNpb25zID0gZGltZW5zaW9uczsKIAkJcG9zdFZhbHVlQ2hhbmdlKEVYVFJBX0RJ
TUVOU0lPTlNfUFJPUEVSVFkpOworCX0KKworCS8qKgorCSAqIFJldHVybnMgdGhlIGxpdmUgb3Jk
ZXJlZCBsaXN0IG9mIGV4dHJhIGRpbWVuc2lvbnMgd2l0aCBhbm5vdGF0aW9ucyBpZiBhbnkgKEpM
UzggQVBJIG9ubHkpLgorCSAqCisJICogQHJldHVybiB0aGUgbGl2ZSBsaXN0IG9mIGV4dHJhIGRp
bWVuc2lvbnMgd2l0aCBhbm5vdGF0aW9ucyBpZiBhbnkgKGVsZW1lbnQgdHlwZToge0BsaW5rIERp
bWVuc2lvbkluZm99W10pCisJICogQHNlZSBBU1QjbmV3RGltZW5zaW9uSW5mbygpCisJICogQHNp
bmNlIDMuOQorCSAqLworCXB1YmxpYyBMaXN0IGdldEV4dHJhRGltZW5zaW9uSW5mb3MoKSB7CisJ
CXVuc3VwcG9ydGVkSW4yXzNfNCgpOworCQlyZXR1cm4gdGhpcy5leHRyYURpbWVuc2lvbkluZm9z
OwogCX0KIAogCS8qIChvbWl0IGphdmFkb2MgZm9yIHRoaXMgbWV0aG9kKQpAQCAtMzE5LDcgKzM5
OSw3IEBACiAJICovCiAJaW50IG1lbVNpemUoKSB7CiAJCS8vIHRyZWF0IE9wZXJhdG9yIGFzIGZy
ZWUKLQkJcmV0dXJuIEJBU0VfTk9ERV9TSVpFICsgMyAqIDQ7CisJCXJldHVybiBCQVNFX05PREVf
U0laRSArIDQgKiA0OwogCX0KIAogCS8qIChvbWl0IGphdmFkb2MgZm9yIHRoaXMgbWV0aG9kKQpA
QCAtMzI5LDYgKzQwOSw3IEBACiAJCXJldHVybgogCQkJbWVtU2l6ZSgpCiAJCQkrICh0aGlzLnZh
cmlhYmxlTmFtZSA9PSBudWxsID8gMCA6IGdldE5hbWUoKS50cmVlU2l6ZSgpKQotCQkJKyAodGhp
cy5vcHRpb25hbEluaXRpYWxpemVyID09IG51bGwgPyAwIDogZ2V0SW5pdGlhbGl6ZXIoKS50cmVl
U2l6ZSgpKTsKKwkJCSsgKHRoaXMub3B0aW9uYWxJbml0aWFsaXplciA9PSBudWxsID8gMCA6IGdl
dEluaXRpYWxpemVyKCkudHJlZVNpemUoKSkKKwkJCSsgKHRoaXMuZXh0cmFEaW1lbnNpb25JbmZv
cyA9PSBudWxsID8gMCA6IGdldEV4dHJhRGltZW5zaW9uSW5mb3MoKS5zaXplKCkpOwogCX0KIH0K
ZGlmZiAtLWdpdCBhL29yZy5lY2xpcHNlLmpkdC5jb3JlL2RvbS9vcmcvZWNsaXBzZS9qZHQvaW50
ZXJuYWwvY29yZS9kb20vTmFpdmVBU1RGbGF0dGVuZXIuamF2YSBiL29yZy5lY2xpcHNlLmpkdC5j
b3JlL2RvbS9vcmcvZWNsaXBzZS9qZHQvaW50ZXJuYWwvY29yZS9kb20vTmFpdmVBU1RGbGF0dGVu
ZXIuamF2YQppbmRleCBlY2NlZGE5Li5hYzM5NDRiIDEwMDY0NAotLS0gYS9vcmcuZWNsaXBzZS5q
ZHQuY29yZS9kb20vb3JnL2VjbGlwc2UvamR0L2ludGVybmFsL2NvcmUvZG9tL05haXZlQVNURmxh
dHRlbmVyLmphdmEKKysrIGIvb3JnLmVjbGlwc2UuamR0LmNvcmUvZG9tL29yZy9lY2xpcHNlL2pk
dC9pbnRlcm5hbC9jb3JlL2RvbS9OYWl2ZUFTVEZsYXR0ZW5lci5qYXZhCkBAIC00NSw2ICs0NSw3
IEBACiBpbXBvcnQgb3JnLmVjbGlwc2UuamR0LmNvcmUuZG9tLkNvbmRpdGlvbmFsRXhwcmVzc2lv
bjsKIGltcG9ydCBvcmcuZWNsaXBzZS5qZHQuY29yZS5kb20uQ29uc3RydWN0b3JJbnZvY2F0aW9u
OwogaW1wb3J0IG9yZy5lY2xpcHNlLmpkdC5jb3JlLmRvbS5Db250aW51ZVN0YXRlbWVudDsKK2lt
cG9ydCBvcmcuZWNsaXBzZS5qZHQuY29yZS5kb20uRGltZW5zaW9uSW5mbzsKIGltcG9ydCBvcmcu
ZWNsaXBzZS5qZHQuY29yZS5kb20uVW5pb25UeXBlOwogaW1wb3J0IG9yZy5lY2xpcHNlLmpkdC5j
b3JlLmRvbS5Eb1N0YXRlbWVudDsKIGltcG9ydCBvcmcuZWNsaXBzZS5qZHQuY29yZS5kb20uRW1w
dHlTdGF0ZW1lbnQ7CkBAIC00MTMsNiArNDE0LDE2IEBACiAJCW5vZGUuZ2V0Q29tcG9uZW50VHlw
ZSgpLmFjY2VwdCh0aGlzKTsKIAkJdmlzaXRUeXBlQW5ub3RhdGlvbnMobm9kZSk7CiAJCXRoaXMu
YnVmZmVyLmFwcGVuZCgiW10iKTsvLyROT04tTkxTLTEkCisJCXJldHVybiBmYWxzZTsKKwl9CisK
KwlwdWJsaWMgYm9vbGVhbiB2aXNpdChEaW1lbnNpb25JbmZvIG5vZGUpIHsKKwkJdmlzaXRBbm5v
dGF0aW9uc0xpc3Qobm9kZS5hbm5vdGF0aW9ucygpKTsKKwkJdGhpcy5idWZmZXIuYXBwZW5kKCJb
Iik7IC8vJE5PTi1OTFMtMSQKKwkJaWYgKG5vZGUuZXhwcmVzc2lvbigpICE9IG51bGwpIHsKKwkJ
CW5vZGUuZXhwcmVzc2lvbigpLmFjY2VwdCh0aGlzKTsKKwkJfQorCQl0aGlzLmJ1ZmZlci5hcHBl
bmQoIl0iKTsgLy8kTk9OLU5MUy0xJAogCQlyZXR1cm4gZmFsc2U7CiAJfQogCkBAIC0xMDM3LDgg
KzEwNDgsMTUgQEAKIAkJCX0KIAkJfQogCQl0aGlzLmJ1ZmZlci5hcHBlbmQoIikiKTsvLyROT04t
TkxTLTEkCi0JCWZvciAoaW50IGkgPSAwOyBpIDwgbm9kZS5nZXRFeHRyYURpbWVuc2lvbnMoKTsg
aSsrKSB7Ci0JCQl0aGlzLmJ1ZmZlci5hcHBlbmQoIltdIik7IC8vJE5PTi1OTFMtMSQKKwkJaWYg
KG5vZGUuZ2V0QVNUKCkuYXBpTGV2ZWwoKSA+PSBBU1QuSkxTOCkgeworCQkJTGlzdCBkaW1lbnNp
b25zID0gbm9kZS5nZXRFeHRyYURpbWVuc2lvbkluZm9zKCk7CisJCQlmb3IgKGludCBpID0gMDsg
aSA8IGRpbWVuc2lvbnMuc2l6ZSgpOyBpKyspIHsKKwkJCQl2aXNpdCgoRGltZW5zaW9uSW5mbykg
ZGltZW5zaW9ucy5nZXQoaSkpOworCQkJfQorCQl9IGVsc2UgeworCQkJZm9yIChpbnQgaSA9IDA7
IGkgPCBub2RlLmdldEV4dHJhRGltZW5zaW9ucygpOyBpKyspIHsKKwkJCQl0aGlzLmJ1ZmZlci5h
cHBlbmQoIltdIik7IC8vJE5PTi1OTFMtMSQKKwkJCX0KIAkJfQogCQlpZiAobm9kZS5nZXRBU1Qo
KS5hcGlMZXZlbCgpIDwgQVNULkpMUzgpIHsKIAkJCWlmICghbm9kZS50aHJvd25FeGNlcHRpb25z
KCkuaXNFbXB0eSgpKSB7CkBAIC0xMzczLDggKzEzOTEsMTUgQEAKIAkJfQogCQl0aGlzLmJ1ZmZl
ci5hcHBlbmQoIiAiKTsvLyROT04tTkxTLTEkCiAJCW5vZGUuZ2V0TmFtZSgpLmFjY2VwdCh0aGlz
KTsKLQkJZm9yIChpbnQgaSA9IDA7IGkgPCBub2RlLmdldEV4dHJhRGltZW5zaW9ucygpOyBpKysp
IHsKLQkJCXRoaXMuYnVmZmVyLmFwcGVuZCgiW10iKTsgLy8kTk9OLU5MUy0xJAorCQlpZiAobm9k
ZS5nZXRBU1QoKS5hcGlMZXZlbCgpID49IEFTVC5KTFM4KSB7CisJCQlMaXN0IGRpbWVuc2lvbnMg
PSBub2RlLmdldEV4dHJhRGltZW5zaW9uSW5mb3MoKTsKKwkJCWZvciAoaW50IGkgPSAwOyBpIDwg
ZGltZW5zaW9ucy5zaXplKCk7IGkrKykgeworCQkJCXZpc2l0KChEaW1lbnNpb25JbmZvKSBkaW1l
bnNpb25zLmdldChpKSk7CisJCQl9CisJCX0gZWxzZSB7CisJCQlmb3IgKGludCBpID0gMDsgaSA8
IG5vZGUuZ2V0RXh0cmFEaW1lbnNpb25zKCk7IGkrKykgeworCQkJCXRoaXMuYnVmZmVyLmFwcGVu
ZCgiW10iKTsgLy8kTk9OLU5MUy0xJAorCQkJfQogCQl9CiAJCWlmIChub2RlLmdldEluaXRpYWxp
emVyKCkgIT0gbnVsbCkgewogCQkJdGhpcy5idWZmZXIuYXBwZW5kKCI9Iik7Ly8kTk9OLU5MUy0x
JApAQCAtMTc5NCw4ICsxODE5LDE1IEBACiAJICovCiAJcHVibGljIGJvb2xlYW4gdmlzaXQoVmFy
aWFibGVEZWNsYXJhdGlvbkZyYWdtZW50IG5vZGUpIHsKIAkJbm9kZS5nZXROYW1lKCkuYWNjZXB0
KHRoaXMpOwotCQlmb3IgKGludCBpID0gMDsgaSA8IG5vZGUuZ2V0RXh0cmFEaW1lbnNpb25zKCk7
IGkrKykgewotCQkJdGhpcy5idWZmZXIuYXBwZW5kKCJbXSIpOy8vJE5PTi1OTFMtMSQKKwkJaWYg
KG5vZGUuZ2V0QVNUKCkuYXBpTGV2ZWwoKSA+PSBBU1QuSkxTOCkgeworCQkJTGlzdCBkaW1lbnNp
b25zID0gbm9kZS5nZXRFeHRyYURpbWVuc2lvbkluZm9zKCk7CisJCQlmb3IgKGludCBpID0gMDsg
aSA8IGRpbWVuc2lvbnMuc2l6ZSgpOyBpKyspIHsKKwkJCQl2aXNpdCgoRGltZW5zaW9uSW5mbykg
ZGltZW5zaW9ucy5nZXQoaSkpOworCQkJfQorCQl9IGVsc2UgeworCQkJZm9yIChpbnQgaSA9IDA7
IGkgPCBub2RlLmdldEV4dHJhRGltZW5zaW9ucygpOyBpKyspIHsKKwkJCQl0aGlzLmJ1ZmZlci5h
cHBlbmQoIltdIik7Ly8kTk9OLU5MUy0xJAorCQkJfQogCQl9CiAJCWlmIChub2RlLmdldEluaXRp
YWxpemVyKCkgIT0gbnVsbCkgewogCQkJdGhpcy5idWZmZXIuYXBwZW5kKCI9Iik7Ly8kTk9OLU5M
Uy0xJApAQCAtMTg2MCwxNCArMTg5MiwxNyBAQAogCX0KIAlwcml2YXRlIHZvaWQgdmlzaXRUeXBl
QW5ub3RhdGlvbnMoQW5ub3RhdGFibGVUeXBlIG5vZGUpIHsKIAkJaWYgKG5vZGUuZ2V0QVNUKCku
YXBpTGV2ZWwoKSA+PSBBU1QuSkxTOCkgewotCQkJTGlzdCBhbm5vdGF0aW9ucyA9IG5vZGUuYW5u
b3RhdGlvbnMoKTsKLQkJCWlmIChhbm5vdGF0aW9ucyAhPSBudWxsKSB7Ci0JCQkJZm9yIChJdGVy
YXRvciBpdCA9IGFubm90YXRpb25zLml0ZXJhdG9yKCk7IGl0Lmhhc05leHQoKTsgKSB7Ci0JCQkJ
CUFubm90YXRpb24gYW5ub3RhdGlvbiA9IChBbm5vdGF0aW9uKSBpdC5uZXh0KCk7Ci0JCQkJCWFu
bm90YXRpb24uYWNjZXB0KHRoaXMpOwotCQkJCQl0aGlzLmJ1ZmZlci5hcHBlbmQoJyAnKTsKLQkJ
CQl9CisJCQl2aXNpdEFubm90YXRpb25zTGlzdChub2RlLmFubm90YXRpb25zKCkpOworCQl9CisJ
fQorCisJcHJpdmF0ZSB2b2lkIHZpc2l0QW5ub3RhdGlvbnNMaXN0KExpc3QgYW5ub3RhdGlvbnMp
IHsKKwkJaWYgKGFubm90YXRpb25zICE9IG51bGwpIHsKKwkJCWZvciAoSXRlcmF0b3IgaXQgPSBh
bm5vdGF0aW9ucy5pdGVyYXRvcigpOyBpdC5oYXNOZXh0KCk7ICkgeworCQkJCUFubm90YXRpb24g
YW5ub3RhdGlvbiA9IChBbm5vdGF0aW9uKSBpdC5uZXh0KCk7CisJCQkJYW5ub3RhdGlvbi5hY2Nl
cHQodGhpcyk7CisJCQkJdGhpcy5idWZmZXIuYXBwZW5kKCcgJyk7CiAJCQl9CiAJCX0KLQl9CQor
CX0KIH0=
</data>

          </attachment>
      

    </bug>

</bugzilla>