<?xml version="1.0" encoding="UTF-8" standalone="yes" ?>
<!DOCTYPE bugzilla SYSTEM "https://bugs.eclipse.org/bugs/page.cgi?id=bugzilla.dtd">

<bugzilla version="4.4.7"
          urlbase="https://bugs.eclipse.org/bugs/"
          
          maintainer="webmaster@eclipse.org"
>

    <bug>
          <bug_id>412076</bug_id>
          
          <creation_ts>2013-07-02 05:24:00 -0400</creation_ts>
          <short_desc>[compiler] @NonNullByDefault doesn&apos;t work for varargs parameter when in generic interface</short_desc>
          <delta_ts>2013-10-17 15:33:54 -0400</delta_ts>
          <reporter_accessible>1</reporter_accessible>
          <cclist_accessible>1</cclist_accessible>
          <classification_id>2</classification_id>
          <classification>Eclipse</classification>
          <product>JDT</product>
          <component>Core</component>
          <version>4.3</version>
          <rep_platform>PC</rep_platform>
          <op_sys>Windows 7</op_sys>
          <bug_status>VERIFIED</bug_status>
          <resolution>FIXED</resolution>
          
          
          <bug_file_loc></bug_file_loc>
          <status_whiteboard></status_whiteboard>
          <keywords></keywords>
          <priority>P3</priority>
          <bug_severity>critical</bug_severity>
          <target_milestone>4.3.1</target_milestone>
          
          
          <everconfirmed>1</everconfirmed>
          <reporter name="Danny Birkefeld">dbirkefeld</reporter>
          <assigned_to name="Stephan Herrmann">stephan.herrmann</assigned_to>
          <cc>daniel_megert</cc>
    
    <cc>dominik.wezel</cc>
    
    <cc>jarthana</cc>
    
    <cc>manpalat</cc>
    
    <cc>mfucci</cc>
    
    <cc>robert.kish</cc>
    
    <cc>shankhba</cc>
          
          <votes>0</votes>

      

      

      <flag name="review"
          id="58950"
          type_id="1"
          status="+"
          setter="daniel_megert"
    />

          <comment_sort_order>oldest_to_newest</comment_sort_order>  
          <long_desc isprivate="0" >
    <commentid>2279656</commentid>
    <comment_count>0</comment_count>
    <who name="Danny Birkefeld">dbirkefeld</who>
    <bug_when>2013-07-02 05:24:45 -0400</bug_when>
    <thetext>We get an compiler error with the following code (one file for each interface / class):

@NonNullByDefault
public interface Foo&lt;V&gt; {
  V bar(String... values);
}

@NonNullByDefault
public class FooImpl implements Foo&lt;String&gt; {
  @Override
  public String bar(final String... values) {
    return (&quot;&quot;);
  }
}

The compiler reports the following error for the class:
&quot;Illegal redefinition of parameter values, inherited method from Foo&lt;String&gt; does not constrain this parameter&quot;.

Adding a @NonNull to the &quot;values&quot; parameter in Foo helps, but generates a warning because of a redundant annotation.

In 4.2.2 it works fine.</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>2279666</commentid>
    <comment_count>1</comment_count>
    <who name="Danny Birkefeld">dbirkefeld</who>
    <bug_when>2013-07-02 05:44:45 -0400</bug_when>
    <thetext>Some additional info:
The varargs is not needed, it won&apos;t work with normal parameters too.
And a clean of the project helps to remove the error. But with every changing or only saving of the files the error reappears.</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>2279669</commentid>
    <comment_count>2</comment_count>
    <who name="Jay Arthanareeswaran">jarthana</who>
    <bug_when>2013-07-02 05:52:17 -0400</bug_when>
    <thetext>I can&apos;t reproduce this with 4.3 with automatic build turned on. Can you confirm if you are using the same build (I20130605-2000) ?</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>2279671</commentid>
    <comment_count>3</comment_count>
    <who name="Danny Birkefeld">dbirkefeld</who>
    <bug_when>2013-07-02 05:56:48 -0400</bug_when>
    <thetext>Yes I use I20130605-2000. Every time I save FooImpl without a change the error appears.</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>2279673</commentid>
    <comment_count>4</comment_count>
    <who name="Jay Arthanareeswaran">jarthana</who>
    <bug_when>2013-07-02 06:01:10 -0400</bug_when>
    <thetext>(In reply to comment #3)
&gt; Yes I use I20130605-2000. Every time I save FooImpl without a change the
&gt; error appears.

Did you mean just a white space change? I tried that and can&apos;t reproduce the problem. Can you try with a fresh workspace/project with just these two files in the project?</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>2279676</commentid>
    <comment_count>5</comment_count>
    <who name="Danny Birkefeld">dbirkefeld</who>
    <bug_when>2013-07-02 06:09:10 -0400</bug_when>
    <thetext>(In reply to comment #4)
&gt; Did you mean just a white space change? I tried that and can&apos;t reproduce the
&gt; problem. Can you try with a fresh workspace/project with just these two
&gt; files in the project?

Yes I type in a space, remove it and save the file.
I just tried a new workspace and project. The only thing I changed in the project settings was to enable &quot;annotation-based null analysis&quot;. And I (eclipse) had to import the annotions.jar from the eclipse folder.</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>2279678</commentid>
    <comment_count>6</comment_count>
    <who name="Danny Birkefeld">dbirkefeld</who>
    <bug_when>2013-07-02 06:09:43 -0400</bug_when>
    <thetext>And the error is still there of course.</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>2279680</commentid>
    <comment_count>7</comment_count>
    <who name="Jay Arthanareeswaran">jarthana</who>
    <bug_when>2013-07-02 06:16:56 -0400</bug_when>
    <thetext>Reproduced. Assigning to Stephan.</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>2279733</commentid>
    <comment_count>8</comment_count>
    <who name="Stephan Herrmann">stephan.herrmann</who>
    <bug_when>2013-07-02 08:28:28 -0400</bug_when>
    <thetext>Thanks for the report. I can reproduce too, I&apos;ll investigate.</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>2279871</commentid>
    <comment_count>9</comment_count>
    <who name="Stephan Herrmann">stephan.herrmann</who>
    <bug_when>2013-07-02 12:40:37 -0400</bug_when>
    <thetext>This bug is probably introduced by the fix for bug 388281, which changed the 
way how null annotation information is initialized for binary methods.
(Hence you don&apos;t get the error during a full build using only source types).

The direct cause is a is a simple lack of transferring some more tagBits from
a BinaryTypeBinding to the corresponding ParameterizedTypeBinding
(hence it only happens for generic types).</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>2279872</commentid>
    <comment_count>10</comment_count>
      <attachid>232999</attachid>
    <who name="Stephan Herrmann">stephan.herrmann</who>
    <bug_when>2013-07-02 12:45:17 -0400</bug_when>
    <thetext>Created attachment 232999
proposed patch

Here&apos;s a straight-forward patch, just needs more testing before release.

We might want to consider this for 4.3.1:
+ appears to be a regression
+ fix is simple and well localized</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>2281389</commentid>
    <comment_count>11</comment_count>
    <who name="Stephan Herrmann">stephan.herrmann</who>
    <bug_when>2013-07-07 11:36:42 -0400</bug_when>
    <thetext>Tests &amp; fix have been released for 4.4 M1 via commit a7206b9a1db9f42c4d02bfbc442f9a8443757f7a.</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>2290027</commentid>
    <comment_count>12</comment_count>
    <who name="Danny Birkefeld">dbirkefeld</who>
    <bug_when>2013-07-31 02:42:10 -0400</bug_when>
    <thetext>I hope the fix will make it into 4.3.1 too. This bug is very annoying in large projects.</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>2290031</commentid>
    <comment_count>13</comment_count>
    <who name="Jay Arthanareeswaran">jarthana</who>
    <bug_when>2013-07-31 03:03:56 -0400</bug_when>
    <thetext>Dani, it would be good to have this one in 4.3.1 too.</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>2291454</commentid>
    <comment_count>14</comment_count>
    <who name="shankha banerjee">shankhba</who>
    <bug_when>2013-08-05 05:48:05 -0400</bug_when>
    <thetext>Verified for 4.4M1 using I20130730-0800 build.</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>2292237</commentid>
    <comment_count>15</comment_count>
    <who name="Dani Megert">daniel_megert</who>
    <bug_when>2013-08-07 07:00:16 -0400</bug_when>
    <thetext>(In reply to comment #13)
&gt; Dani, it would be good to have this one in 4.3.1 too.

OK for 4.3.1.</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>2292270</commentid>
    <comment_count>16</comment_count>
    <who name="Stephan Herrmann">stephan.herrmann</who>
    <bug_when>2013-08-07 08:27:12 -0400</bug_when>
    <thetext>(In reply to comment #15)
&gt; (In reply to comment #13)
&gt; &gt; Dani, it would be good to have this one in 4.3.1 too.
&gt; 
&gt; OK for 4.3.1.

Thanks.

Should I commit it to the branch or is s.o. else already working in this?</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>2292272</commentid>
    <comment_count>17</comment_count>
    <who name="Jay Arthanareeswaran">jarthana</who>
    <bug_when>2013-08-07 08:35:12 -0400</bug_when>
    <thetext>(In reply to comment #16)
&gt; Should I commit it to the branch or is s.o. else already working in this?

None yet. Let me know if you would like, though</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>2292282</commentid>
    <comment_count>18</comment_count>
    <who name="Stephan Herrmann">stephan.herrmann</who>
    <bug_when>2013-08-07 08:45:30 -0400</bug_when>
    <thetext>(In reply to comment #17)
&gt; (In reply to comment #16)
&gt; &gt; Should I commit it to the branch or is s.o. else already working in this?
&gt; 
&gt; None yet. Let me know if you would like, though

I&apos;ll do it, n.p. 
Tests against the branch are already running :)</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>2292314</commentid>
    <comment_count>19</comment_count>
    <who name="Stephan Herrmann">stephan.herrmann</who>
    <bug_when>2013-08-07 09:40:05 -0400</bug_when>
    <thetext>Released for 4.3.1 via commit 1b76d1263c31e5c68d443b5403fb264d42f38984</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>2293441</commentid>
    <comment_count>20</comment_count>
    <who name="Stephan Herrmann">stephan.herrmann</who>
    <bug_when>2013-08-10 13:05:21 -0400</bug_when>
    <thetext>*** Bug 414808 has been marked as a duplicate of this bug. ***</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>2300394</commentid>
    <comment_count>21</comment_count>
    <who name="Jay Arthanareeswaran">jarthana</who>
    <bug_when>2013-08-29 03:11:24 -0400</bug_when>
    <thetext>Verified for 4.3.1 with build M20130828-0800</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>2313951</commentid>
    <comment_count>22</comment_count>
    <who name="Stephan Herrmann">stephan.herrmann</who>
    <bug_when>2013-10-03 12:27:13 -0400</bug_when>
    <thetext>*** Bug 418232 has been marked as a duplicate of this bug. ***</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>2319809</commentid>
    <comment_count>23</comment_count>
    <who name="Stephan Herrmann">stephan.herrmann</who>
    <bug_when>2013-10-17 15:33:54 -0400</bug_when>
    <thetext>*** Bug 416853 has been marked as a duplicate of this bug. ***</thetext>
  </long_desc>
      
          <attachment
              isobsolete="0"
              ispatch="1"
              isprivate="0"
          >
            <attachid>232999</attachid>
            <date>2013-07-02 12:45:00 -0400</date>
            <delta_ts>2013-07-02 12:45:17 -0400</delta_ts>
            <desc>proposed patch</desc>
            <filename>bug412076.patch</filename>
            <type>text/plain</type>
            <size>2777</size>
            <attacher name="Stephan Herrmann">stephan.herrmann</attacher>
            
              <data encoding="base64">IyMjIEVjbGlwc2UgV29ya3NwYWNlIFBhdGNoIDEuMAojUCBvcmcuZWNsaXBzZS5qZHQuY29yZS50
ZXN0cy5jb21waWxlcgpkaWZmIC0tZ2l0IHNyYy9vcmcvZWNsaXBzZS9qZHQvY29yZS90ZXN0cy9j
b21waWxlci9yZWdyZXNzaW9uL051bGxBbm5vdGF0aW9uVGVzdC5qYXZhIHNyYy9vcmcvZWNsaXBz
ZS9qZHQvY29yZS90ZXN0cy9jb21waWxlci9yZWdyZXNzaW9uL051bGxBbm5vdGF0aW9uVGVzdC5q
YXZhCmluZGV4IDc3OTA4YjIuLjAwMDY4YzcgMTAwNjQ0Ci0tLSBzcmMvb3JnL2VjbGlwc2UvamR0
L2NvcmUvdGVzdHMvY29tcGlsZXIvcmVncmVzc2lvbi9OdWxsQW5ub3RhdGlvblRlc3QuamF2YQor
Kysgc3JjL29yZy9lY2xpcHNlL2pkdC9jb3JlL3Rlc3RzL2NvbXBpbGVyL3JlZ3Jlc3Npb24vTnVs
bEFubm90YXRpb25UZXN0LmphdmEKQEAgLTUzLDcgKzUzLDcgQEAKIC8vIFN0YXRpYyBpbml0aWFs
aXplciB0byBzcGVjaWZ5IHRlc3RzIHN1YnNldCB1c2luZyBURVNUU18qIHN0YXRpYyB2YXJpYWJs
ZXMKIC8vIEFsbCBzcGVjaWZpZWQgdGVzdHMgd2hpY2ggZG8gbm90IGJlbG9uZyB0byB0aGUgY2xh
c3MgYXJlIHNraXBwZWQuLi4KIHN0YXRpYyB7Ci0vLwkJVEVTVFNfTkFNRVMgPSBuZXcgU3RyaW5n
W10geyAidGVzdF9jb25kaXRpb25hbF9leHByZXNzaW9uIiB9OworLy8JCVRFU1RTX05BTUVTID0g
bmV3IFN0cmluZ1tdIHsgInRlc3RCdWc0MTIwNzYiIH07CiAvLwkJVEVTVFNfTlVNQkVSUyA9IG5l
dyBpbnRbXSB7IDU2MSB9OwogLy8JCVRFU1RTX1JBTkdFID0gbmV3IGludFtdIHsgMSwgMjA0OSB9
OwogfQpAQCAtNjEyNyw0ICs2MTI3LDMzIEBACiAJCSJQb3RlbnRpYWwgbnVsbCBwb2ludGVyIGFj
Y2VzczogVGhpcyBleHByZXNzaW9uIG9mIHR5cGUgQm9vbGVhbiBtYXkgYmUgbnVsbCBidXQgcmVx
dWlyZXMgYXV0by11bmJveGluZ1xuIiArIAogCQkiLS0tLS0tLS0tLVxuIik7CiB9CisKK3B1Ymxp
YyB2b2lkIHRlc3RCdWc0MTIwNzYoKSB7CisJTWFwIG9wdGlvbnMgPSBnZXRDb21waWxlck9wdGlv
bnMoKTsKKwlvcHRpb25zLnB1dChKYXZhQ29yZS5DT01QSUxFUl9QQl9NSVNTSU5HX09WRVJSSURF
X0FOTk9UQVRJT04sIEphdmFDb3JlLklHTk9SRSk7CisJcnVuQ29uZm9ybVRlc3RXaXRoTGlicygK
KwkJbmV3IFN0cmluZ1tdIHsKKwkJCSJGb28uamF2YSIsCisJCQkiaW1wb3J0IG9yZy5lY2xpcHNl
LmpkdC5hbm5vdGF0aW9uLio7XG4iICsKKwkJCSJATm9uTnVsbEJ5RGVmYXVsdFxuIiArIAorCQkJ
InB1YmxpYyBpbnRlcmZhY2UgRm9vPFY+IHtcbiIgKyAKKwkJCSIgIFYgYmFyKFN0cmluZy4uLiB2
YWx1ZXMpO1xuIiArIAorCQkJIn1cbiIKKwkJfSwKKwkJb3B0aW9ucywKKwkJIiIpOworCXJ1bkNv
bmZvcm1UZXN0V2l0aExpYnMoCisJCW5ldyBTdHJpbmdbXSB7CisJCQkiRm9vSW1wbC5qYXZhIiwK
KwkJCSJpbXBvcnQgb3JnLmVjbGlwc2UuamR0LmFubm90YXRpb24uKjtcbiIgKworCQkJIkBOb25O
dWxsQnlEZWZhdWx0XG4iICsgCisJCQkicHVibGljIGNsYXNzIEZvb0ltcGwgaW1wbGVtZW50cyBG
b288U3RyaW5nPiB7XG4iICsgCisJCQkiICBwdWJsaWMgU3RyaW5nIGJhcihmaW5hbCBTdHJpbmcu
Li4gdmFsdWVzKSB7XG4iICsgCisJCQkiICAgIHJldHVybiAoXCJcIik7XG4iICsgCisJCQkiICB9
XG4iICsgCisJCQkifVxuIgorCQl9LAorCQlvcHRpb25zLAorCQkiIik7CQorfQogfQojUCBvcmcu
ZWNsaXBzZS5qZHQuY29yZQpkaWZmIC0tZ2l0IGNvbXBpbGVyL29yZy9lY2xpcHNlL2pkdC9pbnRl
cm5hbC9jb21waWxlci9sb29rdXAvUGFyYW1ldGVyaXplZFR5cGVCaW5kaW5nLmphdmEgY29tcGls
ZXIvb3JnL2VjbGlwc2UvamR0L2ludGVybmFsL2NvbXBpbGVyL2xvb2t1cC9QYXJhbWV0ZXJpemVk
VHlwZUJpbmRpbmcuamF2YQppbmRleCBkODg3ZDZkLi5mZTM4ZWEyIDEwMDY0NAotLS0gY29tcGls
ZXIvb3JnL2VjbGlwc2UvamR0L2ludGVybmFsL2NvbXBpbGVyL2xvb2t1cC9QYXJhbWV0ZXJpemVk
VHlwZUJpbmRpbmcuamF2YQorKysgY29tcGlsZXIvb3JnL2VjbGlwc2UvamR0L2ludGVybmFsL2Nv
bXBpbGVyL2xvb2t1cC9QYXJhbWV0ZXJpemVkVHlwZUJpbmRpbmcuamF2YQpAQCAtNjg2LDcgKzY4
Niw5IEBACiAJCQkJdGhpcy50YWdCaXRzIHw9IHNvbWVBcmd1bWVudC50YWdCaXRzICYgKFRhZ0Jp
dHMuSGFzVHlwZVZhcmlhYmxlIHwgVGFnQml0cy5IYXNNaXNzaW5nVHlwZSB8IFRhZ0JpdHMuQ29u
dGFpbnNOZXN0ZWRUeXBlUmVmZXJlbmNlcyk7CiAJCQl9CiAJCX0KLQkJdGhpcy50YWdCaXRzIHw9
IHNvbWVUeXBlLnRhZ0JpdHMgJiAoVGFnQml0cy5Jc0xvY2FsVHlwZXwgVGFnQml0cy5Jc01lbWJl
clR5cGUgfCBUYWdCaXRzLklzTmVzdGVkVHlwZSB8IFRhZ0JpdHMuSGFzTWlzc2luZ1R5cGUgfCBU
YWdCaXRzLkNvbnRhaW5zTmVzdGVkVHlwZVJlZmVyZW5jZXMpOworCQl0aGlzLnRhZ0JpdHMgfD0g
c29tZVR5cGUudGFnQml0cyAmIChUYWdCaXRzLklzTG9jYWxUeXBlfCBUYWdCaXRzLklzTWVtYmVy
VHlwZSB8IFRhZ0JpdHMuSXNOZXN0ZWRUeXBlIHwgVGFnQml0cy5Db250YWluc05lc3RlZFR5cGVS
ZWZlcmVuY2VzCisJCQkJIHwgVGFnQml0cy5IYXNNaXNzaW5nVHlwZQorCQkJCSB8IFRhZ0JpdHMu
QW5ub3RhdGlvbk5vbk51bGxCeURlZmF1bHQgfCBUYWdCaXRzLkFubm90YXRpb25OdWxsVW5zcGVj
aWZpZWRCeURlZmF1bHQpOwogCQl0aGlzLnRhZ0JpdHMgJj0gfihUYWdCaXRzLkFyZUZpZWxkc0Nv
bXBsZXRlfFRhZ0JpdHMuQXJlTWV0aG9kc0NvbXBsZXRlKTsKIAl9CiA=
</data>

          </attachment>
      

    </bug>

</bugzilla>