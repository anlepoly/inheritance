<?xml version="1.0" encoding="UTF-8" standalone="yes" ?>
<!DOCTYPE bugzilla SYSTEM "https://bugs.eclipse.org/bugs/page.cgi?id=bugzilla.dtd">

<bugzilla version="4.4.7"
          urlbase="https://bugs.eclipse.org/bugs/"
          
          maintainer="webmaster@eclipse.org"
>

    <bug>
          <bug_id>428112</bug_id>
          
          <creation_ts>2014-02-13 10:46:00 -0500</creation_ts>
          <short_desc>[1.8][compiler] ClassCastException in ReferenceExpression.generateCode</short_desc>
          <delta_ts>2014-02-21 00:56:05 -0500</delta_ts>
          <reporter_accessible>1</reporter_accessible>
          <cclist_accessible>1</cclist_accessible>
          <classification_id>2</classification_id>
          <classification>Eclipse</classification>
          <product>JDT</product>
          <component>Core</component>
          <version>4.4</version>
          <rep_platform>PC</rep_platform>
          <op_sys>Windows 7</op_sys>
          <bug_status>VERIFIED</bug_status>
          <resolution>FIXED</resolution>
          
          
          <bug_file_loc></bug_file_loc>
          <status_whiteboard></status_whiteboard>
          <keywords></keywords>
          <priority>P3</priority>
          <bug_severity>major</bug_severity>
          <target_milestone>BETA J8</target_milestone>
          
          
          <everconfirmed>1</everconfirmed>
          <reporter name="Scott Wright">tswright000</reporter>
          <assigned_to name="Srikanth Sankaran">srikanth_sankaran</assigned_to>
          <cc>jarthana</cc>
    
    <cc>Olivier_Thomann</cc>
    
    <cc>srikanth_sankaran</cc>
          
          <votes>0</votes>

      

      

      

          <comment_sort_order>oldest_to_newest</comment_sort_order>  
          <long_desc isprivate="0" >
    <commentid>2362969</commentid>
    <comment_count>0</comment_count>
      <attachid>239911</attachid>
    <who name="Scott Wright">tswright000</who>
    <bug_when>2014-02-13 10:46:02 -0500</bug_when>
    <thetext>Created attachment 239911
Example from Horstmann&apos;s &apos;Java SE 8 for the Really Impatient&apos;, chapter 8, section 7

Received following exception while compiling the attached source:

!ENTRY org.eclipse.jdt.ui 4 0 2014-02-13 08:21:36.316
!MESSAGE Error in JDT Core during AST creation
!STACK 0
java.lang.ClassCastException: org.eclipse.jdt.internal.compiler.lookup.BinaryTypeBinding cannot be cast to org.eclipse.jdt.internal.compiler.lookup.NestedTypeBinding
	at org.eclipse.jdt.internal.compiler.ast.ReferenceExpression.generateCode(ReferenceExpression.java:216)
	at org.eclipse.jdt.internal.compiler.ast.Statement.generateArguments(Statement.java:289)
	at org.eclipse.jdt.internal.compiler.ast.MessageSend.generateCode(MessageSend.java:426)
	at org.eclipse.jdt.internal.compiler.ast.MessageSend.generateCode(MessageSend.java:419)
	at org.eclipse.jdt.internal.compiler.ast.LocalDeclaration.generateCode(LocalDeclaration.java:152)
	at org.eclipse.jdt.internal.compiler.ast.AbstractMethodDeclaration.generateCode(AbstractMethodDeclaration.java:328)
	at org.eclipse.jdt.internal.compiler.ast.AbstractMethodDeclaration.generateCode(AbstractMethodDeclaration.java:273)
	at org.eclipse.jdt.internal.compiler.ast.TypeDeclaration.generateCode(TypeDeclaration.java:570)
	at org.eclipse.jdt.internal.compiler.ast.TypeDeclaration.generateCode(TypeDeclaration.java:639)
	at org.eclipse.jdt.internal.compiler.ast.CompilationUnitDeclaration.generateCode(CompilationUnitDeclaration.java:370)
	at org.eclipse.jdt.core.dom.CompilationUnitResolver.resolve(CompilationUnitResolver.java:1214)
	at org.eclipse.jdt.core.dom.CompilationUnitResolver.resolve(CompilationUnitResolver.java:693)
	at org.eclipse.jdt.core.dom.ASTParser.internalCreateAST(ASTParser.java:1187)
	at org.eclipse.jdt.core.dom.ASTParser.createAST(ASTParser.java:813)
	at org.eclipse.jdt.internal.ui.javaeditor.ASTProvider$1.run(ASTProvider.java:548)
	at org.eclipse.core.runtime.SafeRunner.run(SafeRunner.java:42)
	at org.eclipse.jdt.internal.ui.javaeditor.ASTProvider.createAST(ASTProvider.java:541)
	at org.eclipse.jdt.internal.ui.javaeditor.ASTProvider.getAST(ASTProvider.java:484)
	at org.eclipse.jdt.internal.ui.javaeditor.ASTProvider.getAST(ASTProvider.java:474)
	at org.eclipse.jdt.ui.SharedASTProvider.getAST(SharedASTProvider.java:132)
	at org.eclipse.jdt.internal.ui.viewsupport.SelectionListenerWithASTManager$PartListenerGroup.calculateASTandInform(SelectionListenerWithASTManager.java:170)
	at org.eclipse.jdt.internal.ui.viewsupport.SelectionListenerWithASTManager$PartListenerGroup$3.run(SelectionListenerWithASTManager.java:155)
	at org.eclipse.core.internal.jobs.Worker.run(Worker.java:53)

Encountered in Luna, build I20140123-1600 with Eclipse Java Development Tools Patch for Java 8 Support (BETA) v 1.0.0.v20140213-0104_BETA_JAVA8</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>2363008</commentid>
    <comment_count>1</comment_count>
    <who name="Srikanth Sankaran">srikanth_sankaran</who>
    <bug_when>2014-02-13 11:39:10 -0500</bug_when>
    <thetext>Thanks, I&apos;ll follow up.</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>2363227</commentid>
    <comment_count>2</comment_count>
    <who name="Srikanth Sankaran">srikanth_sankaran</who>
    <bug_when>2014-02-14 00:03:16 -0500</bug_when>
    <thetext>The cast was completely unnecessary and would produce CCEs
for non-source types. Since there are virtual methods that answer the
required information, I got rid of the cast.

Test and fix released here: 
http://git.eclipse.org/c/jdt/eclipse.jdt.core.git/commit/?h=BETA_JAVA8&amp;id=11f1358e49c275ae76b9b676e7f3fef7eb5220cb

Thanks Scott.</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>2366482</commentid>
    <comment_count>3</comment_count>
    <who name="Jay Arthanareeswaran">jarthana</who>
    <bug_when>2014-02-21 00:56:05 -0500</bug_when>
    <thetext>Verified for Java 8 RC1 using Kepler SR2 +  
Eclipse Java Development Tools Patch for Java 8 Support (BETA)   
1.0.0.v20140220-2054</thetext>
  </long_desc>
      
          <attachment
              isobsolete="0"
              ispatch="0"
              isprivate="0"
          >
            <attachid>239911</attachid>
            <date>2014-02-13 10:46:00 -0500</date>
            <delta_ts>2014-02-13 11:43:33 -0500</delta_ts>
            <desc>Example from Horstmann&apos;s &apos;Java SE 8 for the Really Impatient&apos;, chapter 8, section 7</desc>
            <filename>Locales.java</filename>
            <type>text/plain</type>
            <size>646</size>
            <attacher name="Scott Wright">tswright000</attacher>
            
              <data encoding="base64">cGFja2FnZSBjaDguc2VjMDc7CgppbXBvcnQgamF2YS51dGlsLkFycmF5czsKaW1wb3J0IGphdmEu
dXRpbC5MaXN0OwppbXBvcnQgamF2YS51dGlsLkxvY2FsZTsKaW1wb3J0IGphdmEudXRpbC5zdHJl
YW0uQ29sbGVjdG9yczsKaW1wb3J0IGphdmEudXRpbC5zdHJlYW0uU3RyZWFtOwoKcHVibGljIGNs
YXNzIExvY2FsZXMKewoJcHVibGljIHN0YXRpYyB2b2lkIG1haW4oIGZpbmFsIFN0cmluZ1tdIGFy
Z3MgKQoJewoJCWZpbmFsIExpc3Q8TG9jYWxlLkxhbmd1YWdlUmFuZ2U+IHJhbmdlcyA9IFN0cmVh
bS5vZiggImRlIiwgIiotQ0giICkubWFwKCBMb2NhbGUuTGFuZ3VhZ2VSYW5nZTo6bmV3ICkuY29s
bGVjdCggQ29sbGVjdG9ycy50b0xpc3QoKSApOwoJCWZpbmFsIExpc3Q8TG9jYWxlPiBtYXRjaGVz
ID0gTG9jYWxlLmZpbHRlciggcmFuZ2VzLCBBcnJheXMuYXNMaXN0KCBMb2NhbGUuZ2V0QXZhaWxh
YmxlTG9jYWxlcygpICkgKTsKCQlTeXN0ZW0ub3V0LnByaW50bG4oIG1hdGNoZXMgKTsKCQlmaW5h
bCBMb2NhbGUgYmVzdE1hdGNoID0gTG9jYWxlLmxvb2t1cCggcmFuZ2VzLCBBcnJheXMuYXNMaXN0
KCBMb2NhbGUuZ2V0QXZhaWxhYmxlTG9jYWxlcygpICkgKTsKCQlTeXN0ZW0ub3V0LnByaW50bG4o
IGJlc3RNYXRjaCApOwoJfQp9Cg==
</data>

          </attachment>
      

    </bug>

</bugzilla>