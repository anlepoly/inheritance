<?xml version="1.0" encoding="UTF-8" standalone="yes" ?>
<!DOCTYPE bugzilla SYSTEM "https://bugs.eclipse.org/bugs/page.cgi?id=bugzilla.dtd">

<bugzilla version="4.4.7"
          urlbase="https://bugs.eclipse.org/bugs/"
          
          maintainer="webmaster@eclipse.org"
>

    <bug>
          <bug_id>427943</bug_id>
          
          <creation_ts>2014-02-11 16:57:00 -0500</creation_ts>
          <short_desc>The method org.eclipse.jdt.internal.compiler.apt.model.Factory.getPrimitiveType does not throw IllegalArgumentException</short_desc>
          <delta_ts>2014-03-04 02:10:26 -0500</delta_ts>
          <reporter_accessible>1</reporter_accessible>
          <cclist_accessible>1</cclist_accessible>
          <classification_id>2</classification_id>
          <classification>Eclipse</classification>
          <product>JDT</product>
          <component>APT</component>
          <version>4.3</version>
          <rep_platform>PC</rep_platform>
          <op_sys>Linux</op_sys>
          <bug_status>VERIFIED</bug_status>
          <resolution>FIXED</resolution>
          
          
          <bug_file_loc></bug_file_loc>
          <status_whiteboard></status_whiteboard>
          <keywords></keywords>
          <priority>P3</priority>
          <bug_severity>normal</bug_severity>
          <target_milestone>4.4 M6</target_milestone>
          
          
          <everconfirmed>1</everconfirmed>
          <reporter name="Harry Terkelsen">het</reporter>
          <assigned_to name="Harry Terkelsen">het</assigned_to>
          <cc>daniel_megert</cc>
    
    <cc>jarthana</cc>
    
    <cc>manpalat</cc>
          
          <votes>0</votes>

      

      

      

          <comment_sort_order>oldest_to_newest</comment_sort_order>  
          <long_desc isprivate="0" >
    <commentid>2361850</commentid>
    <comment_count>0</comment_count>
    <who name="Harry Terkelsen">het</who>
    <bug_when>2014-02-11 16:57:47 -0500</bug_when>
    <thetext>The documentation for org.eclipse.jdt.internal.compiler.apt.model.Factory.getPrimitiveType reads:

	/**
	 * Get a type mirror object representing the specified primitive type kind.
	 * @throw IllegalArgumentException if a non-primitive TypeKind is requested
	 */

The method body tells a different story:

	public PrimitiveTypeImpl getPrimitiveType(TypeKind kind)
	{
		switch (kind) {
		case BOOLEAN:
			return PrimitiveTypeImpl.BOOLEAN;
		case BYTE:
			return PrimitiveTypeImpl.BYTE;
		case CHAR:
			return PrimitiveTypeImpl.CHAR;
		case DOUBLE:
			return PrimitiveTypeImpl.DOUBLE;
		case FLOAT:
			return PrimitiveTypeImpl.FLOAT;
		case INT:
			return PrimitiveTypeImpl.INT;
		case LONG:
			return PrimitiveTypeImpl.LONG;
		case SHORT:
			return PrimitiveTypeImpl.SHORT;
		default:
			throw new IllegalStateException();
		}
	}

Proposed patch:

s/IllegalStateException/IllegalArgumentException/</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>2361879</commentid>
    <comment_count>1</comment_count>
    <who name="Harry Terkelsen">het</who>
    <bug_when>2014-02-11 18:03:07 -0500</bug_when>
    <thetext>I&apos;ve requested a review on Gerrit here: https://git.eclipse.org/r/#/c/21852/</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>2361968</commentid>
    <comment_count>2</comment_count>
    <who name="Jay Arthanareeswaran">jarthana</who>
    <bug_when>2014-02-12 02:50:23 -0500</bug_when>
    <thetext>One of the tests failed in the hudson job, although not relevant to this fix. The failure could have happens because classes were loaded in a different order than expected. But we haven&apos;t seen this before in our local environment or eclipse builds. This seems to have happened in previous hudson jobs too.

The patch looks good. We probably have to discard the gerrit contribution and release it from my workspace.</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>2361981</commentid>
    <comment_count>3</comment_count>
    <who name="Jay Arthanareeswaran">jarthana</who>
    <bug_when>2014-02-12 03:18:04 -0500</bug_when>
    <thetext>Thanks for the patch. Released in master for 4.4. M6.

http://git.eclipse.org/c/jdt/eclipse.jdt.core.git/commit/?id=42bd9b01a3f5cafa3c20186dd8b7608f467f1611</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>2370963</commentid>
    <comment_count>4</comment_count>
    <who name="Manoj Palat Away Until May 11 2015">manpalat</who>
    <bug_when>2014-03-04 02:10:26 -0500</bug_when>
    <thetext>Verified for Version: Luna 4.4M6 Build id: I20140303-2000</thetext>
  </long_desc>
      
      

    </bug>

</bugzilla>