<?xml version="1.0" encoding="UTF-8" standalone="yes" ?>
<!DOCTYPE bugzilla SYSTEM "https://bugs.eclipse.org/bugs/page.cgi?id=bugzilla.dtd">

<bugzilla version="4.4.7"
          urlbase="https://bugs.eclipse.org/bugs/"
          
          maintainer="webmaster@eclipse.org"
>

    <bug>
          <bug_id>430572</bug_id>
          
          <creation_ts>2014-03-17 20:59:00 -0400</creation_ts>
          <short_desc>[1.8] CCE on hovering over &apos;super&apos; in lambda expression</short_desc>
          <delta_ts>2015-01-20 03:24:17 -0500</delta_ts>
          <reporter_accessible>1</reporter_accessible>
          <cclist_accessible>1</cclist_accessible>
          <classification_id>2</classification_id>
          <classification>Eclipse</classification>
          <product>JDT</product>
          <component>Core</component>
          <version>4.4</version>
          <rep_platform>All</rep_platform>
          <op_sys>All</op_sys>
          <bug_status>VERIFIED</bug_status>
          <resolution>FIXED</resolution>
          
          
          <bug_file_loc></bug_file_loc>
          <status_whiteboard></status_whiteboard>
          <keywords></keywords>
          <priority>P3</priority>
          <bug_severity>normal</bug_severity>
          <target_milestone>4.4.2</target_milestone>
          
          
          <everconfirmed>1</everconfirmed>
          <reporter name="Noopur Gupta">noopur_gupta</reporter>
          <assigned_to name="Srikanth Sankaran">srikanth_sankaran</assigned_to>
          <cc>jarthana</cc>
    
    <cc>manpalat</cc>
    
    <cc>markus_keller</cc>
    
    <cc>srikanth_sankaran</cc>
          
          <votes>0</votes>

      

      

      

          <comment_sort_order>oldest_to_newest</comment_sort_order>  
          <long_desc isprivate="0" >
    <commentid>2376915</commentid>
    <comment_count>0</comment_count>
    <who name="Noopur Gupta">noopur_gupta</who>
    <bug_when>2014-03-17 20:59:36 -0400</bug_when>
    <thetext>@FunctionalInterface
interface FI {
	default int getID() {
		return 11;
	}

	void print();
}

class T {
	FI f2 = () -&gt; System.out.println(super.toString()); // Hover on &apos;super&apos;	
}

-----------------------------------------

Hover over &apos;super&apos; in the above example.
We get this exception:

java.lang.ClassCastException: org.eclipse.jdt.internal.codeassist.select.SelectionOnSuperReference cannot be cast to org.eclipse.jdt.internal.compiler.ast.LambdaExpression
	at org.eclipse.jdt.internal.compiler.parser.Parser.consumeLambdaExpression(Parser.java:7975)
	at org.eclipse.jdt.internal.codeassist.select.SelectionParser.consumeLambdaExpression(SelectionParser.java:766)
	at org.eclipse.jdt.internal.compiler.parser.Parser.consumeRule(Parser.java:6827)
	at org.eclipse.jdt.internal.compiler.parser.Parser.parse(Parser.java:11023)
	at org.eclipse.jdt.internal.compiler.parser.Parser.parse(Parser.java:11271)
	at org.eclipse.jdt.internal.codeassist.select.SelectionParser.parse(SelectionParser.java:1443)
	at org.eclipse.jdt.internal.compiler.parser.Parser.parse(Parser.java:11228)
	at org.eclipse.jdt.internal.compiler.parser.Parser.dietParse(Parser.java:9649)
	at org.eclipse.jdt.internal.codeassist.select.SelectionParser.dietParse(SelectionParser.java:1278)
	at org.eclipse.jdt.internal.codeassist.SelectionEngine.select(SelectionEngine.java:887)
	at org.eclipse.jdt.internal.core.Openable.codeSelect(Openable.java:163)
	at org.eclipse.jdt.internal.core.CompilationUnit.codeSelect(CompilationUnit.java:381)
	at org.eclipse.jdt.internal.core.CompilationUnit.codeSelect(CompilationUnit.java:375)
	at org.eclipse.jdt.internal.ui.text.java.hover.AbstractJavaEditorTextHover.getJavaElementsAt(AbstractJavaEditorTextHover.java:118)
...</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>2376916</commentid>
    <comment_count>1</comment_count>
    <who name="Srikanth Sankaran">srikanth_sankaran</who>
    <bug_when>2014-03-17 21:01:27 -0400</bug_when>
    <thetext>Thanks Noopur, I&apos;ll take a look.</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>2391667</commentid>
    <comment_count>2</comment_count>
    <who name="Srikanth Sankaran">srikanth_sankaran</who>
    <bug_when>2014-04-23 01:10:58 -0400</bug_when>
    <thetext>There is no owner for code assist as of now.</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>2446200</commentid>
    <comment_count>3</comment_count>
    <who name="Srikanth Sankaran">srikanth_sankaran</who>
    <bug_when>2014-09-02 02:22:23 -0400</bug_when>
    <thetext>Fix and test released here: http://git.eclipse.org/c/jdt/eclipse.jdt.core.git/commit/?id=9c3c9a68123a2dba6c0a481afee1d6f36fcdd02a.

Basically, among the many hacks that code selection and completion are implemented
on top of, we are tripping on one where keywords are scanned as identifiers.
See SelectionScanner.scanIdentifierOrKeyword. This is an old hack that predates
Java 8 work.

This causes problems for handling LambdaExpressions which require extended
recovery. Fix involves putting in code for this case that will eliminate the
harmful effects of the hack on the AST.</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>2452654</commentid>
    <comment_count>4</comment_count>
    <who name="Manoj Palat Away Until May 11 2015">manpalat</who>
    <bug_when>2014-09-16 13:34:58 -0400</bug_when>
    <thetext>Verified Fixed for Eclipse Mars 4.5 M2 Build id: I20140915-2000</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>2478482</commentid>
    <comment_count>5</comment_count>
    <who name="Jay Arthanareeswaran">jarthana</who>
    <bug_when>2014-11-07 03:16:32 -0500</bug_when>
    <thetext>Reopening for back port</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>2478552</commentid>
    <comment_count>6</comment_count>
    <who name="Jay Arthanareeswaran">jarthana</who>
    <bug_when>2014-11-07 04:28:42 -0500</bug_when>
    <thetext>Back ported via:

http://git.eclipse.org/c/jdt/eclipse.jdt.core.git/commit/?h=R4_4_maintenance&amp;id=09002ba47c503605c7eb35a31f2f7437cf1565fd</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>2507669</commentid>
    <comment_count>7</comment_count>
    <who name="Sasikanth Bharadwaj">saammana</who>
    <bug_when>2015-01-20 03:24:17 -0500</bug_when>
    <thetext>Verified for 442 using build M-4.4.2RC1-201501141500</thetext>
  </long_desc>
      
      

    </bug>

</bugzilla>