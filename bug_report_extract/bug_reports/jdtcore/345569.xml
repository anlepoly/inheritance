<?xml version="1.0" encoding="UTF-8" standalone="yes" ?>
<!DOCTYPE bugzilla SYSTEM "https://bugs.eclipse.org/bugs/page.cgi?id=bugzilla.dtd">

<bugzilla version="4.4.7"
          urlbase="https://bugs.eclipse.org/bugs/"
          
          maintainer="webmaster@eclipse.org"
>

    <bug>
          <bug_id>345569</bug_id>
          
          <creation_ts>2011-05-12 06:34:00 -0400</creation_ts>
          <short_desc>FUP of bug 345334: CodeSnippetTest has lot of failures</short_desc>
          <delta_ts>2011-05-15 23:17:49 -0400</delta_ts>
          <reporter_accessible>1</reporter_accessible>
          <cclist_accessible>1</cclist_accessible>
          <classification_id>2</classification_id>
          <classification>Eclipse</classification>
          <product>JDT</product>
          <component>Core</component>
          <version>3.7</version>
          <rep_platform>All</rep_platform>
          <op_sys>All</op_sys>
          <bug_status>VERIFIED</bug_status>
          <resolution>FIXED</resolution>
          
          
          <bug_file_loc></bug_file_loc>
          <status_whiteboard></status_whiteboard>
          <keywords></keywords>
          <priority>P3</priority>
          <bug_severity>critical</bug_severity>
          <target_milestone>3.7 RC1</target_milestone>
          
          
          <everconfirmed>1</everconfirmed>
          <reporter name="Ayushman Jain">amj87.iitr</reporter>
          <assigned_to name="Ayushman Jain">amj87.iitr</assigned_to>
          <cc>jarthana</cc>
    
    <cc>Olivier_Thomann</cc>
    
    <cc>srikanth_sankaran</cc>
          
          <votes>0</votes>

      

      

      <flag name="review"
          id="42042"
          type_id="1"
          status="+"
          setter="jarthana"
    />

          <comment_sort_order>oldest_to_newest</comment_sort_order>  
          <long_desc isprivate="0" >
    <commentid>1928846</commentid>
    <comment_count>0</comment_count>
    <who name="Ayushman Jain">amj87.iitr</who>
    <bug_when>2011-05-12 06:34:38 -0400</bug_when>
    <thetext>After the fix for bug 345334, tests in CodeSnippetTest have started to fail because they all get the error &quot;The method run() should be tagged with @Override annotation..&quot;

There might be some deficiency in the fix. I&apos;m investigating</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>1928879</commentid>
    <comment_count>1</comment_count>
    <who name="Ayushman Jain">amj87.iitr</who>
    <bug_when>2011-05-12 07:16:30 -0400</bug_when>
    <thetext>(In reply to comment #0)
&gt; There might be some deficiency in the fix. I&apos;m investigating

I understood the problem. The tests fail in 1.5 mode because we&apos;re adding the @Override annotation in 1.6 and above only, whereas in the CodeSnippetTest.getCompilerOptions() method, we have configured the detection of @Override annotations with CompilerOptions.OPTION_ReportMissingOverrideAnnotation (which works for 1.5 as well) to ERROR. 

This becomes relevant in 1.5 scenario because the dummy class we build for the code snippet has the form 
public class CodeSnippet_3 extends GlobalVariables_3

So, basically not just the tests fail for 1.5 mode, but even the original bug has not been fixed in 1.5</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>1928883</commentid>
    <comment_count>2</comment_count>
    <who name="Ayushman Jain">amj87.iitr</who>
    <bug_when>2011-05-12 07:26:51 -0400</bug_when>
    <thetext>(In reply to comment #1)

Another problem: Configuring the 2 override detection options to ERROR is not a good idea since some code snippets may have methods that they are overriding from java.lang.Object. Eg: testFreeReturnAnonymous().

Its better to just have a separate regression test for this which tests the fix.

Patch upcoming</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>1928891</commentid>
    <comment_count>3</comment_count>
      <attachid>195489</attachid>
    <who name="Ayushman Jain">amj87.iitr</who>
    <bug_when>2011-05-12 07:42:49 -0400</bug_when>
    <thetext>Created attachment 195489
proposed fix + tests

The fix has 2 parts:
1) Add @override for 1.5 also, so that whatever the user configuration is, the code snippet runs.
2) Add separate test for the fix</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>1928917</commentid>
    <comment_count>4</comment_count>
    <who name="Jay Arthanareeswaran">jarthana</who>
    <bug_when>2011-05-12 08:32:56 -0400</bug_when>
    <thetext>+1 for the patch. 
The patch also fixes the bug #345569 in 1.5 compliance mode.</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>1928920</commentid>
    <comment_count>5</comment_count>
    <who name="Srikanth Sankaran">srikanth_sankaran</who>
    <bug_when>2011-05-12 08:41:47 -0400</bug_when>
    <thetext>Patch looks good. Ayush, Jay see if we have a chance to release this for
RC1, after all tests are found to be green.

Ayush, your initiative in resolving this is much appreciated.</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>1928968</commentid>
    <comment_count>6</comment_count>
    <who name="Olivier Thomann">Olivier_Thomann</who>
    <bug_when>2011-05-12 09:46:56 -0400</bug_when>
    <thetext>+1.
Thanks, Ayushman. I made the mistake of using -Dcompliance=1.6 when running all the tests.

Please release. We will recontribute.</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>1929049</commentid>
    <comment_count>7</comment_count>
    <who name="Ayushman Jain">amj87.iitr</who>
    <bug_when>2011-05-12 11:16:20 -0400</bug_when>
    <thetext>Released in HEAD for 3.7RC1</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>1930416</commentid>
    <comment_count>8</comment_count>
    <who name="Jay Arthanareeswaran">jarthana</who>
    <bug_when>2011-05-15 23:17:49 -0400</bug_when>
    <thetext>Verified for 3.7RC1 with build I20110514-0800.
Also verified that the reported tests are passing now.</thetext>
  </long_desc>
      
          <attachment
              isobsolete="0"
              ispatch="1"
              isprivate="0"
          >
            <attachid>195489</attachid>
            <date>2011-05-12 07:42:00 -0400</date>
            <delta_ts>2011-05-12 07:42:49 -0400</delta_ts>
            <desc>proposed fix + tests</desc>
            <filename>patch345569.txt</filename>
            <type>text/plain</type>
            <size>2881</size>
            <attacher name="Ayushman Jain">amj87.iitr</attacher>
            
              <data encoding="base64">IyMjIEVjbGlwc2UgV29ya3NwYWNlIFBhdGNoIDEuMA0KI1Agb3JnLmVjbGlwc2UuamR0LmNvcmUN
CkluZGV4OiBldmFsL29yZy9lY2xpcHNlL2pkdC9pbnRlcm5hbC9ldmFsL0NvZGVTbmlwcGV0VG9D
dU1hcHBlci5qYXZhDQo9PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09
PT09PT09PT09PT09PT09PT09PT09PT09DQpSQ1MgZmlsZTogL2N2c3Jvb3QvZWNsaXBzZS9vcmcu
ZWNsaXBzZS5qZHQuY29yZS9ldmFsL29yZy9lY2xpcHNlL2pkdC9pbnRlcm5hbC9ldmFsL0NvZGVT
bmlwcGV0VG9DdU1hcHBlci5qYXZhLHYNCnJldHJpZXZpbmcgcmV2aXNpb24gMS43MA0KZGlmZiAt
dSAtcjEuNzAgQ29kZVNuaXBwZXRUb0N1TWFwcGVyLmphdmENCi0tLSBldmFsL29yZy9lY2xpcHNl
L2pkdC9pbnRlcm5hbC9ldmFsL0NvZGVTbmlwcGV0VG9DdU1hcHBlci5qYXZhCTExIE1heSAyMDEx
IDE0OjU4OjU2IC0wMDAwCTEuNzANCisrKyBldmFsL29yZy9lY2xpcHNlL2pkdC9pbnRlcm5hbC9l
dmFsL0NvZGVTbmlwcGV0VG9DdU1hcHBlci5qYXZhCTEyIE1heSAyMDExIDExOjM4OjQ1IC0wMDAw
DQpAQCAtMTQzLDcgKzE0Myw3IEBADQogCQl9DQogCX0NCiAJLy8gcnVuKCkgbWV0aG9kIGRlY2xh
cmF0aW9uDQotCWlmICh0aGlzLmNvbXBsaWFuY2VWZXJzaW9uID49IENsYXNzRmlsZUNvbnN0YW50
cy5KREsxXzYpIHsNCisJaWYgKHRoaXMuY29tcGxpYW5jZVZlcnNpb24gPj0gQ2xhc3NGaWxlQ29u
c3RhbnRzLkpESzFfNSkgew0KIAkJYnVmZmVyLmFwcGVuZCgiQE92ZXJyaWRlICIpOyAvLyROT04t
TkxTLTEkDQogCX0NCiAJYnVmZmVyLmFwcGVuZCgicHVibGljIHZvaWQgcnVuKCkgdGhyb3dzIFRo
cm93YWJsZSB7IikuYXBwZW5kKGxpbmVTZXBhcmF0b3IpOyAvLyROT04tTkxTLTEkDQojUCBvcmcu
ZWNsaXBzZS5qZHQuY29yZS50ZXN0cy5jb21waWxlcg0KSW5kZXg6IHNyYy9vcmcvZWNsaXBzZS9q
ZHQvY29yZS90ZXN0cy9ldmFsL0NvZGVTbmlwcGV0VGVzdC5qYXZhDQo9PT09PT09PT09PT09PT09
PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09DQpSQ1Mg
ZmlsZTogL2N2c3Jvb3QvZWNsaXBzZS9vcmcuZWNsaXBzZS5qZHQuY29yZS50ZXN0cy5jb21waWxl
ci9zcmMvb3JnL2VjbGlwc2UvamR0L2NvcmUvdGVzdHMvZXZhbC9Db2RlU25pcHBldFRlc3QuamF2
YSx2DQpyZXRyaWV2aW5nIHJldmlzaW9uIDEuMjANCmRpZmYgLXUgLXIxLjIwIENvZGVTbmlwcGV0
VGVzdC5qYXZhDQotLS0gc3JjL29yZy9lY2xpcHNlL2pkdC9jb3JlL3Rlc3RzL2V2YWwvQ29kZVNu
aXBwZXRUZXN0LmphdmEJMTEgTWF5IDIwMTEgMTQ6NTg6NTYgLTAwMDAJMS4yMA0KKysrIHNyYy9v
cmcvZWNsaXBzZS9qZHQvY29yZS90ZXN0cy9ldmFsL0NvZGVTbmlwcGV0VGVzdC5qYXZhCTEyIE1h
eSAyMDExIDExOjM4OjQ2IC0wMDAwDQpAQCAtNTcsOCArNTcsNiBAQA0KIAlkZWZhdWx0T3B0aW9u
cy5wdXQoQ29tcGlsZXJPcHRpb25zLk9QVElPTl9SZXBvcnRMb2NhbFZhcmlhYmxlSGlkaW5nLCBD
b21waWxlck9wdGlvbnMuV0FSTklORyk7DQogCWRlZmF1bHRPcHRpb25zLnB1dChDb21waWxlck9w
dGlvbnMuT1BUSU9OX1JlcG9ydFVudXNlZFByaXZhdGVNZW1iZXIsIENvbXBpbGVyT3B0aW9ucy5J
R05PUkUpOw0KIAlkZWZhdWx0T3B0aW9ucy5wdXQoQ29tcGlsZXJPcHRpb25zLk9QVElPTl9SZXBv
cnRQb3NzaWJsZUFjY2lkZW50YWxCb29sZWFuQXNzaWdubWVudCwgQ29tcGlsZXJPcHRpb25zLldB
Uk5JTkcpOw0KLQlkZWZhdWx0T3B0aW9ucy5wdXQoQ29tcGlsZXJPcHRpb25zLk9QVElPTl9SZXBv
cnRNaXNzaW5nT3ZlcnJpZGVBbm5vdGF0aW9uLCBDb21waWxlck9wdGlvbnMuRVJST1IpOw0KLQlk
ZWZhdWx0T3B0aW9ucy5wdXQoQ29tcGlsZXJPcHRpb25zLk9QVElPTl9SZXBvcnRNaXNzaW5nT3Zl
cnJpZGVBbm5vdGF0aW9uRm9ySW50ZXJmYWNlTWV0aG9kSW1wbGVtZW50YXRpb24sIENvbXBpbGVy
T3B0aW9ucy5FUlJPUik7DQogCXJldHVybiBkZWZhdWx0T3B0aW9uczsNCiB9DQogLyoqDQpAQCAt
OTExLDQgKzkwOSwyMiBAQA0KIAkJdGhpcy5jb250ZXh0LnNldEltcG9ydHMobmV3IGNoYXJbMF1b
XSk7DQogCX0NCiB9DQorLyoqDQorICogaHR0cHM6Ly9idWdzLmVjbGlwc2Uub3JnL2J1Z3Mvc2hv
d19idWcuY2dpP2lkPTM0NTMzNA0KKyAqLw0KK3B1YmxpYyB2b2lkIHRlc3RCdWczNDUzMzQoKSB7
DQorCU1hcCBvcHRpb25zID0gZ2V0Q29tcGlsZXJPcHRpb25zKCk7DQorCWlmICh0aGlzLmNvbXBs
aWFuY2VMZXZlbCA9PSBDbGFzc0ZpbGVDb25zdGFudHMuSkRLMV81KSB7DQorCQlvcHRpb25zLnB1
dChDb21waWxlck9wdGlvbnMuT1BUSU9OX1JlcG9ydE1pc3NpbmdPdmVycmlkZUFubm90YXRpb24s
IENvbXBpbGVyT3B0aW9ucy5FUlJPUik7DQorCX0gZWxzZSBpZiAodGhpcy5jb21wbGlhbmNlTGV2
ZWwgPj0gQ2xhc3NGaWxlQ29uc3RhbnRzLkpESzFfNikgew0KKwkJb3B0aW9ucy5wdXQoQ29tcGls
ZXJPcHRpb25zLk9QVElPTl9SZXBvcnRNaXNzaW5nT3ZlcnJpZGVBbm5vdGF0aW9uLCBDb21waWxl
ck9wdGlvbnMuRVJST1IpOw0KKwkJb3B0aW9ucy5wdXQoQ29tcGlsZXJPcHRpb25zLk9QVElPTl9S
ZXBvcnRNaXNzaW5nT3ZlcnJpZGVBbm5vdGF0aW9uRm9ySW50ZXJmYWNlTWV0aG9kSW1wbGVtZW50
YXRpb24sIENvbXBpbGVyT3B0aW9ucy5FUlJPUik7DQorCX0NCisJZXZhbHVhdGVXaXRoRXhwZWN0
ZWREaXNwbGF5U3RyaW5nKA0KKwkJCW9wdGlvbnMsDQorCQkJYnVpbGRDaGFyQXJyYXkobmV3IFN0
cmluZ1tdIHsNCisJCQkicmV0dXJuIFwiU1VDQ0VTU1wiO1xuIiwNCisJCQl9KSwNCisJCQkiU1VD
Q0VTUyIudG9DaGFyQXJyYXkoKSk7DQorfQ0KIH0NCg==
</data>

          </attachment>
      

    </bug>

</bugzilla>