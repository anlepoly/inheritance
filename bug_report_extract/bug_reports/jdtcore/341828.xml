<?xml version="1.0" encoding="UTF-8" standalone="yes" ?>
<!DOCTYPE bugzilla SYSTEM "https://bugs.eclipse.org/bugs/page.cgi?id=bugzilla.dtd">

<bugzilla version="4.4.7"
          urlbase="https://bugs.eclipse.org/bugs/"
          
          maintainer="webmaster@eclipse.org"
>

    <bug>
          <bug_id>341828</bug_id>
          
          <creation_ts>2011-04-04 13:46:00 -0400</creation_ts>
          <short_desc>Bad secondary error for unresolved type in instanceof expression</short_desc>
          <delta_ts>2013-04-30 07:38:45 -0400</delta_ts>
          <reporter_accessible>1</reporter_accessible>
          <cclist_accessible>1</cclist_accessible>
          <classification_id>2</classification_id>
          <classification>Eclipse</classification>
          <product>JDT</product>
          <component>Core</component>
          <version>3.7</version>
          <rep_platform>PC</rep_platform>
          <op_sys>Windows 7</op_sys>
          <bug_status>VERIFIED</bug_status>
          <resolution>FIXED</resolution>
          
          
          <bug_file_loc></bug_file_loc>
          <status_whiteboard></status_whiteboard>
          <keywords></keywords>
          <priority>P3</priority>
          <bug_severity>minor</bug_severity>
          <target_milestone>4.3 M7</target_milestone>
          
          
          <everconfirmed>1</everconfirmed>
          <reporter name="Markus Keller">markus_keller</reporter>
          <assigned_to name="Jay Arthanareeswaran">jarthana</assigned_to>
          <cc>amj87.iitr</cc>
    
    <cc>jarthana</cc>
    
    <cc>Olivier_Thomann</cc>
    
    <cc>shankhba</cc>
          
          <votes>0</votes>

      

      

      

          <comment_sort_order>oldest_to_newest</comment_sort_order>  
          <long_desc isprivate="0" >
    <commentid>1908402</commentid>
    <comment_count>0</comment_count>
    <who name="Markus Keller">markus_keller</who>
    <bug_when>2011-04-04 13:46:49 -0400</bug_when>
    <thetext>HEAD

The snippet below produces 2 errors:
1) FileInputStream cannot be resolved to a type
2) Incompatible conditional operand types InputStream and FileInputStream

The second error is not interesting and should not be reported as long as the RHS of the instanceof expression is not resolved.


package xy;

import java.io.InputStream;

public class Try {
    void foo(InputStream is) {
        if (is instanceof FileInputStream)
            System.out.println(&quot;Hello&quot;);
    }
}</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>1908719</commentid>
    <comment_count>1</comment_count>
    <who name="Ayushman Jain">amj87.iitr</who>
    <bug_when>2011-04-05 07:14:58 -0400</bug_when>
    <thetext>I&apos;ll take a look</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>2236875</commentid>
    <comment_count>2</comment_count>
    <who name="Olivier Thomann">Olivier_Thomann</who>
    <bug_when>2013-03-26 14:35:59 -0400</bug_when>
    <thetext>The fix seems trivial.
If the checkedType is not a valid binding, we should not check for checkCastTypesCompatibility(..). I&apos;ll attach a patch that can be reviewed.</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>2236877</commentid>
    <comment_count>3</comment_count>
      <attachid>229063</attachid>
    <who name="Olivier Thomann">Olivier_Thomann</who>
    <bug_when>2013-03-26 14:37:43 -0400</bug_when>
    <thetext>Created attachment 229063
Proposed fix

Regression test needs to be added and all tests need to be run. We might already have a test that returns an extra secondary error.</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>2236878</commentid>
    <comment_count>4</comment_count>
    <who name="Olivier Thomann">Olivier_Thomann</who>
    <bug_when>2013-03-26 14:39:12 -0400</bug_when>
    <thetext>Jay, please review.</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>2241027</commentid>
    <comment_count>5</comment_count>
    <who name="Jay Arthanareeswaran">jarthana</who>
    <bug_when>2013-04-08 11:39:55 -0400</bug_when>
    <thetext>(In reply to comment #4)
&gt; Jay, please review.

Patch looks good, will release after running the tests.</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>2241087</commentid>
    <comment_count>6</comment_count>
    <who name="Jay Arthanareeswaran">jarthana</who>
    <bug_when>2013-04-08 13:12:19 -0400</bug_when>
    <thetext>Fix released here along with new tests:

http://git.eclipse.org/c/jdt/eclipse.jdt.core.git/commit/?id=5ccdb7e247bbbd1f8f7142380f221525938bf5a9</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>2250282</commentid>
    <comment_count>7</comment_count>
    <who name="shankha banerjee">shankhba</who>
    <bug_when>2013-04-30 05:10:57 -0400</bug_when>
    <thetext>Verified for 3.7 M7 using  build I20130428-2000.</thetext>
  </long_desc>
      
          <attachment
              isobsolete="0"
              ispatch="1"
              isprivate="0"
          >
            <attachid>229063</attachid>
            <date>2013-03-26 14:37:00 -0400</date>
            <delta_ts>2013-03-26 14:37:43 -0400</delta_ts>
            <desc>Proposed fix</desc>
            <filename>patch_341828.txt</filename>
            <type>text/plain</type>
            <size>1297</size>
            <attacher name="Olivier Thomann">Olivier_Thomann</attacher>
            
              <data encoding="base64">ZGlmZiAtLWdpdCBhL29yZy5lY2xpcHNlLmpkdC5jb3JlL2NvbXBpbGVyL29yZy9lY2xpcHNlL2pk
dC9pbnRlcm5hbC9jb21waWxlci9hc3QvSW5zdGFuY2VPZkV4cHJlc3Npb24uamF2YSBiL29yZy5l
Y2xpcHNlLmpkdC5jb3JlL2NvbXBpbGVyL29yZy9lY2xpcHNlL2pkdC9pbnRlcm5hbC9jb21waWxl
ci9hc3QvSW5zdGFuY2VPZkV4cHJlc3Npb24uamF2YQppbmRleCAzNzAzNjEyLi5iZDNjN2M0IDEw
MDY0NAotLS0gYS9vcmcuZWNsaXBzZS5qZHQuY29yZS9jb21waWxlci9vcmcvZWNsaXBzZS9qZHQv
aW50ZXJuYWwvY29tcGlsZXIvYXN0L0luc3RhbmNlT2ZFeHByZXNzaW9uLmphdmEKKysrIGIvb3Jn
LmVjbGlwc2UuamR0LmNvcmUvY29tcGlsZXIvb3JnL2VjbGlwc2UvamR0L2ludGVybmFsL2NvbXBp
bGVyL2FzdC9JbnN0YW5jZU9mRXhwcmVzc2lvbi5qYXZhCkBAIC04Nyw5ICs4NywxMiBAQAogCiAJ
aWYgKCFjaGVja2VkVHlwZS5pc1JlaWZpYWJsZSgpKSB7CiAJCXNjb3BlLnByb2JsZW1SZXBvcnRl
cigpLmlsbGVnYWxJbnN0YW5jZU9mR2VuZXJpY1R5cGUoY2hlY2tlZFR5cGUsIHRoaXMpOwotCX0g
ZWxzZSBpZiAoKGV4cHJlc3Npb25UeXBlICE9IFR5cGVCaW5kaW5nLk5VTEwgJiYgZXhwcmVzc2lv
blR5cGUuaXNCYXNlVHlwZSgpKSAvLyBkaXNhbGxvdyBhdXRvYm94aW5nCi0JCQl8fCAhY2hlY2tD
YXN0VHlwZXNDb21wYXRpYmlsaXR5KHNjb3BlLCBjaGVja2VkVHlwZSwgZXhwcmVzc2lvblR5cGUs
IG51bGwpKSB7Ci0JCXNjb3BlLnByb2JsZW1SZXBvcnRlcigpLm5vdENvbXBhdGlibGVUeXBlc0Vy
cm9yKHRoaXMsIGV4cHJlc3Npb25UeXBlLCBjaGVja2VkVHlwZSk7CisJfSBlbHNlIGlmIChjaGVj
a2VkVHlwZS5pc1ZhbGlkQmluZGluZygpKSB7CisJCS8vIGlmIG5vdCBhIHZhbGlkIGJpbmRpbmcs
IGFuIGVycm9yIGhhcyBhbHJlYWR5IGJlZW4gcmVwb3J0ZWQgZm9yIHVucmVzb2x2ZWQgdHlwZQor
CQlpZiAoKGV4cHJlc3Npb25UeXBlICE9IFR5cGVCaW5kaW5nLk5VTEwgJiYgZXhwcmVzc2lvblR5
cGUuaXNCYXNlVHlwZSgpKSAvLyBkaXNhbGxvdyBhdXRvYm94aW5nCisJCQkJfHwgIWNoZWNrQ2Fz
dFR5cGVzQ29tcGF0aWJpbGl0eShzY29wZSwgY2hlY2tlZFR5cGUsIGV4cHJlc3Npb25UeXBlLCBu
dWxsKSkgeworCQkJc2NvcGUucHJvYmxlbVJlcG9ydGVyKCkubm90Q29tcGF0aWJsZVR5cGVzRXJy
b3IodGhpcywgZXhwcmVzc2lvblR5cGUsIGNoZWNrZWRUeXBlKTsKKwkJfQogCX0KIAlyZXR1cm4g
dGhpcy5yZXNvbHZlZFR5cGUgPSBUeXBlQmluZGluZy5CT09MRUFOOwogfQ==
</data>

          </attachment>
      

    </bug>

</bugzilla>