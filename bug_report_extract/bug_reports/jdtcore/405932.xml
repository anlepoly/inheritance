<?xml version="1.0" encoding="UTF-8" standalone="yes" ?>
<!DOCTYPE bugzilla SYSTEM "https://bugs.eclipse.org/bugs/page.cgi?id=bugzilla.dtd">

<bugzilla version="4.4.7"
          urlbase="https://bugs.eclipse.org/bugs/"
          
          maintainer="webmaster@eclipse.org"
>

    <bug>
          <bug_id>405932</bug_id>
          
          <creation_ts>2013-04-17 22:07:00 -0400</creation_ts>
          <short_desc>JDT managed pre-built indexes are deleted when the project is deleted</short_desc>
          <delta_ts>2015-04-17 02:07:05 -0400</delta_ts>
          <reporter_accessible>1</reporter_accessible>
          <cclist_accessible>1</cclist_accessible>
          <classification_id>2</classification_id>
          <classification>Eclipse</classification>
          <product>JDT</product>
          <component>Core</component>
          <version>4.2.2</version>
          <rep_platform>PC</rep_platform>
          <op_sys>Windows XP</op_sys>
          <bug_status>RESOLVED</bug_status>
          <resolution>FIXED</resolution>
          
          
          <bug_file_loc></bug_file_loc>
          <status_whiteboard>To be verified for 4.5 M7</status_whiteboard>
          <keywords></keywords>
          <priority>P3</priority>
          <bug_severity>normal</bug_severity>
          <target_milestone>3.8.2+</target_milestone>
          
          
          <everconfirmed>1</everconfirmed>
          <reporter name="Troy Bishop">tjbishop</reporter>
          <assigned_to name="Jay Arthanareeswaran">jarthana</assigned_to>
          <cc>daniel_megert</cc>
    
    <cc>jarthana</cc>
          
          <votes>0</votes>

      

      

      

          <comment_sort_order>oldest_to_newest</comment_sort_order>  
          <long_desc isprivate="0" >
    <commentid>2245155</commentid>
    <comment_count>0</comment_count>
      <attachid>229839</attachid>
    <who name="Troy Bishop">tjbishop</who>
    <bug_when>2013-04-17 22:07:01 -0400</bug_when>
    <thetext>Created attachment 229839
possible patch

If the JDT index manager rebuilds a pre-built index (see bug 395897) then it is saved in the index manager with a SAVE_STATE rather than REUSE_STATE.  If a single project in the workspace uses these indexes, and is then deleted, then the underlying index is also deleted.  A pre-built index (even if rebuilt by JDT) should never be deleted programmatically by JDT.</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>2245158</commentid>
    <comment_count>1</comment_count>
    <who name="Troy Bishop">tjbishop</who>
    <bug_when>2013-04-17 22:08:39 -0400</bug_when>
    <thetext>I&apos;ve verified that the JavaSearchBugsTests and JavaIndexTests all pass with the proposed patch.

If possible, can this be added to the 4.2.2+ release?</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>2245160</commentid>
    <comment_count>2</comment_count>
    <who name="Troy Bishop">tjbishop</who>
    <bug_when>2013-04-17 22:10:58 -0400</bug_when>
    <thetext>(In reply to comment #0)
&gt; Created attachment 229839 [details]
&gt; possible patch
&gt; 
&gt; If the JDT index manager rebuilds a pre-built index (see bug 395897) then it
&gt; is saved in the index manager with a SAVE_STATE rather than REUSE_STATE.  If
&gt; a single project in the workspace uses these indexes, and is then deleted,
&gt; then the underlying index is also deleted.  A pre-built index (even if
&gt; rebuilt by JDT) should never be deleted programmatically by JDT.

Forgot to add the following... if the index was saved with a REUSE_STATE then it would not have be deleted. The proposed change basically uses the existing flag introduced in bug 395897 to determine if the index should be saved as SAVE_STATE or REUSE_STATE.</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>2246580</commentid>
    <comment_count>3</comment_count>
    <who name="Jay Arthanareeswaran">jarthana</who>
    <bug_when>2013-04-22 03:18:30 -0400</bug_when>
    <thetext>I played around with this for quite some time and can&apos;t reproduce the reported issue and here is what I tried:

1. Create two projects in a workspace, both having same external JAR in their classpath and both classpath entries have the same index_location attribute in their classpath. The pre-built index file is actually created from a different JAR and not the one it&apos;s attached to. This is just to confirm that the index is indeed is read from. Let&apos;s say the index has a type Test, which doesn&apos;t exist in the classpath.
2. Let the indexing complete and search for type &apos;Type&apos; - type Type is found.
3. Delete one of the projects and refresh.
4. Try to search for type Test and see it&apos;s still being part of the search result.

Even while debugging I didn&apos;t find the index being removed or index location being altered.

Troy, can you please correct me if I am not using the right steps? Thanks!</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>2246734</commentid>
    <comment_count>4</comment_count>
      <attachid>229960</attachid>
    <who name="Jay Arthanareeswaran">jarthana</who>
    <bug_when>2013-04-22 09:50:26 -0400</bug_when>
    <thetext>Created attachment 229960
Test project

This is the test project I used. The project has an external JAR in it&apos;s classpath with a external pre-built index, which I am going to attach next.</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>2246735</commentid>
    <comment_count>5</comment_count>
      <attachid>229961</attachid>
    <who name="Jay Arthanareeswaran">jarthana</who>
    <bug_when>2013-04-22 09:53:29 -0400</bug_when>
    <thetext>Created attachment 229961
Test jar and index used

The JAR and index files need to be extracted and the project&apos;s classpath need to be updated accordingly.</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>2252177</commentid>
    <comment_count>6</comment_count>
      <attachid>230463</attachid>
    <who name="Troy Bishop">tjbishop</who>
    <bug_when>2013-05-03 12:52:05 -0400</bug_when>
    <thetext>Created attachment 230463
updated possible patch</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>2252181</commentid>
    <comment_count>7</comment_count>
      <attachid>230464</attachid>
    <who name="Troy Bishop">tjbishop</who>
    <bug_when>2013-05-03 12:55:26 -0400</bug_when>
    <thetext>Created attachment 230464
testcase

Here is a testcase that shows two problems:

1) The index, when re-built after being deleted, is generated in the workspace after the product is restarted rather than in the specified location.
2) The pre-built index is deleted when the project is deleted.

The attached patch solves these two problems.</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>2252183</commentid>
    <comment_count>8</comment_count>
    <who name="Troy Bishop">tjbishop</who>
    <bug_when>2013-05-03 12:58:02 -0400</bug_when>
    <thetext>(In reply to comment #7)
&gt; Created attachment 230464 [details]
&gt; testcase
&gt; 
&gt; Here is a testcase that shows two problems:
&gt; 
&gt; 1) The index, when re-built after being deleted, is generated in the
&gt; workspace after the product is restarted rather than in the specified
&gt; location.
&gt; 2) The pre-built index is deleted when the project is deleted.
&gt; 
&gt; The attached patch solves these two problems.

One note: This testcase patch also introduces the Accessor class that was discussed in bug 395897 comment 53 to allow changing the static boolean field we introduced in that same bug.</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>2252185</commentid>
    <comment_count>9</comment_count>
    <who name="Troy Bishop">tjbishop</who>
    <bug_when>2013-05-03 12:59:22 -0400</bug_when>
    <thetext>I&apos;ve run all the JavaIndexTests and they all pass with this patch applied - so no (known) regressions have been introduced.</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>2273183</commentid>
    <comment_count>10</comment_count>
      <attachid>230463</attachid>
    <who name="Dani Megert">daniel_megert</who>
    <bug_when>2013-06-17 03:31:59 -0400</bug_when>
    <thetext>Comment on attachment 230463
updated possible patch

Fix looks good. I also ran all Text and JDT UI tests against it.</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>2275429</commentid>
    <comment_count>11</comment_count>
    <who name="Jay Arthanareeswaran">jarthana</who>
    <bug_when>2013-06-21 05:46:00 -0400</bug_when>
    <thetext>(In reply to comment #10)
&gt; Comment on attachment 230463 [details]
&gt; updated possible patch

Thanks Dani, just to be sure, I ran all JDT/Core tests once again with the fix for this one as well as bug 405051. The patch has been released via commit

http://git.eclipse.org/c/jdt/eclipse.jdt.core.git/commit/?h=R3_8_maintenance&amp;id=fdf1e11c6109326de5ebf367239556032171f749

Tagged and updated the map files too.</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>2275461</commentid>
    <comment_count>12</comment_count>
    <who name="Jay Arthanareeswaran">jarthana</who>
    <bug_when>2013-06-21 08:06:54 -0400</bug_when>
    <thetext>Fix has been put in master as well. But will wait and see how it plays out before applying in Kepler SR1.</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>2547621</commentid>
    <comment_count>13</comment_count>
    <who name="Jay Arthanareeswaran">jarthana</who>
    <bug_when>2015-04-17 02:07:05 -0400</bug_when>
    <thetext>There&apos;s nothing more to do here. Fix has been applied in all relevant branches.</thetext>
  </long_desc>
      
          <attachment
              isobsolete="1"
              ispatch="1"
              isprivate="0"
          >
            <attachid>229839</attachid>
            <date>2013-04-17 22:07:00 -0400</date>
            <delta_ts>2013-05-03 12:52:05 -0400</delta_ts>
            <desc>possible patch</desc>
            <filename>eclipse.jdt.core_saveindex_reuse.patch</filename>
            <type>text/plain</type>
            <size>3562</size>
            <attacher name="Troy Bishop">tjbishop</attacher>
            
              <data encoding="base64">ZGlmZiAtLWdpdCBhL29yZy5lY2xpcHNlLmpkdC5jb3JlL3NlYXJjaC9vcmcvZWNsaXBzZS9qZHQv
aW50ZXJuYWwvY29yZS9zZWFyY2gvaW5kZXhpbmcvQWRkSmFyRmlsZVRvSW5kZXguamF2YSBiL29y
Zy5lY2xpcHNlLmpkdC5jb3JlL3NlYXJjaC9vcmcvZWNsaXBzZS9qZHQvaW50ZXJuYWwvY29yZS9z
ZWFyY2gvaW5kZXhpbmcvQWRkSmFyRmlsZVRvSW5kZXguamF2YQppbmRleCA0MmYwYmI0Li41ZmZk
NWYwIDEwMDY0NAotLS0gYS9vcmcuZWNsaXBzZS5qZHQuY29yZS9zZWFyY2gvb3JnL2VjbGlwc2Uv
amR0L2ludGVybmFsL2NvcmUvc2VhcmNoL2luZGV4aW5nL0FkZEphckZpbGVUb0luZGV4LmphdmEK
KysrIGIvb3JnLmVjbGlwc2UuamR0LmNvcmUvc2VhcmNoL29yZy9lY2xpcHNlL2pkdC9pbnRlcm5h
bC9jb3JlL3NlYXJjaC9pbmRleGluZy9BZGRKYXJGaWxlVG9JbmRleC5qYXZhCkBAIC0yMzQsNyAr
MjM0LDEyIEBACiAJCQkJCQl0aGlzLm1hbmFnZXIuaW5kZXhEb2N1bWVudChlbnRyeURvY3VtZW50
LCBwYXJ0aWNpcGFudCwgaW5kZXgsIGluZGV4UGF0aCk7CiAJCQkJCX0KIAkJCQl9Ci0JCQkJdGhp
cy5tYW5hZ2VyLnNhdmVJbmRleChpbmRleCk7CisJCQkJaWYodGhpcy5mb3JjZUluZGV4VXBkYXRl
KSB7CisJCQkJCXRoaXMubWFuYWdlci5zYXZlUHJlQnVpbHRJbmRleChpbmRleCk7CisJCQkJfQor
CQkJCWVsc2UgeworCQkJCQl0aGlzLm1hbmFnZXIuc2F2ZUluZGV4KGluZGV4KTsKKwkJCQl9CiAJ
CQkJaWYgKEpvYk1hbmFnZXIuVkVSQk9TRSkKIAkJCQkJb3JnLmVjbGlwc2UuamR0LmludGVybmFs
LmNvcmUudXRpbC5VdGlsLnZlcmJvc2UoIi0+IGRvbmUgaW5kZXhpbmcgb2YgIiAvLyROT04tTkxT
LTEkCiAJCQkJCQkrIHppcC5nZXROYW1lKCkgKyAiICgiIC8vJE5PTi1OTFMtMSQKZGlmZiAtLWdp
dCBhL29yZy5lY2xpcHNlLmpkdC5jb3JlL3NlYXJjaC9vcmcvZWNsaXBzZS9qZHQvaW50ZXJuYWwv
Y29yZS9zZWFyY2gvaW5kZXhpbmcvSW5kZXhNYW5hZ2VyLmphdmEgYi9vcmcuZWNsaXBzZS5qZHQu
Y29yZS9zZWFyY2gvb3JnL2VjbGlwc2UvamR0L2ludGVybmFsL2NvcmUvc2VhcmNoL2luZGV4aW5n
L0luZGV4TWFuYWdlci5qYXZhCmluZGV4IDQ4MzRjMzIuLjI3ZDFlMDAgMTAwNjQ0Ci0tLSBhL29y
Zy5lY2xpcHNlLmpkdC5jb3JlL3NlYXJjaC9vcmcvZWNsaXBzZS9qZHQvaW50ZXJuYWwvY29yZS9z
ZWFyY2gvaW5kZXhpbmcvSW5kZXhNYW5hZ2VyLmphdmEKKysrIGIvb3JnLmVjbGlwc2UuamR0LmNv
cmUvc2VhcmNoL29yZy9lY2xpcHNlL2pkdC9pbnRlcm5hbC9jb3JlL3NlYXJjaC9pbmRleGluZy9J
bmRleE1hbmFnZXIuamF2YQpAQCAtMzA5LDkgKzMwOSwxNCBAQAogCQkJCS8vIHN1cHBvc2VkIHRv
IGJlIGluIHJldXNlIHN0YXRlIGJ1dCBlcnJvciBpbiB0aGUgaW5kZXggZmlsZSwgc28gcmVpbmRl
eC4KIAkJCQlpZiAoVkVSQk9TRSkKIAkJCQkJVXRpbC52ZXJib3NlKCItPiBjYW5ub3QgcmV1c2Ug
Z2l2ZW4gaW5kZXg6ICIraW5kZXhMb2NhdGlvbisiIHBhdGg6ICIrY29udGFpbmVyUGF0aFN0cmlu
Zyk7IC8vJE5PTi1OTFMtMSQgLy8kTk9OLU5MUy0yJAotCQkJCXRoaXMuaW5kZXhMb2NhdGlvbnMu
cHV0KGNvbnRhaW5lclBhdGgsIG51bGwpOwotCQkJCWluZGV4TG9jYXRpb24gPSBjb21wdXRlSW5k
ZXhMb2NhdGlvbihjb250YWluZXJQYXRoKTsKLQkJCQlyZWJ1aWxkSW5kZXgoaW5kZXhMb2NhdGlv
biwgY29udGFpbmVyUGF0aCk7CisJCQkJaWYoIUlTX01BTkFHSU5HX1BST0RVQ1RfSU5ERVhFU19Q
Uk9QRVJUWSkgeworCQkJCQl0aGlzLmluZGV4TG9jYXRpb25zLnB1dChjb250YWluZXJQYXRoLCBu
dWxsKTsKKwkJCQkJaW5kZXhMb2NhdGlvbiA9IGNvbXB1dGVJbmRleExvY2F0aW9uKGNvbnRhaW5l
clBhdGgpOworCQkJCQlyZWJ1aWxkSW5kZXgoaW5kZXhMb2NhdGlvbiwgY29udGFpbmVyUGF0aCk7
CisJCQkJfQorCQkJCWVsc2UgeworCQkJCQlyZWJ1aWxkSW5kZXgoaW5kZXhMb2NhdGlvbiwgY29u
dGFpbmVyUGF0aCwgdHJ1ZSk7CisJCQkJfQogCQkJCXJldHVybiBudWxsOwogCQkJfQogCQl9CkBA
IC02NDEsNiArNjQ2LDkgQEAKIAlyZXR1cm4gbnVsbDsKIH0KIHByaXZhdGUgdm9pZCByZWJ1aWxk
SW5kZXgoSW5kZXhMb2NhdGlvbiBpbmRleExvY2F0aW9uLCBJUGF0aCBjb250YWluZXJQYXRoKSB7
CisJcmVidWlsZEluZGV4KGluZGV4TG9jYXRpb24sIGNvbnRhaW5lclBhdGgsIGZhbHNlKTsKK30K
K3ByaXZhdGUgdm9pZCByZWJ1aWxkSW5kZXgoSW5kZXhMb2NhdGlvbiBpbmRleExvY2F0aW9uLCBJ
UGF0aCBjb250YWluZXJQYXRoLCBmaW5hbCBib29sZWFuIHVwZGF0ZUluZGV4KSB7CiAJT2JqZWN0
IHRhcmdldCA9IEphdmFNb2RlbC5nZXRUYXJnZXQoY29udGFpbmVyUGF0aCwgdHJ1ZSk7CiAJaWYg
KHRhcmdldCA9PSBudWxsKSByZXR1cm47CiAKQEAgLTY1Niw5ICs2NjQsOSBAQAogCX0gZWxzZSBp
ZiAodGFyZ2V0IGluc3RhbmNlb2YgSUZvbGRlcikgewogCQlyZXF1ZXN0ID0gbmV3IEluZGV4Qmlu
YXJ5Rm9sZGVyKChJRm9sZGVyKSB0YXJnZXQsIHRoaXMpOwogCX0gZWxzZSBpZiAodGFyZ2V0IGlu
c3RhbmNlb2YgSUZpbGUpIHsKLQkJcmVxdWVzdCA9IG5ldyBBZGRKYXJGaWxlVG9JbmRleCgoSUZp
bGUpIHRhcmdldCwgbnVsbCwgdGhpcyk7CisJCXJlcXVlc3QgPSBuZXcgQWRkSmFyRmlsZVRvSW5k
ZXgoKElGaWxlKSB0YXJnZXQsIG51bGwsIHRoaXMsIHVwZGF0ZUluZGV4KTsKIAl9IGVsc2UgaWYg
KHRhcmdldCBpbnN0YW5jZW9mIEZpbGUpIHsKLQkJcmVxdWVzdCA9IG5ldyBBZGRKYXJGaWxlVG9J
bmRleChjb250YWluZXJQYXRoLCBudWxsLCB0aGlzKTsKKwkJcmVxdWVzdCA9IG5ldyBBZGRKYXJG
aWxlVG9JbmRleChjb250YWluZXJQYXRoLCBudWxsLCB0aGlzLCB1cGRhdGVJbmRleCk7CiAJfQog
CWlmIChyZXF1ZXN0ICE9IG51bGwpCiAJCXJlcXVlc3QocmVxdWVzdCk7CkBAIC04NTIsNiArODYw
LDEyIEBACiAJfQogfQogcHVibGljIHZvaWQgc2F2ZUluZGV4KEluZGV4IGluZGV4KSB0aHJvd3Mg
SU9FeGNlcHRpb24geworCXNhdmVJbmRleChpbmRleCwgU0FWRURfU1RBVEUpOworfQorcHVibGlj
IHZvaWQgc2F2ZVByZUJ1aWx0SW5kZXgoSW5kZXggaW5kZXgpIHRocm93cyBJT0V4Y2VwdGlvbiB7
CisJc2F2ZUluZGV4KGluZGV4LCBSRVVTRV9TVEFURSk7Cit9CitwdWJsaWMgdm9pZCBzYXZlSW5k
ZXgoSW5kZXggaW5kZXgsIGZpbmFsIEludGVnZXIgbmV3U3RhdGUpIHRocm93cyBJT0V4Y2VwdGlv
biB7CiAJLy8gbXVzdCBoYXZlIHBlcm1pc3Npb24gdG8gd3JpdGUgZnJvbSB0aGUgd3JpdGUgbW9u
aXRvcgogCWlmIChpbmRleC5oYXNDaGFuZ2VkKCkpIHsKIAkJaWYgKFZFUkJPU0UpCkBAIC04Njgs
NyArODgyLDcgQEAKIAkJCX0KIAkJfQogCQlJbmRleExvY2F0aW9uIGluZGV4TG9jYXRpb24gPSBj
b21wdXRlSW5kZXhMb2NhdGlvbihjb250YWluZXJQYXRoKTsKLQkJdXBkYXRlSW5kZXhTdGF0ZShp
bmRleExvY2F0aW9uLCBTQVZFRF9TVEFURSk7CisJCXVwZGF0ZUluZGV4U3RhdGUoaW5kZXhMb2Nh
dGlvbiwgbmV3U3RhdGUpOwogCX0KIH0KIC8qKg==
</data>

          </attachment>
          <attachment
              isobsolete="0"
              ispatch="0"
              isprivate="0"
          >
            <attachid>229960</attachid>
            <date>2013-04-22 09:50:00 -0400</date>
            <delta_ts>2013-04-22 09:50:26 -0400</delta_ts>
            <desc>Test project</desc>
            <filename>Bug405932.zip</filename>
            <type>application/zip</type>
            <size>1393</size>
            <attacher name="Jay Arthanareeswaran">jarthana</attacher>
            
              <data encoding="base64">UEsDBBQAAAAIAMVclkIQvbdfCgEAAAMCAAAUAAAAQnVnNDA1OTMyLy5jbGFzc3BhdGh9T01PwkAU
PGPif2j2zq6cNKSVGKyJTcQEqlfyun2WhWW32Y8K/95tayOYwO3NZGbeTDw77GXUoLFCq4RM6B2J
UHFdClUl5CN/GT+Q2ePtTcwlWFuD2wQw+kOonDlGO6HKhFjDSdSS/ckuK7lWg1KbiiKXorZIt6Wj
Erzim/CdZst0PX9f5E+vi3TJ/uuEcmgUSFpi4Svqxa8TDV05UCWY8vMtP9bIMmhglY4n9P5aJSmK
odJ8yr612bHsOe+OoOVoWY7W0S0Y0oaMRjE4Z0ThHdqeOGEiBXtMSAjGw1pqDk60ixuQPtBfQuKU
MXbtT2ft+4Zgdv4rZucTLq/S3tXeDcMKobrIE39AP1BLAwQUAAAACADAmpNCJURqCcMAAACBAQAA
EgAAAEJ1ZzQwNTkzMi8ucHJvamVjdHWQ7QqCMBSGfxd0D+L/nH1BwVSo6AaqC1jzMCa6yTaly2+b
MzHo33ne8/G+Gy7eTR31oDSXIos3SRpHIKgsuWBZ/Hzc1se4yFdL3CpZATVX0FTx1thpqy6wIA3k
547t08Npt8XIs2tQ2TQgTI7RWDk1XNEe0IxeHa/LewvUUcCLXSWi9ErwkoolQGveakiq0iRUKluQ
nvgFUFMEu0EU65y3DozmAka/LkEZY1hL0ykI0wP8TzD0XQA/589NB77PnX/hB1BLAwQUAAAAAABx
V5ZCAAAAAAAAAAAAAAAAFAAAAEJ1ZzQwNTkzMi8uc2V0dGluZ3MvUEsDBBQAAAAIAPyak0LRfHly
vgAAAFYCAAAuAAAAQnVnNDA1OTMyLy5zZXR0aW5ncy9vcmcuZWNsaXBzZS5qZHQuY29yZS5wcmVm
c5WQP4sDIRDF+0C+ipAqlU2KgztCuOp6V98uc+goTw3k28cl6bPbyCDzm/cHPkqpMIWYQahHNXew
SlZ7Oh4yF4P3yn9oxmdiPKlIBMcQsECNaBTFT+Xl0bB+WqibIsLWA81xQfuNrs2ZyZ7MeSvZtVeE
a/Yu2pGhgnd8ZlOJ4kbWLUoBU1/MGvDW0wTaIQu69lHmDa7W/hxlLWQnW3Onx5fsAAvz0EnG1VFF
+w7QJrMM1yAzt9LQnvayL7OvRp9QSwMEFAAAAAAAcVeWQgAAAAAAAAAAAAAAAA4AAABCdWc0MDU5
MzIvYmluL1BLAwQUAAAAAABxV5ZCAAAAAAAAAAAAAAAADgAAAEJ1ZzQwNTkzMi9zcmMvUEsBAhQA
FAAAAAgAxVyWQhC9t18KAQAAAwIAABQAAAAAAAAAAQAgAAAAAAAAAEJ1ZzQwNTkzMi8uY2xhc3Nw
YXRoUEsBAhQAFAAAAAgAwJqTQiVEagnDAAAAgQEAABIAAAAAAAAAAQAgAAAAPAEAAEJ1ZzQwNTkz
Mi8ucHJvamVjdFBLAQIUABQAAAAAAHFXlkIAAAAAAAAAAAAAAAAUAAAAAAAAAAAAEAAAAC8CAABC
dWc0MDU5MzIvLnNldHRpbmdzL1BLAQIUABQAAAAIAPyak0LRfHlyvgAAAFYCAAAuAAAAAAAAAAEA
IAAAAGECAABCdWc0MDU5MzIvLnNldHRpbmdzL29yZy5lY2xpcHNlLmpkdC5jb3JlLnByZWZzUEsB
AhQAFAAAAAAAcVeWQgAAAAAAAAAAAAAAAA4AAAAAAAAAAAAQAAAAawMAAEJ1ZzQwNTkzMi9iaW4v
UEsBAhQAFAAAAAAAcVeWQgAAAAAAAAAAAAAAAA4AAAAAAAAAAAAQAAAAlwMAAEJ1ZzQwNTkzMi9z
cmMvUEsFBgAAAAAGAAYAmAEAAMMDAAAAAA==
</data>

          </attachment>
          <attachment
              isobsolete="0"
              ispatch="0"
              isprivate="0"
          >
            <attachid>229961</attachid>
            <date>2013-04-22 09:53:00 -0400</date>
            <delta_ts>2013-04-22 09:53:29 -0400</delta_ts>
            <desc>Test jar and index used</desc>
            <filename>Test.zip</filename>
            <type>application/zip</type>
            <size>944</size>
            <attacher name="Jay Arthanareeswaran">jarthana</attacher>
            
              <data encoding="base64">UEsDBBQAAAAIAMSZk0Lvuret0QAAAD4BAAAKAAAAVGVzdC5pbmRleGMQ9vRzcY1QCHMNCvb091Mw
1DM0MmNgYLjLwFeQna4fklpcopeck1hcDBRjY2DOzCthAAE2/6Ss1GQImxmoEMxgAamGsLISyxIh
rJzEPIgsAwMjgzhIhb6hvuKDBQ36IPM1PDXD9DP1WRjgSjggJusbwEV4wJpAqvUVEerkoepANumB
LAG7VV8frNDZGaaSkZGxBkhJArEWELMyMBelpgEZmgz8yfl5xSVFpckl+UUuqck5QMFMBj4kwSCw
wh4GjpLKglSoinkMHMWlBalQuS0AUEsDBBQAAAAIAMtYlkKZXoQwDQIAACkDAAAIAAAAdGVzdC5q
YXIL8GZmEWHg4OBgOBUxzYkBCXAysDD4uoY46nr6uen/O8XAwMwQ4M3OAZJigioJwKlZBIjhmn0d
/TzdXIND9HzdPvueOe3jrat3kddbV+vcmfObgwyuGD94WqTn5avj6XuxdBUL54zXkhoZFVY/tSye
i4s+EVedxiCa9anoYxEj2PoNmzdI2QINt4Naz8XAAHTSXjTrQa4szsssKEgt0Uc48mRWF4oqUSRV
wRBaLzknsbi4d8JGv8MGAm3/vS+3tDmcZlYofTHB6EFjb5jsiiMhByesmDv3ita6puClfEL9R1uO
HGD+ENDh3SQR0H7r092/5fPr5v75+vcj5wM2cUYri8+F7xb7f1h2K8Na2eViknb8EoNdAjcnm7g9
rRZcHZMatmznrO1rT1Z4Fjw/GiX4izv3ivPXOauMVgo66V+TVs4NLXrrflIj88PXkil35FLrOqKm
7kp8F/dW3jx7Z8ys3gqf7W+MFFkKA6fO3HX9q1pizpe85W9KedsKDB/Ufs/1/3OOo/m/WYufSVwS
R/v/FXZHrrtO33r81aSph3dWf+Wryj5m595vvMPq4YsFx9evZZpjZvmHERTAfdGdXD+AAVPDCApg
RiYRBtQYhsU9KHmgApTEgq4VOd5EULTZMmBPKiATuBhwxy8C7GFAjm2EvaD4RvaOKIquRww4Yj/A
m5UNpIAFCL8BaVmwlwFQSwECFAAUAAAACADEmZNC77q3rdEAAAA+AQAACgAAAAAAAAAAACAAAAAA
AAAAVGVzdC5pbmRleFBLAQIUABQAAAAIAMtYlkKZXoQwDQIAACkDAAAIAAAAAAAAAAAAIAAAAPkA
AAB0ZXN0LmphclBLBQYAAAAAAgACAG4AAAAsAwAAAAA=
</data>

          </attachment>
          <attachment
              isobsolete="0"
              ispatch="1"
              isprivate="0"
          >
            <attachid>230463</attachid>
            <date>2013-05-03 12:52:00 -0400</date>
            <delta_ts>2013-06-17 03:31:59 -0400</delta_ts>
            <desc>updated possible patch</desc>
            <filename>eclipse.jdt.core_saveindex_reuse.patch</filename>
            <type>text/plain</type>
            <size>4840</size>
            <attacher name="Troy Bishop">tjbishop</attacher>
            
              <data encoding="base64">ZGlmZiAtLWdpdCBhL29yZy5lY2xpcHNlLmpkdC5jb3JlL3NlYXJjaC9vcmcvZWNsaXBzZS9qZHQv
aW50ZXJuYWwvY29yZS9zZWFyY2gvaW5kZXhpbmcvQWRkSmFyRmlsZVRvSW5kZXguamF2YSBiL29y
Zy5lY2xpcHNlLmpkdC5jb3JlL3NlYXJjaC9vcmcvZWNsaXBzZS9qZHQvaW50ZXJuYWwvY29yZS9z
ZWFyY2gvaW5kZXhpbmcvQWRkSmFyRmlsZVRvSW5kZXguamF2YQppbmRleCA0MmYwYmI0Li41ZmZk
NWYwIDEwMDY0NAotLS0gYS9vcmcuZWNsaXBzZS5qZHQuY29yZS9zZWFyY2gvb3JnL2VjbGlwc2Uv
amR0L2ludGVybmFsL2NvcmUvc2VhcmNoL2luZGV4aW5nL0FkZEphckZpbGVUb0luZGV4LmphdmEK
KysrIGIvb3JnLmVjbGlwc2UuamR0LmNvcmUvc2VhcmNoL29yZy9lY2xpcHNlL2pkdC9pbnRlcm5h
bC9jb3JlL3NlYXJjaC9pbmRleGluZy9BZGRKYXJGaWxlVG9JbmRleC5qYXZhCkBAIC0yMzQsNyAr
MjM0LDEyIEBACiAJCQkJCQl0aGlzLm1hbmFnZXIuaW5kZXhEb2N1bWVudChlbnRyeURvY3VtZW50
LCBwYXJ0aWNpcGFudCwgaW5kZXgsIGluZGV4UGF0aCk7CiAJCQkJCX0KIAkJCQl9Ci0JCQkJdGhp
cy5tYW5hZ2VyLnNhdmVJbmRleChpbmRleCk7CisJCQkJaWYodGhpcy5mb3JjZUluZGV4VXBkYXRl
KSB7CisJCQkJCXRoaXMubWFuYWdlci5zYXZlUHJlQnVpbHRJbmRleChpbmRleCk7CisJCQkJfQor
CQkJCWVsc2UgeworCQkJCQl0aGlzLm1hbmFnZXIuc2F2ZUluZGV4KGluZGV4KTsKKwkJCQl9CiAJ
CQkJaWYgKEpvYk1hbmFnZXIuVkVSQk9TRSkKIAkJCQkJb3JnLmVjbGlwc2UuamR0LmludGVybmFs
LmNvcmUudXRpbC5VdGlsLnZlcmJvc2UoIi0+IGRvbmUgaW5kZXhpbmcgb2YgIiAvLyROT04tTkxT
LTEkCiAJCQkJCQkrIHppcC5nZXROYW1lKCkgKyAiICgiIC8vJE5PTi1OTFMtMSQKZGlmZiAtLWdp
dCBhL29yZy5lY2xpcHNlLmpkdC5jb3JlL3NlYXJjaC9vcmcvZWNsaXBzZS9qZHQvaW50ZXJuYWwv
Y29yZS9zZWFyY2gvaW5kZXhpbmcvSW5kZXhNYW5hZ2VyLmphdmEgYi9vcmcuZWNsaXBzZS5qZHQu
Y29yZS9zZWFyY2gvb3JnL2VjbGlwc2UvamR0L2ludGVybmFsL2NvcmUvc2VhcmNoL2luZGV4aW5n
L0luZGV4TWFuYWdlci5qYXZhCmluZGV4IDQ4MzRjMzIuLjg5MzA2NmIgMTAwNjQ0Ci0tLSBhL29y
Zy5lY2xpcHNlLmpkdC5jb3JlL3NlYXJjaC9vcmcvZWNsaXBzZS9qZHQvaW50ZXJuYWwvY29yZS9z
ZWFyY2gvaW5kZXhpbmcvSW5kZXhNYW5hZ2VyLmphdmEKKysrIGIvb3JnLmVjbGlwc2UuamR0LmNv
cmUvc2VhcmNoL29yZy9lY2xpcHNlL2pkdC9pbnRlcm5hbC9jb3JlL3NlYXJjaC9pbmRleGluZy9J
bmRleE1hbmFnZXIuamF2YQpAQCAtMzA5LDkgKzMwOSwxNCBAQAogCQkJCS8vIHN1cHBvc2VkIHRv
IGJlIGluIHJldXNlIHN0YXRlIGJ1dCBlcnJvciBpbiB0aGUgaW5kZXggZmlsZSwgc28gcmVpbmRl
eC4KIAkJCQlpZiAoVkVSQk9TRSkKIAkJCQkJVXRpbC52ZXJib3NlKCItPiBjYW5ub3QgcmV1c2Ug
Z2l2ZW4gaW5kZXg6ICIraW5kZXhMb2NhdGlvbisiIHBhdGg6ICIrY29udGFpbmVyUGF0aFN0cmlu
Zyk7IC8vJE5PTi1OTFMtMSQgLy8kTk9OLU5MUy0yJAotCQkJCXRoaXMuaW5kZXhMb2NhdGlvbnMu
cHV0KGNvbnRhaW5lclBhdGgsIG51bGwpOwotCQkJCWluZGV4TG9jYXRpb24gPSBjb21wdXRlSW5k
ZXhMb2NhdGlvbihjb250YWluZXJQYXRoKTsKLQkJCQlyZWJ1aWxkSW5kZXgoaW5kZXhMb2NhdGlv
biwgY29udGFpbmVyUGF0aCk7CisJCQkJaWYoIUlTX01BTkFHSU5HX1BST0RVQ1RfSU5ERVhFU19Q
Uk9QRVJUWSkgeworCQkJCQl0aGlzLmluZGV4TG9jYXRpb25zLnB1dChjb250YWluZXJQYXRoLCBu
dWxsKTsKKwkJCQkJaW5kZXhMb2NhdGlvbiA9IGNvbXB1dGVJbmRleExvY2F0aW9uKGNvbnRhaW5l
clBhdGgpOworCQkJCQlyZWJ1aWxkSW5kZXgoaW5kZXhMb2NhdGlvbiwgY29udGFpbmVyUGF0aCk7
CisJCQkJfQorCQkJCWVsc2UgeworCQkJCQlyZWJ1aWxkSW5kZXgoaW5kZXhMb2NhdGlvbiwgY29u
dGFpbmVyUGF0aCwgdHJ1ZSk7CisJCQkJfQogCQkJCXJldHVybiBudWxsOwogCQkJfQogCQl9CkBA
IC01NDAsOSArNTQ1LDE2IEBACiBwdWJsaWMgdm9pZCBpbmRleExpYnJhcnkoSVBhdGggcGF0aCwg
SVByb2plY3QgcmVxdWVzdGluZ1Byb2plY3QsIFVSTCBpbmRleFVSTCwgZmluYWwgYm9vbGVhbiB1
cGRhdGVJbmRleCkgewogCS8vIHJlcXVlc3RpbmdQcm9qZWN0IGlzIG5vIGxvbmdlciB1c2VkIHRv
IGNhbmNlbCBqb2JzIGJ1dCBsZWF2ZSBpdCBoZXJlIGp1c3QgaW4gY2FzZQogCUluZGV4TG9jYXRp
b24gaW5kZXhGaWxlID0gbnVsbDsKKwlib29sZWFuIGZvcmNlSW5kZXhVcGRhdGUgPSBmYWxzZTsK
IAlpZihpbmRleFVSTCAhPSBudWxsKSB7CiAJCWlmKElTX01BTkFHSU5HX1BST0RVQ1RfSU5ERVhF
U19QUk9QRVJUWSkgewogCQkJaW5kZXhGaWxlID0gY29tcHV0ZUluZGV4TG9jYXRpb24ocGF0aCwg
aW5kZXhVUkwpOworCQkJaWYoIXVwZGF0ZUluZGV4ICYmICFpbmRleEZpbGUuZXhpc3RzKCkpIHsK
KwkJCQlmb3JjZUluZGV4VXBkYXRlID0gdHJ1ZTsKKwkJCX0KKwkJCWVsc2UgeworCQkJCWZvcmNl
SW5kZXhVcGRhdGUgPSB1cGRhdGVJbmRleDsKKwkJCX0KIAkJfQogCQllbHNlIHsKIAkJCWluZGV4
RmlsZSA9IEluZGV4TG9jYXRpb24uY3JlYXRlSW5kZXhMb2NhdGlvbihpbmRleFVSTCk7CkBAIC01
NTAsNyArNTYyLDYgQEAKIAl9CiAJaWYgKEphdmFDb3JlLmdldFBsdWdpbigpID09IG51bGwpIHJl
dHVybjsKIAlJbmRleFJlcXVlc3QgcmVxdWVzdCA9IG51bGw7Ci0JYm9vbGVhbiBmb3JjZUluZGV4
VXBkYXRlID0gSVNfTUFOQUdJTkdfUFJPRFVDVF9JTkRFWEVTX1BST1BFUlRZICYmIHVwZGF0ZUlu
ZGV4OwogCU9iamVjdCB0YXJnZXQgPSBKYXZhTW9kZWwuZ2V0VGFyZ2V0KHBhdGgsIHRydWUpOwog
CWlmICh0YXJnZXQgaW5zdGFuY2VvZiBJRmlsZSkgewogCQlyZXF1ZXN0ID0gbmV3IEFkZEphckZp
bGVUb0luZGV4KChJRmlsZSkgdGFyZ2V0LCBpbmRleEZpbGUsIHRoaXMsIGZvcmNlSW5kZXhVcGRh
dGUpOwpAQCAtNjQxLDYgKzY1Miw5IEBACiAJcmV0dXJuIG51bGw7CiB9CiBwcml2YXRlIHZvaWQg
cmVidWlsZEluZGV4KEluZGV4TG9jYXRpb24gaW5kZXhMb2NhdGlvbiwgSVBhdGggY29udGFpbmVy
UGF0aCkgeworCXJlYnVpbGRJbmRleChpbmRleExvY2F0aW9uLCBjb250YWluZXJQYXRoLCBmYWxz
ZSk7Cit9Citwcml2YXRlIHZvaWQgcmVidWlsZEluZGV4KEluZGV4TG9jYXRpb24gaW5kZXhMb2Nh
dGlvbiwgSVBhdGggY29udGFpbmVyUGF0aCwgZmluYWwgYm9vbGVhbiB1cGRhdGVJbmRleCkgewog
CU9iamVjdCB0YXJnZXQgPSBKYXZhTW9kZWwuZ2V0VGFyZ2V0KGNvbnRhaW5lclBhdGgsIHRydWUp
OwogCWlmICh0YXJnZXQgPT0gbnVsbCkgcmV0dXJuOwogCkBAIC02NTYsOSArNjcwLDkgQEAKIAl9
IGVsc2UgaWYgKHRhcmdldCBpbnN0YW5jZW9mIElGb2xkZXIpIHsKIAkJcmVxdWVzdCA9IG5ldyBJ
bmRleEJpbmFyeUZvbGRlcigoSUZvbGRlcikgdGFyZ2V0LCB0aGlzKTsKIAl9IGVsc2UgaWYgKHRh
cmdldCBpbnN0YW5jZW9mIElGaWxlKSB7Ci0JCXJlcXVlc3QgPSBuZXcgQWRkSmFyRmlsZVRvSW5k
ZXgoKElGaWxlKSB0YXJnZXQsIG51bGwsIHRoaXMpOworCQlyZXF1ZXN0ID0gbmV3IEFkZEphckZp
bGVUb0luZGV4KChJRmlsZSkgdGFyZ2V0LCBudWxsLCB0aGlzLCB1cGRhdGVJbmRleCk7CiAJfSBl
bHNlIGlmICh0YXJnZXQgaW5zdGFuY2VvZiBGaWxlKSB7Ci0JCXJlcXVlc3QgPSBuZXcgQWRkSmFy
RmlsZVRvSW5kZXgoY29udGFpbmVyUGF0aCwgbnVsbCwgdGhpcyk7CisJCXJlcXVlc3QgPSBuZXcg
QWRkSmFyRmlsZVRvSW5kZXgoY29udGFpbmVyUGF0aCwgbnVsbCwgdGhpcywgdXBkYXRlSW5kZXgp
OwogCX0KIAlpZiAocmVxdWVzdCAhPSBudWxsKQogCQlyZXF1ZXN0KHJlcXVlc3QpOwpAQCAtODUx
LDYgKzg2NSwyMyBAQAogCQlyZXR1cm4gZmFsc2U7CiAJfQogfQorLyoqCisgKiB7QGxpbmsgI3Nh
dmVJbmRleChJbmRleCl9IHdpbGwgb25seSB1cGRhdGUgdGhlIHN0YXRlIGlmIHRoZXJlIGFyZSBu
byBvdGhlciBqb2JzIHJ1bm5pbmcgYWdhaW5zdCB0aGUgc2FtZQorICogdW5kZXJseWluZyByZXNv
dXJjZSBmb3IgdGhpcyBpbmRleC4gIFByZS1idWlsdCBpbmRleGVzIG11c3QgYmUgaW4gYSB7QGxp
bmsgI1JFVVNFX1NUQVRFfSBzdGF0ZSBldmVuIGlmCisgKiB0aGVyZSBpcyBhbm90aGVyIGpvYiB0
byBydW4gYWdhaW5zdCBpdCBhcyB0aGUgc3Vic2VxdWVudCBqb2Igd2lsbCBmaW5kIHRoZSBpbmRl
eCBhbmQgbm90IHNhdmUgaXQgaW4gdGhlCisgKiByaWdodCBzdGF0ZS4KKyAqIFJlZmVyIHRvIGh0
dHBzOi8vYnVncy5lY2xpcHNlLm9yZy9idWdzL3Nob3dfYnVnLmNnaT9pZD00MDU5MzIKKyAqLwor
cHVibGljIHZvaWQgc2F2ZVByZUJ1aWx0SW5kZXgoSW5kZXggaW5kZXgpIHRocm93cyBJT0V4Y2Vw
dGlvbiB7CisJaWYgKGluZGV4Lmhhc0NoYW5nZWQoKSkgeworCQlpZiAoVkVSQk9TRSkKKwkJCVV0
aWwudmVyYm9zZSgiLT4gc2F2aW5nIHByZS1idWlsZCBpbmRleCAiICsgaW5kZXguZ2V0SW5kZXhM
b2NhdGlvbigpKTsgLy8kTk9OLU5MUy0xJAorCQlpbmRleC5zYXZlKCk7CisJfQorCXN5bmNocm9u
aXplZCAodGhpcykgeworCQl1cGRhdGVJbmRleFN0YXRlKGluZGV4LmdldEluZGV4TG9jYXRpb24o
KSwgUkVVU0VfU1RBVEUpOworCX0KK30KIHB1YmxpYyB2b2lkIHNhdmVJbmRleChJbmRleCBpbmRl
eCkgdGhyb3dzIElPRXhjZXB0aW9uIHsKIAkvLyBtdXN0IGhhdmUgcGVybWlzc2lvbiB0byB3cml0
ZSBmcm9tIHRoZSB3cml0ZSBtb25pdG9yCiAJaWYgKGluZGV4Lmhhc0NoYW5nZWQoKSkgew==
</data>
<flag name="review"
          id="58569"
          type_id="6"
          status="+"
          setter="daniel_megert"
    />
          </attachment>
          <attachment
              isobsolete="0"
              ispatch="1"
              isprivate="0"
          >
            <attachid>230464</attachid>
            <date>2013-05-03 12:55:00 -0400</date>
            <delta_ts>2013-05-03 12:55:26 -0400</delta_ts>
            <desc>testcase</desc>
            <filename>eclipse.jdt.core_saveindex_reuse_test.patch</filename>
            <type>text/plain</type>
            <size>14714</size>
            <attacher name="Troy Bishop">tjbishop</attacher>
            
              <data encoding="base64">ZGlmZiAtLWdpdCBhL29yZy5lY2xpcHNlLmpkdC5jb3JlLnRlc3RzLmNvbXBpbGVyL3NyYy9vcmcv
ZWNsaXBzZS9qZHQvY29yZS90ZXN0cy91dGlsL0FjY2Vzc29yLmphdmEgYi9vcmcuZWNsaXBzZS5q
ZHQuY29yZS50ZXN0cy5jb21waWxlci9zcmMvb3JnL2VjbGlwc2UvamR0L2NvcmUvdGVzdHMvdXRp
bC9BY2Nlc3Nvci5qYXZhCm5ldyBmaWxlIG1vZGUgMTAwNjQ0CmluZGV4IDAwMDAwMDAuLjY5MDRi
ZGYKLS0tIC9kZXYvbnVsbAorKysgYi9vcmcuZWNsaXBzZS5qZHQuY29yZS50ZXN0cy5jb21waWxl
ci9zcmMvb3JnL2VjbGlwc2UvamR0L2NvcmUvdGVzdHMvdXRpbC9BY2Nlc3Nvci5qYXZhCkBAIC0w
LDAgKzEsMzgwIEBACisvKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioq
KioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKgorICogQ29weXJpZ2h0IChjKSAy
MDEzIElCTSBDb3Jwb3JhdGlvbiBhbmQgb3RoZXJzLgorICogQWxsIHJpZ2h0cyByZXNlcnZlZC4g
VGhpcyBwcm9ncmFtIGFuZCB0aGUgYWNjb21wYW55aW5nIG1hdGVyaWFscworICogYXJlIG1hZGUg
YXZhaWxhYmxlIHVuZGVyIHRoZSB0ZXJtcyBvZiB0aGUgRWNsaXBzZSBQdWJsaWMgTGljZW5zZSB2
MS4wCisgKiB3aGljaCBhY2NvbXBhbmllcyB0aGlzIGRpc3RyaWJ1dGlvbiwgYW5kIGlzIGF2YWls
YWJsZSBhdAorICogaHR0cDovL3d3dy5lY2xpcHNlLm9yZy9sZWdhbC9lcGwtdjEwLmh0bWwKKyAq
CisgKiBDb250cmlidXRvcnM6CisgKiAgICAgSUJNIENvcnBvcmF0aW9uIC0gaW5pdGlhbCBBUEkg
YW5kIGltcGxlbWVudGF0aW9uCisgKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioq
KioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKi8KK3BhY2thZ2Ugb3Jn
LmVjbGlwc2UuamR0LmNvcmUudGVzdHMudXRpbDsKKworaW1wb3J0IGphdmEubGFuZy5yZWZsZWN0
LkNvbnN0cnVjdG9yOworaW1wb3J0IGphdmEubGFuZy5yZWZsZWN0LkZpZWxkOworaW1wb3J0IGph
dmEubGFuZy5yZWZsZWN0Lkludm9jYXRpb25UYXJnZXRFeGNlcHRpb247CitpbXBvcnQgamF2YS5s
YW5nLnJlZmxlY3QuTWV0aG9kOworaW1wb3J0IGphdmEubGFuZy5yZWZsZWN0Lk1vZGlmaWVyOwor
CitpbXBvcnQgb3JnLmVjbGlwc2UuY29yZS5ydW50aW1lLkFzc2VydDsKKworCisvKioKKyAqIEhl
bHBlciBjbGFzcyBmb3IgYWNjZXNzaW5nIGNsYXNzZXMgYW5kIG1lbWJlcnMgd2hpY2ggY2Fubm90
IGJlIGFjY2Vzc2VkIHVzaW5nIHN0YW5kYXJkIEphdmEKKyAqIGFjY2VzcyBjb250cm9sIGxpa2Ug
cHJpdmF0ZSBvciBwYWNrYWdlIHZpc2libGUgZWxlbWVudHMuCisgKiA8cD4KKyAqIDxzdHJvbmc+
Tm90ZTo8L3N0cm9uZz4gQ29waWVkIGZyb20gb3JnLmVjbGlwc2UudGV4dC50ZXN0cy4KKyAqIDwv
cD4KKyAqIAorICogQHNpbmNlIDMuNQorICovCitwdWJsaWMgY2xhc3MgQWNjZXNzb3IgeworCisJ
LyoqIFRoZSBjbGFzcyB0byBhY2Nlc3MuICovCisJcHJpdmF0ZSBDbGFzcyBmQ2xhc3M7CisJLyoq
IFRoZSBpbnN0YW5jZSB0byBhY2Nlc3MuICovCisJcHJpdmF0ZSBPYmplY3QgZkluc3RhbmNlOwor
CisJLyoqCisJICogQ3JlYXRlcyBhbiBhY2Nlc3NvciBmb3IgdGhlIGdpdmVuIDxjb2RlPmluc3Rh
bmNlPC9jb2RlPiBhbmQKKwkgKiA8Y29kZT5jbGFzczwvY29kZT4uIE9ubHkgbm9uLWluaGVyaXRl
ZCBtZW1iZXJzIHRoYXQgcGFydGljdWxhcgorCSAqIDxjb2RlPmNsYXNzPC9jb2RlPiBjYW4gYmUg
YWNjZXNzZWQuCisJICoKKwkgKiBAcGFyYW0gaW5zdGFuY2UgdGhlIGluc3RhbmNlCisJICogQHBh
cmFtIGNsYXp6IHRoZSBjbGFzcworCSAqLworCXB1YmxpYyBBY2Nlc3NvcihPYmplY3QgaW5zdGFu
Y2UsIENsYXNzIGNsYXp6KSB7CisJCW9yZy5lY2xpcHNlLmNvcmUucnVudGltZS5Bc3NlcnQuaXNO
b3ROdWxsKGluc3RhbmNlKTsKKwkJQXNzZXJ0LmlzTm90TnVsbChjbGF6eik7CisJCWZJbnN0YW5j
ZT0gaW5zdGFuY2U7CisJCWZDbGFzcz0gY2xheno7CisJfQorCisJLyoqCisJICogQ3JlYXRlcyBh
biBhY2Nlc3NvciBmb3IgdGhlIGdpdmVuIDxjb2RlPmluc3RhbmNlPC9jb2RlPiBhbmQKKwkgKiA8
Y29kZT5jbGFzczwvY29kZT4uIE9ubHkgbm9uLWluaGVyaXRlZCBtZW1iZXJzIHRoYXQgcGFydGlj
dWxhcgorCSAqIDxjb2RlPmNsYXNzPC9jb2RlPiBjYW4gYmUgYWNjZXNzZWQuCisJICoKKwkgKiBA
cGFyYW0gaW5zdGFuY2UgdGhlIGluc3RhbmNlCisJICogQHBhcmFtIGNsYXNzTmFtZSB0aGUgbmFt
ZSBvZiB0aGUgY2xhc3MKKwkgKiBAcGFyYW0gY2xhc3NMb2FkZXIgdGhlIGNsYXNzIGxvYWRlciB0
byB1c2UgaS5lLiA8Y29kZT5nZXRDbGFzcygpLmdldENsYXNzTG9hZGVyKCk8L2NvZGU+CisJICov
CisJcHVibGljIEFjY2Vzc29yKE9iamVjdCBpbnN0YW5jZSwgU3RyaW5nIGNsYXNzTmFtZSwgQ2xh
c3NMb2FkZXIgY2xhc3NMb2FkZXIpIHsKKwkJQXNzZXJ0LmlzTm90TnVsbChpbnN0YW5jZSk7CisJ
CUFzc2VydC5pc05vdE51bGwoY2xhc3NOYW1lKTsKKwkJQXNzZXJ0LmlzTm90TnVsbChjbGFzc0xv
YWRlcik7CisJCWZJbnN0YW5jZT0gaW5zdGFuY2U7CisJCXRyeSB7CisJCQlmQ2xhc3M9IENsYXNz
LmZvck5hbWUoY2xhc3NOYW1lLCB0cnVlLCBjbGFzc0xvYWRlcik7CisJCX0gY2F0Y2ggKENsYXNz
Tm90Rm91bmRFeGNlcHRpb24gZSkgeworCQkJZmFpbCgpOworCQl9IGNhdGNoIChFeGNlcHRpb25J
bkluaXRpYWxpemVyRXJyb3IgZSkgeworCQkJZmFpbCgpOworCQl9CisJfQorCisJLyoqCisJICog
Q3JlYXRlcyBhbiBhY2Nlc3NvciBmb3IgdGhlIGdpdmVuIGNsYXNzLgorCSAqIDxwPgorCSAqIElu
IG9yZGVyIHRvIGdldCB0aGUgdHlwZSBpbmZvcm1hdGlvbiBmcm9tIHRoZSBnaXZlbgorCSAqIGFy
Z3VtZW50cyB0aGV5IG11c3QgYWxsIGJlIGluc3RhbmNlb2YgT2JqZWN0LiBVc2UKKwkgKiB7QGxp
bmsgI0FjY2Vzc29yKFN0cmluZywgQ2xhc3NMb2FkZXIsIENsYXNzW10sIE9iamVjdFtdKX0gaWYg
dGhpcworCSAqIGlzIG5vdCB0aGUgY2FzZS48L3A+CisJICoKKwkgKiBAcGFyYW0gY2xhc3NOYW1l
IHRoZSBuYW1lIG9mIHRoZSBjbGFzcworCSAqIEBwYXJhbSBjbGFzc0xvYWRlciB0aGUgY2xhc3Mg
bG9hZGVyIHRvIHVzZSBpLmUuIDxjb2RlPmdldENsYXNzKCkuZ2V0Q2xhc3NMb2FkZXIoKTwvY29k
ZT4KKwkgKiBAcGFyYW0gY29uc3RydWN0b3JBcmdzIHRoZSBjb25zdHJ1Y3RvciBhcmd1bWVudHMg
d2hpY2ggbXVzdCBhbGwgYmUgaW5zdGFuY2Ugb2YgT2JqZWN0CisJICovCisJcHVibGljIEFjY2Vz
c29yKFN0cmluZyBjbGFzc05hbWUsIENsYXNzTG9hZGVyIGNsYXNzTG9hZGVyLCBPYmplY3RbXSBj
b25zdHJ1Y3RvckFyZ3MpIHsKKwkJdGhpcyhjbGFzc05hbWUsIGNsYXNzTG9hZGVyLCBnZXRUeXBl
cyhjb25zdHJ1Y3RvckFyZ3MpLCBjb25zdHJ1Y3RvckFyZ3MpOworCX0KKworCS8qKgorCSAqIENy
ZWF0ZXMgYW4gYWNjZXNzb3IgZm9yIHRoZSBnaXZlbiBjbGFzcy4KKwkgKgorCSAqIEBwYXJhbSBj
bGFzc05hbWUgdGhlIG5hbWUgb2YgdGhlIGNsYXNzCisJICogQHBhcmFtIGNsYXNzTG9hZGVyIHRo
ZSBjbGFzcyBsb2FkZXIgdG8gdXNlIGkuZS4gPGNvZGU+Z2V0Q2xhc3MoKS5nZXRDbGFzc0xvYWRl
cigpPC9jb2RlPgorCSAqIEBwYXJhbSBjb25zdHJ1Y3RvclR5cGVzIHRoZSB0eXBlcyBvZiB0aGUg
Y29uc3RydWN0b3IgYXJndW1lbnRzCisJICogQHBhcmFtIGNvbnN0cnVjdG9yQXJncyB0aGUgY29u
c3RydWN0b3IgYXJndW1lbnRzCisJICovCisJcHVibGljIEFjY2Vzc29yKFN0cmluZyBjbGFzc05h
bWUsIENsYXNzTG9hZGVyIGNsYXNzTG9hZGVyLCBDbGFzc1tdIGNvbnN0cnVjdG9yVHlwZXMsIE9i
amVjdFtdIGNvbnN0cnVjdG9yQXJncykgeworCQl0cnkgeworCQkJZkNsYXNzPSBDbGFzcy5mb3JO
YW1lKGNsYXNzTmFtZSwgdHJ1ZSwgY2xhc3NMb2FkZXIpOworCQl9IGNhdGNoIChDbGFzc05vdEZv
dW5kRXhjZXB0aW9uIGUpIHsKKwkJCWZhaWwoKTsKKwkJfSBjYXRjaCAoRXhjZXB0aW9uSW5Jbml0
aWFsaXplckVycm9yIGUpIHsKKwkJCWZhaWwoKTsKKwkJfQorCQlDb25zdHJ1Y3RvciBjb25zdHJ1
Y3Rvcj0gbnVsbDsKKwkJdHJ5IHsKKwkJCWNvbnN0cnVjdG9yPSBmQ2xhc3MuZ2V0RGVjbGFyZWRD
b25zdHJ1Y3Rvcihjb25zdHJ1Y3RvclR5cGVzKTsKKwkJfSBjYXRjaCAoU2VjdXJpdHlFeGNlcHRp
b24gZTIpIHsKKwkJCWZhaWwoKTsKKwkJfSBjYXRjaCAoTm9TdWNoTWV0aG9kRXhjZXB0aW9uIGUy
KSB7CisJCQlmYWlsKCk7CisJCX0KKwkJQXNzZXJ0LmlzTm90TnVsbChjb25zdHJ1Y3Rvcik7CisJ
CWNvbnN0cnVjdG9yLnNldEFjY2Vzc2libGUodHJ1ZSk7CisJCXRyeSB7CisJCQlmSW5zdGFuY2U9
IGNvbnN0cnVjdG9yLm5ld0luc3RhbmNlKGNvbnN0cnVjdG9yQXJncyk7CisJCX0gY2F0Y2ggKEls
bGVnYWxBcmd1bWVudEV4Y2VwdGlvbiBlKSB7CisJCQlmYWlsKCk7CisJCX0gY2F0Y2ggKEludm9j
YXRpb25UYXJnZXRFeGNlcHRpb24gZSkgeworCQkJZmFpbCgpOworCQl9IGNhdGNoIChJbnN0YW50
aWF0aW9uRXhjZXB0aW9uIGUpIHsKKwkJCWZhaWwoKTsKKwkJfSBjYXRjaCAoSWxsZWdhbEFjY2Vz
c0V4Y2VwdGlvbiBlKSB7CisJCQlmYWlsKCk7CisJCX0KKwl9CisKKwkvKioKKwkgKiBDcmVhdGVz
IGFuIGFjY2Vzc29yIGZvciB0aGUgZ2l2ZW4gY2xhc3MuCisJICogPHA+CisJICogVGhpcyBjb25z
dHJ1Y3RvciBpcyB1c2VkIHRvIGFjY2VzcyBzdGF0aWMgc3R1ZmYuCisJICogPC9wPgorCSAqCisJ
ICogQHBhcmFtIGNsYXNzTmFtZSB0aGUgbmFtZSBvZiB0aGUgY2xhc3MKKwkgKiBAcGFyYW0gY2xh
c3NMb2FkZXIgdGhlIGNsYXNzIGxvYWRlciB0byB1c2UgaS5lLiA8Y29kZT5nZXRDbGFzcygpLmdl
dENsYXNzTG9hZGVyKCk8L2NvZGU+CisJICovCisJcHVibGljIEFjY2Vzc29yKFN0cmluZyBjbGFz
c05hbWUsIENsYXNzTG9hZGVyIGNsYXNzTG9hZGVyKSB7CisJCXRyeSB7CisJCQlmQ2xhc3M9IENs
YXNzLmZvck5hbWUoY2xhc3NOYW1lLCB0cnVlLCBjbGFzc0xvYWRlcik7CisJCX0gY2F0Y2ggKENs
YXNzTm90Rm91bmRFeGNlcHRpb24gZSkgeworCQkJZmFpbCgpOworCQl9IGNhdGNoIChFeGNlcHRp
b25JbkluaXRpYWxpemVyRXJyb3IgZSkgeworCQkJZmFpbCgpOworCQl9CisJfQorCisJLyoqCisJ
ICogSW52b2tlcyB0aGUgbWV0aG9kIHdpdGggdGhlIGdpdmVuIG1ldGhvZCBuYW1lIGFuZCBhcmd1
bWVudHMuCisJICogPHA+CisJICogSW4gb3JkZXIgdG8gZ2V0IHRoZSB0eXBlIGluZm9ybWF0aW9u
IGZyb20gdGhlIGdpdmVuCisJICogYXJndW1lbnRzIGFsbCB0aG9zZSBhcmd1bWVudHMgbXVzdCBi
ZSBpbnN0YW5jZSBvZiBPYmplY3QuIFVzZQorCSAqIHtAbGluayAjaW52b2tlKFN0cmluZywgQ2xh
c3NbXSwgT2JqZWN0W10pfSBpZiB0aGlzCisJICogaXMgbm90IHRoZSBjYXNlLjwvcD4KKwkgKgor
CSAqIEBwYXJhbSBtZXRob2ROYW1lIHRoZSBtZXRob2QgbmFtZQorCSAqIEBwYXJhbSBhcmd1bWVu
dHMgdGhlIG1ldGhvZCBhcmd1bWVudHMgd2hpY2ggbXVzdCBhbGwgYmUgaW5zdGFuY2Ugb2YgT2Jq
ZWN0CisJICogQHJldHVybiB0aGUgbWV0aG9kIHJldHVybiB2YWx1ZQorCSAqLworCXB1YmxpYyBP
YmplY3QgaW52b2tlKFN0cmluZyBtZXRob2ROYW1lLCBPYmplY3RbXSBhcmd1bWVudHMpIHsKKwkJ
cmV0dXJuIGludm9rZShtZXRob2ROYW1lLCBnZXRUeXBlcyhhcmd1bWVudHMpLCBhcmd1bWVudHMp
OworCX0KKworCS8qKgorCSAqIEludm9rZXMgdGhlIG1ldGhvZCB3aXRoIHRoZSBnaXZlbiBtZXRo
b2QgbmFtZSBhbmQgYXJndW1lbnRzLgorCSAqCisJICogQHBhcmFtIG1ldGhvZE5hbWUgdGhlIG1l
dGhvZCBuYW1lCisJICogQHBhcmFtIHR5cGVzIHRoZSBhcmd1bWVudCB0eXBlcworCSAqIEBwYXJh
bSBhcmd1bWVudHMgdGhlIG1ldGhvZCBhcmd1bWVudHMKKwkgKiBAcmV0dXJuIHRoZSBtZXRob2Qg
cmV0dXJuIHZhbHVlCisJICovCisJcHVibGljIE9iamVjdCBpbnZva2UoU3RyaW5nIG1ldGhvZE5h
bWUsIENsYXNzW10gdHlwZXMsIE9iamVjdFtdIGFyZ3VtZW50cykgeworCQlNZXRob2QgbWV0aG9k
PSBudWxsOworCQl0cnkgeworCQkJbWV0aG9kPSBmQ2xhc3MuZ2V0RGVjbGFyZWRNZXRob2QobWV0
aG9kTmFtZSwgdHlwZXMpOworCQl9IGNhdGNoIChTZWN1cml0eUV4Y2VwdGlvbiBlKSB7CisJCQlm
YWlsKCk7CisJCX0gY2F0Y2ggKE5vU3VjaE1ldGhvZEV4Y2VwdGlvbiBleCkgeworCQkJZmFpbCgp
OworCQl9CisJCUFzc2VydC5pc05vdE51bGwobWV0aG9kKTsKKwkJbWV0aG9kLnNldEFjY2Vzc2li
bGUodHJ1ZSk7CisJCXRyeSB7CisJCQlyZXR1cm4gbWV0aG9kLmludm9rZShmSW5zdGFuY2UsIGFy
Z3VtZW50cyk7CisJCX0gY2F0Y2ggKElsbGVnYWxBcmd1bWVudEV4Y2VwdGlvbiBlKSB7CisJCQlm
YWlsKCk7CisJCX0gY2F0Y2ggKEludm9jYXRpb25UYXJnZXRFeGNlcHRpb24gZSkgeworCQkJZmFp
bCgpOworCQl9IGNhdGNoIChJbGxlZ2FsQWNjZXNzRXhjZXB0aW9uIGUpIHsKKwkJCWZhaWwoKTsK
KwkJfQorCQlyZXR1cm4gbnVsbDsKKwl9CisKKwkvKioKKwkgKiBBc3NpZ25zIHRoZSBnaXZlbiB2
YWx1ZSB0byB0aGUgZmllbGQgd2l0aCB0aGUgZ2l2ZW4gbmFtZS4KKwkgKgorCSAqIEBwYXJhbSBm
aWVsZE5hbWUgdGhlIGZpZWxkIG5hbWUKKwkgKiBAcGFyYW0gdmFsdWUgdGhlIHZhbHVlIHRvIGFz
c2lnbiB0byB0aGUgZmllbGQKKwkgKi8KKwlwdWJsaWMgdm9pZCBzZXQoU3RyaW5nIGZpZWxkTmFt
ZSwgT2JqZWN0IHZhbHVlKSB7CisJCUZpZWxkIGZpZWxkPSBnZXRGaWVsZChmaWVsZE5hbWUpOwor
CQl0cnkgeworCQkJZmllbGQuc2V0KGZJbnN0YW5jZSwgdmFsdWUpOworCQl9IGNhdGNoIChJbGxl
Z2FsQXJndW1lbnRFeGNlcHRpb24gZSkgeworCQkJZmFpbCgpOworCQl9IGNhdGNoIChJbGxlZ2Fs
QWNjZXNzRXhjZXB0aW9uIGUpIHsKKwkJCWZhaWwoKTsKKwkJfQorCX0KKworCXB1YmxpYyB2b2lk
IHNldEZpbmFsKFN0cmluZyBmaWVsZE5hbWUsIGJvb2xlYW4gdmFsdWUpIHsKKworCQlGaWVsZCBm
aWVsZD0gZ2V0RmllbGQoZmllbGROYW1lKTsKKwkJRmllbGQgbW9kaWZpZXJzRmllbGQgPSBnZXRG
aWVsZE1vZGlmaWVycygpOworCQlib29sZWFuIGlzRmluYWwgPSBmYWxzZTsKKwkJdHJ5IHsKKwkJ
CS8vIGVuc3VyZSB0aGUgZmllbGQgaXMgbm90IGZpbmFsIHNvIHRoYXQgaXQgY2FuIGJlIG1vZGlm
aWVkCisJCQltb2RpZmllcnNGaWVsZC5zZXRBY2Nlc3NpYmxlKHRydWUpOworCQkJaXNGaW5hbCA9
IChmaWVsZC5nZXRNb2RpZmllcnMoKSAmIE1vZGlmaWVyLkZJTkFMKSA9PSBNb2RpZmllci5GSU5B
TDsKKwkJCWlmKGlzRmluYWwpIHsKKwkJCQltb2RpZmllcnNGaWVsZC5zZXRJbnQoZmllbGQsIGZp
ZWxkLmdldE1vZGlmaWVycygpICYgfk1vZGlmaWVyLkZJTkFMKTsKKwkJCX0KKwkJCWZpZWxkLnNl
dEJvb2xlYW4oZkluc3RhbmNlLCB2YWx1ZSk7CisJCX0gY2F0Y2ggKElsbGVnYWxBcmd1bWVudEV4
Y2VwdGlvbiBlKSB7CisJCQlmYWlsKCk7CisJCX0gY2F0Y2ggKElsbGVnYWxBY2Nlc3NFeGNlcHRp
b24gZSkgeworCQkJZmFpbCgpOworCQl9IGNhdGNoIChTZWN1cml0eUV4Y2VwdGlvbiBlKSB7CisJ
CQlmYWlsKCk7CisJCX0KKwkJZmluYWxseSB7CisJCQkvLyByZS1hcHBseSB0aGUgZmluYWwgbW9k
aWZpZXIKKwkJCWlmKGlzRmluYWwpIHsKKwkJCQl0cnkgeworCQkJCQltb2RpZmllcnNGaWVsZC5z
ZXRJbnQoZmllbGQsIGZpZWxkLmdldE1vZGlmaWVycygpIHwgTW9kaWZpZXIuRklOQUwpOworCQkJ
CX0gY2F0Y2ggKElsbGVnYWxBcmd1bWVudEV4Y2VwdGlvbiBlKSB7CisJCQkJCWZhaWwoKTsKKwkJ
CQl9IGNhdGNoIChJbGxlZ2FsQWNjZXNzRXhjZXB0aW9uIGUpIHsKKwkJCQkJZmFpbCgpOworCQkJ
CX0KKwkJCX0KKwkJfQorCX0KKwkKKwkvKioKKwkgKiBBc3NpZ25zIHRoZSBnaXZlbiB2YWx1ZSB0
byB0aGUgZmllbGQgd2l0aCB0aGUgZ2l2ZW4gbmFtZS4KKwkgKgorCSAqIEBwYXJhbSBmaWVsZE5h
bWUgdGhlIGZpZWxkIG5hbWUKKwkgKiBAcGFyYW0gdmFsdWUgdGhlIHZhbHVlIHRvIGFzc2lnbiB0
byB0aGUgZmllbGQKKwkgKi8KKwlwdWJsaWMgdm9pZCBzZXQoU3RyaW5nIGZpZWxkTmFtZSwgYm9v
bGVhbiB2YWx1ZSkgeworCQlGaWVsZCBmaWVsZD0gZ2V0RmllbGQoZmllbGROYW1lKTsKKwkJdHJ5
IHsKKwkJCWZpZWxkLnNldEJvb2xlYW4oZkluc3RhbmNlLCB2YWx1ZSk7CisJCX0gY2F0Y2ggKEls
bGVnYWxBcmd1bWVudEV4Y2VwdGlvbiBlKSB7CisJCQlmYWlsKCk7CisJCX0gY2F0Y2ggKElsbGVn
YWxBY2Nlc3NFeGNlcHRpb24gZSkgeworCQkJZmFpbCgpOworCQl9CisJfQorCisJLyoqCisJICog
QXNzaWducyB0aGUgZ2l2ZW4gdmFsdWUgdG8gdGhlIGZpZWxkIHdpdGggdGhlIGdpdmVuIG5hbWUu
CisJICoKKwkgKiBAcGFyYW0gZmllbGROYW1lIHRoZSBmaWVsZCBuYW1lCisJICogQHBhcmFtIHZh
bHVlIHRoZSB2YWx1ZSB0byBhc3NpZ24gdG8gdGhlIGZpZWxkCisJICovCisJcHVibGljIHZvaWQg
c2V0KFN0cmluZyBmaWVsZE5hbWUsIGludCB2YWx1ZSkgeworCQlGaWVsZCBmaWVsZD0gZ2V0Rmll
bGQoZmllbGROYW1lKTsKKwkJdHJ5IHsKKwkJCWZpZWxkLnNldEludChmSW5zdGFuY2UsIHZhbHVl
KTsKKwkJfSBjYXRjaCAoSWxsZWdhbEFyZ3VtZW50RXhjZXB0aW9uIGUpIHsKKwkJCWZhaWwoKTsK
KwkJfSBjYXRjaCAoSWxsZWdhbEFjY2Vzc0V4Y2VwdGlvbiBlKSB7CisJCQlmYWlsKCk7CisJCX0K
Kwl9CisKKwkvKioKKwkgKiBSZXR1cm5zIHRoZSB2YWx1ZSBvZiB0aGUgZmllbGQgd2l0aCB0aGUg
Z2l2ZW4gbmFtZS4KKwkgKgorCSAqIEBwYXJhbSBmaWVsZE5hbWUgdGhlIGZpZWxkIG5hbWUKKwkg
KiBAcmV0dXJuIHRoZSB2YWx1ZSBvZiB0aGUgZmllbGQKKwkgKi8KKwlwdWJsaWMgT2JqZWN0IGdl
dChTdHJpbmcgZmllbGROYW1lKSB7CisJCUZpZWxkIGZpZWxkPSBnZXRGaWVsZChmaWVsZE5hbWUp
OworCQl0cnkgeworCQkJcmV0dXJuIGZpZWxkLmdldChmSW5zdGFuY2UpOworCQl9IGNhdGNoIChJ
bGxlZ2FsQXJndW1lbnRFeGNlcHRpb24gZSkgeworCQkJZmFpbCgpOworCQl9IGNhdGNoIChJbGxl
Z2FsQWNjZXNzRXhjZXB0aW9uIGUpIHsKKwkJCWZhaWwoKTsKKwkJfQorCQkvLyBVbnJlYWNoYWJs
ZSBjb2RlCisJCXJldHVybiBudWxsOworCX0KKworCS8qKgorCSAqIFJldHVybnMgdGhlIHZhbHVl
IG9mIHRoZSBmaWVsZCB3aXRoIHRoZSBnaXZlbiBuYW1lLgorCSAqCisJICogQHBhcmFtIGZpZWxk
TmFtZSB0aGUgZmllbGQgbmFtZQorCSAqIEByZXR1cm4gdGhlIHZhbHVlIG9mIHRoZSBmaWVsZAor
CSAqLworCXB1YmxpYyBib29sZWFuIGdldEJvb2xlYW4oU3RyaW5nIGZpZWxkTmFtZSkgeworCQlG
aWVsZCBmaWVsZD0gZ2V0RmllbGQoZmllbGROYW1lKTsKKwkJdHJ5IHsKKwkJCXJldHVybiBmaWVs
ZC5nZXRCb29sZWFuKGZJbnN0YW5jZSk7CisJCX0gY2F0Y2ggKElsbGVnYWxBcmd1bWVudEV4Y2Vw
dGlvbiBlKSB7CisJCQlmYWlsKCk7CisJCX0gY2F0Y2ggKElsbGVnYWxBY2Nlc3NFeGNlcHRpb24g
ZSkgeworCQkJZmFpbCgpOworCQl9CisJCS8vIFVucmVhY2hhYmxlIGNvZGUKKwkJcmV0dXJuIGZh
bHNlOworCX0KKworCS8qKgorCSAqIFJldHVybnMgdGhlIHZhbHVlIG9mIHRoZSBmaWVsZCB3aXRo
IHRoZSBnaXZlbiBuYW1lLgorCSAqCisJICogQHBhcmFtIGZpZWxkTmFtZSB0aGUgZmllbGQgbmFt
ZQorCSAqIEByZXR1cm4gdGhlIHZhbHVlIG9mIHRoZSBmaWVsZAorCSAqLworCXB1YmxpYyBpbnQg
Z2V0SW50KFN0cmluZyBmaWVsZE5hbWUpIHsKKwkJRmllbGQgZmllbGQ9IGdldEZpZWxkKGZpZWxk
TmFtZSk7CisJCXRyeSB7CisJCQlyZXR1cm4gZmllbGQuZ2V0SW50KGZJbnN0YW5jZSk7CisJCX0g
Y2F0Y2ggKElsbGVnYWxBcmd1bWVudEV4Y2VwdGlvbiBlKSB7CisJCQlmYWlsKCk7CisJCX0gY2F0
Y2ggKElsbGVnYWxBY2Nlc3NFeGNlcHRpb24gZSkgeworCQkJZmFpbCgpOworCQl9CisJCS8vIFVu
cmVhY2hhYmxlIGNvZGUKKwkJcmV0dXJuIDA7CisJfQorCisJcHJpdmF0ZSBGaWVsZCBnZXRGaWVs
ZE1vZGlmaWVycygpIHsKKwkJRmllbGQgZmllbGQ9IG51bGw7CisJCXRyeSB7CisJCQlmaWVsZD0g
RmllbGQuY2xhc3MuZ2V0RGVjbGFyZWRGaWVsZCgibW9kaWZpZXJzIik7CisJCX0gY2F0Y2ggKFNl
Y3VyaXR5RXhjZXB0aW9uIGUpIHsKKwkJCWZhaWwoKTsKKwkJfSBjYXRjaCAoTm9TdWNoRmllbGRF
eGNlcHRpb24gZSkgeworCQkJZmFpbCgpOworCQl9CisJCXJldHVybiBmaWVsZDsKKwl9CisJCisJ
cHJpdmF0ZSBGaWVsZCBnZXRGaWVsZChTdHJpbmcgZmllbGROYW1lKSB7CisJCUZpZWxkIGZpZWxk
PSBudWxsOworCQl0cnkgeworCQkJZmllbGQ9IGZDbGFzcy5nZXREZWNsYXJlZEZpZWxkKGZpZWxk
TmFtZSk7CisJCX0gY2F0Y2ggKFNlY3VyaXR5RXhjZXB0aW9uIGUpIHsKKwkJCWZhaWwoKTsKKwkJ
fSBjYXRjaCAoTm9TdWNoRmllbGRFeGNlcHRpb24gZSkgeworCQkJZmFpbCgpOworCQl9CisJCWZp
ZWxkLnNldEFjY2Vzc2libGUodHJ1ZSk7CisJCXJldHVybiBmaWVsZDsKKwl9CisJCisJcHJpdmF0
ZSBzdGF0aWMgQ2xhc3NbXSBnZXRUeXBlcyhPYmplY3RbXSBvYmplY3RzKSB7CisJCWlmIChvYmpl
Y3RzID09IG51bGwpCisJCQlyZXR1cm4gbnVsbDsKKworCQlpbnQgbGVuZ3RoPSBvYmplY3RzLmxl
bmd0aDsKKwkJQ2xhc3NbXSBjbGFzc2VzPSBuZXcgQ2xhc3NbbGVuZ3RoXTsKKwkJZm9yIChpbnQg
aT0gMDsgaSA8IGxlbmd0aDsgaSsrKSB7CisJCQlBc3NlcnQuaXNOb3ROdWxsKG9iamVjdHNbaV0p
OworCQkJY2xhc3Nlc1tpXT0gb2JqZWN0c1tpXS5nZXRDbGFzcygpOworCQl9CisJCXJldHVybiBj
bGFzc2VzOworCX0KKworCXByaXZhdGUgdm9pZCBmYWlsKCkgeworCQlBc3NlcnQuaXNUcnVlKGZh
bHNlKTsKKwl9Cit9CmRpZmYgLS1naXQgYS9vcmcuZWNsaXBzZS5qZHQuY29yZS50ZXN0cy5tb2Rl
bC9zcmMvb3JnL2VjbGlwc2UvamR0L2NvcmUvdGVzdHMvbW9kZWwvSmF2YUluZGV4VGVzdHMuamF2
YSBiL29yZy5lY2xpcHNlLmpkdC5jb3JlLnRlc3RzLm1vZGVsL3NyYy9vcmcvZWNsaXBzZS9qZHQv
Y29yZS90ZXN0cy9tb2RlbC9KYXZhSW5kZXhUZXN0cy5qYXZhCmluZGV4IDE4OTNkM2YuLjE0Yjcy
OTQgMTAwNjQ0Ci0tLSBhL29yZy5lY2xpcHNlLmpkdC5jb3JlLnRlc3RzLm1vZGVsL3NyYy9vcmcv
ZWNsaXBzZS9qZHQvY29yZS90ZXN0cy9tb2RlbC9KYXZhSW5kZXhUZXN0cy5qYXZhCisrKyBiL29y
Zy5lY2xpcHNlLmpkdC5jb3JlLnRlc3RzLm1vZGVsL3NyYy9vcmcvZWNsaXBzZS9qZHQvY29yZS90
ZXN0cy9tb2RlbC9KYXZhSW5kZXhUZXN0cy5qYXZhCkBAIC0xLDUgKzEsNSBAQAogLyoqKioqKioq
KioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioq
KioqKioqKioqKioqKioKLSAqIENvcHlyaWdodCAoYykgMjAxMiBJQk0gQ29ycG9yYXRpb24gYW5k
IG90aGVycy4KKyAqIENvcHlyaWdodCAoYykgMjAxMiwgMjAxMyBJQk0gQ29ycG9yYXRpb24gYW5k
IG90aGVycy4KICAqIEFsbCByaWdodHMgcmVzZXJ2ZWQuIFRoaXMgcHJvZ3JhbSBhbmQgdGhlIGFj
Y29tcGFueWluZyBtYXRlcmlhbHMKICAqIGFyZSBtYWRlIGF2YWlsYWJsZSB1bmRlciB0aGUgdGVy
bXMgb2YgdGhlIEVjbGlwc2UgUHVibGljIExpY2Vuc2UgdjEuMAogICogd2hpY2ggYWNjb21wYW5p
ZXMgdGhpcyBkaXN0cmlidXRpb24sIGFuZCBpcyBhdmFpbGFibGUgYXQKQEAgLTI4LDExICsyOCwx
MyBAQAogaW1wb3J0IG9yZy5lY2xpcHNlLmpkdC5jb3JlLklKYXZhRWxlbWVudDsKIGltcG9ydCBv
cmcuZWNsaXBzZS5qZHQuY29yZS5JSmF2YVByb2plY3Q7CiBpbXBvcnQgb3JnLmVjbGlwc2UuamR0
LmNvcmUuSmF2YUNvcmU7Ci1pbXBvcnQgb3JnLmVjbGlwc2UuamR0LmNvcmUuaW5kZXguKjsKK2lt
cG9ydCBvcmcuZWNsaXBzZS5qZHQuY29yZS5pbmRleC5KYXZhSW5kZXhlcjsKIGltcG9ydCBvcmcu
ZWNsaXBzZS5qZHQuY29yZS5zZWFyY2guU2VhcmNoRW5naW5lOworaW1wb3J0IG9yZy5lY2xpcHNl
LmpkdC5jb3JlLnRlc3RzLnV0aWwuQWNjZXNzb3I7CiBpbXBvcnQgb3JnLmVjbGlwc2UuamR0LmNv
cmUudGVzdHMudXRpbC5VdGlsOwogaW1wb3J0IG9yZy5lY2xpcHNlLmpkdC5pbnRlcm5hbC5jb3Jl
LkphdmFNb2RlbE1hbmFnZXI7CiBpbXBvcnQgb3JnLmVjbGlwc2UuamR0LmludGVybmFsLmNvcmUu
VXNlckxpYnJhcnlDbGFzc3BhdGhDb250YWluZXI7CitpbXBvcnQgb3JnLmVjbGlwc2UuamR0Lmlu
dGVybmFsLmNvcmUuc2VhcmNoLmluZGV4aW5nLkluZGV4TWFuYWdlcjsKIGltcG9ydCBvcmcub3Nn
aS5zZXJ2aWNlLnByZWZzLkJhY2tpbmdTdG9yZUV4Y2VwdGlvbjsKIAogcHVibGljIGNsYXNzIEph
dmFJbmRleFRlc3RzIGV4dGVuZHMgQWJzdHJhY3RKYXZhU2VhcmNoVGVzdHMgIHsKQEAgLTg2Myw0
ICs4NjUsNTMgQEAKIAkJCWRlbGV0ZVByb2plY3QoIkZvckluZGV4Iik7CiAJCX0KIAl9Ci19CisK
KwlwdWJsaWMgdm9pZCB0ZXN0RGVsZXRlTWFuYWdlZFByZUJ1aWxkSW5kZXhGaWxlKCkgdGhyb3dz
IENvcmVFeGNlcHRpb24sCisJCQlJT0V4Y2VwdGlvbiB7CisKKwkJLy8gY3JlYXRlIHRoZSBwcmUt
YnVpbHQgaW5kZXgKKwkJRmlsZSBpbmRleEZpbGUgPSBudWxsOworCQlTdHJpbmcgamFyRmlsZVBh
dGggPSBnZXRFeHRlcm5hbFJlc291cmNlUGF0aCgiVGVzdC5qYXIiKTsKKwkJSUphdmFQcm9qZWN0
IHAgPSBudWxsOworCQkvLyBlbmFibGUgSkRUIG1hbmFnZSBwcm9kdWN0IGluZGV4IGZsYWcKKwkJ
QWNjZXNzb3IgYWNjZXNzb3IgPSBuZXcgQWNjZXNzb3IoSmF2YU1vZGVsTWFuYWdlci5nZXRJbmRl
eE1hbmFnZXIoKSwgSW5kZXhNYW5hZ2VyLmNsYXNzKTsKKwkJYWNjZXNzb3Iuc2V0RmluYWwoIklT
X01BTkFHSU5HX1BST0RVQ1RfSU5ERVhFU19QUk9QRVJUWSIsIEJvb2xlYW4uVFJVRS5ib29sZWFu
VmFsdWUoKSk7CisJCXRyeSB7CisJCQljcmVhdGVKYXIobmV3IFN0cmluZ1tdIHsKKwkJCQkJInBr
Zy9UZXN0LmphdmEiLAorCQkJCQkicGFja2FnZSBwa2c7XG4iICsgInB1YmxpYyBjbGFzcyBUZXN0
IHtcbiIKKwkJCQkJCQkrICIgIHByb3RlY3RlZCBUZXN0KCkge31cbiIKKwkJCQkJCQkrICIgIHBy
b3RlY3RlZCB2b2lkIGhlbGxvV29ybGQoKSB7fVxuIiArICJ9IiB9LAorCQkJCQlqYXJGaWxlUGF0
aCk7CisJCQlpbmRleEZpbGUgPSBuZXcgRmlsZShnZXRFeHRlcm5hbFJlc291cmNlUGF0aCgiVGVz
dC5pbmRleCIpKTsKKwkJCUphdmFJbmRleGVyLmdlbmVyYXRlSW5kZXhGb3JKYXIoamFyRmlsZVBh
dGgsIGluZGV4RmlsZS5nZXRBYnNvbHV0ZVBhdGgoKSk7CisJCQkvLyBjcmVhdGUgcHJvamVjdCBQ
IGFuZCBhZGQgdGhlIFRlc3QuamFyIHRvIHRoZSBjbGFzc3BhdGggKGFzc29jaWF0ZSB0aGUgaW5k
ZXggdG8gaXQpCisJCQlwID0gY3JlYXRlSmF2YVByb2plY3QoIlAiKTsKKwkJCVBhdGggbGliUGF0
aCA9IG5ldyBQYXRoKGphckZpbGVQYXRoKTsKKwkJCUlDbGFzc3BhdGhBdHRyaWJ1dGUgYXR0cmli
dXRlID0gSmF2YUNvcmUubmV3Q2xhc3NwYXRoQXR0cmlidXRlKAorCQkJCQlJQ2xhc3NwYXRoQXR0
cmlidXRlLklOREVYX0xPQ0FUSU9OX0FUVFJJQlVURV9OQU1FLAorCQkJCQlpbmRleEZpbGUudG9V
UkkoKS50b1VSTCgpLnRvU3RyaW5nKCkpOworCQkJSUNsYXNzcGF0aEVudHJ5IGVudHJ5ID0gSmF2
YUNvcmUubmV3TGlicmFyeUVudHJ5KGxpYlBhdGgsIG51bGwsCisJCQkJCW51bGwsIG51bGwsIG5l
dyBJQ2xhc3NwYXRoQXR0cmlidXRlW10geyBhdHRyaWJ1dGUgfSwgZmFsc2UpOworCQkJdGhpcy5z
ZXRDbGFzc3BhdGgocCwgbmV3IElDbGFzc3BhdGhFbnRyeVtdIHsgZW50cnkgfSk7CisJCQlBYnN0
cmFjdEphdmFNb2RlbFRlc3RzLndhaXRVbnRpbEluZGV4ZXNSZWFkeSgpOworCQkJLy8gZGVsZXRl
IHRoZSBpbmRleCBmaWxlIG9uIGRpc2sKKwkJCWJvb2xlYW4gaW5kZXhEZWxldGVkID0gaW5kZXhG
aWxlLmRlbGV0ZSgpOworCQkJYXNzZXJ0VHJ1ZShpbmRleERlbGV0ZWQpOworCQkJLy8gcmVzdGFy
dCAtIHRoaXMgc2hvdWxkIGNhdXNlIHRoZSBwcmUtYnVpbHQgaW5kZXggdGhhdCB3YXMgZGVsZXRl
ZCB0byBiZSByZS1jb25zdHJ1Y3RlZCBpbiB0aGUgc2FtZSBsb2NhdGlvbgorCQkJdGhpcy5zaW11
bGF0ZUV4aXRSZXN0YXJ0KCk7CisJCQlKYXZhQ29yZS5pbml0aWFsaXplQWZ0ZXJMb2FkKG51bGwp
OworCQkJQWJzdHJhY3RKYXZhTW9kZWxUZXN0cy53YWl0VW50aWxJbmRleGVzUmVhZHkoKTsKKwkJ
CWFzc2VydFRydWUoaW5kZXhGaWxlLmV4aXN0cygpKTsKKwkJCS8vIGRlbGV0ZSB0aGUgcHJvamVj
dCAtIHRoaXMgc2hvdWxkIGNhdXNlIHRoZSBwcmUtYnVpbHQgaW5kZXggdG8gTk9UIGJlIGRlbGV0
ZWQKKwkJCWlmIChwICE9IG51bGwpIHsKKwkJCQlkZWxldGVQcm9qZWN0KCJQIik7CisJCQl9CisJ
CQlBYnN0cmFjdEphdmFNb2RlbFRlc3RzLndhaXRVbnRpbEluZGV4ZXNSZWFkeSgpOworCQkJYXNz
ZXJ0VHJ1ZShpbmRleEZpbGUuZXhpc3RzKCkpOworCQl9CisJCWZpbmFsbHkgeworCQkJYWNjZXNz
b3Iuc2V0RmluYWwoIklTX01BTkFHSU5HX1BST0RVQ1RfSU5ERVhFU19QUk9QRVJUWSIsIEJvb2xl
YW4uRkFMU0UuYm9vbGVhblZhbHVlKCkpOworCQl9CisJfQorfQpcIE5vIG5ld2xpbmUgYXQgZW5k
IG9mIGZpbGU=
</data>

          </attachment>
      

    </bug>

</bugzilla>