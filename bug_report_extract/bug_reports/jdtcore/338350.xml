<?xml version="1.0" encoding="UTF-8" standalone="yes" ?>
<!DOCTYPE bugzilla SYSTEM "https://bugs.eclipse.org/bugs/page.cgi?id=bugzilla.dtd">

<bugzilla version="4.4.7"
          urlbase="https://bugs.eclipse.org/bugs/"
          
          maintainer="webmaster@eclipse.org"
>

    <bug>
          <bug_id>338350</bug_id>
          
          <creation_ts>2011-02-27 14:28:00 -0500</creation_ts>
          <short_desc>COMPILER_PB_UNAVOIDABLE_GENERIC_TYPE_PROBLEMS wrongly suppresses &quot;Unchecked cast&quot;</short_desc>
          <delta_ts>2013-08-08 05:32:15 -0400</delta_ts>
          <reporter_accessible>1</reporter_accessible>
          <cclist_accessible>1</cclist_accessible>
          <classification_id>2</classification_id>
          <classification>Eclipse</classification>
          <product>JDT</product>
          <component>Core</component>
          <version>3.7</version>
          <rep_platform>PC</rep_platform>
          <op_sys>Windows 7</op_sys>
          <bug_status>VERIFIED</bug_status>
          <resolution>FIXED</resolution>
          
          
          <bug_file_loc></bug_file_loc>
          <status_whiteboard></status_whiteboard>
          <keywords></keywords>
          <priority>P3</priority>
          <bug_severity>normal</bug_severity>
          <target_milestone>4.4 M1</target_milestone>
          
          
          <everconfirmed>1</everconfirmed>
          <reporter name="Markus Keller">markus_keller</reporter>
          <assigned_to name="Markus Keller">markus_keller</assigned_to>
          <cc>amj87.iitr</cc>
    
    <cc>anchakrk</cc>
    
    <cc>daniel_megert</cc>
    
    <cc>jarthana</cc>
    
    <cc>john_arthorne</cc>
    
    <cc>manpalat</cc>
    
    <cc>markus_keller</cc>
    
    <cc>srikanth_sankaran</cc>
    
    <cc>stephan.herrmann</cc>
          
          <votes>0</votes>

      

      

      

          <comment_sort_order>oldest_to_newest</comment_sort_order>  
          <long_desc isprivate="0" >
    <commentid>1889936</commentid>
    <comment_count>0</comment_count>
    <who name="Markus Keller">markus_keller</who>
    <bug_when>2011-02-27 14:28:56 -0500</bug_when>
    <thetext>COMPILER_PB_UNAVOIDABLE_GENERIC_TYPE_PROBLEMS wrongly suppresses &quot;Unchecked cast&quot; problems:

package xy;
import java.lang.reflect.Array;
import java.util.List;
public class Try&lt;E&gt; {

    void fooObj() {
        takeObj((E) Bar.getObject());
        takeObj((E) Bar.getArray());
        takeObj((E) Array.newInstance(Integer.class, 2));
    }

    void takeObj(E obj) {
    }

    void fooArray() {
        takeArray((E[]) Bar.getArray());
        takeArray((E[]) Array.newInstance(Integer.class, 2));
    }

    void takeArray(E[] array) {
    }

    &lt;L&gt; void foo(List&lt;L&gt; list) {
        list.toArray((L[]) Bar.getArray());
        list.toArray((L[]) Array.newInstance(Integer.class, 2));
    }
}

package xy;
import java.lang.reflect.Array;
public class Bar {
    
    public static Object getObject() {
        return new Object();
    }

    public static Object[] getArray() {
        return (Object[]) Array.newInstance(Integer.class, 2);
    }
}

All casts to E[] and E generate &quot;Type safety: Unchecked cast ...&quot; problems, and all these problems should stay even if unavoidable problems are suppressed.
These problems cannot be solved by generifying anything.</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>1906333</commentid>
    <comment_count>1</comment_count>
    <who name="Srikanth Sankaran">srikanth_sankaran</who>
    <bug_when>2011-03-31 02:19:32 -0400</bug_when>
    <thetext>This will have to wait a bit as I am busy
with other Java 7 related deliverables.</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>2289606</commentid>
    <comment_count>2</comment_count>
    <who name="Markus Keller">markus_keller</who>
    <bug_when>2013-07-30 07:14:19 -0400</bug_when>
    <thetext>Fixed with http://git.eclipse.org/c/jdt/eclipse.jdt.core.git/commit/?id=404a2ab8d95764fff1652dfbb3727308f694ee0d</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>2289740</commentid>
    <comment_count>3</comment_count>
    <who name="John Arthorne">john_arthorne</who>
    <bug_when>2013-07-30 11:03:36 -0400</bug_when>
    <thetext>(In reply to comment #0)
&gt; All casts to E[] and E generate &quot;Type safety: Unchecked cast ...&quot; problems,
&gt; and all these problems should stay even if unavoidable problems are
&gt; suppressed. These problems cannot be solved by generifying anything.

I didn&apos;t quite follow your reasoning. You say this class of problems cannot be solved by generifying, but they should not be suppressed as &quot;unavoidable problems&quot;. To me &quot;cannot be solved&quot; and &quot;unavoidable&quot; sound like the same thing. Maybe I am just misunderstanding what you are proposing here.</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>2289784</commentid>
    <comment_count>4</comment_count>
    <who name="Markus Keller">markus_keller</who>
    <bug_when>2013-07-30 12:18:41 -0400</bug_when>
    <thetext>(In reply to comment #3)
When re-reading the documentation for this option, I found that it misses the important restriction &quot;unavoidable *due to raw APIs*&quot;.

Filed bug 414033 to explain the reasoning and to fix the docs.</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>2289813</commentid>
    <comment_count>5</comment_count>
    <who name="John Arthorne">john_arthorne</who>
    <bug_when>2013-07-30 13:28:48 -0400</bug_when>
    <thetext>That explains it, thanks. Unavoidable really means &quot;unavoidable because I am referring to an API that does not use generics&quot;.</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>2290652</commentid>
    <comment_count>6</comment_count>
    <who name="Stephan Herrmann">stephan.herrmann</who>
    <bug_when>2013-08-01 11:33:22 -0400</bug_when>
    <thetext>Note that the latest commit left a dangling

  TESTS_NAMES = new String[] { &quot;test338350&quot; };

=&gt; most of the tests are disabled.

I&apos;ve fixed this via bug 413958 :)</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>2291413</commentid>
    <comment_count>7</comment_count>
    <who name="ANIRBAN CHAKRABORTY">anchakrk</who>
    <bug_when>2013-08-05 04:12:49 -0400</bug_when>
    <thetext>Verified for eclipse-SDK-I20130730-0800.</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>2291786</commentid>
    <comment_count>8</comment_count>
    <who name="Manoj Palat Away Until May 11 2015">manpalat</who>
    <bug_when>2013-08-06 07:18:56 -0400</bug_when>
    <thetext>(In reply to comment #7)
&gt; Verified for eclipse-SDK-I20130730-0800.

which is Eclipse Luna 4.4M1</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>2292664</commentid>
    <comment_count>9</comment_count>
    <who name="Markus Keller">markus_keller</who>
    <bug_when>2013-08-08 05:32:15 -0400</bug_when>
    <thetext>(In reply to comment #6)
&gt; =&gt; most of the tests are disabled.

Thanks for cleaning up! The tests still ran in the build, since the static initializer in RunComparableTests resets the TestCase.TESTS_* global variables.</thetext>
  </long_desc>
      
      

    </bug>

</bugzilla>