<?xml version="1.0" encoding="UTF-8" standalone="yes" ?>
<!DOCTYPE bugzilla SYSTEM "https://bugs.eclipse.org/bugs/page.cgi?id=bugzilla.dtd">

<bugzilla version="4.4.7"
          urlbase="https://bugs.eclipse.org/bugs/"
          
          maintainer="webmaster@eclipse.org"
>

    <bug>
          <bug_id>426459</bug_id>
          
          <creation_ts>2014-01-23 09:47:00 -0500</creation_ts>
          <short_desc>[1.8][dom ast] ITypeBinding#createArrayType(int) should preserve existing type annotations</short_desc>
          <delta_ts>2014-02-21 03:32:25 -0500</delta_ts>
          <reporter_accessible>1</reporter_accessible>
          <cclist_accessible>1</cclist_accessible>
          <classification_id>2</classification_id>
          <classification>Eclipse</classification>
          <product>JDT</product>
          <component>Core</component>
          <version>4.4</version>
          <rep_platform>All</rep_platform>
          <op_sys>All</op_sys>
          <bug_status>VERIFIED</bug_status>
          <resolution>FIXED</resolution>
          
          
          <bug_file_loc></bug_file_loc>
          <status_whiteboard></status_whiteboard>
          <keywords></keywords>
          <priority>P3</priority>
          <bug_severity>minor</bug_severity>
          <target_milestone>BETA J8</target_milestone>
          
          
          <everconfirmed>1</everconfirmed>
          <reporter name="Markus Keller">markus_keller</reporter>
          <assigned_to name="Jay Arthanareeswaran">jarthana</assigned_to>
          <cc>manpalat</cc>
    
    <cc>srikanth_sankaran</cc>
          
          <votes>0</votes>

      

      

      <flag name="review"
          id="61529"
          type_id="1"
          status="+"
          setter="srikanth_sankaran"
    />

          <comment_sort_order>oldest_to_newest</comment_sort_order>  
          <long_desc isprivate="0" >
    <commentid>2353533</commentid>
    <comment_count>0</comment_count>
    <who name="Markus Keller">markus_keller</who>
    <bug_when>2014-01-23 09:47:03 -0500</bug_when>
    <thetext>ITypeBinding#createArrayType(int) should preserve existing type annotations. 

For primitive types, it currently strips all type annotations. For other types, it preserves annotations on the element types but not on dimensions.


Example code to play in the ASTView:

import java.lang.annotation.ElementType;
import java.lang.annotation.Target;

@Target(ElementType.TYPE_USE)  
@interface A {
    int value() default 0;
}

class Test {
    @A int @A(1)[] @A(2)[] is;
    @A String @A(1)[] @A(2)[] ss;
}</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>2357650</commentid>
    <comment_count>1</comment_count>
      <attachid>239560</attachid>
    <who name="Jay Arthanareeswaran">jarthana</who>
    <bug_when>2014-02-02 12:20:53 -0500</bug_when>
    <thetext>Created attachment 239560
Draft patch

Draft patch with test. Largely untested as I have completely removed the existing code. I initially thought of a JLS8 only fix, but primitive types loosing annotations IS a bug anyway and we might as well fix that as well. 

At the moment I don&apos;t know if there are any side effects of re using the same type binding. The other option would be get the unannotated binding and recreating a new annotated binding all over again. But the patch doesn&apos;t bother with that right now.</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>2358562</commentid>
    <comment_count>2</comment_count>
    <who name="Jay Arthanareeswaran">jarthana</who>
    <bug_when>2014-02-04 10:19:04 -0500</bug_when>
    <thetext>(In reply to Jayaprakash Arthanareeswaran from comment #1)
&gt; Created attachment 239560 [details]
&gt; Draft patch

This patch was incorrect. It didn&apos;t take care of the void types (should throw an IAE) and wasn&apos;t producing expected results for qualified types, such as &quot;@A X.@B Y&quot;</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>2358885</commentid>
    <comment_count>3</comment_count>
      <attachid>239645</attachid>
    <who name="Jay Arthanareeswaran">jarthana</who>
    <bug_when>2014-02-05 00:09:47 -0500</bug_when>
    <thetext>Created attachment 239645
Updated patch

This addresses both the issues reported in comment #2 and more tests have been added.</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>2359777</commentid>
    <comment_count>4</comment_count>
    <who name="Srikanth Sankaran">srikanth_sankaran</who>
    <bug_when>2014-02-06 13:53:36 -0500</bug_when>
    <thetext>An alternate approach is to invent a new abstraction on the compiler side
say ConstructedTypeBinding as a subclass of VoidTypeBinding that would allow
cloning and decorations with annotations and have MethodBinding.returnType
point to the new object for constructors.</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>2359779</commentid>
    <comment_count>5</comment_count>
    <who name="Srikanth Sankaran">srikanth_sankaran</who>
    <bug_when>2014-02-06 13:56:05 -0500</bug_when>
    <thetext>(In reply to Srikanth Sankaran from comment #4)
&gt; An alternate approach is to invent a new abstraction on the compiler side
&gt; say ConstructedTypeBinding as a subclass of VoidTypeBinding that would allow
&gt; cloning and decorations with annotations and have MethodBinding.returnType
&gt; point to the new object for constructors.

Sorry, posted on the wrong bug.</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>2359947</commentid>
    <comment_count>6</comment_count>
    <who name="Srikanth Sankaran">srikanth_sankaran</who>
    <bug_when>2014-02-07 01:05:06 -0500</bug_when>
    <thetext>(1) Since this is an area we have badly burnt burnt fingers in, I would like 
to ask for a clarification: 

Given original array: 

@A int @B [] @C [] @A [] 

what do we expect to see after a call to binding.createArrayType(1);

@A int @B [] @C [] @A [] [] -- as the patch produces OR,

&quot;@A int [] @B [] @C [] @A []&quot;

I am inclined to think it is the latter - though the javadoc of 
org.eclipse.jdt.core.dom.ITypeBinding.createArrayType(int) is sufficiently
vague to allow former interpretation too. In particular it does not say
that the receiver type would become the element type.

Given that ITypeBinding(&quot;@A int @B [] @C [] @A []&quot;).getTypeAnnotations()
return @B, leftmost dimension is the primary array type. After a call
to createArrayType(int) I would expect the returned array to be the
primary array dimension (assuming an argument of 1 is passed)

Markus, what would make sense from a client perspective ? 

(2) javadoc of 
org.eclipse.jdt.core.dom.ITypeBinding.createArrayType(int) implies the
ability to shrink arrays - I didn&apos;t check if this work OK, Jay could you
add a test and test.

I&apos;ll hold on the review until we hear from the UI team.</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>2360601</commentid>
    <comment_count>7</comment_count>
    <who name="Srikanth Sankaran">srikanth_sankaran</who>
    <bug_when>2014-02-08 15:32:12 -0500</bug_when>
    <thetext>(In reply to Srikanth Sankaran from comment #6)

&gt; Given original array: 
&gt; 
&gt; @A int @B [] @C [] @A [] 
&gt; 
&gt; what do we expect to see after a call to binding.createArrayType(1);
&gt; 
&gt; @A int @B [] @C [] @A [] [] -- as the patch produces OR,
&gt; 
&gt; &quot;@A int [] @B [] @C [] @A []&quot;
&gt; 
&gt; I am inclined to think it is the latter -

Jay, please proceed to create a patch on this basis. It is clear that
the returned type is *the* array type.</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>2361531</commentid>
    <comment_count>8</comment_count>
      <attachid>239822</attachid>
    <who name="Jay Arthanareeswaran">jarthana</who>
    <bug_when>2014-02-11 08:21:21 -0500</bug_when>
    <thetext>Created attachment 239822
Updated patch

Patch takes care of both points made in comment #6.</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>2361652</commentid>
    <comment_count>9</comment_count>
    <who name="Srikanth Sankaran">srikanth_sankaran</who>
    <bug_when>2014-02-11 10:44:04 -0500</bug_when>
    <thetext>Patch looks good, Thanks Jay. Released here: http://git.eclipse.org/c/jdt/eclipse.jdt.core.git/commit/?h=BETA_JAVA8&amp;id=724710aa30292ac2abd638b547c00344cd47ea49</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>2366529</commentid>
    <comment_count>10</comment_count>
    <who name="Manoj Palat Away Until May 11 2015">manpalat</who>
    <bug_when>2014-02-21 03:32:25 -0500</bug_when>
    <thetext>Verified as working for Eclipse + Java 8 RC1 using Kepler SR2(RC4) +   
Eclipse Java Development Tools Patch for Java 8 Support (BETA)   
1.0.0.v20140220-2054</thetext>
  </long_desc>
      
          <attachment
              isobsolete="1"
              ispatch="1"
              isprivate="0"
          >
            <attachid>239560</attachid>
            <date>2014-02-02 12:20:00 -0500</date>
            <delta_ts>2014-02-05 00:09:47 -0500</delta_ts>
            <desc>Draft patch</desc>
            <filename>Bug-426459.patch</filename>
            <type>text/plain</type>
            <size>7224</size>
            <attacher name="Jay Arthanareeswaran">jarthana</attacher>
            
              <data encoding="base64">ZGlmZiAtLWdpdCBhL29yZy5lY2xpcHNlLmpkdC5jb3JlLnRlc3RzLm1vZGVsL3NyYy9vcmcvZWNs
aXBzZS9qZHQvY29yZS90ZXN0cy9kb20vQVNUQ29udmVydGVyMThUZXN0LmphdmEgYi9vcmcuZWNs
aXBzZS5qZHQuY29yZS50ZXN0cy5tb2RlbC9zcmMvb3JnL2VjbGlwc2UvamR0L2NvcmUvdGVzdHMv
ZG9tL0FTVENvbnZlcnRlcjE4VGVzdC5qYXZhCmluZGV4IDQ5Y2ZmMjQuLmMxZjEyMGMgMTAwNjQ0
Ci0tLSBhL29yZy5lY2xpcHNlLmpkdC5jb3JlLnRlc3RzLm1vZGVsL3NyYy9vcmcvZWNsaXBzZS9q
ZHQvY29yZS90ZXN0cy9kb20vQVNUQ29udmVydGVyMThUZXN0LmphdmEKKysrIGIvb3JnLmVjbGlw
c2UuamR0LmNvcmUudGVzdHMubW9kZWwvc3JjL29yZy9lY2xpcHNlL2pkdC9jb3JlL3Rlc3RzL2Rv
bS9BU1RDb252ZXJ0ZXIxOFRlc3QuamF2YQpAQCAtMzkxMCwzICszOTEwLDc5IEBACiAJCWFzc2Vy
dEVxdWFscygiSW5jb3JyZWN0IHR5cGUgYW5ub3RhdGlvbnMiLCAwLCBhbm5vdHMubGVuZ3RoKTsK
IAl9CisJLy8gaHR0cHM6Ly9idWdzLmVjbGlwc2Uub3JnL2J1Z3Mvc2hvd19idWcuY2dpP2lkPTQy
NjQ1OQorCXB1YmxpYyB2b2lkIHRlc3RCdWc0MjY0NTkoKSB0aHJvd3MgSmF2YU1vZGVsRXhjZXB0
aW9uIHsKKwkJU3RyaW5nIGNvbnRlbnRzID0KKwkJCSJpbXBvcnQgamF2YS5sYW5nLmFubm90YXRp
b24uKjtcbiIgKworCQkJIkBUYXJnZXQoRWxlbWVudFR5cGUuVFlQRV9VU0UpIEBpbnRlcmZhY2Ug
QSB7fVxuIiArCisJCQkiQFRhcmdldChFbGVtZW50VHlwZS5UWVBFX1VTRSkgQGludGVyZmFjZSBC
IHt9XG4iICsKKwkJCSJAVGFyZ2V0KEVsZW1lbnRUeXBlLlRZUEVfVVNFKSBAaW50ZXJmYWNlIEMg
e31cbiIgKworCQkJInB1YmxpYyBjbGFzcyBYIHtcbiIgKworCQkJIgkJQEEgaW50IEBCIFtdIEBD
IFtdIEBBIFtdIGlzO1xuIiArCisJCQkiCQlAQyBTdHJpbmcgQEEgW10gQEIgW10gQEMgW10gc3M7
XG4iICsKKwkJCSJ9IjsKKwkJdGhpcy53b3JraW5nQ29weSA9IGdldFdvcmtpbmdDb3B5KCIvQ29u
dmVydGVyMTgvc3JjL1guamF2YSIsIHRydWUpOworCQlBU1ROb2RlIG5vZGUgPSBidWlsZEFTVChj
b250ZW50cywgdGhpcy53b3JraW5nQ29weSk7CisJCWFzc2VydEVxdWFscygiTm90IGEgY29tcGls
YXRpb24gdW5pdCIsIEFTVE5vZGUuQ09NUElMQVRJT05fVU5JVCwgbm9kZS5nZXROb2RlVHlwZSgp
KTsKKwkJQ29tcGlsYXRpb25Vbml0IGNvbXBpbGF0aW9uVW5pdCA9IChDb21waWxhdGlvblVuaXQp
IG5vZGU7CisJCWFzc2VydFByb2JsZW1zU2l6ZShjb21waWxhdGlvblVuaXQsIDApOworCQlub2Rl
ID0gZ2V0QVNUTm9kZShjb21waWxhdGlvblVuaXQsIDMsIDApOworCQlhc3NlcnRUcnVlKCJOb3Qg
YSBmaWVsZCBkZWNsYXJhdGlvbiIsIG5vZGUuZ2V0Tm9kZVR5cGUoKSA9PSBBU1ROb2RlLkZJRUxE
X0RFQ0xBUkFUSU9OKTsKKwkJRmllbGREZWNsYXJhdGlvbiBmaWVsZCA9IChGaWVsZERlY2xhcmF0
aW9uKSBub2RlOworCQlUeXBlIHR5cGUgPSBmaWVsZC5nZXRUeXBlKCk7CisJCUlUeXBlQmluZGlu
ZyBiaW5kaW5nID0gdHlwZS5yZXNvbHZlQmluZGluZygpOworCQlhc3NlcnRFcXVhbHMoIkluY29y
cmVjdCB0eXBlIGJpbmRpbmciLCAiQEEgaW50IEBCIFtdIEBDIFtdIEBBIFtdIiwgYmluZGluZy50
b1N0cmluZygpKTsKKwkJSUFubm90YXRpb25CaW5kaW5nW10gYW5ub3RhdGlvbnMgPSBiaW5kaW5n
LmdldFR5cGVBbm5vdGF0aW9ucygpOworCQliaW5kaW5nID0gYmluZGluZy5jcmVhdGVBcnJheVR5
cGUoMSk7CisJCWFzc2VydEVxdWFscygiSW5jb3JyZWN0IHR5cGUgYmluZGluZyIsICJAQSBpbnQg
QEIgW10gQEMgW10gQEEgW10gW10iLCBiaW5kaW5nLnRvU3RyaW5nKCkpOworCQlpbnQgZGltcyA9
IGJpbmRpbmcuZ2V0RGltZW5zaW9ucygpOworCQlhc3NlcnRFcXVhbHMoIkluY29ycmVjdCBubyBv
ZiBkaW1lbnNpb25zIiwgNCwgZGltcyk7CisJCWFubm90YXRpb25zID0gYmluZGluZy5nZXRUeXBl
QW5ub3RhdGlvbnMoKTsKKwkJYXNzZXJ0RXF1YWxzKCJJbmNvcnJlY3Qgbm8gb2YgdHlwZSBhbm5v
dGF0aW9ucyIsIDEsIGFubm90YXRpb25zLmxlbmd0aCk7CisJCWFzc2VydEVxdWFscygiSW5jb3Jy
ZWN0IGFubm90YXRpb24iLCAiQEIoKSIsIGFubm90YXRpb25zWzBdLnRvU3RyaW5nKCkpOworCQli
aW5kaW5nID0gYmluZGluZy5nZXRDb21wb25lbnRUeXBlKCk7CisJCWFubm90YXRpb25zID0gYmlu
ZGluZy5nZXRUeXBlQW5ub3RhdGlvbnMoKTsKKwkJYXNzZXJ0RXF1YWxzKCJJbmNvcnJlY3Qgbm8g
b2YgdHlwZSBhbm5vdGF0aW9ucyIsIDEsIGFubm90YXRpb25zLmxlbmd0aCk7CisJCWFzc2VydEVx
dWFscygiSW5jb3JyZWN0IGFubm90YXRpb24iLCAiQEMoKSIsIGFubm90YXRpb25zWzBdLnRvU3Ry
aW5nKCkpOworCQliaW5kaW5nID0gYmluZGluZy5nZXRDb21wb25lbnRUeXBlKCk7CisJCWFubm90
YXRpb25zID0gYmluZGluZy5nZXRUeXBlQW5ub3RhdGlvbnMoKTsKKwkJYXNzZXJ0RXF1YWxzKCJJ
bmNvcnJlY3Qgbm8gb2YgdHlwZSBhbm5vdGF0aW9ucyIsIDEsIGFubm90YXRpb25zLmxlbmd0aCk7
CisJCWFzc2VydEVxdWFscygiSW5jb3JyZWN0IGFubm90YXRpb24iLCAiQEEoKSIsIGFubm90YXRp
b25zWzBdLnRvU3RyaW5nKCkpOworCQliaW5kaW5nID0gYmluZGluZy5nZXRDb21wb25lbnRUeXBl
KCk7CisJCWFubm90YXRpb25zID0gYmluZGluZy5nZXRUeXBlQW5ub3RhdGlvbnMoKTsKKwkJYXNz
ZXJ0RXF1YWxzKCJJbmNvcnJlY3Qgbm8gb2YgdHlwZSBhbm5vdGF0aW9ucyIsIDAsIGFubm90YXRp
b25zLmxlbmd0aCk7CisJCWJpbmRpbmcgPSBiaW5kaW5nLmdldEVsZW1lbnRUeXBlKCk7CisJCWFu
bm90YXRpb25zID0gYmluZGluZy5nZXRUeXBlQW5ub3RhdGlvbnMoKTsKKwkJYXNzZXJ0RXF1YWxz
KCJJbmNvcnJlY3Qgbm8gb2YgdHlwZSBhbm5vdGF0aW9ucyIsIDEsIGFubm90YXRpb25zLmxlbmd0
aCk7CisJCWFzc2VydEVxdWFscygiSW5jb3JyZWN0IGFubm90YXRpb24iLCAiQEEoKSIsIGFubm90
YXRpb25zWzBdLnRvU3RyaW5nKCkpOworCQkKKwkJbm9kZSA9IGdldEFTVE5vZGUoY29tcGlsYXRp
b25Vbml0LCAzLCAxKTsKKwkJYXNzZXJ0VHJ1ZSgiTm90IGEgZmllbGQgZGVjbGFyYXRpb24iLCBu
b2RlLmdldE5vZGVUeXBlKCkgPT0gQVNUTm9kZS5GSUVMRF9ERUNMQVJBVElPTik7CisJCWZpZWxk
ID0gKEZpZWxkRGVjbGFyYXRpb24pIG5vZGU7CisJCXR5cGUgPSBmaWVsZC5nZXRUeXBlKCk7CisJ
CWJpbmRpbmcgPSB0eXBlLnJlc29sdmVCaW5kaW5nKCk7CisJCWFzc2VydEVxdWFscygiSW5jb3Jy
ZWN0IHR5cGUgYmluZGluZyIsICJAQyBTdHJpbmcgQEEgW10gQEIgW10gQEMgW10iLCBiaW5kaW5n
LnRvU3RyaW5nKCkpOworCQlhbm5vdGF0aW9ucyA9IGJpbmRpbmcuZ2V0VHlwZUFubm90YXRpb25z
KCk7CisJCWJpbmRpbmcgPSBiaW5kaW5nLmNyZWF0ZUFycmF5VHlwZSgxKTsKKwkJYXNzZXJ0RXF1
YWxzKCJJbmNvcnJlY3QgdHlwZSBiaW5kaW5nIiwgIkBDIFN0cmluZyBAQSBbXSBAQiBbXSBAQyBb
XSBbXSIsIGJpbmRpbmcudG9TdHJpbmcoKSk7CisJCWRpbXMgPSBiaW5kaW5nLmdldERpbWVuc2lv
bnMoKTsKKwkJYXNzZXJ0RXF1YWxzKCJJbmNvcnJlY3Qgbm8gb2YgZGltZW5zaW9ucyIsIDQsIGRp
bXMpOworCQlhbm5vdGF0aW9ucyA9IGJpbmRpbmcuZ2V0VHlwZUFubm90YXRpb25zKCk7CisJCWFz
c2VydEVxdWFscygiSW5jb3JyZWN0IG5vIG9mIHR5cGUgYW5ub3RhdGlvbnMiLCAxLCBhbm5vdGF0
aW9ucy5sZW5ndGgpOworCQlhc3NlcnRFcXVhbHMoIkluY29ycmVjdCBhbm5vdGF0aW9uIiwgIkBB
KCkiLCBhbm5vdGF0aW9uc1swXS50b1N0cmluZygpKTsKKwkJYmluZGluZyA9IGJpbmRpbmcuZ2V0
Q29tcG9uZW50VHlwZSgpOworCQlhbm5vdGF0aW9ucyA9IGJpbmRpbmcuZ2V0VHlwZUFubm90YXRp
b25zKCk7CisJCWFzc2VydEVxdWFscygiSW5jb3JyZWN0IG5vIG9mIHR5cGUgYW5ub3RhdGlvbnMi
LCAxLCBhbm5vdGF0aW9ucy5sZW5ndGgpOworCQlhc3NlcnRFcXVhbHMoIkluY29ycmVjdCBhbm5v
dGF0aW9uIiwgIkBCKCkiLCBhbm5vdGF0aW9uc1swXS50b1N0cmluZygpKTsKKwkJYmluZGluZyA9
IGJpbmRpbmcuZ2V0Q29tcG9uZW50VHlwZSgpOworCQlhbm5vdGF0aW9ucyA9IGJpbmRpbmcuZ2V0
VHlwZUFubm90YXRpb25zKCk7CisJCWFzc2VydEVxdWFscygiSW5jb3JyZWN0IG5vIG9mIHR5cGUg
YW5ub3RhdGlvbnMiLCAxLCBhbm5vdGF0aW9ucy5sZW5ndGgpOworCQlhc3NlcnRFcXVhbHMoIklu
Y29ycmVjdCBhbm5vdGF0aW9uIiwgIkBDKCkiLCBhbm5vdGF0aW9uc1swXS50b1N0cmluZygpKTsK
KwkJYmluZGluZyA9IGJpbmRpbmcuZ2V0Q29tcG9uZW50VHlwZSgpOworCQlhbm5vdGF0aW9ucyA9
IGJpbmRpbmcuZ2V0VHlwZUFubm90YXRpb25zKCk7CisJCWFzc2VydEVxdWFscygiSW5jb3JyZWN0
IG5vIG9mIHR5cGUgYW5ub3RhdGlvbnMiLCAwLCBhbm5vdGF0aW9ucy5sZW5ndGgpOworCQliaW5k
aW5nID0gYmluZGluZy5nZXRFbGVtZW50VHlwZSgpOworCQlhbm5vdGF0aW9ucyA9IGJpbmRpbmcu
Z2V0VHlwZUFubm90YXRpb25zKCk7CisJCWFzc2VydEVxdWFscygiSW5jb3JyZWN0IG5vIG9mIHR5
cGUgYW5ub3RhdGlvbnMiLCAxLCBhbm5vdGF0aW9ucy5sZW5ndGgpOworCQlhc3NlcnRFcXVhbHMo
IkluY29ycmVjdCBhbm5vdGF0aW9uIiwgIkBDKCkiLCBhbm5vdGF0aW9uc1swXS50b1N0cmluZygp
KTsKKwl9CiB9CmRpZmYgLS1naXQgYS9vcmcuZWNsaXBzZS5qZHQuY29yZS9kb20vb3JnL2VjbGlw
c2UvamR0L2NvcmUvZG9tL0RlZmF1bHRCaW5kaW5nUmVzb2x2ZXIuamF2YSBiL29yZy5lY2xpcHNl
LmpkdC5jb3JlL2RvbS9vcmcvZWNsaXBzZS9qZHQvY29yZS9kb20vRGVmYXVsdEJpbmRpbmdSZXNv
bHZlci5qYXZhCmluZGV4IGIwNzgyYTQuLjg5OTg0NWEgMTAwNjQ0Ci0tLSBhL29yZy5lY2xpcHNl
LmpkdC5jb3JlL2RvbS9vcmcvZWNsaXBzZS9qZHQvY29yZS9kb20vRGVmYXVsdEJpbmRpbmdSZXNv
bHZlci5qYXZhCisrKyBiL29yZy5lY2xpcHNlLmpkdC5jb3JlL2RvbS9vcmcvZWNsaXBzZS9qZHQv
Y29yZS9kb20vRGVmYXVsdEJpbmRpbmdSZXNvbHZlci5qYXZhCkBAIC0xLDQgKzEsNCBAQAogLyoq
KioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioq
KioqKioqKioqKioqKioqKioqKioKLSAqIENvcHlyaWdodCAoYykgMjAwMCwgMjAxMyBJQk0gQ29y
cG9yYXRpb24gYW5kIG90aGVycy4KKyAqIENvcHlyaWdodCAoYykgMjAwMCwgMjAxNCBJQk0gQ29y
cG9yYXRpb24gYW5kIG90aGVycy4KICAqIEFsbCByaWdodHMgcmVzZXJ2ZWQuIFRoaXMgcHJvZ3Jh
bSBhbmQgdGhlIGFjY29tcGFueWluZyBtYXRlcmlhbHMKICAqIGFyZSBtYWRlIGF2YWlsYWJsZSB1
bmRlciB0aGUgdGVybXMgb2YgdGhlIEVjbGlwc2UgUHVibGljIExpY2Vuc2UgdjEuMApAQCAtMTky
MywzOSArMTkyMyw3IEBACiAJCX0KICAJCW9yZy5lY2xpcHNlLmpkdC5pbnRlcm5hbC5jb21waWxl
ci5sb29rdXAuVHlwZUJpbmRpbmcgbGVhZlR5cGVCaW5kaW5nID0gbnVsbDsKLSAJCWlmIChsZWFm
Q29tcG9uZW50VHlwZS5pc1ByaW1pdGl2ZSgpKSB7Ci0gCSAJCVN0cmluZyBuYW1lID0gbGVhZkNv
bXBvbmVudFR5cGUuZ2V0QmluYXJ5TmFtZSgpOwotCQkJc3dpdGNoKG5hbWUuY2hhckF0KDApKSB7
Ci0JCQkJY2FzZSAnSScgOgotCQkJCQlsZWFmVHlwZUJpbmRpbmcgPSBvcmcuZWNsaXBzZS5qZHQu
aW50ZXJuYWwuY29tcGlsZXIubG9va3VwLlR5cGVCaW5kaW5nLklOVDsKLQkJCQkJYnJlYWs7Ci0J
CQkJY2FzZSAnQicgOgotCQkJCQlsZWFmVHlwZUJpbmRpbmcgPSBvcmcuZWNsaXBzZS5qZHQuaW50
ZXJuYWwuY29tcGlsZXIubG9va3VwLlR5cGVCaW5kaW5nLkJZVEU7Ci0JCQkJCWJyZWFrOwotCQkJ
CWNhc2UgJ1onIDoKLQkJCQkJbGVhZlR5cGVCaW5kaW5nID0gb3JnLmVjbGlwc2UuamR0LmludGVy
bmFsLmNvbXBpbGVyLmxvb2t1cC5UeXBlQmluZGluZy5CT09MRUFOOwotCQkJCQlicmVhazsKLQkJ
CQljYXNlICdDJyA6Ci0JCQkJCWxlYWZUeXBlQmluZGluZyA9IG9yZy5lY2xpcHNlLmpkdC5pbnRl
cm5hbC5jb21waWxlci5sb29rdXAuVHlwZUJpbmRpbmcuQ0hBUjsKLQkJCQkJYnJlYWs7Ci0JCQkJ
Y2FzZSAnSicgOgotCQkJCQlsZWFmVHlwZUJpbmRpbmcgPSBvcmcuZWNsaXBzZS5qZHQuaW50ZXJu
YWwuY29tcGlsZXIubG9va3VwLlR5cGVCaW5kaW5nLkxPTkc7Ci0JCQkJCWJyZWFrOwotCQkJCWNh
c2UgJ1MnIDoKLQkJCQkJbGVhZlR5cGVCaW5kaW5nID0gb3JnLmVjbGlwc2UuamR0LmludGVybmFs
LmNvbXBpbGVyLmxvb2t1cC5UeXBlQmluZGluZy5TSE9SVDsKLQkJCQkJYnJlYWs7Ci0JCQkJY2Fz
ZSAnRCcgOgotCQkJCQlsZWFmVHlwZUJpbmRpbmcgPSBvcmcuZWNsaXBzZS5qZHQuaW50ZXJuYWwu
Y29tcGlsZXIubG9va3VwLlR5cGVCaW5kaW5nLkRPVUJMRTsKLQkJCQkJYnJlYWs7Ci0JCQkJY2Fz
ZSAnRicgOgotCQkJCQlsZWFmVHlwZUJpbmRpbmcgPSBvcmcuZWNsaXBzZS5qZHQuaW50ZXJuYWwu
Y29tcGlsZXIubG9va3VwLlR5cGVCaW5kaW5nLkZMT0FUOwotCQkJCQlicmVhazsKLQkJCQljYXNl
ICdWJyA6Ci0JCQkJCXRocm93IG5ldyBJbGxlZ2FsQXJndW1lbnRFeGNlcHRpb24oKTsKLQkJCX0K
LSAJCX0gZWxzZSB7Ci0gCQkJaWYgKCEobGVhZkNvbXBvbmVudFR5cGUgaW5zdGFuY2VvZiBUeXBl
QmluZGluZykpIHJldHVybiBudWxsOwotIAkJCWxlYWZUeXBlQmluZGluZyA9ICgoVHlwZUJpbmRp
bmcpIGxlYWZDb21wb25lbnRUeXBlKS5iaW5kaW5nOwotIAkJfQotCQlyZXR1cm4gdGhpcy5nZXRU
eXBlQmluZGluZyhsb29rdXBFbnZpcm9ubWVudCgpLmNyZWF0ZUFycmF5VHlwZShsZWFmVHlwZUJp
bmRpbmcsIGFjdHVhbERpbWVuc2lvbnMpKTsKKyAJCWlmICghKGxlYWZDb21wb25lbnRUeXBlIGlu
c3RhbmNlb2YgVHlwZUJpbmRpbmcpKSByZXR1cm4gbnVsbDsKKyAJCWxlYWZUeXBlQmluZGluZyA9
ICgoVHlwZUJpbmRpbmcpIGxlYWZDb21wb25lbnRUeXBlKS5iaW5kaW5nOworCQlyZXR1cm4gdGhp
cy5nZXRUeXBlQmluZGluZyhsb29rdXBFbnZpcm9ubWVudCgpLmNyZWF0ZUFycmF5VHlwZShsZWFm
VHlwZUJpbmRpbmcsIGFjdHVhbERpbWVuc2lvbnMsICgoKFR5cGVCaW5kaW5nKSB0eXBlQmluZGlu
ZykuYmluZGluZykuZ2V0VHlwZUFubm90YXRpb25zKCkpKTsKIAl9CiB9
</data>

          </attachment>
          <attachment
              isobsolete="1"
              ispatch="1"
              isprivate="0"
          >
            <attachid>239645</attachid>
            <date>2014-02-05 00:09:00 -0500</date>
            <delta_ts>2014-02-11 08:21:21 -0500</delta_ts>
            <desc>Updated patch</desc>
            <filename>Bug-426459.patch</filename>
            <type>text/plain</type>
            <size>11019</size>
            <attacher name="Jay Arthanareeswaran">jarthana</attacher>
            
              <data encoding="base64">ZGlmZiAtLWdpdCBhL29yZy5lY2xpcHNlLmpkdC5jb3JlLnRlc3RzLm1vZGVsL3NyYy9vcmcvZWNs
aXBzZS9qZHQvY29yZS90ZXN0cy9kb20vQVNUQ29udmVydGVyMThUZXN0LmphdmEgYi9vcmcuZWNs
aXBzZS5qZHQuY29yZS50ZXN0cy5tb2RlbC9zcmMvb3JnL2VjbGlwc2UvamR0L2NvcmUvdGVzdHMv
ZG9tL0FTVENvbnZlcnRlcjE4VGVzdC5qYXZhCmluZGV4IDk2MDRkZDMuLjcyZjUyOWQgMTAwNjQ0
Ci0tLSBhL29yZy5lY2xpcHNlLmpkdC5jb3JlLnRlc3RzLm1vZGVsL3NyYy9vcmcvZWNsaXBzZS9q
ZHQvY29yZS90ZXN0cy9kb20vQVNUQ29udmVydGVyMThUZXN0LmphdmEKKysrIGIvb3JnLmVjbGlw
c2UuamR0LmNvcmUudGVzdHMubW9kZWwvc3JjL29yZy9lY2xpcHNlL2pkdC9jb3JlL3Rlc3RzL2Rv
bS9BU1RDb252ZXJ0ZXIxOFRlc3QuamF2YQpAQCAtNDAyMywzICs0MDIzLDExOCBAQAogCQlhc3Nl
cnRFcXVhbHMoIk5vdCBhIHZhcmlhYmxlIGRlY2xhcmF0aW9uIGZyYWdtZW50IiwgQVNUTm9kZS5W
QVJJQUJMRV9ERUNMQVJBVElPTl9GUkFHTUVOVCwgYXN0Tm9kZS5nZXROb2RlVHlwZSgpKTsKIAl9
CisJLy8gaHR0cHM6Ly9idWdzLmVjbGlwc2Uub3JnL2J1Z3Mvc2hvd19idWcuY2dpP2lkPTQyNjQ1
OQorCXB1YmxpYyB2b2lkIHRlc3RCdWc0MjY0NTkoKSB0aHJvd3MgSmF2YU1vZGVsRXhjZXB0aW9u
IHsKKwkJU3RyaW5nIGNvbnRlbnRzID0KKwkJCSJpbXBvcnQgamF2YS5sYW5nLmFubm90YXRpb24u
KjtcbiIgKworCQkJIkBUYXJnZXQoRWxlbWVudFR5cGUuVFlQRV9VU0UpIEBpbnRlcmZhY2UgQSB7
fVxuIiArCisJCQkiQFRhcmdldChFbGVtZW50VHlwZS5UWVBFX1VTRSkgQGludGVyZmFjZSBCIHt9
XG4iICsKKwkJCSJAVGFyZ2V0KEVsZW1lbnRUeXBlLlRZUEVfVVNFKSBAaW50ZXJmYWNlIEMge31c
biIgKworCQkJInB1YmxpYyBjbGFzcyBYIHtcbiIgKworCQkJIgkJQEEgaW50IEBCIFtdIEBDIFtd
IEBBIFtdIGlzO1xuIiArCisJCQkiCQlAQyBTdHJpbmcgQEEgW10gQEIgW10gQEMgW10gc3M7XG4i
ICsKKwkJCSJ9IjsKKwkJdGhpcy53b3JraW5nQ29weSA9IGdldFdvcmtpbmdDb3B5KCIvQ29udmVy
dGVyMTgvc3JjL1guamF2YSIsIHRydWUpOworCQlBU1ROb2RlIG5vZGUgPSBidWlsZEFTVChjb250
ZW50cywgdGhpcy53b3JraW5nQ29weSk7CisJCWFzc2VydEVxdWFscygiTm90IGEgY29tcGlsYXRp
b24gdW5pdCIsIEFTVE5vZGUuQ09NUElMQVRJT05fVU5JVCwgbm9kZS5nZXROb2RlVHlwZSgpKTsK
KwkJQ29tcGlsYXRpb25Vbml0IGNvbXBpbGF0aW9uVW5pdCA9IChDb21waWxhdGlvblVuaXQpIG5v
ZGU7CisJCWFzc2VydFByb2JsZW1zU2l6ZShjb21waWxhdGlvblVuaXQsIDApOworCQlub2RlID0g
Z2V0QVNUTm9kZShjb21waWxhdGlvblVuaXQsIDMsIDApOworCQlhc3NlcnRUcnVlKCJOb3QgYSBm
aWVsZCBkZWNsYXJhdGlvbiIsIG5vZGUuZ2V0Tm9kZVR5cGUoKSA9PSBBU1ROb2RlLkZJRUxEX0RF
Q0xBUkFUSU9OKTsKKwkJRmllbGREZWNsYXJhdGlvbiBmaWVsZCA9IChGaWVsZERlY2xhcmF0aW9u
KSBub2RlOworCQlUeXBlIHR5cGUgPSBmaWVsZC5nZXRUeXBlKCk7CisJCUlUeXBlQmluZGluZyBi
aW5kaW5nID0gdHlwZS5yZXNvbHZlQmluZGluZygpOworCQlhc3NlcnRFcXVhbHMoIkluY29ycmVj
dCB0eXBlIGJpbmRpbmciLCAiQEEgaW50IEBCIFtdIEBDIFtdIEBBIFtdIiwgYmluZGluZy50b1N0
cmluZygpKTsKKwkJSUFubm90YXRpb25CaW5kaW5nW10gYW5ub3RhdGlvbnMgPSBiaW5kaW5nLmdl
dFR5cGVBbm5vdGF0aW9ucygpOworCQliaW5kaW5nID0gYmluZGluZy5jcmVhdGVBcnJheVR5cGUo
MSk7CisJCWFzc2VydEVxdWFscygiSW5jb3JyZWN0IHR5cGUgYmluZGluZyIsICJAQSBpbnQgQEIg
W10gQEMgW10gQEEgW10gW10iLCBiaW5kaW5nLnRvU3RyaW5nKCkpOworCQlpbnQgZGltcyA9IGJp
bmRpbmcuZ2V0RGltZW5zaW9ucygpOworCQlhc3NlcnRFcXVhbHMoIkluY29ycmVjdCBubyBvZiBk
aW1lbnNpb25zIiwgNCwgZGltcyk7CisJCWFubm90YXRpb25zID0gYmluZGluZy5nZXRUeXBlQW5u
b3RhdGlvbnMoKTsKKwkJYXNzZXJ0RXF1YWxzKCJJbmNvcnJlY3Qgbm8gb2YgdHlwZSBhbm5vdGF0
aW9ucyIsIDEsIGFubm90YXRpb25zLmxlbmd0aCk7CisJCWFzc2VydEVxdWFscygiSW5jb3JyZWN0
IGFubm90YXRpb24iLCAiQEIoKSIsIGFubm90YXRpb25zWzBdLnRvU3RyaW5nKCkpOworCQliaW5k
aW5nID0gYmluZGluZy5nZXRDb21wb25lbnRUeXBlKCk7CisJCWFubm90YXRpb25zID0gYmluZGlu
Zy5nZXRUeXBlQW5ub3RhdGlvbnMoKTsKKwkJYXNzZXJ0RXF1YWxzKCJJbmNvcnJlY3Qgbm8gb2Yg
dHlwZSBhbm5vdGF0aW9ucyIsIDEsIGFubm90YXRpb25zLmxlbmd0aCk7CisJCWFzc2VydEVxdWFs
cygiSW5jb3JyZWN0IGFubm90YXRpb24iLCAiQEMoKSIsIGFubm90YXRpb25zWzBdLnRvU3RyaW5n
KCkpOworCQliaW5kaW5nID0gYmluZGluZy5nZXRDb21wb25lbnRUeXBlKCk7CisJCWFubm90YXRp
b25zID0gYmluZGluZy5nZXRUeXBlQW5ub3RhdGlvbnMoKTsKKwkJYXNzZXJ0RXF1YWxzKCJJbmNv
cnJlY3Qgbm8gb2YgdHlwZSBhbm5vdGF0aW9ucyIsIDEsIGFubm90YXRpb25zLmxlbmd0aCk7CisJ
CWFzc2VydEVxdWFscygiSW5jb3JyZWN0IGFubm90YXRpb24iLCAiQEEoKSIsIGFubm90YXRpb25z
WzBdLnRvU3RyaW5nKCkpOworCQliaW5kaW5nID0gYmluZGluZy5nZXRDb21wb25lbnRUeXBlKCk7
CisJCWFubm90YXRpb25zID0gYmluZGluZy5nZXRUeXBlQW5ub3RhdGlvbnMoKTsKKwkJYXNzZXJ0
RXF1YWxzKCJJbmNvcnJlY3Qgbm8gb2YgdHlwZSBhbm5vdGF0aW9ucyIsIDAsIGFubm90YXRpb25z
Lmxlbmd0aCk7CisJCWJpbmRpbmcgPSBiaW5kaW5nLmdldEVsZW1lbnRUeXBlKCk7CisJCWFubm90
YXRpb25zID0gYmluZGluZy5nZXRUeXBlQW5ub3RhdGlvbnMoKTsKKwkJYXNzZXJ0RXF1YWxzKCJJ
bmNvcnJlY3Qgbm8gb2YgdHlwZSBhbm5vdGF0aW9ucyIsIDEsIGFubm90YXRpb25zLmxlbmd0aCk7
CisJCWFzc2VydEVxdWFscygiSW5jb3JyZWN0IGFubm90YXRpb24iLCAiQEEoKSIsIGFubm90YXRp
b25zWzBdLnRvU3RyaW5nKCkpOworCQkKKwkJbm9kZSA9IGdldEFTVE5vZGUoY29tcGlsYXRpb25V
bml0LCAzLCAxKTsKKwkJYXNzZXJ0VHJ1ZSgiTm90IGEgZmllbGQgZGVjbGFyYXRpb24iLCBub2Rl
LmdldE5vZGVUeXBlKCkgPT0gQVNUTm9kZS5GSUVMRF9ERUNMQVJBVElPTik7CisJCWZpZWxkID0g
KEZpZWxkRGVjbGFyYXRpb24pIG5vZGU7CisJCXR5cGUgPSBmaWVsZC5nZXRUeXBlKCk7CisJCWJp
bmRpbmcgPSB0eXBlLnJlc29sdmVCaW5kaW5nKCk7CisJCWFzc2VydEVxdWFscygiSW5jb3JyZWN0
IHR5cGUgYmluZGluZyIsICJAQyBTdHJpbmcgQEEgW10gQEIgW10gQEMgW10iLCBiaW5kaW5nLnRv
U3RyaW5nKCkpOworCQlhbm5vdGF0aW9ucyA9IGJpbmRpbmcuZ2V0VHlwZUFubm90YXRpb25zKCk7
CisJCWJpbmRpbmcgPSBiaW5kaW5nLmNyZWF0ZUFycmF5VHlwZSgxKTsKKwkJYXNzZXJ0RXF1YWxz
KCJJbmNvcnJlY3QgdHlwZSBiaW5kaW5nIiwgIkBDIFN0cmluZyBAQSBbXSBAQiBbXSBAQyBbXSBb
XSIsIGJpbmRpbmcudG9TdHJpbmcoKSk7CisJCWRpbXMgPSBiaW5kaW5nLmdldERpbWVuc2lvbnMo
KTsKKwkJYXNzZXJ0RXF1YWxzKCJJbmNvcnJlY3Qgbm8gb2YgZGltZW5zaW9ucyIsIDQsIGRpbXMp
OworCX0KKwkvLyBodHRwczovL2J1Z3MuZWNsaXBzZS5vcmcvYnVncy9zaG93X2J1Zy5jZ2k/aWQ9
NDI2NDU5CisJcHVibGljIHZvaWQgdGVzdEJ1ZzQyNjQ1OWEoKSB0aHJvd3MgSmF2YU1vZGVsRXhj
ZXB0aW9uIHsKKwkJU3RyaW5nIGNvbnRlbnRzID0KKwkJCSJpbXBvcnQgamF2YS5sYW5nLmFubm90
YXRpb24uKjtcbiIgKworCQkJIkBUYXJnZXQoRWxlbWVudFR5cGUuVFlQRV9VU0UpIEBpbnRlcmZh
Y2UgQSB7fVxuIiArCisJCQkiQFRhcmdldChFbGVtZW50VHlwZS5UWVBFX1VTRSkgQGludGVyZmFj
ZSBCIHt9XG4iICsKKwkJCSJAVGFyZ2V0KEVsZW1lbnRUeXBlLlRZUEVfVVNFKSBAaW50ZXJmYWNl
IEMge31cbiIgKworCQkJInB1YmxpYyBjbGFzcyBYIHtcbiIgKworCQkJIgkJcHVibGljIHZvaWQg
Zm9vKCkge31cbiIgKworCQkJIgkJcHVibGljIEBBIFguQEIgWSBmb28oQEMgaW50IGkpeyByZXR1
cm4gbnVsbDt9XG4iICsKKwkJCSIJCXB1YmxpYyBAQSBAQiBYIGZvbyhpbnQgaSwgaW50IGopeyBy
ZXR1cm4gbnVsbDt9XG4iICsKKwkJCSIJCWNsYXNzIFkge31cbiIgKworCQkJIn0iOworCQl0aGlz
LndvcmtpbmdDb3B5ID0gZ2V0V29ya2luZ0NvcHkoIi9Db252ZXJ0ZXIxOC9zcmMvWC5qYXZhIiwg
dHJ1ZSk7CisJCUFTVE5vZGUgbm9kZSA9IGJ1aWxkQVNUKGNvbnRlbnRzLCB0aGlzLndvcmtpbmdD
b3B5KTsKKwkJYXNzZXJ0RXF1YWxzKCJOb3QgYSBjb21waWxhdGlvbiB1bml0IiwgQVNUTm9kZS5D
T01QSUxBVElPTl9VTklULCBub2RlLmdldE5vZGVUeXBlKCkpOworCQlDb21waWxhdGlvblVuaXQg
Y29tcGlsYXRpb25Vbml0ID0gKENvbXBpbGF0aW9uVW5pdCkgbm9kZTsKKwkJYXNzZXJ0UHJvYmxl
bXNTaXplKGNvbXBpbGF0aW9uVW5pdCwgMCk7CisJCQorCQlub2RlID0gZ2V0QVNUTm9kZShjb21w
aWxhdGlvblVuaXQsIDMsIDApOworCQlhc3NlcnRFcXVhbHMoIk5vdCBhIG1ldGhvZCBkZWNsYXJh
dGlvbiIsIEFTVE5vZGUuTUVUSE9EX0RFQ0xBUkFUSU9OLCBub2RlLmdldE5vZGVUeXBlKCkpOwor
CQlUeXBlIHR5cGUgPSAoKE1ldGhvZERlY2xhcmF0aW9uKSBub2RlKS5nZXRSZXR1cm5UeXBlMigp
OworCQlJVHlwZUJpbmRpbmcgYmluZGluZyA9IHR5cGUucmVzb2x2ZUJpbmRpbmcoKTsKKwkJYXNz
ZXJ0Tm90TnVsbCgiQmluZGluZyBzaG91bGQgbm90IGJlIG51bGwiLCBiaW5kaW5nKTsKKwkJdHJ5
IHsKKwkJCWJpbmRpbmcgPSBiaW5kaW5nLmNyZWF0ZUFycmF5VHlwZSgxKTsKKwkJCWJpbmRpbmcg
PSBudWxsOworCQl9IGNhdGNoKElsbGVnYWxBcmd1bWVudEV4Y2VwdGlvbiBpYWUpIHsKKwkJfQor
CQlhc3NlcnROb3ROdWxsKCJJbGxlZ2FsQXJndW1lbnRFeGNlcHRpb24gc2hvdWxkIGhhdmUgYmVl
biB0aHJvd24iLCBiaW5kaW5nKTsKKworCQlub2RlID0gZ2V0QVNUTm9kZShjb21waWxhdGlvblVu
aXQsIDMsIDEpOworCQlhc3NlcnRFcXVhbHMoIk5vdCBhIG1ldGhvZCBkZWNsYXJhdGlvbiIsIEFT
VE5vZGUuTUVUSE9EX0RFQ0xBUkFUSU9OLCBub2RlLmdldE5vZGVUeXBlKCkpOworCQl0eXBlID0g
KChNZXRob2REZWNsYXJhdGlvbikgbm9kZSkuZ2V0UmV0dXJuVHlwZTIoKTsKKwkJYmluZGluZyA9
IHR5cGUucmVzb2x2ZUJpbmRpbmcoKTsKKwkJYXNzZXJ0RXF1YWxzKCJJbmNvcnJlY3QgdHlwZSBi
aW5kaW5nIiwgIkBBIFguQEIgWSIsIGJpbmRpbmcudG9TdHJpbmcoKSk7CisJCWJpbmRpbmcgPSBi
aW5kaW5nLmNyZWF0ZUFycmF5VHlwZSgyKTsKKwkJYXNzZXJ0RXF1YWxzKCJJbmNvcnJlY3QgdHlw
ZSBiaW5kaW5nIiwgIkBBIFguQEIgWSBbXSBbXSIsIGJpbmRpbmcudG9TdHJpbmcoKSk7CisJCWlu
dCBkaW1zID0gYmluZGluZy5nZXREaW1lbnNpb25zKCk7CisJCWFzc2VydEVxdWFscygiSW5jb3Jy
ZWN0IG5vIG9mIGRpbWVuc2lvbnMiLCAyLCBkaW1zKTsKKwkJU2luZ2xlVmFyaWFibGVEZWNsYXJh
dGlvbiBwYXJhbSA9IChTaW5nbGVWYXJpYWJsZURlY2xhcmF0aW9uKSAoKE1ldGhvZERlY2xhcmF0
aW9uKSBub2RlKS5wYXJhbWV0ZXJzKCkuZ2V0KDApOworCQl0eXBlID0gcGFyYW0uZ2V0VHlwZSgp
OworCQliaW5kaW5nID0gdHlwZS5yZXNvbHZlQmluZGluZygpOworCQlhc3NlcnRFcXVhbHMoIklu
Y29ycmVjdCB0eXBlIGJpbmRpbmciLCAiQEMgaW50IiwgYmluZGluZy50b1N0cmluZygpKTsKKwkJ
YmluZGluZyA9IGJpbmRpbmcuY3JlYXRlQXJyYXlUeXBlKDIpOworCQlhc3NlcnRFcXVhbHMoIklu
Y29ycmVjdCB0eXBlIGJpbmRpbmciLCAiQEMgaW50IFtdIFtdIiwgYmluZGluZy50b1N0cmluZygp
KTsKKwkJCisJCW5vZGUgPSBnZXRBU1ROb2RlKGNvbXBpbGF0aW9uVW5pdCwgMywgMik7CisJCWFz
c2VydEVxdWFscygiTm90IGEgbWV0aG9kIGRlY2xhcmF0aW9uIiwgQVNUTm9kZS5NRVRIT0RfREVD
TEFSQVRJT04sIG5vZGUuZ2V0Tm9kZVR5cGUoKSk7CisJCXR5cGUgPSAoKE1ldGhvZERlY2xhcmF0
aW9uKSBub2RlKS5nZXRSZXR1cm5UeXBlMigpOworCQliaW5kaW5nID0gdHlwZS5yZXNvbHZlQmlu
ZGluZygpOworCQlhc3NlcnRFcXVhbHMoIkluY29ycmVjdCB0eXBlIGJpbmRpbmciLCAiQEEgQEIg
WCIsIGJpbmRpbmcudG9TdHJpbmcoKSk7CisJCWJpbmRpbmcgPSBiaW5kaW5nLmNyZWF0ZUFycmF5
VHlwZSgyKTsKKwkJYXNzZXJ0RXF1YWxzKCJJbmNvcnJlY3QgdHlwZSBiaW5kaW5nIiwgIkBBIEBC
IFggW10gW10iLCBiaW5kaW5nLnRvU3RyaW5nKCkpOworCQlkaW1zID0gYmluZGluZy5nZXREaW1l
bnNpb25zKCk7CisJCWFzc2VydEVxdWFscygiSW5jb3JyZWN0IG5vIG9mIGRpbWVuc2lvbnMiLCAy
LCBkaW1zKTsKKwl9CiB9CmRpZmYgLS1naXQgYS9vcmcuZWNsaXBzZS5qZHQuY29yZS9kb20vb3Jn
L2VjbGlwc2UvamR0L2NvcmUvZG9tL0JpbmRpbmdSZXNvbHZlci5qYXZhIGIvb3JnLmVjbGlwc2Uu
amR0LmNvcmUvZG9tL29yZy9lY2xpcHNlL2pkdC9jb3JlL2RvbS9CaW5kaW5nUmVzb2x2ZXIuamF2
YQppbmRleCBkZTc5YTRjLi5kYjRhYzRjIDEwMDY0NAotLS0gYS9vcmcuZWNsaXBzZS5qZHQuY29y
ZS9kb20vb3JnL2VjbGlwc2UvamR0L2NvcmUvZG9tL0JpbmRpbmdSZXNvbHZlci5qYXZhCisrKyBi
L29yZy5lY2xpcHNlLmpkdC5jb3JlL2RvbS9vcmcvZWNsaXBzZS9qZHQvY29yZS9kb20vQmluZGlu
Z1Jlc29sdmVyLmphdmEKQEAgLTEsNCArMSw0IEBACiAvKioqKioqKioqKioqKioqKioqKioqKioq
KioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKgot
ICogQ29weXJpZ2h0IChjKSAyMDAwLCAyMDEzIElCTSBDb3Jwb3JhdGlvbiBhbmQgb3RoZXJzLgor
ICogQ29weXJpZ2h0IChjKSAyMDAwLCAyMDE0IElCTSBDb3Jwb3JhdGlvbiBhbmQgb3RoZXJzLgog
ICogQWxsIHJpZ2h0cyByZXNlcnZlZC4gVGhpcyBwcm9ncmFtIGFuZCB0aGUgYWNjb21wYW55aW5n
IG1hdGVyaWFscwogICogYXJlIG1hZGUgYXZhaWxhYmxlIHVuZGVyIHRoZSB0ZXJtcyBvZiB0aGUg
RWNsaXBzZSBQdWJsaWMgTGljZW5zZSB2MS4wCkBAIC05OTgsNSArOTk4LDUgQEAKIAkgKiA8cD4K
IAkgKiBUaGUgZGVmYXVsdCBpbXBsZW1lbnRhdGlvbiBvZiB0aGlzIG1ldGhvZCByZXR1cm5zIDxj
b2RlPm51bGw8L2NvZGU+LgotCSAqIFN1YmNsYXNzZXMgbWF5IHJlaW1wbGVtZW50LgorCSAqIFN1
YmNsYXNzZXMgbWF5IG92ZXJyaWRlIHRoaXMgYmVoYXZpb3IuCiAJICogPC9wPgogCSAqCmRpZmYg
LS1naXQgYS9vcmcuZWNsaXBzZS5qZHQuY29yZS9kb20vb3JnL2VjbGlwc2UvamR0L2NvcmUvZG9t
L0RlZmF1bHRCaW5kaW5nUmVzb2x2ZXIuamF2YSBiL29yZy5lY2xpcHNlLmpkdC5jb3JlL2RvbS9v
cmcvZWNsaXBzZS9qZHQvY29yZS9kb20vRGVmYXVsdEJpbmRpbmdSZXNvbHZlci5qYXZhCmluZGV4
IGIwNzgyYTQuLmIxODg1NDkgMTAwNjQ0Ci0tLSBhL29yZy5lY2xpcHNlLmpkdC5jb3JlL2RvbS9v
cmcvZWNsaXBzZS9qZHQvY29yZS9kb20vRGVmYXVsdEJpbmRpbmdSZXNvbHZlci5qYXZhCisrKyBi
L29yZy5lY2xpcHNlLmpkdC5jb3JlL2RvbS9vcmcvZWNsaXBzZS9qZHQvY29yZS9kb20vRGVmYXVs
dEJpbmRpbmdSZXNvbHZlci5qYXZhCkBAIC0xLDQgKzEsNCBAQAogLyoqKioqKioqKioqKioqKioq
KioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioq
KioqKioKLSAqIENvcHlyaWdodCAoYykgMjAwMCwgMjAxMyBJQk0gQ29ycG9yYXRpb24gYW5kIG90
aGVycy4KKyAqIENvcHlyaWdodCAoYykgMjAwMCwgMjAxNCBJQk0gQ29ycG9yYXRpb24gYW5kIG90
aGVycy4KICAqIEFsbCByaWdodHMgcmVzZXJ2ZWQuIFRoaXMgcHJvZ3JhbSBhbmQgdGhlIGFjY29t
cGFueWluZyBtYXRlcmlhbHMKICAqIGFyZSBtYWRlIGF2YWlsYWJsZSB1bmRlciB0aGUgdGVybXMg
b2YgdGhlIEVjbGlwc2UgUHVibGljIExpY2Vuc2UgdjEuMApAQCAtNjgsNCArNjgsNSBAQAogaW1w
b3J0IG9yZy5lY2xpcHNlLmpkdC5pbnRlcm5hbC5jb21waWxlci5sb29rdXAuVHlwZUNvbnN0YW50
czsKIGltcG9ydCBvcmcuZWNsaXBzZS5qZHQuaW50ZXJuYWwuY29tcGlsZXIubG9va3VwLlR5cGVJ
ZHM7CitpbXBvcnQgb3JnLmVjbGlwc2UuamR0LmludGVybmFsLmNvbXBpbGVyLmxvb2t1cC5Wb2lk
VHlwZUJpbmRpbmc7CiBpbXBvcnQgb3JnLmVjbGlwc2UuamR0LmludGVybmFsLmNvbXBpbGVyLnBy
b2JsZW0uQWJvcnRDb21waWxhdGlvbjsKIGltcG9ydCBvcmcuZWNsaXBzZS5qZHQuaW50ZXJuYWwu
Y29yZS51dGlsLlV0aWw7CkBAIC0xOTA1LDUgKzE5MDYsNSBAQAogCSAqIDxwPgogCSAqIFRoZSBk
ZWZhdWx0IGltcGxlbWVudGF0aW9uIG9mIHRoaXMgbWV0aG9kIHJldHVybnMgPGNvZGU+bnVsbDwv
Y29kZT4uCi0JICogU3ViY2xhc3NlcyBtYXkgcmVpbXBsZW1lbnQuCisJICogU3ViY2xhc3NlcyBt
YXkgb3ZlcnJpZGUgdGhpcyBiZWhhdmlvci4KIAkgKiA8L3A+CiAJICoKQEAgLTE5MTgsNDQgKzE5
MTksMjUgQEAKIAkJSVR5cGVCaW5kaW5nIGxlYWZDb21wb25lbnRUeXBlID0gdHlwZUJpbmRpbmc7
CiAJCWludCBhY3R1YWxEaW1lbnNpb25zID0gZGltZW5zaW9uczsKKwkJCiAJCWlmICh0eXBlQmlu
ZGluZy5pc0FycmF5KCkpIHsKIAkJCWxlYWZDb21wb25lbnRUeXBlID0gdHlwZUJpbmRpbmcuZ2V0
RWxlbWVudFR5cGUoKTsKIAkJCWFjdHVhbERpbWVuc2lvbnMgKz0gdHlwZUJpbmRpbmcuZ2V0RGlt
ZW5zaW9ucygpOwogCQl9Ci0gCQlvcmcuZWNsaXBzZS5qZHQuaW50ZXJuYWwuY29tcGlsZXIubG9v
a3VwLlR5cGVCaW5kaW5nIGxlYWZUeXBlQmluZGluZyA9IG51bGw7Ci0gCQlpZiAobGVhZkNvbXBv
bmVudFR5cGUuaXNQcmltaXRpdmUoKSkgewotIAkgCQlTdHJpbmcgbmFtZSA9IGxlYWZDb21wb25l
bnRUeXBlLmdldEJpbmFyeU5hbWUoKTsKLQkJCXN3aXRjaChuYW1lLmNoYXJBdCgwKSkgewotCQkJ
CWNhc2UgJ0knIDoKLQkJCQkJbGVhZlR5cGVCaW5kaW5nID0gb3JnLmVjbGlwc2UuamR0LmludGVy
bmFsLmNvbXBpbGVyLmxvb2t1cC5UeXBlQmluZGluZy5JTlQ7Ci0JCQkJCWJyZWFrOwotCQkJCWNh
c2UgJ0InIDoKLQkJCQkJbGVhZlR5cGVCaW5kaW5nID0gb3JnLmVjbGlwc2UuamR0LmludGVybmFs
LmNvbXBpbGVyLmxvb2t1cC5UeXBlQmluZGluZy5CWVRFOwotCQkJCQlicmVhazsKLQkJCQljYXNl
ICdaJyA6Ci0JCQkJCWxlYWZUeXBlQmluZGluZyA9IG9yZy5lY2xpcHNlLmpkdC5pbnRlcm5hbC5j
b21waWxlci5sb29rdXAuVHlwZUJpbmRpbmcuQk9PTEVBTjsKLQkJCQkJYnJlYWs7Ci0JCQkJY2Fz
ZSAnQycgOgotCQkJCQlsZWFmVHlwZUJpbmRpbmcgPSBvcmcuZWNsaXBzZS5qZHQuaW50ZXJuYWwu
Y29tcGlsZXIubG9va3VwLlR5cGVCaW5kaW5nLkNIQVI7Ci0JCQkJCWJyZWFrOwotCQkJCWNhc2Ug
J0onIDoKLQkJCQkJbGVhZlR5cGVCaW5kaW5nID0gb3JnLmVjbGlwc2UuamR0LmludGVybmFsLmNv
bXBpbGVyLmxvb2t1cC5UeXBlQmluZGluZy5MT05HOwotCQkJCQlicmVhazsKLQkJCQljYXNlICdT
JyA6Ci0JCQkJCWxlYWZUeXBlQmluZGluZyA9IG9yZy5lY2xpcHNlLmpkdC5pbnRlcm5hbC5jb21w
aWxlci5sb29rdXAuVHlwZUJpbmRpbmcuU0hPUlQ7Ci0JCQkJCWJyZWFrOwotCQkJCWNhc2UgJ0Qn
IDoKLQkJCQkJbGVhZlR5cGVCaW5kaW5nID0gb3JnLmVjbGlwc2UuamR0LmludGVybmFsLmNvbXBp
bGVyLmxvb2t1cC5UeXBlQmluZGluZy5ET1VCTEU7Ci0JCQkJCWJyZWFrOwotCQkJCWNhc2UgJ0Yn
IDoKLQkJCQkJbGVhZlR5cGVCaW5kaW5nID0gb3JnLmVjbGlwc2UuamR0LmludGVybmFsLmNvbXBp
bGVyLmxvb2t1cC5UeXBlQmluZGluZy5GTE9BVDsKLQkJCQkJYnJlYWs7Ci0JCQkJY2FzZSAnVicg
OgotCQkJCQl0aHJvdyBuZXcgSWxsZWdhbEFyZ3VtZW50RXhjZXB0aW9uKCk7Ci0JCQl9Ci0gCQl9
IGVsc2UgewotIAkJCWlmICghKGxlYWZDb21wb25lbnRUeXBlIGluc3RhbmNlb2YgVHlwZUJpbmRp
bmcpKSByZXR1cm4gbnVsbDsKLSAJCQlsZWFmVHlwZUJpbmRpbmcgPSAoKFR5cGVCaW5kaW5nKSBs
ZWFmQ29tcG9uZW50VHlwZSkuYmluZGluZzsKLSAJCX0KLQkJcmV0dXJuIHRoaXMuZ2V0VHlwZUJp
bmRpbmcobG9va3VwRW52aXJvbm1lbnQoKS5jcmVhdGVBcnJheVR5cGUobGVhZlR5cGVCaW5kaW5n
LCBhY3R1YWxEaW1lbnNpb25zKSk7CisJCWlmICghKGxlYWZDb21wb25lbnRUeXBlIGluc3RhbmNl
b2YgVHlwZUJpbmRpbmcpKSByZXR1cm4gbnVsbDsKKwkJb3JnLmVjbGlwc2UuamR0LmludGVybmFs
LmNvbXBpbGVyLmxvb2t1cC5UeXBlQmluZGluZyBsZWFmVHlwZUJpbmRpbmcgPSAKKwkJCQkJCQkJ
CQkJKChUeXBlQmluZGluZykgbGVhZkNvbXBvbmVudFR5cGUpLmJpbmRpbmc7CisJCWlmIChsZWFm
VHlwZUJpbmRpbmcgaW5zdGFuY2VvZiBWb2lkVHlwZUJpbmRpbmcpIHsKKwkJCXRocm93IG5ldyBJ
bGxlZ2FsQXJndW1lbnRFeGNlcHRpb24oKTsKKwkJfQorCQlpZiAodHlwZUJpbmRpbmcuaXNBcnJh
eSgpKSB7CisJCQlyZXR1cm4gdGhpcy5nZXRUeXBlQmluZGluZyhsb29rdXBFbnZpcm9ubWVudCgp
LmNyZWF0ZUFycmF5VHlwZSgKKwkJCQkJCQkJCQkJbGVhZlR5cGVCaW5kaW5nLAorCQkJCQkJCQkJ
CQlhY3R1YWxEaW1lbnNpb25zLAorCQkJCQkJCQkJCQkoKChUeXBlQmluZGluZykgdHlwZUJpbmRp
bmcpLmJpbmRpbmcpLmdldFR5cGVBbm5vdGF0aW9ucygpKSk7CisJCX0gZWxzZSB7CisJCQlyZXR1
cm4gdGhpcy5nZXRUeXBlQmluZGluZyhsb29rdXBFbnZpcm9ubWVudCgpLmNyZWF0ZUFycmF5VHlw
ZSgKKwkJCQkJCQkJCQkJbGVhZlR5cGVCaW5kaW5nLAorCQkJCQkJCQkJCQlhY3R1YWxEaW1lbnNp
b25zKSk7CisJCX0KIAl9CiB9
</data>

          </attachment>
          <attachment
              isobsolete="0"
              ispatch="1"
              isprivate="0"
          >
            <attachid>239822</attachid>
            <date>2014-02-11 08:21:00 -0500</date>
            <delta_ts>2014-02-11 08:21:21 -0500</delta_ts>
            <desc>Updated patch</desc>
            <filename>Bug-426459.patch</filename>
            <type>text/plain</type>
            <size>12066</size>
            <attacher name="Jay Arthanareeswaran">jarthana</attacher>
            
              <data encoding="base64">IyMjIEVjbGlwc2UgV29ya3NwYWNlIFBhdGNoIDEuMAojUCBvcmcuZWNsaXBzZS5qZHQuY29yZS50
ZXN0cy5tb2RlbApkaWZmIC0tZ2l0IHNyYy9vcmcvZWNsaXBzZS9qZHQvY29yZS90ZXN0cy9kb20v
QVNUQ29udmVydGVyMThUZXN0LmphdmEgc3JjL29yZy9lY2xpcHNlL2pkdC9jb3JlL3Rlc3RzL2Rv
bS9BU1RDb252ZXJ0ZXIxOFRlc3QuamF2YQppbmRleCA0NWMyMWVhLi4zOWYyY2E3IDEwMDY0NAot
LS0gc3JjL29yZy9lY2xpcHNlL2pkdC9jb3JlL3Rlc3RzL2RvbS9BU1RDb252ZXJ0ZXIxOFRlc3Qu
amF2YQorKysgc3JjL29yZy9lY2xpcHNlL2pkdC9jb3JlL3Rlc3RzL2RvbS9BU1RDb252ZXJ0ZXIx
OFRlc3QuamF2YQpAQCAtNDA2OCwzICs0MDY4LDE1OSBAQAogCQlhc3NlcnROb3ROdWxsKCJSZWNl
aXZlciBzaG91bGQgbm90IGJlIG51bGwiLCByZWNlaXZlcik7CiAJfQorCS8vIGh0dHBzOi8vYnVn
cy5lY2xpcHNlLm9yZy9idWdzL3Nob3dfYnVnLmNnaT9pZD00MjY0NTkKKwlwdWJsaWMgdm9pZCB0
ZXN0QnVnNDI2NDU5KCkgdGhyb3dzIEphdmFNb2RlbEV4Y2VwdGlvbiB7CisJCVN0cmluZyBjb250
ZW50cyA9CisJCQkiaW1wb3J0IGphdmEubGFuZy5hbm5vdGF0aW9uLio7XG4iICsKKwkJCSJAVGFy
Z2V0KEVsZW1lbnRUeXBlLlRZUEVfVVNFKSBAaW50ZXJmYWNlIEEge31cbiIgKworCQkJIkBUYXJn
ZXQoRWxlbWVudFR5cGUuVFlQRV9VU0UpIEBpbnRlcmZhY2UgQiB7fVxuIiArCisJCQkiQFRhcmdl
dChFbGVtZW50VHlwZS5UWVBFX1VTRSkgQGludGVyZmFjZSBDIHt9XG4iICsKKwkJCSJwdWJsaWMg
Y2xhc3MgWCB7XG4iICsKKwkJCSIJCUBBIGludCBAQiBbXSBAQyBbXSBAQSBbXSBpcztcbiIgKwor
CQkJIgkJQEMgU3RyaW5nIEBBIFtdIEBCIFtdIEBDIFtdIHNzO1xuIiArCisJCQkiCQlAQyBTdHJp
bmcgQEEgW10gW10gW10gW10gc3NzO1xuIiArCisJCQkifSI7CisJCXRoaXMud29ya2luZ0NvcHkg
PSBnZXRXb3JraW5nQ29weSgiL0NvbnZlcnRlcjE4L3NyYy9YLmphdmEiLCB0cnVlKTsKKwkJQVNU
Tm9kZSBub2RlID0gYnVpbGRBU1QoY29udGVudHMsIHRoaXMud29ya2luZ0NvcHkpOworCQlhc3Nl
cnRFcXVhbHMoIk5vdCBhIGNvbXBpbGF0aW9uIHVuaXQiLCBBU1ROb2RlLkNPTVBJTEFUSU9OX1VO
SVQsIG5vZGUuZ2V0Tm9kZVR5cGUoKSk7CisJCUNvbXBpbGF0aW9uVW5pdCBjb21waWxhdGlvblVu
aXQgPSAoQ29tcGlsYXRpb25Vbml0KSBub2RlOworCQlhc3NlcnRQcm9ibGVtc1NpemUoY29tcGls
YXRpb25Vbml0LCAwKTsKKwkJbm9kZSA9IGdldEFTVE5vZGUoY29tcGlsYXRpb25Vbml0LCAzLCAw
KTsKKwkJYXNzZXJ0VHJ1ZSgiTm90IGEgZmllbGQgZGVjbGFyYXRpb24iLCBub2RlLmdldE5vZGVU
eXBlKCkgPT0gQVNUTm9kZS5GSUVMRF9ERUNMQVJBVElPTik7CisJCUZpZWxkRGVjbGFyYXRpb24g
ZmllbGQgPSAoRmllbGREZWNsYXJhdGlvbikgbm9kZTsKKwkJVHlwZSB0eXBlID0gZmllbGQuZ2V0
VHlwZSgpOworCQlJVHlwZUJpbmRpbmcgb3JpZ2luYWwgPSB0eXBlLnJlc29sdmVCaW5kaW5nKCk7
CisJCWFzc2VydEVxdWFscygiSW5jb3JyZWN0IHR5cGUgYmluZGluZyIsICJAQSBpbnQgQEIgW10g
QEMgW10gQEEgW10iLCBvcmlnaW5hbC50b1N0cmluZygpKTsKKwkJSVR5cGVCaW5kaW5nIGJpbmRp
bmcgPSBvcmlnaW5hbC5jcmVhdGVBcnJheVR5cGUoMSk7CisJCWFzc2VydEVxdWFscygiSW5jb3Jy
ZWN0IHR5cGUgYmluZGluZyIsICJAQSBpbnQgW10gQEIgW10gQEMgW10gQEEgW10iLCBiaW5kaW5n
LnRvU3RyaW5nKCkpOworCQlpbnQgZGltcyA9IGJpbmRpbmcuZ2V0RGltZW5zaW9ucygpOworCQlh
c3NlcnRFcXVhbHMoIkluY29ycmVjdCBubyBvZiBkaW1lbnNpb25zIiwgNCwgZGltcyk7CisJCUlB
bm5vdGF0aW9uQmluZGluZ1tdIGFubm90YXRpb25zID0gYmluZGluZy5nZXRUeXBlQW5ub3RhdGlv
bnMoKTsKKwkJYXNzZXJ0RXF1YWxzKCJJbmNvcnJlY3Qgbm8gb2YgdHlwZSBhbm5vdGF0aW9ucyIs
IDAsIGFubm90YXRpb25zLmxlbmd0aCk7CisJCWJpbmRpbmcgPSBiaW5kaW5nLmdldENvbXBvbmVu
dFR5cGUoKTsKKwkJYW5ub3RhdGlvbnMgPSBiaW5kaW5nLmdldFR5cGVBbm5vdGF0aW9ucygpOwor
CQlhc3NlcnRFcXVhbHMoIkluY29ycmVjdCBubyBvZiB0eXBlIGFubm90YXRpb25zIiwgMSwgYW5u
b3RhdGlvbnMubGVuZ3RoKTsKKwkJYXNzZXJ0RXF1YWxzKCJJbmNvcnJlY3QgYW5ub3RhdGlvbiIs
ICJAQigpIiwgYW5ub3RhdGlvbnNbMF0udG9TdHJpbmcoKSk7CisJCWJpbmRpbmcgPSBiaW5kaW5n
LmdldENvbXBvbmVudFR5cGUoKTsKKwkJYW5ub3RhdGlvbnMgPSBiaW5kaW5nLmdldFR5cGVBbm5v
dGF0aW9ucygpOworCQlhc3NlcnRFcXVhbHMoIkluY29ycmVjdCBubyBvZiB0eXBlIGFubm90YXRp
b25zIiwgMSwgYW5ub3RhdGlvbnMubGVuZ3RoKTsKKwkJYXNzZXJ0RXF1YWxzKCJJbmNvcnJlY3Qg
YW5ub3RhdGlvbiIsICJAQygpIiwgYW5ub3RhdGlvbnNbMF0udG9TdHJpbmcoKSk7CisJCWJpbmRp
bmcgPSBiaW5kaW5nLmdldENvbXBvbmVudFR5cGUoKTsKKwkJYW5ub3RhdGlvbnMgPSBiaW5kaW5n
LmdldFR5cGVBbm5vdGF0aW9ucygpOworCQlhc3NlcnRFcXVhbHMoIkluY29ycmVjdCBubyBvZiB0
eXBlIGFubm90YXRpb25zIiwgMSwgYW5ub3RhdGlvbnMubGVuZ3RoKTsKKwkJYXNzZXJ0RXF1YWxz
KCJJbmNvcnJlY3QgYW5ub3RhdGlvbiIsICJAQSgpIiwgYW5ub3RhdGlvbnNbMF0udG9TdHJpbmco
KSk7CisJCWJpbmRpbmcgPSBiaW5kaW5nLmdldEVsZW1lbnRUeXBlKCk7CisJCWFubm90YXRpb25z
ID0gYmluZGluZy5nZXRUeXBlQW5ub3RhdGlvbnMoKTsKKwkJYXNzZXJ0RXF1YWxzKCJJbmNvcnJl
Y3Qgbm8gb2YgdHlwZSBhbm5vdGF0aW9ucyIsIDEsIGFubm90YXRpb25zLmxlbmd0aCk7CisJCWFz
c2VydEVxdWFscygiSW5jb3JyZWN0IGFubm90YXRpb24iLCAiQEEoKSIsIGFubm90YXRpb25zWzBd
LnRvU3RyaW5nKCkpOworCQkKKwkJbm9kZSA9IGdldEFTVE5vZGUoY29tcGlsYXRpb25Vbml0LCAz
LCAxKTsKKwkJYXNzZXJ0VHJ1ZSgiTm90IGEgZmllbGQgZGVjbGFyYXRpb24iLCBub2RlLmdldE5v
ZGVUeXBlKCkgPT0gQVNUTm9kZS5GSUVMRF9ERUNMQVJBVElPTik7CisJCWZpZWxkID0gKEZpZWxk
RGVjbGFyYXRpb24pIG5vZGU7CisJCXR5cGUgPSBmaWVsZC5nZXRUeXBlKCk7CisJCW9yaWdpbmFs
ID0gdHlwZS5yZXNvbHZlQmluZGluZygpOworCQlhc3NlcnRFcXVhbHMoIkluY29ycmVjdCB0eXBl
IGJpbmRpbmciLCAiQEMgU3RyaW5nIEBBIFtdIEBCIFtdIEBDIFtdIiwgb3JpZ2luYWwudG9TdHJp
bmcoKSk7CisJCWJpbmRpbmcgPSBvcmlnaW5hbC5jcmVhdGVBcnJheVR5cGUoMSk7CisJCWFzc2Vy
dEVxdWFscygiSW5jb3JyZWN0IHR5cGUgYmluZGluZyIsICJAQyBTdHJpbmcgW10gQEEgW10gQEIg
W10gQEMgW10iLCBiaW5kaW5nLnRvU3RyaW5nKCkpOworCQlkaW1zID0gYmluZGluZy5nZXREaW1l
bnNpb25zKCk7CisJCWFzc2VydEVxdWFscygiSW5jb3JyZWN0IG5vIG9mIGRpbWVuc2lvbnMiLCA0
LCBkaW1zKTsKKwkJCisJCWJpbmRpbmcgPSBvcmlnaW5hbC5jcmVhdGVBcnJheVR5cGUoLTEpOwor
CQlhc3NlcnRFcXVhbHMoIkluY29ycmVjdCB0eXBlIGJpbmRpbmciLCAiQEMgU3RyaW5nIEBCIFtd
IEBDIFtdIiwgYmluZGluZy50b1N0cmluZygpKTsKKwkJZGltcyA9IGJpbmRpbmcuZ2V0RGltZW5z
aW9ucygpOworCQlhc3NlcnRFcXVhbHMoIkluY29ycmVjdCBubyBvZiBkaW1lbnNpb25zIiwgMiwg
ZGltcyk7CisJCQorCQliaW5kaW5nID0gb3JpZ2luYWwuY3JlYXRlQXJyYXlUeXBlKC0yKTsKKwkJ
YXNzZXJ0RXF1YWxzKCJJbmNvcnJlY3QgdHlwZSBiaW5kaW5nIiwgIkBDIFN0cmluZyBAQyBbXSIs
IGJpbmRpbmcudG9TdHJpbmcoKSk7CisJCWRpbXMgPSBiaW5kaW5nLmdldERpbWVuc2lvbnMoKTsK
KwkJYXNzZXJ0RXF1YWxzKCJJbmNvcnJlY3Qgbm8gb2YgZGltZW5zaW9ucyIsIDEsIGRpbXMpOwor
CQkKKwkJbm9kZSA9IGdldEFTVE5vZGUoY29tcGlsYXRpb25Vbml0LCAzLCAyKTsKKwkJYXNzZXJ0
VHJ1ZSgiTm90IGEgZmllbGQgZGVjbGFyYXRpb24iLCBub2RlLmdldE5vZGVUeXBlKCkgPT0gQVNU
Tm9kZS5GSUVMRF9ERUNMQVJBVElPTik7CisJCWZpZWxkID0gKEZpZWxkRGVjbGFyYXRpb24pIG5v
ZGU7CisJCXR5cGUgPSBmaWVsZC5nZXRUeXBlKCk7CisJCW9yaWdpbmFsID0gdHlwZS5yZXNvbHZl
QmluZGluZygpOworCQlhc3NlcnRFcXVhbHMoIkluY29ycmVjdCB0eXBlIGJpbmRpbmciLCAiQEMg
U3RyaW5nIEBBIFtdIFtdIFtdIFtdIiwgb3JpZ2luYWwudG9TdHJpbmcoKSk7CisJCWJpbmRpbmcg
PSBvcmlnaW5hbC5jcmVhdGVBcnJheVR5cGUoLTEpOworCQlhc3NlcnRFcXVhbHMoIkluY29ycmVj
dCB0eXBlIGJpbmRpbmciLCAiQEMgU3RyaW5nIFtdIFtdIFtdIiwgYmluZGluZy50b1N0cmluZygp
KTsKKwkJZGltcyA9IGJpbmRpbmcuZ2V0RGltZW5zaW9ucygpOworCQlhc3NlcnRFcXVhbHMoIklu
Y29ycmVjdCBubyBvZiBkaW1lbnNpb25zIiwgMywgZGltcyk7CisJCWJpbmRpbmcgPSBiaW5kaW5n
LmNyZWF0ZUFycmF5VHlwZSgtMik7CisJCWFzc2VydEVxdWFscygiSW5jb3JyZWN0IHR5cGUgYmlu
ZGluZyIsICJAQyBTdHJpbmcgW10iLCBiaW5kaW5nLnRvU3RyaW5nKCkpOworCQlkaW1zID0gYmlu
ZGluZy5nZXREaW1lbnNpb25zKCk7CisJCWFzc2VydEVxdWFscygiSW5jb3JyZWN0IG5vIG9mIGRp
bWVuc2lvbnMiLCAxLCBkaW1zKTsKKwl9CisJLy8gaHR0cHM6Ly9idWdzLmVjbGlwc2Uub3JnL2J1
Z3Mvc2hvd19idWcuY2dpP2lkPTQyNjQ1OQorCXB1YmxpYyB2b2lkIHRlc3RCdWc0MjY0NTlhKCkg
dGhyb3dzIEphdmFNb2RlbEV4Y2VwdGlvbiB7CisJCVN0cmluZyBjb250ZW50cyA9CisJCQkiaW1w
b3J0IGphdmEubGFuZy5hbm5vdGF0aW9uLio7XG4iICsKKwkJCSJAVGFyZ2V0KEVsZW1lbnRUeXBl
LlRZUEVfVVNFKSBAaW50ZXJmYWNlIEEge31cbiIgKworCQkJIkBUYXJnZXQoRWxlbWVudFR5cGUu
VFlQRV9VU0UpIEBpbnRlcmZhY2UgQiB7fVxuIiArCisJCQkiQFRhcmdldChFbGVtZW50VHlwZS5U
WVBFX1VTRSkgQGludGVyZmFjZSBDIHt9XG4iICsKKwkJCSJwdWJsaWMgY2xhc3MgWCB7XG4iICsK
KwkJCSIJCXB1YmxpYyB2b2lkIGZvbygpIHt9XG4iICsKKwkJCSIJCXB1YmxpYyBAQSBYLkBCIFkg
Zm9vKEBDIGludCBpKXsgcmV0dXJuIG51bGw7fVxuIiArCisJCQkiCQlwdWJsaWMgQEEgQEIgWCBm
b28oaW50IGksIGludCBqKXsgcmV0dXJuIG51bGw7fVxuIiArCisJCQkiCQlwdWJsaWMgQEEgWC5Z
IFtdIEBCIFtdIGZvbyhmbG9hdCBmKXsgcmV0dXJuIG51bGw7fVxuIiArCisJCQkiCQljbGFzcyBZ
IHt9XG4iICsKKwkJCSJ9IjsKKwkJdGhpcy53b3JraW5nQ29weSA9IGdldFdvcmtpbmdDb3B5KCIv
Q29udmVydGVyMTgvc3JjL1guamF2YSIsIHRydWUpOworCQlBU1ROb2RlIG5vZGUgPSBidWlsZEFT
VChjb250ZW50cywgdGhpcy53b3JraW5nQ29weSk7CisJCWFzc2VydEVxdWFscygiTm90IGEgY29t
cGlsYXRpb24gdW5pdCIsIEFTVE5vZGUuQ09NUElMQVRJT05fVU5JVCwgbm9kZS5nZXROb2RlVHlw
ZSgpKTsKKwkJQ29tcGlsYXRpb25Vbml0IGNvbXBpbGF0aW9uVW5pdCA9IChDb21waWxhdGlvblVu
aXQpIG5vZGU7CisJCWFzc2VydFByb2JsZW1zU2l6ZShjb21waWxhdGlvblVuaXQsIDApOworCQkK
KwkJbm9kZSA9IGdldEFTVE5vZGUoY29tcGlsYXRpb25Vbml0LCAzLCAwKTsKKwkJYXNzZXJ0RXF1
YWxzKCJOb3QgYSBtZXRob2QgZGVjbGFyYXRpb24iLCBBU1ROb2RlLk1FVEhPRF9ERUNMQVJBVElP
Tiwgbm9kZS5nZXROb2RlVHlwZSgpKTsKKwkJVHlwZSB0eXBlID0gKChNZXRob2REZWNsYXJhdGlv
bikgbm9kZSkuZ2V0UmV0dXJuVHlwZTIoKTsKKwkJSVR5cGVCaW5kaW5nIGJpbmRpbmcgPSB0eXBl
LnJlc29sdmVCaW5kaW5nKCk7CisJCWFzc2VydE5vdE51bGwoIkJpbmRpbmcgc2hvdWxkIG5vdCBi
ZSBudWxsIiwgYmluZGluZyk7CisJCXRyeSB7CisJCQliaW5kaW5nID0gYmluZGluZy5jcmVhdGVB
cnJheVR5cGUoMSk7CisJCQliaW5kaW5nID0gbnVsbDsKKwkJfSBjYXRjaChJbGxlZ2FsQXJndW1l
bnRFeGNlcHRpb24gaWFlKSB7CisJCX0KKwkJYXNzZXJ0Tm90TnVsbCgiSWxsZWdhbEFyZ3VtZW50
RXhjZXB0aW9uIHNob3VsZCBoYXZlIGJlZW4gdGhyb3duIiwgYmluZGluZyk7CisKKwkJbm9kZSA9
IGdldEFTVE5vZGUoY29tcGlsYXRpb25Vbml0LCAzLCAxKTsKKwkJYXNzZXJ0RXF1YWxzKCJOb3Qg
YSBtZXRob2QgZGVjbGFyYXRpb24iLCBBU1ROb2RlLk1FVEhPRF9ERUNMQVJBVElPTiwgbm9kZS5n
ZXROb2RlVHlwZSgpKTsKKwkJdHlwZSA9ICgoTWV0aG9kRGVjbGFyYXRpb24pIG5vZGUpLmdldFJl
dHVyblR5cGUyKCk7CisJCWJpbmRpbmcgPSB0eXBlLnJlc29sdmVCaW5kaW5nKCk7CisJCWFzc2Vy
dEVxdWFscygiSW5jb3JyZWN0IHR5cGUgYmluZGluZyIsICJAQSBYLkBCIFkiLCBiaW5kaW5nLnRv
U3RyaW5nKCkpOworCQliaW5kaW5nID0gYmluZGluZy5jcmVhdGVBcnJheVR5cGUoMik7CisJCWFz
c2VydEVxdWFscygiSW5jb3JyZWN0IHR5cGUgYmluZGluZyIsICJAQSBYLkBCIFkgW10gW10iLCBi
aW5kaW5nLnRvU3RyaW5nKCkpOworCQlpbnQgZGltcyA9IGJpbmRpbmcuZ2V0RGltZW5zaW9ucygp
OworCQlhc3NlcnRFcXVhbHMoIkluY29ycmVjdCBubyBvZiBkaW1lbnNpb25zIiwgMiwgZGltcyk7
CisJCVNpbmdsZVZhcmlhYmxlRGVjbGFyYXRpb24gcGFyYW0gPSAoU2luZ2xlVmFyaWFibGVEZWNs
YXJhdGlvbikgKChNZXRob2REZWNsYXJhdGlvbikgbm9kZSkucGFyYW1ldGVycygpLmdldCgwKTsK
KwkJdHlwZSA9IHBhcmFtLmdldFR5cGUoKTsKKwkJYmluZGluZyA9IHR5cGUucmVzb2x2ZUJpbmRp
bmcoKTsKKwkJYXNzZXJ0RXF1YWxzKCJJbmNvcnJlY3QgdHlwZSBiaW5kaW5nIiwgIkBDIGludCIs
IGJpbmRpbmcudG9TdHJpbmcoKSk7CisJCWJpbmRpbmcgPSBiaW5kaW5nLmNyZWF0ZUFycmF5VHlw
ZSgyKTsKKwkJYXNzZXJ0RXF1YWxzKCJJbmNvcnJlY3QgdHlwZSBiaW5kaW5nIiwgIkBDIGludCBb
XSBbXSIsIGJpbmRpbmcudG9TdHJpbmcoKSk7CisJCQorCQlub2RlID0gZ2V0QVNUTm9kZShjb21w
aWxhdGlvblVuaXQsIDMsIDIpOworCQlhc3NlcnRFcXVhbHMoIk5vdCBhIG1ldGhvZCBkZWNsYXJh
dGlvbiIsIEFTVE5vZGUuTUVUSE9EX0RFQ0xBUkFUSU9OLCBub2RlLmdldE5vZGVUeXBlKCkpOwor
CQl0eXBlID0gKChNZXRob2REZWNsYXJhdGlvbikgbm9kZSkuZ2V0UmV0dXJuVHlwZTIoKTsKKwkJ
YmluZGluZyA9IHR5cGUucmVzb2x2ZUJpbmRpbmcoKTsKKwkJYXNzZXJ0RXF1YWxzKCJJbmNvcnJl
Y3QgdHlwZSBiaW5kaW5nIiwgIkBBIEBCIFgiLCBiaW5kaW5nLnRvU3RyaW5nKCkpOworCQliaW5k
aW5nID0gYmluZGluZy5jcmVhdGVBcnJheVR5cGUoMik7CisJCWFzc2VydEVxdWFscygiSW5jb3Jy
ZWN0IHR5cGUgYmluZGluZyIsICJAQSBAQiBYIFtdIFtdIiwgYmluZGluZy50b1N0cmluZygpKTsK
KwkJZGltcyA9IGJpbmRpbmcuZ2V0RGltZW5zaW9ucygpOworCQlhc3NlcnRFcXVhbHMoIkluY29y
cmVjdCBubyBvZiBkaW1lbnNpb25zIiwgMiwgZGltcyk7CisJCQorCQlub2RlID0gZ2V0QVNUTm9k
ZShjb21waWxhdGlvblVuaXQsIDMsIDMpOworCQlhc3NlcnRFcXVhbHMoIk5vdCBhIG1ldGhvZCBk
ZWNsYXJhdGlvbiIsIEFTVE5vZGUuTUVUSE9EX0RFQ0xBUkFUSU9OLCBub2RlLmdldE5vZGVUeXBl
KCkpOworCQl0eXBlID0gKChNZXRob2REZWNsYXJhdGlvbikgbm9kZSkuZ2V0UmV0dXJuVHlwZTIo
KTsKKwkJSVR5cGVCaW5kaW5nIG9yaWdpbmFsID0gdHlwZS5yZXNvbHZlQmluZGluZygpOworCQlh
c3NlcnRFcXVhbHMoIkluY29ycmVjdCB0eXBlIGJpbmRpbmciLCAiQEEgWC5ZIFtdIEBCIFtdIiwg
b3JpZ2luYWwudG9TdHJpbmcoKSk7CisJCWJpbmRpbmcgPSBvcmlnaW5hbC5jcmVhdGVBcnJheVR5
cGUoMSk7CisJCWFzc2VydEVxdWFscygiSW5jb3JyZWN0IHR5cGUgYmluZGluZyIsICJAQSBYLlkg
W10gW10gQEIgW10iLCBiaW5kaW5nLnRvU3RyaW5nKCkpOworCQlkaW1zID0gYmluZGluZy5nZXRE
aW1lbnNpb25zKCk7CisJCWFzc2VydEVxdWFscygiSW5jb3JyZWN0IG5vIG9mIGRpbWVuc2lvbnMi
LCAzLCBkaW1zKTsKKwkJCisJCWJpbmRpbmcgPSBvcmlnaW5hbC5jcmVhdGVBcnJheVR5cGUoLTEp
OworCQlhc3NlcnRFcXVhbHMoIkluY29ycmVjdCB0eXBlIGJpbmRpbmciLCAiQEEgWC5ZIEBCIFtd
IiwgYmluZGluZy50b1N0cmluZygpKTsKKwkJZGltcyA9IGJpbmRpbmcuZ2V0RGltZW5zaW9ucygp
OworCQlhc3NlcnRFcXVhbHMoIkluY29ycmVjdCBubyBvZiBkaW1lbnNpb25zIiwgMSwgZGltcyk7
CisKKwl9CiB9CiNQIG9yZy5lY2xpcHNlLmpkdC5jb3JlCmRpZmYgLS1naXQgZG9tL29yZy9lY2xp
cHNlL2pkdC9jb3JlL2RvbS9EZWZhdWx0QmluZGluZ1Jlc29sdmVyLmphdmEgZG9tL29yZy9lY2xp
cHNlL2pkdC9jb3JlL2RvbS9EZWZhdWx0QmluZGluZ1Jlc29sdmVyLmphdmEKaW5kZXggZjU1MTU4
MC4uODRjYmI4MSAxMDA2NDQKLS0tIGRvbS9vcmcvZWNsaXBzZS9qZHQvY29yZS9kb20vRGVmYXVs
dEJpbmRpbmdSZXNvbHZlci5qYXZhCisrKyBkb20vb3JnL2VjbGlwc2UvamR0L2NvcmUvZG9tL0Rl
ZmF1bHRCaW5kaW5nUmVzb2x2ZXIuamF2YQpAQCAtNjgsNCArNjgsNSBAQAogaW1wb3J0IG9yZy5l
Y2xpcHNlLmpkdC5pbnRlcm5hbC5jb21waWxlci5sb29rdXAuVHlwZUNvbnN0YW50czsKIGltcG9y
dCBvcmcuZWNsaXBzZS5qZHQuaW50ZXJuYWwuY29tcGlsZXIubG9va3VwLlR5cGVJZHM7CitpbXBv
cnQgb3JnLmVjbGlwc2UuamR0LmludGVybmFsLmNvbXBpbGVyLmxvb2t1cC5Wb2lkVHlwZUJpbmRp
bmc7CiBpbXBvcnQgb3JnLmVjbGlwc2UuamR0LmludGVybmFsLmNvbXBpbGVyLnByb2JsZW0uQWJv
cnRDb21waWxhdGlvbjsKIGltcG9ydCBvcmcuZWNsaXBzZS5qZHQuaW50ZXJuYWwuY29yZS51dGls
LlV0aWw7CkBAIC0xOTI1LDQwICsxOTI2LDQyIEBACiAJCQlhY3R1YWxEaW1lbnNpb25zICs9IHR5
cGVCaW5kaW5nLmdldERpbWVuc2lvbnMoKTsKIAkJfQotIAkJb3JnLmVjbGlwc2UuamR0LmludGVy
bmFsLmNvbXBpbGVyLmxvb2t1cC5UeXBlQmluZGluZyBsZWFmVHlwZUJpbmRpbmcgPSBudWxsOwot
IAkJaWYgKGxlYWZDb21wb25lbnRUeXBlLmlzUHJpbWl0aXZlKCkpIHsKLSAJIAkJU3RyaW5nIG5h
bWUgPSBsZWFmQ29tcG9uZW50VHlwZS5nZXRCaW5hcnlOYW1lKCk7Ci0JCQlzd2l0Y2gobmFtZS5j
aGFyQXQoMCkpIHsKLQkJCQljYXNlICdJJyA6Ci0JCQkJCWxlYWZUeXBlQmluZGluZyA9IG9yZy5l
Y2xpcHNlLmpkdC5pbnRlcm5hbC5jb21waWxlci5sb29rdXAuVHlwZUJpbmRpbmcuSU5UOwotCQkJ
CQlicmVhazsKLQkJCQljYXNlICdCJyA6Ci0JCQkJCWxlYWZUeXBlQmluZGluZyA9IG9yZy5lY2xp
cHNlLmpkdC5pbnRlcm5hbC5jb21waWxlci5sb29rdXAuVHlwZUJpbmRpbmcuQllURTsKLQkJCQkJ
YnJlYWs7Ci0JCQkJY2FzZSAnWicgOgotCQkJCQlsZWFmVHlwZUJpbmRpbmcgPSBvcmcuZWNsaXBz
ZS5qZHQuaW50ZXJuYWwuY29tcGlsZXIubG9va3VwLlR5cGVCaW5kaW5nLkJPT0xFQU47Ci0JCQkJ
CWJyZWFrOwotCQkJCWNhc2UgJ0MnIDoKLQkJCQkJbGVhZlR5cGVCaW5kaW5nID0gb3JnLmVjbGlw
c2UuamR0LmludGVybmFsLmNvbXBpbGVyLmxvb2t1cC5UeXBlQmluZGluZy5DSEFSOwotCQkJCQli
cmVhazsKLQkJCQljYXNlICdKJyA6Ci0JCQkJCWxlYWZUeXBlQmluZGluZyA9IG9yZy5lY2xpcHNl
LmpkdC5pbnRlcm5hbC5jb21waWxlci5sb29rdXAuVHlwZUJpbmRpbmcuTE9ORzsKLQkJCQkJYnJl
YWs7Ci0JCQkJY2FzZSAnUycgOgotCQkJCQlsZWFmVHlwZUJpbmRpbmcgPSBvcmcuZWNsaXBzZS5q
ZHQuaW50ZXJuYWwuY29tcGlsZXIubG9va3VwLlR5cGVCaW5kaW5nLlNIT1JUOwotCQkJCQlicmVh
azsKLQkJCQljYXNlICdEJyA6Ci0JCQkJCWxlYWZUeXBlQmluZGluZyA9IG9yZy5lY2xpcHNlLmpk
dC5pbnRlcm5hbC5jb21waWxlci5sb29rdXAuVHlwZUJpbmRpbmcuRE9VQkxFOwotCQkJCQlicmVh
azsKLQkJCQljYXNlICdGJyA6Ci0JCQkJCWxlYWZUeXBlQmluZGluZyA9IG9yZy5lY2xpcHNlLmpk
dC5pbnRlcm5hbC5jb21waWxlci5sb29rdXAuVHlwZUJpbmRpbmcuRkxPQVQ7Ci0JCQkJCWJyZWFr
OwotCQkJCWNhc2UgJ1YnIDoKLQkJCQkJdGhyb3cgbmV3IElsbGVnYWxBcmd1bWVudEV4Y2VwdGlv
bigpOworCQlpZiAoIShsZWFmQ29tcG9uZW50VHlwZSBpbnN0YW5jZW9mIFR5cGVCaW5kaW5nKSkg
cmV0dXJuIG51bGw7CisJCW9yZy5lY2xpcHNlLmpkdC5pbnRlcm5hbC5jb21waWxlci5sb29rdXAu
VHlwZUJpbmRpbmcgbGVhZlR5cGVCaW5kaW5nID0gCisJCQkJCQkJCQkJCSgoVHlwZUJpbmRpbmcp
IGxlYWZDb21wb25lbnRUeXBlKS5iaW5kaW5nOworCQlpZiAobGVhZlR5cGVCaW5kaW5nIGluc3Rh
bmNlb2YgVm9pZFR5cGVCaW5kaW5nKSB7CisJCQl0aHJvdyBuZXcgSWxsZWdhbEFyZ3VtZW50RXhj
ZXB0aW9uKCk7CisJCX0KKwkJaWYgKHR5cGVCaW5kaW5nLmlzQXJyYXkoKSkgeworCQkJcmV0dXJu
IHRoaXMuZ2V0VHlwZUJpbmRpbmcobG9va3VwRW52aXJvbm1lbnQoKS5jcmVhdGVBcnJheVR5cGUo
CisJCQkJCQkJCQkJCWxlYWZUeXBlQmluZGluZywKKwkJCQkJCQkJCQkJYWN0dWFsRGltZW5zaW9u
cywKKwkJCQkJCQkJCQkJaW5zZXJ0QW5ub3RhdGlvbnMoKCgoVHlwZUJpbmRpbmcpIHR5cGVCaW5k
aW5nKS5iaW5kaW5nKS5nZXRUeXBlQW5ub3RhdGlvbnMoKSwgZGltZW5zaW9ucykpKTsKKwkJfSBl
bHNlIHsKKwkJCXJldHVybiB0aGlzLmdldFR5cGVCaW5kaW5nKGxvb2t1cEVudmlyb25tZW50KCku
Y3JlYXRlQXJyYXlUeXBlKAorCQkJCQkJCQkJCQlsZWFmVHlwZUJpbmRpbmcsCisJCQkJCQkJCQkJ
CWFjdHVhbERpbWVuc2lvbnMpKTsKKwkJfQorCX0KKwkKKwlwcml2YXRlIG9yZy5lY2xpcHNlLmpk
dC5pbnRlcm5hbC5jb21waWxlci5sb29rdXAuQW5ub3RhdGlvbkJpbmRpbmdbXSBpbnNlcnRBbm5v
dGF0aW9ucygKKwkJCQkJCQlvcmcuZWNsaXBzZS5qZHQuaW50ZXJuYWwuY29tcGlsZXIubG9va3Vw
LkFubm90YXRpb25CaW5kaW5nW10gYW5ub3RzLCBpbnQgZGltZW5zaW9ucykgeworCQlpZiAoZGlt
ZW5zaW9ucyA9PSAwIHx8IGFubm90cyA9PSBudWxsIHx8IGFubm90cy5sZW5ndGggPT0gMCkgewor
CQkJcmV0dXJuIGFubm90czsKKwkJfQorCQlpbnQgaW5kZXggPSAwOworCQlpZiAoZGltZW5zaW9u
cyA8IDApIHsKKwkJCWZvciAoaW50IGkgPSAwOyBpIDwgYW5ub3RzLmxlbmd0aDsgaSsrKSB7CisJ
CQkJaW5kZXgrKzsKKwkJCQlpZiAoYW5ub3RzW2ldID09IG51bGwpIHsKKwkJCQkJaWYoKytkaW1l
bnNpb25zID09IDApIGJyZWFrOworCQkJCX0KIAkJCX0KLSAJCX0gZWxzZSB7Ci0gCQkJaWYgKCEo
bGVhZkNvbXBvbmVudFR5cGUgaW5zdGFuY2VvZiBUeXBlQmluZGluZykpIHJldHVybiBudWxsOwot
IAkJCWxlYWZUeXBlQmluZGluZyA9ICgoVHlwZUJpbmRpbmcpIGxlYWZDb21wb25lbnRUeXBlKS5i
aW5kaW5nOwotIAkJfQotCQlyZXR1cm4gdGhpcy5nZXRUeXBlQmluZGluZyhsb29rdXBFbnZpcm9u
bWVudCgpLmNyZWF0ZUFycmF5VHlwZShsZWFmVHlwZUJpbmRpbmcsIGFjdHVhbERpbWVuc2lvbnMp
KTsKKwkJCWlmIChkaW1lbnNpb25zIDwgMCkgZGltZW5zaW9ucyA9IDA7IC8vIEp1c3QgbWVhbnMg
dGhlcmUgd2VyZSBubyBhbm5vdGF0aW9ucworCQl9CisJCW9yZy5lY2xpcHNlLmpkdC5pbnRlcm5h
bC5jb21waWxlci5sb29rdXAuQW5ub3RhdGlvbkJpbmRpbmdbXSBuZXdBbm5vdHMgPSAKKwkJCQlu
ZXcgb3JnLmVjbGlwc2UuamR0LmludGVybmFsLmNvbXBpbGVyLmxvb2t1cC5Bbm5vdGF0aW9uQmlu
ZGluZ1thbm5vdHMubGVuZ3RoIC0gaW5kZXggKyBkaW1lbnNpb25zXTsKKworCQlTeXN0ZW0uYXJy
YXljb3B5KGFubm90cywgaW5kZXgsIG5ld0Fubm90cywgZGltZW5zaW9ucywgYW5ub3RzLmxlbmd0
aCAtIGluZGV4KTsKKwkJcmV0dXJuIG5ld0Fubm90czsKIAl9CiB9
</data>

          </attachment>
      

    </bug>

</bugzilla>