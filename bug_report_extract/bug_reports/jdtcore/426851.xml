<?xml version="1.0" encoding="UTF-8" standalone="yes" ?>
<!DOCTYPE bugzilla SYSTEM "https://bugs.eclipse.org/bugs/page.cgi?id=bugzilla.dtd">

<bugzilla version="4.4.7"
          urlbase="https://bugs.eclipse.org/bugs/"
          
          maintainer="webmaster@eclipse.org"
>

    <bug>
          <bug_id>426851</bug_id>
          
          <creation_ts>2014-01-29 02:29:00 -0500</creation_ts>
          <short_desc>[1.8][content assist] content assist for a type use annotation</short_desc>
          <delta_ts>2014-02-03 07:01:33 -0500</delta_ts>
          <reporter_accessible>1</reporter_accessible>
          <cclist_accessible>1</cclist_accessible>
          <classification_id>2</classification_id>
          <classification>Eclipse</classification>
          <product>JDT</product>
          <component>Core</component>
          <version>4.4</version>
          <rep_platform>All</rep_platform>
          <op_sys>All</op_sys>
          <bug_status>RESOLVED</bug_status>
          <resolution>FIXED</resolution>
          
          
          <bug_file_loc></bug_file_loc>
          <status_whiteboard></status_whiteboard>
          <keywords></keywords>
          <priority>P3</priority>
          <bug_severity>normal</bug_severity>
          <target_milestone>BETA J8</target_milestone>
          
          
          <everconfirmed>1</everconfirmed>
          <reporter name="Noopur Gupta">noopur_gupta</reporter>
          <assigned_to name="Srikanth Sankaran">srikanth_sankaran</assigned_to>
          <cc>daniel_megert</cc>
    
    <cc>markus_keller</cc>
    
    <cc>srikanth_sankaran</cc>
          
          <votes>0</votes>

      

      

      

          <comment_sort_order>oldest_to_newest</comment_sort_order>  
          <long_desc isprivate="0" >
    <commentid>2355761</commentid>
    <comment_count>0</comment_count>
    <who name="Noopur Gupta">noopur_gupta</who>
    <bug_when>2014-01-29 02:29:18 -0500</bug_when>
    <thetext>package test.pack1;

import java.lang.annotation.ElementType;
import java.lang.annotation.Target;

@Target(ElementType.TYPE_USE)
@interface TypeUse {
}

@T|
interface I {
	default @T| void foo() { }
}
-----------------------------------------------

In the above example, replace &apos;|&apos; with the caret at both the locations and press Ctrl+space.

At 1st location (before interface), @TypeUse is not suggested, though it is valid there.
At 2nd location (before &apos;void&apos;), @TypeUse is suggested, and selecting that results in compilation error.</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>2355767</commentid>
    <comment_count>1</comment_count>
    <who name="Srikanth Sankaran">srikanth_sankaran</who>
    <bug_when>2014-01-29 02:48:07 -0500</bug_when>
    <thetext>(In reply to Noopur Gupta from comment #0)

&gt; At 1st location (before interface), @TypeUse is not suggested, though it is
&gt; valid there.

Thanks, will take a look.

&gt; At 2nd location (before &apos;void&apos;), @TypeUse is suggested, and selecting that
&gt; results in compilation error.

There are many places, code assist offers proposals that will lead to errors.
This is useful in many but not all scenarios where a follow up quick fix will
achieve what the programmer intended. That logic is not totally applicable here
arguably. (A follow up quick fix could be change method return type for
example.</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>2355772</commentid>
    <comment_count>2</comment_count>
    <who name="Srikanth Sankaran">srikanth_sankaran</who>
    <bug_when>2014-01-29 03:06:54 -0500</bug_when>
    <thetext>(In reply to Srikanth Sankaran from comment #1)

&gt; &gt; At 2nd location (before &apos;void&apos;), @TypeUse is suggested, and selecting that
&gt; &gt; results in compilation error.

There is also a further problem that would inhibit a full solution here:
There are places where the completion engine operates with raw type names,
with no type information. It would not be possible to always know that
an annotation type is a TYPE_USE annotation.

See https://bugs.eclipse.org/bugs/show_bug.cgi?id=174312#c0</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>2357870</commentid>
    <comment_count>3</comment_count>
    <who name="Srikanth Sankaran">srikanth_sankaran</who>
    <bug_when>2014-02-03 07:01:33 -0500</bug_when>
    <thetext>Thanks Noopur. Fix and tests available here: http://git.eclipse.org/c/jdt/eclipse.jdt.core.git/commit/?h=BETA_JAVA8&amp;id=8c64bffbde25c824dd307f6fe5deea636346d85b</thetext>
  </long_desc>
      
      

    </bug>

</bugzilla>