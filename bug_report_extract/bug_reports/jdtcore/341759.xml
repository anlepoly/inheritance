<?xml version="1.0" encoding="UTF-8" standalone="yes" ?>
<!DOCTYPE bugzilla SYSTEM "https://bugs.eclipse.org/bugs/page.cgi?id=bugzilla.dtd">

<bugzilla version="4.4.7"
          urlbase="https://bugs.eclipse.org/bugs/"
          
          maintainer="webmaster@eclipse.org"
>

    <bug>
          <bug_id>341759</bug_id>
          
          <creation_ts>2011-04-04 05:59:00 -0400</creation_ts>
          <short_desc>NPE in ITypeBinding#getName() for intersection type</short_desc>
          <delta_ts>2011-04-26 00:43:06 -0400</delta_ts>
          <reporter_accessible>1</reporter_accessible>
          <cclist_accessible>1</cclist_accessible>
          <classification_id>2</classification_id>
          <classification>Eclipse</classification>
          <product>JDT</product>
          <component>Core</component>
          <version>3.7</version>
          <rep_platform>PC</rep_platform>
          <op_sys>Windows 7</op_sys>
          <bug_status>VERIFIED</bug_status>
          <resolution>FIXED</resolution>
          
          
          <bug_file_loc></bug_file_loc>
          <status_whiteboard></status_whiteboard>
          <keywords></keywords>
          <priority>P3</priority>
          <bug_severity>normal</bug_severity>
          <target_milestone>3.7 M7</target_milestone>
          
          
          <everconfirmed>1</everconfirmed>
          <reporter name="Markus Keller">markus_keller</reporter>
          <assigned_to name="Olivier Thomann">Olivier_Thomann</assigned_to>
          <cc>jarthana</cc>
    
    <cc>Olivier_Thomann</cc>
          
          <votes>0</votes>

      

      

      

          <comment_sort_order>oldest_to_newest</comment_sort_order>  
          <long_desc isprivate="0" >
    <commentid>1908029</commentid>
    <comment_count>0</comment_count>
    <who name="Markus Keller">markus_keller</who>
    <bug_when>2011-04-04 05:59:46 -0400</bug_when>
    <thetext>N20110403-2000

- Have this class:

package xy;
public class Try {
    void test(String s, Integer i) {
        combine(s, i).compareTo(null); //1
        Comparable comp= combine(s, i); //2
        java.io.Serializable ser= combine(s, i); //3
        combine(s, i); //4
        //bug99922 java.util.Arrays.asList(s, i);
    }

    &lt;T&gt; T combine(T t1, T t2) {
        return Math.random() &gt; 0 ? t1 : t2;
    }
}

- open ASTView on &quot;combine(s, i)&quot;
- expand the type binding of the SimpleName &quot;combine&quot;

java.lang.NullPointerException
	at java.lang.String.&lt;init&gt;(String.java:177)
	at org.eclipse.jdt.core.dom.TypeBinding.getName(TypeBinding.java:656)
	at org.eclipse.jdt.core.dom.TypeBinding.getQualifiedName(TypeBinding.java:786)
	at org.eclipse.jdt.astview.views.Binding.getLabel(Binding.java:315)
	at org.eclipse.jdt.astview.views.ASTViewLabelProvider.getText(ASTViewLabelProvider.java:78)
	at org.eclipse.jface.viewers.WrappedViewerLabelProvider.getText(WrappedViewerLabelProvider.java:108)
	at org.eclipse.jface.viewers.WrappedViewerLabelProvider.update(WrappedViewerLabelProvider.java:164)
	at org.eclipse.jface.viewers.ViewerColumn.refresh(ViewerColumn.java:152)
	at org.eclipse.jface.viewers.AbstractTreeViewer.doUpdateItem(AbstractTreeViewer.java:938)</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>1908033</commentid>
    <comment_count>1</comment_count>
    <who name="Markus Keller">markus_keller</who>
    <bug_when>2011-04-04 06:26:15 -0400</bug_when>
    <thetext>Note that the problematic binding is not the type binding for the expression type of &quot;combine(s, i)&quot;, but the result of calling getGenericTypeOfWildcardType() on that type.</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>1908063</commentid>
    <comment_count>2</comment_count>
    <who name="Olivier Thomann">Olivier_Thomann</who>
    <bug_when>2011-04-04 07:45:41 -0400</bug_when>
    <thetext>I have a trivial fix for this one. The method getGenericTypeOfWildcardType() should return null for an intersection type.</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>1910368</commentid>
    <comment_count>3</comment_count>
      <attachid>192758</attachid>
    <who name="Olivier Thomann">Olivier_Thomann</who>
    <bug_when>2011-04-07 11:40:16 -0400</bug_when>
    <thetext>Created attachment 192758
Proposed fix + regression test

I don&apos;t touch other cases for intersection types like getRank(), isUpperBound(), getName(), getQualifiedName(), getBound(). This will be done when fixing bug 99931.</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>1910434</commentid>
    <comment_count>4</comment_count>
    <who name="Olivier Thomann">Olivier_Thomann</who>
    <bug_when>2011-04-07 13:26:18 -0400</bug_when>
    <thetext>Released in HEAD and BETA_JAVA7 branch.
The NPE came from trying to display the name of the generic type of wildcard for an intersection type.
To prevent it, the call to getGenericTypeOfWildcardType() now returns null for intersection type.</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>1918708</commentid>
    <comment_count>5</comment_count>
    <who name="Jay Arthanareeswaran">jarthana</who>
    <bug_when>2011-04-26 00:43:06 -0400</bug_when>
    <thetext>Verified for 3.7M7 using build I20110421-1800</thetext>
  </long_desc>
      
          <attachment
              isobsolete="0"
              ispatch="1"
              isprivate="0"
          >
            <attachid>192758</attachid>
            <date>2011-04-07 11:40:00 -0400</date>
            <delta_ts>2011-04-07 11:40:16 -0400</delta_ts>
            <desc>Proposed fix + regression test</desc>
            <filename>patch_341759.txt</filename>
            <type>text/plain</type>
            <size>1738</size>
            <attacher name="Olivier Thomann">Olivier_Thomann</attacher>
            
              <data encoding="base64">IyMjIEVjbGlwc2UgV29ya3NwYWNlIFBhdGNoIDEuMA0KI1Agb3JnLmVjbGlwc2UuamR0LmNvcmUN
CkluZGV4OiBkb20vb3JnL2VjbGlwc2UvamR0L2NvcmUvZG9tL1R5cGVCaW5kaW5nLmphdmENCj09
PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09
PT09PT09PT0NClJDUyBmaWxlOiAvY3Zzcm9vdC9lY2xpcHNlL29yZy5lY2xpcHNlLmpkdC5jb3Jl
L2RvbS9vcmcvZWNsaXBzZS9qZHQvY29yZS9kb20vVHlwZUJpbmRpbmcuamF2YSx2DQpyZXRyaWV2
aW5nIHJldmlzaW9uIDEuMTUwDQpkaWZmIC11IC1yMS4xNTAgVHlwZUJpbmRpbmcuamF2YQ0KLS0t
IGRvbS9vcmcvZWNsaXBzZS9qZHQvY29yZS9kb20vVHlwZUJpbmRpbmcuamF2YQk3IEphbiAyMDEx
IDE1OjEwOjIzIC0wMDAwCTEuMTUwDQorKysgZG9tL29yZy9lY2xpcHNlL2pkdC9jb3JlL2RvbS9U
eXBlQmluZGluZy5qYXZhCTcgQXByIDIwMTEgMTU6MzU6MjIgLTAwMDANCkBAIC0xNzcsNyArMTc3
LDYgQEANCiAJcHVibGljIElUeXBlQmluZGluZyBnZXRHZW5lcmljVHlwZU9mV2lsZGNhcmRUeXBl
KCkgew0KIAkJc3dpdGNoICh0aGlzLmJpbmRpbmcua2luZCgpKSB7DQogCQkJY2FzZSBCaW5kaW5n
LldJTERDQVJEX1RZUEUgOg0KLQkJCWNhc2UgQmluZGluZy5JTlRFUlNFQ1RJT05fVFlQRSA6DQog
CQkJCVdpbGRjYXJkQmluZGluZyB3aWxkY2FyZEJpbmRpbmcgPSAoV2lsZGNhcmRCaW5kaW5nKSB0
aGlzLmJpbmRpbmc7DQogCQkJCWlmICh3aWxkY2FyZEJpbmRpbmcuZ2VuZXJpY1R5cGUgIT0gbnVs
bCkgew0KIAkJCQkJcmV0dXJuIHRoaXMucmVzb2x2ZXIuZ2V0VHlwZUJpbmRpbmcod2lsZGNhcmRC
aW5kaW5nLmdlbmVyaWNUeXBlKTsNCiNQIG9yZy5lY2xpcHNlLmpkdC5jb3JlLnRlc3RzLm1vZGVs
DQpJbmRleDogc3JjL29yZy9lY2xpcHNlL2pkdC9jb3JlL3Rlc3RzL2RvbS9BU1RDb252ZXJ0ZXIx
N1Rlc3QuamF2YQ0KPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09
PT09PT09PT09PT09PT09PT09PT09PQ0KUkNTIGZpbGU6IC9jdnNyb290L2VjbGlwc2Uvb3JnLmVj
bGlwc2UuamR0LmNvcmUudGVzdHMubW9kZWwvc3JjL29yZy9lY2xpcHNlL2pkdC9jb3JlL3Rlc3Rz
L2RvbS9BdHRpYy9BU1RDb252ZXJ0ZXIxN1Rlc3QuamF2YSx2DQpyZXRyaWV2aW5nIHJldmlzaW9u
IDEuMS4yLjQNCmRpZmYgLXUgLXIxLjEuMi40IEFTVENvbnZlcnRlcjE3VGVzdC5qYXZhDQotLS0g
c3JjL29yZy9lY2xpcHNlL2pkdC9jb3JlL3Rlc3RzL2RvbS9BU1RDb252ZXJ0ZXIxN1Rlc3QuamF2
YQkxIEFwciAyMDExIDE2OjM3OjU4IC0wMDAwCTEuMS4yLjQNCisrKyBzcmMvb3JnL2VjbGlwc2Uv
amR0L2NvcmUvdGVzdHMvZG9tL0FTVENvbnZlcnRlcjE3VGVzdC5qYXZhCTcgQXByIDIwMTEgMTU6
MzU6MjIgLTAwMDANCkBAIC00MjcsNSArNDI3LDYgQEANCiAJCWNoZWNrU291cmNlUmFuZ2UodHlw
ZSwgIkV4Y2VwdGlvbkEgfCBFeGNlcHRpb25CIiwgY29udGVudHMpOw0KIAkJSVR5cGVCaW5kaW5n
IHR5cGVCaW5kaW5nID0gdHlwZS5yZXNvbHZlQmluZGluZygpOw0KIAkJYXNzZXJ0Tm90TnVsbCgi
Tm8gYmluZGluZyIsIHR5cGVCaW5kaW5nKTsNCisJCWFzc2VydE51bGwoIlRoaXMgc2hvdWxkIGJl
IG51bGwgZm9yIGludGVyc2VjdGlvbiB0eXBlIiwgdHlwZUJpbmRpbmcuZ2V0R2VuZXJpY1R5cGVP
ZldpbGRjYXJkVHlwZSgpKTsNCiAJfQ0KIH0NCg==
</data>

          </attachment>
      

    </bug>

</bugzilla>