<?xml version="1.0" encoding="UTF-8" standalone="yes" ?>
<!DOCTYPE bugzilla SYSTEM "https://bugs.eclipse.org/bugs/page.cgi?id=bugzilla.dtd">

<bugzilla version="4.4.7"
          urlbase="https://bugs.eclipse.org/bugs/"
          
          maintainer="webmaster@eclipse.org"
>

    <bug>
          <bug_id>395612</bug_id>
          
          <creation_ts>2012-12-03 10:33:00 -0500</creation_ts>
          <short_desc>[1.8] Implement AST Rewrite for Receiver</short_desc>
          <delta_ts>2013-04-15 12:16:17 -0400</delta_ts>
          <reporter_accessible>1</reporter_accessible>
          <cclist_accessible>1</cclist_accessible>
          <classification_id>2</classification_id>
          <classification>Eclipse</classification>
          <product>JDT</product>
          <component>Core</component>
          <version>3.8</version>
          <rep_platform>PC</rep_platform>
          <op_sys>All</op_sys>
          <bug_status>RESOLVED</bug_status>
          <resolution>FIXED</resolution>
          
          
          <bug_file_loc></bug_file_loc>
          <status_whiteboard></status_whiteboard>
          <keywords></keywords>
          <priority>P3</priority>
          <bug_severity>normal</bug_severity>
          <target_milestone>BETA J8</target_milestone>
          <dependson>391893</dependson>
    
    <dependson>403132</dependson>
          <blocked>405270</blocked>
    
    <blocked>398940</blocked>
          <everconfirmed>1</everconfirmed>
          <reporter name="Jay Arthanareeswaran">jarthana</reporter>
          <assigned_to name="Jay Arthanareeswaran">jarthana</assigned_to>
          <cc>jesper</cc>
    
    <cc>manju656</cc>
    
    <cc>manpalat</cc>
    
    <cc>markus_keller</cc>
    
    <cc>srikanth_sankaran</cc>
          
          <votes>0</votes>

      

      

      <flag name="review"
          id="56132"
          type_id="1"
          status="+"
          setter="markus_keller"
    />
    <flag name="review"
          id="56554"
          type_id="1"
          status="+"
          setter="markus_keller"
    />

          <comment_sort_order>oldest_to_newest</comment_sort_order>  
          <long_desc isprivate="0" >
    <commentid>2189944</commentid>
    <comment_count>0</comment_count>
    <who name="Jay Arthanareeswaran">jarthana</who>
    <bug_when>2012-12-03 10:33:42 -0500</bug_when>
    <thetext>BETA_JAVA8:

AST/DOM support for receiver is being added through bug 391893. This bug is for implementing AST Rewrite for the Receiver parameter.</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>2189948</commentid>
    <comment_count>1</comment_count>
    <who name="Jay Arthanareeswaran">jarthana</who>
    <bug_when>2012-12-03 10:43:52 -0500</bug_when>
    <thetext>Srikanth, would you prefer a new umbrella bug for all the AST rewrite bugs or can I just add a new dependency to the bug 391847 ?</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>2189951</commentid>
    <comment_count>2</comment_count>
      <attachid>224219</attachid>
    <who name="Jay Arthanareeswaran">jarthana</who>
    <bug_when>2012-12-03 10:52:14 -0500</bug_when>
    <thetext>Created attachment 224219
Proposed fix

Patch with tests</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>2199401</commentid>
    <comment_count>3</comment_count>
    <who name="Jay Arthanareeswaran">jarthana</who>
    <bug_when>2013-01-07 00:24:30 -0500</bug_when>
    <thetext>Markus, can you please review this (after fix for bug 391893 is out) ?</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>2212754</commentid>
    <comment_count>4</comment_count>
    <who name="Jay Arthanareeswaran">jarthana</who>
    <bug_when>2013-02-06 02:00:50 -0500</bug_when>
    <thetext>(In reply to comment #3)
&gt; Markus, can you please review this (after fix for bug 391893 is out) ?

This requires complete rewrite since receiver is no longer SVD but now split into RECEIVER_TYPE and RECEIVER_QUALIFIER. I am on it.</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>2224637</commentid>
    <comment_count>5</comment_count>
    <who name="Srikanth Sankaran">srikanth_sankaran</who>
    <bug_when>2013-03-01 11:09:16 -0500</bug_when>
    <thetext>(In reply to comment #4)
&gt; (In reply to comment #3)
&gt; &gt; Markus, can you please review this (after fix for bug 391893 is out) ?
&gt; 
&gt; This requires complete rewrite since receiver is no longer SVD but now split
&gt; into RECEIVER_TYPE and RECEIVER_QUALIFIER. I am on it.

Just so the priorities are clear: DOM/AST &amp; ASTRewrite work is much higher
priority than (insofar as they would &quot;unblock&quot; the UI team and allow them
to join the Java 8 project work) stray/standalone compiler ERs like
https://bugs.eclipse.org/bugs/show_bug.cgi?id=399780 - Jay, I can help
with reassigning the compiler bug to someone else enabling you to focus
on AST API items. Let me know your thoughts.</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>2227627</commentid>
    <comment_count>6</comment_count>
      <attachid>228084</attachid>
    <who name="Jay Arthanareeswaran">jarthana</who>
    <bug_when>2013-03-07 13:31:57 -0500</bug_when>
    <thetext>Created attachment 228084
Updated patch

Rewritten patch with tests.

The last test in ASTRewritingMethodDeclTest is failing because the formatter is inserting a new line after annotations for annotatable types. I don&apos;t know if there is a quick fix for this. Or should we revisit this when we work on the formtter?</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>2227796</commentid>
    <comment_count>7</comment_count>
    <who name="Srikanth Sankaran">srikanth_sankaran</who>
    <bug_when>2013-03-07 18:33:26 -0500</bug_when>
    <thetext>(In reply to comment #6)
&gt; Created attachment 228084 [details]
&gt; Updated patch

Manoj, please review before we request Markus for a review. TIA.</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>2227838</commentid>
    <comment_count>8</comment_count>
    <who name="Srikanth Sankaran">srikanth_sankaran</who>
    <bug_when>2013-03-07 22:06:24 -0500</bug_when>
    <thetext>(In reply to comment #6)
&gt; Created attachment 228084 [details]
&gt; Updated patch
&gt; 
&gt; Rewritten patch with tests.
&gt; 
&gt; The last test in ASTRewritingMethodDeclTest is failing because the formatter
&gt; is inserting a new line after annotations for annotatable types. I don&apos;t
&gt; know if there is a quick fix for this. Or should we revisit this when we
&gt; work on the formtter?

Please disable the test, raise a follow up bug and assign it to Jesper
and mention the disabled test name in https://bugs.eclipse.org/bugs/show_bug.cgi?id=383608 and request Jesper to update the list when fixed and reenabled.</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>2228485</commentid>
    <comment_count>9</comment_count>
    <who name="Srikanth Sankaran">srikanth_sankaran</who>
    <bug_when>2013-03-09 11:44:47 -0500</bug_when>
    <thetext>(In reply to comment #6)
&gt; Created attachment 228084 [details]
&gt; Updated patch
&gt; 
&gt; Rewritten patch with tests.
&gt; 
&gt; The last test in ASTRewritingMethodDeclTest is failing because the formatter
&gt; is inserting a new line after annotations for annotatable types. I don&apos;t
&gt; know if there is a quick fix for this. Or should we revisit this when we
&gt; work on the formtter?

Perhaps this is the same as https://bugs.eclipse.org/bugs/show_bug.cgi?id=401848 ?</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>2228499</commentid>
    <comment_count>10</comment_count>
    <who name="Jay Arthanareeswaran">jarthana</who>
    <bug_when>2013-03-09 13:51:20 -0500</bug_when>
    <thetext>(In reply to comment #9)
&gt; Perhaps this is the same as
&gt; https://bugs.eclipse.org/bugs/show_bug.cgi?id=401848 ?

Indeed, it is.</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>2228570</commentid>
    <comment_count>11</comment_count>
    <who name="Srikanth Sankaran">srikanth_sankaran</who>
    <bug_when>2013-03-10 03:55:52 -0400</bug_when>
    <thetext>Modulo bugs, this is the last work item to complete ASTRewrite work for 308.
When this gets reviewed and released, we can also resolve bug 398940</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>2228571</commentid>
    <comment_count>12</comment_count>
    <who name="Srikanth Sankaran">srikanth_sankaran</who>
    <bug_when>2013-03-10 04:02:07 -0400</bug_when>
    <thetext>(In reply to comment #11)
&gt; Modulo bugs, this is the last work item to complete ASTRewrite work for 308.
&gt; When this gets reviewed and released, we can also resolve bug 398940

Spoke too soon. Bug 400650 is wrongly parented (fixed.) but that bug is about
adding tests, so yes effectively we will be complete with functionality that
can be consumed with the resolution of the present bug.</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>2230123</commentid>
    <comment_count>13</comment_count>
    <who name="Manoj Palat Away Until May 11 2015">manpalat</who>
    <bug_when>2013-03-13 01:26:57 -0400</bug_when>
    <thetext>(In reply to comment #7)
&gt; (In reply to comment #6)
&gt; Created attachment 228084 [details]
&gt; Updated
&gt; patch

Manoj, please review before we request Markus for a review. TIA.

One issue found, more of a converter issue rather than ASTRewrite, raised bug 403132.</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>2230175</commentid>
    <comment_count>14</comment_count>
    <who name="Manoj Palat Away Until May 11 2015">manpalat</who>
    <bug_when>2013-03-13 04:24:11 -0400</bug_when>
    <thetext>(In reply to comment #13)
&gt; (In reply to comment #7)
&gt; (In reply to comment #6)
&gt; Created attachment
&gt; 228084 [details]
&gt; Updated
&gt; patch

Manoj, please review before we request
&gt; Markus for a review. TIA.

One issue found, more of a converter issue rather
&gt; than ASTRewrite, raised bug 403132.

Continuing on the review:

 - Line 1877:
} else {
rewriteRequiredNode(method, MethodDeclaration.RECEIVER_TYPE_PROPERTY);
					rewriteQualifier = true;
}


- three additional test scenarios need to be implemented to achieve full statement coverage: 
a)</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>2230177</commentid>
    <comment_count>15</comment_count>
    <who name="Manoj Palat Away Until May 11 2015">manpalat</who>
    <bug_when>2013-03-13 04:29:11 -0400</bug_when>
    <thetext>Pressed tab too soon.. comment incomplete. Please find the comments below:

1) - Line 1877:
} else {
 rewriteRequiredNode(method, MethodDeclaration.RECEIVER_TYPE_PROPERTY);				
 rewriteQualifier = true;
}
Is there a scenario (with the current list constants in Rewrite) that will cause this code to be touched? If yes, we need a test case here.

2) Line 1894 - block - A test case missing that touches this part of the code.

3) Line 1901 - Same as above.

Otherwise the patch looks good. Will review the patch again if changes due to the fix in bug 403132 has a code change here.</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>2231615</commentid>
    <comment_count>16</comment_count>
    <who name="Jay Arthanareeswaran">jarthana</who>
    <bug_when>2013-03-14 17:01:06 -0400</bug_when>
    <thetext>(In reply to comment #15)
&gt; Pressed tab too soon.. comment incomplete. Please find the comments below:
&gt; 
&gt; 1) - Line 1877:
&gt; } else {
&gt;  rewriteRequiredNode(method, MethodDeclaration.RECEIVER_TYPE_PROPERTY);				
&gt;  rewriteQualifier = true;
&gt; }
&gt; Is there a scenario (with the current list constants in Rewrite) that will
&gt; cause this code to be touched? If yes, we need a test case here.

I had added that code to handle the children changed event for the receiver type. But looks like it&apos;s handled already by the code right below it where we enable rewriteQualifier in the presence of receiver type. So, I have removed that block of code. I have added new tests for the other two blocks you pointed out.

I have also removed some unnecessary white space from the tests in this patch.</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>2231617</commentid>
    <comment_count>17</comment_count>
      <attachid>228451</attachid>
    <who name="Jay Arthanareeswaran">jarthana</who>
    <bug_when>2013-03-14 17:03:12 -0400</bug_when>
    <thetext>Created attachment 228451
Updated patch

And this would be the patch with the updates I just mentioned above.</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>2231618</commentid>
    <comment_count>18</comment_count>
    <who name="Jay Arthanareeswaran">jarthana</who>
    <bug_when>2013-03-14 17:12:56 -0400</bug_when>
    <thetext>Some rewrite tests will fail if run without the patch on bug 403132, comment #7.</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>2231672</commentid>
    <comment_count>19</comment_count>
    <who name="Srikanth Sankaran">srikanth_sankaran</who>
    <bug_when>2013-03-14 21:01:03 -0400</bug_when>
    <thetext>(In reply to comment #18)
&gt; Some rewrite tests will fail if run without the patch on bug 403132, comment
&gt; #7.

This is fixed, Markus, Manoj has finished one round of review. So the ball is
in your court. TIA.</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>2233151</commentid>
    <comment_count>20</comment_count>
    <who name="Markus Keller">markus_keller</who>
    <bug_when>2013-03-18 15:44:30 -0400</bug_when>
    <thetext>In ASTRewriteAnalyzer#rewriteModifiers2(..), I think it&apos;s time to introduce a new local variable and use it in all 3 places that do the same check:

boolean isAnnotationsProperty =
	property == SingleVariableDeclaration.VARARGS_ANNOTATIONS_PROPERTY 
	|| node instanceof AnnotatableType &amp;&amp; property == ((AnnotatableType) node).getAnnotationsProperty();

The property check I added may currently not be necessary, but it doesn&apos;t hurt to be explicit, since we never know how the AST will evolve.

In ASTRewriteAnalyzer#visit(MethodDeclaration), the scan for TerminalTokens.TokenNameLPAREN better stays in that method, rather than being moved to rewriteMethodReceiver(..)

In ASTRewriteAnalyzer#rewriteMethodReceiver(..), there&apos;s a space too much in front of a &quot; doTextInsert(&quot; invocation and after a &quot;offset= &quot;.


The ASTRewritingMethodDeclTest still contained a sysout. Furthermore, it looks like you did some experiments with strange spacing. These should be reverted for the commit. Our official policy regarding badly-formatted code is &quot;garbage in -&gt; garbage out&quot;, so we don&apos;t need any tests for that situation. But we do need tests for the default code formatter settings.

Fixed these things and pushed as http://git.eclipse.org/c/jdt/eclipse.jdt.core.git/commit/?id=da439c42c3c777a1dd6611e64418ac2f9b27b690</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>2241957</commentid>
    <comment_count>21</comment_count>
    <who name="Markus Keller">markus_keller</who>
    <bug_when>2013-04-10 09:19:03 -0400</bug_when>
    <thetext>Manju found that ASTRewriteFlattener#visit(MethodDeclaration) also needs to be updated. She&apos;s working on a patch.</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>2242033</commentid>
    <comment_count>22</comment_count>
      <attachid>229564</attachid>
    <who name="Manju Mathew">manju656</who>
    <bug_when>2013-04-10 10:45:37 -0400</bug_when>
    <thetext>Created attachment 229564
Patch for ASTRewriteFlattener

Included handling of receiver parameter in ASTRewriteFlattener#visit(MethodDeclaration). Will upload a test case for this one as soon as it is complete.</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>2242103</commentid>
    <comment_count>23</comment_count>
      <attachid>229564</attachid>
    <who name="Markus Keller">markus_keller</who>
    <bug_when>2013-04-10 12:30:08 -0400</bug_when>
    <thetext>Comment on attachment 229564
Patch for ASTRewriteFlattener

ASTRewriteFlattener needs to use getChildNode(..) and getChildList(..) to get the right nodes, see all other code in that class.</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>2242127</commentid>
    <comment_count>24</comment_count>
      <attachid>229577</attachid>
    <who name="Manju Mathew">manju656</who>
    <bug_when>2013-04-10 13:13:09 -0400</bug_when>
    <thetext>Created attachment 229577
Patch for ASTRewriteFlattener

Thanks Markus. I have now used getChildNode and getChildList to retrieve data from the ASTNode.</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>2243602</commentid>
    <comment_count>25</comment_count>
      <attachid>229716</attachid>
    <who name="Manju Mathew">manju656</who>
    <bug_when>2013-04-15 06:50:20 -0400</bug_when>
    <thetext>Created attachment 229716
Tests Patch

Added two test cases in ASTRewritingMethodDeclTest for the handling of receiver parameter.</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>2243949</commentid>
    <comment_count>26</comment_count>
    <who name="Markus Keller">markus_keller</who>
    <bug_when>2013-04-15 11:51:36 -0400</bug_when>
    <thetext>Thanks Manju. Released comment 24 and comment 25 as http://git.eclipse.org/c/jdt/eclipse.jdt.core.git/commit/?id=aade06a7dde9bdd68930bb7332e79ee5b41e5db9

I clarified the buf.append(...) by putting each &quot;\n&quot; on a separate line, and I simplified the initialization of &quot;TypeDeclaration inner&quot; (there&apos;s no need to iterate over bodyDeclarations() if we know that the inner type is at index 1).</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>2243963</commentid>
    <comment_count>27</comment_count>
    <who name="Markus Keller">markus_keller</who>
    <bug_when>2013-04-15 12:16:17 -0400</bug_when>
    <thetext>(In reply to comment #26)
Sorry, I forgot to set Manju as Git Author.</thetext>
  </long_desc>
      
          <attachment
              isobsolete="1"
              ispatch="1"
              isprivate="0"
          >
            <attachid>224219</attachid>
            <date>2012-12-03 10:52:00 -0500</date>
            <delta_ts>2013-02-06 03:17:26 -0500</delta_ts>
            <desc>Proposed fix</desc>
            <filename>Fix-for-bug-395612.patch</filename>
            <type>text/plain</type>
            <size>15154</size>
            <attacher name="Jay Arthanareeswaran">jarthana</attacher>
            
              <data encoding="base64">ZGlmZiAtLWdpdCBhL29yZy5lY2xpcHNlLmpkdC5jb3JlLnRlc3RzLm1vZGVsL3NyYy9vcmcvZWNs
aXBzZS9qZHQvY29yZS90ZXN0cy9yZXdyaXRlL2Rlc2NyaWJpbmcvQVNUUmV3cml0aW5nTWV0aG9k
RGVjbFRlc3QuamF2YSBiL29yZy5lY2xpcHNlLmpkdC5jb3JlLnRlc3RzLm1vZGVsL3NyYy9vcmcv
ZWNsaXBzZS9qZHQvY29yZS90ZXN0cy9yZXdyaXRlL2Rlc2NyaWJpbmcvQVNUUmV3cml0aW5nTWV0
aG9kRGVjbFRlc3QuamF2YQppbmRleCA2M2IwYWE1Li5lMzMwYWY5IDEwMDY0NAotLS0gYS9vcmcu
ZWNsaXBzZS5qZHQuY29yZS50ZXN0cy5tb2RlbC9zcmMvb3JnL2VjbGlwc2UvamR0L2NvcmUvdGVz
dHMvcmV3cml0ZS9kZXNjcmliaW5nL0FTVFJld3JpdGluZ01ldGhvZERlY2xUZXN0LmphdmEKKysr
IGIvb3JnLmVjbGlwc2UuamR0LmNvcmUudGVzdHMubW9kZWwvc3JjL29yZy9lY2xpcHNlL2pkdC9j
b3JlL3Rlc3RzL3Jld3JpdGUvZGVzY3JpYmluZy9BU1RSZXdyaXRpbmdNZXRob2REZWNsVGVzdC5q
YXZhCkBAIC0yODcxLDUgKzI4NzEsMTUxIEBACiAJCWFzc2VydEVxdWFsU3RyaW5nKHByZXZpZXcs
IGJ1Zi50b1N0cmluZygpKTsKIAl9CisJcHVibGljIHZvaWQgdGVzdFJlY2VpdmVyMSgpIHRocm93
cyBFeGNlcHRpb24geworCQlJUGFja2FnZUZyYWdtZW50IHBhY2sxID0gdGhpcy5zb3VyY2VGb2xk
ZXIuY3JlYXRlUGFja2FnZUZyYWdtZW50KCJ0ZXN0MSIsIGZhbHNlLCBudWxsKTsKKwkJU3RyaW5n
QnVmZmVyIGJ1ZiA9IG5ldyBTdHJpbmdCdWZmZXIoKTsKKwkJYnVmLmFwcGVuZCgicGFja2FnZSB0
ZXN0MTtcbiIpOworCQlidWYuYXBwZW5kKCJjbGFzcyBYIHtcbiIpOworCQlidWYuYXBwZW5kKCIg
ICAgcHVibGljIHZvaWQgZm9vKCBAQSBAQiBAQyBYIHRoaXMsIGludCBpICwgaW50IGogKSB7XG4i
KTsKKwkJYnVmLmFwcGVuZCgiICAgIH1cbiIpOworCQlidWYuYXBwZW5kKCJ9XG4iKTsKKwkJSUNv
bXBpbGF0aW9uVW5pdCBjdT0gcGFjazEuY3JlYXRlQ29tcGlsYXRpb25Vbml0KCJYLmphdmEiLCBi
dWYudG9TdHJpbmcoKSwgZmFsc2UsIG51bGwpOworCQlDb21waWxhdGlvblVuaXQgYXN0Um9vdCA9
IGNyZWF0ZUFTVDgoY3UpOworCQlBU1RSZXdyaXRlIHJld3JpdGUgPSBBU1RSZXdyaXRlLmNyZWF0
ZShhc3RSb290LmdldEFTVCgpKTsKKwkJQVNUIGFzdCA9IGFzdFJvb3QuZ2V0QVNUKCk7CisJCU1l
dGhvZERlY2xhcmF0aW9uIG1ldGhvZCA9IChNZXRob2REZWNsYXJhdGlvbikgZmluZFR5cGVEZWNs
YXJhdGlvbihhc3RSb290LCAiWCIpLmJvZHlEZWNsYXJhdGlvbnMoKS5nZXQoMCk7CisJCVNpbmds
ZVZhcmlhYmxlRGVjbGFyYXRpb24gcmVjZWl2ZXIgPSBtZXRob2QuZ2V0UmVjZWl2ZXIoKTsKKwkJ
TWFya2VyQW5ub3RhdGlvbiBhbm5vdCA9IGFzdC5uZXdNYXJrZXJBbm5vdGF0aW9uKCk7CisJCWFu
bm90LnNldFR5cGVOYW1lKGFzdC5uZXdTaW1wbGVOYW1lKCJNYXJrZXIiKSk7CisJCUxpc3RSZXdy
aXRlIGxpc3RSZXdyaXRlID0gcmV3cml0ZS5nZXRMaXN0UmV3cml0ZShyZWNlaXZlciwgU2luZ2xl
VmFyaWFibGVEZWNsYXJhdGlvbi5NT0RJRklFUlMyX1BST1BFUlRZKTsKKwkJbGlzdFJld3JpdGUu
aW5zZXJ0Rmlyc3QoYW5ub3QsIG51bGwpOwogCisJCVN0cmluZyBwcmV2aWV3ID0gZXZhbHVhdGVS
ZXdyaXRlKGN1LCByZXdyaXRlKTsKKwkJYnVmID0gbmV3IFN0cmluZ0J1ZmZlcigpOworCQlidWYu
YXBwZW5kKCJwYWNrYWdlIHRlc3QxO1xuIik7CisJCWJ1Zi5hcHBlbmQoImNsYXNzIFgge1xuIik7
CisJCWJ1Zi5hcHBlbmQoIiAgICBwdWJsaWMgdm9pZCBmb28oIEBNYXJrZXIgQEEgQEIgQEMgWCB0
aGlzLCBpbnQgaSAsIGludCBqICkge1xuIik7CisJCWJ1Zi5hcHBlbmQoIiAgICB9XG4iKTsKKwkJ
YnVmLmFwcGVuZCgifVxuIik7CisJCWFzc2VydEVxdWFsU3RyaW5nKHByZXZpZXcsIGJ1Zi50b1N0
cmluZygpKTsKKwl9CisJcHVibGljIHZvaWQgdGVzdFJlY2VpdmVyMigpIHRocm93cyBFeGNlcHRp
b24geworCQlJUGFja2FnZUZyYWdtZW50IHBhY2sxID0gdGhpcy5zb3VyY2VGb2xkZXIuY3JlYXRl
UGFja2FnZUZyYWdtZW50KCJ0ZXN0MSIsIGZhbHNlLCBudWxsKTsKKwkJU3RyaW5nQnVmZmVyIGJ1
ZiA9IG5ldyBTdHJpbmdCdWZmZXIoKTsKKwkJYnVmLmFwcGVuZCgicGFja2FnZSB0ZXN0MTtcbiIp
OworCQlidWYuYXBwZW5kKCJjbGFzcyBYIHtcbiIpOworCQlidWYuYXBwZW5kKCIJY2xhc3MgWSB7
XG4iKTsKKwkJYnVmLmFwcGVuZCgiICAgIAlwdWJsaWMgWSggQEEgWCB0aGlzICwgaW50IGkgLCBA
QiBib29sZWFuIGIgLCBAQSBpbnQgaiApIHtcbiIpOworCQlidWYuYXBwZW5kKCIgICAgCX1cbiIp
OworCQlidWYuYXBwZW5kKCIgICAgfVxuIik7CisJCWJ1Zi5hcHBlbmQoIn1cbiIpOworCQlJQ29t
cGlsYXRpb25Vbml0IGN1ID0gcGFjazEuY3JlYXRlQ29tcGlsYXRpb25Vbml0KCJYLmphdmEiLCBi
dWYudG9TdHJpbmcoKSwgZmFsc2UsIG51bGwpOworCQlDb21waWxhdGlvblVuaXQgYXN0Um9vdCA9
IGNyZWF0ZUFTVDgoY3UpOworCQlBU1RSZXdyaXRlIHJld3JpdGUgPSBBU1RSZXdyaXRlLmNyZWF0
ZShhc3RSb290LmdldEFTVCgpKTsKKwkJQVNUIGFzdCA9IGFzdFJvb3QuZ2V0QVNUKCk7CisJCVR5
cGVEZWNsYXJhdGlvbiB0eXBlID0gKFR5cGVEZWNsYXJhdGlvbikgZmluZFR5cGVEZWNsYXJhdGlv
bihhc3RSb290LCAiWCIpLmJvZHlEZWNsYXJhdGlvbnMoKS5nZXQoMCk7CisJCU1ldGhvZERlY2xh
cmF0aW9uIG1ldGhvZCA9ICAoTWV0aG9kRGVjbGFyYXRpb24pIHR5cGUuYm9keURlY2xhcmF0aW9u
cygpLmdldCgwKTsKKwkJTGlzdCBwYXJhbXMgPSBtZXRob2QucGFyYW1ldGVycygpOwogCisJCVNp
bmdsZVZhcmlhYmxlRGVjbGFyYXRpb24gZmlyc3QgPSAoU2luZ2xlVmFyaWFibGVEZWNsYXJhdGlv
bikgcGFyYW1zLmdldCgwKTsKKwkJU2luZ2xlVmFyaWFibGVEZWNsYXJhdGlvbiBzZWNvbmQgPSAo
U2luZ2xlVmFyaWFibGVEZWNsYXJhdGlvbikgcGFyYW1zLmdldCgxKTsKKwkJU2luZ2xlVmFyaWFi
bGVEZWNsYXJhdGlvbiB0aGlyZCA9IChTaW5nbGVWYXJpYWJsZURlY2xhcmF0aW9uKSBwYXJhbXMu
Z2V0KDIpOworCQlyZXdyaXRlLnJlcGxhY2UoZmlyc3QuZ2V0TmFtZSgpLCBhc3QubmV3U2ltcGxl
TmFtZSgiaSIpLCBudWxsKTsKKwkJcmV3cml0ZS5yZXBsYWNlKHNlY29uZC5nZXROYW1lKCksIGFz
dC5uZXdTaW1wbGVOYW1lKCJiIiksIG51bGwpOworCisJCUFTVE5vZGUgY29weTEgPSByZXdyaXRl
LmNyZWF0ZUNvcHlUYXJnZXQoZmlyc3QpOworCQlBU1ROb2RlIGNvcHkyID0gcmV3cml0ZS5jcmVh
dGVDb3B5VGFyZ2V0KHNlY29uZCk7CisKKwkJcmV3cml0ZS5yZXBsYWNlKGZpcnN0LCBjb3B5Miwg
bnVsbCk7CisJCXJld3JpdGUucmVwbGFjZShzZWNvbmQsIGNvcHkxLCBudWxsKTsKKwkJcmV3cml0
ZS5yZW1vdmUodGhpcmQsIG51bGwpOworCisJCVN0cmluZyBwcmV2aWV3ID0gZXZhbHVhdGVSZXdy
aXRlKGN1LCByZXdyaXRlKTsKKwkJYnVmID0gbmV3IFN0cmluZ0J1ZmZlcigpOworCQlidWYuYXBw
ZW5kKCJwYWNrYWdlIHRlc3QxO1xuIik7CisJCWJ1Zi5hcHBlbmQoImNsYXNzIFgge1xuIik7CisJ
CWJ1Zi5hcHBlbmQoIgljbGFzcyBZIHtcbiIpOworCQlidWYuYXBwZW5kKCIgICAgCXB1YmxpYyBZ
KCBAQSBYIHRoaXMgLCBAQiBib29sZWFuIGIgLCBpbnQgaSApIHtcbiIpOworCQlidWYuYXBwZW5k
KCIgICAgCX1cbiIpOworCQlidWYuYXBwZW5kKCIgICAgfVxuIik7CisJCWJ1Zi5hcHBlbmQoIn1c
biIpOworCQlhc3NlcnRFcXVhbFN0cmluZyhwcmV2aWV3LCBidWYudG9TdHJpbmcoKSk7CisJfQor
CXB1YmxpYyB2b2lkIHRlc3RSZWNlaXZlcjMoKSB0aHJvd3MgRXhjZXB0aW9uIHsKKwkJSVBhY2th
Z2VGcmFnbWVudCBwYWNrMSA9IHRoaXMuc291cmNlRm9sZGVyLmNyZWF0ZVBhY2thZ2VGcmFnbWVu
dCgidGVzdDEiLCBmYWxzZSwgbnVsbCk7CisJCVN0cmluZ0J1ZmZlciBidWYgPSBuZXcgU3RyaW5n
QnVmZmVyKCk7CisJCWJ1Zi5hcHBlbmQoInBhY2thZ2UgdGVzdDE7XG4iKTsKKwkJYnVmLmFwcGVu
ZCgiY2xhc3MgWCB7XG4iKTsKKwkJYnVmLmFwcGVuZCgiICAgIHB1YmxpYyB2b2lkIGZvbyAoIFgg
dGhpcyApIHt9XG4iKTsKKwkJYnVmLmFwcGVuZCgiICAgIHB1YmxpYyB2b2lkIGZvbyAoICApIHt9
XG4iKTsKKwkJYnVmLmFwcGVuZCgiICAgIHB1YmxpYyB2b2lkIGZvbyAoIFggdGhpcyAsLypjb21t
ZW50Ki8gaW50IGkgKSB7fVxuIik7CisJCWJ1Zi5hcHBlbmQoIiAgICBwdWJsaWMgdm9pZCBmb28g
KCBpbnQgaSAsIGludCBqICkge31cbiIpOworCQlidWYuYXBwZW5kKCIgICAgcHVibGljIHZvaWQg
Zm9vICggWCB0aGlzICkge31cbiIpOworCQlidWYuYXBwZW5kKCIgICAgcHVibGljIHZvaWQgZm9v
ICggWCB0aGlzICwgZmxvYXQgZjEgLCBmbG9hdCBmMiApIHt9XG4iKTsKKwkJYnVmLmFwcGVuZCgi
ICAgIHB1YmxpYyB2b2lkIGZvbyAoIFggdGhpcyAsIGludCBpKSB7fVxuIik7CisJCWJ1Zi5hcHBl
bmQoIiAgICBwdWJsaWMgdm9pZCBmb28gKCBYIHRoaXMgLCBmbG9hdCBmICkge31cbiIpOworCQli
dWYuYXBwZW5kKCJ9XG4iKTsKKwkJSUNvbXBpbGF0aW9uVW5pdCBjdT0gcGFjazEuY3JlYXRlQ29t
cGlsYXRpb25Vbml0KCJYLmphdmEiLCBidWYudG9TdHJpbmcoKSwgZmFsc2UsIG51bGwpOworCQlD
b21waWxhdGlvblVuaXQgYXN0Um9vdCA9IGNyZWF0ZUFTVDgoY3UpOworCQlBU1QgYXN0ID0gYXN0
Um9vdC5nZXRBU1QoKTsKKwkJQVNUUmV3cml0ZSByZXdyaXRlID0gQVNUUmV3cml0ZS5jcmVhdGUo
YXN0Um9vdC5nZXRBU1QoKSk7CisJCVR5cGVEZWNsYXJhdGlvbiB0eXBlID0gZmluZFR5cGVEZWNs
YXJhdGlvbihhc3RSb290LCAiWCIpOworCQlNZXRob2REZWNsYXJhdGlvbiBtZXRob2QxID0gKE1l
dGhvZERlY2xhcmF0aW9uKSB0eXBlLmJvZHlEZWNsYXJhdGlvbnMoKS5nZXQoMCk7CisJCU1ldGhv
ZERlY2xhcmF0aW9uIG1ldGhvZDIgPSAoTWV0aG9kRGVjbGFyYXRpb24pIHR5cGUuYm9keURlY2xh
cmF0aW9ucygpLmdldCgxKTsKKwkJTWV0aG9kRGVjbGFyYXRpb24gbWV0aG9kMyA9IChNZXRob2RE
ZWNsYXJhdGlvbikgdHlwZS5ib2R5RGVjbGFyYXRpb25zKCkuZ2V0KDIpOworCQlNZXRob2REZWNs
YXJhdGlvbiBtZXRob2Q0ID0gKE1ldGhvZERlY2xhcmF0aW9uKSB0eXBlLmJvZHlEZWNsYXJhdGlv
bnMoKS5nZXQoMyk7CisJCU1ldGhvZERlY2xhcmF0aW9uIG1ldGhvZDUgPSAoTWV0aG9kRGVjbGFy
YXRpb24pIHR5cGUuYm9keURlY2xhcmF0aW9ucygpLmdldCg0KTsKKwkJTWV0aG9kRGVjbGFyYXRp
b24gbWV0aG9kNiA9IChNZXRob2REZWNsYXJhdGlvbikgdHlwZS5ib2R5RGVjbGFyYXRpb25zKCku
Z2V0KDUpOworCQlNZXRob2REZWNsYXJhdGlvbiBtZXRob2Q3ID0gKE1ldGhvZERlY2xhcmF0aW9u
KSB0eXBlLmJvZHlEZWNsYXJhdGlvbnMoKS5nZXQoNik7CisJCU1ldGhvZERlY2xhcmF0aW9uIG1l
dGhvZDggPSAoTWV0aG9kRGVjbGFyYXRpb24pIHR5cGUuYm9keURlY2xhcmF0aW9ucygpLmdldCg3
KTsKKworCQlTaW5nbGVWYXJpYWJsZURlY2xhcmF0aW9uIHJlY2VpdmVyMSA9IG1ldGhvZDEuZ2V0
UmVjZWl2ZXIoKTsKKwkJU2luZ2xlVmFyaWFibGVEZWNsYXJhdGlvbiByZWNlaXZlcjMgPSBtZXRo
b2QzLmdldFJlY2VpdmVyKCk7CisJCVNpbmdsZVZhcmlhYmxlRGVjbGFyYXRpb24gcmVjZWl2ZXI1
ID0gbWV0aG9kNS5nZXRSZWNlaXZlcigpOworCQlTaW5nbGVWYXJpYWJsZURlY2xhcmF0aW9uIHJl
Y2VpdmVyNiA9IG1ldGhvZDYuZ2V0UmVjZWl2ZXIoKTsKKwkJU2luZ2xlVmFyaWFibGVEZWNsYXJh
dGlvbiByZWNlaXZlcjggPSBtZXRob2Q4LmdldFJlY2VpdmVyKCk7CisKKwkJU2luZ2xlVmFyaWFi
bGVEZWNsYXJhdGlvbiByZWNlaXZlckNvcHkgPSAoU2luZ2xlVmFyaWFibGVEZWNsYXJhdGlvbikg
cmV3cml0ZS5jcmVhdGVDb3B5VGFyZ2V0KHJlY2VpdmVyMSk7CisJCXJld3JpdGUuc2V0KG1ldGhv
ZDIsIE1ldGhvZERlY2xhcmF0aW9uLlJFQ0VJVkVSX1BST1BFUlRZLCByZWNlaXZlckNvcHksIG51
bGwpOworCQlyZXdyaXRlLnJlbW92ZShyZWNlaXZlcjEsIG51bGwpOworCisJCXJlY2VpdmVyQ29w
eSA9IChTaW5nbGVWYXJpYWJsZURlY2xhcmF0aW9uKSByZXdyaXRlLmNyZWF0ZUNvcHlUYXJnZXQo
cmVjZWl2ZXIzKTsKKwkJcmV3cml0ZS5zZXQobWV0aG9kNCwgTWV0aG9kRGVjbGFyYXRpb24uUkVD
RUlWRVJfUFJPUEVSVFksIHJlY2VpdmVyQ29weSwgbnVsbCk7CisJCXJld3JpdGUucmVtb3ZlKHJl
Y2VpdmVyMywgbnVsbCk7CisKKwkJTGlzdFJld3JpdGUgbGlzdFJld3JpdGUgPSByZXdyaXRlLmdl
dExpc3RSZXdyaXRlKG1ldGhvZDMsIE1ldGhvZERlY2xhcmF0aW9uLk1PRElGSUVSUzJfUFJPUEVS
VFkpOworCQlsaXN0UmV3cml0ZS5pbnNlcnRMYXN0KGFzdC5uZXdNb2RpZmllcihNb2RpZmllci5N
b2RpZmllcktleXdvcmQuRklOQUxfS0VZV09SRCksIG51bGwpOworCisJCXJlY2VpdmVyQ29weSA9
IGFzdC5uZXdTaW5nbGVWYXJpYWJsZURlY2xhcmF0aW9uKCk7CisJCXJlY2VpdmVyQ29weS5zZXRU
eXBlKGFzdC5uZXdTaW1wbGVUeXBlKGFzdC5uZXdTaW1wbGVOYW1lKCJYWSIpKSk7CisJCXJlY2Vp
dmVyQ29weS5zZXROYW1lKChTaW1wbGVOYW1lKXJld3JpdGUuY3JlYXRlQ29weVRhcmdldChyZWNl
aXZlcjUuZ2V0TmFtZSgpKSk7CisJCXJld3JpdGUucmVwbGFjZShyZWNlaXZlcjUsIHJlY2VpdmVy
Q29weSwgbnVsbCk7CisKKwkJcmVjZWl2ZXJDb3B5ID0gYXN0Lm5ld1NpbmdsZVZhcmlhYmxlRGVj
bGFyYXRpb24oKTsKKwkJcmVjZWl2ZXJDb3B5LnNldFR5cGUoYXN0Lm5ld1NpbXBsZVR5cGUoYXN0
Lm5ld1NpbXBsZU5hbWUoIlhZIikpKTsKKwkJcmVjZWl2ZXJDb3B5LnNldE5hbWUoKFNpbXBsZU5h
bWUpcmV3cml0ZS5jcmVhdGVDb3B5VGFyZ2V0KHJlY2VpdmVyNi5nZXROYW1lKCkpKTsKKwkJcmV3
cml0ZS5yZXBsYWNlKHJlY2VpdmVyNiwgcmVjZWl2ZXJDb3B5LCBudWxsKTsKKwkJU2luZ2xlVmFy
aWFibGVEZWNsYXJhdGlvbiBwYXJhbUNvcHkgPSAoU2luZ2xlVmFyaWFibGVEZWNsYXJhdGlvbikg
cmV3cml0ZS5jcmVhdGVDb3B5VGFyZ2V0KChTaW5nbGVWYXJpYWJsZURlY2xhcmF0aW9uKSBtZXRo
b2Q2LnBhcmFtZXRlcnMoKS5nZXQoMCkpOworCQlyZXdyaXRlLnJlbW92ZSgoU2luZ2xlVmFyaWFi
bGVEZWNsYXJhdGlvbikgbWV0aG9kNi5wYXJhbWV0ZXJzKCkuZ2V0KDApLCBudWxsKTsKKworCQls
aXN0UmV3cml0ZSA9IHJld3JpdGUuZ2V0TGlzdFJld3JpdGUobWV0aG9kNywgTWV0aG9kRGVjbGFy
YXRpb24uUEFSQU1FVEVSU19QUk9QRVJUWSk7CisJCWxpc3RSZXdyaXRlLmluc2VydExhc3QocGFy
YW1Db3B5LCBudWxsKTsKKworCQlyZXdyaXRlLnJlbW92ZShyZWNlaXZlcjgsIG51bGwpOworCQly
ZXdyaXRlLnJlbW92ZSgoU2luZ2xlVmFyaWFibGVEZWNsYXJhdGlvbikgbWV0aG9kOC5wYXJhbWV0
ZXJzKCkuZ2V0KDApLCBudWxsKTsKKworCQlTdHJpbmcgcHJldmlldyA9IGV2YWx1YXRlUmV3cml0
ZShjdSwgcmV3cml0ZSk7CisJCWJ1ZiA9IG5ldyBTdHJpbmdCdWZmZXIoKTsKKwkJYnVmLmFwcGVu
ZCgicGFja2FnZSB0ZXN0MTtcbiIpOworCQlidWYuYXBwZW5kKCJjbGFzcyBYIHtcbiIpOworCQli
dWYuYXBwZW5kKCIgICAgcHVibGljIHZvaWQgZm9vICggKSB7fVxuIik7CisJCWJ1Zi5hcHBlbmQo
IiAgICBwdWJsaWMgdm9pZCBmb28gKFggdGhpcyAgKSB7fVxuIik7CisJCWJ1Zi5hcHBlbmQoIiAg
ICBwdWJsaWMgZmluYWwgdm9pZCBmb28gKC8qY29tbWVudCovIGludCBpICkge31cbiIpOworCQli
dWYuYXBwZW5kKCIgICAgcHVibGljIHZvaWQgZm9vIChYIHRoaXMsICBpbnQgaSAsIGludCBqICkg
e31cbiIpOworCQlidWYuYXBwZW5kKCIgICAgcHVibGljIHZvaWQgZm9vICggWFkgdGhpcyApIHt9
XG4iKTsKKwkJYnVmLmFwcGVuZCgiICAgIHB1YmxpYyB2b2lkIGZvbyAoIFhZIHRoaXMgLCBmbG9h
dCBmMiApIHt9XG4iKTsKKwkJYnVmLmFwcGVuZCgiICAgIHB1YmxpYyB2b2lkIGZvbyAoIFggdGhp
cyAsIGludCBpLCBmbG9hdCBmMSkge31cbiIpOworCQlidWYuYXBwZW5kKCIgICAgcHVibGljIHZv
aWQgZm9vICggKSB7fVxuIik7CisJCWJ1Zi5hcHBlbmQoIn1cbiIpOworCQlhc3NlcnRFcXVhbFN0
cmluZyhwcmV2aWV3LCBidWYudG9TdHJpbmcoKSk7CisJfQogfQpkaWZmIC0tZ2l0IGEvb3JnLmVj
bGlwc2UuamR0LmNvcmUudGVzdHMubW9kZWwvc3JjL29yZy9lY2xpcHNlL2pkdC9jb3JlL3Rlc3Rz
L3Jld3JpdGUvZGVzY3JpYmluZy9BU1RSZXdyaXRpbmdUZXN0LmphdmEgYi9vcmcuZWNsaXBzZS5q
ZHQuY29yZS50ZXN0cy5tb2RlbC9zcmMvb3JnL2VjbGlwc2UvamR0L2NvcmUvdGVzdHMvcmV3cml0
ZS9kZXNjcmliaW5nL0FTVFJld3JpdGluZ1Rlc3QuamF2YQppbmRleCBhNGQ4OTJkLi4wNDhjNjI5
IDEwMDY0NAotLS0gYS9vcmcuZWNsaXBzZS5qZHQuY29yZS50ZXN0cy5tb2RlbC9zcmMvb3JnL2Vj
bGlwc2UvamR0L2NvcmUvdGVzdHMvcmV3cml0ZS9kZXNjcmliaW5nL0FTVFJld3JpdGluZ1Rlc3Qu
amF2YQorKysgYi9vcmcuZWNsaXBzZS5qZHQuY29yZS50ZXN0cy5tb2RlbC9zcmMvb3JnL2VjbGlw
c2UvamR0L2NvcmUvdGVzdHMvcmV3cml0ZS9kZXNjcmliaW5nL0FTVFJld3JpdGluZ1Rlc3QuamF2
YQpAQCAtMTEyLDQgKzExMiw4IEBACiAJCXJldHVybiBjcmVhdGVBU1QoSkxTM19JTlRFUk5BTCwg
Y3UsIGZhbHNlKTsKIAl9CisKKwlwcm90ZWN0ZWQgQ29tcGlsYXRpb25Vbml0IGNyZWF0ZUFTVDgo
SUNvbXBpbGF0aW9uVW5pdCBjdSkgeworCQlyZXR1cm4gY3JlYXRlQVNUKEFTVC5KTFM4LCBjdSwg
ZmFsc2UpOworCX0KIAkKIAlwcm90ZWN0ZWQgQ29tcGlsYXRpb25Vbml0IGNyZWF0ZUFTVDMoSUNv
bXBpbGF0aW9uVW5pdCBjdSwgYm9vbGVhbiBzdGF0ZW1lbnRzUmVjb3ZlcnkpIHsKZGlmZiAtLWdp
dCBhL29yZy5lY2xpcHNlLmpkdC5jb3JlL2RvbS9vcmcvZWNsaXBzZS9qZHQvaW50ZXJuYWwvY29y
ZS9kb20vcmV3cml0ZS9BU1RSZXdyaXRlQW5hbHl6ZXIuamF2YSBiL29yZy5lY2xpcHNlLmpkdC5j
b3JlL2RvbS9vcmcvZWNsaXBzZS9qZHQvaW50ZXJuYWwvY29yZS9kb20vcmV3cml0ZS9BU1RSZXdy
aXRlQW5hbHl6ZXIuamF2YQppbmRleCBiMjYxMWExLi4xMDk0ZTU3IDEwMDY0NAotLS0gYS9vcmcu
ZWNsaXBzZS5qZHQuY29yZS9kb20vb3JnL2VjbGlwc2UvamR0L2ludGVybmFsL2NvcmUvZG9tL3Jl
d3JpdGUvQVNUUmV3cml0ZUFuYWx5emVyLmphdmEKKysrIGIvb3JnLmVjbGlwc2UuamR0LmNvcmUv
ZG9tL29yZy9lY2xpcHNlL2pkdC9pbnRlcm5hbC9jb3JlL2RvbS9yZXdyaXRlL0FTVFJld3JpdGVB
bmFseXplci5qYXZhCkBAIC0xNzk4LDQgKzE3OTgsNTEgQEAKIAl9CiAKKwlwcml2YXRlIGludCBy
ZXdyaXRlUmVjZWl2ZXIoTWV0aG9kRGVjbGFyYXRpb24gbWV0aG9kLCBTdHJ1Y3R1cmFsUHJvcGVy
dHlEZXNjcmlwdG9yIHByb3BlcnR5LCBpbnQgb2Zmc2V0LCBpbnQgYXN0TGV2ZWwpIHRocm93cyBD
b3JlRXhjZXB0aW9uIHsKKwkKKwkJaW50IG5ld09mZnNldCA9IG9mZnNldDsKKwkJaWYgKGFzdExl
dmVsID49IEFTVC5KTFM4KSB7CisJCQlSZXdyaXRlRXZlbnQgZXZlbnQgPSBnZXRFdmVudChtZXRo
b2QsIHByb3BlcnR5KTsKKwkJCWlmIChldmVudCAhPSBudWxsKSB7CisJCQkJc3dpdGNoKGV2ZW50
LmdldENoYW5nZUtpbmQoKSkgeworCQkJCQljYXNlIFJld3JpdGVFdmVudC5JTlNFUlRFRDoKKwkJ
CQkJCW5ld09mZnNldCA9IGdldFNjYW5uZXIoKS5nZXRUb2tlbkVuZE9mZnNldChUZXJtaW5hbFRv
a2Vucy5Ub2tlbk5hbWVMUEFSRU4sIG5ld09mZnNldCk7IAorCQkJCQkJbmV3T2Zmc2V0ID0gcmV3
cml0ZU5vZGUobWV0aG9kLCBwcm9wZXJ0eSwgbmV3T2Zmc2V0LCBBU1RSZXdyaXRlRm9ybWF0dGVy
Lk5PTkUpOworCQkJCQkJaW50IG5ld1BhcmFtQ291bnQgPSAoKExpc3QpIGdldE5ld1ZhbHVlKG1l
dGhvZCwgTWV0aG9kRGVjbGFyYXRpb24uUEFSQU1FVEVSU19QUk9QRVJUWSkpLnNpemUoKTsKKwkJ
CQkJCWlmIChuZXdQYXJhbUNvdW50ID4gMCkgeworCQkJCQkJCVRleHRFZGl0R3JvdXAgZWRpdEdy
b3VwID0gZ2V0RWRpdEdyb3VwKG1ldGhvZCwgcHJvcGVydHkpOworCQkJCQkJCWRvVGV4dEluc2Vy
dChuZXdPZmZzZXQsICIsICIsIGVkaXRHcm91cCk7IC8vJE5PTi1OTFMtMSQKKwkJCQkJCX0KKwkJ
CQkJCWJyZWFrOworCQkJCQljYXNlIFJld3JpdGVFdmVudC5SRU1PVkVEOgorCQkJCQkJLy8gQW55
IHdoaXRlIHNwYWNlIGJlZm9yZSB0aGUgcmVjZWl2ZXIgd2lsbCBnZXQgcmVtb3ZlZCB0b28uIAor
CQkJCQkJLy8gQnV0IHRoZSBzcGFjZSBhZnRlciB0aGUgcmVjZWl2ZXIgaWYgdGhlcmUgYXJlIG5v
IHBhcmFtZXRlcnMgd2lsbCBub3QgYmUgcmVtb3ZlZAorCQkJCQkJbmV3T2Zmc2V0ID0gZ2V0U2Nh
bm5lcigpLmdldFRva2VuRW5kT2Zmc2V0KFRlcm1pbmFsVG9rZW5zLlRva2VuTmFtZUxQQVJFTiwg
bmV3T2Zmc2V0KTsKKwkJCQkJCW5ld09mZnNldCA9IHJld3JpdGVOb2RlKG1ldGhvZCwgcHJvcGVy
dHksIG5ld09mZnNldCwgQVNUUmV3cml0ZUZvcm1hdHRlci5OT05FKTsKKwkJCQkJCWludCBvbGRQ
YXJhbUNvdW50ID0gbWV0aG9kLnBhcmFtZXRlcnMoKS5zaXplKCk7CisJCQkJCQlpZiAob2xkUGFy
YW1Db3VudCA+IDApIHsKKwkJCQkJCQkvLyBJZiB0aGUgb2xkIGZpcnN0IHBhcmFtZXRlciBoYWQg
c3BhY2UgYWZ0ZXIgdGhlIGNvbW1hLCAKKwkJCQkJCQkvLyBpdCB3aWxsIGJlIHJldGFpbmVkLiBQ
cm9iYWJseSBub3QgdGhlIHBlcmZlY3QgdGhpbmcgdG8gZG8/CisJCQkJCQkJaW50IGNvbW1hID0g
Z2V0U2Nhbm5lcigpLmdldFRva2VuRW5kT2Zmc2V0KFRlcm1pbmFsVG9rZW5zLlRva2VuTmFtZUNP
TU1BLCBuZXdPZmZzZXQpOworCQkJCQkJCVRleHRFZGl0R3JvdXAgZWRpdEdyb3VwID0gZ2V0RWRp
dEdyb3VwKG1ldGhvZCwgcHJvcGVydHkpOworCQkJCQkJCWRvVGV4dFJlbW92ZShuZXdPZmZzZXQs
IChjb21tYSAtIG5ld09mZnNldCksIGVkaXRHcm91cCk7CisJCQkJCQkJbmV3T2Zmc2V0ID0gY29t
bWE7CisJCQkJCQl9CisJCQkJCQlicmVhazsKKwkJCQkJY2FzZSBSZXdyaXRlRXZlbnQuQ0hJTERS
RU5fQ0hBTkdFRDoKKwkJCQkJY2FzZSBSZXdyaXRlRXZlbnQuUkVQTEFDRUQ6CisJCQkJCQkJbmV3
T2Zmc2V0ID0gcmV3cml0ZU5vZGUobWV0aG9kLCBwcm9wZXJ0eSwgbmV3T2Zmc2V0LCBBU1RSZXdy
aXRlRm9ybWF0dGVyLk5PTkUpOworCQkJCQkJCWJyZWFrOworCQkJCQlkZWZhdWx0OgorCQkJCQkJ
YnJlYWs7CisJCQkJfQorCQkJfSBlbHNlIHsKKwkJCQluZXdPZmZzZXQgPSBkb1Zpc2l0KG1ldGhv
ZCwgcHJvcGVydHksIG5ld09mZnNldCk7CisJCQl9CisJCX0KKwkJaWYgKG5ld09mZnNldCA9PSBv
ZmZzZXQpIHsKKwkJCW5ld09mZnNldCA9IGdldFNjYW5uZXIoKS5nZXRUb2tlbkVuZE9mZnNldChU
ZXJtaW5hbFRva2Vucy5Ub2tlbk5hbWVMUEFSRU4sIG5ld09mZnNldCk7CisJCX0KKwkJcmV0dXJu
IG5ld09mZnNldDsKKwl9CiAKIAkvKiAobm9uLUphdmFkb2MpCkBAIC0xODA3LDUgKzE4NTQsNiBA
QAogCQl9CiAJCWludCBwb3M9IHJld3JpdGVKYXZhZG9jKG5vZGUsIE1ldGhvZERlY2xhcmF0aW9u
LkpBVkFET0NfUFJPUEVSVFkpOwotCQlpZiAobm9kZS5nZXRBU1QoKS5hcGlMZXZlbCgpID09IEpM
UzJfSU5URVJOQUwpIHsKKwkJaW50IGFwaUxldmVsID0gbm9kZS5nZXRBU1QoKS5hcGlMZXZlbCgp
OworCQlpZiAoYXBpTGV2ZWwgPT0gSkxTMl9JTlRFUk5BTCkgewogCQkJcmV3cml0ZU1vZGlmaWVy
cyhub2RlLCBNZXRob2REZWNsYXJhdGlvbi5NT0RJRklFUlNfUFJPUEVSVFksIHBvcyk7CiAJCX0g
ZWxzZSB7CkBAIC0xODIyLDkgKzE4NzAsMTAgQEAKIAkJcG9zPSByZXdyaXRlUmVxdWlyZWROb2Rl
KG5vZGUsIE1ldGhvZERlY2xhcmF0aW9uLk5BTUVfUFJPUEVSVFkpOwogCi0JCS8vIHBhcmFtZXRl
cnMKKwkJLy8gcGFyYW1ldGVycywgaW5jbHVkaW5nIGV4cGxpY2l0ICd0aGlzJyBpZiBhbnkKIAkJ
dHJ5IHsKKwkJCSBwb3MgPSByZXdyaXRlUmVjZWl2ZXIobm9kZSwgTWV0aG9kRGVjbGFyYXRpb24u
UkVDRUlWRVJfUFJPUEVSVFksIHBvcywgYXBpTGV2ZWwpOworCiAJCQlpZiAoaXNDaGFuZ2VkKG5v
ZGUsIE1ldGhvZERlY2xhcmF0aW9uLlBBUkFNRVRFUlNfUFJPUEVSVFkpKSB7Ci0JCQkJcG9zPSBn
ZXRTY2FubmVyKCkuZ2V0VG9rZW5FbmRPZmZzZXQoVGVybWluYWxUb2tlbnMuVG9rZW5OYW1lTFBB
UkVOLCBwb3MpOwotCQkJCXBvcz0gcmV3cml0ZU5vZGVMaXN0KG5vZGUsIE1ldGhvZERlY2xhcmF0
aW9uLlBBUkFNRVRFUlNfUFJPUEVSVFksIHBvcywgVXRpbC5FTVBUWV9TVFJJTkcsICIsICIpOyAv
LyROT04tTkxTLTEkIAorCQkJCSBwb3M9IHJld3JpdGVOb2RlTGlzdChub2RlLCBNZXRob2REZWNs
YXJhdGlvbi5QQVJBTUVURVJTX1BST1BFUlRZLCBwb3MsIFV0aWwuRU1QVFlfU1RSSU5HLCAiLCAi
KTsgLy8kTk9OLU5MUy0xJCAKIAkJCX0gZWxzZSB7CiAJCQkJcG9zPSBkb1Zpc2l0KG5vZGUsIE1l
dGhvZERlY2xhcmF0aW9uLlBBUkFNRVRFUlNfUFJPUEVSVFksIHBvcyk7CmRpZmYgLS1naXQgYS9v
cmcuZWNsaXBzZS5qZHQuY29yZS9kb20vb3JnL2VjbGlwc2UvamR0L2ludGVybmFsL2NvcmUvZG9t
L3Jld3JpdGUvQVNUUmV3cml0ZUZsYXR0ZW5lci5qYXZhIGIvb3JnLmVjbGlwc2UuamR0LmNvcmUv
ZG9tL29yZy9lY2xpcHNlL2pkdC9pbnRlcm5hbC9jb3JlL2RvbS9yZXdyaXRlL0FTVFJld3JpdGVG
bGF0dGVuZXIuamF2YQppbmRleCAxNGQyYjU5Li5jYjI5ZDUwIDEwMDY0NAotLS0gYS9vcmcuZWNs
aXBzZS5qZHQuY29yZS9kb20vb3JnL2VjbGlwc2UvamR0L2ludGVybmFsL2NvcmUvZG9tL3Jld3Jp
dGUvQVNUUmV3cml0ZUZsYXR0ZW5lci5qYXZhCisrKyBiL29yZy5lY2xpcHNlLmpkdC5jb3JlL2Rv
bS9vcmcvZWNsaXBzZS9qZHQvaW50ZXJuYWwvY29yZS9kb20vcmV3cml0ZS9BU1RSZXdyaXRlRmxh
dHRlbmVyLmphdmEKQEAgLTEzMSw0ICsxMzEsOCBAQAogCXByb3RlY3RlZCB2b2lkIHZpc2l0TGlz
dChBU1ROb2RlIHBhcmVudCwgU3RydWN0dXJhbFByb3BlcnR5RGVzY3JpcHRvciBjaGlsZFByb3Bl
cnR5LCBTdHJpbmcgc2VwYXJhdG9yKSB7CiAJCUxpc3QgbGlzdD0gZ2V0Q2hpbGRMaXN0KHBhcmVu
dCwgY2hpbGRQcm9wZXJ0eSk7CisJCXZpc2l0TGlzdChsaXN0LCBzZXBhcmF0b3IpOworCX0KKwor
CXByb3RlY3RlZCB2b2lkIHZpc2l0TGlzdChMaXN0IGxpc3QsIFN0cmluZyBzZXBhcmF0b3IpIHsK
IAkJZm9yIChpbnQgaT0gMDsgaSA8IGxpc3Quc2l6ZSgpOyBpKyspIHsKIAkJCWlmIChzZXBhcmF0
b3IgIT0gbnVsbCAmJiBpID4gMCkgewpAQCAtMTM4LDE1ICsxNDIsOSBAQAogCQl9CiAJfQotCiAJ
cHJvdGVjdGVkIHZvaWQgdmlzaXRMaXN0KEFTVE5vZGUgcGFyZW50LCBTdHJ1Y3R1cmFsUHJvcGVy
dHlEZXNjcmlwdG9yIGNoaWxkUHJvcGVydHksIFN0cmluZyBzZXBhcmF0b3IsIFN0cmluZyBsZWFk
LCBTdHJpbmcgcG9zdCkgewogCQlMaXN0IGxpc3Q9IGdldENoaWxkTGlzdChwYXJlbnQsIGNoaWxk
UHJvcGVydHkpOwogCQlpZiAoIWxpc3QuaXNFbXB0eSgpKSB7CiAJCQl0aGlzLnJlc3VsdC5hcHBl
bmQobGVhZCk7Ci0JCQlmb3IgKGludCBpPSAwOyBpIDwgbGlzdC5zaXplKCk7IGkrKykgewotCQkJ
CWlmIChzZXBhcmF0b3IgIT0gbnVsbCAmJiBpID4gMCkgewotCQkJCQl0aGlzLnJlc3VsdC5hcHBl
bmQoc2VwYXJhdG9yKTsKLQkJCQl9Ci0JCQkJKChBU1ROb2RlKSBsaXN0LmdldChpKSkuYWNjZXB0
KHRoaXMpOwotCQkJfQorCQkJdmlzaXRMaXN0KGxpc3QsIHNlcGFyYXRvcik7CiAJCQl0aGlzLnJl
c3VsdC5hcHBlbmQocG9zdCk7CiAJCX0KQEAgLTU5OCw1ICs1OTYsNiBAQAogCQkJamF2YWRvYy5h
Y2NlcHQodGhpcyk7CiAJCX0KLQkJaWYgKG5vZGUuZ2V0QVNUKCkuYXBpTGV2ZWwoKSA9PSBKTFMy
X0lOVEVSTkFMKSB7CisJCWludCBhcGlMZXZlbCA9IG5vZGUuZ2V0QVNUKCkuYXBpTGV2ZWwoKTsK
KwkJaWYgKGFwaUxldmVsID09IEpMUzJfSU5URVJOQUwpIHsKIAkJCXByaW50TW9kaWZpZXJzKGdl
dEludEF0dHJpYnV0ZShub2RlLCBNZXRob2REZWNsYXJhdGlvbi5NT0RJRklFUlNfUFJPUEVSVFkp
LCB0aGlzLnJlc3VsdCk7CiAJCX0gZWxzZSB7CkBAIC02MDYsNSArNjA1LDUgQEAKIAogCQlpZiAo
IWdldEJvb2xlYW5BdHRyaWJ1dGUobm9kZSwgTWV0aG9kRGVjbGFyYXRpb24uQ09OU1RSVUNUT1Jf
UFJPUEVSVFkpKSB7Ci0JCQlpZiAobm9kZS5nZXRBU1QoKS5hcGlMZXZlbCgpID09IEpMUzJfSU5U
RVJOQUwpIHsKKwkJCWlmIChhcGlMZXZlbCA9PSBKTFMyX0lOVEVSTkFMKSB7CiAJCQkJZ2V0Q2hp
bGROb2RlKG5vZGUsIE1ldGhvZERlY2xhcmF0aW9uLlJFVFVSTl9UWVBFX1BST1BFUlRZKS5hY2Nl
cHQodGhpcyk7CiAJCQl9IGVsc2UgewpAQCAtNjIwLDYgKzYxOSwxNiBAQAogCQl9CiAJCWdldENo
aWxkTm9kZShub2RlLCBNZXRob2REZWNsYXJhdGlvbi5OQU1FX1BST1BFUlRZKS5hY2NlcHQodGhp
cyk7CisJCUxpc3QgcGFyYW1ldGVycyA9IGdldENoaWxkTGlzdChub2RlLCAgTWV0aG9kRGVjbGFy
YXRpb24uUEFSQU1FVEVSU19QUk9QRVJUWSk7CiAJCXRoaXMucmVzdWx0LmFwcGVuZCgnKCcpOwot
CQl2aXNpdExpc3Qobm9kZSwgTWV0aG9kRGVjbGFyYXRpb24uUEFSQU1FVEVSU19QUk9QRVJUWSwg
U3RyaW5nLnZhbHVlT2YoJywnKSk7CisJCWlmIChhcGlMZXZlbCA+PSBBU1QuSkxTOCkgeworCQkJ
QVNUTm9kZSByZWNlaXZlciA9IGdldENoaWxkTm9kZShub2RlLCBNZXRob2REZWNsYXJhdGlvbi5S
RUNFSVZFUl9QUk9QRVJUWSk7CisJCQlpZiAocmVjZWl2ZXIgIT0gbnVsbCkgeworCQkJCXJlY2Vp
dmVyLmFjY2VwdCh0aGlzKTsKKwkJCQlpZiAocGFyYW1ldGVycy5zaXplKCkgPiAwKSB7CisJCQkJ
CXRoaXMucmVzdWx0LmFwcGVuZChTdHJpbmcudmFsdWVPZignLCcpKTsKKwkJCQl9CisJCQl9CisJ
CX0KKwkJdmlzaXRMaXN0KHBhcmFtZXRlcnMsIFN0cmluZy52YWx1ZU9mKCcsJykpOwogCQl0aGlz
LnJlc3VsdC5hcHBlbmQoJyknKTsKIAkJaW50IGV4dHJhRGltcz0gZ2V0SW50QXR0cmlidXRlKG5v
ZGUsIE1ldGhvZERlY2xhcmF0aW9uLkVYVFJBX0RJTUVOU0lPTlNfUFJPUEVSVFkpOw==
</data>

          </attachment>
          <attachment
              isobsolete="1"
              ispatch="1"
              isprivate="0"
          >
            <attachid>228084</attachid>
            <date>2013-03-07 13:31:00 -0500</date>
            <delta_ts>2013-03-14 17:03:12 -0400</delta_ts>
            <desc>Updated patch</desc>
            <filename>Fix-for-bug-395612.patch</filename>
            <type>text/plain</type>
            <size>22785</size>
            <attacher name="Jay Arthanareeswaran">jarthana</attacher>
            
              <data encoding="base64">ZGlmZiAtLWdpdCBhL29yZy5lY2xpcHNlLmpkdC5jb3JlLnRlc3RzLm1vZGVsL3NyYy9vcmcvZWNs
aXBzZS9qZHQvY29yZS90ZXN0cy9yZXdyaXRlL2Rlc2NyaWJpbmcvQVNUUmV3cml0aW5nTWV0aG9k
RGVjbFRlc3QuamF2YSBiL29yZy5lY2xpcHNlLmpkdC5jb3JlLnRlc3RzLm1vZGVsL3NyYy9vcmcv
ZWNsaXBzZS9qZHQvY29yZS90ZXN0cy9yZXdyaXRlL2Rlc2NyaWJpbmcvQVNUUmV3cml0aW5nTWV0
aG9kRGVjbFRlc3QuamF2YQppbmRleCA0MDUwNTkzLi42ODE5MTQzIDEwMDY0NAotLS0gYS9vcmcu
ZWNsaXBzZS5qZHQuY29yZS50ZXN0cy5tb2RlbC9zcmMvb3JnL2VjbGlwc2UvamR0L2NvcmUvdGVz
dHMvcmV3cml0ZS9kZXNjcmliaW5nL0FTVFJld3JpdGluZ01ldGhvZERlY2xUZXN0LmphdmEKKysr
IGIvb3JnLmVjbGlwc2UuamR0LmNvcmUudGVzdHMubW9kZWwvc3JjL29yZy9lY2xpcHNlL2pkdC9j
b3JlL3Rlc3RzL3Jld3JpdGUvZGVzY3JpYmluZy9BU1RSZXdyaXRpbmdNZXRob2REZWNsVGVzdC5q
YXZhCkBAIC0zMjI2LDMgKzMyMjYsMjgzIEBACiAJCWFzc2VydEVxdWFsU3RyaW5nKHByZXZpZXcs
IGJ1Zi50b1N0cmluZygpKTsKIAl9CisJcHVibGljIHZvaWQgdGVzdFJlY2VpdmVyMV9zaW5jZV84
KCkgdGhyb3dzIEV4Y2VwdGlvbiB7CisJCUlQYWNrYWdlRnJhZ21lbnQgcGFjazEgPSB0aGlzLnNv
dXJjZUZvbGRlci5jcmVhdGVQYWNrYWdlRnJhZ21lbnQoInRlc3QxIiwgZmFsc2UsIG51bGwpOwor
CQlTdHJpbmdCdWZmZXIgYnVmID0gbmV3IFN0cmluZ0J1ZmZlcigpOworCQlidWYuYXBwZW5kKCJw
YWNrYWdlIHRlc3QxO1xuIik7CisJCWJ1Zi5hcHBlbmQoImNsYXNzIFgge1xuIik7CisJCWJ1Zi5h
cHBlbmQoIiAgICBwdWJsaWMgdm9pZCBmb28oIEBBIEBCIEBDIFggdGhpcywgaW50IGkgLCBpbnQg
aiApIHtcbiIpOworCQlidWYuYXBwZW5kKCIgICAgfVxuIik7CisJCWJ1Zi5hcHBlbmQoIn1cbiIp
OworCQlJQ29tcGlsYXRpb25Vbml0IGN1PSBwYWNrMS5jcmVhdGVDb21waWxhdGlvblVuaXQoIlgu
amF2YSIsIGJ1Zi50b1N0cmluZygpLCBmYWxzZSwgbnVsbCk7CisJCUNvbXBpbGF0aW9uVW5pdCBh
c3RSb290ID0gY3JlYXRlQVNUKGN1KTsKKwkJQVNUUmV3cml0ZSByZXdyaXRlID0gQVNUUmV3cml0
ZS5jcmVhdGUoYXN0Um9vdC5nZXRBU1QoKSk7CisJCUFTVCBhc3QgPSBhc3RSb290LmdldEFTVCgp
OworCQlNZXRob2REZWNsYXJhdGlvbiBtZXRob2QgPSAoTWV0aG9kRGVjbGFyYXRpb24pIGZpbmRU
eXBlRGVjbGFyYXRpb24oYXN0Um9vdCwgIlgiKS5ib2R5RGVjbGFyYXRpb25zKCkuZ2V0KDApOwor
CQlBbm5vdGF0YWJsZVR5cGUgcmVjZWl2ZXJUeXBlID0gbWV0aG9kLmdldFJlY2VpdmVyVHlwZSgp
OworCQlhc3NlcnRFcXVhbHMoIkludmFsaWQgcmVjZWl2ZXIgdHlwZSIsIEFTVE5vZGUuU0lNUExF
X1RZUEUsIHJlY2VpdmVyVHlwZS5nZXROb2RlVHlwZSgpKTsKKwkJTWFya2VyQW5ub3RhdGlvbiBh
bm5vdCA9IGFzdC5uZXdNYXJrZXJBbm5vdGF0aW9uKCk7CisJCWFubm90LnNldFR5cGVOYW1lKGFz
dC5uZXdTaW1wbGVOYW1lKCJNYXJrZXIiKSk7CisJCUxpc3RSZXdyaXRlIGxpc3RSZXdyaXRlID0g
cmV3cml0ZS5nZXRMaXN0UmV3cml0ZShyZWNlaXZlclR5cGUsIFNpbXBsZVR5cGUuQU5OT1RBVElP
TlNfUFJPUEVSVFkpOworCQlsaXN0UmV3cml0ZS5pbnNlcnRGaXJzdChhbm5vdCwgbnVsbCk7CisK
KwkJU3RyaW5nIHByZXZpZXcgPSBldmFsdWF0ZVJld3JpdGUoY3UsIHJld3JpdGUpOworCQlidWYg
PSBuZXcgU3RyaW5nQnVmZmVyKCk7CisJCWJ1Zi5hcHBlbmQoInBhY2thZ2UgdGVzdDE7XG4iKTsK
KwkJYnVmLmFwcGVuZCgiY2xhc3MgWCB7XG4iKTsKKwkJYnVmLmFwcGVuZCgiICAgIHB1YmxpYyB2
b2lkIGZvbyggQE1hcmtlciBAQSBAQiBAQyBYIHRoaXMsIGludCBpICwgaW50IGogKSB7XG4iKTsK
KwkJYnVmLmFwcGVuZCgiICAgIH1cbiIpOworCQlidWYuYXBwZW5kKCJ9XG4iKTsKKwkJYXNzZXJ0
RXF1YWxTdHJpbmcocHJldmlldywgYnVmLnRvU3RyaW5nKCkpOworCX0KKwlwdWJsaWMgdm9pZCB0
ZXN0UmVjZWl2ZXIyX3NpbmNlXzgoKSB0aHJvd3MgRXhjZXB0aW9uIHsKKwkJSVBhY2thZ2VGcmFn
bWVudCBwYWNrMSA9IHRoaXMuc291cmNlRm9sZGVyLmNyZWF0ZVBhY2thZ2VGcmFnbWVudCgidGVz
dDEiLCBmYWxzZSwgbnVsbCk7CisJCVN0cmluZ0J1ZmZlciBidWYgPSBuZXcgU3RyaW5nQnVmZmVy
KCk7CisJCWJ1Zi5hcHBlbmQoInBhY2thZ2UgdGVzdDE7XG4iKTsKKwkJYnVmLmFwcGVuZCgiY2xh
c3MgWCB7XG4iKTsKKwkJYnVmLmFwcGVuZCgiCWNsYXNzIFkge1xuIik7CisJCWJ1Zi5hcHBlbmQo
IiAgICAJcHVibGljIFkoIEBBIFggdGhpcyAsIGludCBpICwgQEIgYm9vbGVhbiBiICwgQEEgaW50
IGogKSB7XG4iKTsKKwkJYnVmLmFwcGVuZCgiICAgIAl9XG4iKTsKKwkJYnVmLmFwcGVuZCgiICAg
IH1cbiIpOworCQlidWYuYXBwZW5kKCJ9XG4iKTsKKwkJSUNvbXBpbGF0aW9uVW5pdCBjdSA9IHBh
Y2sxLmNyZWF0ZUNvbXBpbGF0aW9uVW5pdCgiWC5qYXZhIiwgYnVmLnRvU3RyaW5nKCksIGZhbHNl
LCBudWxsKTsKKwkJQ29tcGlsYXRpb25Vbml0IGFzdFJvb3QgPSBjcmVhdGVBU1QoY3UpOworCQlB
U1RSZXdyaXRlIHJld3JpdGUgPSBBU1RSZXdyaXRlLmNyZWF0ZShhc3RSb290LmdldEFTVCgpKTsK
KwkJQVNUIGFzdCA9IGFzdFJvb3QuZ2V0QVNUKCk7CisJCVR5cGVEZWNsYXJhdGlvbiB0eXBlID0g
KFR5cGVEZWNsYXJhdGlvbikgZmluZFR5cGVEZWNsYXJhdGlvbihhc3RSb290LCAiWCIpLmJvZHlE
ZWNsYXJhdGlvbnMoKS5nZXQoMCk7CisJCU1ldGhvZERlY2xhcmF0aW9uIG1ldGhvZCA9ICAoTWV0
aG9kRGVjbGFyYXRpb24pIHR5cGUuYm9keURlY2xhcmF0aW9ucygpLmdldCgwKTsKKwkJTGlzdCBw
YXJhbXMgPSBtZXRob2QucGFyYW1ldGVycygpOworCisJCVNpbmdsZVZhcmlhYmxlRGVjbGFyYXRp
b24gZmlyc3QgPSAoU2luZ2xlVmFyaWFibGVEZWNsYXJhdGlvbikgcGFyYW1zLmdldCgwKTsKKwkJ
U2luZ2xlVmFyaWFibGVEZWNsYXJhdGlvbiBzZWNvbmQgPSAoU2luZ2xlVmFyaWFibGVEZWNsYXJh
dGlvbikgcGFyYW1zLmdldCgxKTsKKwkJU2luZ2xlVmFyaWFibGVEZWNsYXJhdGlvbiB0aGlyZCA9
IChTaW5nbGVWYXJpYWJsZURlY2xhcmF0aW9uKSBwYXJhbXMuZ2V0KDIpOworCQlyZXdyaXRlLnJl
cGxhY2UoZmlyc3QuZ2V0TmFtZSgpLCBhc3QubmV3U2ltcGxlTmFtZSgiaSIpLCBudWxsKTsKKwkJ
cmV3cml0ZS5yZXBsYWNlKHNlY29uZC5nZXROYW1lKCksIGFzdC5uZXdTaW1wbGVOYW1lKCJiIiks
IG51bGwpOworCisJCUFTVE5vZGUgY29weTEgPSByZXdyaXRlLmNyZWF0ZUNvcHlUYXJnZXQoZmly
c3QpOworCQlBU1ROb2RlIGNvcHkyID0gcmV3cml0ZS5jcmVhdGVDb3B5VGFyZ2V0KHNlY29uZCk7
CisKKwkJcmV3cml0ZS5yZXBsYWNlKGZpcnN0LCBjb3B5MiwgbnVsbCk7CisJCXJld3JpdGUucmVw
bGFjZShzZWNvbmQsIGNvcHkxLCBudWxsKTsKKwkJcmV3cml0ZS5yZW1vdmUodGhpcmQsIG51bGwp
OworCisJCVN0cmluZyBwcmV2aWV3ID0gZXZhbHVhdGVSZXdyaXRlKGN1LCByZXdyaXRlKTsKKwkJ
YnVmID0gbmV3IFN0cmluZ0J1ZmZlcigpOworCQlidWYuYXBwZW5kKCJwYWNrYWdlIHRlc3QxO1xu
Iik7CisJCWJ1Zi5hcHBlbmQoImNsYXNzIFgge1xuIik7CisJCWJ1Zi5hcHBlbmQoIgljbGFzcyBZ
IHtcbiIpOworCQlidWYuYXBwZW5kKCIgICAgCXB1YmxpYyBZKCBAQSBYIHRoaXMgLCBAQiBib29s
ZWFuIGIgLCBpbnQgaSApIHtcbiIpOworCQlidWYuYXBwZW5kKCIgICAgCX1cbiIpOworCQlidWYu
YXBwZW5kKCIgICAgfVxuIik7CisJCWJ1Zi5hcHBlbmQoIn1cbiIpOworCQlhc3NlcnRFcXVhbFN0
cmluZyhwcmV2aWV3LCBidWYudG9TdHJpbmcoKSk7CisJfQorCXB1YmxpYyB2b2lkIHRlc3RSZWNl
aXZlcjNfc2luY2VfOCgpIHRocm93cyBFeGNlcHRpb24geworCQlJUGFja2FnZUZyYWdtZW50IHBh
Y2sxID0gdGhpcy5zb3VyY2VGb2xkZXIuY3JlYXRlUGFja2FnZUZyYWdtZW50KCJ0ZXN0MSIsIGZh
bHNlLCBudWxsKTsKKwkJU3RyaW5nQnVmZmVyIGJ1ZiA9IG5ldyBTdHJpbmdCdWZmZXIoKTsKKwkJ
YnVmLmFwcGVuZCgicGFja2FnZSB0ZXN0MTtcbiIpOworCQlidWYuYXBwZW5kKCJjbGFzcyBYIHtc
biIpOworCQlidWYuYXBwZW5kKCIgICAgcHVibGljIHZvaWQgZm9vICggWCB0aGlzICkge31cbiIp
OworCQlidWYuYXBwZW5kKCIgICAgcHVibGljIHZvaWQgZm9vICggICkge31cbiIpOworCQlidWYu
YXBwZW5kKCIgICAgcHVibGljIHZvaWQgZm9vICggWCB0aGlzICwvKmNvbW1lbnQqLyBpbnQgaSAp
IHt9XG4iKTsKKwkJYnVmLmFwcGVuZCgiICAgIHB1YmxpYyB2b2lkIGZvbyAoIGludCBpICwgaW50
IGogKSB7fVxuIik7CisJCWJ1Zi5hcHBlbmQoIiAgICBwdWJsaWMgdm9pZCBmb28gKCBYIHRoaXMg
KSB7fVxuIik7CisJCWJ1Zi5hcHBlbmQoIiAgICBwdWJsaWMgdm9pZCBmb28gKCBYIHRoaXMgLCBm
bG9hdCBmMSAsIGZsb2F0IGYyICkge31cbiIpOworCQlidWYuYXBwZW5kKCIgICAgcHVibGljIHZv
aWQgZm9vICggWCB0aGlzICwgaW50IGkpIHt9XG4iKTsKKwkJYnVmLmFwcGVuZCgiICAgIHB1Ymxp
YyB2b2lkIGZvbyAoIFggdGhpcyAsIGZsb2F0IGYgKSB7fVxuIik7CisJCWJ1Zi5hcHBlbmQoIiAg
ICBwdWJsaWMgdm9pZCBmb28xIChYIHRoaXMgLCBmbG9hdCBmKSB7fVxuIik7CisJCWJ1Zi5hcHBl
bmQoIn1cbiIpOworCQlJQ29tcGlsYXRpb25Vbml0IGN1PSBwYWNrMS5jcmVhdGVDb21waWxhdGlv
blVuaXQoIlguamF2YSIsIGJ1Zi50b1N0cmluZygpLCBmYWxzZSwgbnVsbCk7CisJCUNvbXBpbGF0
aW9uVW5pdCBhc3RSb290ID0gY3JlYXRlQVNUKGN1KTsKKwkJQVNUIGFzdCA9IGFzdFJvb3QuZ2V0
QVNUKCk7CisJCUFTVFJld3JpdGUgcmV3cml0ZSA9IEFTVFJld3JpdGUuY3JlYXRlKGFzdFJvb3Qu
Z2V0QVNUKCkpOworCQlUeXBlRGVjbGFyYXRpb24gdHlwZSA9IGZpbmRUeXBlRGVjbGFyYXRpb24o
YXN0Um9vdCwgIlgiKTsKKwkJTWV0aG9kRGVjbGFyYXRpb24gbWV0aG9kMSA9IChNZXRob2REZWNs
YXJhdGlvbikgdHlwZS5ib2R5RGVjbGFyYXRpb25zKCkuZ2V0KDApOworCQlNZXRob2REZWNsYXJh
dGlvbiBtZXRob2QyID0gKE1ldGhvZERlY2xhcmF0aW9uKSB0eXBlLmJvZHlEZWNsYXJhdGlvbnMo
KS5nZXQoMSk7CisJCU1ldGhvZERlY2xhcmF0aW9uIG1ldGhvZDMgPSAoTWV0aG9kRGVjbGFyYXRp
b24pIHR5cGUuYm9keURlY2xhcmF0aW9ucygpLmdldCgyKTsKKwkJTWV0aG9kRGVjbGFyYXRpb24g
bWV0aG9kNCA9IChNZXRob2REZWNsYXJhdGlvbikgdHlwZS5ib2R5RGVjbGFyYXRpb25zKCkuZ2V0
KDMpOworCQlNZXRob2REZWNsYXJhdGlvbiBtZXRob2Q1ID0gKE1ldGhvZERlY2xhcmF0aW9uKSB0
eXBlLmJvZHlEZWNsYXJhdGlvbnMoKS5nZXQoNCk7CisJCU1ldGhvZERlY2xhcmF0aW9uIG1ldGhv
ZDYgPSAoTWV0aG9kRGVjbGFyYXRpb24pIHR5cGUuYm9keURlY2xhcmF0aW9ucygpLmdldCg1KTsK
KwkJTWV0aG9kRGVjbGFyYXRpb24gbWV0aG9kNyA9IChNZXRob2REZWNsYXJhdGlvbikgdHlwZS5i
b2R5RGVjbGFyYXRpb25zKCkuZ2V0KDYpOworCQlNZXRob2REZWNsYXJhdGlvbiBtZXRob2Q4ID0g
KE1ldGhvZERlY2xhcmF0aW9uKSB0eXBlLmJvZHlEZWNsYXJhdGlvbnMoKS5nZXQoNyk7CisJCU1l
dGhvZERlY2xhcmF0aW9uIG1ldGhvZDkgPSAoTWV0aG9kRGVjbGFyYXRpb24pIHR5cGUuYm9keURl
Y2xhcmF0aW9ucygpLmdldCg4KTsKKworCQlTaW1wbGVUeXBlIHJlY2VpdmVyMSA9IChTaW1wbGVU
eXBlKSBtZXRob2QxLmdldFJlY2VpdmVyVHlwZSgpOworCQlTaW1wbGVUeXBlIHJlY2VpdmVyMyA9
IChTaW1wbGVUeXBlKSBtZXRob2QzLmdldFJlY2VpdmVyVHlwZSgpOworCQlTaW1wbGVUeXBlIHJl
Y2VpdmVyNSA9IChTaW1wbGVUeXBlKSBtZXRob2Q1LmdldFJlY2VpdmVyVHlwZSgpOworCQlTaW1w
bGVUeXBlIHJlY2VpdmVyNiA9IChTaW1wbGVUeXBlKSBtZXRob2Q2LmdldFJlY2VpdmVyVHlwZSgp
OworCQlTaW1wbGVUeXBlIHJlY2VpdmVyOCA9IChTaW1wbGVUeXBlKSBtZXRob2Q4LmdldFJlY2Vp
dmVyVHlwZSgpOworCQlTaW1wbGVUeXBlIHJlY2VpdmVyOSA9IChTaW1wbGVUeXBlKSBtZXRob2Q5
LmdldFJlY2VpdmVyVHlwZSgpOworCisJCVNpbXBsZVR5cGUgcmVjZWl2ZXJDb3B5ID0gKFNpbXBs
ZVR5cGUpIHJld3JpdGUuY3JlYXRlQ29weVRhcmdldChyZWNlaXZlcjEpOworCQlyZXdyaXRlLnNl
dChtZXRob2QyLCBNZXRob2REZWNsYXJhdGlvbi5SRUNFSVZFUl9UWVBFX1BST1BFUlRZLCByZWNl
aXZlckNvcHksIG51bGwpOworCQlyZXdyaXRlLnJlbW92ZShyZWNlaXZlcjEsIG51bGwpOworCisJ
CXJlY2VpdmVyQ29weSA9IChTaW1wbGVUeXBlKSByZXdyaXRlLmNyZWF0ZUNvcHlUYXJnZXQocmVj
ZWl2ZXIzKTsKKwkJcmV3cml0ZS5zZXQobWV0aG9kNCwgTWV0aG9kRGVjbGFyYXRpb24uUkVDRUlW
RVJfVFlQRV9QUk9QRVJUWSwgcmVjZWl2ZXJDb3B5LCBudWxsKTsKKwkJcmV3cml0ZS5yZW1vdmUo
cmVjZWl2ZXIzLCBudWxsKTsKKworCQlMaXN0UmV3cml0ZSBsaXN0UmV3cml0ZSA9IHJld3JpdGUu
Z2V0TGlzdFJld3JpdGUobWV0aG9kMywgTWV0aG9kRGVjbGFyYXRpb24uTU9ESUZJRVJTMl9QUk9Q
RVJUWSk7CisJCWxpc3RSZXdyaXRlLmluc2VydExhc3QoYXN0Lm5ld01vZGlmaWVyKE1vZGlmaWVy
Lk1vZGlmaWVyS2V5d29yZC5GSU5BTF9LRVlXT1JEKSwgbnVsbCk7CisKKwkJcmVjZWl2ZXJDb3B5
ID0gYXN0Lm5ld1NpbXBsZVR5cGUoYXN0Lm5ld1NpbXBsZU5hbWUoIlhZIikpOworCQlyZXdyaXRl
LnJlcGxhY2UocmVjZWl2ZXI1LCByZWNlaXZlckNvcHksIG51bGwpOworCisJCXJlY2VpdmVyQ29w
eSA9IGFzdC5uZXdTaW1wbGVUeXBlKGFzdC5uZXdTaW1wbGVOYW1lKCJYWSIpKTsKKwkJcmV3cml0
ZS5yZXBsYWNlKHJlY2VpdmVyNiwgcmVjZWl2ZXJDb3B5LCBudWxsKTsKKwkJU2luZ2xlVmFyaWFi
bGVEZWNsYXJhdGlvbiBwYXJhbUNvcHkgPSAoU2luZ2xlVmFyaWFibGVEZWNsYXJhdGlvbikgcmV3
cml0ZS5jcmVhdGVDb3B5VGFyZ2V0KChTaW5nbGVWYXJpYWJsZURlY2xhcmF0aW9uKSBtZXRob2Q2
LnBhcmFtZXRlcnMoKS5nZXQoMCkpOworCQlyZXdyaXRlLnJlbW92ZSgoU2luZ2xlVmFyaWFibGVE
ZWNsYXJhdGlvbikgbWV0aG9kNi5wYXJhbWV0ZXJzKCkuZ2V0KDApLCBudWxsKTsKKworCQlsaXN0
UmV3cml0ZSA9IHJld3JpdGUuZ2V0TGlzdFJld3JpdGUobWV0aG9kNywgTWV0aG9kRGVjbGFyYXRp
b24uUEFSQU1FVEVSU19QUk9QRVJUWSk7CisJCWxpc3RSZXdyaXRlLmluc2VydExhc3QocGFyYW1D
b3B5LCBudWxsKTsKKworCQlyZXdyaXRlLnJlbW92ZShyZWNlaXZlcjgsIG51bGwpOworCQlyZXdy
aXRlLnJlbW92ZSgoU2luZ2xlVmFyaWFibGVEZWNsYXJhdGlvbikgbWV0aG9kOC5wYXJhbWV0ZXJz
KCkuZ2V0KDApLCBudWxsKTsKKwkJCisJCXJld3JpdGUucmVtb3ZlKHJlY2VpdmVyOSwgbnVsbCk7
CisJCXJld3JpdGUucmVtb3ZlKChTaW5nbGVWYXJpYWJsZURlY2xhcmF0aW9uKSBtZXRob2Q5LnBh
cmFtZXRlcnMoKS5nZXQoMCksIG51bGwpOworCisJCVN0cmluZyBwcmV2aWV3ID0gZXZhbHVhdGVS
ZXdyaXRlKGN1LCByZXdyaXRlKTsKKwkJYnVmID0gbmV3IFN0cmluZ0J1ZmZlcigpOworCQlidWYu
YXBwZW5kKCJwYWNrYWdlIHRlc3QxO1xuIik7CisJCWJ1Zi5hcHBlbmQoImNsYXNzIFgge1xuIik7
CisJCWJ1Zi5hcHBlbmQoIiAgICBwdWJsaWMgdm9pZCBmb28gKCkge31cbiIpOworCQlidWYuYXBw
ZW5kKCIgICAgcHVibGljIHZvaWQgZm9vIChYIHRoaXMgICkge31cbiIpOworCQlidWYuYXBwZW5k
KCIgICAgcHVibGljIGZpbmFsIHZvaWQgZm9vICgvKmNvbW1lbnQqLyBpbnQgaSApIHt9XG4iKTsK
KwkJYnVmLmFwcGVuZCgiICAgIHB1YmxpYyB2b2lkIGZvbyAoWCB0aGlzLCAgaW50IGkgLCBpbnQg
aiApIHt9XG4iKTsKKwkJYnVmLmFwcGVuZCgiICAgIHB1YmxpYyB2b2lkIGZvbyAoIFhZIHRoaXMg
KSB7fVxuIik7CisJCWJ1Zi5hcHBlbmQoIiAgICBwdWJsaWMgdm9pZCBmb28gKCBYWSB0aGlzICwg
ZmxvYXQgZjIgKSB7fVxuIik7CisJCWJ1Zi5hcHBlbmQoIiAgICBwdWJsaWMgdm9pZCBmb28gKCBY
IHRoaXMgLCBpbnQgaSwgZmxvYXQgZjEpIHt9XG4iKTsKKwkJYnVmLmFwcGVuZCgiICAgIHB1Ymxp
YyB2b2lkIGZvbyAoICkge31cbiIpOworCQlidWYuYXBwZW5kKCIgICAgcHVibGljIHZvaWQgZm9v
MSAoKSB7fVxuIik7CisJCWJ1Zi5hcHBlbmQoIn1cbiIpOworCQlhc3NlcnRFcXVhbFN0cmluZyhw
cmV2aWV3LCBidWYudG9TdHJpbmcoKSk7CisJfQorCXB1YmxpYyB2b2lkIHRlc3RSZWNlaXZlcjRf
c2luY2VfOCgpIHRocm93cyBFeGNlcHRpb24geworCQlJUGFja2FnZUZyYWdtZW50IHBhY2sxID0g
dGhpcy5zb3VyY2VGb2xkZXIuY3JlYXRlUGFja2FnZUZyYWdtZW50KCJ0ZXN0MSIsIGZhbHNlLCBu
dWxsKTsKKwkJU3RyaW5nQnVmZmVyIGJ1ZiA9IG5ldyBTdHJpbmdCdWZmZXIoKTsKKwkJYnVmLmFw
cGVuZCgicGFja2FnZSB0ZXN0MTtcbiIpOworCQlidWYuYXBwZW5kKCJjbGFzcyBYWVoge1xuIik7
CisJCWJ1Zi5hcHBlbmQoIgljbGFzcyBZIHtcbiIpOworCQlidWYuYXBwZW5kKCIgICAgCXB1Ymxp
YyBZICggQEEgWFlaIFhZWi50aGlzICwgQEIgaW50IGkgKSB7fVxuIik7CisJCWJ1Zi5hcHBlbmQo
IiAgICAJcHVibGljIFkgKCBAQSBYWVogWFlaLnRoaXMgLCBAQiBpbnQgaSAsIEBDIGludCBqICkg
e31cbiIpOworCQlidWYuYXBwZW5kKCIgICAgCXB1YmxpYyBZICggQEEgWFlaIFhZWi50aGlzICwg
QEIgZmxvYXQgZSApIHt9XG4iKTsKKwkJYnVmLmFwcGVuZCgiICAgIAlwdWJsaWMgWSggQEEgWFla
IFhZWi50aGlzICwgQEIgZmxvYXQgZSwgQEMgZmxvYXQgZiApIHt9XG4iKTsKKwkJYnVmLmFwcGVu
ZCgiICAgIAlwdWJsaWMgWSAoIEBBIFhZWiBYWVoudGhpcywgQEIgaW50IGkgLCBAQyBmbG9hdCBm
ICkge31cbiIpOworCQlidWYuYXBwZW5kKCIgICAgCXB1YmxpYyBZIChAQSBYWVogWFlaLnRoaXMg
LCBAQiBmbG9hdCBmLCBAQyBpbnQgaSkge31cbiIpOworCQlidWYuYXBwZW5kKCIgICAgCXB1Ymxp
YyBZICggQEEgWFlaIFhZWi50aGlzICwgQEIgYm9vbGVhbiBiMSkge31cbiIpOworCQlidWYuYXBw
ZW5kKCIgICAgCXB1YmxpYyBZIChAQSBYWVogWFlaLnRoaXMgLCBAQiBib29sZWFuIGIyICwgQEMg
aW50IGkgKSB7fVxuIik7CisJCWJ1Zi5hcHBlbmQoIiAgICAJcHVibGljIFkgKEBCIGJvb2xlYW4g
YiwgQEMgZmxvYXQgZikge31cbiIpOworCQlidWYuYXBwZW5kKCIgICAgCXB1YmxpYyBZIChAQiBi
b29sZWFuIGIgLCBAQyBib29sZWFuIGMpIHt9XG4iKTsKKwkJYnVmLmFwcGVuZCgiICAgIAlwdWJs
aWMgWSAoQEIgYm9vbGVhbiBiKSB7fVxuIik7CisJCWJ1Zi5hcHBlbmQoIiAgICAJcHVibGljIFkg
KCBAQSBYWVogWFlaLnRoaXMgLCBAQiBpbnQgaSAsIEBDIGludCBqLCBARCBpbnQgaykge31cbiIp
OworCQlidWYuYXBwZW5kKCIgICAgCXB1YmxpYyBZICggQEEgWFlaIFhZWi50aGlzKSB7fVxuIik7
CisJCWJ1Zi5hcHBlbmQoIiAgICB9XG4iKTsKKwkJYnVmLmFwcGVuZCgifVxuIik7CisJCUlDb21w
aWxhdGlvblVuaXQgY3UgPSBwYWNrMS5jcmVhdGVDb21waWxhdGlvblVuaXQoIlhZWi5qYXZhIiwg
YnVmLnRvU3RyaW5nKCksIGZhbHNlLCBudWxsKTsKKwkJQ29tcGlsYXRpb25Vbml0IGFzdFJvb3Qg
PSBjcmVhdGVBU1QoY3UpOworCQlBU1RSZXdyaXRlIHJld3JpdGUgPSBBU1RSZXdyaXRlLmNyZWF0
ZShhc3RSb290LmdldEFTVCgpKTsKKwkJQVNUIGFzdCA9IGFzdFJvb3QuZ2V0QVNUKCk7CisJCVR5
cGVEZWNsYXJhdGlvbiB0eXBlID0gKFR5cGVEZWNsYXJhdGlvbikgZmluZFR5cGVEZWNsYXJhdGlv
bihhc3RSb290LCAiWFlaIikuYm9keURlY2xhcmF0aW9ucygpLmdldCgwKTsKKwkJTWV0aG9kRGVj
bGFyYXRpb24gbWV0aG9kMSA9ICAoTWV0aG9kRGVjbGFyYXRpb24pIHR5cGUuYm9keURlY2xhcmF0
aW9ucygpLmdldCgwKTsgLy8gUmVtb3ZlIHRoZSByZWNlaXZlciB0eXBlIGFuZCBxdWFsaWZ5aW5n
IG5hbWUKKwkJTWV0aG9kRGVjbGFyYXRpb24gbWV0aG9kMiA9ICAoTWV0aG9kRGVjbGFyYXRpb24p
IHR5cGUuYm9keURlY2xhcmF0aW9ucygpLmdldCgxKTsgLy8gUmVtb3ZlIHRoZSByZWNlaXZlciBi
dXQgbm90IHRoZSBxdWFsaWZpZXIKKwkJTWV0aG9kRGVjbGFyYXRpb24gbWV0aG9kMyA9ICAoTWV0
aG9kRGVjbGFyYXRpb24pIHR5cGUuYm9keURlY2xhcmF0aW9ucygpLmdldCgyKTsgLy8gUmVtb3Zl
IHRoZSBxdWFsaWZpZXIgb25seSAKKwkJTWV0aG9kRGVjbGFyYXRpb24gbWV0aG9kNCA9ICAoTWV0
aG9kRGVjbGFyYXRpb24pIHR5cGUuYm9keURlY2xhcmF0aW9ucygpLmdldCgzKTsgLy8gUmVtb3Zl
IHRoZSBxdWFsaWZpZXIgYW5kIHJlY2VpdmVyIGFubm90YXRpb24KKwkJTWV0aG9kRGVjbGFyYXRp
b24gbWV0aG9kNSA9ICAoTWV0aG9kRGVjbGFyYXRpb24pIHR5cGUuYm9keURlY2xhcmF0aW9ucygp
LmdldCg0KTsgLy8gUmVtb3ZlIHRoZSByZWNlaXZlciB0eXBlIGFuZCBhbGwgcGFyYW1ldGVycwor
CQlNZXRob2REZWNsYXJhdGlvbiBtZXRob2Q2ID0gIChNZXRob2REZWNsYXJhdGlvbikgdHlwZS5i
b2R5RGVjbGFyYXRpb25zKCkuZ2V0KDUpOyAvLyBSZW1vdmUgdGhlIHJlY2VpdmVyIHR5cGUgYW5k
IGFkZCBhIHBhcmFtCisJCU1ldGhvZERlY2xhcmF0aW9uIG1ldGhvZDcgPSAgKE1ldGhvZERlY2xh
cmF0aW9uKSB0eXBlLmJvZHlEZWNsYXJhdGlvbnMoKS5nZXQoNik7IC8vIFJlbW92ZSB0aGUgcXVh
bGlmaWVyIGFuZCByZW1vdmUgYSBwYXJhbQorCQlNZXRob2REZWNsYXJhdGlvbiBtZXRob2Q4ID0g
IChNZXRob2REZWNsYXJhdGlvbikgdHlwZS5ib2R5RGVjbGFyYXRpb25zKCkuZ2V0KDcpOyAvLyBS
ZW1vdmUgdGhlIHF1YWxpZmllciBhbmQgcmVwbGFjZSBhIHBhcmFtCisJCU1ldGhvZERlY2xhcmF0
aW9uIG1ldGhvZDkgPSAgKE1ldGhvZERlY2xhcmF0aW9uKSB0eXBlLmJvZHlEZWNsYXJhdGlvbnMo
KS5nZXQoOCk7IC8vIEFkZCBhIHJlY2VpdmVyIHR5cGUgYW5kIHF1YWxpZmllciB3aXRoIGFubm90
YXRpb24KKwkJTWV0aG9kRGVjbGFyYXRpb24gbWV0aG9kMTAgPSAgKE1ldGhvZERlY2xhcmF0aW9u
KSB0eXBlLmJvZHlEZWNsYXJhdGlvbnMoKS5nZXQoOSk7IC8vIEFkZCBhIHJlY2VpdmVyIHR5cGUg
YW5kIHF1YWxpZmllciB3aXRoIGFubm90YXRpb25zIGFuZCBhZGQgb25lIHBhcmFtZXRlcgorCQlN
ZXRob2REZWNsYXJhdGlvbiBtZXRob2QxMSA9ICAoTWV0aG9kRGVjbGFyYXRpb24pIHR5cGUuYm9k
eURlY2xhcmF0aW9ucygpLmdldCgxMCk7IC8vIEFkZCBhIHJlY2VpdmVyIHR5cGUgd2l0aCBxdWFs
aWZpZXIgJiBhbm5vdGF0aW9ucyBhbmQgcmVtb3ZlIGFsbCBwYXJhbWV0ZXJzCisJCU1ldGhvZERl
Y2xhcmF0aW9uIG1ldGhvZDEyID0gIChNZXRob2REZWNsYXJhdGlvbikgdHlwZS5ib2R5RGVjbGFy
YXRpb25zKCkuZ2V0KDExKTsgLy8gS2VlcCB0aGUgcmVjZWl2ZXIgdHlwZSBhbmQgcXVhbGlmaWVy
LCBidXQgYWx0ZXIgcGFyYW1ldGVycworCQlNZXRob2REZWNsYXJhdGlvbiBtZXRob2QxMyA9ICAo
TWV0aG9kRGVjbGFyYXRpb24pIHR5cGUuYm9keURlY2xhcmF0aW9ucygpLmdldCgxMik7IC8vIEtl
ZXAgdGhlIHJlY2VpdmVyIHR5cGUgYW5kIHF1YWxpZmllciwgYnV0IGFsdGVyIHBhcmFtZXRlcnMK
KwkJCisJCXJld3JpdGUuc2V0KG1ldGhvZDEsIE1ldGhvZERlY2xhcmF0aW9uLlJFQ0VJVkVSX1RZ
UEVfUFJPUEVSVFksIG51bGwsIG51bGwpOworCQlyZXdyaXRlLnNldChtZXRob2QxLCBNZXRob2RE
ZWNsYXJhdGlvbi5SRUNFSVZFUl9RVUFMSUZJRVJfUFJPUEVSVFksIG51bGwsIG51bGwpOworCQly
ZXdyaXRlLnNldChtZXRob2QyLCBNZXRob2REZWNsYXJhdGlvbi5SRUNFSVZFUl9UWVBFX1BST1BF
UlRZLCBudWxsLCBudWxsKTsKKwkJcmV3cml0ZS5zZXQobWV0aG9kMywgTWV0aG9kRGVjbGFyYXRp
b24uUkVDRUlWRVJfUVVBTElGSUVSX1BST1BFUlRZLCBudWxsLCBudWxsKTsKKwkJCisJCXJld3Jp
dGUuc2V0KG1ldGhvZDQsIE1ldGhvZERlY2xhcmF0aW9uLlJFQ0VJVkVSX1FVQUxJRklFUl9QUk9Q
RVJUWSwgbnVsbCwgbnVsbCk7CisJCUxpc3RSZXdyaXRlIGxpc3RSZXdyaXRlID0gcmV3cml0ZS5n
ZXRMaXN0UmV3cml0ZShtZXRob2Q0LmdldFJlY2VpdmVyVHlwZSgpLCBTaW1wbGVUeXBlLkFOTk9U
QVRJT05TX1BST1BFUlRZKTsKKwkJbGlzdFJld3JpdGUucmVtb3ZlKChBU1ROb2RlKSBtZXRob2Q0
LmdldFJlY2VpdmVyVHlwZSgpLmFubm90YXRpb25zKCkuZ2V0KDApLCBudWxsKTsKKworCQlyZXdy
aXRlLnNldChtZXRob2Q1LCBNZXRob2REZWNsYXJhdGlvbi5SRUNFSVZFUl9UWVBFX1BST1BFUlRZ
LCBudWxsLCBudWxsKTsKKwkJTGlzdCBwYXJhbXMgPSBtZXRob2Q1LnBhcmFtZXRlcnMoKTsKKwkJ
U2luZ2xlVmFyaWFibGVEZWNsYXJhdGlvbiBmaXJzdCA9IChTaW5nbGVWYXJpYWJsZURlY2xhcmF0
aW9uKSBwYXJhbXMuZ2V0KDApOworCQlsaXN0UmV3cml0ZSA9IHJld3JpdGUuZ2V0TGlzdFJld3Jp
dGUobWV0aG9kNSwgTWV0aG9kRGVjbGFyYXRpb24uUEFSQU1FVEVSU19QUk9QRVJUWSk7CisJCWxp
c3RSZXdyaXRlLnJlbW92ZShmaXJzdCwgbnVsbCk7CisJCWZpcnN0ID0gKFNpbmdsZVZhcmlhYmxl
RGVjbGFyYXRpb24pIHBhcmFtcy5nZXQoMSk7CisJCWxpc3RSZXdyaXRlLnJlbW92ZShmaXJzdCwg
bnVsbCk7CisKKwkJcmV3cml0ZS5zZXQobWV0aG9kNiwgTWV0aG9kRGVjbGFyYXRpb24uUkVDRUlW
RVJfVFlQRV9QUk9QRVJUWSwgbnVsbCwgbnVsbCk7CisJCWxpc3RSZXdyaXRlID0gcmV3cml0ZS5n
ZXRMaXN0UmV3cml0ZShtZXRob2Q2LCBNZXRob2REZWNsYXJhdGlvbi5QQVJBTUVURVJTX1BST1BF
UlRZKTsKKwkJU2luZ2xlVmFyaWFibGVEZWNsYXJhdGlvbiBwYXJhbUNvcHkgPSBhc3QubmV3U2lu
Z2xlVmFyaWFibGVEZWNsYXJhdGlvbigpOworCQlTaW1wbGVUeXBlIHR5cGVDb3B5ID0gYXN0Lm5l
d1NpbXBsZVR5cGUoYXN0Lm5ld1NpbXBsZU5hbWUoIk9iamVjdCIpKTsKKwkJTWFya2VyQW5ub3Rh
dGlvbiBtYXJrZXJBbm5vdGF0aW9uPSBhc3QubmV3TWFya2VyQW5ub3RhdGlvbigpOworCQltYXJr
ZXJBbm5vdGF0aW9uLnNldFR5cGVOYW1lKGFzdC5uZXdTaW1wbGVOYW1lKCJBIikpOworCQl0eXBl
Q29weS5hbm5vdGF0aW9ucygpLmFkZChtYXJrZXJBbm5vdGF0aW9uKTsKKwkJcGFyYW1Db3B5LnNl
dFR5cGUodHlwZUNvcHkpOworCQlwYXJhbUNvcHkuc2V0TmFtZShhc3QubmV3U2ltcGxlTmFtZSgi
b2JqIikpOworCQlsaXN0UmV3cml0ZS5pbnNlcnRGaXJzdChwYXJhbUNvcHksIG51bGwpOworCQkK
KwkJcmV3cml0ZS5zZXQobWV0aG9kNywgTWV0aG9kRGVjbGFyYXRpb24uUkVDRUlWRVJfUVVBTElG
SUVSX1BST1BFUlRZLCBudWxsLCBudWxsKTsKKwkJcGFyYW1zID0gbWV0aG9kNy5wYXJhbWV0ZXJz
KCk7CisJCWZpcnN0ID0gKFNpbmdsZVZhcmlhYmxlRGVjbGFyYXRpb24pIHBhcmFtcy5nZXQoMCk7
CisJCWxpc3RSZXdyaXRlID0gcmV3cml0ZS5nZXRMaXN0UmV3cml0ZShtZXRob2Q3LCBNZXRob2RE
ZWNsYXJhdGlvbi5QQVJBTUVURVJTX1BST1BFUlRZKTsKKwkJbGlzdFJld3JpdGUucmVtb3ZlKGZp
cnN0LCBudWxsKTsKKwkJcGFyYW1zID0gbWV0aG9kOC5wYXJhbWV0ZXJzKCk7CisJCXJld3JpdGUu
c2V0KG1ldGhvZDgsIE1ldGhvZERlY2xhcmF0aW9uLlJFQ0VJVkVSX1FVQUxJRklFUl9QUk9QRVJU
WSwgbnVsbCwgbnVsbCk7CisJCWxpc3RSZXdyaXRlID0gcmV3cml0ZS5nZXRMaXN0UmV3cml0ZSht
ZXRob2Q4LCBNZXRob2REZWNsYXJhdGlvbi5QQVJBTUVURVJTX1BST1BFUlRZKTsKKwkJbGlzdFJl
d3JpdGUucmVtb3ZlKChTaW5nbGVWYXJpYWJsZURlY2xhcmF0aW9uKSBwYXJhbXMuZ2V0KDApLCBu
dWxsKTsKKwkJbGlzdFJld3JpdGUucmVtb3ZlKChTaW5nbGVWYXJpYWJsZURlY2xhcmF0aW9uKSBw
YXJhbXMuZ2V0KDEpLCBudWxsKTsKKwkJbGlzdFJld3JpdGUuaW5zZXJ0TGFzdChwYXJhbUNvcHks
IG51bGwpOworCisJCVNpbXBsZVR5cGUgcmVjZWl2ZXJUeXBlID0gYXN0Lm5ld1NpbXBsZVR5cGUo
YXN0Lm5ld1NpbXBsZU5hbWUoIlhZWiIpKTsKKwkJU2ltcGxlTmFtZSBxdWFsID0gYXN0Lm5ld1Np
bXBsZU5hbWUoIlhZWiIpOworCQltYXJrZXJBbm5vdGF0aW9uPSBhc3QubmV3TWFya2VyQW5ub3Rh
dGlvbigpOworCQltYXJrZXJBbm5vdGF0aW9uLnNldFR5cGVOYW1lKGFzdC5uZXdTaW1wbGVOYW1l
KCJBIikpOworCQlyZWNlaXZlclR5cGUuYW5ub3RhdGlvbnMoKS5hZGQobWFya2VyQW5ub3RhdGlv
bik7CisJCQorCQlyZXdyaXRlLnNldChtZXRob2Q5LCBNZXRob2REZWNsYXJhdGlvbi5SRUNFSVZF
Ul9UWVBFX1BST1BFUlRZLCByZWNlaXZlclR5cGUsIG51bGwpOworCQlyZXdyaXRlLnNldChtZXRo
b2Q5LCBNZXRob2REZWNsYXJhdGlvbi5SRUNFSVZFUl9RVUFMSUZJRVJfUFJPUEVSVFksIHF1YWws
IG51bGwpOworCisJCXJld3JpdGUuc2V0KG1ldGhvZDEwLCBNZXRob2REZWNsYXJhdGlvbi5SRUNF
SVZFUl9UWVBFX1BST1BFUlRZLCByZWNlaXZlclR5cGUsIG51bGwpOworCQlyZXdyaXRlLnNldCht
ZXRob2QxMCwgTWV0aG9kRGVjbGFyYXRpb24uUkVDRUlWRVJfUVVBTElGSUVSX1BST1BFUlRZLCBx
dWFsLCBudWxsKTsKKwkJbGlzdFJld3JpdGUgPSByZXdyaXRlLmdldExpc3RSZXdyaXRlKG1ldGhv
ZDEwLCBNZXRob2REZWNsYXJhdGlvbi5QQVJBTUVURVJTX1BST1BFUlRZKTsKKwkJbGlzdFJld3Jp
dGUuaW5zZXJ0Rmlyc3QocGFyYW1Db3B5LCBudWxsKTsKKwkJCisJCXJld3JpdGUuc2V0KG1ldGhv
ZDExLCBNZXRob2REZWNsYXJhdGlvbi5SRUNFSVZFUl9UWVBFX1BST1BFUlRZLCByZWNlaXZlclR5
cGUsIG51bGwpOworCQlyZXdyaXRlLnNldChtZXRob2QxMSwgTWV0aG9kRGVjbGFyYXRpb24uUkVD
RUlWRVJfUVVBTElGSUVSX1BST1BFUlRZLCBxdWFsLCBudWxsKTsKKwkJbGlzdFJld3JpdGUgPSBy
ZXdyaXRlLmdldExpc3RSZXdyaXRlKG1ldGhvZDExLCBNZXRob2REZWNsYXJhdGlvbi5QQVJBTUVU
RVJTX1BST1BFUlRZKTsKKwkJbGlzdFJld3JpdGUucmVtb3ZlKChBU1ROb2RlKSBtZXRob2QxMS5w
YXJhbWV0ZXJzKCkuZ2V0KDApLCBudWxsKTsKKwkJCisJCWxpc3RSZXdyaXRlID0gcmV3cml0ZS5n
ZXRMaXN0UmV3cml0ZShtZXRob2QxMiwgTWV0aG9kRGVjbGFyYXRpb24uUEFSQU1FVEVSU19QUk9Q
RVJUWSk7CisJCWxpc3RSZXdyaXRlLnJlbW92ZSgoQVNUTm9kZSkgbWV0aG9kMTIucGFyYW1ldGVy
cygpLmdldCgxKSwgbnVsbCk7CisKKwkJbGlzdFJld3JpdGUgPSByZXdyaXRlLmdldExpc3RSZXdy
aXRlKG1ldGhvZDEzLCBNZXRob2REZWNsYXJhdGlvbi5QQVJBTUVURVJTX1BST1BFUlRZKTsKKwkJ
bGlzdFJld3JpdGUuaW5zZXJ0Rmlyc3QocGFyYW1Db3B5LCBudWxsKTsKKwkJCisJCVN0cmluZyBw
cmV2aWV3ID0gZXZhbHVhdGVSZXdyaXRlKGN1LCByZXdyaXRlKTsKKwkJYnVmID0gbmV3IFN0cmlu
Z0J1ZmZlcigpOworCQlidWYuYXBwZW5kKCJwYWNrYWdlIHRlc3QxO1xuIik7CisJCWJ1Zi5hcHBl
bmQoImNsYXNzIFhZWiB7XG4iKTsKKwkJYnVmLmFwcGVuZCgiCWNsYXNzIFkge1xuIik7CisJCWJ1
Zi5hcHBlbmQoIiAgICAJcHVibGljIFkgKCBAQiBpbnQgaSApIHt9XG4iKTsKKwkJYnVmLmFwcGVu
ZCgiICAgIAlwdWJsaWMgWSAoIEBCIGludCBpICwgQEMgaW50IGogKSB7fVxuIik7CisJCWJ1Zi5h
cHBlbmQoIiAgICAJcHVibGljIFkgKCBAQSBYWVogdGhpcyAsIEBCIGZsb2F0IGUgKSB7fVxuIik7
CisJCWJ1Zi5hcHBlbmQoIiAgICAJcHVibGljIFkoIFhZWiB0aGlzICwgQEIgZmxvYXQgZSwgQEMg
ZmxvYXQgZiApIHt9XG4iKTsKKwkJYnVmLmFwcGVuZCgiICAgIAlwdWJsaWMgWSAoICkge31cbiIp
OworCQlidWYuYXBwZW5kKCIgICAgCXB1YmxpYyBZICggQEEgT2JqZWN0IG9iaiwgQEIgZmxvYXQg
ZiwgQEMgaW50IGkpIHt9XG4iKTsKKwkJYnVmLmFwcGVuZCgiICAgIAlwdWJsaWMgWSAoIEBBIFhZ
WiB0aGlzKSB7fVxuIik7CisJCWJ1Zi5hcHBlbmQoIiAgICAJcHVibGljIFkgKEBBIFhZWiB0aGlz
ICwgQEEgT2JqZWN0IG9iaiApIHt9XG4iKTsKKwkJYnVmLmFwcGVuZCgiICAgIAlwdWJsaWMgWSAo
QEEgWFlaIFhZWi50aGlzLCBAQiBib29sZWFuIGIsIEBDIGZsb2F0IGYpIHt9XG4iKTsKKwkJYnVm
LmFwcGVuZCgiICAgIAlwdWJsaWMgWSAoQEEgWFlaIFhZWi50aGlzLCBAQSBPYmplY3Qgb2JqLCBA
QiBib29sZWFuIGIgLCBAQyBib29sZWFuIGMpIHt9XG4iKTsKKwkJYnVmLmFwcGVuZCgiICAgIAlw
dWJsaWMgWSAoQEEgWFlaIFhZWi50aGlzKSB7fVxuIik7CisJCWJ1Zi5hcHBlbmQoIiAgICAJcHVi
bGljIFkgKCBAQSBYWVogWFlaLnRoaXMgLCBAQiBpbnQgaSAsIEBEIGludCBrKSB7fVxuIik7CisJ
CWJ1Zi5hcHBlbmQoIiAgICAJcHVibGljIFkgKCBAQSBYWVogWFlaLnRoaXMsIEBBIE9iamVjdCBv
YmopIHt9XG4iKTsKKwkJYnVmLmFwcGVuZCgiICAgIH1cbiIpOworCQlidWYuYXBwZW5kKCJ9XG4i
KTsKKwkJYXNzZXJ0RXF1YWxTdHJpbmcocHJldmlldywgYnVmLnRvU3RyaW5nKCkpOworCX0KKwog
fQpkaWZmIC0tZ2l0IGEvb3JnLmVjbGlwc2UuamR0LmNvcmUvZG9tL29yZy9lY2xpcHNlL2pkdC9p
bnRlcm5hbC9jb3JlL2RvbS9yZXdyaXRlL0FTVFJld3JpdGVBbmFseXplci5qYXZhIGIvb3JnLmVj
bGlwc2UuamR0LmNvcmUvZG9tL29yZy9lY2xpcHNlL2pkdC9pbnRlcm5hbC9jb3JlL2RvbS9yZXdy
aXRlL0FTVFJld3JpdGVBbmFseXplci5qYXZhCmluZGV4IDVjMzljOTkuLjAyNzk1M2QgMTAwNjQ0
Ci0tLSBhL29yZy5lY2xpcHNlLmpkdC5jb3JlL2RvbS9vcmcvZWNsaXBzZS9qZHQvaW50ZXJuYWwv
Y29yZS9kb20vcmV3cml0ZS9BU1RSZXdyaXRlQW5hbHl6ZXIuamF2YQorKysgYi9vcmcuZWNsaXBz
ZS5qZHQuY29yZS9kb20vb3JnL2VjbGlwc2UvamR0L2ludGVybmFsL2NvcmUvZG9tL3Jld3JpdGUv
QVNUUmV3cml0ZUFuYWx5emVyLmphdmEKQEAgLTE1MTcsNSArMTUxNyw1IEBACiAJCWJvb2xlYW4g
aXNBbGxSZW1vdmU9IGlzQWxsT2ZLaW5kKGNoaWxkcmVuLCBSZXdyaXRlRXZlbnQuUkVNT1ZFRCk7
CiAJCVN0cmluZyBrZXl3b3JkPSBVdGlsLkVNUFRZX1NUUklORzsKLQkJaWYgKHByb3BlcnR5ID09
IFNpbmdsZVZhcmlhYmxlRGVjbGFyYXRpb24uVkFSQVJHU19BTk5PVEFUSU9OU19QUk9QRVJUWSB8
fCBwcm9wZXJ0eSA9PSBBcnJheVR5cGUuQU5OT1RBVElPTlNfUFJPUEVSVFkpIHsKKwkJaWYgKHBy
b3BlcnR5ID09IFNpbmdsZVZhcmlhYmxlRGVjbGFyYXRpb24uVkFSQVJHU19BTk5PVEFUSU9OU19Q
Uk9QRVJUWSB8fCBub2RlIGluc3RhbmNlb2YgQW5ub3RhdGFibGVUeXBlKSB7CiAJCQlrZXl3b3Jk
PSAiICI7IC8vJE5PTi1OTFMtMSQKIAkJfSBlbHNlIGlmIChpc0FsbEluc2VydCB8fCBpc0FsbFJl
bW92ZSkgewpAQCAtMTUzMCw1ICsxNTMwLDUgQEAKIAkJUHJlZml4IGZvcm1hdHRlclByZWZpeDsK
IAkJaWYgKHByb3BlcnR5ID09IFNpbmdsZVZhcmlhYmxlRGVjbGFyYXRpb24uTU9ESUZJRVJTMl9Q
Uk9QRVJUWSB8fCBwcm9wZXJ0eSA9PSBTaW5nbGVWYXJpYWJsZURlY2xhcmF0aW9uLlZBUkFSR1Nf
QU5OT1RBVElPTlNfUFJPUEVSVFkgCi0JCQkJCQkJfHwgcHJvcGVydHkgPT0gQXJyYXlUeXBlLkFO
Tk9UQVRJT05TX1BST1BFUlRZKQorCQkJCQkJCXx8IG5vZGUgaW5zdGFuY2VvZiBBbm5vdGF0YWJs
ZVR5cGUpCiAJCQlmb3JtYXR0ZXJQcmVmaXg9IHRoaXMuZm9ybWF0dGVyLlBBUkFNX0FOTk9UQVRJ
T05fU0VQQVJBVElPTjsKIAkJZWxzZQpAQCAtMTU0Niw1ICsxNTQ2LDUgQEAKIAkJCQlyZXR1cm4g
bmV4dFBvczsKIAkJCX0gZWxzZSBpZiAoKGlzQWxsSW5zZXJ0IHx8IChuZXh0UG9zID09IGVuZFBv
cyAmJiBsYXN0VW5jaGFuZ2VkKSkgLy8gc2VlIGJ1ZyAxNjU2NTQKLQkJCQkJJiYgcHJvcGVydHkg
IT0gU2luZ2xlVmFyaWFibGVEZWNsYXJhdGlvbi5WQVJBUkdTX0FOTk9UQVRJT05TX1BST1BFUlRZ
ICYmIHByb3BlcnR5ICE9IEFycmF5VHlwZS5BTk5PVEFUSU9OU19QUk9QRVJUWSkgeworCQkJCQkm
JiBwcm9wZXJ0eSAhPSBTaW5nbGVWYXJpYWJsZURlY2xhcmF0aW9uLlZBUkFSR1NfQU5OT1RBVElP
TlNfUFJPUEVSVFkgJiYgIShub2RlIGluc3RhbmNlb2YgQW5ub3RhdGFibGVUeXBlKSkgewogCQkJ
CVN0cmluZyBzZXBhcmF0b3I7CiAJCQkJaWYgKGxhc3RDaGlsZC5nZXROZXdWYWx1ZSgpIGluc3Rh
bmNlb2YgQW5ub3RhdGlvbikgewpAQCAtMTgyMCw0ICsxODIwLDk3IEBACiAJCX0KIAl9CisJCisJ
cHJpdmF0ZSBpbnQgcmV3cml0ZU1ldGhvZFJlY2VpdmVyKE1ldGhvZERlY2xhcmF0aW9uIG1ldGhv
ZCwgaW50IG9mZnNldCkgdGhyb3dzIENvcmVFeGNlcHRpb24geworCQlvZmZzZXQ9IGdldFNjYW5u
ZXIoKS5nZXRUb2tlbkVuZE9mZnNldChUZXJtaW5hbFRva2Vucy5Ub2tlbk5hbWVMUEFSRU4sIG9m
ZnNldCk7IAorCQlpZiAobWV0aG9kLmdldEFTVCgpLmFwaUxldmVsKCkgPCBBU1QuSkxTOCkgewor
CQkJcmV0dXJuIG9mZnNldDsKKwkJfQorCQkKKwkJaW50IG5ld1BhcmFtQ291bnQgPSAoKExpc3Qp
IGdldE5ld1ZhbHVlKG1ldGhvZCwgTWV0aG9kRGVjbGFyYXRpb24uUEFSQU1FVEVSU19QUk9QRVJU
WSkpLnNpemUoKTsKKwkJaW50IG9sZFBhcmFtQ291bnQgPSBtZXRob2QucGFyYW1ldGVycygpLnNp
emUoKTsKKwkJUmV3cml0ZUV2ZW50IGV2ZW50ID0gZ2V0RXZlbnQobWV0aG9kLCBNZXRob2REZWNs
YXJhdGlvbi5SRUNFSVZFUl9UWVBFX1BST1BFUlRZKTsKKwkJUmV3cml0ZUV2ZW50IHF1YWxFdmVu
dCA9IGdldEV2ZW50KG1ldGhvZCwgTWV0aG9kRGVjbGFyYXRpb24uUkVDRUlWRVJfUVVBTElGSUVS
X1BST1BFUlRZKTsKKwkJCisJCWJvb2xlYW4gcmV3cml0ZVF1YWxpZmllciA9IGZhbHNlOworCQlB
U1ROb2RlIG5ld1F1YWwgPSBudWxsOworCQlBU1ROb2RlIG9sZFF1YWwgPSBudWxsOworCQlpZiAo
cXVhbEV2ZW50ICE9IG51bGwpIHsKKwkJCW5ld1F1YWwgPSAoQVNUTm9kZSkgcXVhbEV2ZW50Lmdl
dE5ld1ZhbHVlKCk7CisJCQlvbGRRdWFsID0gKEFTVE5vZGUpIHF1YWxFdmVudC5nZXRPcmlnaW5h
bFZhbHVlKCk7CisJCX0KKwkJCisJCVRleHRFZGl0R3JvdXAgZWRpdEdyb3VwPSBnZXRFZGl0R3Jv
dXAoZXZlbnQpOworCQlpZiAoZXZlbnQgIT0gbnVsbCAmJiBldmVudC5nZXRDaGFuZ2VLaW5kKCkg
IT0gUmV3cml0ZUV2ZW50LlVOQ0hBTkdFRCkgeworCQkJaW50IGNoYW5nZUtpbmQ9IGV2ZW50Lmdl
dENoYW5nZUtpbmQoKTsKKwkJCWlmIChjaGFuZ2VLaW5kID09IFJld3JpdGVFdmVudC5JTlNFUlRF
RCkgeworCQkJCSBkb1RleHRJbnNlcnQob2Zmc2V0LCAoQVNUTm9kZSkgZXZlbnQuZ2V0TmV3VmFs
dWUoKSwgMCwgZmFsc2UsIGVkaXRHcm91cCk7CisJCQkJZG9UZXh0SW5zZXJ0KG9mZnNldCwgIiAi
LCBlZGl0R3JvdXApOyAvLyROT04tTkxTLTEkCisJCQkJaWYgKG5ld1F1YWwgIT0gbnVsbCApIHsK
KwkJCQkJZG9UZXh0SW5zZXJ0KG9mZnNldCwgbmV3UXVhbCwgMCwgZmFsc2UsIGdldEVkaXRHcm91
cChxdWFsRXZlbnQpKTsKKwkJCQkJZG9UZXh0SW5zZXJ0KG9mZnNldCwgIi4iLCBlZGl0R3JvdXAp
OyAvLyROT04tTkxTLTEkCisJCQkJfQorCQkJCWRvVGV4dEluc2VydChvZmZzZXQsICJ0aGlzIiwg
ZWRpdEdyb3VwKTsgLy8kTk9OLU5MUy0xJAorCQkJCWlmIChuZXdQYXJhbUNvdW50ID4gMCkgewor
CQkJCQlkb1RleHRJbnNlcnQob2Zmc2V0LCAiLCAiLCBlZGl0R3JvdXApOyAvLyROT04tTkxTLTEk
CisJCQkJfQorCQkJfSBlbHNlIHsKKwkJCQlBU1ROb2RlIGVsZW09IChBU1ROb2RlKSBldmVudC5n
ZXRPcmlnaW5hbFZhbHVlKCk7CisJCQkJU291cmNlUmFuZ2UgcmFuZ2U9IGdldEV4dGVuZGVkUmFu
Z2UoZWxlbSk7CisJCQkJaW50IGVsZW1PZmZzZXQ9IHJhbmdlLmdldFN0YXJ0UG9zaXRpb24oKTsK
KwkJCQlpbnQgZWxlbUxlbmd0aD0gcmFuZ2UuZ2V0TGVuZ3RoKCk7CisJCQkJaW50IGVsZW1FbmQ9
IGVsZW1PZmZzZXQgKyBlbGVtTGVuZ3RoOworCQkJCWlmIChjaGFuZ2VLaW5kID09IFJld3JpdGVF
dmVudC5SRU1PVkVEKSB7CisJCQkJCWVkaXRHcm91cD0gZ2V0RWRpdEdyb3VwKGV2ZW50KTsKKwkJ
CQkJaW50IGVuZFBvczsKKwkJCQkJaWYgKG9sZFBhcmFtQ291bnQgPT0gMCkgeworCQkJCQkJZW5k
UG9zPSBnZXRTY2FubmVyKCkuZ2V0VG9rZW5TdGFydE9mZnNldChUZXJtaW5hbFRva2Vucy5Ub2tl
bk5hbWVSUEFSRU4sIGVsZW1FbmQpOworCQkJCQl9IGVsc2UgeworCQkJCQkJZW5kUG9zPSBnZXRT
Y2FubmVyKCkuZ2V0VG9rZW5FbmRPZmZzZXQoVGVybWluYWxUb2tlbnMuVG9rZW5OYW1lQ09NTUEs
IGVsZW1FbmQpOworCQkJCQl9CisJCQkJCWRvVGV4dFJlbW92ZUFuZFZpc2l0KG9mZnNldCwgZW5k
UG9zIC0gb2Zmc2V0LCBlbGVtLCBlZGl0R3JvdXApOworCQkJCQlyZXR1cm4gZW5kUG9zOworCQkJ
CX0gZWxzZSBpZiAoY2hhbmdlS2luZCA9PSBSZXdyaXRlRXZlbnQuUkVQTEFDRUQpIHsKKwkJCQkJ
ZWRpdEdyb3VwPSBnZXRFZGl0R3JvdXAoZXZlbnQpOworCQkJCQlkb1RleHRSZW1vdmVBbmRWaXNp
dChlbGVtT2Zmc2V0LCBlbGVtTGVuZ3RoLCBlbGVtLCBlZGl0R3JvdXApOworCQkJCQlkb1RleHRJ
bnNlcnQoZWxlbU9mZnNldCwgKEFTVE5vZGUpIGV2ZW50LmdldE5ld1ZhbHVlKCksIDAsIGZhbHNl
LCBlZGl0R3JvdXApOworCQkJCQlyZXdyaXRlUXVhbGlmaWVyID0gdHJ1ZTsKKwkJCQl9IGVsc2Ug
eworCQkJCQlyZXdyaXRlUmVxdWlyZWROb2RlKG1ldGhvZCwgTWV0aG9kRGVjbGFyYXRpb24uUkVD
RUlWRVJfVFlQRV9QUk9QRVJUWSk7CisJCQkJCXJld3JpdGVRdWFsaWZpZXIgPSB0cnVlOworCQkJ
CX0KKwkJCX0KKwkJfSBlbHNlIHsKKwkJCXJld3JpdGVSZXF1aXJlZE5vZGUobWV0aG9kLCBNZXRo
b2REZWNsYXJhdGlvbi5SRUNFSVZFUl9UWVBFX1BST1BFUlRZKTsKKwkJCWlmIChtZXRob2QuZ2V0
UmVjZWl2ZXJUeXBlKCkgIT0gbnVsbCkgeworCQkJCXJld3JpdGVRdWFsaWZpZXIgPSB0cnVlOwor
CQkJfQorCQl9CisJCWlmIChyZXdyaXRlUXVhbGlmaWVyKSB7CisJCQlpZiAocXVhbEV2ZW50ICE9
IG51bGwpIHsKKwkJCQlpbnQgcXVhbENoYW5nZUtpbmQgPSBxdWFsRXZlbnQuZ2V0Q2hhbmdlS2lu
ZCgpOworCQkJCVRleHRFZGl0R3JvdXAgcXVhbEdyb3VwID0gZ2V0RWRpdEdyb3VwKHF1YWxFdmVu
dCk7CisJCQkJaWYgKHF1YWxDaGFuZ2VLaW5kID09IFJld3JpdGVFdmVudC5JTlNFUlRFRCkgewor
CQkJCQlpbnQgcG9zPSBnZXRTY2FubmVyKCkuZ2V0VG9rZW5TdGFydE9mZnNldChUZXJtaW5hbFRv
a2Vucy5Ub2tlbk5hbWV0aGlzLCBvZmZzZXQpOworCQkJCQlkb1RleHRJbnNlcnQocG9zLCAoQVNU
Tm9kZSkgZXZlbnQuZ2V0TmV3VmFsdWUoKSwgMCwgZmFsc2UsIHF1YWxHcm91cCk7CisJCQkJCWRv
VGV4dEluc2VydChwb3MsICIuIiwgcXVhbEdyb3VwKTsgLy8kTk9OLU5MUy0xJAorCQkJCX0gZWxz
ZSBpZiAocXVhbENoYW5nZUtpbmQgPT0gUmV3cml0ZUV2ZW50LlJFTU9WRUQpIHsKKwkJCQkJaW50
IHF1YWxPZmZzZXQgPSBvbGRRdWFsLmdldFN0YXJ0UG9zaXRpb24oKTsKKwkJCQkJaW50IGVuZFBv
cz0gZ2V0U2Nhbm5lcigpLmdldFRva2VuRW5kT2Zmc2V0KFRlcm1pbmFsVG9rZW5zLlRva2VuTmFt
ZURPVCwgcXVhbE9mZnNldCk7CisJCQkJCWRvVGV4dFJlbW92ZShxdWFsT2Zmc2V0LCBlbmRQb3Mg
LSBxdWFsT2Zmc2V0LCBxdWFsR3JvdXApOworCQkJCX0gZWxzZSBpZiAocXVhbENoYW5nZUtpbmQg
PT0gUmV3cml0ZUV2ZW50LlJFUExBQ0VEKSB7CisJCQkJCVNvdXJjZVJhbmdlIHJhbmdlPSBnZXRF
eHRlbmRlZFJhbmdlKG9sZFF1YWwpOworCQkJCQlpbnQgZWxlbU9mZnNldD0gcmFuZ2UuZ2V0U3Rh
cnRQb3NpdGlvbigpOworCQkJCQlpbnQgZWxlbUxlbmd0aD0gcmFuZ2UuZ2V0TGVuZ3RoKCk7CisJ
CQkJCWRvVGV4dFJlbW92ZUFuZFZpc2l0KGVsZW1PZmZzZXQsIGVsZW1MZW5ndGgsIG9sZFF1YWws
IHF1YWxHcm91cCk7CisJCQkJCWRvVGV4dEluc2VydChlbGVtT2Zmc2V0LCBuZXdRdWFsLCAwLCBm
YWxzZSwgcXVhbEdyb3VwKTsKKwkJCQl9CisJCQl9CisJCQlvZmZzZXQ9ICBnZXRTY2FubmVyKCku
Z2V0VG9rZW5FbmRPZmZzZXQoVGVybWluYWxUb2tlbnMuVG9rZW5OYW1ldGhpcywgb2Zmc2V0KTsK
KwkJCWlmIChuZXdQYXJhbUNvdW50ID4gMCAmJiBvbGRQYXJhbUNvdW50ID09IDApIHsKKwkJCQlk
b1RleHRJbnNlcnQob2Zmc2V0LCAiLCAiLCBlZGl0R3JvdXApOyAvLyROT04tTkxTLTEkCisJCQl9
CisJCX0KKwkJcmV0dXJuIG9mZnNldDsKKwl9CiAKIAlwdWJsaWMgYm9vbGVhbiB2aXNpdChFeHRy
YURpbWVuc2lvbiBub2RlKSB7CkBAIC0xODU4LDYgKzE5NTEsNiBAQAogCQkvLyBwYXJhbWV0ZXJz
CiAJCXRyeSB7CisJCQlwb3M9IHJld3JpdGVNZXRob2RSZWNlaXZlcihub2RlLCBwb3MpOwogCQkJ
aWYgKGlzQ2hhbmdlZChub2RlLCBNZXRob2REZWNsYXJhdGlvbi5QQVJBTUVURVJTX1BST1BFUlRZ
KSkgewotCQkJCXBvcz0gZ2V0U2Nhbm5lcigpLmdldFRva2VuRW5kT2Zmc2V0KFRlcm1pbmFsVG9r
ZW5zLlRva2VuTmFtZUxQQVJFTiwgcG9zKTsKIAkJCQlwb3M9IHJld3JpdGVOb2RlTGlzdChub2Rl
LCBNZXRob2REZWNsYXJhdGlvbi5QQVJBTUVURVJTX1BST1BFUlRZLCBwb3MsIFV0aWwuRU1QVFlf
U1RSSU5HLCAiLCAiKTsgLy8kTk9OLU5MUy0xJCAKIAkJCX0gZWxzZSB7
</data>

          </attachment>
          <attachment
              isobsolete="0"
              ispatch="0"
              isprivate="0"
          >
            <attachid>228451</attachid>
            <date>2013-03-14 17:03:00 -0400</date>
            <delta_ts>2013-03-14 17:03:12 -0400</delta_ts>
            <desc>Updated patch</desc>
            <filename>Fix-for-bug-395612.patch</filename>
            <type>application/octet-stream</type>
            <size>25250</size>
            <attacher name="Jay Arthanareeswaran">jarthana</attacher>
            
              <data encoding="base64">ZGlmZiAtLWdpdCBhL29yZy5lY2xpcHNlLmpkdC5jb3JlLnRlc3RzLm1vZGVsL3NyYy9vcmcvZWNs
aXBzZS9qZHQvY29yZS90ZXN0cy9yZXdyaXRlL2Rlc2NyaWJpbmcvQVNUUmV3cml0aW5nTWV0aG9k
RGVjbFRlc3QuamF2YSBiL29yZy5lY2xpcHNlLmpkdC5jb3JlLnRlc3RzLm1vZGVsL3NyYy9vcmcv
ZWNsaXBzZS9qZHQvY29yZS90ZXN0cy9yZXdyaXRlL2Rlc2NyaWJpbmcvQVNUUmV3cml0aW5nTWV0
aG9kRGVjbFRlc3QuamF2YQppbmRleCA0MDUwNTkzLi5kY2Y4ZWM4IDEwMDY0NAotLS0gYS9vcmcu
ZWNsaXBzZS5qZHQuY29yZS50ZXN0cy5tb2RlbC9zcmMvb3JnL2VjbGlwc2UvamR0L2NvcmUvdGVz
dHMvcmV3cml0ZS9kZXNjcmliaW5nL0FTVFJld3JpdGluZ01ldGhvZERlY2xUZXN0LmphdmEKKysr
IGIvb3JnLmVjbGlwc2UuamR0LmNvcmUudGVzdHMubW9kZWwvc3JjL29yZy9lY2xpcHNlL2pkdC9j
b3JlL3Rlc3RzL3Jld3JpdGUvZGVzY3JpYmluZy9BU1RSZXdyaXRpbmdNZXRob2REZWNsVGVzdC5q
YXZhCkBAIC0zMjI2LDMgKzMyMjYsMzI4IEBACiAJCWFzc2VydEVxdWFsU3RyaW5nKHByZXZpZXcs
IGJ1Zi50b1N0cmluZygpKTsKIAl9CisJcHVibGljIHZvaWQgdGVzdFJlY2VpdmVyMV9zaW5jZV84
KCkgdGhyb3dzIEV4Y2VwdGlvbiB7CisJCUlQYWNrYWdlRnJhZ21lbnQgcGFjazEgPSB0aGlzLnNv
dXJjZUZvbGRlci5jcmVhdGVQYWNrYWdlRnJhZ21lbnQoInRlc3QxIiwgZmFsc2UsIG51bGwpOwor
CQlTdHJpbmdCdWZmZXIgYnVmID0gbmV3IFN0cmluZ0J1ZmZlcigpOworCQlidWYuYXBwZW5kKCJw
YWNrYWdlIHRlc3QxO1xuIik7CisJCWJ1Zi5hcHBlbmQoImNsYXNzIFgge1xuIik7CisJCWJ1Zi5h
cHBlbmQoIiAgICBwdWJsaWMgdm9pZCBmb28oIEBBIEBCIEBDIFggdGhpcywgaW50IGkgLCBpbnQg
aiApIHtcbiIpOworCQlidWYuYXBwZW5kKCIgICAgfVxuIik7CisJCWJ1Zi5hcHBlbmQoIn1cbiIp
OworCQlJQ29tcGlsYXRpb25Vbml0IGN1PSBwYWNrMS5jcmVhdGVDb21waWxhdGlvblVuaXQoIlgu
amF2YSIsIGJ1Zi50b1N0cmluZygpLCBmYWxzZSwgbnVsbCk7CisJCUNvbXBpbGF0aW9uVW5pdCBh
c3RSb290ID0gY3JlYXRlQVNUKGN1KTsKKwkJQVNUUmV3cml0ZSByZXdyaXRlID0gQVNUUmV3cml0
ZS5jcmVhdGUoYXN0Um9vdC5nZXRBU1QoKSk7CisJCUFTVCBhc3QgPSBhc3RSb290LmdldEFTVCgp
OworCQlNZXRob2REZWNsYXJhdGlvbiBtZXRob2QgPSAoTWV0aG9kRGVjbGFyYXRpb24pIGZpbmRU
eXBlRGVjbGFyYXRpb24oYXN0Um9vdCwgIlgiKS5ib2R5RGVjbGFyYXRpb25zKCkuZ2V0KDApOwor
CQlBbm5vdGF0YWJsZVR5cGUgcmVjZWl2ZXJUeXBlID0gbWV0aG9kLmdldFJlY2VpdmVyVHlwZSgp
OworCQlhc3NlcnRFcXVhbHMoIkludmFsaWQgcmVjZWl2ZXIgdHlwZSIsIEFTVE5vZGUuU0lNUExF
X1RZUEUsIHJlY2VpdmVyVHlwZS5nZXROb2RlVHlwZSgpKTsKKwkJTWFya2VyQW5ub3RhdGlvbiBh
bm5vdCA9IGFzdC5uZXdNYXJrZXJBbm5vdGF0aW9uKCk7CisJCWFubm90LnNldFR5cGVOYW1lKGFz
dC5uZXdTaW1wbGVOYW1lKCJNYXJrZXIiKSk7CisJCUxpc3RSZXdyaXRlIGxpc3RSZXdyaXRlID0g
cmV3cml0ZS5nZXRMaXN0UmV3cml0ZShyZWNlaXZlclR5cGUsIFNpbXBsZVR5cGUuQU5OT1RBVElP
TlNfUFJPUEVSVFkpOworCQlsaXN0UmV3cml0ZS5pbnNlcnRGaXJzdChhbm5vdCwgbnVsbCk7CisK
KwkJU3RyaW5nIHByZXZpZXcgPSBldmFsdWF0ZVJld3JpdGUoY3UsIHJld3JpdGUpOworCQlidWYg
PSBuZXcgU3RyaW5nQnVmZmVyKCk7CisJCWJ1Zi5hcHBlbmQoInBhY2thZ2UgdGVzdDE7XG4iKTsK
KwkJYnVmLmFwcGVuZCgiY2xhc3MgWCB7XG4iKTsKKwkJYnVmLmFwcGVuZCgiICAgIHB1YmxpYyB2
b2lkIGZvbyggQE1hcmtlciBAQSBAQiBAQyBYIHRoaXMsIGludCBpICwgaW50IGogKSB7XG4iKTsK
KwkJYnVmLmFwcGVuZCgiICAgIH1cbiIpOworCQlidWYuYXBwZW5kKCJ9XG4iKTsKKwkJYXNzZXJ0
RXF1YWxTdHJpbmcocHJldmlldywgYnVmLnRvU3RyaW5nKCkpOworCX0KKwlwdWJsaWMgdm9pZCB0
ZXN0UmVjZWl2ZXIyX3NpbmNlXzgoKSB0aHJvd3MgRXhjZXB0aW9uIHsKKwkJSVBhY2thZ2VGcmFn
bWVudCBwYWNrMSA9IHRoaXMuc291cmNlRm9sZGVyLmNyZWF0ZVBhY2thZ2VGcmFnbWVudCgidGVz
dDEiLCBmYWxzZSwgbnVsbCk7CisJCVN0cmluZ0J1ZmZlciBidWYgPSBuZXcgU3RyaW5nQnVmZmVy
KCk7CisJCWJ1Zi5hcHBlbmQoInBhY2thZ2UgdGVzdDE7XG4iKTsKKwkJYnVmLmFwcGVuZCgiY2xh
c3MgWCB7XG4iKTsKKwkJYnVmLmFwcGVuZCgiCWNsYXNzIFkge1xuIik7CisJCWJ1Zi5hcHBlbmQo
IiAgICAJcHVibGljIFkoIEBBIFggdGhpcyAsIGludCBpICwgQEIgYm9vbGVhbiBiICwgQEEgaW50
IGogKSB7XG4iKTsKKwkJYnVmLmFwcGVuZCgiICAgIAl9XG4iKTsKKwkJYnVmLmFwcGVuZCgiICAg
IH1cbiIpOworCQlidWYuYXBwZW5kKCJ9XG4iKTsKKwkJSUNvbXBpbGF0aW9uVW5pdCBjdSA9IHBh
Y2sxLmNyZWF0ZUNvbXBpbGF0aW9uVW5pdCgiWC5qYXZhIiwgYnVmLnRvU3RyaW5nKCksIGZhbHNl
LCBudWxsKTsKKwkJQ29tcGlsYXRpb25Vbml0IGFzdFJvb3QgPSBjcmVhdGVBU1QoY3UpOworCQlB
U1RSZXdyaXRlIHJld3JpdGUgPSBBU1RSZXdyaXRlLmNyZWF0ZShhc3RSb290LmdldEFTVCgpKTsK
KwkJQVNUIGFzdCA9IGFzdFJvb3QuZ2V0QVNUKCk7CisJCVR5cGVEZWNsYXJhdGlvbiB0eXBlID0g
KFR5cGVEZWNsYXJhdGlvbikgZmluZFR5cGVEZWNsYXJhdGlvbihhc3RSb290LCAiWCIpLmJvZHlE
ZWNsYXJhdGlvbnMoKS5nZXQoMCk7CisJCU1ldGhvZERlY2xhcmF0aW9uIG1ldGhvZCA9ICAoTWV0
aG9kRGVjbGFyYXRpb24pIHR5cGUuYm9keURlY2xhcmF0aW9ucygpLmdldCgwKTsKKwkJTGlzdCBw
YXJhbXMgPSBtZXRob2QucGFyYW1ldGVycygpOworCisJCVNpbmdsZVZhcmlhYmxlRGVjbGFyYXRp
b24gZmlyc3QgPSAoU2luZ2xlVmFyaWFibGVEZWNsYXJhdGlvbikgcGFyYW1zLmdldCgwKTsKKwkJ
U2luZ2xlVmFyaWFibGVEZWNsYXJhdGlvbiBzZWNvbmQgPSAoU2luZ2xlVmFyaWFibGVEZWNsYXJh
dGlvbikgcGFyYW1zLmdldCgxKTsKKwkJU2luZ2xlVmFyaWFibGVEZWNsYXJhdGlvbiB0aGlyZCA9
IChTaW5nbGVWYXJpYWJsZURlY2xhcmF0aW9uKSBwYXJhbXMuZ2V0KDIpOworCQlyZXdyaXRlLnJl
cGxhY2UoZmlyc3QuZ2V0TmFtZSgpLCBhc3QubmV3U2ltcGxlTmFtZSgiaSIpLCBudWxsKTsKKwkJ
cmV3cml0ZS5yZXBsYWNlKHNlY29uZC5nZXROYW1lKCksIGFzdC5uZXdTaW1wbGVOYW1lKCJiIiks
IG51bGwpOworCisJCUFTVE5vZGUgY29weTEgPSByZXdyaXRlLmNyZWF0ZUNvcHlUYXJnZXQoZmly
c3QpOworCQlBU1ROb2RlIGNvcHkyID0gcmV3cml0ZS5jcmVhdGVDb3B5VGFyZ2V0KHNlY29uZCk7
CisKKwkJcmV3cml0ZS5yZXBsYWNlKGZpcnN0LCBjb3B5MiwgbnVsbCk7CisJCXJld3JpdGUucmVw
bGFjZShzZWNvbmQsIGNvcHkxLCBudWxsKTsKKwkJcmV3cml0ZS5yZW1vdmUodGhpcmQsIG51bGwp
OworCisJCVN0cmluZyBwcmV2aWV3ID0gZXZhbHVhdGVSZXdyaXRlKGN1LCByZXdyaXRlKTsKKwkJ
YnVmID0gbmV3IFN0cmluZ0J1ZmZlcigpOworCQlidWYuYXBwZW5kKCJwYWNrYWdlIHRlc3QxO1xu
Iik7CisJCWJ1Zi5hcHBlbmQoImNsYXNzIFgge1xuIik7CisJCWJ1Zi5hcHBlbmQoIgljbGFzcyBZ
IHtcbiIpOworCQlidWYuYXBwZW5kKCIgICAgCXB1YmxpYyBZKCBAQSBYIHRoaXMgLCBAQiBib29s
ZWFuIGIgLCBpbnQgaSApIHtcbiIpOworCQlidWYuYXBwZW5kKCIgICAgCX1cbiIpOworCQlidWYu
YXBwZW5kKCIgICAgfVxuIik7CisJCWJ1Zi5hcHBlbmQoIn1cbiIpOworCQlhc3NlcnRFcXVhbFN0
cmluZyhwcmV2aWV3LCBidWYudG9TdHJpbmcoKSk7CisJfQorCXB1YmxpYyB2b2lkIHRlc3RSZWNl
aXZlcjNfc2luY2VfOCgpIHRocm93cyBFeGNlcHRpb24geworCQlJUGFja2FnZUZyYWdtZW50IHBh
Y2sxID0gdGhpcy5zb3VyY2VGb2xkZXIuY3JlYXRlUGFja2FnZUZyYWdtZW50KCJ0ZXN0MSIsIGZh
bHNlLCBudWxsKTsKKwkJU3RyaW5nQnVmZmVyIGJ1ZiA9IG5ldyBTdHJpbmdCdWZmZXIoKTsKKwkJ
YnVmLmFwcGVuZCgicGFja2FnZSB0ZXN0MTtcbiIpOworCQlidWYuYXBwZW5kKCJjbGFzcyBYIHtc
biIpOworCQlidWYuYXBwZW5kKCIgICAgcHVibGljIHZvaWQgZm9vICggWCB0aGlzICkge31cbiIp
OworCQlidWYuYXBwZW5kKCIgICAgcHVibGljIHZvaWQgZm9vICggICkge31cbiIpOworCQlidWYu
YXBwZW5kKCIgICAgcHVibGljIHZvaWQgZm9vICggWCB0aGlzICwvKmNvbW1lbnQqLyBpbnQgaSAp
IHt9XG4iKTsKKwkJYnVmLmFwcGVuZCgiICAgIHB1YmxpYyB2b2lkIGZvbyAoIGludCBpICwgaW50
IGogKSB7fVxuIik7CisJCWJ1Zi5hcHBlbmQoIiAgICBwdWJsaWMgdm9pZCBmb28gKCBYIHRoaXMg
KSB7fVxuIik7CisJCWJ1Zi5hcHBlbmQoIiAgICBwdWJsaWMgdm9pZCBmb28gKCBYIHRoaXMgLCBm
bG9hdCBmMSAsIGZsb2F0IGYyICkge31cbiIpOworCQlidWYuYXBwZW5kKCIgICAgcHVibGljIHZv
aWQgZm9vICggWCB0aGlzICwgaW50IGkpIHt9XG4iKTsKKwkJYnVmLmFwcGVuZCgiICAgIHB1Ymxp
YyB2b2lkIGZvbyAoIFggdGhpcyAsIGZsb2F0IGYgKSB7fVxuIik7CisJCWJ1Zi5hcHBlbmQoIiAg
ICBwdWJsaWMgdm9pZCBmb28xIChYIHRoaXMgLCBmbG9hdCBmKSB7fVxuIik7CisJCWJ1Zi5hcHBl
bmQoIn1cbiIpOworCQlJQ29tcGlsYXRpb25Vbml0IGN1PSBwYWNrMS5jcmVhdGVDb21waWxhdGlv
blVuaXQoIlguamF2YSIsIGJ1Zi50b1N0cmluZygpLCBmYWxzZSwgbnVsbCk7CisJCUNvbXBpbGF0
aW9uVW5pdCBhc3RSb290ID0gY3JlYXRlQVNUKGN1KTsKKwkJQVNUIGFzdCA9IGFzdFJvb3QuZ2V0
QVNUKCk7CisJCUFTVFJld3JpdGUgcmV3cml0ZSA9IEFTVFJld3JpdGUuY3JlYXRlKGFzdFJvb3Qu
Z2V0QVNUKCkpOworCQlUeXBlRGVjbGFyYXRpb24gdHlwZSA9IGZpbmRUeXBlRGVjbGFyYXRpb24o
YXN0Um9vdCwgIlgiKTsKKwkJTWV0aG9kRGVjbGFyYXRpb24gbWV0aG9kMSA9IChNZXRob2REZWNs
YXJhdGlvbikgdHlwZS5ib2R5RGVjbGFyYXRpb25zKCkuZ2V0KDApOworCQlNZXRob2REZWNsYXJh
dGlvbiBtZXRob2QyID0gKE1ldGhvZERlY2xhcmF0aW9uKSB0eXBlLmJvZHlEZWNsYXJhdGlvbnMo
KS5nZXQoMSk7CisJCU1ldGhvZERlY2xhcmF0aW9uIG1ldGhvZDMgPSAoTWV0aG9kRGVjbGFyYXRp
b24pIHR5cGUuYm9keURlY2xhcmF0aW9ucygpLmdldCgyKTsKKwkJTWV0aG9kRGVjbGFyYXRpb24g
bWV0aG9kNCA9IChNZXRob2REZWNsYXJhdGlvbikgdHlwZS5ib2R5RGVjbGFyYXRpb25zKCkuZ2V0
KDMpOworCQlNZXRob2REZWNsYXJhdGlvbiBtZXRob2Q1ID0gKE1ldGhvZERlY2xhcmF0aW9uKSB0
eXBlLmJvZHlEZWNsYXJhdGlvbnMoKS5nZXQoNCk7CisJCU1ldGhvZERlY2xhcmF0aW9uIG1ldGhv
ZDYgPSAoTWV0aG9kRGVjbGFyYXRpb24pIHR5cGUuYm9keURlY2xhcmF0aW9ucygpLmdldCg1KTsK
KwkJTWV0aG9kRGVjbGFyYXRpb24gbWV0aG9kNyA9IChNZXRob2REZWNsYXJhdGlvbikgdHlwZS5i
b2R5RGVjbGFyYXRpb25zKCkuZ2V0KDYpOworCQlNZXRob2REZWNsYXJhdGlvbiBtZXRob2Q4ID0g
KE1ldGhvZERlY2xhcmF0aW9uKSB0eXBlLmJvZHlEZWNsYXJhdGlvbnMoKS5nZXQoNyk7CisJCU1l
dGhvZERlY2xhcmF0aW9uIG1ldGhvZDkgPSAoTWV0aG9kRGVjbGFyYXRpb24pIHR5cGUuYm9keURl
Y2xhcmF0aW9ucygpLmdldCg4KTsKKworCQlTaW1wbGVUeXBlIHJlY2VpdmVyMSA9IChTaW1wbGVU
eXBlKSBtZXRob2QxLmdldFJlY2VpdmVyVHlwZSgpOworCQlTaW1wbGVUeXBlIHJlY2VpdmVyMyA9
IChTaW1wbGVUeXBlKSBtZXRob2QzLmdldFJlY2VpdmVyVHlwZSgpOworCQlTaW1wbGVUeXBlIHJl
Y2VpdmVyNSA9IChTaW1wbGVUeXBlKSBtZXRob2Q1LmdldFJlY2VpdmVyVHlwZSgpOworCQlTaW1w
bGVUeXBlIHJlY2VpdmVyNiA9IChTaW1wbGVUeXBlKSBtZXRob2Q2LmdldFJlY2VpdmVyVHlwZSgp
OworCQlTaW1wbGVUeXBlIHJlY2VpdmVyOCA9IChTaW1wbGVUeXBlKSBtZXRob2Q4LmdldFJlY2Vp
dmVyVHlwZSgpOworCQlTaW1wbGVUeXBlIHJlY2VpdmVyOSA9IChTaW1wbGVUeXBlKSBtZXRob2Q5
LmdldFJlY2VpdmVyVHlwZSgpOworCisJCVNpbXBsZVR5cGUgcmVjZWl2ZXJDb3B5ID0gKFNpbXBs
ZVR5cGUpIHJld3JpdGUuY3JlYXRlQ29weVRhcmdldChyZWNlaXZlcjEpOworCQlyZXdyaXRlLnNl
dChtZXRob2QyLCBNZXRob2REZWNsYXJhdGlvbi5SRUNFSVZFUl9UWVBFX1BST1BFUlRZLCByZWNl
aXZlckNvcHksIG51bGwpOworCQlyZXdyaXRlLnJlbW92ZShyZWNlaXZlcjEsIG51bGwpOworCisJ
CXJlY2VpdmVyQ29weSA9IChTaW1wbGVUeXBlKSByZXdyaXRlLmNyZWF0ZUNvcHlUYXJnZXQocmVj
ZWl2ZXIzKTsKKwkJcmV3cml0ZS5zZXQobWV0aG9kNCwgTWV0aG9kRGVjbGFyYXRpb24uUkVDRUlW
RVJfVFlQRV9QUk9QRVJUWSwgcmVjZWl2ZXJDb3B5LCBudWxsKTsKKwkJcmV3cml0ZS5yZW1vdmUo
cmVjZWl2ZXIzLCBudWxsKTsKKworCQlMaXN0UmV3cml0ZSBsaXN0UmV3cml0ZSA9IHJld3JpdGUu
Z2V0TGlzdFJld3JpdGUobWV0aG9kMywgTWV0aG9kRGVjbGFyYXRpb24uTU9ESUZJRVJTMl9QUk9Q
RVJUWSk7CisJCWxpc3RSZXdyaXRlLmluc2VydExhc3QoYXN0Lm5ld01vZGlmaWVyKE1vZGlmaWVy
Lk1vZGlmaWVyS2V5d29yZC5GSU5BTF9LRVlXT1JEKSwgbnVsbCk7CisKKwkJcmVjZWl2ZXJDb3B5
ID0gYXN0Lm5ld1NpbXBsZVR5cGUoYXN0Lm5ld1NpbXBsZU5hbWUoIlhZIikpOworCQlyZXdyaXRl
LnJlcGxhY2UocmVjZWl2ZXI1LCByZWNlaXZlckNvcHksIG51bGwpOworCisJCXJlY2VpdmVyQ29w
eSA9IGFzdC5uZXdTaW1wbGVUeXBlKGFzdC5uZXdTaW1wbGVOYW1lKCJYWSIpKTsKKwkJcmV3cml0
ZS5yZXBsYWNlKHJlY2VpdmVyNiwgcmVjZWl2ZXJDb3B5LCBudWxsKTsKKwkJU2luZ2xlVmFyaWFi
bGVEZWNsYXJhdGlvbiBwYXJhbUNvcHkgPSAoU2luZ2xlVmFyaWFibGVEZWNsYXJhdGlvbikgcmV3
cml0ZS5jcmVhdGVDb3B5VGFyZ2V0KChTaW5nbGVWYXJpYWJsZURlY2xhcmF0aW9uKSBtZXRob2Q2
LnBhcmFtZXRlcnMoKS5nZXQoMCkpOworCQlyZXdyaXRlLnJlbW92ZSgoU2luZ2xlVmFyaWFibGVE
ZWNsYXJhdGlvbikgbWV0aG9kNi5wYXJhbWV0ZXJzKCkuZ2V0KDApLCBudWxsKTsKKworCQlsaXN0
UmV3cml0ZSA9IHJld3JpdGUuZ2V0TGlzdFJld3JpdGUobWV0aG9kNywgTWV0aG9kRGVjbGFyYXRp
b24uUEFSQU1FVEVSU19QUk9QRVJUWSk7CisJCWxpc3RSZXdyaXRlLmluc2VydExhc3QocGFyYW1D
b3B5LCBudWxsKTsKKworCQlyZXdyaXRlLnJlbW92ZShyZWNlaXZlcjgsIG51bGwpOworCQlyZXdy
aXRlLnJlbW92ZSgoU2luZ2xlVmFyaWFibGVEZWNsYXJhdGlvbikgbWV0aG9kOC5wYXJhbWV0ZXJz
KCkuZ2V0KDApLCBudWxsKTsKKworCQlyZXdyaXRlLnJlbW92ZShyZWNlaXZlcjksIG51bGwpOwor
CQlyZXdyaXRlLnJlbW92ZSgoU2luZ2xlVmFyaWFibGVEZWNsYXJhdGlvbikgbWV0aG9kOS5wYXJh
bWV0ZXJzKCkuZ2V0KDApLCBudWxsKTsKKworCQlTdHJpbmcgcHJldmlldyA9IGV2YWx1YXRlUmV3
cml0ZShjdSwgcmV3cml0ZSk7CisJCWJ1ZiA9IG5ldyBTdHJpbmdCdWZmZXIoKTsKKwkJYnVmLmFw
cGVuZCgicGFja2FnZSB0ZXN0MTtcbiIpOworCQlidWYuYXBwZW5kKCJjbGFzcyBYIHtcbiIpOwor
CQlidWYuYXBwZW5kKCIgICAgcHVibGljIHZvaWQgZm9vICgpIHt9XG4iKTsKKwkJYnVmLmFwcGVu
ZCgiICAgIHB1YmxpYyB2b2lkIGZvbyAoWCB0aGlzICApIHt9XG4iKTsKKwkJYnVmLmFwcGVuZCgi
ICAgIHB1YmxpYyBmaW5hbCB2b2lkIGZvbyAoLypjb21tZW50Ki8gaW50IGkgKSB7fVxuIik7CisJ
CWJ1Zi5hcHBlbmQoIiAgICBwdWJsaWMgdm9pZCBmb28gKFggdGhpcywgIGludCBpICwgaW50IGog
KSB7fVxuIik7CisJCWJ1Zi5hcHBlbmQoIiAgICBwdWJsaWMgdm9pZCBmb28gKCBYWSB0aGlzICkg
e31cbiIpOworCQlidWYuYXBwZW5kKCIgICAgcHVibGljIHZvaWQgZm9vICggWFkgdGhpcyAsIGZs
b2F0IGYyICkge31cbiIpOworCQlidWYuYXBwZW5kKCIgICAgcHVibGljIHZvaWQgZm9vICggWCB0
aGlzICwgaW50IGksIGZsb2F0IGYxKSB7fVxuIik7CisJCWJ1Zi5hcHBlbmQoIiAgICBwdWJsaWMg
dm9pZCBmb28gKCApIHt9XG4iKTsKKwkJYnVmLmFwcGVuZCgiICAgIHB1YmxpYyB2b2lkIGZvbzEg
KCkge31cbiIpOworCQlidWYuYXBwZW5kKCJ9XG4iKTsKKwkJYXNzZXJ0RXF1YWxTdHJpbmcocHJl
dmlldywgYnVmLnRvU3RyaW5nKCkpOworCX0KKwlwdWJsaWMgdm9pZCBfdGVzdFJlY2VpdmVyNF9z
aW5jZV84KCkgdGhyb3dzIEV4Y2VwdGlvbiB7CisJCUlQYWNrYWdlRnJhZ21lbnQgcGFjazEgPSB0
aGlzLnNvdXJjZUZvbGRlci5jcmVhdGVQYWNrYWdlRnJhZ21lbnQoInRlc3QxIiwgZmFsc2UsIG51
bGwpOworCQlTdHJpbmdCdWZmZXIgYnVmID0gbmV3IFN0cmluZ0J1ZmZlcigpOworCQlidWYuYXBw
ZW5kKCJwYWNrYWdlIHRlc3QxO1xuIik7CisJCWJ1Zi5hcHBlbmQoImNsYXNzIFhZWiB7XG4iKTsK
KwkJYnVmLmFwcGVuZCgiCWNsYXNzIFkge1xuIik7CisJCWJ1Zi5hcHBlbmQoIiAgICAJcHVibGlj
IFkgKCBAQSBYWVogWFlaLnRoaXMgLCBAQiBpbnQgaSApIHt9XG4iKTsKKwkJYnVmLmFwcGVuZCgi
ICAgIAlwdWJsaWMgWSAoIEBBIFhZWiBYWVoudGhpcyAsIEBCIGludCBpICwgQEMgaW50IGogKSB7
fVxuIik7CisJCWJ1Zi5hcHBlbmQoIiAgICAJcHVibGljIFkgKCBAQSBYWVogWFlaLnRoaXMgLCBA
QiBmbG9hdCBlICkge31cbiIpOworCQlidWYuYXBwZW5kKCIgICAgCXB1YmxpYyBZKCBAQSBYWVog
WFlaLnRoaXMgLCBAQiBmbG9hdCBlLCBAQyBmbG9hdCBmICkge31cbiIpOworCQlidWYuYXBwZW5k
KCIgICAgCXB1YmxpYyBZICggQEEgWFlaIFhZWi50aGlzLCBAQiBpbnQgaSAsIEBDIGZsb2F0IGYg
KSB7fVxuIik7CisJCWJ1Zi5hcHBlbmQoIiAgICAJcHVibGljIFkgKEBBIFhZWiBYWVoudGhpcyAs
IEBCIGZsb2F0IGYsIEBDIGludCBpKSB7fVxuIik7CisJCWJ1Zi5hcHBlbmQoIiAgICAJcHVibGlj
IFkgKCBAQSBYWVogWFlaLnRoaXMgLCBAQiBib29sZWFuIGIxKSB7fVxuIik7CisJCWJ1Zi5hcHBl
bmQoIiAgICAJcHVibGljIFkgKEBBIFhZWiBYWVoudGhpcyAsIEBCIGJvb2xlYW4gYjIgLCBAQyBp
bnQgaSApIHt9XG4iKTsKKwkJYnVmLmFwcGVuZCgiICAgIAlwdWJsaWMgWSAoQEIgYm9vbGVhbiBi
LCBAQyBmbG9hdCBmKSB7fVxuIik7CisJCWJ1Zi5hcHBlbmQoIiAgICAJcHVibGljIFkgKEBCIGJv
b2xlYW4gYiAsIEBDIGJvb2xlYW4gYykge31cbiIpOworCQlidWYuYXBwZW5kKCIgICAgCXB1Ymxp
YyBZIChAQiBib29sZWFuIGIsIFN0cmluZyBzdHIpIHt9XG4iKTsKKwkJYnVmLmFwcGVuZCgiICAg
IAlwdWJsaWMgWSAoIEBBIFhZWiBYWVoudGhpcyAsIEBCIGludCBpICwgQEMgaW50IGosIEBEIGlu
dCBrKSB7fVxuIik7CisJCWJ1Zi5hcHBlbmQoIiAgICAJcHVibGljIFkgKCBAQSBYWVogWFlaLnRo
aXMpIHt9XG4iKTsKKwkJYnVmLmFwcGVuZCgiICAgIH1cbiIpOworCQlidWYuYXBwZW5kKCJ9XG4i
KTsKKwkJSUNvbXBpbGF0aW9uVW5pdCBjdSA9IHBhY2sxLmNyZWF0ZUNvbXBpbGF0aW9uVW5pdCgi
WFlaLmphdmEiLCBidWYudG9TdHJpbmcoKSwgZmFsc2UsIG51bGwpOworCQlDb21waWxhdGlvblVu
aXQgYXN0Um9vdCA9IGNyZWF0ZUFTVChjdSk7CisJCUFTVFJld3JpdGUgcmV3cml0ZSA9IEFTVFJl
d3JpdGUuY3JlYXRlKGFzdFJvb3QuZ2V0QVNUKCkpOworCQlBU1QgYXN0ID0gYXN0Um9vdC5nZXRB
U1QoKTsKKwkJVHlwZURlY2xhcmF0aW9uIHR5cGUgPSAoVHlwZURlY2xhcmF0aW9uKSBmaW5kVHlw
ZURlY2xhcmF0aW9uKGFzdFJvb3QsICJYWVoiKS5ib2R5RGVjbGFyYXRpb25zKCkuZ2V0KDApOwor
CQlNZXRob2REZWNsYXJhdGlvbiBtZXRob2QxID0gIChNZXRob2REZWNsYXJhdGlvbikgdHlwZS5i
b2R5RGVjbGFyYXRpb25zKCkuZ2V0KDApOyAvLyBSZW1vdmUgdGhlIHJlY2VpdmVyIHR5cGUgYW5k
IHF1YWxpZnlpbmcgbmFtZQorCQlNZXRob2REZWNsYXJhdGlvbiBtZXRob2QyID0gIChNZXRob2RE
ZWNsYXJhdGlvbikgdHlwZS5ib2R5RGVjbGFyYXRpb25zKCkuZ2V0KDEpOyAvLyBSZW1vdmUgdGhl
IHJlY2VpdmVyIGJ1dCBub3QgdGhlIHF1YWxpZmllcgorCQlNZXRob2REZWNsYXJhdGlvbiBtZXRo
b2QzID0gIChNZXRob2REZWNsYXJhdGlvbikgdHlwZS5ib2R5RGVjbGFyYXRpb25zKCkuZ2V0KDIp
OyAvLyBSZW1vdmUgdGhlIHF1YWxpZmllciBvbmx5IAorCQlNZXRob2REZWNsYXJhdGlvbiBtZXRo
b2Q0ID0gIChNZXRob2REZWNsYXJhdGlvbikgdHlwZS5ib2R5RGVjbGFyYXRpb25zKCkuZ2V0KDMp
OyAvLyBSZW1vdmUgdGhlIHF1YWxpZmllciBhbmQgcmVjZWl2ZXIgYW5ub3RhdGlvbgorCQlNZXRo
b2REZWNsYXJhdGlvbiBtZXRob2Q1ID0gIChNZXRob2REZWNsYXJhdGlvbikgdHlwZS5ib2R5RGVj
bGFyYXRpb25zKCkuZ2V0KDQpOyAvLyBSZW1vdmUgdGhlIHJlY2VpdmVyIHR5cGUgYW5kIGFsbCBw
YXJhbWV0ZXJzCisJCU1ldGhvZERlY2xhcmF0aW9uIG1ldGhvZDYgPSAgKE1ldGhvZERlY2xhcmF0
aW9uKSB0eXBlLmJvZHlEZWNsYXJhdGlvbnMoKS5nZXQoNSk7IC8vIFJlbW92ZSB0aGUgcmVjZWl2
ZXIgdHlwZSBhbmQgYWRkIGEgcGFyYW0KKwkJTWV0aG9kRGVjbGFyYXRpb24gbWV0aG9kNyA9ICAo
TWV0aG9kRGVjbGFyYXRpb24pIHR5cGUuYm9keURlY2xhcmF0aW9ucygpLmdldCg2KTsgLy8gUmVt
b3ZlIHRoZSBxdWFsaWZpZXIgYW5kIHJlbW92ZSBhIHBhcmFtCisJCU1ldGhvZERlY2xhcmF0aW9u
IG1ldGhvZDggPSAgKE1ldGhvZERlY2xhcmF0aW9uKSB0eXBlLmJvZHlEZWNsYXJhdGlvbnMoKS5n
ZXQoNyk7IC8vIFJlbW92ZSB0aGUgcXVhbGlmaWVyIGFuZCByZXBsYWNlIGEgcGFyYW0KKwkJTWV0
aG9kRGVjbGFyYXRpb24gbWV0aG9kOSA9ICAoTWV0aG9kRGVjbGFyYXRpb24pIHR5cGUuYm9keURl
Y2xhcmF0aW9ucygpLmdldCg4KTsgLy8gQWRkIGEgcmVjZWl2ZXIgdHlwZSBhbmQgcXVhbGlmaWVy
IHdpdGggYW5ub3RhdGlvbgorCQlNZXRob2REZWNsYXJhdGlvbiBtZXRob2QxMCA9ICAoTWV0aG9k
RGVjbGFyYXRpb24pIHR5cGUuYm9keURlY2xhcmF0aW9ucygpLmdldCg5KTsgLy8gQWRkIGEgcmVj
ZWl2ZXIgdHlwZSBhbmQgcXVhbGlmaWVyIHdpdGggYW5ub3RhdGlvbnMgYW5kIGFkZCBvbmUgcGFy
YW1ldGVyCisJCU1ldGhvZERlY2xhcmF0aW9uIG1ldGhvZDExID0gIChNZXRob2REZWNsYXJhdGlv
bikgdHlwZS5ib2R5RGVjbGFyYXRpb25zKCkuZ2V0KDEwKTsgLy8gQWRkIGEgcmVjZWl2ZXIgdHlw
ZSB3aXRoIHF1YWxpZmllciAmIGFubm90YXRpb25zIGFuZCByZW1vdmUgYWxsIHBhcmFtZXRlcnMK
KwkJTWV0aG9kRGVjbGFyYXRpb24gbWV0aG9kMTIgPSAgKE1ldGhvZERlY2xhcmF0aW9uKSB0eXBl
LmJvZHlEZWNsYXJhdGlvbnMoKS5nZXQoMTEpOyAvLyBLZWVwIHRoZSByZWNlaXZlciB0eXBlIGFu
ZCBxdWFsaWZpZXIsIGJ1dCBhbHRlciBwYXJhbWV0ZXJzCisJCU1ldGhvZERlY2xhcmF0aW9uIG1l
dGhvZDEzID0gIChNZXRob2REZWNsYXJhdGlvbikgdHlwZS5ib2R5RGVjbGFyYXRpb25zKCkuZ2V0
KDEyKTsgLy8gS2VlcCB0aGUgcmVjZWl2ZXIgdHlwZSBhbmQgcXVhbGlmaWVyLCBidXQgYWx0ZXIg
cGFyYW1ldGVycworCisJCXJld3JpdGUuc2V0KG1ldGhvZDEsIE1ldGhvZERlY2xhcmF0aW9uLlJF
Q0VJVkVSX1RZUEVfUFJPUEVSVFksIG51bGwsIG51bGwpOworCQlyZXdyaXRlLnNldChtZXRob2Qx
LCBNZXRob2REZWNsYXJhdGlvbi5SRUNFSVZFUl9RVUFMSUZJRVJfUFJPUEVSVFksIG51bGwsIG51
bGwpOworCQlyZXdyaXRlLnNldChtZXRob2QyLCBNZXRob2REZWNsYXJhdGlvbi5SRUNFSVZFUl9U
WVBFX1BST1BFUlRZLCBudWxsLCBudWxsKTsKKwkJcmV3cml0ZS5zZXQobWV0aG9kMywgTWV0aG9k
RGVjbGFyYXRpb24uUkVDRUlWRVJfUVVBTElGSUVSX1BST1BFUlRZLCBudWxsLCBudWxsKTsKKwor
CQlyZXdyaXRlLnNldChtZXRob2Q0LCBNZXRob2REZWNsYXJhdGlvbi5SRUNFSVZFUl9RVUFMSUZJ
RVJfUFJPUEVSVFksIG51bGwsIG51bGwpOworCQlMaXN0UmV3cml0ZSBsaXN0UmV3cml0ZSA9IHJl
d3JpdGUuZ2V0TGlzdFJld3JpdGUobWV0aG9kNC5nZXRSZWNlaXZlclR5cGUoKSwgU2ltcGxlVHlw
ZS5BTk5PVEFUSU9OU19QUk9QRVJUWSk7CisJCWxpc3RSZXdyaXRlLnJlbW92ZSgoQVNUTm9kZSkg
bWV0aG9kNC5nZXRSZWNlaXZlclR5cGUoKS5hbm5vdGF0aW9ucygpLmdldCgwKSwgbnVsbCk7CisK
KwkJcmV3cml0ZS5zZXQobWV0aG9kNSwgTWV0aG9kRGVjbGFyYXRpb24uUkVDRUlWRVJfVFlQRV9Q
Uk9QRVJUWSwgbnVsbCwgbnVsbCk7CisJCUxpc3QgcGFyYW1zID0gbWV0aG9kNS5wYXJhbWV0ZXJz
KCk7CisJCVNpbmdsZVZhcmlhYmxlRGVjbGFyYXRpb24gZmlyc3QgPSAoU2luZ2xlVmFyaWFibGVE
ZWNsYXJhdGlvbikgcGFyYW1zLmdldCgwKTsKKwkJbGlzdFJld3JpdGUgPSByZXdyaXRlLmdldExp
c3RSZXdyaXRlKG1ldGhvZDUsIE1ldGhvZERlY2xhcmF0aW9uLlBBUkFNRVRFUlNfUFJPUEVSVFkp
OworCQlsaXN0UmV3cml0ZS5yZW1vdmUoZmlyc3QsIG51bGwpOworCQlmaXJzdCA9IChTaW5nbGVW
YXJpYWJsZURlY2xhcmF0aW9uKSBwYXJhbXMuZ2V0KDEpOworCQlsaXN0UmV3cml0ZS5yZW1vdmUo
Zmlyc3QsIG51bGwpOworCisJCXJld3JpdGUuc2V0KG1ldGhvZDYsIE1ldGhvZERlY2xhcmF0aW9u
LlJFQ0VJVkVSX1RZUEVfUFJPUEVSVFksIG51bGwsIG51bGwpOworCQlsaXN0UmV3cml0ZSA9IHJl
d3JpdGUuZ2V0TGlzdFJld3JpdGUobWV0aG9kNiwgTWV0aG9kRGVjbGFyYXRpb24uUEFSQU1FVEVS
U19QUk9QRVJUWSk7CisJCVNpbmdsZVZhcmlhYmxlRGVjbGFyYXRpb24gcGFyYW1Db3B5ID0gYXN0
Lm5ld1NpbmdsZVZhcmlhYmxlRGVjbGFyYXRpb24oKTsKKwkJU2ltcGxlVHlwZSB0eXBlQ29weSA9
IGFzdC5uZXdTaW1wbGVUeXBlKGFzdC5uZXdTaW1wbGVOYW1lKCJPYmplY3QiKSk7CisJCU1hcmtl
ckFubm90YXRpb24gbWFya2VyQW5ub3RhdGlvbj0gYXN0Lm5ld01hcmtlckFubm90YXRpb24oKTsK
KwkJbWFya2VyQW5ub3RhdGlvbi5zZXRUeXBlTmFtZShhc3QubmV3U2ltcGxlTmFtZSgiQSIpKTsK
KwkJdHlwZUNvcHkuYW5ub3RhdGlvbnMoKS5hZGQobWFya2VyQW5ub3RhdGlvbik7CisJCXBhcmFt
Q29weS5zZXRUeXBlKHR5cGVDb3B5KTsKKwkJcGFyYW1Db3B5LnNldE5hbWUoYXN0Lm5ld1NpbXBs
ZU5hbWUoIm9iaiIpKTsKKwkJbGlzdFJld3JpdGUuaW5zZXJ0Rmlyc3QocGFyYW1Db3B5LCBudWxs
KTsKKworCQlyZXdyaXRlLnNldChtZXRob2Q3LCBNZXRob2REZWNsYXJhdGlvbi5SRUNFSVZFUl9R
VUFMSUZJRVJfUFJPUEVSVFksIG51bGwsIG51bGwpOworCQlwYXJhbXMgPSBtZXRob2Q3LnBhcmFt
ZXRlcnMoKTsKKwkJZmlyc3QgPSAoU2luZ2xlVmFyaWFibGVEZWNsYXJhdGlvbikgcGFyYW1zLmdl
dCgwKTsKKwkJbGlzdFJld3JpdGUgPSByZXdyaXRlLmdldExpc3RSZXdyaXRlKG1ldGhvZDcsIE1l
dGhvZERlY2xhcmF0aW9uLlBBUkFNRVRFUlNfUFJPUEVSVFkpOworCQlsaXN0UmV3cml0ZS5yZW1v
dmUoZmlyc3QsIG51bGwpOworCQlwYXJhbXMgPSBtZXRob2Q4LnBhcmFtZXRlcnMoKTsKKwkJcmV3
cml0ZS5zZXQobWV0aG9kOCwgTWV0aG9kRGVjbGFyYXRpb24uUkVDRUlWRVJfUVVBTElGSUVSX1BS
T1BFUlRZLCBudWxsLCBudWxsKTsKKwkJbGlzdFJld3JpdGUgPSByZXdyaXRlLmdldExpc3RSZXdy
aXRlKG1ldGhvZDgsIE1ldGhvZERlY2xhcmF0aW9uLlBBUkFNRVRFUlNfUFJPUEVSVFkpOworCQls
aXN0UmV3cml0ZS5yZW1vdmUoKFNpbmdsZVZhcmlhYmxlRGVjbGFyYXRpb24pIHBhcmFtcy5nZXQo
MCksIG51bGwpOworCQlsaXN0UmV3cml0ZS5yZW1vdmUoKFNpbmdsZVZhcmlhYmxlRGVjbGFyYXRp
b24pIHBhcmFtcy5nZXQoMSksIG51bGwpOworCQlsaXN0UmV3cml0ZS5pbnNlcnRMYXN0KHBhcmFt
Q29weSwgbnVsbCk7CisKKwkJU2ltcGxlVHlwZSByZWNlaXZlclR5cGUgPSBhc3QubmV3U2ltcGxl
VHlwZShhc3QubmV3U2ltcGxlTmFtZSgiWFlaIikpOworCQlTaW1wbGVOYW1lIHF1YWwgPSBhc3Qu
bmV3U2ltcGxlTmFtZSgiWFlaIik7CisJCW1hcmtlckFubm90YXRpb249IGFzdC5uZXdNYXJrZXJB
bm5vdGF0aW9uKCk7CisJCW1hcmtlckFubm90YXRpb24uc2V0VHlwZU5hbWUoYXN0Lm5ld1NpbXBs
ZU5hbWUoIkEiKSk7CisJCXJlY2VpdmVyVHlwZS5hbm5vdGF0aW9ucygpLmFkZChtYXJrZXJBbm5v
dGF0aW9uKTsKKworCQlyZXdyaXRlLnNldChtZXRob2Q5LCBNZXRob2REZWNsYXJhdGlvbi5SRUNF
SVZFUl9UWVBFX1BST1BFUlRZLCByZWNlaXZlclR5cGUsIG51bGwpOworCQlyZXdyaXRlLnNldCht
ZXRob2Q5LCBNZXRob2REZWNsYXJhdGlvbi5SRUNFSVZFUl9RVUFMSUZJRVJfUFJPUEVSVFksIHF1
YWwsIG51bGwpOworCisJCXJld3JpdGUuc2V0KG1ldGhvZDEwLCBNZXRob2REZWNsYXJhdGlvbi5S
RUNFSVZFUl9UWVBFX1BST1BFUlRZLCByZWNlaXZlclR5cGUsIG51bGwpOworCQlyZXdyaXRlLnNl
dChtZXRob2QxMCwgTWV0aG9kRGVjbGFyYXRpb24uUkVDRUlWRVJfUVVBTElGSUVSX1BST1BFUlRZ
LCBxdWFsLCBudWxsKTsKKwkJbGlzdFJld3JpdGUgPSByZXdyaXRlLmdldExpc3RSZXdyaXRlKG1l
dGhvZDEwLCBNZXRob2REZWNsYXJhdGlvbi5QQVJBTUVURVJTX1BST1BFUlRZKTsKKwkJbGlzdFJl
d3JpdGUuaW5zZXJ0Rmlyc3QocGFyYW1Db3B5LCBudWxsKTsKKworCQlyZXdyaXRlLnNldChtZXRo
b2QxMSwgTWV0aG9kRGVjbGFyYXRpb24uUkVDRUlWRVJfVFlQRV9QUk9QRVJUWSwgcmVjZWl2ZXJU
eXBlLCBudWxsKTsKKwkJcmV3cml0ZS5zZXQobWV0aG9kMTEsIE1ldGhvZERlY2xhcmF0aW9uLlJF
Q0VJVkVSX1FVQUxJRklFUl9QUk9QRVJUWSwgcXVhbCwgbnVsbCk7CisJCWxpc3RSZXdyaXRlID0g
cmV3cml0ZS5nZXRMaXN0UmV3cml0ZShtZXRob2QxMSwgTWV0aG9kRGVjbGFyYXRpb24uUEFSQU1F
VEVSU19QUk9QRVJUWSk7CisJCWxpc3RSZXdyaXRlLnJlbW92ZSgoQVNUTm9kZSkgbWV0aG9kMTEu
cGFyYW1ldGVycygpLmdldCgwKSwgbnVsbCk7CisJCWxpc3RSZXdyaXRlLnJlbW92ZSgoQVNUTm9k
ZSkgbWV0aG9kMTEucGFyYW1ldGVycygpLmdldCgxKSwgbnVsbCk7CisKKwkJbGlzdFJld3JpdGUg
PSByZXdyaXRlLmdldExpc3RSZXdyaXRlKG1ldGhvZDEyLCBNZXRob2REZWNsYXJhdGlvbi5QQVJB
TUVURVJTX1BST1BFUlRZKTsKKwkJbGlzdFJld3JpdGUucmVtb3ZlKChBU1ROb2RlKSBtZXRob2Qx
Mi5wYXJhbWV0ZXJzKCkuZ2V0KDEpLCBudWxsKTsKKworCQlsaXN0UmV3cml0ZSA9IHJld3JpdGUu
Z2V0TGlzdFJld3JpdGUobWV0aG9kMTMsIE1ldGhvZERlY2xhcmF0aW9uLlBBUkFNRVRFUlNfUFJP
UEVSVFkpOworCQlsaXN0UmV3cml0ZS5pbnNlcnRGaXJzdChwYXJhbUNvcHksIG51bGwpOworCisJ
CVN0cmluZyBwcmV2aWV3ID0gZXZhbHVhdGVSZXdyaXRlKGN1LCByZXdyaXRlKTsKKwkJYnVmID0g
bmV3IFN0cmluZ0J1ZmZlcigpOworCQlidWYuYXBwZW5kKCJwYWNrYWdlIHRlc3QxO1xuIik7CisJ
CWJ1Zi5hcHBlbmQoImNsYXNzIFhZWiB7XG4iKTsKKwkJYnVmLmFwcGVuZCgiCWNsYXNzIFkge1xu
Iik7CisJCWJ1Zi5hcHBlbmQoIiAgICAJcHVibGljIFkgKCBAQiBpbnQgaSApIHt9XG4iKTsKKwkJ
YnVmLmFwcGVuZCgiICAgIAlwdWJsaWMgWSAoIEBCIGludCBpICwgQEMgaW50IGogKSB7fVxuIik7
CisJCWJ1Zi5hcHBlbmQoIiAgICAJcHVibGljIFkgKCBAQSBYWVogdGhpcyAsIEBCIGZsb2F0IGUg
KSB7fVxuIik7CisJCWJ1Zi5hcHBlbmQoIiAgICAJcHVibGljIFkoIFhZWiB0aGlzICwgQEIgZmxv
YXQgZSwgQEMgZmxvYXQgZiApIHt9XG4iKTsKKwkJYnVmLmFwcGVuZCgiICAgIAlwdWJsaWMgWSAo
ICkge31cbiIpOworCQlidWYuYXBwZW5kKCIgICAgCXB1YmxpYyBZICggQEEgT2JqZWN0IG9iaiwg
QEIgZmxvYXQgZiwgQEMgaW50IGkpIHt9XG4iKTsKKwkJYnVmLmFwcGVuZCgiICAgIAlwdWJsaWMg
WSAoIEBBIFhZWiB0aGlzKSB7fVxuIik7CisJCWJ1Zi5hcHBlbmQoIiAgICAJcHVibGljIFkgKEBB
IFhZWiB0aGlzICwgQEEgT2JqZWN0IG9iaiApIHt9XG4iKTsKKwkJYnVmLmFwcGVuZCgiICAgIAlw
dWJsaWMgWSAoQEEgWFlaIFhZWi50aGlzLCBAQiBib29sZWFuIGIsIEBDIGZsb2F0IGYpIHt9XG4i
KTsKKwkJYnVmLmFwcGVuZCgiICAgIAlwdWJsaWMgWSAoQEEgWFlaIFhZWi50aGlzLCBAQSBPYmpl
Y3Qgb2JqLCBAQiBib29sZWFuIGIgLCBAQyBib29sZWFuIGMpIHt9XG4iKTsKKwkJYnVmLmFwcGVu
ZCgiICAgIAlwdWJsaWMgWSAoQEEgWFlaIFhZWi50aGlzKSB7fVxuIik7CisJCWJ1Zi5hcHBlbmQo
IiAgICAJcHVibGljIFkgKCBAQSBYWVogWFlaLnRoaXMgLCBAQiBpbnQgaSAsIEBEIGludCBrKSB7
fVxuIik7CisJCWJ1Zi5hcHBlbmQoIiAgICAJcHVibGljIFkgKCBAQSBYWVogWFlaLnRoaXMsIEBB
IE9iamVjdCBvYmopIHt9XG4iKTsKKwkJYnVmLmFwcGVuZCgiICAgIH1cbiIpOworCQlidWYuYXBw
ZW5kKCJ9XG4iKTsKKwkJYXNzZXJ0RXF1YWxTdHJpbmcocHJldmlldywgYnVmLnRvU3RyaW5nKCkp
OworCX0KKwlwdWJsaWMgdm9pZCB0ZXN0UmVjZWl2ZXI1X3NpbmNlXzgoKSB0aHJvd3MgRXhjZXB0
aW9uIHsKKwkJSVBhY2thZ2VGcmFnbWVudCBwYWNrMSA9IHRoaXMuc291cmNlRm9sZGVyLmNyZWF0
ZVBhY2thZ2VGcmFnbWVudCgidGVzdDEiLCBmYWxzZSwgbnVsbCk7CisJCVN0cmluZ0J1ZmZlciBi
dWYgPSBuZXcgU3RyaW5nQnVmZmVyKCk7CisJCWJ1Zi5hcHBlbmQoInBhY2thZ2UgdGVzdDE7XG4i
KTsKKwkJYnVmLmFwcGVuZCgiY2xhc3MgWFlaIHtcbiIpOworCQlidWYuYXBwZW5kKCIJY2xhc3Mg
WSB7XG4iKTsKKwkJYnVmLmFwcGVuZCgiICAgIAlwdWJsaWMgWSAoIEBBIFkgWS50aGlzICwgQEIg
aW50IGkgKSB7fVxuIik7CisJCWJ1Zi5hcHBlbmQoIiAgICAJcHVibGljIFkgKCBAQSBYWVogdGhp
cyAsIEBCIGludCBpICwgQEMgaW50IGogKSB7fVxuIik7CisJCWJ1Zi5hcHBlbmQoIiAgICAJcHVi
bGljIFkgKCBAQSBYWVogWS50aGlzICwgQEIgZmxvYXQgZSApIHt9XG4iKTsKKwkJYnVmLmFwcGVu
ZCgiICAgIAlwdWJsaWMgWSggQEEgWFlaIFkudGhpcyAsIEBCIGZsb2F0IGUsIEBDIGZsb2F0IGYg
KSB7fVxuIik7CisJCWJ1Zi5hcHBlbmQoIiAgICB9XG4iKTsKKwkJYnVmLmFwcGVuZCgifVxuIik7
CisJCVN5c3RlbS5vdXQucHJpbnRsbihidWYpOworCQlJQ29tcGlsYXRpb25Vbml0IGN1ID0gcGFj
azEuY3JlYXRlQ29tcGlsYXRpb25Vbml0KCJYWVouamF2YSIsIGJ1Zi50b1N0cmluZygpLCBmYWxz
ZSwgbnVsbCk7CisJCUNvbXBpbGF0aW9uVW5pdCBhc3RSb290ID0gY3JlYXRlQVNUKGN1KTsKKwkJ
QVNUUmV3cml0ZSByZXdyaXRlID0gQVNUUmV3cml0ZS5jcmVhdGUoYXN0Um9vdC5nZXRBU1QoKSk7
CisJCUFTVCBhc3QgPSBhc3RSb290LmdldEFTVCgpOworCQlUeXBlRGVjbGFyYXRpb24gdHlwZSA9
IChUeXBlRGVjbGFyYXRpb24pIGZpbmRUeXBlRGVjbGFyYXRpb24oYXN0Um9vdCwgIlhZWiIpLmJv
ZHlEZWNsYXJhdGlvbnMoKS5nZXQoMCk7CisJCU1ldGhvZERlY2xhcmF0aW9uIG1ldGhvZDEgPSAg
KE1ldGhvZERlY2xhcmF0aW9uKSB0eXBlLmJvZHlEZWNsYXJhdGlvbnMoKS5nZXQoMCk7IC8vIENo
YW5nZSByZWNlaXZlciB0eXBlJ3MgY2hpbGQvY2hpbGRyZW4KKwkJTWV0aG9kRGVjbGFyYXRpb24g
bWV0aG9kMiA9ICAoTWV0aG9kRGVjbGFyYXRpb24pIHR5cGUuYm9keURlY2xhcmF0aW9ucygpLmdl
dCgxKTsgLy8gSW5zZXJ0IHJlY2VpdmVyIHF1YWxpZmllcgorCQlNZXRob2REZWNsYXJhdGlvbiBt
ZXRob2QzID0gIChNZXRob2REZWNsYXJhdGlvbikgdHlwZS5ib2R5RGVjbGFyYXRpb25zKCkuZ2V0
KDIpOyAvLyBSZXBsYWNlIHJlY2VpdmVyIHF1YWxpZmllcgorCQlNZXRob2REZWNsYXJhdGlvbiBt
ZXRob2Q0ID0gIChNZXRob2REZWNsYXJhdGlvbikgdHlwZS5ib2R5RGVjbGFyYXRpb25zKCkuZ2V0
KDMpOyAvLyBDaGFuZ2UgcmVjZWl2ZXIgcXVhbGlmaWVyJ3MgY2hpbGRyZW4KKworCQlOYW1lIG5l
d05hbWUgPSBhc3QubmV3U2ltcGxlTmFtZSgiWFlaIik7CisJCXJld3JpdGUucmVwbGFjZSgoKFNp
bXBsZVR5cGUpIG1ldGhvZDEuZ2V0UmVjZWl2ZXJUeXBlKCkpLmdldE5hbWUoKSwgbmV3TmFtZSwg
bnVsbCk7CisJCXJld3JpdGUucmVwbGFjZShtZXRob2QxLmdldFJlY2VpdmVyUXVhbGlmaWVyKCks
IG5ld05hbWUsIG51bGwpOworCQlyZXdyaXRlLnNldChtZXRob2QyLCBNZXRob2REZWNsYXJhdGlv
bi5SRUNFSVZFUl9RVUFMSUZJRVJfUFJPUEVSVFksIG5ld05hbWUsIG51bGwpOworCQlyZXdyaXRl
LnJlcGxhY2UobWV0aG9kMy5nZXRSZWNlaXZlclF1YWxpZmllcigpLCBuZXdOYW1lLCBudWxsKTsK
KwkJU2ltcGxlTmFtZSBxdWFsaWZpZXIgPSBtZXRob2Q0LmdldFJlY2VpdmVyUXVhbGlmaWVyKCk7
CisJCXJld3JpdGUuc2V0KHF1YWxpZmllciwgU2ltcGxlTmFtZS5JREVOVElGSUVSX1BST1BFUlRZ
LCAiWFlaIiwgbnVsbCk7CisKKwkJU3RyaW5nIHByZXZpZXcgPSBldmFsdWF0ZVJld3JpdGUoY3Us
IHJld3JpdGUpOworCQlidWYgPSBuZXcgU3RyaW5nQnVmZmVyKCk7CisJCWJ1Zi5hcHBlbmQoInBh
Y2thZ2UgdGVzdDE7XG4iKTsKKwkJYnVmLmFwcGVuZCgiY2xhc3MgWFlaIHtcbiIpOworCQlidWYu
YXBwZW5kKCIJY2xhc3MgWSB7XG4iKTsKKwkJYnVmLmFwcGVuZCgiICAgIAlwdWJsaWMgWSAoIEBB
IFhZWiBYWVoudGhpcyAsIEBCIGludCBpICkge31cbiIpOworCQlidWYuYXBwZW5kKCIgICAgCXB1
YmxpYyBZICggQEEgWFlaIFhZWi50aGlzICwgQEIgaW50IGkgLCBAQyBpbnQgaiApIHt9XG4iKTsK
KwkJYnVmLmFwcGVuZCgiICAgIAlwdWJsaWMgWSAoIEBBIFhZWiBYWVoudGhpcyAsIEBCIGZsb2F0
IGUgKSB7fVxuIik7CisJCWJ1Zi5hcHBlbmQoIiAgICAJcHVibGljIFkoIEBBIFhZWiBYWVoudGhp
cyAsIEBCIGZsb2F0IGUsIEBDIGZsb2F0IGYgKSB7fVxuIik7CisJCWJ1Zi5hcHBlbmQoIiAgICB9
XG4iKTsKKwkJYnVmLmFwcGVuZCgifVxuIik7CisJCWFzc2VydEVxdWFsU3RyaW5nKHByZXZpZXcs
IGJ1Zi50b1N0cmluZygpKTsKKwl9CisKIH0KZGlmZiAtLWdpdCBhL29yZy5lY2xpcHNlLmpkdC5j
b3JlL2RvbS9vcmcvZWNsaXBzZS9qZHQvaW50ZXJuYWwvY29yZS9kb20vcmV3cml0ZS9BU1RSZXdy
aXRlQW5hbHl6ZXIuamF2YSBiL29yZy5lY2xpcHNlLmpkdC5jb3JlL2RvbS9vcmcvZWNsaXBzZS9q
ZHQvaW50ZXJuYWwvY29yZS9kb20vcmV3cml0ZS9BU1RSZXdyaXRlQW5hbHl6ZXIuamF2YQppbmRl
eCAyYTE3Y2E2Li45MjAwYzgzIDEwMDY0NAotLS0gYS9vcmcuZWNsaXBzZS5qZHQuY29yZS9kb20v
b3JnL2VjbGlwc2UvamR0L2ludGVybmFsL2NvcmUvZG9tL3Jld3JpdGUvQVNUUmV3cml0ZUFuYWx5
emVyLmphdmEKKysrIGIvb3JnLmVjbGlwc2UuamR0LmNvcmUvZG9tL29yZy9lY2xpcHNlL2pkdC9p
bnRlcm5hbC9jb3JlL2RvbS9yZXdyaXRlL0FTVFJld3JpdGVBbmFseXplci5qYXZhCkBAIC0xNTE3
LDUgKzE1MTcsNSBAQAogCQlib29sZWFuIGlzQWxsUmVtb3ZlPSBpc0FsbE9mS2luZChjaGlsZHJl
biwgUmV3cml0ZUV2ZW50LlJFTU9WRUQpOwogCQlTdHJpbmcga2V5d29yZD0gVXRpbC5FTVBUWV9T
VFJJTkc7Ci0JCWlmIChwcm9wZXJ0eSA9PSBTaW5nbGVWYXJpYWJsZURlY2xhcmF0aW9uLlZBUkFS
R1NfQU5OT1RBVElPTlNfUFJPUEVSVFkgfHwgcHJvcGVydHkgPT0gQXJyYXlUeXBlLkFOTk9UQVRJ
T05TX1BST1BFUlRZKSB7CisJCWlmIChwcm9wZXJ0eSA9PSBTaW5nbGVWYXJpYWJsZURlY2xhcmF0
aW9uLlZBUkFSR1NfQU5OT1RBVElPTlNfUFJPUEVSVFkgfHwgbm9kZSBpbnN0YW5jZW9mIEFubm90
YXRhYmxlVHlwZSkgewogCQkJa2V5d29yZD0gIiAiOyAvLyROT04tTkxTLTEkCiAJCX0gZWxzZSBp
ZiAoaXNBbGxJbnNlcnQgfHwgaXNBbGxSZW1vdmUpIHsKQEAgLTE1MzAsNSArMTUzMCw1IEBACiAJ
CVByZWZpeCBmb3JtYXR0ZXJQcmVmaXg7CiAJCWlmIChwcm9wZXJ0eSA9PSBTaW5nbGVWYXJpYWJs
ZURlY2xhcmF0aW9uLk1PRElGSUVSUzJfUFJPUEVSVFkgfHwgcHJvcGVydHkgPT0gU2luZ2xlVmFy
aWFibGVEZWNsYXJhdGlvbi5WQVJBUkdTX0FOTk9UQVRJT05TX1BST1BFUlRZIAotCQkJCQkJCXx8
IHByb3BlcnR5ID09IEFycmF5VHlwZS5BTk5PVEFUSU9OU19QUk9QRVJUWSkKKwkJCQkJCQl8fCBu
b2RlIGluc3RhbmNlb2YgQW5ub3RhdGFibGVUeXBlKQogCQkJZm9ybWF0dGVyUHJlZml4PSB0aGlz
LmZvcm1hdHRlci5QQVJBTV9BTk5PVEFUSU9OX1NFUEFSQVRJT047CiAJCWVsc2UKQEAgLTE1NDYs
NSArMTU0Niw1IEBACiAJCQkJcmV0dXJuIG5leHRQb3M7CiAJCQl9IGVsc2UgaWYgKChpc0FsbElu
c2VydCB8fCAobmV4dFBvcyA9PSBlbmRQb3MgJiYgbGFzdFVuY2hhbmdlZCkpIC8vIHNlZSBidWcg
MTY1NjU0Ci0JCQkJCSYmIHByb3BlcnR5ICE9IFNpbmdsZVZhcmlhYmxlRGVjbGFyYXRpb24uVkFS
QVJHU19BTk5PVEFUSU9OU19QUk9QRVJUWSAmJiBwcm9wZXJ0eSAhPSBBcnJheVR5cGUuQU5OT1RB
VElPTlNfUFJPUEVSVFkpIHsKKwkJCQkJJiYgcHJvcGVydHkgIT0gU2luZ2xlVmFyaWFibGVEZWNs
YXJhdGlvbi5WQVJBUkdTX0FOTk9UQVRJT05TX1BST1BFUlRZICYmICEobm9kZSBpbnN0YW5jZW9m
IEFubm90YXRhYmxlVHlwZSkpIHsKIAkJCQlTdHJpbmcgc2VwYXJhdG9yOwogCQkJCWlmIChsYXN0
Q2hpbGQuZ2V0TmV3VmFsdWUoKSBpbnN0YW5jZW9mIEFubm90YXRpb24pIHsKQEAgLTE4MjAsNCAr
MTgyMCw5NCBAQAogCQl9CiAJfQorCQorCXByaXZhdGUgaW50IHJld3JpdGVNZXRob2RSZWNlaXZl
cihNZXRob2REZWNsYXJhdGlvbiBtZXRob2QsIGludCBvZmZzZXQpIHRocm93cyBDb3JlRXhjZXB0
aW9uIHsKKwkJb2Zmc2V0PSBnZXRTY2FubmVyKCkuZ2V0VG9rZW5FbmRPZmZzZXQoVGVybWluYWxU
b2tlbnMuVG9rZW5OYW1lTFBBUkVOLCBvZmZzZXQpOworCQlpZiAobWV0aG9kLmdldEFTVCgpLmFw
aUxldmVsKCkgPCBBU1QuSkxTOCkgeworCQkJcmV0dXJuIG9mZnNldDsKKwkJfQorCisJCWludCBu
ZXdQYXJhbUNvdW50ID0gKChMaXN0KSBnZXROZXdWYWx1ZShtZXRob2QsIE1ldGhvZERlY2xhcmF0
aW9uLlBBUkFNRVRFUlNfUFJPUEVSVFkpKS5zaXplKCk7CisJCWludCBvbGRQYXJhbUNvdW50ID0g
bWV0aG9kLnBhcmFtZXRlcnMoKS5zaXplKCk7CisJCVJld3JpdGVFdmVudCBldmVudCA9IGdldEV2
ZW50KG1ldGhvZCwgTWV0aG9kRGVjbGFyYXRpb24uUkVDRUlWRVJfVFlQRV9QUk9QRVJUWSk7CisJ
CVJld3JpdGVFdmVudCBxdWFsRXZlbnQgPSBnZXRFdmVudChtZXRob2QsIE1ldGhvZERlY2xhcmF0
aW9uLlJFQ0VJVkVSX1FVQUxJRklFUl9QUk9QRVJUWSk7CisKKwkJYm9vbGVhbiByZXdyaXRlUXVh
bGlmaWVyID0gZmFsc2U7CisJCUFTVE5vZGUgbmV3UXVhbCA9IG51bGw7CisJCUFTVE5vZGUgb2xk
UXVhbCA9IG51bGw7CisJCWlmIChxdWFsRXZlbnQgIT0gbnVsbCkgeworCQkJbmV3UXVhbCA9IChB
U1ROb2RlKSBxdWFsRXZlbnQuZ2V0TmV3VmFsdWUoKTsKKwkJCW9sZFF1YWwgPSAoQVNUTm9kZSkg
cXVhbEV2ZW50LmdldE9yaWdpbmFsVmFsdWUoKTsKKwkJfQorCisJCVRleHRFZGl0R3JvdXAgZWRp
dEdyb3VwPSBnZXRFZGl0R3JvdXAoZXZlbnQpOworCQlpZiAoZXZlbnQgIT0gbnVsbCAmJiBldmVu
dC5nZXRDaGFuZ2VLaW5kKCkgIT0gUmV3cml0ZUV2ZW50LlVOQ0hBTkdFRCkgeworCQkJaW50IGNo
YW5nZUtpbmQ9IGV2ZW50LmdldENoYW5nZUtpbmQoKTsKKwkJCWlmIChjaGFuZ2VLaW5kID09IFJl
d3JpdGVFdmVudC5JTlNFUlRFRCkgeworCQkJCSBkb1RleHRJbnNlcnQob2Zmc2V0LCAoQVNUTm9k
ZSkgZXZlbnQuZ2V0TmV3VmFsdWUoKSwgMCwgZmFsc2UsIGVkaXRHcm91cCk7CisJCQkJZG9UZXh0
SW5zZXJ0KG9mZnNldCwgIiAiLCBlZGl0R3JvdXApOyAvLyROT04tTkxTLTEkCisJCQkJaWYgKG5l
d1F1YWwgIT0gbnVsbCApIHsKKwkJCQkJZG9UZXh0SW5zZXJ0KG9mZnNldCwgbmV3UXVhbCwgMCwg
ZmFsc2UsIGdldEVkaXRHcm91cChxdWFsRXZlbnQpKTsKKwkJCQkJZG9UZXh0SW5zZXJ0KG9mZnNl
dCwgIi4iLCBlZGl0R3JvdXApOyAvLyROT04tTkxTLTEkCisJCQkJfQorCQkJCWRvVGV4dEluc2Vy
dChvZmZzZXQsICJ0aGlzIiwgZWRpdEdyb3VwKTsgLy8kTk9OLU5MUy0xJAorCQkJCWlmIChuZXdQ
YXJhbUNvdW50ID4gMCkgeworCQkJCQlkb1RleHRJbnNlcnQob2Zmc2V0LCAiLCAiLCBlZGl0R3Jv
dXApOyAvLyROT04tTkxTLTEkCisJCQkJfQorCQkJfSBlbHNlIHsKKwkJCQlBU1ROb2RlIGVsZW09
IChBU1ROb2RlKSBldmVudC5nZXRPcmlnaW5hbFZhbHVlKCk7CisJCQkJU291cmNlUmFuZ2UgcmFu
Z2U9IGdldEV4dGVuZGVkUmFuZ2UoZWxlbSk7CisJCQkJaW50IGVsZW1PZmZzZXQ9IHJhbmdlLmdl
dFN0YXJ0UG9zaXRpb24oKTsKKwkJCQlpbnQgZWxlbUxlbmd0aD0gcmFuZ2UuZ2V0TGVuZ3RoKCk7
CisJCQkJaW50IGVsZW1FbmQ9IGVsZW1PZmZzZXQgKyBlbGVtTGVuZ3RoOworCQkJCWlmIChjaGFu
Z2VLaW5kID09IFJld3JpdGVFdmVudC5SRU1PVkVEKSB7CisJCQkJCWVkaXRHcm91cD0gZ2V0RWRp
dEdyb3VwKGV2ZW50KTsKKwkJCQkJaW50IGVuZFBvczsKKwkJCQkJaWYgKG9sZFBhcmFtQ291bnQg
PT0gMCkgeworCQkJCQkJZW5kUG9zPSBnZXRTY2FubmVyKCkuZ2V0VG9rZW5TdGFydE9mZnNldChU
ZXJtaW5hbFRva2Vucy5Ub2tlbk5hbWVSUEFSRU4sIGVsZW1FbmQpOworCQkJCQl9IGVsc2Ugewor
CQkJCQkJZW5kUG9zPSBnZXRTY2FubmVyKCkuZ2V0VG9rZW5FbmRPZmZzZXQoVGVybWluYWxUb2tl
bnMuVG9rZW5OYW1lQ09NTUEsIGVsZW1FbmQpOworCQkJCQl9CisJCQkJCWRvVGV4dFJlbW92ZUFu
ZFZpc2l0KG9mZnNldCwgZW5kUG9zIC0gb2Zmc2V0LCBlbGVtLCBlZGl0R3JvdXApOworCQkJCQly
ZXR1cm4gZW5kUG9zOworCQkJCX0gZWxzZSBpZiAoY2hhbmdlS2luZCA9PSBSZXdyaXRlRXZlbnQu
UkVQTEFDRUQpIHsKKwkJCQkJZWRpdEdyb3VwPSBnZXRFZGl0R3JvdXAoZXZlbnQpOworCQkJCQlk
b1RleHRSZW1vdmVBbmRWaXNpdChlbGVtT2Zmc2V0LCBlbGVtTGVuZ3RoLCBlbGVtLCBlZGl0R3Jv
dXApOworCQkJCQlkb1RleHRJbnNlcnQoZWxlbU9mZnNldCwgKEFTVE5vZGUpIGV2ZW50LmdldE5l
d1ZhbHVlKCksIDAsIGZhbHNlLCBlZGl0R3JvdXApOworCQkJCQlyZXdyaXRlUXVhbGlmaWVyID0g
dHJ1ZTsKKwkJCQl9CisJCQl9CisJCX0gZWxzZSB7CisJCQlyZXdyaXRlUmVxdWlyZWROb2RlKG1l
dGhvZCwgTWV0aG9kRGVjbGFyYXRpb24uUkVDRUlWRVJfVFlQRV9QUk9QRVJUWSk7CisJCQlpZiAo
bWV0aG9kLmdldFJlY2VpdmVyVHlwZSgpICE9IG51bGwpIHsKKwkJCQlyZXdyaXRlUXVhbGlmaWVy
ID0gdHJ1ZTsKKwkJCX0KKwkJfQorCQlpZiAocmV3cml0ZVF1YWxpZmllcikgeworCQkJaWYgKHF1
YWxFdmVudCAhPSBudWxsKSB7CisJCQkJaW50IHF1YWxDaGFuZ2VLaW5kID0gcXVhbEV2ZW50Lmdl
dENoYW5nZUtpbmQoKTsKKwkJCQlUZXh0RWRpdEdyb3VwIHF1YWxHcm91cCA9IGdldEVkaXRHcm91
cChxdWFsRXZlbnQpOworCQkJCWlmIChxdWFsQ2hhbmdlS2luZCA9PSBSZXdyaXRlRXZlbnQuSU5T
RVJURUQpIHsKKwkJCQkJaW50IHBvcz0gZ2V0U2Nhbm5lcigpLmdldFRva2VuU3RhcnRPZmZzZXQo
VGVybWluYWxUb2tlbnMuVG9rZW5OYW1ldGhpcywgb2Zmc2V0KTsKKwkJCQkJZG9UZXh0SW5zZXJ0
KHBvcywgKEFTVE5vZGUpIHF1YWxFdmVudC5nZXROZXdWYWx1ZSgpLCAwLCBmYWxzZSwgcXVhbEdy
b3VwKTsKKwkJCQkJZG9UZXh0SW5zZXJ0KHBvcywgIi4iLCBxdWFsR3JvdXApOyAvLyROT04tTkxT
LTEkCisJCQkJfSBlbHNlIGlmIChxdWFsQ2hhbmdlS2luZCA9PSBSZXdyaXRlRXZlbnQuUkVNT1ZF
RCkgeworCQkJCQlpbnQgcXVhbE9mZnNldCA9IG9sZFF1YWwuZ2V0U3RhcnRQb3NpdGlvbigpOwor
CQkJCQlpbnQgZW5kUG9zPSBnZXRTY2FubmVyKCkuZ2V0VG9rZW5FbmRPZmZzZXQoVGVybWluYWxU
b2tlbnMuVG9rZW5OYW1lRE9ULCBxdWFsT2Zmc2V0KTsKKwkJCQkJZG9UZXh0UmVtb3ZlKHF1YWxP
ZmZzZXQsIGVuZFBvcyAtIHF1YWxPZmZzZXQsIHF1YWxHcm91cCk7CisJCQkJfSBlbHNlIGlmIChx
dWFsQ2hhbmdlS2luZCA9PSBSZXdyaXRlRXZlbnQuUkVQTEFDRUQpIHsKKwkJCQkJU291cmNlUmFu
Z2UgcmFuZ2U9IGdldEV4dGVuZGVkUmFuZ2Uob2xkUXVhbCk7CisJCQkJCWludCBlbGVtT2Zmc2V0
PSByYW5nZS5nZXRTdGFydFBvc2l0aW9uKCk7CisJCQkJCWludCBlbGVtTGVuZ3RoPSByYW5nZS5n
ZXRMZW5ndGgoKTsKKwkJCQkJZG9UZXh0UmVtb3ZlQW5kVmlzaXQoZWxlbU9mZnNldCwgZWxlbUxl
bmd0aCwgb2xkUXVhbCwgcXVhbEdyb3VwKTsKKwkJCQkJZG9UZXh0SW5zZXJ0KGVsZW1PZmZzZXQs
IG5ld1F1YWwsIDAsIGZhbHNlLCBxdWFsR3JvdXApOworCQkJCX0KKwkJCX0KKwkJCW9mZnNldD0g
IGdldFNjYW5uZXIoKS5nZXRUb2tlbkVuZE9mZnNldChUZXJtaW5hbFRva2Vucy5Ub2tlbk5hbWV0
aGlzLCBvZmZzZXQpOworCQkJaWYgKG5ld1BhcmFtQ291bnQgPiAwICYmIG9sZFBhcmFtQ291bnQg
PT0gMCkgeworCQkJCWRvVGV4dEluc2VydChvZmZzZXQsICIsICIsIGVkaXRHcm91cCk7IC8vJE5P
Ti1OTFMtMSQKKwkJCX0KKwkJfQorCQlyZXR1cm4gb2Zmc2V0OworCX0KIAogCXB1YmxpYyBib29s
ZWFuIHZpc2l0KEV4dHJhRGltZW5zaW9uIG5vZGUpIHsKQEAgLTE4NTgsNiArMTk0OCw2IEBACiAJ
CS8vIHBhcmFtZXRlcnMKIAkJdHJ5IHsKKwkJCXBvcz0gcmV3cml0ZU1ldGhvZFJlY2VpdmVyKG5v
ZGUsIHBvcyk7CiAJCQlpZiAoaXNDaGFuZ2VkKG5vZGUsIE1ldGhvZERlY2xhcmF0aW9uLlBBUkFN
RVRFUlNfUFJPUEVSVFkpKSB7Ci0JCQkJcG9zPSBnZXRTY2FubmVyKCkuZ2V0VG9rZW5FbmRPZmZz
ZXQoVGVybWluYWxUb2tlbnMuVG9rZW5OYW1lTFBBUkVOLCBwb3MpOwogCQkJCXBvcz0gcmV3cml0
ZU5vZGVMaXN0KG5vZGUsIE1ldGhvZERlY2xhcmF0aW9uLlBBUkFNRVRFUlNfUFJPUEVSVFksIHBv
cywgVXRpbC5FTVBUWV9TVFJJTkcsICIsICIpOyAvLyROT04tTkxTLTEkIAogCQkJfSBlbHNlIHs=
</data>

          </attachment>
          <attachment
              isobsolete="1"
              ispatch="1"
              isprivate="0"
          >
            <attachid>229564</attachid>
            <date>2013-04-10 10:45:00 -0400</date>
            <delta_ts>2013-04-10 13:13:09 -0400</delta_ts>
            <desc>Patch for ASTRewriteFlattener</desc>
            <filename>eclipse.jdt.core.patch</filename>
            <type>text/plain</type>
            <size>1259</size>
            <attacher name="Manju Mathew">manju656</attacher>
            
              <data encoding="base64">IyMjIEVjbGlwc2UgV29ya3NwYWNlIFBhdGNoIDEuMAojUCBvcmcuZWNsaXBzZS5qZHQuY29yZQpk
aWZmIC0tZ2l0IGRvbS9vcmcvZWNsaXBzZS9qZHQvaW50ZXJuYWwvY29yZS9kb20vcmV3cml0ZS9B
U1RSZXdyaXRlRmxhdHRlbmVyLmphdmEgZG9tL29yZy9lY2xpcHNlL2pkdC9pbnRlcm5hbC9jb3Jl
L2RvbS9yZXdyaXRlL0FTVFJld3JpdGVGbGF0dGVuZXIuamF2YQppbmRleCAyMjE3YmRiLi41Mjgz
MDgxIDEwMDY0NAotLS0gZG9tL29yZy9lY2xpcHNlL2pkdC9pbnRlcm5hbC9jb3JlL2RvbS9yZXdy
aXRlL0FTVFJld3JpdGVGbGF0dGVuZXIuamF2YQorKysgZG9tL29yZy9lY2xpcHNlL2pkdC9pbnRl
cm5hbC9jb3JlL2RvbS9yZXdyaXRlL0FTVFJld3JpdGVGbGF0dGVuZXIuamF2YQpAQCAtNzA1LDYg
KzcwNSwyNCBAQAogCQl9CiAJCWdldENoaWxkTm9kZShub2RlLCBNZXRob2REZWNsYXJhdGlvbi5O
QU1FX1BST1BFUlRZKS5hY2NlcHQodGhpcyk7CiAJCXRoaXMucmVzdWx0LmFwcGVuZCgnKCcpOwor
CQkvLyByZWNlaXZlciBwYXJhbWV0ZXIKKwkJaWYgKG5vZGUuZ2V0QVNUKCkuYXBpTGV2ZWwoKSA+
PSBBU1QuSkxTOCkgeworCQkJQW5ub3RhdGFibGVUeXBlIHJlY2VpdmVyVHlwZSA9IG5vZGUuZ2V0
UmVjZWl2ZXJUeXBlKCk7CisJCQlpZiAocmVjZWl2ZXJUeXBlICE9IG51bGwpIHsKKwkJCQlyZWNl
aXZlclR5cGUuYWNjZXB0KHRoaXMpOworCQkJCXRoaXMucmVzdWx0LmFwcGVuZCgnICcpOworCQkJ
CVNpbXBsZU5hbWUgcXVhbGlmaWVyID0gbm9kZS5nZXRSZWNlaXZlclF1YWxpZmllcigpOworCQkJ
CWlmIChxdWFsaWZpZXIgIT0gbnVsbCkgeworCQkJCQlxdWFsaWZpZXIuYWNjZXB0KHRoaXMpOwor
CQkJCQl0aGlzLnJlc3VsdC5hcHBlbmQoJy4nKTsKKwkJCQl9CisJCQkJdGhpcy5yZXN1bHQuYXBw
ZW5kKCJ0aGlzIik7IC8vJE5PTi1OTFMtMSQKKwkJCQlpZiAobm9kZS5wYXJhbWV0ZXJzKCkuc2l6
ZSgpID4gMCkgeworCQkJCQl0aGlzLnJlc3VsdC5hcHBlbmQoJywnKTsKKwkJCQl9CisJCQl9CisJ
CX0KKwkKIAkJdmlzaXRMaXN0KG5vZGUsIE1ldGhvZERlY2xhcmF0aW9uLlBBUkFNRVRFUlNfUFJP
UEVSVFksIFN0cmluZy52YWx1ZU9mKCcsJykpOwogCQl0aGlzLnJlc3VsdC5hcHBlbmQoJyknKTsK
IAkJdmlzaXRFeHRyYURpbWVuc2lvbnMobm9kZSwgSU5URVJOQUxfTUVUSE9EX0VYVFJBX0RJTUVO
U0lPTlNfUFJPUEVSVFksIE1ldGhvZERlY2xhcmF0aW9uLkVYVFJBX0RJTUVOU0lPTlMyX1BST1BF
UlRZKTs=
</data>
<flag name="review"
          id="56503"
          type_id="6"
          status="-"
          setter="markus_keller"
    />
          </attachment>
          <attachment
              isobsolete="0"
              ispatch="1"
              isprivate="0"
          >
            <attachid>229577</attachid>
            <date>2013-04-10 13:13:00 -0400</date>
            <delta_ts>2013-04-10 13:13:09 -0400</delta_ts>
            <desc>Patch for ASTRewriteFlattener</desc>
            <filename>eclipse.jdt.core.patch</filename>
            <type>text/plain</type>
            <size>1364</size>
            <attacher name="Manju Mathew">manju656</attacher>
            
              <data encoding="base64">IyMjIEVjbGlwc2UgV29ya3NwYWNlIFBhdGNoIDEuMAojUCBvcmcuZWNsaXBzZS5qZHQuY29yZQpk
aWZmIC0tZ2l0IGRvbS9vcmcvZWNsaXBzZS9qZHQvaW50ZXJuYWwvY29yZS9kb20vcmV3cml0ZS9B
U1RSZXdyaXRlRmxhdHRlbmVyLmphdmEgZG9tL29yZy9lY2xpcHNlL2pkdC9pbnRlcm5hbC9jb3Jl
L2RvbS9yZXdyaXRlL0FTVFJld3JpdGVGbGF0dGVuZXIuamF2YQppbmRleCAyMjE3YmRiLi43ZDdj
MzQ4IDEwMDY0NAotLS0gZG9tL29yZy9lY2xpcHNlL2pkdC9pbnRlcm5hbC9jb3JlL2RvbS9yZXdy
aXRlL0FTVFJld3JpdGVGbGF0dGVuZXIuamF2YQorKysgZG9tL29yZy9lY2xpcHNlL2pkdC9pbnRl
cm5hbC9jb3JlL2RvbS9yZXdyaXRlL0FTVFJld3JpdGVGbGF0dGVuZXIuamF2YQpAQCAtNzA1LDYg
KzcwNSwyNCBAQAogCQl9CiAJCWdldENoaWxkTm9kZShub2RlLCBNZXRob2REZWNsYXJhdGlvbi5O
QU1FX1BST1BFUlRZKS5hY2NlcHQodGhpcyk7CiAJCXRoaXMucmVzdWx0LmFwcGVuZCgnKCcpOwor
CQkvLyByZWNlaXZlciBwYXJhbWV0ZXIKKwkJaWYgKG5vZGUuZ2V0QVNUKCkuYXBpTGV2ZWwoKSA+
PSBBU1QuSkxTOCkgeworCQkJQVNUTm9kZSByZWNlaXZlclR5cGUgPSBnZXRDaGlsZE5vZGUobm9k
ZSwgTWV0aG9kRGVjbGFyYXRpb24uUkVDRUlWRVJfVFlQRV9QUk9QRVJUWSk7CisJCQlpZiAocmVj
ZWl2ZXJUeXBlICE9IG51bGwpIHsKKwkJCQlyZWNlaXZlclR5cGUuYWNjZXB0KHRoaXMpOworCQkJ
CXRoaXMucmVzdWx0LmFwcGVuZCgnICcpOworCQkJCUFTVE5vZGUgcXVhbGlmaWVyID0gZ2V0Q2hp
bGROb2RlKG5vZGUsIE1ldGhvZERlY2xhcmF0aW9uLlJFQ0VJVkVSX1FVQUxJRklFUl9QUk9QRVJU
WSk7CisJCQkJaWYgKHF1YWxpZmllciAhPSBudWxsKSB7CisJCQkJCXF1YWxpZmllci5hY2NlcHQo
dGhpcyk7CisJCQkJCXRoaXMucmVzdWx0LmFwcGVuZCgnLicpOworCQkJCX0KKwkJCQl0aGlzLnJl
c3VsdC5hcHBlbmQoInRoaXMiKTsgLy8kTk9OLU5MUy0xJAorCQkJCWlmIChnZXRDaGlsZExpc3Qo
bm9kZSwgTWV0aG9kRGVjbGFyYXRpb24uUEFSQU1FVEVSU19QUk9QRVJUWSkuc2l6ZSgpID4gMCkg
eworCQkJCQl0aGlzLnJlc3VsdC5hcHBlbmQoJywnKTsKKwkJCQl9CisJCQl9CisJCX0KKwkKIAkJ
dmlzaXRMaXN0KG5vZGUsIE1ldGhvZERlY2xhcmF0aW9uLlBBUkFNRVRFUlNfUFJPUEVSVFksIFN0
cmluZy52YWx1ZU9mKCcsJykpOwogCQl0aGlzLnJlc3VsdC5hcHBlbmQoJyknKTsKIAkJdmlzaXRF
eHRyYURpbWVuc2lvbnMobm9kZSwgSU5URVJOQUxfTUVUSE9EX0VYVFJBX0RJTUVOU0lPTlNfUFJP
UEVSVFksIE1ldGhvZERlY2xhcmF0aW9uLkVYVFJBX0RJTUVOU0lPTlMyX1BST1BFUlRZKTs=
</data>

          </attachment>
          <attachment
              isobsolete="0"
              ispatch="1"
              isprivate="0"
          >
            <attachid>229716</attachid>
            <date>2013-04-15 06:50:00 -0400</date>
            <delta_ts>2013-04-15 06:50:20 -0400</delta_ts>
            <desc>Tests Patch</desc>
            <filename>eclipse.jdt.core.tests.patch</filename>
            <type>text/plain</type>
            <size>4727</size>
            <attacher name="Manju Mathew">manju656</attacher>
            
              <data encoding="base64">IyMjIEVjbGlwc2UgV29ya3NwYWNlIFBhdGNoIDEuMAojUCBvcmcuZWNsaXBzZS5qZHQuY29yZS50
ZXN0cy5tb2RlbApkaWZmIC0tZ2l0IHNyYy9vcmcvZWNsaXBzZS9qZHQvY29yZS90ZXN0cy9yZXdy
aXRlL2Rlc2NyaWJpbmcvQVNUUmV3cml0aW5nTWV0aG9kRGVjbFRlc3QuamF2YSBzcmMvb3JnL2Vj
bGlwc2UvamR0L2NvcmUvdGVzdHMvcmV3cml0ZS9kZXNjcmliaW5nL0FTVFJld3JpdGluZ01ldGhv
ZERlY2xUZXN0LmphdmEKaW5kZXggMmU2M2M1MC4uNjE2NGI3OCAxMDA2NDQKLS0tIHNyYy9vcmcv
ZWNsaXBzZS9qZHQvY29yZS90ZXN0cy9yZXdyaXRlL2Rlc2NyaWJpbmcvQVNUUmV3cml0aW5nTWV0
aG9kRGVjbFRlc3QuamF2YQorKysgc3JjL29yZy9lY2xpcHNlL2pkdC9jb3JlL3Rlc3RzL3Jld3Jp
dGUvZGVzY3JpYmluZy9BU1RSZXdyaXRpbmdNZXRob2REZWNsVGVzdC5qYXZhCkBAIC0zNjQ2LDQg
KzM2NDYsMTE4IEBACiAJCQkJIn1cbiI7CiAJCWFzc2VydEVxdWFsU3RyaW5nKHByZXZpZXcsIGNv
bnRlbnRzKTsKIAl9CisKKwlwdWJsaWMgdm9pZCB0ZXN0UmVjZWl2ZXJQYXJhbV9zaW5jZV84KCkg
dGhyb3dzIEV4Y2VwdGlvbiB7CisJCUlQYWNrYWdlRnJhZ21lbnQgcGFjazEgPSB0aGlzLnNvdXJj
ZUZvbGRlci5jcmVhdGVQYWNrYWdlRnJhZ21lbnQoCisJCQkJInRlc3QxIiwgZmFsc2UsIG51bGwp
OworCQlTdHJpbmdCdWZmZXIgYnVmID0gbmV3IFN0cmluZ0J1ZmZlcigpOworCQlidWYuYXBwZW5k
KCJwYWNrYWdlIHRlc3QxO1xuIik7CisJCWJ1Zi5hcHBlbmQoInB1YmxpYyBhYnN0cmFjdCBjbGFz
cyBFIHtcbiIpOworCQlidWYuYXBwZW5kKCIgICAgcHVibGljIHZvaWQgZm9vKCkge1xuIik7CisJ
CWJ1Zi5hcHBlbmQoIiAgICB9XG4iKTsKKwkJYnVmLmFwcGVuZCgiXG4iKTsKKwkJYnVmLmFwcGVu
ZCgifVxuIik7CisJCUlDb21waWxhdGlvblVuaXQgY3UgPSBwYWNrMS5jcmVhdGVDb21waWxhdGlv
blVuaXQoIkUuamF2YSIsCisJCQkJYnVmLnRvU3RyaW5nKCksIGZhbHNlLCBudWxsKTsKKworCQlD
b21waWxhdGlvblVuaXQgYXN0Um9vdCA9IGNyZWF0ZUFTVChjdSk7CisJCUFTVCBhc3QgPSBhc3RS
b290LmdldEFTVCgpOworCQlBU1RSZXdyaXRlIHJld3JpdGUgPSBBU1RSZXdyaXRlLmNyZWF0ZShh
c3RSb290LmdldEFTVCgpKTsKKwkJVHlwZURlY2xhcmF0aW9uIHR5cGUgPSBmaW5kVHlwZURlY2xh
cmF0aW9uKGFzdFJvb3QsICJFIik7CisKKwkJTWV0aG9kRGVjbGFyYXRpb24gbmV3TWV0aG9kRGVj
bGFyYXRpb24gPSBhc3QubmV3TWV0aG9kRGVjbGFyYXRpb24oKTsKKwkJU2ltcGxlTmFtZSBtZXRo
b2ROYW1lID0gYXN0Lm5ld1NpbXBsZU5hbWUoImJhciIpOworCQlTaW1wbGVUeXBlIHNpbXBsZVR5
cGUgPSBhc3QubmV3U2ltcGxlVHlwZShhc3QubmV3U2ltcGxlTmFtZSgiRSIpKTsKKwkJTWFya2Vy
QW5ub3RhdGlvbiBhbm5vdGF0aW9uQyA9IGFzdC5uZXdNYXJrZXJBbm5vdGF0aW9uKCk7CisJCWFu
bm90YXRpb25DLnNldFR5cGVOYW1lKGFzdC5uZXdTaW1wbGVOYW1lKCJDIikpOworCQlzaW1wbGVU
eXBlLmFubm90YXRpb25zKCkuYWRkKGFubm90YXRpb25DKTsKKwkJbmV3TWV0aG9kRGVjbGFyYXRp
b24uc2V0TmFtZShtZXRob2ROYW1lKTsKKwkJbmV3TWV0aG9kRGVjbGFyYXRpb24uc2V0UmVjZWl2
ZXJUeXBlKHNpbXBsZVR5cGUpOworCisJCU1ldGhvZERlY2xhcmF0aW9uW10gbWV0aG9kcyA9IHR5
cGUuZ2V0TWV0aG9kcygpOworCQlNZXRob2REZWNsYXJhdGlvbiBtZXRob2REZWNsYXJhdGlvbiA9
IG1ldGhvZHNbMF07CisJCW1ldGhvZERlY2xhcmF0aW9uLnNldFJlY2VpdmVyVHlwZShhc3QubmV3
U2ltcGxlVHlwZShhc3QKKwkJCQkubmV3U2ltcGxlTmFtZSgiRSIpKSk7CisKKwkJTGlzdFJld3Jp
dGUgbGlzdFJld3JpdGUgPSByZXdyaXRlLmdldExpc3RSZXdyaXRlKHR5cGUsCisJCQkJVHlwZURl
Y2xhcmF0aW9uLkJPRFlfREVDTEFSQVRJT05TX1BST1BFUlRZKTsKKwkJbGlzdFJld3JpdGUuaW5z
ZXJ0TGFzdChuZXdNZXRob2REZWNsYXJhdGlvbiwgbnVsbCk7CisKKwkJU3RyaW5nIHByZXZpZXcg
PSBldmFsdWF0ZVJld3JpdGUoY3UsIHJld3JpdGUpOworCisJCWJ1ZiA9IG5ldyBTdHJpbmdCdWZm
ZXIoKTsKKwkJYnVmLmFwcGVuZCgicGFja2FnZSB0ZXN0MTtcbiIpOworCQlidWYuYXBwZW5kKCJw
dWJsaWMgYWJzdHJhY3QgY2xhc3MgRSB7XG4iKTsKKwkJYnVmLmFwcGVuZCgiICAgIHB1YmxpYyB2
b2lkIGZvbygpIHtcbiIpOworCQlidWYuYXBwZW5kKCIgICAgfVxuIik7CisJCWJ1Zi5hcHBlbmQo
IlxuIik7CisJCWJ1Zi5hcHBlbmQoIiAgICB2b2lkIGJhcihAQyBFIHRoaXMpO1xuIik7CisJCWJ1
Zi5hcHBlbmQoIlxuIik7CisJCWJ1Zi5hcHBlbmQoIn1cbiIpOworCisJCWFzc2VydEVxdWFsU3Ry
aW5nKHByZXZpZXcsIGJ1Zi50b1N0cmluZygpKTsKKwl9CisJCisJcHVibGljIHZvaWQgdGVzdFJl
Y2VpdmVyUGFyYW1fSW5uZXJDbGFzc19zaW5jZV84KCkgdGhyb3dzIEV4Y2VwdGlvbiB7CisJCUlQ
YWNrYWdlRnJhZ21lbnQgcGFjazEgPSB0aGlzLnNvdXJjZUZvbGRlci5jcmVhdGVQYWNrYWdlRnJh
Z21lbnQoCisJCQkJInRlc3QxIiwgZmFsc2UsIG51bGwpOworCQlTdHJpbmdCdWZmZXIgYnVmID0g
bmV3IFN0cmluZ0J1ZmZlcigpOworCQlidWYuYXBwZW5kKCJwYWNrYWdlIHRlc3QxO1xuIik7CisJ
CWJ1Zi5hcHBlbmQoInB1YmxpYyBjbGFzcyBFIHtcbiIpOworCQlidWYuYXBwZW5kKCIgICAgcHVi
bGljIHZvaWQgZm9vKCkge1xuIik7CisJCWJ1Zi5hcHBlbmQoIiAgICB9XG4iKTsKKwkJYnVmLmFw
cGVuZCgiXG4iKTsKKwkJYnVmLmFwcGVuZCgiY2xhc3MgSW5uZXJ7XG5cbiIpOworCQlidWYuYXBw
ZW5kKCJ9XG4iKTsKKwkJYnVmLmFwcGVuZCgifVxuIik7CisJCUlDb21waWxhdGlvblVuaXQgY3Ug
PSBwYWNrMS5jcmVhdGVDb21waWxhdGlvblVuaXQoIkUuamF2YSIsCisJCQkJYnVmLnRvU3RyaW5n
KCksIGZhbHNlLCBudWxsKTsKKworCQlDb21waWxhdGlvblVuaXQgYXN0Um9vdCA9IGNyZWF0ZUFT
VChjdSk7CisJCUFTVCBhc3QgPSBhc3RSb290LmdldEFTVCgpOworCQlBU1RSZXdyaXRlIHJld3Jp
dGUgPSBBU1RSZXdyaXRlLmNyZWF0ZShhc3RSb290LmdldEFTVCgpKTsKKwkJVHlwZURlY2xhcmF0
aW9uIHR5cGUgPSBmaW5kVHlwZURlY2xhcmF0aW9uKGFzdFJvb3QsICJFIik7CisJCVR5cGVEZWNs
YXJhdGlvbiBpbm5lciA9IG51bGw7CisJCUxpc3QgYm9keURlY2xhcmF0aW9ucyA9IHR5cGUuYm9k
eURlY2xhcmF0aW9ucygpOworCQlmb3IgKEl0ZXJhdG9yIGl0ZXJhdG9yID0gYm9keURlY2xhcmF0
aW9ucy5pdGVyYXRvcigpOyBpdGVyYXRvcgorCQkJCS5oYXNOZXh0KCk7KSB7CisJCQlPYmplY3Qg
b2JqZWN0ID0gaXRlcmF0b3IubmV4dCgpOworCQkJaWYgKG9iamVjdCBpbnN0YW5jZW9mIFR5cGVE
ZWNsYXJhdGlvbikgeworCQkJCWlubmVyID0gKFR5cGVEZWNsYXJhdGlvbikgb2JqZWN0OworCQkJ
fQorCisJCX0KKwkJTWV0aG9kRGVjbGFyYXRpb24gbmV3TWV0aG9kRGVjbGFyYXRpb24gPSBhc3Qu
bmV3TWV0aG9kRGVjbGFyYXRpb24oKTsKKwkJU2ltcGxlTmFtZSBtZXRob2ROYW1lID0gYXN0Lm5l
d1NpbXBsZU5hbWUoIklubmVyIik7CisJCVNpbXBsZVR5cGUgc2ltcGxlVHlwZSA9IGFzdC5uZXdT
aW1wbGVUeXBlKGFzdC5uZXdTaW1wbGVOYW1lKCJFIikpOworCQlNYXJrZXJBbm5vdGF0aW9uIGFu
bm90YXRpb25DID0gYXN0Lm5ld01hcmtlckFubm90YXRpb24oKTsKKwkJYW5ub3RhdGlvbkMuc2V0
VHlwZU5hbWUoYXN0Lm5ld1NpbXBsZU5hbWUoIkMiKSk7CisJCXNpbXBsZVR5cGUuYW5ub3RhdGlv
bnMoKS5hZGQoYW5ub3RhdGlvbkMpOworCQluZXdNZXRob2REZWNsYXJhdGlvbi5zZXROYW1lKG1l
dGhvZE5hbWUpOworCQluZXdNZXRob2REZWNsYXJhdGlvbi5zZXRDb25zdHJ1Y3Rvcih0cnVlKTsK
KwkJbmV3TWV0aG9kRGVjbGFyYXRpb24uc2V0UmVjZWl2ZXJUeXBlKHNpbXBsZVR5cGUpOworCQlu
ZXdNZXRob2REZWNsYXJhdGlvbi5zZXRSZWNlaXZlclF1YWxpZmllcihhc3QubmV3U2ltcGxlTmFt
ZSgiRSIpKTsKKwkJbmV3TWV0aG9kRGVjbGFyYXRpb24uc2V0Qm9keShhc3QubmV3QmxvY2soKSk7
CisKKwkJTGlzdFJld3JpdGUgbGlzdFJld3JpdGUgPSByZXdyaXRlLmdldExpc3RSZXdyaXRlKGlu
bmVyLAorCQkJCVR5cGVEZWNsYXJhdGlvbi5CT0RZX0RFQ0xBUkFUSU9OU19QUk9QRVJUWSk7CisJ
CWxpc3RSZXdyaXRlLmluc2VydExhc3QobmV3TWV0aG9kRGVjbGFyYXRpb24sIG51bGwpOworCisJ
CVN0cmluZyBwcmV2aWV3ID0gZXZhbHVhdGVSZXdyaXRlKGN1LCByZXdyaXRlKTsKKworCQlidWYg
PSBuZXcgU3RyaW5nQnVmZmVyKCk7CisJCWJ1Zi5hcHBlbmQoInBhY2thZ2UgdGVzdDE7XG4iKTsK
KwkJYnVmLmFwcGVuZCgicHVibGljIGNsYXNzIEUge1xuIik7CisJCWJ1Zi5hcHBlbmQoIiAgICBw
dWJsaWMgdm9pZCBmb28oKSB7XG4iKTsKKwkJYnVmLmFwcGVuZCgiICAgIH1cbiIpOworCQlidWYu
YXBwZW5kKCJcbiIpOworCQlidWYuYXBwZW5kKCJjbGFzcyBJbm5lcntcblxuIik7CisJCWJ1Zi5h
cHBlbmQoIiAgICBJbm5lcihAQyBFIEUudGhpcykge1xuIik7CisJCWJ1Zi5hcHBlbmQoIiAgICB9
XG5cbiIpOworCQlidWYuYXBwZW5kKCJ9XG4iKTsKKwkJYnVmLmFwcGVuZCgifVxuIik7CisKKwkJ
YXNzZXJ0RXF1YWxTdHJpbmcocHJldmlldywgYnVmLnRvU3RyaW5nKCkpOworCX0KKwkKIH0=
</data>

          </attachment>
      

    </bug>

</bugzilla>