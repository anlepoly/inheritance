<?xml version="1.0" encoding="UTF-8" standalone="yes" ?>
<!DOCTYPE bugzilla SYSTEM "https://bugs.eclipse.org/bugs/page.cgi?id=bugzilla.dtd">

<bugzilla version="4.4.7"
          urlbase="https://bugs.eclipse.org/bugs/"
          
          maintainer="webmaster@eclipse.org"
>

    <bug>
          <bug_id>400745</bug_id>
          
          <creation_ts>2013-02-13 17:58:00 -0500</creation_ts>
          <short_desc>[1.8][compiler] Compiler incorrectly allows shadowing of local class names.</short_desc>
          <delta_ts>2013-02-14 02:29:48 -0500</delta_ts>
          <reporter_accessible>1</reporter_accessible>
          <cclist_accessible>1</cclist_accessible>
          <classification_id>2</classification_id>
          <classification>Eclipse</classification>
          <product>JDT</product>
          <component>Core</component>
          <version>4.3</version>
          <rep_platform>PC</rep_platform>
          <op_sys>Windows 7</op_sys>
          <bug_status>RESOLVED</bug_status>
          <resolution>FIXED</resolution>
          
          
          <bug_file_loc></bug_file_loc>
          <status_whiteboard></status_whiteboard>
          <keywords></keywords>
          <priority>P3</priority>
          <bug_severity>normal</bug_severity>
          <target_milestone>BETA J8</target_milestone>
          
          <blocked>382701</blocked>
          <everconfirmed>1</everconfirmed>
          <reporter name="Srikanth Sankaran">srikanth_sankaran</reporter>
          <assigned_to name="Manoj Palat Away Until May 11 2015">manpalat</assigned_to>
          <cc>manpalat</cc>
          
          <votes>0</votes>

      

      

      <flag name="review"
          id="55601"
          type_id="1"
          status="?"
          setter="manpalat"
          requestee="srikanth_sankaran"
    />

          <comment_sort_order>oldest_to_newest</comment_sort_order>  
          <long_desc isprivate="0" >
    <commentid>2216503</commentid>
    <comment_count>0</comment_count>
    <who name="Srikanth Sankaran">srikanth_sankaran</who>
    <bug_when>2013-02-13 17:58:40 -0500</bug_when>
    <thetext>BETA_JAVA8:

Amends to JLS7 read:

&quot;It is a compile-time error if the name of a local class C is used to declare a new local class within the scope of C, unless the new local class is declared in the body of C or within another class whose declaration is within the scope of C.&quot;

So the following program should be rejected, but is not.

// --------
interface I {
	void foo();
}

public class X {
	void foo() {
		class Y {};
		I i = ()  -&gt; {
			class Y {};
		};
	}	
}
 
// ---

javac complains: 

X.java:9: error: class Y is already defined in method foo()
                        class Y {};
                        ^
1 error</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>2216555</commentid>
    <comment_count>1</comment_count>
    <who name="Srikanth Sankaran">srikanth_sankaran</who>
    <bug_when>2013-02-14 00:08:51 -0500</bug_when>
    <thetext>Manoj, thanks for looking into this.</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>2216557</commentid>
    <comment_count>2</comment_count>
      <attachid>227056</attachid>
    <who name="Manoj Palat Away Until May 11 2015">manpalat</who>
    <bug_when>2013-02-14 00:31:25 -0500</bug_when>
    <thetext>Created attachment 227056
Proposed Patch</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>2216581</commentid>
    <comment_count>3</comment_count>
    <who name="Srikanth Sankaran">srikanth_sankaran</who>
    <bug_when>2013-02-14 02:29:48 -0500</bug_when>
    <thetext>Released fix and tests here: http://git.eclipse.org/c/jdt/eclipse.jdt.core.git/commit/?h=BETA_JAVA8&amp;id=a1761e4448ca9b0394806aae37f349b5bdd250df

after adding one more test, mentioning bug number &amp; title in test
(always required, the earlier discussion about avoiding bug links
is for code and not tests), fixing bug comment post copy + paste.

Thanks Manoj.

While testing I found a pre-existing issue and raised:
https://bugs.eclipse.org/bugs/show_bug.cgi?id=400763</thetext>
  </long_desc>
      
          <attachment
              isobsolete="0"
              ispatch="1"
              isprivate="0"
          >
            <attachid>227056</attachid>
            <date>2013-02-14 00:31:00 -0500</date>
            <delta_ts>2013-02-14 00:31:25 -0500</delta_ts>
            <desc>Proposed Patch</desc>
            <filename>Fix-for-Bug-400745--18compiler-Compiler-incorrectly-.patch</filename>
            <type>text/plain</type>
            <size>2131</size>
            <attacher name="Manoj Palat Away Until May 11 2015">manpalat</attacher>
            
              <data encoding="base64">ZGlmZiAtLWdpdCBhL29yZy5lY2xpcHNlLmpkdC5jb3JlLnRlc3RzLmNvbXBpbGVyL3NyYy9vcmcv
ZWNsaXBzZS9qZHQvY29yZS90ZXN0cy9jb21waWxlci9yZWdyZXNzaW9uL05lZ2F0aXZlTGFtYmRh
RXhwcmVzc2lvbnNUZXN0LmphdmEgYi9vcmcuZWNsaXBzZS5qZHQuY29yZS50ZXN0cy5jb21waWxl
ci9zcmMvb3JnL2VjbGlwc2UvamR0L2NvcmUvdGVzdHMvY29tcGlsZXIvcmVncmVzc2lvbi9OZWdh
dGl2ZUxhbWJkYUV4cHJlc3Npb25zVGVzdC5qYXZhCmluZGV4IDRmYmVlZjQuLjc3NzM4ZjYgMTAw
NjQ0Ci0tLSBhL29yZy5lY2xpcHNlLmpkdC5jb3JlLnRlc3RzLmNvbXBpbGVyL3NyYy9vcmcvZWNs
aXBzZS9qZHQvY29yZS90ZXN0cy9jb21waWxlci9yZWdyZXNzaW9uL05lZ2F0aXZlTGFtYmRhRXhw
cmVzc2lvbnNUZXN0LmphdmEKKysrIGIvb3JnLmVjbGlwc2UuamR0LmNvcmUudGVzdHMuY29tcGls
ZXIvc3JjL29yZy9lY2xpcHNlL2pkdC9jb3JlL3Rlc3RzL2NvbXBpbGVyL3JlZ3Jlc3Npb24vTmVn
YXRpdmVMYW1iZGFFeHByZXNzaW9uc1Rlc3QuamF2YQpAQCAtMzMxOCw2ICszMzE4LDMxIEBACiAJ
KTsKIH0KIAorcHVibGljIHZvaWQgdGVzdDQwMDc0NSgpIHsKKwkvLyBMYW1iZGEgbG9jYWwgcmVk
ZWxhcmVzIGl0cyBvd24gc2VsZgorCXRoaXMucnVuTmVnYXRpdmVUZXN0KAorCQkJbmV3IFN0cmlu
Z1tdIHsKKwkJCQkJIlguamF2YSIsCisJCQkJCSJpbnRlcmZhY2UgSSB7XG4iICsKKwkJCQkJIgl2
b2lkIGZvbygpO1xuIiArCisJCQkJCSJ9XG4iICsKKwkJCQkJInB1YmxpYyBjbGFzcyBYIHtcbiIg
KworCQkJCQkiCXB1YmxpYyB2b2lkIGZvbygpIHtcbiIgKworCQkJCQkiCQljbGFzcyBZIHt9O1xu
IiArIAorCQkJCQkiCQlJIGkgPSAoKSAgLT4ge1xuIiArCisJCQkJCSIJCQljbGFzcyBZe30gO1xu
IiArCisJCQkJCSIJCX07XG4iICsKKwkJCQkJIgl9XG4iICsJCisJCQkJCSJ9XG4iLAorCQkJfSwK
KwkJCSItLS0tLS0tLS0tXG4iICsgCisJCQkiMS4gRVJST1IgaW4gWC5qYXZhIChhdCBsaW5lIDgp
XG4iICsgCisJCQkiCWNsYXNzIFl7fSA7XG4iICsgCisJCQkiCSAgICAgIF5cbiIgKyAKKwkJCSJE
dXBsaWNhdGUgbmVzdGVkIHR5cGUgWVxuIiArIAorCQkJIi0tLS0tLS0tLS1cbiIpOworfQorCiBw
dWJsaWMgc3RhdGljIENsYXNzIHRlc3RDbGFzcygpIHsKIAlyZXR1cm4gTmVnYXRpdmVMYW1iZGFF
eHByZXNzaW9uc1Rlc3QuY2xhc3M7CiB9CmRpZmYgLS1naXQgYS9vcmcuZWNsaXBzZS5qZHQuY29y
ZS9jb21waWxlci9vcmcvZWNsaXBzZS9qZHQvaW50ZXJuYWwvY29tcGlsZXIvYXN0L1R5cGVEZWNs
YXJhdGlvbi5qYXZhIGIvb3JnLmVjbGlwc2UuamR0LmNvcmUvY29tcGlsZXIvb3JnL2VjbGlwc2Uv
amR0L2ludGVybmFsL2NvbXBpbGVyL2FzdC9UeXBlRGVjbGFyYXRpb24uamF2YQppbmRleCAyZDhk
ZjAwLi43NzJmNTg5IDEwMDY0NAotLS0gYS9vcmcuZWNsaXBzZS5qZHQuY29yZS9jb21waWxlci9v
cmcvZWNsaXBzZS9qZHQvaW50ZXJuYWwvY29tcGlsZXIvYXN0L1R5cGVEZWNsYXJhdGlvbi5qYXZh
CisrKyBiL29yZy5lY2xpcHNlLmpkdC5jb3JlL2NvbXBpbGVyL29yZy9lY2xpcHNlL2pkdC9pbnRl
cm5hbC9jb21waWxlci9hc3QvVHlwZURlY2xhcmF0aW9uLmphdmEKQEAgLTEyNjEsNyArMTI2MSw3
IEBACiAJCQkJCW91dGVyU2NvcGUgPSBvdXRlclNjb3BlLnBhcmVudDsKIAkJCQl9CiAJCQl9IGVs
c2UgaWYgKGV4aXN0aW5nVHlwZSBpbnN0YW5jZW9mIExvY2FsVHlwZUJpbmRpbmcKLQkJCQkJCSYm
ICgoTG9jYWxUeXBlQmluZGluZykgZXhpc3RpbmdUeXBlKS5zY29wZS5tZXRob2RTY29wZSgpID09
IGJsb2NrU2NvcGUubWV0aG9kU2NvcGUoKSkgeworCQkJCQkJJiYgKCgoTG9jYWxUeXBlQmluZGlu
ZykgZXhpc3RpbmdUeXBlKS5zY29wZS5tZXRob2RTY29wZSgpID09IGJsb2NrU2NvcGUubWV0aG9k
U2NvcGUoKSB8fCBibG9ja1Njb3BlLmlzTGFtYmRhU3Vic2NvcGUoKSkpIHsKIAkJCQkJLy8gZHVw
IGluIHNhbWUgbWV0aG9kCiAJCQkJCWJsb2NrU2NvcGUucHJvYmxlbVJlcG9ydGVyKCkuZHVwbGlj
YXRlTmVzdGVkVHlwZSh0aGlzKTsKIAkJCX0gZWxzZSBpZiAoYmxvY2tTY29wZS5pc0RlZmluZWRJ
blR5cGUoZXhpc3RpbmdUeXBlKSkgew==
</data>

          </attachment>
      

    </bug>

</bugzilla>