<?xml version="1.0" encoding="UTF-8" standalone="yes" ?>
<!DOCTYPE bugzilla SYSTEM "https://bugs.eclipse.org/bugs/page.cgi?id=bugzilla.dtd">

<bugzilla version="4.4.7"
          urlbase="https://bugs.eclipse.org/bugs/"
          
          maintainer="webmaster@eclipse.org"
>

    <bug>
          <bug_id>402174</bug_id>
          
          <creation_ts>2013-03-01 13:25:00 -0500</creation_ts>
          <short_desc>[1.8][formatter] Code formatter should understand method and constructor references.</short_desc>
          <delta_ts>2013-03-11 08:16:22 -0400</delta_ts>
          <reporter_accessible>1</reporter_accessible>
          <cclist_accessible>1</cclist_accessible>
          <classification_id>2</classification_id>
          <classification>Eclipse</classification>
          <product>JDT</product>
          <component>Core</component>
          <version>4.3</version>
          <rep_platform>PC</rep_platform>
          <op_sys>Windows 7</op_sys>
          <bug_status>RESOLVED</bug_status>
          <resolution>FIXED</resolution>
          
          
          <bug_file_loc></bug_file_loc>
          <status_whiteboard></status_whiteboard>
          <keywords></keywords>
          <priority>P3</priority>
          <bug_severity>normal</bug_severity>
          <target_milestone>BETA J8</target_milestone>
          
          <blocked>400830</blocked>
          <everconfirmed>1</everconfirmed>
          <reporter name="Srikanth Sankaran">srikanth_sankaran</reporter>
          <assigned_to name="Jesper Moller">jesper</assigned_to>
          <cc>manju656</cc>
    
    <cc>markus_keller</cc>
          
          <votes>0</votes>

      

      

      

          <comment_sort_order>oldest_to_newest</comment_sort_order>  
          <long_desc isprivate="0" >
    <commentid>2224760</commentid>
    <comment_count>0</comment_count>
    <who name="Srikanth Sankaran">srikanth_sankaran</who>
    <bug_when>2013-03-01 13:25:25 -0500</bug_when>
    <thetext>Method and constructor references should be understood by the formatter
and processed properly.</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>2225154</commentid>
    <comment_count>1</comment_count>
    <who name="Jesper Moller">jesper</who>
    <bug_when>2013-03-03 17:01:05 -0500</bug_when>
    <thetext>Srinkanth, I&apos;m ready to submit the patch for this -- would you prefer this as a cumulative patch to the patches in bug 402173 (formatter for lambda), or do you want an independent patch for this.
(Silly me, I&apos;d clumped all of the formatting for 1.8 into one test case, so now I&apos;m picking it apart).</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>2228508</commentid>
    <comment_count>2</comment_count>
    <who name="Srikanth Sankaran">srikanth_sankaran</who>
    <bug_when>2013-03-09 14:31:46 -0500</bug_when>
    <thetext>(In reply to comment #1)
&gt; Srinkanth, I&apos;m ready to submit the patch for this -- would you prefer this
&gt; as a cumulative patch to the patches in bug 402173 (formatter for lambda),
&gt; or do you want an independent patch for this.
&gt; (Silly me, I&apos;d clumped all of the formatting for 1.8 into one test case, so
&gt; now I&apos;m picking it apart).

Sorry, I didn&apos;t see this question earlier. But it is answered by the fact that
the lambda work is released already. If you post a patch for reference expressions
alone, I&apos;ll take it forward.</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>2228696</commentid>
    <comment_count>3</comment_count>
      <attachid>228178</attachid>
    <who name="Srikanth Sankaran">srikanth_sankaran</who>
    <bug_when>2013-03-11 03:38:25 -0400</bug_when>
    <thetext>Created attachment 228178
Format support for method and constructor references

This is extracted from the patch posted by Jesper
(https://bugs.eclipse.org/bugs/attachment.cgi?id=227503) at
https://bugs.eclipse.org/bugs/show_bug.cgi?id=400830.

I did not extract the tests from there since all of the tests
involve 308 annotations.

I&apos;ll add fresh tests to verify the functionality.</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>2228718</commentid>
    <comment_count>4</comment_count>
    <who name="Srikanth Sankaran">srikanth_sankaran</who>
    <bug_when>2013-03-11 04:41:34 -0400</bug_when>
    <thetext>(In reply to comment #3)
&gt; Created attachment 228178 [details]
&gt; Format support for method and constructor references

I made the following changes and released the fix here: http://git.eclipse.org/c/jdt/eclipse.jdt.core.git/commit/?h=BETA_JAVA8&amp;id=c4e062ebcfc48b14b7c36c591e88d44ce5b3b5c0 - Thanks Jesper.
Tests will follow in a separate patch.

(1) Since the posting of the patch at (https://bugs.eclipse.org/bugs/attachment.cgi?id=227503) at
https://bugs.eclipse.org/bugs/show_bug.cgi?id=400830, the fields of
ReferenceExpression have undergone a change. The field method which used
to be a SingleNameReference does not exist any more and has been replaced
with &apos;selector&apos; which a char [] that stores the identifier. Adjusted the
patch accordingly.

(2) The type argument printing code appears to be copied from PSTR/PQTR
processing code - this is incorrect. We should adapt it from formatMessageSend.</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>2228832</commentid>
    <comment_count>5</comment_count>
    <who name="Srikanth Sankaran">srikanth_sankaran</who>
    <bug_when>2013-03-11 08:16:22 -0400</bug_when>
    <thetext>Tests released here: http://git.eclipse.org/c/jdt/eclipse.jdt.core.git/commit/?h=BETA_JAVA8&amp;id=4da206fbf61a10e973b62f504ebc9e4e8671589b

Thanks Jesper. Please include the tests that combine 335 and 308 as part of
type annotations formatting work.</thetext>
  </long_desc>
      
          <attachment
              isobsolete="0"
              ispatch="1"
              isprivate="0"
          >
            <attachid>228178</attachid>
            <date>2013-03-11 03:38:00 -0400</date>
            <delta_ts>2013-03-11 03:38:25 -0400</delta_ts>
            <desc>Format support for method and constructor references</desc>
            <filename>ReferenceExpressions-formatting-support.patch</filename>
            <type>text/plain</type>
            <size>2721</size>
            <attacher name="Srikanth Sankaran">srikanth_sankaran</attacher>
            
              <data encoding="base64">ZGlmZiAtLWdpdCBhL29yZy5lY2xpcHNlLmpkdC5jb3JlL2Zvcm1hdHRlci9vcmcvZWNsaXBzZS9q
ZHQvaW50ZXJuYWwvZm9ybWF0dGVyL0NvZGVGb3JtYXR0ZXJWaXNpdG9yLmphdmEgYi9vcmcuZWNs
aXBzZS5qZHQuY29yZS9mb3JtYXR0ZXIvb3JnL2VjbGlwc2UvamR0L2ludGVybmFsL2Zvcm1hdHRl
ci9Db2RlRm9ybWF0dGVyVmlzaXRvci5qYXZhCmluZGV4IDE5YjgzODcuLmEwNmUxMjkgMTAwNjQ0
Ci0tLSBhL29yZy5lY2xpcHNlLmpkdC5jb3JlL2Zvcm1hdHRlci9vcmcvZWNsaXBzZS9qZHQvaW50
ZXJuYWwvZm9ybWF0dGVyL0NvZGVGb3JtYXR0ZXJWaXNpdG9yLmphdmEKKysrIGIvb3JnLmVjbGlw
c2UuamR0LmNvcmUvZm9ybWF0dGVyL29yZy9lY2xpcHNlL2pkdC9pbnRlcm5hbC9mb3JtYXR0ZXIv
Q29kZUZvcm1hdHRlclZpc2l0b3IuamF2YQpAQCAtNTExNCw2ICs1MTE0LDQ0IEBACiAJfQogCiAJ
LyoqCisJICogQHNlZSBvcmcuZWNsaXBzZS5qZHQuaW50ZXJuYWwuY29tcGlsZXIuQVNUVmlzaXRv
ciN2aXNpdChvcmcuZWNsaXBzZS5qZHQuaW50ZXJuYWwuY29tcGlsZXIuYXN0LlJlZmVyZW5jZUV4
cHJlc3Npb24sIG9yZy5lY2xpcHNlLmpkdC5pbnRlcm5hbC5jb21waWxlci5sb29rdXAuQmxvY2tT
Y29wZSkKKwkgKi8KKwlwdWJsaWMgYm9vbGVhbiB2aXNpdChvcmcuZWNsaXBzZS5qZHQuaW50ZXJu
YWwuY29tcGlsZXIuYXN0LlJlZmVyZW5jZUV4cHJlc3Npb24gcmVmZXJlbmNlRXhwcmVzc2lvbiwg
QmxvY2tTY29wZSBibG9ja1Njb3BlKSB7CisJCXJlZmVyZW5jZUV4cHJlc3Npb24ubGhzLnRyYXZl
cnNlKHRoaXMsIGJsb2NrU2NvcGUpOworCQl0aGlzLnNjcmliZS5wcmludE5leHRUb2tlbihUZXJt
aW5hbFRva2Vucy5Ub2tlbk5hbWVDT0xPTl9DT0xPTik7CisJCQorCQlUeXBlUmVmZXJlbmNlW10g
dHlwZUFyZ3VtZW50cyA9IHJlZmVyZW5jZUV4cHJlc3Npb24udHlwZUFyZ3VtZW50czsKKwkJaW50
IHR5cGVBcmd1bWVudHNMZW5ndGggPSB0eXBlQXJndW1lbnRzICE9IG51bGwgPyB0eXBlQXJndW1l
bnRzLmxlbmd0aCA6IDA7CisJCWlmICh0eXBlQXJndW1lbnRzTGVuZ3RoID4gMCkgeworCQkJdGhp
cy5zY3JpYmUucHJpbnROZXh0VG9rZW4oVGVybWluYWxUb2tlbnMuVG9rZW5OYW1lTEVTUywgdGhp
cy5wcmVmZXJlbmNlcy5pbnNlcnRfc3BhY2VfYmVmb3JlX29wZW5pbmdfYW5nbGVfYnJhY2tldF9p
bl9wYXJhbWV0ZXJpemVkX3R5cGVfcmVmZXJlbmNlKTsKKwkJCWlmICh0aGlzLnByZWZlcmVuY2Vz
Lmluc2VydF9zcGFjZV9hZnRlcl9vcGVuaW5nX2FuZ2xlX2JyYWNrZXRfaW5fcGFyYW1ldGVyaXpl
ZF90eXBlX3JlZmVyZW5jZSkgeworCQkJCXRoaXMuc2NyaWJlLnNwYWNlKCk7CisJCQl9CisJCQlm
b3IgKGludCBpID0gMDsgaSA8IHR5cGVBcmd1bWVudHNMZW5ndGggLSAxOyBpKyspIHsKKwkJCQl0
eXBlQXJndW1lbnRzW2ldLnRyYXZlcnNlKHRoaXMsIGJsb2NrU2NvcGUpOworCQkJCXRoaXMuc2Ny
aWJlLnByaW50TmV4dFRva2VuKFRlcm1pbmFsVG9rZW5zLlRva2VuTmFtZUNPTU1BLCB0aGlzLnBy
ZWZlcmVuY2VzLmluc2VydF9zcGFjZV9iZWZvcmVfY29tbWFfaW5fcGFyYW1ldGVyaXplZF90eXBl
X3JlZmVyZW5jZSk7CisJCQkJaWYgKHRoaXMucHJlZmVyZW5jZXMuaW5zZXJ0X3NwYWNlX2FmdGVy
X2NvbW1hX2luX3BhcmFtZXRlcml6ZWRfdHlwZV9yZWZlcmVuY2UpIHsKKwkJCQkJdGhpcy5zY3Jp
YmUuc3BhY2UoKTsKKwkJCQl9CisJCQl9CisJCQl0eXBlQXJndW1lbnRzW3R5cGVBcmd1bWVudHNM
ZW5ndGggLSAxXS50cmF2ZXJzZSh0aGlzLCBibG9ja1Njb3BlKTsKKwkJCWlmIChpc0Nsb3NpbmdH
ZW5lcmljVG9rZW4oKSkgeworCQkJCXRoaXMuc2NyaWJlLnByaW50TmV4dFRva2VuKENMT1NJTkdf
R0VORVJJQ1NfRVhQRUNURURUT0tFTlMsIHRoaXMucHJlZmVyZW5jZXMuaW5zZXJ0X3NwYWNlX2Jl
Zm9yZV9jbG9zaW5nX2FuZ2xlX2JyYWNrZXRfaW5fcGFyYW1ldGVyaXplZF90eXBlX3JlZmVyZW5j
ZSk7CisJCQl9CisvLwkJfSBlbHNlIHsKKy8vCQkJdGhpcy5zY3JpYmUucHJpbnROZXh0VG9rZW4o
VGVybWluYWxUb2tlbnMuVG9rZW5OYW1lTEVTUywgdGhpcy5wcmVmZXJlbmNlcy5pbnNlcnRfc3Bh
Y2VfYmVmb3JlX29wZW5pbmdfYW5nbGVfYnJhY2tldF9pbl9wYXJhbWV0ZXJpemVkX3R5cGVfcmVm
ZXJlbmNlKTsKKy8vCQkJdGhpcy5zY3JpYmUucHJpbnROZXh0VG9rZW4oQ0xPU0lOR19HRU5FUklD
U19FWFBFQ1RFRFRPS0VOUyk7CisJCX0KKworCQlpZiAocmVmZXJlbmNlRXhwcmVzc2lvbi5pc0Nv
bnN0cnVjdG9yUmVmZXJlbmNlKCkpIHsKKwkJCXRoaXMuc2NyaWJlLnByaW50TmV4dFRva2VuKFRl
cm1pbmFsVG9rZW5zLlRva2VuTmFtZW5ldyk7CisJCX0gZWxzZSB7CisJCQlyZWZlcmVuY2VFeHBy
ZXNzaW9uLm1ldGhvZC50cmF2ZXJzZSh0aGlzLCBibG9ja1Njb3BlKTsKKwkJfQorCQlyZXR1cm4g
ZmFsc2U7CisJfQorCQorCS8qKgogCSAqIEBzZWUgb3JnLmVjbGlwc2UuamR0LmludGVybmFsLmNv
bXBpbGVyLkFTVFZpc2l0b3IjdmlzaXQob3JnLmVjbGlwc2UuamR0LmludGVybmFsLmNvbXBpbGVy
LmFzdC5SZXR1cm5TdGF0ZW1lbnQsIG9yZy5lY2xpcHNlLmpkdC5pbnRlcm5hbC5jb21waWxlci5s
b29rdXAuQmxvY2tTY29wZSkKIAkgKi8KIAlwdWJsaWMgYm9vbGVhbiB2aXNpdChSZXR1cm5TdGF0
ZW1lbnQgcmV0dXJuU3RhdGVtZW50LCBCbG9ja1Njb3BlIHNjb3BlKSB7
</data>

          </attachment>
      

    </bug>

</bugzilla>