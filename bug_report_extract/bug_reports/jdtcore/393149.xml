<?xml version="1.0" encoding="UTF-8" standalone="yes" ?>
<!DOCTYPE bugzilla SYSTEM "https://bugs.eclipse.org/bugs/page.cgi?id=bugzilla.dtd">

<bugzilla version="4.4.7"
          urlbase="https://bugs.eclipse.org/bugs/"
          
          maintainer="webmaster@eclipse.org"
>

    <bug>
          <bug_id>393149</bug_id>
          
          <creation_ts>2012-10-30 10:07:00 -0400</creation_ts>
          <short_desc>Test failures on Mac</short_desc>
          <delta_ts>2012-12-12 01:35:53 -0500</delta_ts>
          <reporter_accessible>1</reporter_accessible>
          <cclist_accessible>1</cclist_accessible>
          <classification_id>2</classification_id>
          <classification>Eclipse</classification>
          <product>JDT</product>
          <component>Core</component>
          <version>3.8</version>
          <rep_platform>Macintosh</rep_platform>
          <op_sys>Mac OS X</op_sys>
          <bug_status>VERIFIED</bug_status>
          <resolution>WORKSFORME</resolution>
          
          
          <bug_file_loc></bug_file_loc>
          <status_whiteboard></status_whiteboard>
          <keywords></keywords>
          <priority>P4</priority>
          <bug_severity>normal</bug_severity>
          <target_milestone>4.3 M4</target_milestone>
          
          
          <everconfirmed>1</everconfirmed>
          <reporter name="Jay Arthanareeswaran">jarthana</reporter>
          <assigned_to name="Stephan Herrmann">stephan.herrmann</assigned_to>
          <cc>anchakrk</cc>
    
    <cc>cwindatt</cc>
    
    <cc>daniel_megert</cc>
    
    <cc>jarthana</cc>
    
    <cc>markus_keller</cc>
    
    <cc>Michael_Rennie</cc>
    
    <cc>stephan.herrmann</cc>
          
          <votes>0</votes>

      

      

      

          <comment_sort_order>oldest_to_newest</comment_sort_order>  
          <long_desc isprivate="0" >
    <commentid>2177443</commentid>
    <comment_count>0</comment_count>
    <who name="Jay Arthanareeswaran">jarthana</who>
    <bug_when>2012-10-30 10:07:28 -0400</bug_when>
    <thetext>There are about 23 failures with the recent build on the Mac environment. The test results can be accessed here:

http://download.eclipse.org/eclipse/downloads/drops4/I20121029-2000/testresults/html/org.eclipse.jdt.core.tests.compiler_macosx.cocoa.x86_5.0.html

Apparently we have had successful builds with the same HEAD earlier. This needs to be investigated.</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>2177448</commentid>
    <comment_count>1</comment_count>
    <who name="Stephan Herrmann">stephan.herrmann</who>
    <bug_when>2012-10-30 10:13:58 -0400</bug_when>
    <thetext>See also bug 344633 comment 4.</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>2177455</commentid>
    <comment_count>2</comment_count>
    <who name="Curtis Windatt">cwindatt</who>
    <bug_when>2012-10-30 10:21:58 -0400</bug_when>
    <thetext>With the fix for bug 344633 the default JRE path chosen by the PDE launch configurations may be different.  Rather than defaulting to the workspace default, it tries to determine what EE environment matches the bundles being launched.  If the tests depend on being run in a certain JRE that may be the cause of the failures.</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>2177477</commentid>
    <comment_count>3</comment_count>
    <who name="Markus Keller">markus_keller</who>
    <bug_when>2012-10-30 10:44:28 -0400</bug_when>
    <thetext>When I just run AnnotationTest on my Mac (OS X 10.8.2, Oracle JDK 1.7.0_09), then all tests are green in I20121029-2000 + jdt.core/ui/etc. from master.

Same if I launch with the Apple JRE 1.6.0_37.

I can do further experiments if you have an idea where the problem could be.</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>2177553</commentid>
    <comment_count>4</comment_count>
    <who name="Michael Rennie">Michael_Rennie</who>
    <bug_when>2012-10-30 12:23:27 -0400</bug_when>
    <thetext>(In reply to comment #3)
&gt; When I just run AnnotationTest on my Mac (OS X 10.8.2, Oracle JDK 1.7.0_09),
&gt; then all tests are green in I20121029-2000 + jdt.core/ui/etc. from master.
&gt; 
&gt; Same if I launch with the Apple JRE 1.6.0_37.
&gt; 
&gt; I can do further experiments if you have an idea where the problem could be.

I also ran the tests using 10.8.2 with I20121030-0800 using 1.6 update 37 and 1.7.0 update 5 /9 and also did not get any failures locally. I only had the tests as source in my workspace, jdt.core / ui from the target platform.</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>2177557</commentid>
    <comment_count>5</comment_count>
    <who name="Stephan Herrmann">stephan.herrmann</who>
    <bug_when>2012-10-30 12:26:19 -0400</bug_when>
    <thetext>Doesn&apos;t the change in bug 344633 imply that tests are now run on a 1.4 JRE?
At least that&apos;s what the BREE of the test plug-in says.
Does anyone have such a JRE on Mac for testing?</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>2177559</commentid>
    <comment_count>6</comment_count>
    <who name="Stephan Herrmann">stephan.herrmann</who>
    <bug_when>2012-10-30 12:29:01 -0400</bug_when>
    <thetext>(In reply to comment #5)
&gt; Doesn&apos;t the change in bug 344633 imply that tests are now run on a 1.4 JRE?
&gt; At least that&apos;s what the BREE of the test plug-in says.
&gt; Does anyone have such a JRE on Mac for testing?

Reading again what I just wrote: the failures involve Java5 features, so specifying J2SE-1.4 as the test&apos;s BREE would imply we run Java5+ tests on 1.4??? That can&apos;t work.</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>2177560</commentid>
    <comment_count>7</comment_count>
    <who name="Stephan Herrmann">stephan.herrmann</who>
    <bug_when>2012-10-30 12:33:15 -0400</bug_when>
    <thetext>If my assumption in comment 6 is correct, the long term solution would have to follow the lines of bug 390889 comment 4 item E.

Indication against my theory: why did the tests only fail on Mac?</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>2177565</commentid>
    <comment_count>8</comment_count>
    <who name="Curtis Windatt">cwindatt</who>
    <bug_when>2012-10-30 12:36:26 -0400</bug_when>
    <thetext>(In reply to comment #6)
&gt; Reading again what I just wrote: the failures involve Java5 features, so
&gt; specifying J2SE-1.4 as the test&apos;s BREE would imply we run Java5+ tests on
&gt; 1.4??? That can&apos;t work.

The EE chosen is based on the BREE of all plug-ins being launched, not just the test plug-in.  Also, prior to the PDE change, we would grab the JRE from on the project&apos;s classpath, which might be 1.4 if the project&apos;s BREE is 1.4.</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>2177567</commentid>
    <comment_count>9</comment_count>
    <who name="Markus Keller">markus_keller</who>
    <bug_when>2012-10-30 12:39:21 -0400</bug_when>
    <thetext>I don&apos;t know exactly what the test does, but I think the fastest way forward is to sysout more information about the VM that is supposed to run the tests. Then we see in the next build what exactly happens on the test machine.

Re 1.4 on the Mac: No, there&apos;s no 1.4 JRE on the Mac. There&apos;s not even a 1.5 for modern hardware/OS combinations.</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>2177569</commentid>
    <comment_count>10</comment_count>
    <who name="Markus Keller">markus_keller</who>
    <bug_when>2012-10-30 12:40:48 -0400</bug_when>
    <thetext>&gt; the VM that is supposed to run the tests.
The VM that is launched by the tests, I meant.</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>2177677</commentid>
    <comment_count>11</comment_count>
    <who name="Stephan Herrmann">stephan.herrmann</who>
    <bug_when>2012-10-30 14:57:44 -0400</bug_when>
    <thetext>(In reply to comment #9)
&gt; I don&apos;t know exactly what the test does, but I think the fastest way forward
&gt; is to sysout more information about the VM that is supposed to run the
&gt; tests. Then we see in the next build what exactly happens on the test
&gt; machine.

We already have such sysout (disabled) inside org.eclipse.jdt.core.tests.runtime.LocalVMLauncher

I temporarily enabled this via commit 9ac7b033b88e9b6fb0227420e6488d01306c7854

Should this go into the integration branch, too? Who?</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>2177707</commentid>
    <comment_count>12</comment_count>
    <who name="Markus Keller">markus_keller</who>
    <bug_when>2012-10-30 15:59:46 -0400</bug_when>
    <thetext>&gt; Should this go into the integration branch, too? Who?

Yes. In the milestone week, there are no N-builds [1]. I&apos;ve pushed the integration branch, so that we can see the results tomorrow. Thanks for the fix.

[1] http://www.eclipse.org/eclipse/platform-releng/buildSchedule.html</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>2177842</commentid>
    <comment_count>13</comment_count>
    <who name="Jay Arthanareeswaran">jarthana</who>
    <bug_when>2012-10-31 04:13:47 -0400</bug_when>
    <thetext>The test results are here and here is the console output with the trouble-shooting output.

http://download.eclipse.org/eclipse/downloads/drops4/I20121030-2000/testresults/macosx.cocoa.x86_5.0/org.eclipse.jdt.core.tests.compiler.regression.TestAll.txt</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>2177855</commentid>
    <comment_count>14</comment_count>
    <who name="Dani Megert">daniel_megert</who>
    <bug_when>2012-10-31 04:53:21 -0400</bug_when>
    <thetext>(In reply to comment #13)
&gt; The test results are here and here is the console output with the
&gt; trouble-shooting output.
&gt; 
&gt; http://download.eclipse.org/eclipse/downloads/drops4/I20121030-2000/
&gt; testresults/macosx.cocoa.x86_5.0/org.eclipse.jdt.core.tests.compiler.
&gt; regression.TestAll.txt

Even more interesting comment would be that the tests passed again in the last two builds ;-).

So, unless this happens again, we can leave this rest in peace.</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>2178082</commentid>
    <comment_count>15</comment_count>
    <who name="Stephan Herrmann">stephan.herrmann</who>
    <bug_when>2012-10-31 11:34:02 -0400</bug_when>
    <thetext>Let me preserve the relevant part of the log before it gets deleted:

  /Library/Java/JavaVirtualMachines/jdk1.7.0_10.jdk

i.e., all tests use a 1.7 JVM, so this can&apos;t be the culprit.

Sorry for suspecting PDE.

Still, I&apos;d like to leave the debug sysout in place for a while, in case the failure happens again.
Setting target milestone to M4 as a reminder to remove the printout again.</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>2190926</commentid>
    <comment_count>16</comment_count>
    <who name="Jay Arthanareeswaran">jarthana</who>
    <bug_when>2012-12-05 09:58:40 -0500</bug_when>
    <thetext>So, the failure didn&apos;t occur again. Stephan, do you think the sysout can be removed now so that the bug can be closed?</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>2191777</commentid>
    <comment_count>17</comment_count>
    <who name="Jay Arthanareeswaran">jarthana</who>
    <bug_when>2012-12-07 05:31:58 -0500</bug_when>
    <thetext>I have removed the troubleshooting code now.</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>2191779</commentid>
    <comment_count>18</comment_count>
    <who name="Jay Arthanareeswaran">jarthana</who>
    <bug_when>2012-12-07 05:38:02 -0500</bug_when>
    <thetext>Sorry, it should not be FIXED.</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>2192179</commentid>
    <comment_count>19</comment_count>
    <who name="Stephan Herrmann">stephan.herrmann</who>
    <bug_when>2012-12-08 13:38:52 -0500</bug_when>
    <thetext>(In reply to comment #17)
&gt; I have removed the troubleshooting code now.

I totally agree, thanks.</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>2193411</commentid>
    <comment_count>20</comment_count>
    <who name="ANIRBAN CHAKRABORTY">anchakrk</who>
    <bug_when>2012-12-12 01:31:06 -0500</bug_when>
    <thetext>Hello,
I verified the MAC regression is coming clean.
4.3 M4 build:I20121211-0800 
Thanks
Anirban</thetext>
  </long_desc>
      
      

    </bug>

</bugzilla>