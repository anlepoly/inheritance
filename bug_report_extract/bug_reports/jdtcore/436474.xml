<?xml version="1.0" encoding="UTF-8" standalone="yes" ?>
<!DOCTYPE bugzilla SYSTEM "https://bugs.eclipse.org/bugs/page.cgi?id=bugzilla.dtd">

<bugzilla version="4.4.7"
          urlbase="https://bugs.eclipse.org/bugs/"
          
          maintainer="webmaster@eclipse.org"
>

    <bug>
          <bug_id>436474</bug_id>
          
          <creation_ts>2014-06-03 11:21:00 -0400</creation_ts>
          <short_desc>[codegen]Problem with varargs and List.toString</short_desc>
          <delta_ts>2014-08-06 01:30:22 -0400</delta_ts>
          <reporter_accessible>1</reporter_accessible>
          <cclist_accessible>1</cclist_accessible>
          <classification_id>2</classification_id>
          <classification>Eclipse</classification>
          <product>JDT</product>
          <component>Core</component>
          <version>3.8.2</version>
          <rep_platform>PC</rep_platform>
          <op_sys>Linux</op_sys>
          <bug_status>VERIFIED</bug_status>
          <resolution>WORKSFORME</resolution>
          
          
          <bug_file_loc></bug_file_loc>
          <status_whiteboard></status_whiteboard>
          <keywords></keywords>
          <priority>P3</priority>
          <bug_severity>normal</bug_severity>
          <target_milestone>4.5 M1</target_milestone>
          
          
          <everconfirmed>1</everconfirmed>
          <reporter name="Andreas Lundblad">andreas.lundblad</reporter>
          <assigned_to name="Sasikanth Bharadwaj">saammana</assigned_to>
          <cc>jarthana</cc>
    
    <cc>manpalat</cc>
    
    <cc>srikanth_sankaran</cc>
    
    <cc>stephan.herrmann</cc>
          
          <votes>0</votes>

      

      

      

          <comment_sort_order>oldest_to_newest</comment_sort_order>  
          <long_desc isprivate="0" >
    <commentid>2412128</commentid>
    <comment_count>0</comment_count>
    <who name="Andreas Lundblad">andreas.lundblad</who>
    <bug_when>2014-06-03 11:21:15 -0400</bug_when>
    <thetext>Eclipse compiler accepts passing List.toArray(new String[0]) to a varargMethod(String... strs) but the emitted bytecode seems to have the wrong signature on the vararg invocation.

$ cat Scratch.java 
import java.util.Arrays;
import java.util.List;

public class Scratch {
    public static void vararg(String... strs) {
    }
    
    public static void main(String[] args) {
        List&lt;String&gt; l = Arrays.asList(&quot;a&quot;);
        vararg(l.toArray(new String[0]));
    }
}

$ java -jar /home/aioobe/misc/eclipse-4.3/plugins/org.eclipse.jdt.core_3.9.2.v20140131-0106_BETA_JAVA8.jar -source 8 -target 8 -classpath /usr/lib/jvm/java-8-oracle/jre/lib/rt.jar Scratch.java 

$ java Scratch
Exception in thread &quot;main&quot; java.lang.NoSuchMethodError: java.util.List.toArray([Ljava/lang/String;)Ljava/lang/String;
	at Scratch.main(Scratch.java:10)</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>2412342</commentid>
    <comment_count>1</comment_count>
    <who name="Stephan Herrmann">stephan.herrmann</who>
    <bug_when>2014-06-03 18:07:30 -0400</bug_when>
    <thetext>I cannot reproduce with any of the ecj versions I have on my disk (and I *am* a collector :) ).

Please re-test with a more recent version.
Version 3.9.2.v20140131-0106_BETA_JAVA8 wasn&apos;t even close to being a release.</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>2412477</commentid>
    <comment_count>2</comment_count>
    <who name="Andreas Lundblad">andreas.lundblad</who>
    <bug_when>2014-06-04 04:31:47 -0400</bug_when>
    <thetext>Ok, I had a recent standard Eclipse IDE installation and activated Java 8 features according to the instructions on http://www.eclipse.org/downloads/java8/ and stumbled across this bug when using the IDE.

Last time I tried to report a bug, I didn&apos;t have a command line reproducer, so I tried to provide that in this report. 3.9.2.v20140131-0106_BETA_JAVA8.jar was the latest version I found when searching my harddrive, so I thought that was somewhat recent.</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>2413839</commentid>
    <comment_count>3</comment_count>
    <who name="Stephan Herrmann">stephan.herrmann</who>
    <bug_when>2014-06-05 17:36:09 -0400</bug_when>
    <thetext>Java 8 support in JDT was first released on March 18, bundle version is P20140317-1600. Anything before that build was strictly &quot;early access&quot;, and I didn&apos;t keep enough builds to be able to reproduce.

So, if you want to stick to Kepler for now, the P20140317-1600 build [1] would be the appropriate point of reference. Otherwise, advanced release candidates for Luna are available so perhaps you may want to check one of those.

[1] see also: http://www.eclipse.org/downloads/index-java8.php</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>2429601</commentid>
    <comment_count>4</comment_count>
    <who name="Srikanth Sankaran">srikanth_sankaran</who>
    <bug_when>2014-07-21 02:03:44 -0400</bug_when>
    <thetext>Sasi, please double check if this is reproducible or not and close accordingly.
TIA.</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>2433932</commentid>
    <comment_count>5</comment_count>
    <who name="Sasikanth Bharadwaj">saammana</who>
    <bug_when>2014-07-31 01:36:31 -0400</bug_when>
    <thetext>This works fine in Luna.</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>2433939</commentid>
    <comment_count>6</comment_count>
    <who name="Srikanth Sankaran">srikanth_sankaran</who>
    <bug_when>2014-07-31 01:57:10 -0400</bug_when>
    <thetext>(In reply to Sasikanth Bharadwaj from comment #5)
&gt; This works fine in Luna.

Please provide a regression test and let us close this one as WORKSFORME.
Thanks Sasi.</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>2434471</commentid>
    <comment_count>7</comment_count>
      <attachid>245626</attachid>
    <who name="Sasikanth Bharadwaj">saammana</who>
    <bug_when>2014-08-01 01:18:06 -0400</bug_when>
    <thetext>Created attachment 245626
Regression test</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>2434472</commentid>
    <comment_count>8</comment_count>
    <who name="Sasikanth Bharadwaj">saammana</who>
    <bug_when>2014-08-01 01:19:42 -0400</bug_when>
    <thetext>My contribution for this defect fix complies with http://www.eclipse.org/legal/CoO.php</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>2434473</commentid>
    <comment_count>9</comment_count>
    <who name="Sasikanth Bharadwaj">saammana</who>
    <bug_when>2014-08-01 01:20:51 -0400</bug_when>
    <thetext>(In reply to comment #6)
&gt; (In reply to Sasikanth Bharadwaj from comment #5)
&gt; &gt; This works fine in Luna.
&gt; 
&gt; Please provide a regression test and let us close this one as WORKSFORME.
&gt; Thanks Sasi.
Attached patch with new test</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>2435021</commentid>
    <comment_count>10</comment_count>
    <who name="Srikanth Sankaran">srikanth_sankaran</who>
    <bug_when>2014-08-04 01:54:01 -0400</bug_when>
    <thetext>Thanks Sasi. Test released here: http://git.eclipse.org/c/jdt/eclipse.jdt.core.git/commit/?id=3b3bb74598b16537e8819313b01884889effdbd2</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>2436069</commentid>
    <comment_count>11</comment_count>
    <who name="Jay Arthanareeswaran">jarthana</who>
    <bug_when>2014-08-06 01:30:22 -0400</bug_when>
    <thetext>Verified for 4.5 M1 with build I20140804-2000</thetext>
  </long_desc>
      
          <attachment
              isobsolete="0"
              ispatch="1"
              isprivate="0"
          >
            <attachid>245626</attachid>
            <date>2014-08-01 01:18:00 -0400</date>
            <delta_ts>2014-08-01 01:18:06 -0400</delta_ts>
            <desc>Regression test</desc>
            <filename>regression_test_436474.patch</filename>
            <type>text/plain</type>
            <size>1354</size>
            <attacher name="Sasikanth Bharadwaj">saammana</attacher>
            
              <data encoding="base64">ZGlmZiAtLWdpdCBhL29yZy5lY2xpcHNlLmpkdC5jb3JlLnRlc3RzLmNvbXBpbGVyL3NyYy9vcmcv
ZWNsaXBzZS9qZHQvY29yZS90ZXN0cy9jb21waWxlci9yZWdyZXNzaW9uL1ZhcmFyZ3NUZXN0Lmph
dmEgYi9vcmcuZWNsaXBzZS5qZHQuY29yZS50ZXN0cy5jb21waWxlci9zcmMvb3JnL2VjbGlwc2Uv
amR0L2NvcmUvdGVzdHMvY29tcGlsZXIvcmVncmVzc2lvbi9WYXJhcmdzVGVzdC5qYXZhCmluZGV4
IDhiNTc5ZTAuLjg2OGNhYTkgMTAwNjQ0Ci0tLSBhL29yZy5lY2xpcHNlLmpkdC5jb3JlLnRlc3Rz
LmNvbXBpbGVyL3NyYy9vcmcvZWNsaXBzZS9qZHQvY29yZS90ZXN0cy9jb21waWxlci9yZWdyZXNz
aW9uL1ZhcmFyZ3NUZXN0LmphdmEKKysrIGIvb3JnLmVjbGlwc2UuamR0LmNvcmUudGVzdHMuY29t
cGlsZXIvc3JjL29yZy9lY2xpcHNlL2pkdC9jb3JlL3Rlc3RzL2NvbXBpbGVyL3JlZ3Jlc3Npb24v
VmFyYXJnc1Rlc3QuamF2YQpAQCAtMzQ2NSw0ICszNDY1LDI0IEBACiAJCQkiVGhlIG1ldGhvZCBm
b28oQS4uLikgb2YgdHlwZSBCIGlzIG5vdCBhcHBsaWNhYmxlIGFzIHRoZSBmb3JtYWwgdmFyYXJn
cyBlbGVtZW50IHR5cGUgQSBpcyBub3QgYWNjZXNzaWJsZSBoZXJlXG4iICsgCiAJCQkiLS0tLS0t
LS0tLVxuIik7IC8vIGNoZWNrIGFuZCBhZGp1c3QsCiAJfQorCS8vIGh0dHBzOi8vYnVncy5lY2xp
cHNlLm9yZy9idWdzL3Nob3dfYnVnLmNnaT9pZD00MzY0NzQsIFtjb2RlZ2VuXVByb2JsZW0gd2l0
aCB2YXJhcmdzIGFuZCBMaXN0LnRvU3RyaW5nCisJcHVibGljIHZvaWQgdGVzdDQzNjQ3NCgpIHsK
KwkJcnVuQ29uZm9ybVRlc3QoCisJCQluZXcgU3RyaW5nW10geworCQkJCSJTY3JhdGNoLmphdmEi
LAorCQkJCSJpbXBvcnQgamF2YS51dGlsLkFycmF5cztcbiIgKyAKKwkJCQkiaW1wb3J0IGphdmEu
dXRpbC5MaXN0O1xuIiArIAorCQkJCSJwdWJsaWMgY2xhc3MgU2NyYXRjaCB7XG4iICsgCisJCQkJ
IiAgICBwdWJsaWMgc3RhdGljIHZvaWQgdmFyYXJnKFN0cmluZy4uLiBzdHJzKSB7XG4iICsgCisJ
CQkJIiAgICAJU3lzdGVtLm91dC5wcmludGxuKHN0cnNbMF0pO1xuIiArIAorCQkJCSIgICAgfVxu
IiArIAorCQkJCSIgICAgXG4iICsgCisJCQkJIiAgICBwdWJsaWMgc3RhdGljIHZvaWQgbWFpbihT
dHJpbmdbXSBhcmdzKSB7XG4iICsgCisJCQkJIiAgICAgICAgTGlzdDxTdHJpbmc+IGwgPSBBcnJh
eXMuYXNMaXN0KFwiYVwiKTtcbiIgKyAKKwkJCQkiICAgICAgICB2YXJhcmcobC50b0FycmF5KG5l
dyBTdHJpbmdbMF0pKTtcbiIgKyAKKwkJCQkiICAgIH1cbiIgKyAKKwkJCQkifSIsCisJCQl9LAor
CQkJImEiKTsKKwl9CiB9ClwgTm8gbmV3bGluZSBhdCBlbmQgb2YgZmlsZQ==
</data>

          </attachment>
      

    </bug>

</bugzilla>