<?xml version="1.0" encoding="UTF-8" standalone="yes" ?>
<!DOCTYPE bugzilla SYSTEM "https://bugs.eclipse.org/bugs/page.cgi?id=bugzilla.dtd">

<bugzilla version="4.4.7"
          urlbase="https://bugs.eclipse.org/bugs/"
          
          maintainer="webmaster@eclipse.org"
>

    <bug>
          <bug_id>420313</bug_id>
          
          <creation_ts>2013-10-24 15:00:00 -0400</creation_ts>
          <short_desc>[null] &quot;Missing non-null annotation&quot; does not show up when base method is generic</short_desc>
          <delta_ts>2014-10-07 17:39:09 -0400</delta_ts>
          <reporter_accessible>1</reporter_accessible>
          <cclist_accessible>1</cclist_accessible>
          <classification_id>2</classification_id>
          <classification>Eclipse</classification>
          <product>JDT</product>
          <component>Core</component>
          <version>4.3.1</version>
          <rep_platform>PC</rep_platform>
          <op_sys>Linux</op_sys>
          <bug_status>ASSIGNED</bug_status>
          <resolution></resolution>
          
          
          <bug_file_loc></bug_file_loc>
          <status_whiteboard></status_whiteboard>
          <keywords></keywords>
          <priority>P3</priority>
          <bug_severity>normal</bug_severity>
          <target_milestone>4.5</target_milestone>
          <dependson>415179</dependson>
          
          <everconfirmed>1</everconfirmed>
          <reporter name="Colin Bartolome">cbartolo</reporter>
          <assigned_to name="Stephan Herrmann">stephan.herrmann</assigned_to>
          <cc>stephan.herrmann</cc>
          
          <votes>1</votes>

      

      

      

          <comment_sort_order>oldest_to_newest</comment_sort_order>  
          <long_desc isprivate="0" >
    <commentid>2322851</commentid>
    <comment_count>0</comment_count>
      <attachid>236856</attachid>
    <who name="Colin Bartolome">cbartolo</who>
    <bug_when>2013-10-24 15:00:59 -0400</bug_when>
    <thetext>Created attachment 236856
Warning went missing

With the &quot;@NonNull parameter not annotated in overriding method&quot; warning turned on, override a method that has a generic type parameter. The warning won&apos;t show up. See the attached code for an example.

This appears to happen even when the generic parameter of the overridden method *isn&apos;t* the one with the @NonNull annotation.</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>2322976</commentid>
    <comment_count>1</comment_count>
    <who name="Stephan Herrmann">stephan.herrmann</who>
    <bug_when>2013-10-24 17:52:45 -0400</bug_when>
    <thetext>Thanks for the report, I can reproduce in 4.3.1 and 4.4M2.

In BETA_JAVA8, however, this seems to be fixed. 
Not sure via which bug.</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>2365195</commentid>
    <comment_count>2</comment_count>
    <who name="Stephan Herrmann">stephan.herrmann</who>
    <bug_when>2014-02-18 18:01:04 -0500</bug_when>
    <thetext>I&apos;ll add regression tests for BETA_JAVA8 to ensure this consistently works moving forward.</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>2366266</commentid>
    <comment_count>3</comment_count>
    <who name="Stephan Herrmann">stephan.herrmann</who>
    <bug_when>2014-02-20 14:26:52 -0500</bug_when>
    <thetext>Correction: 

- 4.3.1 and luna master correctly show the expected warning

- BETA_JAVA8 does show the warning when using type annotations

- BETA_JAVA8 using decl. annotations (o.e.j.annotation_1.1.x) fails to detect the problem.

I could not observe a difference between the two methods, though.</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>2366315</commentid>
    <comment_count>4</comment_count>
    <who name="Stephan Herrmann">stephan.herrmann</who>
    <bug_when>2014-02-20 15:37:13 -0500</bug_when>
    <thetext>It&apos;s even more specific: the only failing combination is:
- BETA_JAVA8 compiler
- compliance 1.8
- using declaration annotations
IOW: given you use the BETA_JAVA8 compiler for each compliance level there is an annotation library with which the warning is correctly detected.

Combination of new compliance level and old annotations is not my priority atm.

I assume this will be fixed once I address bug 415179, to be revisited later.</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>2367215</commentid>
    <comment_count>5</comment_count>
    <who name="Stephan Herrmann">stephan.herrmann</who>
    <bug_when>2014-02-22 10:51:47 -0500</bug_when>
    <thetext>A passing test has been released via http://git.eclipse.org/c/jdt/eclipse.jdt.core.git/commit/?h=BETA_JAVA8&amp;id=01b4ca7b386e2151e72abd0b2f1c2ecda16f856e

This challenges all cases where version of the annotations and compliance level match.

Note for self: Local branch SE5_ANNOT_AT_18 contains infra structure work to run all NullAnnotationTests at compliance 1.8 with old annotations (shows regressions currently).</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>2389164</commentid>
    <comment_count>6</comment_count>
    <who name="Stephan Herrmann">stephan.herrmann</who>
    <bug_when>2014-04-15 07:01:59 -0400</bug_when>
    <thetext>Not a priority for 4.4</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>2461126</commentid>
    <comment_count>7</comment_count>
      <attachid>247691</attachid>
    <who name="Colin Bartolome">cbartolo</who>
    <bug_when>2014-10-07 13:23:42 -0400</bug_when>
    <thetext>Created attachment 247691
&quot;Illegal redefinition of parameter&quot; error now missing

On a whim, I made the parameters in the interface @Nullable and the parameters in the implementing methods @NonNull. In Kepler SR2, I got the expected &quot;Illegal redefinition of parameter&quot; on only one of the methods--the one that overrides the non-generic interface.

What&apos;s worse is that Luna (4.4.1) gives NO error for EITHER method! Additionally, it gives no warnings for either method in the original attachment. This behavior has regressed.</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>2461140</commentid>
    <comment_count>8</comment_count>
    <who name="Stephan Herrmann">stephan.herrmann</who>
    <bug_when>2014-10-07 13:43:49 -0400</bug_when>
    <thetext>(In reply to Colin Bartolome from comment #7)
&gt; Created attachment 247691 [details]
&gt; &quot;Illegal redefinition of parameter&quot; error now missing
&gt; 
&gt; On a whim, I made the parameters in the interface @Nullable and the
&gt; parameters in the implementing methods @NonNull. In Kepler SR2, I got the
&gt; expected &quot;Illegal redefinition of parameter&quot; on only one of the methods--the
&gt; one that overrides the non-generic interface.
&gt; 
&gt; What&apos;s worse is that Luna (4.4.1) gives NO error for EITHER method!
&gt; Additionally, it gives no warnings for either method in the original
&gt; attachment. This behavior has regressed.

At what compliance level and with which annotations did you observe this?</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>2461226</commentid>
    <comment_count>9</comment_count>
    <who name="Colin Bartolome">cbartolo</who>
    <bug_when>2014-10-07 17:13:15 -0400</bug_when>
    <thetext>&gt; At what compliance level and with which annotations did you observe this?

I was using Kepler SR2 with compliance level 1.7 and Luna with compliance level 1.8.

I can confirm that Kepler SR2 with Java 8 support works correctly with compliance level 1.7, but fails exactly like Luna does with compliance level 1.8.

All of this is while using the annotations supplied with Eclipse.</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>2461228</commentid>
    <comment_count>10</comment_count>
    <who name="Colin Bartolome">cbartolo</who>
    <bug_when>2014-10-07 17:17:12 -0400</bug_when>
    <thetext>I removed the annotations JAR from the project and allowed Kepler (SR2 with Java 8) to re-add it. Now the JAR has version 2.0.0 and everything works correctly. I didn&apos;t realize the annotation JAR had multiple versions; Eclipse makes no mention of this, as far as I can tell. Maybe it should point this out when the compliance level changes?</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>2461232</commentid>
    <comment_count>11</comment_count>
    <who name="Colin Bartolome">cbartolo</who>
    <bug_when>2014-10-07 17:21:53 -0400</bug_when>
    <thetext>Okay, I can confirm that this issue is fixed when using org.eclipse.jdt.annotation_2.0.0.x.jar, compliance level 1.8, and either Eclipse Luna or Kepler SR2 with Java 8.</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>2461241</commentid>
    <comment_count>12</comment_count>
    <who name="Stephan Herrmann">stephan.herrmann</who>
    <bug_when>2014-10-07 17:39:09 -0400</bug_when>
    <thetext>Thanks for the updates.

The difference between versions 1.1.x and 2.0.x of the annotation bundle is: the former are SE5 style annotations, whereas the latter are SE8 *type annotations* (see the @Target(TYPE_USE) meta annotation).

Some background is actually documented in the help, see: http://help.eclipse.org/luna/topic/org.eclipse.jdt.doc.user/tasks/task-using_null_type_annotations.htm#compatibility

The combination compliance 1.8 and SE5-style annotations is known to have some problems. I&apos;ll see what I can do for Mars.</thetext>
  </long_desc>
      
          <attachment
              isobsolete="0"
              ispatch="0"
              isprivate="0"
          >
            <attachid>236856</attachid>
            <date>2013-10-24 15:00:00 -0400</date>
            <delta_ts>2013-10-24 15:00:59 -0400</delta_ts>
            <desc>Warning went missing</desc>
            <filename>OverrideTest.java</filename>
            <type>text/x-java-source</type>
            <size>509</size>
            <attacher name="Colin Bartolome">cbartolo</attacher>
            
              <data encoding="base64">aW1wb3J0IG9yZy5lY2xpcHNlLmpkdC5hbm5vdGF0aW9uLk5vbk51bGw7CgpwdWJsaWMgY2xhc3Mg
T3ZlcnJpZGVUZXN0IGltcGxlbWVudHMgVHlwZWRCYXNlPFN0cmluZz4sIFVudHlwZWRCYXNlCnsK
ICAgQE92ZXJyaWRlCiAgIHB1YmxpYyB2b2lkIGRvU29tZXRoaW5nKFN0cmluZyB0ZXh0KSAvLyBO
byB3YXJuaW5nCiAgIHsKICAgICAgU3lzdGVtLm91dC5wcmludGxuKHRleHQpOwogICB9CiAgIAog
ICBAT3ZlcnJpZGUKICAgcHVibGljIHZvaWQgZG9Tb21ldGhpbmdFbHNlKFN0cmluZyB0ZXh0KSAv
LyAiTWlzc2luZyBub24tbnVsbCBhbm5vdGF0aW9uIiB3YXJuaW5nCiAgIHsKICAgICAgU3lzdGVt
Lm91dC5wcmludGxuKHRleHQpOwogICB9Cn0KCmludGVyZmFjZSBUeXBlZEJhc2U8VD4KewogICB2
b2lkIGRvU29tZXRoaW5nKEBOb25OdWxsIFQgdGV4dCk7Cn0KCmludGVyZmFjZSBVbnR5cGVkQmFz
ZQp7CiAgIHZvaWQgZG9Tb21ldGhpbmdFbHNlKEBOb25OdWxsIFN0cmluZyB0ZXh0KTsKfQo=
</data>

          </attachment>
          <attachment
              isobsolete="0"
              ispatch="0"
              isprivate="0"
          >
            <attachid>247691</attachid>
            <date>2014-10-07 13:23:00 -0400</date>
            <delta_ts>2014-10-07 13:23:42 -0400</delta_ts>
            <desc>&quot;Illegal redefinition of parameter&quot; error now missing</desc>
            <filename>file_420313.txt</filename>
            <type>text/plain</type>
            <size>545</size>
            <attacher name="Colin Bartolome">cbartolo</attacher>
            
              <data encoding="base64">aW1wb3J0IG9yZy5lY2xpcHNlLmpkdC5hbm5vdGF0aW9uLk5vbk51bGw7DQppbXBvcnQgb3JnLmVj
bGlwc2UuamR0LmFubm90YXRpb24uTnVsbGFibGU7DQoNCnB1YmxpYyBjbGFzcyBPdmVycmlkZVRl
c3QgaW1wbGVtZW50cyBUeXBlZEJhc2U8U3RyaW5nPiwgVW50eXBlZEJhc2UNCnsNCiAgIEBPdmVy
cmlkZQ0KICAgcHVibGljIHZvaWQgZG9Tb21ldGhpbmcoQE5vbk51bGwgU3RyaW5nIHRleHQpDQog
ICB7DQogICAgICBTeXN0ZW0ub3V0LnByaW50bG4odGV4dCk7DQogICB9DQogICANCiAgIEBPdmVy
cmlkZQ0KICAgcHVibGljIHZvaWQgZG9Tb21ldGhpbmdFbHNlKEBOb25OdWxsIFN0cmluZyB0ZXh0
KQ0KICAgew0KICAgICAgU3lzdGVtLm91dC5wcmludGxuKHRleHQpOw0KICAgfQ0KfQ0KDQppbnRl
cmZhY2UgVHlwZWRCYXNlPFQ+DQp7DQogICB2b2lkIGRvU29tZXRoaW5nKEBOdWxsYWJsZSBUIHRl
eHQpOw0KfQ0KDQppbnRlcmZhY2UgVW50eXBlZEJhc2UNCnsNCiAgIHZvaWQgZG9Tb21ldGhpbmdF
bHNlKEBOdWxsYWJsZSBTdHJpbmcgdGV4dCk7DQp9DQo=
</data>

          </attachment>
      

    </bug>

</bugzilla>