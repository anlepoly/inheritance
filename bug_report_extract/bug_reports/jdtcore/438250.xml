<?xml version="1.0" encoding="UTF-8" standalone="yes" ?>
<!DOCTYPE bugzilla SYSTEM "https://bugs.eclipse.org/bugs/page.cgi?id=bugzilla.dtd">

<bugzilla version="4.4.7"
          urlbase="https://bugs.eclipse.org/bugs/"
          
          maintainer="webmaster@eclipse.org"
>

    <bug>
          <bug_id>438250</bug_id>
          
          <creation_ts>2014-06-26 07:31:00 -0400</creation_ts>
          <short_desc>[1.8][null] NPE trying to report bogus null annotation conflict</short_desc>
          <delta_ts>2014-08-05 04:54:15 -0400</delta_ts>
          <reporter_accessible>1</reporter_accessible>
          <cclist_accessible>1</cclist_accessible>
          <classification_id>2</classification_id>
          <classification>Eclipse</classification>
          <product>JDT</product>
          <component>Core</component>
          <version>4.4</version>
          <rep_platform>PC</rep_platform>
          <op_sys>Windows 7</op_sys>
          <bug_status>VERIFIED</bug_status>
          <resolution>FIXED</resolution>
          
          
          <bug_file_loc></bug_file_loc>
          <status_whiteboard></status_whiteboard>
          <keywords></keywords>
          <priority>P3</priority>
          <bug_severity>normal</bug_severity>
          <target_milestone>4.5 M1</target_milestone>
          
          <blocked>438458</blocked>
          <everconfirmed>1</everconfirmed>
          <reporter name="Clovis Seragiotto">clovis.seragiotto</reporter>
          <assigned_to name="Stephan Herrmann">stephan.herrmann</assigned_to>
          <cc>clovis.seragiotto</cc>
    
    <cc>shankhba</cc>
    
    <cc>srikanth_sankaran</cc>
    
    <cc>stephan.herrmann</cc>
          
          <votes>0</votes>

      

      

      

          <comment_sort_order>oldest_to_newest</comment_sort_order>  
          <long_desc isprivate="0" >
    <commentid>2420820</commentid>
    <comment_count>0</comment_count>
    <who name="Clovis Seragiotto">clovis.seragiotto</who>
    <bug_when>2014-06-26 07:31:14 -0400</bug_when>
    <thetext>For the following program (with annotation-based null analysis enabled), one get a NullPointerException from the compiler:

Internal compiler error: java.lang.NullPointerException at org.eclipse.jdt.internal.compiler.problem.ProblemReporter.contradictoryNullAnnotationsOnBounds(ProblemReporter.java:9522)

@org.eclipse.jdt.annotation.NonNullByDefault(org.eclipse.jdt.annotation.DefaultLocation.TYPE_BOUND)
public interface FooBar {
    &lt;@org.eclipse.jdt.annotation.Nullable R extends Runnable&gt; R foobar(R r);
}</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>2421851</commentid>
    <comment_count>1</comment_count>
    <who name="Stephan Herrmann">stephan.herrmann</who>
    <bug_when>2014-06-28 14:11:36 -0400</bug_when>
    <thetext>Thanks, I can reproduce.</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>2430249</commentid>
    <comment_count>2</comment_count>
    <who name="Stephan Herrmann">stephan.herrmann</who>
    <bug_when>2014-07-22 10:04:57 -0400</bug_when>
    <thetext>I have a fix under test:

The NPE occurred when trying to report contradiction against an annotation that doesn&apos;t exist: the type bound &apos;extends Runnable&apos; is implicitly nonnull via the @NonNullByDefault, but there&apos;s no explicit annotation to complain about.

Fixed by detecting the situation where a type parameter has an explicit null annotation and one of its bound has an implicit null annotation. Instead of trying to report contradiction, let the explicit annotation override the implicit one. OIOW: if a type parameter already has a null annotation, there&apos;s no use for a applying a default any more.</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>2430378</commentid>
    <comment_count>3</comment_count>
    <who name="Stephan Herrmann">stephan.herrmann</who>
    <bug_when>2014-07-22 11:58:42 -0400</bug_when>
    <thetext>Released for 4.5 M1 via http://git.eclipse.org/c/jdt/eclipse.jdt.core.git/commit/?id=403deed13ad4115ce80e0449d5be70cb085b39a1</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>2435533</commentid>
    <comment_count>4</comment_count>
    <who name="Srikanth Sankaran">srikanth_sankaran</who>
    <bug_when>2014-08-05 04:54:15 -0400</bug_when>
    <thetext>Verified that no NPE is seen for the test case in comment#0 using 
Version: Mars (4.5)
Build id: I20140804-2000</thetext>
  </long_desc>
      
      

    </bug>

</bugzilla>