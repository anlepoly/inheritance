<?xml version="1.0" encoding="UTF-8" standalone="yes" ?>
<!DOCTYPE bugzilla SYSTEM "https://bugs.eclipse.org/bugs/page.cgi?id=bugzilla.dtd">

<bugzilla version="4.4.7"
          urlbase="https://bugs.eclipse.org/bugs/"
          
          maintainer="webmaster@eclipse.org"
>

    <bug>
          <bug_id>419219</bug_id>
          
          <creation_ts>2013-10-11 07:50:00 -0400</creation_ts>
          <short_desc>JavaCorePreferenceModifyListener pollutes exported preferences</short_desc>
          <delta_ts>2014-04-29 04:02:09 -0400</delta_ts>
          <reporter_accessible>1</reporter_accessible>
          <cclist_accessible>1</cclist_accessible>
          <classification_id>2</classification_id>
          <classification>Eclipse</classification>
          <product>JDT</product>
          <component>Core</component>
          <version>4.4</version>
          <rep_platform>All</rep_platform>
          <op_sys>All</op_sys>
          <bug_status>VERIFIED</bug_status>
          <resolution>FIXED</resolution>
          
          
          <bug_file_loc></bug_file_loc>
          <status_whiteboard></status_whiteboard>
          <keywords></keywords>
          <priority>P3</priority>
          <bug_severity>normal</bug_severity>
          <target_milestone>4.4 M7</target_milestone>
          
          
          <everconfirmed>1</everconfirmed>
          <reporter name="Szymon Ptaszkiewicz">szymon.ptaszkiewicz</reporter>
          <assigned_to name="Jay Arthanareeswaran">jarthana</assigned_to>
          <cc>daniel_megert</cc>
    
    <cc>jarthana</cc>
    
    <cc>srikanth_sankaran</cc>
          
          <votes>0</votes>

      

      

      <flag name="review"
          id="62017"
          type_id="1"
          status="+"
          setter="jarthana"
    />

          <comment_sort_order>oldest_to_newest</comment_sort_order>  
          <long_desc isprivate="0" >
    <commentid>2317169</commentid>
    <comment_count>0</comment_count>
    <who name="Szymon Ptaszkiewicz">szymon.ptaszkiewicz</who>
    <bug_when>2013-10-11 07:50:00 -0400</bug_when>
    <thetext>The implementation of JavaCorePreferenceModifyListener#preApply may cause unexpected removal of Java preferences. The issue was reported initially in bug 418046 and this bug will focus on changes required to fix the jdt.core part.

The node passed as an argument to the preApply method is always an IExportedPreferences node which means it is a &quot;delta&quot; that will be applied to the global hierarchy. If a listener modifies this delta by creating an empty node, then all preferences of this node will be removed in the global hierarchy.

Reproducible scenario:
1. Download the plugin from https://bugs.eclipse.org/bugs/attachment.cgi?id=235817
2. Import it to your workspace.
3. Start self-hosted Eclipse.
4. Modify one of Java preferences in Window &gt; Preferences &gt; Java &gt; Compiler, e.g. change compiler compliance to &quot;1.3&quot;. Click OK.
5. Restart the inner Eclipse.
=&gt; Check that compiler compliance is set back to the default and our &quot;1.3&quot; is lost.</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>2317172</commentid>
    <comment_count>1</comment_count>
    <who name="Szymon Ptaszkiewicz">szymon.ptaszkiewicz</who>
    <bug_when>2013-10-11 07:54:13 -0400</bug_when>
    <thetext>I have prepared Gerrit patch set: https://git.eclipse.org/r/17299</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>2317504</commentid>
    <comment_count>2</comment_count>
    <who name="Srikanth Sankaran">srikanth_sankaran</who>
    <bug_when>2013-10-11 21:01:56 -0400</bug_when>
    <thetext> Szymon, Thanks for the patch. Jay, please take it forward.</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>2318918</commentid>
    <comment_count>3</comment_count>
    <who name="Szymon Ptaszkiewicz">szymon.ptaszkiewicz</who>
    <bug_when>2013-10-16 09:37:35 -0400</bug_when>
    <thetext>Changing bug title to describe more general problem.</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>2347541</commentid>
    <comment_count>4</comment_count>
    <who name="Szymon Ptaszkiewicz">szymon.ptaszkiewicz</who>
    <bug_when>2014-01-09 10:57:30 -0500</bug_when>
    <thetext>Jay, is it possible to push it for M5?</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>2385061</commentid>
    <comment_count>5</comment_count>
    <who name="Szymon Ptaszkiewicz">szymon.ptaszkiewicz</who>
    <bug_when>2014-04-05 11:44:35 -0400</bug_when>
    <thetext>There were some conflicts during rebase so I manually rebased the patch on top of master and pushed a new patch set to Gerrit. Jay, can you please review? TIA.</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>2385226</commentid>
    <comment_count>6</comment_count>
    <who name="Jay Arthanareeswaran">jarthana</who>
    <bug_when>2014-04-07 00:53:53 -0400</bug_when>
    <thetext>Sorry, this one slipped through. I will look at this for M7.</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>2385343</commentid>
    <comment_count>7</comment_count>
    <who name="Jay Arthanareeswaran">jarthana</who>
    <bug_when>2014-04-07 05:31:42 -0400</bug_when>
    <thetext>Patch looks good. Just updated the copyright (removed the 2013 from the new file) and posted a new patch. Will push once the build completes.</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>2385359</commentid>
    <comment_count>8</comment_count>
    <who name="Jay Arthanareeswaran">jarthana</who>
    <bug_when>2014-04-07 05:49:02 -0400</bug_when>
    <thetext>Released in master via :

http://git.eclipse.org/c/jdt/eclipse.jdt.core.git/commit/?id=030a336d6852ac839a3f6024ca126c25cd9a3e62

Thanks Szymon, for the patch.</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>2394445</commentid>
    <comment_count>9</comment_count>
    <who name="Srikanth Sankaran">srikanth_sankaran</who>
    <bug_when>2014-04-29 04:02:09 -0400</bug_when>
    <thetext>Verified for 4.4 M7 using Build id: I20140427-2030</thetext>
  </long_desc>
      
      

    </bug>

</bugzilla>