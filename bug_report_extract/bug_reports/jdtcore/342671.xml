<?xml version="1.0" encoding="UTF-8" standalone="yes" ?>
<!DOCTYPE bugzilla SYSTEM "https://bugs.eclipse.org/bugs/page.cgi?id=bugzilla.dtd">

<bugzilla version="4.4.7"
          urlbase="https://bugs.eclipse.org/bugs/"
          
          maintainer="webmaster@eclipse.org"
>

    <bug>
          <bug_id>342671</bug_id>
          
          <creation_ts>2011-04-13 04:29:00 -0400</creation_ts>
          <short_desc>ClassCastException: org.eclipse.jdt.internal.compiler.lookup.SourceTypeBinding cannot be cast to org.eclipse.jdt.internal.compiler.lookup.ArrayBinding</short_desc>
          <delta_ts>2011-04-26 06:32:41 -0400</delta_ts>
          <reporter_accessible>1</reporter_accessible>
          <cclist_accessible>1</cclist_accessible>
          <classification_id>2</classification_id>
          <classification>Eclipse</classification>
          <product>JDT</product>
          <component>Core</component>
          <version>3.7</version>
          <rep_platform>PC</rep_platform>
          <op_sys>Windows 7</op_sys>
          <bug_status>VERIFIED</bug_status>
          <resolution>FIXED</resolution>
          
          
          <bug_file_loc></bug_file_loc>
          <status_whiteboard></status_whiteboard>
          <keywords></keywords>
          <priority>P3</priority>
          <bug_severity>normal</bug_severity>
          <target_milestone>3.7 M7</target_milestone>
          
          
          <everconfirmed>1</everconfirmed>
          <reporter name="Philippe Coucaud">phil_fj12</reporter>
          <assigned_to name="Stephan Herrmann">stephan.herrmann</assigned_to>
          <cc>amj87.iitr</cc>
    
    <cc>Olivier_Thomann</cc>
    
    <cc>stephan.herrmann</cc>
          
          <votes>0</votes>

      

      

      <flag name="review"
          id="40755"
          type_id="1"
          status="+"
          setter="amj87.iitr"
    />

          <comment_sort_order>oldest_to_newest</comment_sort_order>  
          <long_desc isprivate="0" >
    <commentid>1912737</commentid>
    <comment_count>0</comment_count>
    <who name="Philippe Coucaud">phil_fj12</who>
    <bug_when>2011-04-13 04:29:59 -0400</bug_when>
    <thetext>Build Identifier: I20110310-1119

Stack trace to be attached.

Reproducible: Always

Steps to Reproduce:
I can reproduce the exception, but I don&apos;t know which steps are really related to the problem:

1. I have a class X which implements an interface Foo&lt;Bar&lt;T&gt;&gt;. I removed the parameter type T from Bar: X thus contains errors.
2. I start removing the type parameter &quot;&lt;T&gt;&quot; in occurrences of Bar&lt;T&gt; in class X: some are simple types like &quot;Bar&lt;T&gt;&quot; and some appear in array types like &quot;Bar&lt;T&gt;[]&quot;.
3. When modifying an occurrence of the latter form (the selection thus being &apos;Bar&lt;T&gt;[]&apos;), the error dialog pops up: &apos;An internal error occurred during: &quot;Requesting Java AST from selection&quot;&apos;.
4. If I close the editor and reopen X, the exception does not occur anymore. I need to restore the previous version of the file from CVS, and then perform step 2 again.</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>1912740</commentid>
    <comment_count>1</comment_count>
      <attachid>193126</attachid>
    <who name="Philippe Coucaud">phil_fj12</who>
    <bug_when>2011-04-13 04:30:35 -0400</bug_when>
    <thetext>Created attachment 193126
stack trace</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>1912809</commentid>
    <comment_count>2</comment_count>
    <who name="Ayushman Jain">amj87.iitr</who>
    <bug_when>2011-04-13 06:14:37 -0400</bug_when>
    <thetext>Hi Phillipe,
Can you please elaborate on what exactly did u do that caused the exception? Was it just during manual deletion?

It&apos;ll be really good if you can attach a testcase here which clearly throws the CCE. I can&apos;t reproduce this right now.</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>1912846</commentid>
    <comment_count>3</comment_count>
      <attachid>193148</attachid>
    <who name="Philippe Coucaud">phil_fj12</who>
    <bug_when>2011-04-13 07:21:01 -0400</bug_when>
    <thetext>Created attachment 193148
foo.zip

&gt; Can you please elaborate on what exactly did u do that caused the exception?
&gt; Was it just during manual deletion?

I managed to trigger the CCE with the attached project. In fact the (manual) deletion was not mandatory.

1. import the zipped Java project
2. Open class X in the Java editor
3. click inside the return type &quot;T1&lt;T&gt;[]&quot; of method f() in order to trigger a selection event: the problem dialog should appear.</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>1912875</commentid>
    <comment_count>4</comment_count>
    <who name="Ayushman Jain">amj87.iitr</who>
    <bug_when>2011-04-13 08:19:49 -0400</bug_when>
    <thetext>This is caused by the fix for bug 337964</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>1912878</commentid>
    <comment_count>5</comment_count>
    <who name="Ayushman Jain">amj87.iitr</who>
    <bug_when>2011-04-13 08:26:10 -0400</bug_when>
    <thetext>(In reply to comment #4)
&gt; This is caused by the fix for bug 337964

In fact, was bug 337964 even a bug? Backing out the changes done for the fix seems to fix this issue.</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>1912880</commentid>
    <comment_count>6</comment_count>
      <attachid>193157</attachid>
    <who name="Ayushman Jain">amj87.iitr</who>
    <bug_when>2011-04-13 08:30:18 -0400</bug_when>
    <thetext>Created attachment 193157
proposed fix

Backing out fix for bug 337964</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>1912881</commentid>
    <comment_count>7</comment_count>
    <who name="Olivier Thomann">Olivier_Thomann</who>
    <bug_when>2011-04-13 08:32:01 -0400</bug_when>
    <thetext>I&apos;ll take a look.</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>1912900</commentid>
    <comment_count>8</comment_count>
    <who name="Olivier Thomann">Olivier_Thomann</who>
    <bug_when>2011-04-13 09:08:01 -0400</bug_when>
    <thetext>Simply reverting the fix for 337964 is not good enough as it is causing a NPE.
I&apos;ll provide a new patch shortly.</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>1912906</commentid>
    <comment_count>9</comment_count>
      <attachid>193158</attachid>
    <who name="Olivier Thomann">Olivier_Thomann</who>
    <bug_when>2011-04-13 09:10:52 -0400</bug_when>
    <thetext>Created attachment 193158
Proposed fix + regression tests</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>1912907</commentid>
    <comment_count>10</comment_count>
    <who name="Olivier Thomann">Olivier_Thomann</who>
    <bug_when>2011-04-13 09:12:51 -0400</bug_when>
    <thetext>Ayushman, please review.

The fix for bug 337964 was wrong. Only the usage of binding in the context of the parameterized qualified type reference had to be fixed.
When the reference is a parameterized type reference (qualified or not), it can contain a dimension. So the check for array type is required.</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>1912949</commentid>
    <comment_count>11</comment_count>
    <who name="Ayushman Jain">amj87.iitr</who>
    <bug_when>2011-04-13 10:03:05 -0400</bug_when>
    <thetext>Yup looks good.</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>1912961</commentid>
    <comment_count>12</comment_count>
    <who name="Olivier Thomann">Olivier_Thomann</who>
    <bug_when>2011-04-13 10:11:17 -0400</bug_when>
    <thetext>Thanks for the test case.
Released for 3.7M7.
Regression tests added in:
org.eclipse.jdt.core.tests.dom.ASTConverter15Test#test0351
org.eclipse.jdt.core.tests.dom.ASTConverter15Test#test0352</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>1913550</commentid>
    <comment_count>13</comment_count>
    <who name="Stephan Herrmann">stephan.herrmann</who>
    <bug_when>2011-04-14 08:13:30 -0400</bug_when>
    <thetext>I tend to disagree with your solution:

IMO the bug is in the compiler not the DefaultBindingResolver. At the compiler
level we find a ParameterizedQualifiedTypeReference for &quot;test0352.I1&lt;T&gt;[]&quot;
which has as its resolvedType a SourceTypeBinding &quot;test0352.I1&quot;.

At the point where QualifedTypeReference.internalResolveType() detects the
error (I1 is not generic), we skip creating the array binding.
Throughout this method, whenever we are past an assignment to resolvedType
it is ensured that array bindings are created. However, also 
findNextTypeBinding() may cause an assignment to resolvedType in which
case the scalar type may remain in place although the reference has
dimensions.

To me this looks inconsistent and should not be worked around in the binding
resolver. I couldn&apos;t easily create another test case where inconsistent
resolvedType would cause harm, because return null from internalResolveType
normally aborts treatment of that element. So, maybe the field resolvedType 
isn&apos;t that important for code with errors? But if other clients besides
the binding resolver also depend on this field I would prefer fixing in the
compiler.

Also note, that this case is different from the section starting at line 1570: 
here the second check isArrayType() is needed because newAstToOldAst is not
bijective, it may indeed map, e.g., a SimpleName to an
ArrayAllocationExpression. (See bug 339226).</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>1913737</commentid>
    <comment_count>14</comment_count>
    <who name="Olivier Thomann">Olivier_Thomann</who>
    <bug_when>2011-04-14 11:30:50 -0400</bug_when>
    <thetext>(In reply to comment #13)
&gt; To me this looks inconsistent and should not be worked around in the binding
&gt; resolver. I couldn&apos;t easily create another test case where inconsistent
&gt; resolvedType would cause harm, because return null from internalResolveType
&gt; normally aborts treatment of that element. So, maybe the field resolvedType 
&gt; isn&apos;t that important for code with errors? But if other clients besides
&gt; the binding resolver also depend on this field I would prefer fixing in the
&gt; compiler.
I understand your point. We are at a point in the game where we need to be careful about making deep changes. I also considered changing the value of resolveType to be an array type if the type reference has a dimension.
I wanted to fix this problem as this was introduced with a recent change (so it looks like a regression) by minimizing the impact on other usages of the resolvedType.

What you suggest is perfectly fine for 3.8, but meanwhile I think this approach is safer. Please open a new bug report to fix this inconsistency for 3.8 or provide a patch that fixes this issue the way you suggested.
We are at a point where we need to make trade-offs. Let me know what you think.</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>1913756</commentid>
    <comment_count>15</comment_count>
      <attachid>193271</attachid>
    <who name="Olivier Thomann">Olivier_Thomann</who>
    <bug_when>2011-04-14 11:55:24 -0400</bug_when>
    <thetext>Created attachment 193271
A new proposal

Stephan, I think this is more in line with what you wanted. Please check it.
The part that I could not quite see if the case where the isGenericError (ParameterizedSingleTypeReference) would return a binding without assigning it to resolvedType first.
This is at least a first attempt to find a better fix for this issue.</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>1913759</commentid>
    <comment_count>16</comment_count>
      <attachid>193272</attachid>
    <who name="Olivier Thomann">Olivier_Thomann</who>
    <bug_when>2011-04-14 11:56:34 -0400</bug_when>
    <thetext>Created attachment 193272
Same patch

Same patch with some unrelated changes removed.</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>1913771</commentid>
    <comment_count>17</comment_count>
    <who name="Stephan Herrmann">stephan.herrmann</who>
    <bug_when>2011-04-14 12:13:38 -0400</bug_when>
    <thetext>(In reply to comment #15)
&gt; Created attachment 193271 [details]
&gt; A new proposal
&gt; 
&gt; Stephan, I think this is more in line with what you wanted. Please check it.
&gt; The part that I could not quite see if the case where the isGenericError
&gt; (ParameterizedSingleTypeReference) would return a binding without assigning it
&gt; to resolvedType first.
&gt; This is at least a first attempt to find a better fix for this issue.

At a first glance this looks good to me. I will give it a thorough check
before our next call.

Anyway, I fully understand your concerns. If we&apos;re not at ease with the new 
patch I&apos;m happy with postponing for 3.8 and sticking to the previous patch.</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>1914809</commentid>
    <comment_count>18</comment_count>
      <attachid>193439</attachid>
    <who name="Stephan Herrmann">stephan.herrmann</who>
    <bug_when>2011-04-17 13:31:18 -0400</bug_when>
    <thetext>Created attachment 193439
my proposal

Starting from your last patch this is what I did:

Simplify ParameterizedQualifiedTypeReference by extracting a new method;
now array bindings are always created at the end.

For ParameterizedSingleTypeReference I made explicit the three possible
outcomes (combinations of return value and what&apos;s stored in resolvedType).
In this patch I assume that hasGenericError should always correspond to
!resolvedType.isValidBinding()

I added one more test to witness how we can still get into line 1570
of DefaultBindingResolver (the part mentioned in bug 339226)
- just to document that the remaining checks are all needed.


If the change in ParameterizedSingleTypeReference is good we might 
actually use that strategy also in ParameterizedQualifiedTypeReference.

I&apos;m currently running tests, and since the hasGenericError flag was introduced
in the context of apt (bug 196200) I&apos;m including compiler.apt.tests, too.</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>1915936</commentid>
    <comment_count>19</comment_count>
    <who name="Stephan Herrmann">stephan.herrmann</who>
    <bug_when>2011-04-19 11:51:34 -0400</bug_when>
    <thetext>(In reply to comment #18)
&gt; I&apos;m currently running tests, and since the hasGenericError flag was introduced
&gt; in the context of apt (bug 196200) I&apos;m including compiler.apt.tests, too.

Meanwhile I got my test configuration fixed and I can confirm that all jdt.core
tests plus tests org.eclipse.jdt.compiler.apt.tests.AllTests pass with my patch
from comment 18.</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>1916064</commentid>
    <comment_count>20</comment_count>
    <who name="Olivier Thomann">Olivier_Thomann</who>
    <bug_when>2011-04-19 14:56:20 -0400</bug_when>
    <thetext>Patch looks good.
Please release.</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>1916100</commentid>
    <comment_count>21</comment_count>
    <who name="Stephan Herrmann">stephan.herrmann</who>
    <bug_when>2011-04-19 15:47:35 -0400</bug_when>
    <thetext>Released for 3.7M7.</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>1918851</commentid>
    <comment_count>22</comment_count>
    <who name="Ayushman Jain">amj87.iitr</who>
    <bug_when>2011-04-26 06:32:41 -0400</bug_when>
    <thetext>Verified for 3.7M7 using build I20110425-1800.</thetext>
  </long_desc>
      
          <attachment
              isobsolete="1"
              ispatch="0"
              isprivate="0"
          >
            <attachid>193126</attachid>
            <date>2011-04-13 04:30:00 -0400</date>
            <delta_ts>2011-04-13 09:10:52 -0400</delta_ts>
            <desc>stack trace</desc>
            <filename>stack trace.txt</filename>
            <type>text/plain</type>
            <size>7014</size>
            <attacher name="Philippe Coucaud">phil_fj12</attacher>
            
              <data encoding="base64">ZWNsaXBzZS5idWlsZElkPUkyMDExMDMxMC0xMTE5DQpqYXZhLnZlcnNpb249MS42LjBfMjMNCmph
dmEudmVuZG9yPVN1biBNaWNyb3N5c3RlbXMgSW5jLg0KQm9vdExvYWRlciBjb25zdGFudHM6IE9T
PXdpbjMyLCBBUkNIPXg4Nl82NCwgV1M9d2luMzIsIE5MPWZyX0ZSDQpDb21tYW5kLWxpbmUgYXJn
dW1lbnRzOiAgLW9zIHdpbjMyIC13cyB3aW4zMiAtYXJjaCB4ODZfNjQNCg0KDQpFcnJvcg0KV2Vk
IEFwciAxMyAxMDoyNDo1MyBDRVNUIDIwMTENClByb2JsZW1zIG9jY3VycmVkIHdoZW4gaW52b2tp
bmcgY29kZSBmcm9tIHBsdWctaW46ICJvcmcuZWNsaXBzZS51aS53b3JrYmVuY2giLg0KDQpqYXZh
LmxhbmcuQ2xhc3NDYXN0RXhjZXB0aW9uOiBvcmcuZWNsaXBzZS5qZHQuaW50ZXJuYWwuY29tcGls
ZXIubG9va3VwLlNvdXJjZVR5cGVCaW5kaW5nIGNhbm5vdCBiZSBjYXN0IHRvIG9yZy5lY2xpcHNl
LmpkdC5pbnRlcm5hbC5jb21waWxlci5sb29rdXAuQXJyYXlCaW5kaW5nDQoJYXQgb3JnLmVjbGlw
c2UuamR0LmNvcmUuZG9tLkRlZmF1bHRCaW5kaW5nUmVzb2x2ZXIucmVzb2x2ZVR5cGUoRGVmYXVs
dEJpbmRpbmdSZXNvbHZlci5qYXZhOjE1NjcpDQoJYXQgb3JnLmVjbGlwc2UuamR0LmNvcmUuZG9t
LlR5cGUucmVzb2x2ZUJpbmRpbmcoVHlwZS5qYXZhOjE2OSkNCglhdCBvcmcuZWNsaXBzZS5qZHQu
aW50ZXJuYWwudWkuc2VhcmNoLk1ldGhvZEV4aXRzRmluZGVyLm1hcmtSZWZlcmVuY2VzKE1ldGhv
ZEV4aXRzRmluZGVyLmphdmE6MTMxKQ0KCWF0IG9yZy5lY2xpcHNlLmpkdC5pbnRlcm5hbC51aS5z
ZWFyY2guTWV0aG9kRXhpdHNGaW5kZXIucGVyZm9ybVNlYXJjaChNZXRob2RFeGl0c0ZpbmRlci5q
YXZhOjEwNykNCglhdCBvcmcuZWNsaXBzZS5qZHQuaW50ZXJuYWwudWkuc2VhcmNoLk1ldGhvZEV4
aXRzRmluZGVyLmdldE9jY3VycmVuY2VzKE1ldGhvZEV4aXRzRmluZGVyLmphdmE6MTE4KQ0KCWF0
IG9yZy5lY2xpcHNlLmpkdC5pbnRlcm5hbC51aS5qYXZhZWRpdG9yLkphdmFFZGl0b3IudXBkYXRl
T2NjdXJyZW5jZUFubm90YXRpb25zKEphdmFFZGl0b3IuamF2YTozMzEyKQ0KCWF0IG9yZy5lY2xp
cHNlLmpkdC5pbnRlcm5hbC51aS5qYXZhZWRpdG9yLkphdmFFZGl0b3IkQWN0aXZhdGlvbkxpc3Rl
bmVyLndpbmRvd0FjdGl2YXRlZChKYXZhRWRpdG9yLmphdmE6MTI2OCkNCglhdCBvcmcuZWNsaXBz
ZS51aS5pbnRlcm5hbC5Xb3JrYmVuY2gkMTQucnVuKFdvcmtiZW5jaC5qYXZhOjEwMDIpDQoJYXQg
b3JnLmVjbGlwc2UuY29yZS5ydW50aW1lLlNhZmVSdW5uZXIucnVuKFNhZmVSdW5uZXIuamF2YTo0
MikNCglhdCBvcmcuZWNsaXBzZS51aS5pbnRlcm5hbC5Xb3JrYmVuY2guZmlyZVdpbmRvd0FjdGl2
YXRlZChXb3JrYmVuY2guamF2YToxMDAwKQ0KCWF0IG9yZy5lY2xpcHNlLnVpLmludGVybmFsLldv
cmtiZW5jaFdpbmRvdyQyOC5zaGVsbEFjdGl2YXRlZChXb3JrYmVuY2hXaW5kb3cuamF2YTozMTQx
KQ0KCWF0IG9yZy5lY2xpcHNlLnN3dC53aWRnZXRzLlR5cGVkTGlzdGVuZXIuaGFuZGxlRXZlbnQo
VHlwZWRMaXN0ZW5lci5qYXZhOjg4KQ0KCWF0IG9yZy5lY2xpcHNlLnN3dC53aWRnZXRzLkV2ZW50
VGFibGUuc2VuZEV2ZW50KEV2ZW50VGFibGUuamF2YTo4NCkNCglhdCBvcmcuZWNsaXBzZS5zd3Qu
d2lkZ2V0cy5XaWRnZXQuc2VuZEV2ZW50KFdpZGdldC5qYXZhOjEwNTMpDQoJYXQgb3JnLmVjbGlw
c2Uuc3d0LndpZGdldHMuV2lkZ2V0LnNlbmRFdmVudChXaWRnZXQuamF2YToxMDc3KQ0KCWF0IG9y
Zy5lY2xpcHNlLnN3dC53aWRnZXRzLldpZGdldC5zZW5kRXZlbnQoV2lkZ2V0LmphdmE6MTA1OCkN
CglhdCBvcmcuZWNsaXBzZS5zd3Qud2lkZ2V0cy5EZWNvcmF0aW9ucy5XTV9BQ1RJVkFURShEZWNv
cmF0aW9ucy5qYXZhOjE2NDcpDQoJYXQgb3JnLmVjbGlwc2Uuc3d0LndpZGdldHMuU2hlbGwuV01f
QUNUSVZBVEUoU2hlbGwuamF2YToyMTM0KQ0KCWF0IG9yZy5lY2xpcHNlLnN3dC53aWRnZXRzLkNv
bnRyb2wud2luZG93UHJvYyhDb250cm9sLmphdmE6NDUwOCkNCglhdCBvcmcuZWNsaXBzZS5zd3Qu
d2lkZ2V0cy5DYW52YXMud2luZG93UHJvYyhDYW52YXMuamF2YTozNDEpDQoJYXQgb3JnLmVjbGlw
c2Uuc3d0LndpZGdldHMuRGVjb3JhdGlvbnMud2luZG93UHJvYyhEZWNvcmF0aW9ucy5qYXZhOjE2
MTApDQoJYXQgb3JnLmVjbGlwc2Uuc3d0LndpZGdldHMuU2hlbGwud2luZG93UHJvYyhTaGVsbC5q
YXZhOjIwNTgpDQoJYXQgb3JnLmVjbGlwc2Uuc3d0LndpZGdldHMuRGlzcGxheS53aW5kb3dQcm9j
KERpc3BsYXkuamF2YTo0OTU3KQ0KCWF0IG9yZy5lY2xpcHNlLnN3dC5pbnRlcm5hbC53aW4zMi5P
Uy5EZXN0cm95V2luZG93KE5hdGl2ZSBNZXRob2QpDQoJYXQgb3JnLmVjbGlwc2Uuc3d0LndpZGdl
dHMuQ29udHJvbC5kZXN0cm95V2lkZ2V0KENvbnRyb2wuamF2YTo3NzEpDQoJYXQgb3JnLmVjbGlw
c2Uuc3d0LndpZGdldHMuU2hlbGwuZGVzdHJveVdpZGdldChTaGVsbC5qYXZhOjY5NykNCglhdCBv
cmcuZWNsaXBzZS5zd3Qud2lkZ2V0cy5XaWRnZXQucmVsZWFzZShXaWRnZXQuamF2YTo4MTgpDQoJ
YXQgb3JnLmVjbGlwc2Uuc3d0LndpZGdldHMuV2lkZ2V0LmRpc3Bvc2UoV2lkZ2V0LmphdmE6NDQ2
KQ0KCWF0IG9yZy5lY2xpcHNlLnN3dC53aWRnZXRzLkRlY29yYXRpb25zLmRpc3Bvc2UoRGVjb3Jh
dGlvbnMuamF2YTo0NDcpDQoJYXQgb3JnLmVjbGlwc2Uuc3d0LndpZGdldHMuU2hlbGwuZGlzcG9z
ZShTaGVsbC5qYXZhOjcxNCkNCglhdCBvcmcuZWNsaXBzZS5qZmFjZS53aW5kb3cuV2luZG93LmNs
b3NlKFdpbmRvdy5qYXZhOjMzNSkNCglhdCBvcmcuZWNsaXBzZS5qZmFjZS5kaWFsb2dzLkRpYWxv
Zy5jbG9zZShEaWFsb2cuamF2YTo5NzkpDQoJYXQgb3JnLmVjbGlwc2UuamZhY2UuZGlhbG9ncy5N
ZXNzYWdlRGlhbG9nLmJ1dHRvblByZXNzZWQoTWVzc2FnZURpYWxvZy5qYXZhOjIwNykNCglhdCBv
cmcuZWNsaXBzZS5qZmFjZS5kaWFsb2dzLkRpYWxvZyQyLndpZGdldFNlbGVjdGVkKERpYWxvZy5q
YXZhOjYyNCkNCglhdCBvcmcuZWNsaXBzZS5zd3Qud2lkZ2V0cy5UeXBlZExpc3RlbmVyLmhhbmRs
ZUV2ZW50KFR5cGVkTGlzdGVuZXIuamF2YToyNDApDQoJYXQgb3JnLmVjbGlwc2Uuc3d0LndpZGdl
dHMuRXZlbnRUYWJsZS5zZW5kRXZlbnQoRXZlbnRUYWJsZS5qYXZhOjg0KQ0KCWF0IG9yZy5lY2xp
cHNlLnN3dC53aWRnZXRzLldpZGdldC5zZW5kRXZlbnQoV2lkZ2V0LmphdmE6MTA1MykNCglhdCBv
cmcuZWNsaXBzZS5zd3Qud2lkZ2V0cy5EaXNwbGF5LnJ1bkRlZmVycmVkRXZlbnRzKERpc3BsYXku
amF2YTo0MTUwKQ0KCWF0IG9yZy5lY2xpcHNlLnN3dC53aWRnZXRzLkRpc3BsYXkucmVhZEFuZERp
c3BhdGNoKERpc3BsYXkuamF2YTozNzM5KQ0KCWF0IG9yZy5lY2xpcHNlLmpmYWNlLndpbmRvdy5X
aW5kb3cucnVuRXZlbnRMb29wKFdpbmRvdy5qYXZhOjgyNSkNCglhdCBvcmcuZWNsaXBzZS5qZmFj
ZS53aW5kb3cuV2luZG93Lm9wZW4oV2luZG93LmphdmE6ODAxKQ0KCWF0IG9yZy5lY2xpcHNlLmpm
YWNlLmRpYWxvZ3MuTWVzc2FnZURpYWxvZy5vcGVuKE1lc3NhZ2VEaWFsb2cuamF2YTozMzQpDQoJ
YXQgb3JnLmVjbGlwc2UudWkuaW50ZXJuYWwuU2F2ZWFibGVzTGlzdC5wcm9tcHRGb3JTYXZpbmco
U2F2ZWFibGVzTGlzdC5qYXZhOjUyOSkNCglhdCBvcmcuZWNsaXBzZS51aS5pbnRlcm5hbC5TYXZl
YWJsZXNMaXN0LnByb21wdEZvclNhdmluZ0lmTmVjZXNzYXJ5KFNhdmVhYmxlc0xpc3QuamF2YTo0
MzMpDQoJYXQgb3JnLmVjbGlwc2UudWkuaW50ZXJuYWwuU2F2ZWFibGVzTGlzdC5wcmVDbG9zZVBh
cnRzKFNhdmVhYmxlc0xpc3QuamF2YTozODgpDQoJYXQgb3JnLmVjbGlwc2UudWkuaW50ZXJuYWwu
U2F2ZWFibGVzTGlzdC5wcmVDbG9zZVBhcnRzKFNhdmVhYmxlc0xpc3QuamF2YTozNDcpDQoJYXQg
b3JnLmVjbGlwc2UudWkuaW50ZXJuYWwuV29ya2JlbmNoUGFnZS5jbG9zZUVkaXRvcnMoV29ya2Jl
bmNoUGFnZS5qYXZhOjE0MjYpDQoJYXQgb3JnLmVjbGlwc2UudWkuaW50ZXJuYWwuV29ya2JlbmNo
UGFnZS5jbG9zZUVkaXRvcihXb3JrYmVuY2hQYWdlLmphdmE6MTUxNCkNCglhdCBvcmcuZWNsaXBz
ZS51aS5pbnRlcm5hbC5FZGl0b3JQYW5lLmRvSGlkZShFZGl0b3JQYW5lLmphdmE6NjEpDQoJYXQg
b3JnLmVjbGlwc2UudWkuaW50ZXJuYWwuUGFydFN0YWNrLmNsb3NlKFBhcnRTdGFjay5qYXZhOjUz
NykNCglhdCBvcmcuZWNsaXBzZS51aS5pbnRlcm5hbC5FZGl0b3JTdGFjay5jbG9zZShFZGl0b3JT
dGFjay5qYXZhOjIwNikNCglhdCBvcmcuZWNsaXBzZS51aS5pbnRlcm5hbC5QYXJ0U3RhY2skMS5j
bG9zZShQYXJ0U3RhY2suamF2YToxMjApDQoJYXQgb3JnLmVjbGlwc2UudWkuaW50ZXJuYWwucHJl
c2VudGF0aW9ucy51dGlsLlRhYmJlZFN0YWNrUHJlc2VudGF0aW9uJDEuaGFuZGxlRXZlbnQoVGFi
YmVkU3RhY2tQcmVzZW50YXRpb24uamF2YTo4MykNCglhdCBvcmcuZWNsaXBzZS51aS5pbnRlcm5h
bC5wcmVzZW50YXRpb25zLnV0aWwuQWJzdHJhY3RUYWJGb2xkZXIuZmlyZUV2ZW50KEFic3RyYWN0
VGFiRm9sZGVyLmphdmE6MjY5KQ0KCWF0IG9yZy5lY2xpcHNlLnVpLmludGVybmFsLnByZXNlbnRh
dGlvbnMudXRpbC5BYnN0cmFjdFRhYkZvbGRlci5maXJlRXZlbnQoQWJzdHJhY3RUYWJGb2xkZXIu
amF2YToyNzgpDQoJYXQgb3JnLmVjbGlwc2UudWkuaW50ZXJuYWwucHJlc2VudGF0aW9ucy5kZWZh
dWx0cHJlc2VudGF0aW9uLkRlZmF1bHRUYWJGb2xkZXIuYWNjZXNzJDEoRGVmYXVsdFRhYkZvbGRl
ci5qYXZhOjEpDQoJYXQgb3JnLmVjbGlwc2UudWkuaW50ZXJuYWwucHJlc2VudGF0aW9ucy5kZWZh
dWx0cHJlc2VudGF0aW9uLkRlZmF1bHRUYWJGb2xkZXIkMS5jbG9zZUJ1dHRvblByZXNzZWQoRGVm
YXVsdFRhYkZvbGRlci5qYXZhOjcxKQ0KCWF0IG9yZy5lY2xpcHNlLnVpLmludGVybmFsLnByZXNl
bnRhdGlvbnMuUGFuZUZvbGRlci5ub3RpZnlDbG9zZUxpc3RlbmVycyhQYW5lRm9sZGVyLmphdmE6
NjMxKQ0KCWF0IG9yZy5lY2xpcHNlLnVpLmludGVybmFsLnByZXNlbnRhdGlvbnMuUGFuZUZvbGRl
ciQ0Lm1vdXNlVXAoUGFuZUZvbGRlci5qYXZhOjIzMCkNCglhdCBvcmcuZWNsaXBzZS5zd3Qud2lk
Z2V0cy5UeXBlZExpc3RlbmVyLmhhbmRsZUV2ZW50KFR5cGVkTGlzdGVuZXIuamF2YToyMTkpDQoJ
YXQgb3JnLmVjbGlwc2Uuc3d0LndpZGdldHMuRXZlbnRUYWJsZS5zZW5kRXZlbnQoRXZlbnRUYWJs
ZS5qYXZhOjg0KQ0KCWF0IG9yZy5lY2xpcHNlLnN3dC53aWRnZXRzLldpZGdldC5zZW5kRXZlbnQo
V2lkZ2V0LmphdmE6MTA1MykNCglhdCBvcmcuZWNsaXBzZS5zd3Qud2lkZ2V0cy5EaXNwbGF5LnJ1
bkRlZmVycmVkRXZlbnRzKERpc3BsYXkuamF2YTo0MTUwKQ0KCWF0IG9yZy5lY2xpcHNlLnN3dC53
aWRnZXRzLkRpc3BsYXkucmVhZEFuZERpc3BhdGNoKERpc3BsYXkuamF2YTozNzM5KQ0KCWF0IG9y
Zy5lY2xpcHNlLnVpLmludGVybmFsLldvcmtiZW5jaC5ydW5FdmVudExvb3AoV29ya2JlbmNoLmph
dmE6MjY5NikNCglhdCBvcmcuZWNsaXBzZS51aS5pbnRlcm5hbC5Xb3JrYmVuY2gucnVuVUkoV29y
a2JlbmNoLmphdmE6MjY2MCkNCglhdCBvcmcuZWNsaXBzZS51aS5pbnRlcm5hbC5Xb3JrYmVuY2gu
YWNjZXNzJDQoV29ya2JlbmNoLmphdmE6MjQ5NCkNCglhdCBvcmcuZWNsaXBzZS51aS5pbnRlcm5h
bC5Xb3JrYmVuY2gkNy5ydW4oV29ya2JlbmNoLmphdmE6Njc0KQ0KCWF0IG9yZy5lY2xpcHNlLmNv
cmUuZGF0YWJpbmRpbmcub2JzZXJ2YWJsZS5SZWFsbS5ydW5XaXRoRGVmYXVsdChSZWFsbS5qYXZh
OjMzMikNCglhdCBvcmcuZWNsaXBzZS51aS5pbnRlcm5hbC5Xb3JrYmVuY2guY3JlYXRlQW5kUnVu
V29ya2JlbmNoKFdvcmtiZW5jaC5qYXZhOjY2NykNCglhdCBvcmcuZWNsaXBzZS51aS5QbGF0Zm9y
bVVJLmNyZWF0ZUFuZFJ1bldvcmtiZW5jaChQbGF0Zm9ybVVJLmphdmE6MTQ5KQ0KCWF0IG9yZy5l
Y2xpcHNlLnVpLmludGVybmFsLmlkZS5hcHBsaWNhdGlvbi5JREVBcHBsaWNhdGlvbi5zdGFydChJ
REVBcHBsaWNhdGlvbi5qYXZhOjEyMykNCglhdCBvcmcuZWNsaXBzZS5lcXVpbm94LmludGVybmFs
LmFwcC5FY2xpcHNlQXBwSGFuZGxlLnJ1bihFY2xpcHNlQXBwSGFuZGxlLmphdmE6MTk2KQ0KCWF0
IG9yZy5lY2xpcHNlLmNvcmUucnVudGltZS5pbnRlcm5hbC5hZGFwdG9yLkVjbGlwc2VBcHBMYXVu
Y2hlci5ydW5BcHBsaWNhdGlvbihFY2xpcHNlQXBwTGF1bmNoZXIuamF2YToxMTApDQoJYXQgb3Jn
LmVjbGlwc2UuY29yZS5ydW50aW1lLmludGVybmFsLmFkYXB0b3IuRWNsaXBzZUFwcExhdW5jaGVy
LnN0YXJ0KEVjbGlwc2VBcHBMYXVuY2hlci5qYXZhOjc5KQ0KCWF0IG9yZy5lY2xpcHNlLmNvcmUu
cnVudGltZS5hZGFwdG9yLkVjbGlwc2VTdGFydGVyLnJ1bihFY2xpcHNlU3RhcnRlci5qYXZhOjM0
NCkNCglhdCBvcmcuZWNsaXBzZS5jb3JlLnJ1bnRpbWUuYWRhcHRvci5FY2xpcHNlU3RhcnRlci5y
dW4oRWNsaXBzZVN0YXJ0ZXIuamF2YToxNzkpDQoJYXQgc3VuLnJlZmxlY3QuTmF0aXZlTWV0aG9k
QWNjZXNzb3JJbXBsLmludm9rZTAoTmF0aXZlIE1ldGhvZCkNCglhdCBzdW4ucmVmbGVjdC5OYXRp
dmVNZXRob2RBY2Nlc3NvckltcGwuaW52b2tlKE5hdGl2ZU1ldGhvZEFjY2Vzc29ySW1wbC5qYXZh
OjM5KQ0KCWF0IHN1bi5yZWZsZWN0LkRlbGVnYXRpbmdNZXRob2RBY2Nlc3NvckltcGwuaW52b2tl
KERlbGVnYXRpbmdNZXRob2RBY2Nlc3NvckltcGwuamF2YToyNSkNCglhdCBqYXZhLmxhbmcucmVm
bGVjdC5NZXRob2QuaW52b2tlKE1ldGhvZC5qYXZhOjU5NykNCglhdCBvcmcuZWNsaXBzZS5lcXVp
bm94LmxhdW5jaGVyLk1haW4uaW52b2tlRnJhbWV3b3JrKE1haW4uamF2YTo2MjIpDQoJYXQgb3Jn
LmVjbGlwc2UuZXF1aW5veC5sYXVuY2hlci5NYWluLmJhc2ljUnVuKE1haW4uamF2YTo1NzcpDQoJ
YXQgb3JnLmVjbGlwc2UuZXF1aW5veC5sYXVuY2hlci5NYWluLnJ1bihNYWluLmphdmE6MTQxMCkN
Cg0K
</data>

          </attachment>
          <attachment
              isobsolete="1"
              ispatch="0"
              isprivate="0"
          >
            <attachid>193148</attachid>
            <date>2011-04-13 07:21:00 -0400</date>
            <delta_ts>2011-04-13 09:10:52 -0400</delta_ts>
            <desc>foo.zip</desc>
            <filename>foo.zip</filename>
            <type>application/octet-stream</type>
            <size>3108</size>
            <attacher name="Philippe Coucaud">phil_fj12</attacher>
            
              <data encoding="base64">UEsDBBQACAAIAGFojT4AAAAAAAAAAAAAAAAOAAAARm9vLy5jbGFzc3BhdGh9j0sLwjAQhM8K/oeS
u1u9iIdWEamgoIJWrxKTpUbjpuQh9t/7RhH0NjN8y84k/fNRRye0ThlKWRtaLEISRioqUrbKR80u
6/ca9URo7lzJ/e5qam+H5G0VHRTJlDkrWHQLHzL+TQpDL9LYAlBoVTqEvfSgeSCxu36HySLbDOez
fDCeZYv4m1Pk0RLXIHEbCgjqeYkWlp6T5Faup3lVYjzhJ77Mmm3o/Ktkgi+Df7XaKrrDSfy5+wJQ
SwcIbfrPKrcAAAAtAQAAUEsDBBQACAAIAGFojT4AAAAAAAAAAAAAAAAMAAAARm9vLy5wcm9qZWN0
dVBBDsIgEDxr4h8a7oLePND2oOkH1AcgbBqaFgjQxucLlNrUxNvO7MzOAK3fQ19MYJ3UqkRnfEIF
KK6FVG2Jno/meEF1ddhTY3UH3N/AcSuND+rA7qhiA1SN1pSkKVJcDwMoX1GyTJHNfpcA2aDXKHtx
N8AjyvAarEyJxOQUbVsMvJfGAe6Ex1zbMLCJJQPYtUJwMNuOMdtlTLYEJb8pmVlqhEg/WsjqGfxv
MO9jgaRL59YD3+duP+8DUEsHCNBFRKK6AAAAewEAAFBLAwQUAAgACABhaI0+AAAAAAAAAAAAAAAA
KAAAAEZvby8uc2V0dGluZ3Mvb3JnLmVjbGlwc2UuamR0LmNvcmUucHJlZnOVkMtKAzEUhveC7zDg
PnQquChkoVJBEREqus4k/wxHcuMkKfTte4bqujNwCCHJl/9y9wPXPWbu+nuZ3UZm2z3vD1/ddtP3
tzewnnKByowRjGhR1BFcKEUt14kn9f/k11VlE0OWkMmDZeMwISqKniLeCj+dKuZDjWgGD7f0g2p4
Qv30po6Jg+7Vw1KyxVbg3pM1XkuGAj7iOhuyJyNZlyg5DG1Sc8CPFgawFlmwqVdl/sDZ2rdhmgtZ
yZbU2OKFVoCZk+gEZYpUUV8dYqWRxDWYEy+lEVtYy17MXho9A1BLBwgeM1hN3QAAAHYCAABQSwME
FAAIAAgA7WmNPgAAAAAAAAAAAAAAABgAAABGb28vYmluL2Zvby9iYXIvSTAuY2xhc3M79W/XPgYG
BiMGTnYGJkYGrrT8fP2kxCJ9TwN2BhZGBoGsxLJE/ZzEvHR9/6Ss1OQSoJLg/NKi5FS3zJxURgZ2
TwM9kBJGBs7gzPS8xJLSIqCohk2IlQ+6Tms7TCE2RgZGBmYGCGBiYAWTbAzsYJoDAFBLBwgr1Eb5
cQAAAJwAAABQSwMEFAAIAAgA6WmNPgAAAAAAAAAAAAAAABgAAABGb28vYmluL2Zvby9iYXIvSTEu
Y2xhc3M79W/XPgYGBiMGbnYGJkYGrrT8fP2kxCJ9T0N2BhZGBoGsxLJE/ZzEvHR9/6Ss1OQSdgY2
ZFUGQE5wfmlRcqpbZk4qIwO7p6EeSAsjA2dwZnpeYklpEVBUzwfdGGsfhBE2cHaEjZadtZ010AZG
BmYgZmUAASYGdjDJwcAJprkAUEsHCDDC5IJ/AAAAtAAAAFBLAwQUAAgACAB7aY0+AAAAAAAAAAAA
AAAAGAAAAEZvby9iaW4vZm9vL2Jhci9JMi5jbGFzczv1b9c+BgYGIwYedgYmRgautPx8/aTEIn1P
I3YGFkYGgazEskT9nMS8dH3/pKzU5BJGBr701BLPvJTM5MSSzPy8YkYGfg3NaB+4PgNrRgbO4Mz0
vMSS0qJURgY2oGxICFCQKzi/tCg51S0zByjK7mmkBzKakUHNJsTKCkm7jZadtZ0PurXWbIwMjAzM
DCDACHQXKwMbkM8O5DExcAAxJ5jFBRXhBgBQSwcIQN023KYAAADWAAAAUEsDBBQACAAIALNpjT4A
AAAAAAAAAAAAAAAXAAAARm9vL2Jpbi9mb28vYmFyL1guY2xhc3NlUMFKw0AUnNekiU2jjVV796Ye
DPZoQkAFQQh6aCi9buJat8RE0kTwszwJHvwAP0p8idZQZdmZ9+YN7Jv9+Hx7BzDGyESH0LvLczcW
hTszoROchXgSbiqyuXsTL2RSmjAI1sp0NSYYvspUGRC0g8MpQb/Ib6UFDX0bJjYIg1Bl8rp6iGUR
iTiVhGGYJyKdikLV/Y+ol/dqSeiHvwt4hNG68/lx5XZamx9FXsBea5JXRSIvVT03Zsf15pxnouaZ
KKuCxXM/Og3/BvKC/1LY5vPb+oSf0ffBQfl2+c+ID0dk7HF31vRA9+gV1gsXGmxGoxF1bDLa3wZs
YcDsrCnbzB0MG9zBbsN7X1BLBwjVzPQABwEAAJ0BAABQSwMEFAAIAAgA7WmNPgAAAAAAAAAAAAAA
ABcAAABGb28vc3JjL2Zvby9iYXIvSTAuamF2YStITM5OTE9VSMvP10tKLLLm5eLlKihNyslMVsjM
K0ktSktMTlXwNLAJsVOo5uWq5eUCAFBLBwgQWPP1MwAAADEAAABQSwMEFAAIAAgA6WmNPgAAAAAA
AAAAAAAAABcAAABGb28vc3JjL2Zvby9iYXIvSTEuamF2YStITM5OTE9VSMvP10tKLLLm5eLlKihN
yslMVsjMK0ktSktMTlXwNFRIrShJzUspVvA0sImwsbezU6jm5arl5QIAUEsHCB5F53lBAAAAPwAA
AFBLAwQUAAgACAB6aY0+AAAAAAAAAAAAAAAAFwAAAEZvby9zcmMvZm9vL2Jhci9JMi5qYXZhK0hM
zk5MT1VIy8/XS0ossubl4uUqKE3KyUxWyMwrSS1KS0xOVfA0sglRSK0oSc1LKVbwNLCxt7NTqObl
4oQqDImOVUhPLfHMS8lMTizJzM8r1tAEGlTLywUAUEsHCJ5WWd5aAAAAXgAAAFBLAwQUAAgACACz
aY0+AAAAAAAAAAAAAAAAFgAAAEZvby9zcmMvZm9vL2Jhci9YLmphdmErSEzOTkxPVUjLz9dLSiyy
5uUCwYLSpJzMZIXEpOKSosTkEoXknMTiYoUImxA7hczcgpzU3NS8kmIFTyMbT0M7hWqQDk6oFk9D
oKLoWIU0DU2QBCdnUWpJaVGeQl5pTg7QcM5aXi4gAgBQSwcIDomPDmkAAAB2AAAAUEsBAhQAFAAI
AAgAYWiNPm36zyq3AAAALQEAAA4AAAAAAAAAAAAAAAAAAAAAAEZvby8uY2xhc3NwYXRoUEsBAhQA
FAAIAAgAYWiNPtBFRKK6AAAAewEAAAwAAAAAAAAAAAAAAAAA8wAAAEZvby8ucHJvamVjdFBLAQIU
ABQACAAIAGFojT4eM1hN3QAAAHYCAAAoAAAAAAAAAAAAAAAAAOcBAABGb28vLnNldHRpbmdzL29y
Zy5lY2xpcHNlLmpkdC5jb3JlLnByZWZzUEsBAhQAFAAIAAgA7WmNPivURvlxAAAAnAAAABgAAAAA
AAAAAAAAAAAAGgMAAEZvby9iaW4vZm9vL2Jhci9JMC5jbGFzc1BLAQIUABQACAAIAOlpjT4wwuSC
fwAAALQAAAAYAAAAAAAAAAAAAAAAANEDAABGb28vYmluL2Zvby9iYXIvSTEuY2xhc3NQSwECFAAU
AAgACAB7aY0+QN023KYAAADWAAAAGAAAAAAAAAAAAAAAAACWBAAARm9vL2Jpbi9mb28vYmFyL0ky
LmNsYXNzUEsBAhQAFAAIAAgAs2mNPtXM9AAHAQAAnQEAABcAAAAAAAAAAAAAAAAAggUAAEZvby9i
aW4vZm9vL2Jhci9YLmNsYXNzUEsBAhQAFAAIAAgA7WmNPhBY8/UzAAAAMQAAABcAAAAAAAAAAAAA
AAAAzgYAAEZvby9zcmMvZm9vL2Jhci9JMC5qYXZhUEsBAhQAFAAIAAgA6WmNPh5F53lBAAAAPwAA
ABcAAAAAAAAAAAAAAAAARgcAAEZvby9zcmMvZm9vL2Jhci9JMS5qYXZhUEsBAhQAFAAIAAgAemmN
Pp5WWd5aAAAAXgAAABcAAAAAAAAAAAAAAAAAzAcAAEZvby9zcmMvZm9vL2Jhci9JMi5qYXZhUEsB
AhQAFAAIAAgAs2mNPg6Jjw5pAAAAdgAAABYAAAAAAAAAAAAAAAAAawgAAEZvby9zcmMvZm9vL2Jh
ci9YLmphdmFQSwUGAAAAAAsACwD2AgAAGAkAAAAA
</data>

          </attachment>
          <attachment
              isobsolete="1"
              ispatch="1"
              isprivate="0"
          >
            <attachid>193157</attachid>
            <date>2011-04-13 08:30:00 -0400</date>
            <delta_ts>2011-04-13 09:10:52 -0400</delta_ts>
            <desc>proposed fix</desc>
            <filename>patch342671.txt</filename>
            <type>text/plain</type>
            <size>2021</size>
            <attacher name="Ayushman Jain">amj87.iitr</attacher>
            
              <data encoding="base64">IyMjIEVjbGlwc2UgV29ya3NwYWNlIFBhdGNoIDEuMA0KI1Agb3JnLmVjbGlwc2UuamR0LmNvcmUN
CkluZGV4OiBkb20vb3JnL2VjbGlwc2UvamR0L2NvcmUvZG9tL0RlZmF1bHRCaW5kaW5nUmVzb2x2
ZXIuamF2YQ0KPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09
PT09PT09PT09PT09PT09PT09PQ0KUkNTIGZpbGU6IC9jdnNyb290L2VjbGlwc2Uvb3JnLmVjbGlw
c2UuamR0LmNvcmUvZG9tL29yZy9lY2xpcHNlL2pkdC9jb3JlL2RvbS9EZWZhdWx0QmluZGluZ1Jl
c29sdmVyLmphdmEsdg0KcmV0cmlldmluZyByZXZpc2lvbiAxLjE3Mg0KZGlmZiAtdSAtcjEuMTcy
IERlZmF1bHRCaW5kaW5nUmVzb2x2ZXIuamF2YQ0KLS0tIGRvbS9vcmcvZWNsaXBzZS9qZHQvY29y
ZS9kb20vRGVmYXVsdEJpbmRpbmdSZXNvbHZlci5qYXZhCTI0IEZlYiAyMDExIDE5OjMxOjM3IC0w
MDAwCTEuMTcyDQorKysgZG9tL29yZy9lY2xpcHNlL2pkdC9jb3JlL2RvbS9EZWZhdWx0QmluZGlu
Z1Jlc29sdmVyLmphdmEJMTMgQXByIDIwMTEgMTI6Mjk6MjAgLTAwMDANCkBAIC0xNTIzLDggKzE1
MjMsMTEgQEANCiAJCQkJCQlyZXR1cm4gbnVsbDsNCiAJCQkJCX0NCiAJCQkJCUFycmF5VHlwZSBh
cnJheVR5cGUgPSAoQXJyYXlUeXBlKSB0eXBlOw0KLQkJCQkJQXJyYXlCaW5kaW5nIGFycmF5Qmlu
ZGluZyA9IChBcnJheUJpbmRpbmcpIHR5cGVCaW5kaW5nOw0KLQkJCQkJcmV0dXJuIGdldFR5cGVC
aW5kaW5nKHRoaXMuc2NvcGUuY3JlYXRlQXJyYXlUeXBlKGFycmF5QmluZGluZy5sZWFmQ29tcG9u
ZW50VHlwZSwgYXJyYXlUeXBlLmdldERpbWVuc2lvbnMoKSkpOw0KKwkJCQkJaWYgKHR5cGVCaW5k
aW5nLmlzQXJyYXlUeXBlKCkpIHsNCisJCQkJCQlBcnJheUJpbmRpbmcgYXJyYXlCaW5kaW5nID0g
KEFycmF5QmluZGluZykgdHlwZUJpbmRpbmc7DQorCQkJCQkJcmV0dXJuIGdldFR5cGVCaW5kaW5n
KHRoaXMuc2NvcGUuY3JlYXRlQXJyYXlUeXBlKGFycmF5QmluZGluZy5sZWFmQ29tcG9uZW50VHlw
ZSwgYXJyYXlUeXBlLmdldERpbWVuc2lvbnMoKSkpOw0KKwkJCQkJfQ0KKwkJCQkJcmV0dXJuIGdl
dFR5cGVCaW5kaW5nKHRoaXMuc2NvcGUuY3JlYXRlQXJyYXlUeXBlKGJpbmRpbmcsIGFycmF5VHlw
ZS5nZXREaW1lbnNpb25zKCkpKTsNCiAJCQkJfQ0KIAkJCQlpZiAodHlwZUJpbmRpbmcuaXNBcnJh
eVR5cGUoKSkgew0KIAkJCQkJdHlwZUJpbmRpbmcgPSAoKEFycmF5QmluZGluZykgdHlwZUJpbmRp
bmcpLmxlYWZDb21wb25lbnRUeXBlOw0KQEAgLTE1NjQsOCArMTU2NywxMSBAQA0KIAkJCQkJaWYg
KHRoaXMuc2NvcGUgPT0gbnVsbCkgew0KIAkJCQkJCXJldHVybiBudWxsOw0KIAkJCQkJfQ0KLQkJ
CQkJQXJyYXlCaW5kaW5nIGFycmF5QmluZGluZyA9IChBcnJheUJpbmRpbmcpIGJpbmRpbmc7DQot
CQkJCQlyZXR1cm4gZ2V0VHlwZUJpbmRpbmcodGhpcy5zY29wZS5jcmVhdGVBcnJheVR5cGUoYXJy
YXlCaW5kaW5nLmxlYWZDb21wb25lbnRUeXBlLCBhcnJheVR5cGUuZ2V0RGltZW5zaW9ucygpKSk7
DQorCQkJCQlpZiAoYmluZGluZy5pc0FycmF5VHlwZSgpKSB7DQorCQkJCQkJQXJyYXlCaW5kaW5n
IGFycmF5QmluZGluZyA9IChBcnJheUJpbmRpbmcpIGJpbmRpbmc7DQorCQkJCQkJcmV0dXJuIGdl
dFR5cGVCaW5kaW5nKHRoaXMuc2NvcGUuY3JlYXRlQXJyYXlUeXBlKGFycmF5QmluZGluZy5sZWFm
Q29tcG9uZW50VHlwZSwgYXJyYXlUeXBlLmdldERpbWVuc2lvbnMoKSkpOw0KKwkJCQkJfQ0KKwkJ
CQkJcmV0dXJuIGdldFR5cGVCaW5kaW5nKHRoaXMuc2NvcGUuY3JlYXRlQXJyYXlUeXBlKGJpbmRp
bmcsIGFycmF5VHlwZS5nZXREaW1lbnNpb25zKCkpKTsNCiAJCQkJfSBlbHNlIGlmIChiaW5kaW5n
LmlzQXJyYXlUeXBlKCkpIHsNCiAJCQkJCUFycmF5QmluZGluZyBhcnJheUJpbmRpbmcgPSAoQXJy
YXlCaW5kaW5nKSBiaW5kaW5nOw0KIAkJCQkJcmV0dXJuIGdldFR5cGVCaW5kaW5nKGFycmF5Qmlu
ZGluZy5sZWFmQ29tcG9uZW50VHlwZSk7DQo=
</data>

          </attachment>
          <attachment
              isobsolete="0"
              ispatch="1"
              isprivate="0"
          >
            <attachid>193158</attachid>
            <date>2011-04-13 09:10:00 -0400</date>
            <delta_ts>2011-04-13 09:10:52 -0400</delta_ts>
            <desc>Proposed fix + regression tests</desc>
            <filename>patch_342671.txt</filename>
            <type>text/plain</type>
            <size>8004</size>
            <attacher name="Olivier Thomann">Olivier_Thomann</attacher>
            
              <data encoding="base64">IyMjIEVjbGlwc2UgV29ya3NwYWNlIFBhdGNoIDEuMA0KI1Agb3JnLmVjbGlwc2UuamR0LmNvcmUN
CkluZGV4OiBkb20vb3JnL2VjbGlwc2UvamR0L2NvcmUvZG9tL0RlZmF1bHRCaW5kaW5nUmVzb2x2
ZXIuamF2YQ0KPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09
PT09PT09PT09PT09PT09PT09PQ0KUkNTIGZpbGU6IC9jdnNyb290L2VjbGlwc2Uvb3JnLmVjbGlw
c2UuamR0LmNvcmUvZG9tL29yZy9lY2xpcHNlL2pkdC9jb3JlL2RvbS9EZWZhdWx0QmluZGluZ1Jl
c29sdmVyLmphdmEsdg0KcmV0cmlldmluZyByZXZpc2lvbiAxLjE3Mg0KZGlmZiAtdSAtcjEuMTcy
IERlZmF1bHRCaW5kaW5nUmVzb2x2ZXIuamF2YQ0KLS0tIGRvbS9vcmcvZWNsaXBzZS9qZHQvY29y
ZS9kb20vRGVmYXVsdEJpbmRpbmdSZXNvbHZlci5qYXZhCTI0IEZlYiAyMDExIDE5OjMxOjM3IC0w
MDAwCTEuMTcyDQorKysgZG9tL29yZy9lY2xpcHNlL2pkdC9jb3JlL2RvbS9EZWZhdWx0QmluZGlu
Z1Jlc29sdmVyLmphdmEJMTMgQXByIDIwMTEgMTM6MDk6MTkgLTAwMDANCkBAIC0xNTIzLDggKzE1
MjMsMTEgQEANCiAJCQkJCQlyZXR1cm4gbnVsbDsNCiAJCQkJCX0NCiAJCQkJCUFycmF5VHlwZSBh
cnJheVR5cGUgPSAoQXJyYXlUeXBlKSB0eXBlOw0KLQkJCQkJQXJyYXlCaW5kaW5nIGFycmF5Qmlu
ZGluZyA9IChBcnJheUJpbmRpbmcpIHR5cGVCaW5kaW5nOw0KLQkJCQkJcmV0dXJuIGdldFR5cGVC
aW5kaW5nKHRoaXMuc2NvcGUuY3JlYXRlQXJyYXlUeXBlKGFycmF5QmluZGluZy5sZWFmQ29tcG9u
ZW50VHlwZSwgYXJyYXlUeXBlLmdldERpbWVuc2lvbnMoKSkpOw0KKwkJCQkJaWYgKHR5cGVCaW5k
aW5nLmlzQXJyYXlUeXBlKCkpIHsNCisJCQkJCQlBcnJheUJpbmRpbmcgYXJyYXlCaW5kaW5nID0g
KEFycmF5QmluZGluZykgdHlwZUJpbmRpbmc7DQorCQkJCQkJcmV0dXJuIGdldFR5cGVCaW5kaW5n
KHRoaXMuc2NvcGUuY3JlYXRlQXJyYXlUeXBlKGFycmF5QmluZGluZy5sZWFmQ29tcG9uZW50VHlw
ZSwgYXJyYXlUeXBlLmdldERpbWVuc2lvbnMoKSkpOw0KKwkJCQkJfQ0KKwkJCQkJcmV0dXJuIGdl
dFR5cGVCaW5kaW5nKHRoaXMuc2NvcGUuY3JlYXRlQXJyYXlUeXBlKHR5cGVCaW5kaW5nLCBhcnJh
eVR5cGUuZ2V0RGltZW5zaW9ucygpKSk7DQogCQkJCX0NCiAJCQkJaWYgKHR5cGVCaW5kaW5nLmlz
QXJyYXlUeXBlKCkpIHsNCiAJCQkJCXR5cGVCaW5kaW5nID0gKChBcnJheUJpbmRpbmcpIHR5cGVC
aW5kaW5nKS5sZWFmQ29tcG9uZW50VHlwZTsNCkBAIC0xNTY0LDggKzE1NjcsMTEgQEANCiAJCQkJ
CWlmICh0aGlzLnNjb3BlID09IG51bGwpIHsNCiAJCQkJCQlyZXR1cm4gbnVsbDsNCiAJCQkJCX0N
Ci0JCQkJCUFycmF5QmluZGluZyBhcnJheUJpbmRpbmcgPSAoQXJyYXlCaW5kaW5nKSBiaW5kaW5n
Ow0KLQkJCQkJcmV0dXJuIGdldFR5cGVCaW5kaW5nKHRoaXMuc2NvcGUuY3JlYXRlQXJyYXlUeXBl
KGFycmF5QmluZGluZy5sZWFmQ29tcG9uZW50VHlwZSwgYXJyYXlUeXBlLmdldERpbWVuc2lvbnMo
KSkpOw0KKwkJCQkJaWYgKGJpbmRpbmcuaXNBcnJheVR5cGUoKSkgew0KKwkJCQkJCUFycmF5Qmlu
ZGluZyBhcnJheUJpbmRpbmcgPSAoQXJyYXlCaW5kaW5nKSBiaW5kaW5nOw0KKwkJCQkJCXJldHVy
biBnZXRUeXBlQmluZGluZyh0aGlzLnNjb3BlLmNyZWF0ZUFycmF5VHlwZShhcnJheUJpbmRpbmcu
bGVhZkNvbXBvbmVudFR5cGUsIGFycmF5VHlwZS5nZXREaW1lbnNpb25zKCkpKTsNCisJCQkJCX0N
CisJCQkJCXJldHVybiBnZXRUeXBlQmluZGluZyh0aGlzLnNjb3BlLmNyZWF0ZUFycmF5VHlwZShi
aW5kaW5nLCBhcnJheVR5cGUuZ2V0RGltZW5zaW9ucygpKSk7DQogCQkJCX0gZWxzZSBpZiAoYmlu
ZGluZy5pc0FycmF5VHlwZSgpKSB7DQogCQkJCQlBcnJheUJpbmRpbmcgYXJyYXlCaW5kaW5nID0g
KEFycmF5QmluZGluZykgYmluZGluZzsNCiAJCQkJCXJldHVybiBnZXRUeXBlQmluZGluZyhhcnJh
eUJpbmRpbmcubGVhZkNvbXBvbmVudFR5cGUpOw0KI1Agb3JnLmVjbGlwc2UuamR0LmNvcmUudGVz
dHMubW9kZWwNCkluZGV4OiBzcmMvb3JnL2VjbGlwc2UvamR0L2NvcmUvdGVzdHMvZG9tL0FTVENv
bnZlcnRlcjE1VGVzdC5qYXZhDQo9PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09
PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09DQpSQ1MgZmlsZTogL2N2c3Jvb3QvZWNsaXBz
ZS9vcmcuZWNsaXBzZS5qZHQuY29yZS50ZXN0cy5tb2RlbC9zcmMvb3JnL2VjbGlwc2UvamR0L2Nv
cmUvdGVzdHMvZG9tL0FTVENvbnZlcnRlcjE1VGVzdC5qYXZhLHYNCnJldHJpZXZpbmcgcmV2aXNp
b24gMS4zMDUNCmRpZmYgLXUgLXIxLjMwNSBBU1RDb252ZXJ0ZXIxNVRlc3QuamF2YQ0KLS0tIHNy
Yy9vcmcvZWNsaXBzZS9qZHQvY29yZS90ZXN0cy9kb20vQVNUQ29udmVydGVyMTVUZXN0LmphdmEJ
NyBBcHIgMjAxMSAxNzoyNTo1MiAtMDAwMAkxLjMwNQ0KKysrIHNyYy9vcmcvZWNsaXBzZS9qZHQv
Y29yZS90ZXN0cy9kb20vQVNUQ29udmVydGVyMTVUZXN0LmphdmEJMTMgQXByIDIwMTEgMTM6MDk6
MjAgLTAwMDANCkBAIC00Nyw3ICs0Nyw3IEBADQogCX0NCiANCiAJc3RhdGljIHsNCi0vLwkJVEVT
VFNfTlVNQkVSUyA9IG5ldyBpbnRbXSB7IDM1MCB9Ow0KKy8vCQlURVNUU19OVU1CRVJTID0gbmV3
IGludFtdIHsgMzUxLCAzNTIgfTsNCiAvLwkJVEVTVFNfUkFOR0UgPSBuZXcgaW50W10geyAzMjUs
IC0xIH07DQogLy8JCVRFU1RTX05BTUVTID0gbmV3IFN0cmluZ1tdIHsidGVzdDAyMDQifTsNCiAJ
fQ0KQEAgLTExMjg0LDQgKzExMjg0LDI0IEBADQogCQlhc3NlcnRUcnVlKCJTaG91bGQgYmUgc2Vl
biBhcyBhIHdpbGRjYXJkIChyZWFsbHkgYW4gaW50ZXJzZWN0aW9uIHR5cGUpIiwgYmluZGluZy5p
c1dpbGRjYXJkVHlwZSgpKTsNCiAJCWFzc2VydE51bGwoInNob3VsZCBiZSBudWxsIiwgYmluZGlu
Zy5nZXRHZW5lcmljVHlwZU9mV2lsZGNhcmRUeXBlKCkpOw0KIAl9DQorCS8vaHR0cHM6Ly9idWdz
LmVjbGlwc2Uub3JnL2J1Z3Mvc2hvd19idWcuY2dpP2lkPTM0MjY3MQ0KKwlwdWJsaWMgdm9pZCB0
ZXN0MDM1MSgpIHRocm93cyBKYXZhTW9kZWxFeGNlcHRpb24gew0KKwkJSUNvbXBpbGF0aW9uVW5p
dCBzb3VyY2VVbml0ID0gZ2V0Q29tcGlsYXRpb25Vbml0KCJDb252ZXJ0ZXIxNSIgLCAic3JjIiwg
InRlc3QwMzUxIiwgIlguamF2YSIpOyAvLyROT04tTkxTLTEkIC8vJE5PTi1OTFMtMiQgLy8kTk9O
LU5MUy0zJCAvLyROT04tTkxTLTQkDQorCQlBU1ROb2RlIHJlc3VsdCA9IHJ1bkpMUzNDb252ZXJz
aW9uKHNvdXJjZVVuaXQsIHRydWUsIHRydWUpOw0KKwkJYXNzZXJ0VHJ1ZSgiTm90IGEgY29tcGls
YXRpb24gdW5pdCIsIHJlc3VsdC5nZXROb2RlVHlwZSgpID09IEFTVE5vZGUuQ09NUElMQVRJT05f
VU5JVCk7DQorCQlDb21waWxhdGlvblVuaXQgdW5pdCA9IChDb21waWxhdGlvblVuaXQpIHJlc3Vs
dDsNCisJCU1ldGhvZERlY2xhcmF0aW9uIG1ldGhvZERlY2xhcmF0aW9uID0gKE1ldGhvZERlY2xh
cmF0aW9uKSBnZXRBU1ROb2RlKHVuaXQsIDAsIDApOw0KKwkJSVR5cGVCaW5kaW5nIHR5cGVCaW5k
aW5nID0gbWV0aG9kRGVjbGFyYXRpb24uZ2V0UmV0dXJuVHlwZTIoKS5yZXNvbHZlQmluZGluZygp
Ow0KKwkJYXNzZXJ0RXF1YWxzKCJXcm9uZyBmdWxseSBxdWFsaWZpZWQgbmFtZSIsICJ0ZXN0MDM1
MS5JMVtdIiwgdHlwZUJpbmRpbmcuZ2V0UXVhbGlmaWVkTmFtZSgpKTsNCisJfQ0KKwkvL2h0dHBz
Oi8vYnVncy5lY2xpcHNlLm9yZy9idWdzL3Nob3dfYnVnLmNnaT9pZD0zNDI2NzENCisJcHVibGlj
IHZvaWQgdGVzdDAzNTIoKSB0aHJvd3MgSmF2YU1vZGVsRXhjZXB0aW9uIHsNCisJCUlDb21waWxh
dGlvblVuaXQgc291cmNlVW5pdCA9IGdldENvbXBpbGF0aW9uVW5pdCgiQ29udmVydGVyMTUiICwg
InNyYyIsICJ0ZXN0MDM1MiIsICJYLmphdmEiKTsgLy8kTk9OLU5MUy0xJCAvLyROT04tTkxTLTIk
IC8vJE5PTi1OTFMtMyQgLy8kTk9OLU5MUy00JA0KKwkJQVNUTm9kZSByZXN1bHQgPSBydW5KTFMz
Q29udmVyc2lvbihzb3VyY2VVbml0LCB0cnVlLCB0cnVlKTsNCisJCWFzc2VydFRydWUoIk5vdCBh
IGNvbXBpbGF0aW9uIHVuaXQiLCByZXN1bHQuZ2V0Tm9kZVR5cGUoKSA9PSBBU1ROb2RlLkNPTVBJ
TEFUSU9OX1VOSVQpOw0KKwkJQ29tcGlsYXRpb25Vbml0IHVuaXQgPSAoQ29tcGlsYXRpb25Vbml0
KSByZXN1bHQ7DQorCQlNZXRob2REZWNsYXJhdGlvbiBtZXRob2REZWNsYXJhdGlvbiA9IChNZXRo
b2REZWNsYXJhdGlvbikgZ2V0QVNUTm9kZSh1bml0LCAwLCAwKTsNCisJCUlUeXBlQmluZGluZyB0
eXBlQmluZGluZyA9IG1ldGhvZERlY2xhcmF0aW9uLmdldFJldHVyblR5cGUyKCkucmVzb2x2ZUJp
bmRpbmcoKTsNCisJCWFzc2VydEVxdWFscygiV3JvbmcgZnVsbHkgcXVhbGlmaWVkIG5hbWUiLCAi
dGVzdDAzNTIuSTFbXSIsIHR5cGVCaW5kaW5nLmdldFF1YWxpZmllZE5hbWUoKSk7DQorCX0NCiB9
DQpJbmRleDogd29ya3NwYWNlL0NvbnZlcnRlcjE1L3NyYy90ZXN0MDM1MS9JMC5qYXZhDQo9PT09
PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09
PT09PT09DQpSQ1MgZmlsZTogd29ya3NwYWNlL0NvbnZlcnRlcjE1L3NyYy90ZXN0MDM1MS9JMC5q
YXZhDQpkaWZmIC1OIHdvcmtzcGFjZS9Db252ZXJ0ZXIxNS9zcmMvdGVzdDAzNTEvSTAuamF2YQ0K
LS0tIC9kZXYvbnVsbAkxIEphbiAxOTcwIDAwOjAwOjAwIC0wMDAwDQorKysgd29ya3NwYWNlL0Nv
bnZlcnRlcjE1L3NyYy90ZXN0MDM1MS9JMC5qYXZhCTEgSmFuIDE5NzAgMDA6MDA6MDAgLTAwMDAN
CkBAIC0wLDAgKzEsNCBAQA0KK3BhY2thZ2UgdGVzdDAzNTE7DQorDQorcHVibGljIGludGVyZmFj
ZSBJMDxUPiB7DQorfQ0KSW5kZXg6IHdvcmtzcGFjZS9Db252ZXJ0ZXIxNS9zcmMvdGVzdDAzNTEv
STEuamF2YQ0KPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09
PT09PT09PT09PT09PT09PT09PQ0KUkNTIGZpbGU6IHdvcmtzcGFjZS9Db252ZXJ0ZXIxNS9zcmMv
dGVzdDAzNTEvSTEuamF2YQ0KZGlmZiAtTiB3b3Jrc3BhY2UvQ29udmVydGVyMTUvc3JjL3Rlc3Qw
MzUxL0kxLmphdmENCi0tLSAvZGV2L251bGwJMSBKYW4gMTk3MCAwMDowMDowMCAtMDAwMA0KKysr
IHdvcmtzcGFjZS9Db252ZXJ0ZXIxNS9zcmMvdGVzdDAzNTEvSTEuamF2YQkxIEphbiAxOTcwIDAw
OjAwOjAwIC0wMDAwDQpAQCAtMCwwICsxLDQgQEANCitwYWNrYWdlIHRlc3QwMzUxOw0KKw0KK3B1
YmxpYyBpbnRlcmZhY2UgSTEgZXh0ZW5kcyBJMDxYPD8+PiB7DQorfQ0KSW5kZXg6IHdvcmtzcGFj
ZS9Db252ZXJ0ZXIxNS9zcmMvdGVzdDAzNTEvSTIuamF2YQ0KPT09PT09PT09PT09PT09PT09PT09
PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PQ0KUkNTIGZpbGU6
IHdvcmtzcGFjZS9Db252ZXJ0ZXIxNS9zcmMvdGVzdDAzNTEvSTIuamF2YQ0KZGlmZiAtTiB3b3Jr
c3BhY2UvQ29udmVydGVyMTUvc3JjL3Rlc3QwMzUxL0kyLmphdmENCi0tLSAvZGV2L251bGwJMSBK
YW4gMTk3MCAwMDowMDowMCAtMDAwMA0KKysrIHdvcmtzcGFjZS9Db252ZXJ0ZXIxNS9zcmMvdGVz
dDAzNTEvSTIuamF2YQkxIEphbiAxOTcwIDAwOjAwOjAwIC0wMDAwDQpAQCAtMCwwICsxLDUgQEAN
CitwYWNrYWdlIHRlc3QwMzUxOw0KKw0KK3B1YmxpYyBpbnRlcmZhY2UgSTI8VCBleHRlbmRzIEkw
PD8+PiB7DQorCXB1YmxpYyBUW10gZ2V0SW5kaWNhdGlvbnMoKTsNCit9DQpJbmRleDogd29ya3Nw
YWNlL0NvbnZlcnRlcjE1L3NyYy90ZXN0MDM1MS9YLmphdmENCj09PT09PT09PT09PT09PT09PT09
PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT0NClJDUyBmaWxl
OiB3b3Jrc3BhY2UvQ29udmVydGVyMTUvc3JjL3Rlc3QwMzUxL1guamF2YQ0KZGlmZiAtTiB3b3Jr
c3BhY2UvQ29udmVydGVyMTUvc3JjL3Rlc3QwMzUxL1guamF2YQ0KLS0tIC9kZXYvbnVsbAkxIEph
biAxOTcwIDAwOjAwOjAwIC0wMDAwDQorKysgd29ya3NwYWNlL0NvbnZlcnRlcjE1L3NyYy90ZXN0
MDM1MS9YLmphdmEJMSBKYW4gMTk3MCAwMDowMDowMCAtMDAwMA0KQEAgLTAsMCArMSw3IEBADQor
cGFja2FnZSB0ZXN0MDM1MTsNCisNCitwdWJsaWMgY2xhc3MgWDxUPiB7DQorCXB1YmxpYyBJMTxU
PltdIGYoKSB7DQorCQlyZXR1cm4gbnVsbDsNCisJfQ0KK30NCkluZGV4OiB3b3Jrc3BhY2UvQ29u
dmVydGVyMTUvc3JjL3Rlc3QwMzUyL0kwLmphdmENCj09PT09PT09PT09PT09PT09PT09PT09PT09
PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT0NClJDUyBmaWxlOiB3b3Jr
c3BhY2UvQ29udmVydGVyMTUvc3JjL3Rlc3QwMzUyL0kwLmphdmENCmRpZmYgLU4gd29ya3NwYWNl
L0NvbnZlcnRlcjE1L3NyYy90ZXN0MDM1Mi9JMC5qYXZhDQotLS0gL2Rldi9udWxsCTEgSmFuIDE5
NzAgMDA6MDA6MDAgLTAwMDANCisrKyB3b3Jrc3BhY2UvQ29udmVydGVyMTUvc3JjL3Rlc3QwMzUy
L0kwLmphdmEJMSBKYW4gMTk3MCAwMDowMDowMCAtMDAwMA0KQEAgLTAsMCArMSw0IEBADQorcGFj
a2FnZSB0ZXN0MDM1MjsNCisNCitwdWJsaWMgaW50ZXJmYWNlIEkwPFQ+IHsNCit9DQpJbmRleDog
d29ya3NwYWNlL0NvbnZlcnRlcjE1L3NyYy90ZXN0MDM1Mi9JMS5qYXZhDQo9PT09PT09PT09PT09
PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09DQpS
Q1MgZmlsZTogd29ya3NwYWNlL0NvbnZlcnRlcjE1L3NyYy90ZXN0MDM1Mi9JMS5qYXZhDQpkaWZm
IC1OIHdvcmtzcGFjZS9Db252ZXJ0ZXIxNS9zcmMvdGVzdDAzNTIvSTEuamF2YQ0KLS0tIC9kZXYv
bnVsbAkxIEphbiAxOTcwIDAwOjAwOjAwIC0wMDAwDQorKysgd29ya3NwYWNlL0NvbnZlcnRlcjE1
L3NyYy90ZXN0MDM1Mi9JMS5qYXZhCTEgSmFuIDE5NzAgMDA6MDA6MDAgLTAwMDANCkBAIC0wLDAg
KzEsNCBAQA0KK3BhY2thZ2UgdGVzdDAzNTI7DQorDQorcHVibGljIGludGVyZmFjZSBJMSBleHRl
bmRzIEkwPFg8Pz4+IHsNCit9DQpJbmRleDogd29ya3NwYWNlL0NvbnZlcnRlcjE1L3NyYy90ZXN0
MDM1Mi9JMi5qYXZhDQo9PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09
PT09PT09PT09PT09PT09PT09PT09PT09DQpSQ1MgZmlsZTogd29ya3NwYWNlL0NvbnZlcnRlcjE1
L3NyYy90ZXN0MDM1Mi9JMi5qYXZhDQpkaWZmIC1OIHdvcmtzcGFjZS9Db252ZXJ0ZXIxNS9zcmMv
dGVzdDAzNTIvSTIuamF2YQ0KLS0tIC9kZXYvbnVsbAkxIEphbiAxOTcwIDAwOjAwOjAwIC0wMDAw
DQorKysgd29ya3NwYWNlL0NvbnZlcnRlcjE1L3NyYy90ZXN0MDM1Mi9JMi5qYXZhCTEgSmFuIDE5
NzAgMDA6MDA6MDAgLTAwMDANCkBAIC0wLDAgKzEsNSBAQA0KK3BhY2thZ2UgdGVzdDAzNTI7DQor
DQorcHVibGljIGludGVyZmFjZSBJMjxUIGV4dGVuZHMgSTA8Pz4+IHsNCisJcHVibGljIFRbXSBn
ZXRJbmRpY2F0aW9ucygpOw0KK30NCkluZGV4OiB3b3Jrc3BhY2UvQ29udmVydGVyMTUvc3JjL3Rl
c3QwMzUyL1guamF2YQ0KPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09
PT09PT09PT09PT09PT09PT09PT09PT09PQ0KUkNTIGZpbGU6IHdvcmtzcGFjZS9Db252ZXJ0ZXIx
NS9zcmMvdGVzdDAzNTIvWC5qYXZhDQpkaWZmIC1OIHdvcmtzcGFjZS9Db252ZXJ0ZXIxNS9zcmMv
dGVzdDAzNTIvWC5qYXZhDQotLS0gL2Rldi9udWxsCTEgSmFuIDE5NzAgMDA6MDA6MDAgLTAwMDAN
CisrKyB3b3Jrc3BhY2UvQ29udmVydGVyMTUvc3JjL3Rlc3QwMzUyL1guamF2YQkxIEphbiAxOTcw
IDAwOjAwOjAwIC0wMDAwDQpAQCAtMCwwICsxLDcgQEANCitwYWNrYWdlIHRlc3QwMzUyOw0KKw0K
K3B1YmxpYyBjbGFzcyBYPFQ+IHsNCisJcHVibGljIHRlc3QwMzUyLkkxPFQ+W10gZigpIHsNCisJ
CXJldHVybiBudWxsOw0KKwl9DQorfQ0K
</data>

          </attachment>
          <attachment
              isobsolete="1"
              ispatch="1"
              isprivate="0"
          >
            <attachid>193271</attachid>
            <date>2011-04-14 11:55:00 -0400</date>
            <delta_ts>2011-04-14 11:56:34 -0400</delta_ts>
            <desc>A new proposal</desc>
            <filename>patch_342671_2.txt</filename>
            <type>text/plain</type>
            <size>17996</size>
            <attacher name="Olivier Thomann">Olivier_Thomann</attacher>
            
              <data encoding="base64">IyMjIEVjbGlwc2UgV29ya3NwYWNlIFBhdGNoIDEuMA0KI1Agb3JnLmVjbGlwc2UuamR0LmNvcmUN
CkluZGV4OiBjb21waWxlci9vcmcvZWNsaXBzZS9qZHQvaW50ZXJuYWwvY29tcGlsZXIvYXN0L1Bh
cmFtZXRlcml6ZWRRdWFsaWZpZWRUeXBlUmVmZXJlbmNlLmphdmENCj09PT09PT09PT09PT09PT09
PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT0NClJDUyBm
aWxlOiAvY3Zzcm9vdC9lY2xpcHNlL29yZy5lY2xpcHNlLmpkdC5jb3JlL2NvbXBpbGVyL29yZy9l
Y2xpcHNlL2pkdC9pbnRlcm5hbC9jb21waWxlci9hc3QvUGFyYW1ldGVyaXplZFF1YWxpZmllZFR5
cGVSZWZlcmVuY2UuamF2YSx2DQpyZXRyaWV2aW5nIHJldmlzaW9uIDEuNjMNCmRpZmYgLXUgLXIx
LjYzIFBhcmFtZXRlcml6ZWRRdWFsaWZpZWRUeXBlUmVmZXJlbmNlLmphdmENCi0tLSBjb21waWxl
ci9vcmcvZWNsaXBzZS9qZHQvaW50ZXJuYWwvY29tcGlsZXIvYXN0L1BhcmFtZXRlcml6ZWRRdWFs
aWZpZWRUeXBlUmVmZXJlbmNlLmphdmEJMSBOb3YgMjAxMCAxNDoxNTo0NiAtMDAwMAkxLjYzDQor
KysgY29tcGlsZXIvb3JnL2VjbGlwc2UvamR0L2ludGVybmFsL2NvbXBpbGVyL2FzdC9QYXJhbWV0
ZXJpemVkUXVhbGlmaWVkVHlwZVJlZmVyZW5jZS5qYXZhCTE0IEFwciAyMDExIDE1OjUyOjE2IC0w
MDAwDQpAQCAtMSw1ICsxLDUgQEANCiAvKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioq
KioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKg0KLSAqIENvcHly
aWdodCAoYykgMjAwMCwgMjAxMCBJQk0gQ29ycG9yYXRpb24gYW5kIG90aGVycy4NCisgKiBDb3B5
cmlnaHQgKGMpIDIwMDAsIDIwMTEgSUJNIENvcnBvcmF0aW9uIGFuZCBvdGhlcnMuDQogICogQWxs
IHJpZ2h0cyByZXNlcnZlZC4gVGhpcyBwcm9ncmFtIGFuZCB0aGUgYWNjb21wYW55aW5nIG1hdGVy
aWFscw0KICAqIGFyZSBtYWRlIGF2YWlsYWJsZSB1bmRlciB0aGUgdGVybXMgb2YgdGhlIEVjbGlw
c2UgUHVibGljIExpY2Vuc2UgdjEuMA0KICAqIHdoaWNoIGFjY29tcGFuaWVzIHRoaXMgZGlzdHJp
YnV0aW9uLCBhbmQgaXMgYXZhaWxhYmxlIGF0DQpAQCAtMTQ4LDYgKzE0OCw3IEBADQogCQkJCQl9
DQogCQkJCX0NCiAJCQl9DQorCQkJY3JlYXRlQXJyYXlUeXBlKHNjb3BlKTsNCiAJCQlyZXR1cm4g
bnVsbDsNCiAJCX0NCiANCkBAIC0xNzMsNiArMTc0LDcgQEANCiAJCQkJCQl9DQogCQkJCSAgICB9
DQogCQkJCX0NCisJCQkJY3JlYXRlQXJyYXlUeXBlKHNjb3BlKTsNCiAJCQkJcmV0dXJuIG51bGw7
DQogCQkJfQ0KIAkJCVJlZmVyZW5jZUJpbmRpbmcgY3VycmVudFR5cGUgPSAoUmVmZXJlbmNlQmlu
ZGluZykgdGhpcy5yZXNvbHZlZFR5cGU7DQpAQCAtMjE5LDMxICsyMjEsMzIgQEANCiAJCQkJCX0N
CiAJCQkJfQ0KIAkJCQlpZiAoYXJnSGFzRXJyb3IpIHsNCisJCQkJCWNyZWF0ZUFycmF5VHlwZShz
Y29wZSk7DQogCQkJCQlyZXR1cm4gbnVsbDsNCiAJCQkJfQ0KIAkJCQlpZiAoaXNDbGFzc1Njb3Bl
KSB7DQogCQkJCQkoKENsYXNzU2NvcGUpIHNjb3BlKS5zdXBlclR5cGVSZWZlcmVuY2UgPSBrZWVw
Ow0KLQkJCQkJaWYgKCgoQ2xhc3NTY29wZSkgc2NvcGUpLmRldGVjdEhpZXJhcmNoeUN5Y2xlKGN1
cnJlbnRPcmlnaW5hbCwgdGhpcykpDQorCQkJCQlpZiAoKChDbGFzc1Njb3BlKSBzY29wZSkuZGV0
ZWN0SGllcmFyY2h5Q3ljbGUoY3VycmVudE9yaWdpbmFsLCB0aGlzKSkgew0KKwkJCQkJCWNyZWF0
ZUFycmF5VHlwZShzY29wZSk7DQogCQkJCQkJcmV0dXJuIG51bGw7DQorCQkJCQl9DQogCQkJCX0N
CiANCiAJCQkgICAgVHlwZVZhcmlhYmxlQmluZGluZ1tdIHR5cGVWYXJpYWJsZXMgPSBjdXJyZW50
T3JpZ2luYWwudHlwZVZhcmlhYmxlcygpOw0KIAkJCQlpZiAodHlwZVZhcmlhYmxlcyA9PSBCaW5k
aW5nLk5PX1RZUEVfVkFSSUFCTEVTKSB7IC8vIGNoZWNrIGdlbmVyaWMNCiAJCQkJCWlmIChzY29w
ZS5jb21waWxlck9wdGlvbnMoKS5vcmlnaW5hbFNvdXJjZUxldmVsID49IENsYXNzRmlsZUNvbnN0
YW50cy5KREsxXzUpIHsgLy8gYmVsb3cgMS41LCBhbHJlYWR5IHJlcG9ydGVkIGFzIHN5bnRheCBl
cnJvcg0KIAkJCQkJCXNjb3BlLnByb2JsZW1SZXBvcnRlcigpLm5vbkdlbmVyaWNUeXBlQ2Fubm90
QmVQYXJhbWV0ZXJpemVkKGksIHRoaXMsIGN1cnJlbnRUeXBlLCBhcmdUeXBlcyk7DQorCQkJCQkJ
Y3JlYXRlQXJyYXlUeXBlKHNjb3BlKTsNCiAJCQkJCQlyZXR1cm4gbnVsbDsNCiAJCQkJCX0NCiAJ
CQkJCXRoaXMucmVzb2x2ZWRUeXBlID0gIChxdWFsaWZ5aW5nVHlwZSAhPSBudWxsICYmIHF1YWxp
ZnlpbmdUeXBlLmlzUGFyYW1ldGVyaXplZFR5cGUoKSkNCiAJCQkJCQk/IHNjb3BlLmVudmlyb25t
ZW50KCkuY3JlYXRlUGFyYW1ldGVyaXplZFR5cGUoY3VycmVudE9yaWdpbmFsLCBudWxsLCBxdWFs
aWZ5aW5nVHlwZSkNCiAJCQkJCQk6IGN1cnJlbnRUeXBlOw0KLQkJCQkJaWYgKHRoaXMuZGltZW5z
aW9ucyA+IDApIHsNCi0JCQkJCQlpZiAodGhpcy5kaW1lbnNpb25zID4gMjU1KQ0KLQkJCQkJCQlz
Y29wZS5wcm9ibGVtUmVwb3J0ZXIoKS50b29NYW55RGltZW5zaW9ucyh0aGlzKTsNCi0JCQkJCQl0
aGlzLnJlc29sdmVkVHlwZSA9IHNjb3BlLmNyZWF0ZUFycmF5VHlwZSh0aGlzLnJlc29sdmVkVHlw
ZSwgdGhpcy5kaW1lbnNpb25zKTsNCi0JCQkJCX0NCisJCQkJCWNyZWF0ZUFycmF5VHlwZShzY29w
ZSk7DQogCQkJCQlyZXR1cm4gdGhpcy5yZXNvbHZlZFR5cGU7DQogCQkJCX0gZWxzZSBpZiAoYXJn
TGVuZ3RoICE9IHR5cGVWYXJpYWJsZXMubGVuZ3RoKSB7IC8vIGNoZWNrIGFyaXR5DQogCQkJCQlz
Y29wZS5wcm9ibGVtUmVwb3J0ZXIoKS5pbmNvcnJlY3RBcml0eUZvclBhcmFtZXRlcml6ZWRUeXBl
KHRoaXMsIGN1cnJlbnRUeXBlLCBhcmdUeXBlcywgaSk7DQorCQkJCQljcmVhdGVBcnJheVR5cGUo
c2NvcGUpOw0KIAkJCQkJcmV0dXJuIG51bGw7DQogCQkJCX0NCiAJCQkJLy8gY2hlY2sgcGFyYW1l
dGVyaXppbmcgbm9uLXN0YXRpYyBtZW1iZXIgdHlwZSBvZiByYXcgdHlwZQ0KQEAgLTI2NSw4ICsy
NjgsMTAgQEANCiAJCSAgICB9IGVsc2Ugew0KIAkJCQlSZWZlcmVuY2VCaW5kaW5nIGN1cnJlbnRP
cmlnaW5hbCA9IChSZWZlcmVuY2VCaW5kaW5nKWN1cnJlbnRUeXBlLm9yaWdpbmFsKCk7DQogCQkJ
CWlmIChpc0NsYXNzU2NvcGUpDQotCQkJCQlpZiAoKChDbGFzc1Njb3BlKSBzY29wZSkuZGV0ZWN0
SGllcmFyY2h5Q3ljbGUoY3VycmVudE9yaWdpbmFsLCB0aGlzKSkNCisJCQkJCWlmICgoKENsYXNz
U2NvcGUpIHNjb3BlKS5kZXRlY3RIaWVyYXJjaHlDeWNsZShjdXJyZW50T3JpZ2luYWwsIHRoaXMp
KSB7DQorCQkJCQkJY3JlYXRlQXJyYXlUeXBlKHNjb3BlKTsNCiAJCQkJCQlyZXR1cm4gbnVsbDsN
CisJCQkJCX0NCiAJCQkJaWYgKGN1cnJlbnRPcmlnaW5hbC5pc0dlbmVyaWNUeXBlKCkpIHsNCiAJ
ICAgCQkJICAgIGlmICh0eXBlSXNDb25zaXN0ZW50ICYmIHF1YWxpZnlpbmdUeXBlICE9IG51bGwg
JiYgcXVhbGlmeWluZ1R5cGUuaXNQYXJhbWV0ZXJpemVkVHlwZSgpKSB7DQogCQkJCQkJc2NvcGUu
cHJvYmxlbVJlcG9ydGVyKCkucGFyYW1ldGVyaXplZE1lbWJlclR5cGVNaXNzaW5nQXJndW1lbnRz
KHRoaXMsIHNjb3BlLmVudmlyb25tZW50KCkuY3JlYXRlUGFyYW1ldGVyaXplZFR5cGUoY3VycmVu
dE9yaWdpbmFsLCBudWxsLCBxdWFsaWZ5aW5nVHlwZSksIGkpOw0KQEAgLTI4MywxMyArMjg4LDE2
IEBADQogCQkJCXJlcG9ydERlcHJlY2F0ZWRUeXBlKHF1YWxpZnlpbmdUeXBlLCBzY29wZSwgaSk7
DQogCQkJdGhpcy5yZXNvbHZlZFR5cGUgPSBxdWFsaWZ5aW5nVHlwZTsNCiAJCX0NCisJCWNyZWF0
ZUFycmF5VHlwZShzY29wZSk7DQorCQlyZXR1cm4gdGhpcy5yZXNvbHZlZFR5cGU7DQorCX0NCisJ
cHJpdmF0ZSB2b2lkIGNyZWF0ZUFycmF5VHlwZShTY29wZSBzY29wZSkgew0KIAkJLy8gYXJyYXkg
dHlwZSA/DQogCQlpZiAodGhpcy5kaW1lbnNpb25zID4gMCkgew0KIAkJCWlmICh0aGlzLmRpbWVu
c2lvbnMgPiAyNTUpDQogCQkJCXNjb3BlLnByb2JsZW1SZXBvcnRlcigpLnRvb01hbnlEaW1lbnNp
b25zKHRoaXMpOw0KIAkJCXRoaXMucmVzb2x2ZWRUeXBlID0gc2NvcGUuY3JlYXRlQXJyYXlUeXBl
KHRoaXMucmVzb2x2ZWRUeXBlLCB0aGlzLmRpbWVuc2lvbnMpOw0KIAkJfQ0KLQkJcmV0dXJuIHRo
aXMucmVzb2x2ZWRUeXBlOw0KIAl9DQogDQogCXB1YmxpYyBTdHJpbmdCdWZmZXIgcHJpbnRFeHBy
ZXNzaW9uKGludCBpbmRlbnQsIFN0cmluZ0J1ZmZlciBvdXRwdXQpIHsNCkluZGV4OiBjb21waWxl
ci9vcmcvZWNsaXBzZS9qZHQvaW50ZXJuYWwvY29tcGlsZXIvYXN0L1BhcmFtZXRlcml6ZWRTaW5n
bGVUeXBlUmVmZXJlbmNlLmphdmENCj09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09
PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT0NClJDUyBmaWxlOiAvY3Zzcm9vdC9lY2xp
cHNlL29yZy5lY2xpcHNlLmpkdC5jb3JlL2NvbXBpbGVyL29yZy9lY2xpcHNlL2pkdC9pbnRlcm5h
bC9jb21waWxlci9hc3QvUGFyYW1ldGVyaXplZFNpbmdsZVR5cGVSZWZlcmVuY2UuamF2YSx2DQpy
ZXRyaWV2aW5nIHJldmlzaW9uIDEuNTQNCmRpZmYgLXUgLXIxLjU0IFBhcmFtZXRlcml6ZWRTaW5n
bGVUeXBlUmVmZXJlbmNlLmphdmENCi0tLSBjb21waWxlci9vcmcvZWNsaXBzZS9qZHQvaW50ZXJu
YWwvY29tcGlsZXIvYXN0L1BhcmFtZXRlcml6ZWRTaW5nbGVUeXBlUmVmZXJlbmNlLmphdmEJMSBO
b3YgMjAxMCAxNDoxNTo0NiAtMDAwMAkxLjU0DQorKysgY29tcGlsZXIvb3JnL2VjbGlwc2UvamR0
L2ludGVybmFsL2NvbXBpbGVyL2FzdC9QYXJhbWV0ZXJpemVkU2luZ2xlVHlwZVJlZmVyZW5jZS5q
YXZhCTE0IEFwciAyMDExIDE1OjUyOjE2IC0wMDAwDQpAQCAtMSw1ICsxLDUgQEANCiAvKioqKioq
KioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioq
KioqKioqKioqKioqKioqKg0KLSAqIENvcHlyaWdodCAoYykgMjAwMCwgMjAxMCBJQk0gQ29ycG9y
YXRpb24gYW5kIG90aGVycy4NCisgKiBDb3B5cmlnaHQgKGMpIDIwMDAsIDIwMTEgSUJNIENvcnBv
cmF0aW9uIGFuZCBvdGhlcnMuDQogICogQWxsIHJpZ2h0cyByZXNlcnZlZC4gVGhpcyBwcm9ncmFt
IGFuZCB0aGUgYWNjb21wYW55aW5nIG1hdGVyaWFscw0KICAqIGFyZSBtYWRlIGF2YWlsYWJsZSB1
bmRlciB0aGUgdGVybXMgb2YgdGhlIEVjbGlwc2UgUHVibGljIExpY2Vuc2UgdjEuMA0KICAqIHdo
aWNoIGFjY29tcGFuaWVzIHRoaXMgZGlzdHJpYnV0aW9uLCBhbmQgaXMgYXZhaWxhYmxlIGF0DQpA
QCAtMTA1LDcgKzEwNSw2IEBADQogCQkJCX0NCiAJCQl9DQogCQl9DQotCQlib29sZWFuIGhhc0dl
bmVyaWNFcnJvciA9IGZhbHNlOw0KIAkJUmVmZXJlbmNlQmluZGluZyBjdXJyZW50VHlwZTsNCiAJ
CXRoaXMuYml0cyB8PSBBU1ROb2RlLkRpZFJlc29sdmU7DQogCQlpZiAoZW5jbG9zaW5nVHlwZSA9
PSBudWxsKSB7DQpAQCAtMTEzLDcgKzExMiw2IEBADQogCQkJaWYgKHRoaXMucmVzb2x2ZWRUeXBl
LmlzVmFsaWRCaW5kaW5nKCkpIHsNCiAJCQkJY3VycmVudFR5cGUgPSAoUmVmZXJlbmNlQmluZGlu
ZykgdGhpcy5yZXNvbHZlZFR5cGU7DQogCQkJfSBlbHNlIHsNCi0JCQkJaGFzR2VuZXJpY0Vycm9y
ID0gdHJ1ZTsNCiAJCQkJcmVwb3J0SW52YWxpZFR5cGUoc2NvcGUpOw0KIAkJCQlzd2l0Y2ggKHRo
aXMucmVzb2x2ZWRUeXBlLnByb2JsZW1JZCgpKSB7DQogCQkJCQljYXNlIFByb2JsZW1SZWFzb25z
Lk5vdEZvdW5kIDoNCkBAIC0xMjcsMTYgKzEyNSwxNyBAQA0KIAkJCQkJCS8vJEZBTEwtVEhST1VH
SCQgLSB1bmFibGUgdG8gY29tcGxldGUgdHlwZSBiaW5kaW5nLCBidXQgc3RpbGwgcmVzb2x2ZSB0
eXBlIGFyZ3VtZW50cw0KIAkJCQkJZGVmYXVsdCA6DQogCQkJCQkJYm9vbGVhbiBpc0NsYXNzU2Nv
cGUgPSBzY29wZS5raW5kID09IFNjb3BlLkNMQVNTX1NDT1BFOw0KLQkJCQkJaW50IGFyZ0xlbmd0
aCA9IHRoaXMudHlwZUFyZ3VtZW50cy5sZW5ndGg7DQotCQkJCQlmb3IgKGludCBpID0gMDsgaSA8
IGFyZ0xlbmd0aDsgaSsrKSB7DQotCQkJCQkJVHlwZVJlZmVyZW5jZSB0eXBlQXJndW1lbnQgPSB0
aGlzLnR5cGVBcmd1bWVudHNbaV07DQotCQkJCQkJaWYgKGlzQ2xhc3NTY29wZSkgew0KLQkJCQkJ
CQl0eXBlQXJndW1lbnQucmVzb2x2ZVR5cGUoKENsYXNzU2NvcGUpIHNjb3BlKTsNCi0JCQkJCQl9
IGVsc2Ugew0KLQkJCQkJCQl0eXBlQXJndW1lbnQucmVzb2x2ZVR5cGUoKEJsb2NrU2NvcGUpIHNj
b3BlLCBjaGVja0JvdW5kcyk7DQorCQkJCQkJaW50IGFyZ0xlbmd0aCA9IHRoaXMudHlwZUFyZ3Vt
ZW50cy5sZW5ndGg7DQorCQkJCQkJZm9yIChpbnQgaSA9IDA7IGkgPCBhcmdMZW5ndGg7IGkrKykg
ew0KKwkJCQkJCQlUeXBlUmVmZXJlbmNlIHR5cGVBcmd1bWVudCA9IHRoaXMudHlwZUFyZ3VtZW50
c1tpXTsNCisJCQkJCQkJaWYgKGlzQ2xhc3NTY29wZSkgew0KKwkJCQkJCQkJdHlwZUFyZ3VtZW50
LnJlc29sdmVUeXBlKChDbGFzc1Njb3BlKSBzY29wZSk7DQorCQkJCQkJCX0gZWxzZSB7DQorCQkJ
CQkJCQl0eXBlQXJndW1lbnQucmVzb2x2ZVR5cGUoKEJsb2NrU2NvcGUpIHNjb3BlLCBjaGVja0Jv
dW5kcyk7DQorCQkJCQkJCX0NCiAJCQkJCQl9DQotCQkJCQl9DQotCQkJCQlyZXR1cm4gbnVsbDsN
CisJCQkJCQljcmVhdGVBcnJheVR5cGUoc2NvcGUpOw0KKwkJCQkJCXJldHVybiBudWxsOw0KIAkJ
CQl9DQogCQkJCS8vIGJlIHJlc2lsaWVudCwgc3RpbGwgYXR0ZW1wdCByZXNvbHZpbmcgYXJndW1l
bnRzDQogCQkJfQ0KQEAgLTE1MCw4ICsxNDksOCBAQA0KIAkJfSBlbHNlIHsgLy8gcmVzb2x2aW5n
IG1lbWJlciB0eXBlIChyZWxhdGl2ZWx5IHRvIGVuY2xvc2luZ1R5cGUpDQogCQkJdGhpcy5yZXNv
bHZlZFR5cGUgPSBjdXJyZW50VHlwZSA9IHNjb3BlLmdldE1lbWJlclR5cGUodGhpcy50b2tlbiwg
ZW5jbG9zaW5nVHlwZSk7DQogCQkJaWYgKCF0aGlzLnJlc29sdmVkVHlwZS5pc1ZhbGlkQmluZGlu
ZygpKSB7DQotCQkJCWhhc0dlbmVyaWNFcnJvciA9IHRydWU7DQogCQkJCXNjb3BlLnByb2JsZW1S
ZXBvcnRlcigpLmludmFsaWRFbmNsb3NpbmdUeXBlKHRoaXMsIGN1cnJlbnRUeXBlLCBlbmNsb3Np
bmdUeXBlKTsNCisJCQkJY3JlYXRlQXJyYXlUeXBlKHNjb3BlKTsNCiAJCQkJcmV0dXJuIG51bGw7
DQogCQkJfQ0KIAkJCWlmIChpc1R5cGVVc2VEZXByZWNhdGVkKGN1cnJlbnRUeXBlLCBzY29wZSkp
DQpAQCAtMTYzLDM0ICsxNjIsMzcgQEANCiAJCX0NCiANCiAJCS8vIGNoZWNrIGdlbmVyaWMgYW5k
IGFyaXR5DQotCSAgICBib29sZWFuIGlzQ2xhc3NTY29wZSA9IHNjb3BlLmtpbmQgPT0gU2NvcGUu
Q0xBU1NfU0NPUEU7DQotCSAgICBUeXBlUmVmZXJlbmNlIGtlZXAgPSBudWxsOw0KLQkgICAgaWYg
KGlzQ2xhc3NTY29wZSkgew0KLQkgICAgCWtlZXAgPSAoKENsYXNzU2NvcGUpIHNjb3BlKS5zdXBl
clR5cGVSZWZlcmVuY2U7DQotCSAgICAJKChDbGFzc1Njb3BlKSBzY29wZSkuc3VwZXJUeXBlUmVm
ZXJlbmNlID0gbnVsbDsNCi0JICAgIH0NCisJCWJvb2xlYW4gaXNDbGFzc1Njb3BlID0gc2NvcGUu
a2luZCA9PSBTY29wZS5DTEFTU19TQ09QRTsNCisJCVR5cGVSZWZlcmVuY2Uga2VlcCA9IG51bGw7
DQorCQlpZiAoaXNDbGFzc1Njb3BlKSB7DQorCQkJa2VlcCA9ICgoQ2xhc3NTY29wZSkgc2NvcGUp
LnN1cGVyVHlwZVJlZmVyZW5jZTsNCisJCQkoKENsYXNzU2NvcGUpIHNjb3BlKS5zdXBlclR5cGVS
ZWZlcmVuY2UgPSBudWxsOw0KKwkJfQ0KIAkJaW50IGFyZ0xlbmd0aCA9IHRoaXMudHlwZUFyZ3Vt
ZW50cy5sZW5ndGg7DQogCQlUeXBlQmluZGluZ1tdIGFyZ1R5cGVzID0gbmV3IFR5cGVCaW5kaW5n
W2FyZ0xlbmd0aF07DQogCQlib29sZWFuIGFyZ0hhc0Vycm9yID0gZmFsc2U7DQogCQlSZWZlcmVu
Y2VCaW5kaW5nIGN1cnJlbnRPcmlnaW5hbCA9IChSZWZlcmVuY2VCaW5kaW5nKWN1cnJlbnRUeXBl
Lm9yaWdpbmFsKCk7DQogCQlmb3IgKGludCBpID0gMDsgaSA8IGFyZ0xlbmd0aDsgaSsrKSB7DQot
CQkgICAgVHlwZVJlZmVyZW5jZSB0eXBlQXJndW1lbnQgPSB0aGlzLnR5cGVBcmd1bWVudHNbaV07
DQotCQkgICAgVHlwZUJpbmRpbmcgYXJnVHlwZSA9IGlzQ2xhc3NTY29wZQ0KLQkJCQk/IHR5cGVB
cmd1bWVudC5yZXNvbHZlVHlwZUFyZ3VtZW50KChDbGFzc1Njb3BlKSBzY29wZSwgY3VycmVudE9y
aWdpbmFsLCBpKQ0KLQkJCQk6IHR5cGVBcmd1bWVudC5yZXNvbHZlVHlwZUFyZ3VtZW50KChCbG9j
a1Njb3BlKSBzY29wZSwgY3VycmVudE9yaWdpbmFsLCBpKTsNCi0JCSAgICAgaWYgKGFyZ1R5cGUg
PT0gbnVsbCkgew0KLQkJICAgICAgICAgYXJnSGFzRXJyb3IgPSB0cnVlOw0KLQkJICAgICB9IGVs
c2Ugew0KLQkJCSAgICBhcmdUeXBlc1tpXSA9IGFyZ1R5cGU7DQotCQkgICAgIH0NCisJCQlUeXBl
UmVmZXJlbmNlIHR5cGVBcmd1bWVudCA9IHRoaXMudHlwZUFyZ3VtZW50c1tpXTsNCisJCQlUeXBl
QmluZGluZyBhcmdUeXBlID0gaXNDbGFzc1Njb3BlDQorCQkJCQk/IHR5cGVBcmd1bWVudC5yZXNv
bHZlVHlwZUFyZ3VtZW50KChDbGFzc1Njb3BlKSBzY29wZSwgY3VycmVudE9yaWdpbmFsLCBpKQ0K
KwkJCQkJOiB0eXBlQXJndW1lbnQucmVzb2x2ZVR5cGVBcmd1bWVudCgoQmxvY2tTY29wZSkgc2Nv
cGUsIGN1cnJlbnRPcmlnaW5hbCwgaSk7DQorCQkJaWYgKGFyZ1R5cGUgPT0gbnVsbCkgew0KKwkJ
CQlhcmdIYXNFcnJvciA9IHRydWU7DQorCQkJfSBlbHNlIHsNCisJCQkJYXJnVHlwZXNbaV0gPSBh
cmdUeXBlOw0KKwkJCX0NCiAJCX0NCiAJCWlmIChhcmdIYXNFcnJvcikgew0KKwkJCWNyZWF0ZUFy
cmF5VHlwZShzY29wZSk7DQogCQkJcmV0dXJuIG51bGw7DQogCQl9DQogCQlpZiAoaXNDbGFzc1Nj
b3BlKSB7DQotCSAgICAJKChDbGFzc1Njb3BlKSBzY29wZSkuc3VwZXJUeXBlUmVmZXJlbmNlID0g
a2VlcDsNCi0JCQlpZiAoKChDbGFzc1Njb3BlKSBzY29wZSkuZGV0ZWN0SGllcmFyY2h5Q3ljbGUo
Y3VycmVudE9yaWdpbmFsLCB0aGlzKSkNCisJCQkoKENsYXNzU2NvcGUpIHNjb3BlKS5zdXBlclR5
cGVSZWZlcmVuY2UgPSBrZWVwOw0KKwkJCWlmICgoKENsYXNzU2NvcGUpIHNjb3BlKS5kZXRlY3RI
aWVyYXJjaHlDeWNsZShjdXJyZW50T3JpZ2luYWwsIHRoaXMpKSB7DQorCQkJCWNyZWF0ZUFycmF5
VHlwZShzY29wZSk7DQogCQkJCXJldHVybiBudWxsOw0KKwkJCX0NCiAJCX0NCiANCiAJCVR5cGVW
YXJpYWJsZUJpbmRpbmdbXSB0eXBlVmFyaWFibGVzID0gY3VycmVudE9yaWdpbmFsLnR5cGVWYXJp
YWJsZXMoKTsNCkBAIC0yMDAsNiArMjAyLDcgQEANCiAJCQkJaWYgKGlzQ29tcGxpYW50MTUpIHsg
Ly8gYmVsb3cgMS41LCBhbHJlYWR5IHJlcG9ydGVkIGFzIHN5bnRheCBlcnJvcg0KIAkJCQkJdGhp
cy5yZXNvbHZlZFR5cGUgPSBjdXJyZW50VHlwZTsNCiAJCQkJCXNjb3BlLnByb2JsZW1SZXBvcnRl
cigpLm5vbkdlbmVyaWNUeXBlQ2Fubm90QmVQYXJhbWV0ZXJpemVkKDAsIHRoaXMsIGN1cnJlbnRU
eXBlLCBhcmdUeXBlcyk7DQorCQkJCQljcmVhdGVBcnJheVR5cGUoc2NvcGUpOw0KIAkJCQkJcmV0
dXJuIG51bGw7DQogCQkJCX0NCiAJCQl9DQpAQCAtMjEyLDMxICsyMTUsMzMgQEANCiAJCQkJCQlz
Y29wZS5wcm9ibGVtUmVwb3J0ZXIoKS50b29NYW55RGltZW5zaW9ucyh0aGlzKTsNCiAJCQkJCXR5
cGUgPSBzY29wZS5jcmVhdGVBcnJheVR5cGUodHlwZSwgdGhpcy5kaW1lbnNpb25zKTsNCiAJCQkJ
fQ0KLQkJCQlpZiAoaGFzR2VuZXJpY0Vycm9yKQ0KLQkJCQkJcmV0dXJuIHR5cGU7DQogCQkJCXJl
dHVybiB0aGlzLnJlc29sdmVkVHlwZSA9IHR5cGU7DQogCQkJfQ0KIAkJCS8vIGlmIG1pc3Npbmcg
Z2VuZXJpYyB0eXBlLCBhbmQgY29tcGxpYW5jZSA+PSAxLjUsIHRoZW4gd2lsbCByZWJ1aWxkIGEg
cGFyYW1ldGVyaXplZCBiaW5kaW5nDQogCQl9IGVsc2UgaWYgKGFyZ0xlbmd0aCAhPSB0eXBlVmFy
aWFibGVzLmxlbmd0aCkgeyAvLyBjaGVjayBhcml0eQ0KIAkJCXNjb3BlLnByb2JsZW1SZXBvcnRl
cigpLmluY29ycmVjdEFyaXR5Rm9yUGFyYW1ldGVyaXplZFR5cGUodGhpcywgY3VycmVudFR5cGUs
IGFyZ1R5cGVzKTsNCisJCQljcmVhdGVBcnJheVR5cGUoc2NvcGUpOw0KIAkJCXJldHVybiBudWxs
Ow0KIAkJfSBlbHNlIGlmICghY3VycmVudFR5cGUuaXNTdGF0aWMoKSkgew0KIAkJCVJlZmVyZW5j
ZUJpbmRpbmcgYWN0dWFsRW5jbG9zaW5nID0gY3VycmVudFR5cGUuZW5jbG9zaW5nVHlwZSgpOw0K
IAkJCWlmIChhY3R1YWxFbmNsb3NpbmcgIT0gbnVsbCAmJiBhY3R1YWxFbmNsb3NpbmcuaXNSYXdU
eXBlKCkpew0KIAkJCQlzY29wZS5wcm9ibGVtUmVwb3J0ZXIoKS5yYXdNZW1iZXJUeXBlQ2Fubm90
QmVQYXJhbWV0ZXJpemVkKA0KIAkJCQkJCXRoaXMsIHNjb3BlLmVudmlyb25tZW50KCkuY3JlYXRl
UmF3VHlwZShjdXJyZW50T3JpZ2luYWwsIGFjdHVhbEVuY2xvc2luZyksIGFyZ1R5cGVzKTsNCisJ
CQkJY3JlYXRlQXJyYXlUeXBlKHNjb3BlKTsNCiAJCQkJcmV0dXJuIG51bGw7DQogCQkJfQ0KIAkJ
fQ0KIA0KICAgICAJUGFyYW1ldGVyaXplZFR5cGVCaW5kaW5nIHBhcmFtZXRlcml6ZWRUeXBlID0g
c2NvcGUuZW52aXJvbm1lbnQoKS5jcmVhdGVQYXJhbWV0ZXJpemVkVHlwZShjdXJyZW50T3JpZ2lu
YWwsIGFyZ1R5cGVzLCBlbmNsb3NpbmdUeXBlKTsNCiAJCS8vIGNoZWNrIGFyZ3VtZW50IHR5cGUg
Y29tcGF0aWJpbGl0eQ0KLQkJaWYgKGNoZWNrQm91bmRzKSAvLyBvdGhlcndpc2Ugd2lsbCBkbyBp
dCBpbiBTY29wZS5jb25uZWN0VHlwZVZhcmlhYmxlcygpIG9yIGdlbmVyaWMgbWV0aG9kIHJlc29s
dXRpb24NCisJCWlmIChjaGVja0JvdW5kcykgey8vIG90aGVyd2lzZSB3aWxsIGRvIGl0IGluIFNj
b3BlLmNvbm5lY3RUeXBlVmFyaWFibGVzKCkgb3IgZ2VuZXJpYyBtZXRob2QgcmVzb2x1dGlvbg0K
IAkJCXBhcmFtZXRlcml6ZWRUeXBlLmJvdW5kQ2hlY2soc2NvcGUsIHRoaXMudHlwZUFyZ3VtZW50
cyk7DQotCQllbHNlDQorCQl9IGVsc2Ugew0KIAkJCXNjb3BlLmRlZmVyQm91bmRDaGVjayh0aGlz
KTsNCi0JCWlmIChpc1R5cGVVc2VEZXByZWNhdGVkKHBhcmFtZXRlcml6ZWRUeXBlLCBzY29wZSkp
DQorCQl9DQorCQlpZiAoaXNUeXBlVXNlRGVwcmVjYXRlZChwYXJhbWV0ZXJpemVkVHlwZSwgc2Nv
cGUpKSB7DQogCQkJcmVwb3J0RGVwcmVjYXRlZFR5cGUocGFyYW1ldGVyaXplZFR5cGUsIHNjb3Bl
KTsNCisJCX0NCiANCiAJCVR5cGVCaW5kaW5nIHR5cGUgPSBwYXJhbWV0ZXJpemVkVHlwZTsNCiAJ
CS8vIGFycmF5IHR5cGUgPw0KQEAgLTI0NSwxMSArMjUwLDE2IEBADQogCQkJCXNjb3BlLnByb2Js
ZW1SZXBvcnRlcigpLnRvb01hbnlEaW1lbnNpb25zKHRoaXMpOw0KIAkJCXR5cGUgPSBzY29wZS5j
cmVhdGVBcnJheVR5cGUodHlwZSwgdGhpcy5kaW1lbnNpb25zKTsNCiAJCX0NCi0JCWlmIChoYXNH
ZW5lcmljRXJyb3IpIHsNCi0JCQlyZXR1cm4gdHlwZTsNCi0JCX0NCiAJCXJldHVybiB0aGlzLnJl
c29sdmVkVHlwZSA9IHR5cGU7DQogCX0NCisJcHJpdmF0ZSB2b2lkIGNyZWF0ZUFycmF5VHlwZShT
Y29wZSBzY29wZSkgew0KKwkJaWYgKHRoaXMuZGltZW5zaW9ucyA+IDApIHsNCisJCQlpZiAodGhp
cy5kaW1lbnNpb25zID4gMjU1KSB7DQorCQkJCXNjb3BlLnByb2JsZW1SZXBvcnRlcigpLnRvb01h
bnlEaW1lbnNpb25zKHRoaXMpOw0KKwkJCX0NCisJCQl0aGlzLnJlc29sdmVkVHlwZSA9IHNjb3Bl
LmNyZWF0ZUFycmF5VHlwZSh0aGlzLnJlc29sdmVkVHlwZSwgdGhpcy5kaW1lbnNpb25zKTsNCisJ
CX0NCisJfQ0KIA0KIAlwdWJsaWMgU3RyaW5nQnVmZmVyIHByaW50RXhwcmVzc2lvbihpbnQgaW5k
ZW50LCBTdHJpbmdCdWZmZXIgb3V0cHV0KXsNCiAJCW91dHB1dC5hcHBlbmQodGhpcy50b2tlbik7
DQpJbmRleDogZG9tL29yZy9lY2xpcHNlL2pkdC9jb3JlL2RvbS9BU1RDb252ZXJ0ZXIuamF2YQ0K
PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09
PT09PT09PT09PQ0KUkNTIGZpbGU6IC9jdnNyb290L2VjbGlwc2Uvb3JnLmVjbGlwc2UuamR0LmNv
cmUvZG9tL29yZy9lY2xpcHNlL2pkdC9jb3JlL2RvbS9BU1RDb252ZXJ0ZXIuamF2YSx2DQpyZXRy
aWV2aW5nIHJldmlzaW9uIDEuMjc1DQpkaWZmIC11IC1yMS4yNzUgQVNUQ29udmVydGVyLmphdmEN
Ci0tLSBkb20vb3JnL2VjbGlwc2UvamR0L2NvcmUvZG9tL0FTVENvbnZlcnRlci5qYXZhCTE0IE1h
ciAyMDExIDE2OjQ2OjUzIC0wMDAwCTEuMjc1DQorKysgZG9tL29yZy9lY2xpcHNlL2pkdC9jb3Jl
L2RvbS9BU1RDb252ZXJ0ZXIuamF2YQkxNCBBcHIgMjAxMSAxNTo1MjoxNiAtMDAwMA0KQEAgLTMx
NTcsMTQgKzMxNTcsMTQgQEANCiAJCQkJCWNhc2UgQVNULkpMUzMgOg0KIAkJCQkJCWlmICh0eXBl
QXJndW1lbnRzICE9IG51bGwpIHsNCiAJCQkJCQkJaW50IG51bWJlck9mRW5jbG9zaW5nVHlwZSA9
IDA7DQotICAgICAgICAgICAgICAgICAgICAgICAgICAgIGludCBzdGFydGluZ0luZGV4ID0gMDsN
Ci0gICAgICAgICAgICAgICAgICAgICAgICAgICAgaW50IGVuZGluZ0luZGV4ID0gMDsNCisJCQkJ
CQkJaW50IHN0YXJ0aW5nSW5kZXggPSAwOw0KKwkJCQkJCQlpbnQgZW5kaW5nSW5kZXggPSAwOw0K
IAkJCQkJCQlmb3IgKGludCBpID0gMCwgbWF4ID0gdHlwZUFyZ3VtZW50cy5sZW5ndGg7IGkgPCBt
YXg7IGkrKykgew0KIAkJCQkJCQkJaWYgKHR5cGVBcmd1bWVudHNbaV0gIT0gbnVsbCkgew0KIAkJ
CQkJCQkJCW51bWJlck9mRW5jbG9zaW5nVHlwZSsrOw0KIAkJCQkJCQkJfSBlbHNlIGlmIChudW1i
ZXJPZkVuY2xvc2luZ1R5cGUgPT0gMCkgew0KLSAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgIGVuZGluZ0luZGV4Kys7DQotICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9
DQorCQkJCQkJCQkJZW5kaW5nSW5kZXgrKzsNCisJCQkJCQkJCX0NCiAJCQkJCQkJfQ0KIAkJCQkJ
CQlOYW1lIG5hbWUgPSBudWxsOw0KIAkJCQkJCQlpZiAoZW5kaW5nSW5kZXggLSBzdGFydGluZ0lu
ZGV4ID09IDApIHsNCkBAIC0zMTg5LDEwICszMTg5LDEwIEBADQogCQkJCQkJCXNpbXBsZVR5cGUu
c2V0U291cmNlUmFuZ2Uoc3RhcnQsIGVuZCAtIHN0YXJ0ICsgMSk7DQogCQkJCQkJCVBhcmFtZXRl
cml6ZWRUeXBlIHBhcmFtZXRlcml6ZWRUeXBlID0gbmV3IFBhcmFtZXRlcml6ZWRUeXBlKHRoaXMu
YXN0KTsNCiAJCQkJCQkJcGFyYW1ldGVyaXplZFR5cGUuc2V0VHlwZShzaW1wbGVUeXBlKTsNCi0g
ICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKHRoaXMucmVzb2x2ZUJpbmRpbmdzKSB7DQot
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICByZWNvcmROb2RlcyhzaW1wbGVUeXBlLCB0
eXBlUmVmZXJlbmNlKTsNCi0gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJlY29yZE5v
ZGVzKHBhcmFtZXRlcml6ZWRUeXBlLCB0eXBlUmVmZXJlbmNlKTsNCi0gICAgICAgICAgICAgICAg
ICAgICAgICAgICAgfQ0KKwkJCQkJCQlpZiAodGhpcy5yZXNvbHZlQmluZGluZ3MpIHsNCisJCQkJ
CQkJCXJlY29yZE5vZGVzKHNpbXBsZVR5cGUsIHR5cGVSZWZlcmVuY2UpOw0KKwkJCQkJCQkJcmVj
b3JkTm9kZXMocGFyYW1ldGVyaXplZFR5cGUsIHR5cGVSZWZlcmVuY2UpOw0KKwkJCQkJCQl9DQog
CQkJCQkJCXN0YXJ0ID0gc2ltcGxlVHlwZS5nZXRTdGFydFBvc2l0aW9uKCk7DQogCQkJCQkJCWVu
ZCA9IHN0YXJ0ICsgc2ltcGxlVHlwZS5nZXRMZW5ndGgoKSAtIDE7DQogCQkJCQkJCWZvciAoaW50
IGkgPSAwLCBtYXggPSB0eXBlQXJndW1lbnRzW2VuZGluZ0luZGV4XS5sZW5ndGg7IGkgPCBtYXg7
IGkrKykgew0KQEAgLTMyMTgsMjIgKzMyMTgsMjIgQEANCiAJCQkJCQkJCVF1YWxpZmllZFR5cGUg
cXVhbGlmaWVkVHlwZSA9IG5ldyBRdWFsaWZpZWRUeXBlKHRoaXMuYXN0KTsNCiAJCQkJCQkJCXF1
YWxpZmllZFR5cGUuc2V0UXVhbGlmaWVyKGN1cnJlbnRUeXBlKTsNCiAJCQkJCQkJCXF1YWxpZmll
ZFR5cGUuc2V0TmFtZShzaW1wbGVOYW1lKTsNCi0gICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgIGlmICh0aGlzLnJlc29sdmVCaW5kaW5ncykgew0KLSAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgIHJlY29yZE5vZGVzKHNpbXBsZU5hbWUsIHR5cGVSZWZlcmVuY2UpOw0KLSAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJlY29yZE5vZGVzKHF1YWxpZmllZFR5
cGUsIHR5cGVSZWZlcmVuY2UpOw0KLSAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfQ0K
KwkJCQkJCQkJaWYgKHRoaXMucmVzb2x2ZUJpbmRpbmdzKSB7DQorCQkJCQkJCQkJcmVjb3JkTm9k
ZXMoc2ltcGxlTmFtZSwgdHlwZVJlZmVyZW5jZSk7DQorCQkJCQkJCQkJcmVjb3JkTm9kZXMocXVh
bGlmaWVkVHlwZSwgdHlwZVJlZmVyZW5jZSk7DQorCQkJCQkJCQl9DQogCQkJCQkJCQlzdGFydCA9
IGN1cnJlbnRUeXBlLmdldFN0YXJ0UG9zaXRpb24oKTsNCiAJCQkJCQkJCWVuZCA9IHNpbXBsZU5h
bWUuZ2V0U3RhcnRQb3NpdGlvbigpICsgc2ltcGxlTmFtZS5nZXRMZW5ndGgoKSAtIDE7DQogCQkJ
CQkJCQlxdWFsaWZpZWRUeXBlLnNldFNvdXJjZVJhbmdlKHN0YXJ0LCBlbmQgLSBzdGFydCArIDEp
Ow0KIAkJCQkJCQkJaW5kZXhPZkVuY2xvc2luZ1R5cGUrKzsNCiAJCQkJCQkJCWlmICh0eXBlQXJn
dW1lbnRzW3N0YXJ0aW5nSW5kZXhdICE9IG51bGwpIHsNCi0JICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgIAlxdWFsaWZpZWRUeXBlLmluZGV4ID0gaW5kZXhPZkVuY2xvc2luZ1R5cGU7DQor
CQkJCQkJCQkJcXVhbGlmaWVkVHlwZS5pbmRleCA9IGluZGV4T2ZFbmNsb3NpbmdUeXBlOw0KIAkJ
CQkJCQkJCVBhcmFtZXRlcml6ZWRUeXBlIHBhcmFtZXRlcml6ZWRUeXBlMiA9IG5ldyBQYXJhbWV0
ZXJpemVkVHlwZSh0aGlzLmFzdCk7DQogCQkJCQkJCQkJcGFyYW1ldGVyaXplZFR5cGUyLnNldFR5
cGUocXVhbGlmaWVkVHlwZSk7DQotIAkJCQkJCQkJCXBhcmFtZXRlcml6ZWRUeXBlMi5pbmRleCA9
IGluZGV4T2ZFbmNsb3NpbmdUeXBlOw0KLSAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgaWYgKHRoaXMucmVzb2x2ZUJpbmRpbmdzKSB7DQotICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgIHJlY29yZE5vZGVzKHBhcmFtZXRlcml6ZWRUeXBlMiwgdHlwZVJlZmVy
ZW5jZSk7DQotICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfQ0KKwkJCQkJCQkJ
CXBhcmFtZXRlcml6ZWRUeXBlMi5pbmRleCA9IGluZGV4T2ZFbmNsb3NpbmdUeXBlOw0KKwkJCQkJ
CQkJCWlmICh0aGlzLnJlc29sdmVCaW5kaW5ncykgew0KKwkJCQkJCQkJCQlyZWNvcmROb2Rlcyhw
YXJhbWV0ZXJpemVkVHlwZTIsIHR5cGVSZWZlcmVuY2UpOw0KKwkJCQkJCQkJCX0NCiAJCQkJCQkJ
CQlmb3IgKGludCBpID0gMCwgbWF4ID0gdHlwZUFyZ3VtZW50c1tzdGFydGluZ0luZGV4XS5sZW5n
dGg7IGkgPCBtYXg7IGkrKykgew0KIAkJCQkJCQkJCQlmaW5hbCBUeXBlIHR5cGUyID0gY29udmVy
dFR5cGUodHlwZUFyZ3VtZW50c1tzdGFydGluZ0luZGV4XVtpXSk7DQogCQkJCQkJCQkJCXBhcmFt
ZXRlcml6ZWRUeXBlMi50eXBlQXJndW1lbnRzKCkuYWRkKHR5cGUyKTsNCkBAIC0zMjQ1LDcgKzMy
NDUsNyBAQA0KIAkJCQkJCQkJCWN1cnJlbnRUeXBlID0gcGFyYW1ldGVyaXplZFR5cGUyOw0KIAkJ
CQkJCQkJfSBlbHNlIHsNCiAJCQkJCQkJCQljdXJyZW50VHlwZSA9IHF1YWxpZmllZFR5cGU7DQot
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAkJcXVhbGlmaWVkVHlwZS5pbmRleCA9IGlu
ZGV4T2ZFbmNsb3NpbmdUeXBlOw0KKwkJCQkJCQkJCXF1YWxpZmllZFR5cGUuaW5kZXggPSBpbmRl
eE9mRW5jbG9zaW5nVHlwZTsNCiAJCQkJCQkJCX0NCiAJCQkJCQkJCXN0YXJ0aW5nSW5kZXgrKzsN
CiAJCQkJCQkJfQ0KSW5kZXg6IGRvbS9vcmcvZWNsaXBzZS9qZHQvY29yZS9kb20vRGVmYXVsdEJp
bmRpbmdSZXNvbHZlci5qYXZhDQo9PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09
PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09DQpSQ1MgZmlsZTogL2N2c3Jvb3QvZWNsaXBz
ZS9vcmcuZWNsaXBzZS5qZHQuY29yZS9kb20vb3JnL2VjbGlwc2UvamR0L2NvcmUvZG9tL0RlZmF1
bHRCaW5kaW5nUmVzb2x2ZXIuamF2YSx2DQpyZXRyaWV2aW5nIHJldmlzaW9uIDEuMTczDQpkaWZm
IC11IC1yMS4xNzMgRGVmYXVsdEJpbmRpbmdSZXNvbHZlci5qYXZhDQotLS0gZG9tL29yZy9lY2xp
cHNlL2pkdC9jb3JlL2RvbS9EZWZhdWx0QmluZGluZ1Jlc29sdmVyLmphdmEJMTMgQXByIDIwMTEg
MTQ6MTA6MjkgLTAwMDAJMS4xNzMNCisrKyBkb20vb3JnL2VjbGlwc2UvamR0L2NvcmUvZG9tL0Rl
ZmF1bHRCaW5kaW5nUmVzb2x2ZXIuamF2YQkxNCBBcHIgMjAxMSAxNTo1MjoxNiAtMDAwMA0KQEAg
LTE1MjMsMTEgKzE1MjMsOCBAQA0KIAkJCQkJCXJldHVybiBudWxsOw0KIAkJCQkJfQ0KIAkJCQkJ
QXJyYXlUeXBlIGFycmF5VHlwZSA9IChBcnJheVR5cGUpIHR5cGU7DQotCQkJCQlpZiAodHlwZUJp
bmRpbmcuaXNBcnJheVR5cGUoKSkgew0KLQkJCQkJCUFycmF5QmluZGluZyBhcnJheUJpbmRpbmcg
PSAoQXJyYXlCaW5kaW5nKSB0eXBlQmluZGluZzsNCi0JCQkJCQlyZXR1cm4gZ2V0VHlwZUJpbmRp
bmcodGhpcy5zY29wZS5jcmVhdGVBcnJheVR5cGUoYXJyYXlCaW5kaW5nLmxlYWZDb21wb25lbnRU
eXBlLCBhcnJheVR5cGUuZ2V0RGltZW5zaW9ucygpKSk7DQotCQkJCQl9DQotCQkJCQlyZXR1cm4g
Z2V0VHlwZUJpbmRpbmcodGhpcy5zY29wZS5jcmVhdGVBcnJheVR5cGUodHlwZUJpbmRpbmcsIGFy
cmF5VHlwZS5nZXREaW1lbnNpb25zKCkpKTsNCisJCQkJCUFycmF5QmluZGluZyBhcnJheUJpbmRp
bmcgPSAoQXJyYXlCaW5kaW5nKSB0eXBlQmluZGluZzsNCisJCQkJCXJldHVybiBnZXRUeXBlQmlu
ZGluZyh0aGlzLnNjb3BlLmNyZWF0ZUFycmF5VHlwZShhcnJheUJpbmRpbmcubGVhZkNvbXBvbmVu
dFR5cGUsIGFycmF5VHlwZS5nZXREaW1lbnNpb25zKCkpKTsNCiAJCQkJfQ0KIAkJCQlpZiAodHlw
ZUJpbmRpbmcuaXNBcnJheVR5cGUoKSkgew0KIAkJCQkJdHlwZUJpbmRpbmcgPSAoKEFycmF5Qmlu
ZGluZykgdHlwZUJpbmRpbmcpLmxlYWZDb21wb25lbnRUeXBlOw0KQEAgLTE1NjcsMTEgKzE1NjQs
OCBAQA0KIAkJCQkJaWYgKHRoaXMuc2NvcGUgPT0gbnVsbCkgew0KIAkJCQkJCXJldHVybiBudWxs
Ow0KIAkJCQkJfQ0KLQkJCQkJaWYgKGJpbmRpbmcuaXNBcnJheVR5cGUoKSkgew0KLQkJCQkJCUFy
cmF5QmluZGluZyBhcnJheUJpbmRpbmcgPSAoQXJyYXlCaW5kaW5nKSBiaW5kaW5nOw0KLQkJCQkJ
CXJldHVybiBnZXRUeXBlQmluZGluZyh0aGlzLnNjb3BlLmNyZWF0ZUFycmF5VHlwZShhcnJheUJp
bmRpbmcubGVhZkNvbXBvbmVudFR5cGUsIGFycmF5VHlwZS5nZXREaW1lbnNpb25zKCkpKTsNCi0J
CQkJCX0NCi0JCQkJCXJldHVybiBnZXRUeXBlQmluZGluZyh0aGlzLnNjb3BlLmNyZWF0ZUFycmF5
VHlwZShiaW5kaW5nLCBhcnJheVR5cGUuZ2V0RGltZW5zaW9ucygpKSk7DQorCQkJCQlBcnJheUJp
bmRpbmcgYXJyYXlCaW5kaW5nID0gKEFycmF5QmluZGluZykgYmluZGluZzsNCisJCQkJCXJldHVy
biBnZXRUeXBlQmluZGluZyh0aGlzLnNjb3BlLmNyZWF0ZUFycmF5VHlwZShhcnJheUJpbmRpbmcu
bGVhZkNvbXBvbmVudFR5cGUsIGFycmF5VHlwZS5nZXREaW1lbnNpb25zKCkpKTsNCiAJCQkJfSBl
bHNlIGlmIChiaW5kaW5nLmlzQXJyYXlUeXBlKCkpIHsNCiAJCQkJCUFycmF5QmluZGluZyBhcnJh
eUJpbmRpbmcgPSAoQXJyYXlCaW5kaW5nKSBiaW5kaW5nOw0KIAkJCQkJcmV0dXJuIGdldFR5cGVC
aW5kaW5nKGFycmF5QmluZGluZy5sZWFmQ29tcG9uZW50VHlwZSk7DQo=
</data>

          </attachment>
          <attachment
              isobsolete="0"
              ispatch="1"
              isprivate="0"
          >
            <attachid>193272</attachid>
            <date>2011-04-14 11:56:00 -0400</date>
            <delta_ts>2011-04-14 11:56:34 -0400</delta_ts>
            <desc>Same patch</desc>
            <filename>patch_342671_2.txt</filename>
            <type>text/plain</type>
            <size>13939</size>
            <attacher name="Olivier Thomann">Olivier_Thomann</attacher>
            
              <data encoding="base64">IyMjIEVjbGlwc2UgV29ya3NwYWNlIFBhdGNoIDEuMA0KI1Agb3JnLmVjbGlwc2UuamR0LmNvcmUN
CkluZGV4OiBjb21waWxlci9vcmcvZWNsaXBzZS9qZHQvaW50ZXJuYWwvY29tcGlsZXIvYXN0L1Bh
cmFtZXRlcml6ZWRRdWFsaWZpZWRUeXBlUmVmZXJlbmNlLmphdmENCj09PT09PT09PT09PT09PT09
PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT0NClJDUyBm
aWxlOiAvY3Zzcm9vdC9lY2xpcHNlL29yZy5lY2xpcHNlLmpkdC5jb3JlL2NvbXBpbGVyL29yZy9l
Y2xpcHNlL2pkdC9pbnRlcm5hbC9jb21waWxlci9hc3QvUGFyYW1ldGVyaXplZFF1YWxpZmllZFR5
cGVSZWZlcmVuY2UuamF2YSx2DQpyZXRyaWV2aW5nIHJldmlzaW9uIDEuNjMNCmRpZmYgLXUgLXIx
LjYzIFBhcmFtZXRlcml6ZWRRdWFsaWZpZWRUeXBlUmVmZXJlbmNlLmphdmENCi0tLSBjb21waWxl
ci9vcmcvZWNsaXBzZS9qZHQvaW50ZXJuYWwvY29tcGlsZXIvYXN0L1BhcmFtZXRlcml6ZWRRdWFs
aWZpZWRUeXBlUmVmZXJlbmNlLmphdmEJMSBOb3YgMjAxMCAxNDoxNTo0NiAtMDAwMAkxLjYzDQor
KysgY29tcGlsZXIvb3JnL2VjbGlwc2UvamR0L2ludGVybmFsL2NvbXBpbGVyL2FzdC9QYXJhbWV0
ZXJpemVkUXVhbGlmaWVkVHlwZVJlZmVyZW5jZS5qYXZhCTE0IEFwciAyMDExIDE1OjU1OjQ5IC0w
MDAwDQpAQCAtMSw1ICsxLDUgQEANCiAvKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioq
KioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKg0KLSAqIENvcHly
aWdodCAoYykgMjAwMCwgMjAxMCBJQk0gQ29ycG9yYXRpb24gYW5kIG90aGVycy4NCisgKiBDb3B5
cmlnaHQgKGMpIDIwMDAsIDIwMTEgSUJNIENvcnBvcmF0aW9uIGFuZCBvdGhlcnMuDQogICogQWxs
IHJpZ2h0cyByZXNlcnZlZC4gVGhpcyBwcm9ncmFtIGFuZCB0aGUgYWNjb21wYW55aW5nIG1hdGVy
aWFscw0KICAqIGFyZSBtYWRlIGF2YWlsYWJsZSB1bmRlciB0aGUgdGVybXMgb2YgdGhlIEVjbGlw
c2UgUHVibGljIExpY2Vuc2UgdjEuMA0KICAqIHdoaWNoIGFjY29tcGFuaWVzIHRoaXMgZGlzdHJp
YnV0aW9uLCBhbmQgaXMgYXZhaWxhYmxlIGF0DQpAQCAtMTQ4LDYgKzE0OCw3IEBADQogCQkJCQl9
DQogCQkJCX0NCiAJCQl9DQorCQkJY3JlYXRlQXJyYXlUeXBlKHNjb3BlKTsNCiAJCQlyZXR1cm4g
bnVsbDsNCiAJCX0NCiANCkBAIC0xNzMsNiArMTc0LDcgQEANCiAJCQkJCQl9DQogCQkJCSAgICB9
DQogCQkJCX0NCisJCQkJY3JlYXRlQXJyYXlUeXBlKHNjb3BlKTsNCiAJCQkJcmV0dXJuIG51bGw7
DQogCQkJfQ0KIAkJCVJlZmVyZW5jZUJpbmRpbmcgY3VycmVudFR5cGUgPSAoUmVmZXJlbmNlQmlu
ZGluZykgdGhpcy5yZXNvbHZlZFR5cGU7DQpAQCAtMjE5LDMxICsyMjEsMzIgQEANCiAJCQkJCX0N
CiAJCQkJfQ0KIAkJCQlpZiAoYXJnSGFzRXJyb3IpIHsNCisJCQkJCWNyZWF0ZUFycmF5VHlwZShz
Y29wZSk7DQogCQkJCQlyZXR1cm4gbnVsbDsNCiAJCQkJfQ0KIAkJCQlpZiAoaXNDbGFzc1Njb3Bl
KSB7DQogCQkJCQkoKENsYXNzU2NvcGUpIHNjb3BlKS5zdXBlclR5cGVSZWZlcmVuY2UgPSBrZWVw
Ow0KLQkJCQkJaWYgKCgoQ2xhc3NTY29wZSkgc2NvcGUpLmRldGVjdEhpZXJhcmNoeUN5Y2xlKGN1
cnJlbnRPcmlnaW5hbCwgdGhpcykpDQorCQkJCQlpZiAoKChDbGFzc1Njb3BlKSBzY29wZSkuZGV0
ZWN0SGllcmFyY2h5Q3ljbGUoY3VycmVudE9yaWdpbmFsLCB0aGlzKSkgew0KKwkJCQkJCWNyZWF0
ZUFycmF5VHlwZShzY29wZSk7DQogCQkJCQkJcmV0dXJuIG51bGw7DQorCQkJCQl9DQogCQkJCX0N
CiANCiAJCQkgICAgVHlwZVZhcmlhYmxlQmluZGluZ1tdIHR5cGVWYXJpYWJsZXMgPSBjdXJyZW50
T3JpZ2luYWwudHlwZVZhcmlhYmxlcygpOw0KIAkJCQlpZiAodHlwZVZhcmlhYmxlcyA9PSBCaW5k
aW5nLk5PX1RZUEVfVkFSSUFCTEVTKSB7IC8vIGNoZWNrIGdlbmVyaWMNCiAJCQkJCWlmIChzY29w
ZS5jb21waWxlck9wdGlvbnMoKS5vcmlnaW5hbFNvdXJjZUxldmVsID49IENsYXNzRmlsZUNvbnN0
YW50cy5KREsxXzUpIHsgLy8gYmVsb3cgMS41LCBhbHJlYWR5IHJlcG9ydGVkIGFzIHN5bnRheCBl
cnJvcg0KIAkJCQkJCXNjb3BlLnByb2JsZW1SZXBvcnRlcigpLm5vbkdlbmVyaWNUeXBlQ2Fubm90
QmVQYXJhbWV0ZXJpemVkKGksIHRoaXMsIGN1cnJlbnRUeXBlLCBhcmdUeXBlcyk7DQorCQkJCQkJ
Y3JlYXRlQXJyYXlUeXBlKHNjb3BlKTsNCiAJCQkJCQlyZXR1cm4gbnVsbDsNCiAJCQkJCX0NCiAJ
CQkJCXRoaXMucmVzb2x2ZWRUeXBlID0gIChxdWFsaWZ5aW5nVHlwZSAhPSBudWxsICYmIHF1YWxp
ZnlpbmdUeXBlLmlzUGFyYW1ldGVyaXplZFR5cGUoKSkNCiAJCQkJCQk/IHNjb3BlLmVudmlyb25t
ZW50KCkuY3JlYXRlUGFyYW1ldGVyaXplZFR5cGUoY3VycmVudE9yaWdpbmFsLCBudWxsLCBxdWFs
aWZ5aW5nVHlwZSkNCiAJCQkJCQk6IGN1cnJlbnRUeXBlOw0KLQkJCQkJaWYgKHRoaXMuZGltZW5z
aW9ucyA+IDApIHsNCi0JCQkJCQlpZiAodGhpcy5kaW1lbnNpb25zID4gMjU1KQ0KLQkJCQkJCQlz
Y29wZS5wcm9ibGVtUmVwb3J0ZXIoKS50b29NYW55RGltZW5zaW9ucyh0aGlzKTsNCi0JCQkJCQl0
aGlzLnJlc29sdmVkVHlwZSA9IHNjb3BlLmNyZWF0ZUFycmF5VHlwZSh0aGlzLnJlc29sdmVkVHlw
ZSwgdGhpcy5kaW1lbnNpb25zKTsNCi0JCQkJCX0NCisJCQkJCWNyZWF0ZUFycmF5VHlwZShzY29w
ZSk7DQogCQkJCQlyZXR1cm4gdGhpcy5yZXNvbHZlZFR5cGU7DQogCQkJCX0gZWxzZSBpZiAoYXJn
TGVuZ3RoICE9IHR5cGVWYXJpYWJsZXMubGVuZ3RoKSB7IC8vIGNoZWNrIGFyaXR5DQogCQkJCQlz
Y29wZS5wcm9ibGVtUmVwb3J0ZXIoKS5pbmNvcnJlY3RBcml0eUZvclBhcmFtZXRlcml6ZWRUeXBl
KHRoaXMsIGN1cnJlbnRUeXBlLCBhcmdUeXBlcywgaSk7DQorCQkJCQljcmVhdGVBcnJheVR5cGUo
c2NvcGUpOw0KIAkJCQkJcmV0dXJuIG51bGw7DQogCQkJCX0NCiAJCQkJLy8gY2hlY2sgcGFyYW1l
dGVyaXppbmcgbm9uLXN0YXRpYyBtZW1iZXIgdHlwZSBvZiByYXcgdHlwZQ0KQEAgLTI2NSw4ICsy
NjgsMTAgQEANCiAJCSAgICB9IGVsc2Ugew0KIAkJCQlSZWZlcmVuY2VCaW5kaW5nIGN1cnJlbnRP
cmlnaW5hbCA9IChSZWZlcmVuY2VCaW5kaW5nKWN1cnJlbnRUeXBlLm9yaWdpbmFsKCk7DQogCQkJ
CWlmIChpc0NsYXNzU2NvcGUpDQotCQkJCQlpZiAoKChDbGFzc1Njb3BlKSBzY29wZSkuZGV0ZWN0
SGllcmFyY2h5Q3ljbGUoY3VycmVudE9yaWdpbmFsLCB0aGlzKSkNCisJCQkJCWlmICgoKENsYXNz
U2NvcGUpIHNjb3BlKS5kZXRlY3RIaWVyYXJjaHlDeWNsZShjdXJyZW50T3JpZ2luYWwsIHRoaXMp
KSB7DQorCQkJCQkJY3JlYXRlQXJyYXlUeXBlKHNjb3BlKTsNCiAJCQkJCQlyZXR1cm4gbnVsbDsN
CisJCQkJCX0NCiAJCQkJaWYgKGN1cnJlbnRPcmlnaW5hbC5pc0dlbmVyaWNUeXBlKCkpIHsNCiAJ
ICAgCQkJICAgIGlmICh0eXBlSXNDb25zaXN0ZW50ICYmIHF1YWxpZnlpbmdUeXBlICE9IG51bGwg
JiYgcXVhbGlmeWluZ1R5cGUuaXNQYXJhbWV0ZXJpemVkVHlwZSgpKSB7DQogCQkJCQkJc2NvcGUu
cHJvYmxlbVJlcG9ydGVyKCkucGFyYW1ldGVyaXplZE1lbWJlclR5cGVNaXNzaW5nQXJndW1lbnRz
KHRoaXMsIHNjb3BlLmVudmlyb25tZW50KCkuY3JlYXRlUGFyYW1ldGVyaXplZFR5cGUoY3VycmVu
dE9yaWdpbmFsLCBudWxsLCBxdWFsaWZ5aW5nVHlwZSksIGkpOw0KQEAgLTI4MywxMyArMjg4LDE2
IEBADQogCQkJCXJlcG9ydERlcHJlY2F0ZWRUeXBlKHF1YWxpZnlpbmdUeXBlLCBzY29wZSwgaSk7
DQogCQkJdGhpcy5yZXNvbHZlZFR5cGUgPSBxdWFsaWZ5aW5nVHlwZTsNCiAJCX0NCisJCWNyZWF0
ZUFycmF5VHlwZShzY29wZSk7DQorCQlyZXR1cm4gdGhpcy5yZXNvbHZlZFR5cGU7DQorCX0NCisJ
cHJpdmF0ZSB2b2lkIGNyZWF0ZUFycmF5VHlwZShTY29wZSBzY29wZSkgew0KIAkJLy8gYXJyYXkg
dHlwZSA/DQogCQlpZiAodGhpcy5kaW1lbnNpb25zID4gMCkgew0KIAkJCWlmICh0aGlzLmRpbWVu
c2lvbnMgPiAyNTUpDQogCQkJCXNjb3BlLnByb2JsZW1SZXBvcnRlcigpLnRvb01hbnlEaW1lbnNp
b25zKHRoaXMpOw0KIAkJCXRoaXMucmVzb2x2ZWRUeXBlID0gc2NvcGUuY3JlYXRlQXJyYXlUeXBl
KHRoaXMucmVzb2x2ZWRUeXBlLCB0aGlzLmRpbWVuc2lvbnMpOw0KIAkJfQ0KLQkJcmV0dXJuIHRo
aXMucmVzb2x2ZWRUeXBlOw0KIAl9DQogDQogCXB1YmxpYyBTdHJpbmdCdWZmZXIgcHJpbnRFeHBy
ZXNzaW9uKGludCBpbmRlbnQsIFN0cmluZ0J1ZmZlciBvdXRwdXQpIHsNCkluZGV4OiBjb21waWxl
ci9vcmcvZWNsaXBzZS9qZHQvaW50ZXJuYWwvY29tcGlsZXIvYXN0L1BhcmFtZXRlcml6ZWRTaW5n
bGVUeXBlUmVmZXJlbmNlLmphdmENCj09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09
PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT0NClJDUyBmaWxlOiAvY3Zzcm9vdC9lY2xp
cHNlL29yZy5lY2xpcHNlLmpkdC5jb3JlL2NvbXBpbGVyL29yZy9lY2xpcHNlL2pkdC9pbnRlcm5h
bC9jb21waWxlci9hc3QvUGFyYW1ldGVyaXplZFNpbmdsZVR5cGVSZWZlcmVuY2UuamF2YSx2DQpy
ZXRyaWV2aW5nIHJldmlzaW9uIDEuNTQNCmRpZmYgLXUgLXIxLjU0IFBhcmFtZXRlcml6ZWRTaW5n
bGVUeXBlUmVmZXJlbmNlLmphdmENCi0tLSBjb21waWxlci9vcmcvZWNsaXBzZS9qZHQvaW50ZXJu
YWwvY29tcGlsZXIvYXN0L1BhcmFtZXRlcml6ZWRTaW5nbGVUeXBlUmVmZXJlbmNlLmphdmEJMSBO
b3YgMjAxMCAxNDoxNTo0NiAtMDAwMAkxLjU0DQorKysgY29tcGlsZXIvb3JnL2VjbGlwc2UvamR0
L2ludGVybmFsL2NvbXBpbGVyL2FzdC9QYXJhbWV0ZXJpemVkU2luZ2xlVHlwZVJlZmVyZW5jZS5q
YXZhCTE0IEFwciAyMDExIDE1OjU1OjQ5IC0wMDAwDQpAQCAtMSw1ICsxLDUgQEANCiAvKioqKioq
KioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioq
KioqKioqKioqKioqKioqKg0KLSAqIENvcHlyaWdodCAoYykgMjAwMCwgMjAxMCBJQk0gQ29ycG9y
YXRpb24gYW5kIG90aGVycy4NCisgKiBDb3B5cmlnaHQgKGMpIDIwMDAsIDIwMTEgSUJNIENvcnBv
cmF0aW9uIGFuZCBvdGhlcnMuDQogICogQWxsIHJpZ2h0cyByZXNlcnZlZC4gVGhpcyBwcm9ncmFt
IGFuZCB0aGUgYWNjb21wYW55aW5nIG1hdGVyaWFscw0KICAqIGFyZSBtYWRlIGF2YWlsYWJsZSB1
bmRlciB0aGUgdGVybXMgb2YgdGhlIEVjbGlwc2UgUHVibGljIExpY2Vuc2UgdjEuMA0KICAqIHdo
aWNoIGFjY29tcGFuaWVzIHRoaXMgZGlzdHJpYnV0aW9uLCBhbmQgaXMgYXZhaWxhYmxlIGF0DQpA
QCAtMTA1LDcgKzEwNSw2IEBADQogCQkJCX0NCiAJCQl9DQogCQl9DQotCQlib29sZWFuIGhhc0dl
bmVyaWNFcnJvciA9IGZhbHNlOw0KIAkJUmVmZXJlbmNlQmluZGluZyBjdXJyZW50VHlwZTsNCiAJ
CXRoaXMuYml0cyB8PSBBU1ROb2RlLkRpZFJlc29sdmU7DQogCQlpZiAoZW5jbG9zaW5nVHlwZSA9
PSBudWxsKSB7DQpAQCAtMTEzLDcgKzExMiw2IEBADQogCQkJaWYgKHRoaXMucmVzb2x2ZWRUeXBl
LmlzVmFsaWRCaW5kaW5nKCkpIHsNCiAJCQkJY3VycmVudFR5cGUgPSAoUmVmZXJlbmNlQmluZGlu
ZykgdGhpcy5yZXNvbHZlZFR5cGU7DQogCQkJfSBlbHNlIHsNCi0JCQkJaGFzR2VuZXJpY0Vycm9y
ID0gdHJ1ZTsNCiAJCQkJcmVwb3J0SW52YWxpZFR5cGUoc2NvcGUpOw0KIAkJCQlzd2l0Y2ggKHRo
aXMucmVzb2x2ZWRUeXBlLnByb2JsZW1JZCgpKSB7DQogCQkJCQljYXNlIFByb2JsZW1SZWFzb25z
Lk5vdEZvdW5kIDoNCkBAIC0xMjcsMTYgKzEyNSwxNyBAQA0KIAkJCQkJCS8vJEZBTEwtVEhST1VH
SCQgLSB1bmFibGUgdG8gY29tcGxldGUgdHlwZSBiaW5kaW5nLCBidXQgc3RpbGwgcmVzb2x2ZSB0
eXBlIGFyZ3VtZW50cw0KIAkJCQkJZGVmYXVsdCA6DQogCQkJCQkJYm9vbGVhbiBpc0NsYXNzU2Nv
cGUgPSBzY29wZS5raW5kID09IFNjb3BlLkNMQVNTX1NDT1BFOw0KLQkJCQkJaW50IGFyZ0xlbmd0
aCA9IHRoaXMudHlwZUFyZ3VtZW50cy5sZW5ndGg7DQotCQkJCQlmb3IgKGludCBpID0gMDsgaSA8
IGFyZ0xlbmd0aDsgaSsrKSB7DQotCQkJCQkJVHlwZVJlZmVyZW5jZSB0eXBlQXJndW1lbnQgPSB0
aGlzLnR5cGVBcmd1bWVudHNbaV07DQotCQkJCQkJaWYgKGlzQ2xhc3NTY29wZSkgew0KLQkJCQkJ
CQl0eXBlQXJndW1lbnQucmVzb2x2ZVR5cGUoKENsYXNzU2NvcGUpIHNjb3BlKTsNCi0JCQkJCQl9
IGVsc2Ugew0KLQkJCQkJCQl0eXBlQXJndW1lbnQucmVzb2x2ZVR5cGUoKEJsb2NrU2NvcGUpIHNj
b3BlLCBjaGVja0JvdW5kcyk7DQorCQkJCQkJaW50IGFyZ0xlbmd0aCA9IHRoaXMudHlwZUFyZ3Vt
ZW50cy5sZW5ndGg7DQorCQkJCQkJZm9yIChpbnQgaSA9IDA7IGkgPCBhcmdMZW5ndGg7IGkrKykg
ew0KKwkJCQkJCQlUeXBlUmVmZXJlbmNlIHR5cGVBcmd1bWVudCA9IHRoaXMudHlwZUFyZ3VtZW50
c1tpXTsNCisJCQkJCQkJaWYgKGlzQ2xhc3NTY29wZSkgew0KKwkJCQkJCQkJdHlwZUFyZ3VtZW50
LnJlc29sdmVUeXBlKChDbGFzc1Njb3BlKSBzY29wZSk7DQorCQkJCQkJCX0gZWxzZSB7DQorCQkJ
CQkJCQl0eXBlQXJndW1lbnQucmVzb2x2ZVR5cGUoKEJsb2NrU2NvcGUpIHNjb3BlLCBjaGVja0Jv
dW5kcyk7DQorCQkJCQkJCX0NCiAJCQkJCQl9DQotCQkJCQl9DQotCQkJCQlyZXR1cm4gbnVsbDsN
CisJCQkJCQljcmVhdGVBcnJheVR5cGUoc2NvcGUpOw0KKwkJCQkJCXJldHVybiBudWxsOw0KIAkJ
CQl9DQogCQkJCS8vIGJlIHJlc2lsaWVudCwgc3RpbGwgYXR0ZW1wdCByZXNvbHZpbmcgYXJndW1l
bnRzDQogCQkJfQ0KQEAgLTE1MCw4ICsxNDksOCBAQA0KIAkJfSBlbHNlIHsgLy8gcmVzb2x2aW5n
IG1lbWJlciB0eXBlIChyZWxhdGl2ZWx5IHRvIGVuY2xvc2luZ1R5cGUpDQogCQkJdGhpcy5yZXNv
bHZlZFR5cGUgPSBjdXJyZW50VHlwZSA9IHNjb3BlLmdldE1lbWJlclR5cGUodGhpcy50b2tlbiwg
ZW5jbG9zaW5nVHlwZSk7DQogCQkJaWYgKCF0aGlzLnJlc29sdmVkVHlwZS5pc1ZhbGlkQmluZGlu
ZygpKSB7DQotCQkJCWhhc0dlbmVyaWNFcnJvciA9IHRydWU7DQogCQkJCXNjb3BlLnByb2JsZW1S
ZXBvcnRlcigpLmludmFsaWRFbmNsb3NpbmdUeXBlKHRoaXMsIGN1cnJlbnRUeXBlLCBlbmNsb3Np
bmdUeXBlKTsNCisJCQkJY3JlYXRlQXJyYXlUeXBlKHNjb3BlKTsNCiAJCQkJcmV0dXJuIG51bGw7
DQogCQkJfQ0KIAkJCWlmIChpc1R5cGVVc2VEZXByZWNhdGVkKGN1cnJlbnRUeXBlLCBzY29wZSkp
DQpAQCAtMTYzLDM0ICsxNjIsMzcgQEANCiAJCX0NCiANCiAJCS8vIGNoZWNrIGdlbmVyaWMgYW5k
IGFyaXR5DQotCSAgICBib29sZWFuIGlzQ2xhc3NTY29wZSA9IHNjb3BlLmtpbmQgPT0gU2NvcGUu
Q0xBU1NfU0NPUEU7DQotCSAgICBUeXBlUmVmZXJlbmNlIGtlZXAgPSBudWxsOw0KLQkgICAgaWYg
KGlzQ2xhc3NTY29wZSkgew0KLQkgICAgCWtlZXAgPSAoKENsYXNzU2NvcGUpIHNjb3BlKS5zdXBl
clR5cGVSZWZlcmVuY2U7DQotCSAgICAJKChDbGFzc1Njb3BlKSBzY29wZSkuc3VwZXJUeXBlUmVm
ZXJlbmNlID0gbnVsbDsNCi0JICAgIH0NCisJCWJvb2xlYW4gaXNDbGFzc1Njb3BlID0gc2NvcGUu
a2luZCA9PSBTY29wZS5DTEFTU19TQ09QRTsNCisJCVR5cGVSZWZlcmVuY2Uga2VlcCA9IG51bGw7
DQorCQlpZiAoaXNDbGFzc1Njb3BlKSB7DQorCQkJa2VlcCA9ICgoQ2xhc3NTY29wZSkgc2NvcGUp
LnN1cGVyVHlwZVJlZmVyZW5jZTsNCisJCQkoKENsYXNzU2NvcGUpIHNjb3BlKS5zdXBlclR5cGVS
ZWZlcmVuY2UgPSBudWxsOw0KKwkJfQ0KIAkJaW50IGFyZ0xlbmd0aCA9IHRoaXMudHlwZUFyZ3Vt
ZW50cy5sZW5ndGg7DQogCQlUeXBlQmluZGluZ1tdIGFyZ1R5cGVzID0gbmV3IFR5cGVCaW5kaW5n
W2FyZ0xlbmd0aF07DQogCQlib29sZWFuIGFyZ0hhc0Vycm9yID0gZmFsc2U7DQogCQlSZWZlcmVu
Y2VCaW5kaW5nIGN1cnJlbnRPcmlnaW5hbCA9IChSZWZlcmVuY2VCaW5kaW5nKWN1cnJlbnRUeXBl
Lm9yaWdpbmFsKCk7DQogCQlmb3IgKGludCBpID0gMDsgaSA8IGFyZ0xlbmd0aDsgaSsrKSB7DQot
CQkgICAgVHlwZVJlZmVyZW5jZSB0eXBlQXJndW1lbnQgPSB0aGlzLnR5cGVBcmd1bWVudHNbaV07
DQotCQkgICAgVHlwZUJpbmRpbmcgYXJnVHlwZSA9IGlzQ2xhc3NTY29wZQ0KLQkJCQk/IHR5cGVB
cmd1bWVudC5yZXNvbHZlVHlwZUFyZ3VtZW50KChDbGFzc1Njb3BlKSBzY29wZSwgY3VycmVudE9y
aWdpbmFsLCBpKQ0KLQkJCQk6IHR5cGVBcmd1bWVudC5yZXNvbHZlVHlwZUFyZ3VtZW50KChCbG9j
a1Njb3BlKSBzY29wZSwgY3VycmVudE9yaWdpbmFsLCBpKTsNCi0JCSAgICAgaWYgKGFyZ1R5cGUg
PT0gbnVsbCkgew0KLQkJICAgICAgICAgYXJnSGFzRXJyb3IgPSB0cnVlOw0KLQkJICAgICB9IGVs
c2Ugew0KLQkJCSAgICBhcmdUeXBlc1tpXSA9IGFyZ1R5cGU7DQotCQkgICAgIH0NCisJCQlUeXBl
UmVmZXJlbmNlIHR5cGVBcmd1bWVudCA9IHRoaXMudHlwZUFyZ3VtZW50c1tpXTsNCisJCQlUeXBl
QmluZGluZyBhcmdUeXBlID0gaXNDbGFzc1Njb3BlDQorCQkJCQk/IHR5cGVBcmd1bWVudC5yZXNv
bHZlVHlwZUFyZ3VtZW50KChDbGFzc1Njb3BlKSBzY29wZSwgY3VycmVudE9yaWdpbmFsLCBpKQ0K
KwkJCQkJOiB0eXBlQXJndW1lbnQucmVzb2x2ZVR5cGVBcmd1bWVudCgoQmxvY2tTY29wZSkgc2Nv
cGUsIGN1cnJlbnRPcmlnaW5hbCwgaSk7DQorCQkJaWYgKGFyZ1R5cGUgPT0gbnVsbCkgew0KKwkJ
CQlhcmdIYXNFcnJvciA9IHRydWU7DQorCQkJfSBlbHNlIHsNCisJCQkJYXJnVHlwZXNbaV0gPSBh
cmdUeXBlOw0KKwkJCX0NCiAJCX0NCiAJCWlmIChhcmdIYXNFcnJvcikgew0KKwkJCWNyZWF0ZUFy
cmF5VHlwZShzY29wZSk7DQogCQkJcmV0dXJuIG51bGw7DQogCQl9DQogCQlpZiAoaXNDbGFzc1Nj
b3BlKSB7DQotCSAgICAJKChDbGFzc1Njb3BlKSBzY29wZSkuc3VwZXJUeXBlUmVmZXJlbmNlID0g
a2VlcDsNCi0JCQlpZiAoKChDbGFzc1Njb3BlKSBzY29wZSkuZGV0ZWN0SGllcmFyY2h5Q3ljbGUo
Y3VycmVudE9yaWdpbmFsLCB0aGlzKSkNCisJCQkoKENsYXNzU2NvcGUpIHNjb3BlKS5zdXBlclR5
cGVSZWZlcmVuY2UgPSBrZWVwOw0KKwkJCWlmICgoKENsYXNzU2NvcGUpIHNjb3BlKS5kZXRlY3RI
aWVyYXJjaHlDeWNsZShjdXJyZW50T3JpZ2luYWwsIHRoaXMpKSB7DQorCQkJCWNyZWF0ZUFycmF5
VHlwZShzY29wZSk7DQogCQkJCXJldHVybiBudWxsOw0KKwkJCX0NCiAJCX0NCiANCiAJCVR5cGVW
YXJpYWJsZUJpbmRpbmdbXSB0eXBlVmFyaWFibGVzID0gY3VycmVudE9yaWdpbmFsLnR5cGVWYXJp
YWJsZXMoKTsNCkBAIC0yMDAsNiArMjAyLDcgQEANCiAJCQkJaWYgKGlzQ29tcGxpYW50MTUpIHsg
Ly8gYmVsb3cgMS41LCBhbHJlYWR5IHJlcG9ydGVkIGFzIHN5bnRheCBlcnJvcg0KIAkJCQkJdGhp
cy5yZXNvbHZlZFR5cGUgPSBjdXJyZW50VHlwZTsNCiAJCQkJCXNjb3BlLnByb2JsZW1SZXBvcnRl
cigpLm5vbkdlbmVyaWNUeXBlQ2Fubm90QmVQYXJhbWV0ZXJpemVkKDAsIHRoaXMsIGN1cnJlbnRU
eXBlLCBhcmdUeXBlcyk7DQorCQkJCQljcmVhdGVBcnJheVR5cGUoc2NvcGUpOw0KIAkJCQkJcmV0
dXJuIG51bGw7DQogCQkJCX0NCiAJCQl9DQpAQCAtMjEyLDMxICsyMTUsMzMgQEANCiAJCQkJCQlz
Y29wZS5wcm9ibGVtUmVwb3J0ZXIoKS50b29NYW55RGltZW5zaW9ucyh0aGlzKTsNCiAJCQkJCXR5
cGUgPSBzY29wZS5jcmVhdGVBcnJheVR5cGUodHlwZSwgdGhpcy5kaW1lbnNpb25zKTsNCiAJCQkJ
fQ0KLQkJCQlpZiAoaGFzR2VuZXJpY0Vycm9yKQ0KLQkJCQkJcmV0dXJuIHR5cGU7DQogCQkJCXJl
dHVybiB0aGlzLnJlc29sdmVkVHlwZSA9IHR5cGU7DQogCQkJfQ0KIAkJCS8vIGlmIG1pc3Npbmcg
Z2VuZXJpYyB0eXBlLCBhbmQgY29tcGxpYW5jZSA+PSAxLjUsIHRoZW4gd2lsbCByZWJ1aWxkIGEg
cGFyYW1ldGVyaXplZCBiaW5kaW5nDQogCQl9IGVsc2UgaWYgKGFyZ0xlbmd0aCAhPSB0eXBlVmFy
aWFibGVzLmxlbmd0aCkgeyAvLyBjaGVjayBhcml0eQ0KIAkJCXNjb3BlLnByb2JsZW1SZXBvcnRl
cigpLmluY29ycmVjdEFyaXR5Rm9yUGFyYW1ldGVyaXplZFR5cGUodGhpcywgY3VycmVudFR5cGUs
IGFyZ1R5cGVzKTsNCisJCQljcmVhdGVBcnJheVR5cGUoc2NvcGUpOw0KIAkJCXJldHVybiBudWxs
Ow0KIAkJfSBlbHNlIGlmICghY3VycmVudFR5cGUuaXNTdGF0aWMoKSkgew0KIAkJCVJlZmVyZW5j
ZUJpbmRpbmcgYWN0dWFsRW5jbG9zaW5nID0gY3VycmVudFR5cGUuZW5jbG9zaW5nVHlwZSgpOw0K
IAkJCWlmIChhY3R1YWxFbmNsb3NpbmcgIT0gbnVsbCAmJiBhY3R1YWxFbmNsb3NpbmcuaXNSYXdU
eXBlKCkpew0KIAkJCQlzY29wZS5wcm9ibGVtUmVwb3J0ZXIoKS5yYXdNZW1iZXJUeXBlQ2Fubm90
QmVQYXJhbWV0ZXJpemVkKA0KIAkJCQkJCXRoaXMsIHNjb3BlLmVudmlyb25tZW50KCkuY3JlYXRl
UmF3VHlwZShjdXJyZW50T3JpZ2luYWwsIGFjdHVhbEVuY2xvc2luZyksIGFyZ1R5cGVzKTsNCisJ
CQkJY3JlYXRlQXJyYXlUeXBlKHNjb3BlKTsNCiAJCQkJcmV0dXJuIG51bGw7DQogCQkJfQ0KIAkJ
fQ0KIA0KICAgICAJUGFyYW1ldGVyaXplZFR5cGVCaW5kaW5nIHBhcmFtZXRlcml6ZWRUeXBlID0g
c2NvcGUuZW52aXJvbm1lbnQoKS5jcmVhdGVQYXJhbWV0ZXJpemVkVHlwZShjdXJyZW50T3JpZ2lu
YWwsIGFyZ1R5cGVzLCBlbmNsb3NpbmdUeXBlKTsNCiAJCS8vIGNoZWNrIGFyZ3VtZW50IHR5cGUg
Y29tcGF0aWJpbGl0eQ0KLQkJaWYgKGNoZWNrQm91bmRzKSAvLyBvdGhlcndpc2Ugd2lsbCBkbyBp
dCBpbiBTY29wZS5jb25uZWN0VHlwZVZhcmlhYmxlcygpIG9yIGdlbmVyaWMgbWV0aG9kIHJlc29s
dXRpb24NCisJCWlmIChjaGVja0JvdW5kcykgey8vIG90aGVyd2lzZSB3aWxsIGRvIGl0IGluIFNj
b3BlLmNvbm5lY3RUeXBlVmFyaWFibGVzKCkgb3IgZ2VuZXJpYyBtZXRob2QgcmVzb2x1dGlvbg0K
IAkJCXBhcmFtZXRlcml6ZWRUeXBlLmJvdW5kQ2hlY2soc2NvcGUsIHRoaXMudHlwZUFyZ3VtZW50
cyk7DQotCQllbHNlDQorCQl9IGVsc2Ugew0KIAkJCXNjb3BlLmRlZmVyQm91bmRDaGVjayh0aGlz
KTsNCi0JCWlmIChpc1R5cGVVc2VEZXByZWNhdGVkKHBhcmFtZXRlcml6ZWRUeXBlLCBzY29wZSkp
DQorCQl9DQorCQlpZiAoaXNUeXBlVXNlRGVwcmVjYXRlZChwYXJhbWV0ZXJpemVkVHlwZSwgc2Nv
cGUpKSB7DQogCQkJcmVwb3J0RGVwcmVjYXRlZFR5cGUocGFyYW1ldGVyaXplZFR5cGUsIHNjb3Bl
KTsNCisJCX0NCiANCiAJCVR5cGVCaW5kaW5nIHR5cGUgPSBwYXJhbWV0ZXJpemVkVHlwZTsNCiAJ
CS8vIGFycmF5IHR5cGUgPw0KQEAgLTI0NSwxMSArMjUwLDE2IEBADQogCQkJCXNjb3BlLnByb2Js
ZW1SZXBvcnRlcigpLnRvb01hbnlEaW1lbnNpb25zKHRoaXMpOw0KIAkJCXR5cGUgPSBzY29wZS5j
cmVhdGVBcnJheVR5cGUodHlwZSwgdGhpcy5kaW1lbnNpb25zKTsNCiAJCX0NCi0JCWlmIChoYXNH
ZW5lcmljRXJyb3IpIHsNCi0JCQlyZXR1cm4gdHlwZTsNCi0JCX0NCiAJCXJldHVybiB0aGlzLnJl
c29sdmVkVHlwZSA9IHR5cGU7DQogCX0NCisJcHJpdmF0ZSB2b2lkIGNyZWF0ZUFycmF5VHlwZShT
Y29wZSBzY29wZSkgew0KKwkJaWYgKHRoaXMuZGltZW5zaW9ucyA+IDApIHsNCisJCQlpZiAodGhp
cy5kaW1lbnNpb25zID4gMjU1KSB7DQorCQkJCXNjb3BlLnByb2JsZW1SZXBvcnRlcigpLnRvb01h
bnlEaW1lbnNpb25zKHRoaXMpOw0KKwkJCX0NCisJCQl0aGlzLnJlc29sdmVkVHlwZSA9IHNjb3Bl
LmNyZWF0ZUFycmF5VHlwZSh0aGlzLnJlc29sdmVkVHlwZSwgdGhpcy5kaW1lbnNpb25zKTsNCisJ
CX0NCisJfQ0KIA0KIAlwdWJsaWMgU3RyaW5nQnVmZmVyIHByaW50RXhwcmVzc2lvbihpbnQgaW5k
ZW50LCBTdHJpbmdCdWZmZXIgb3V0cHV0KXsNCiAJCW91dHB1dC5hcHBlbmQodGhpcy50b2tlbik7
DQpJbmRleDogZG9tL29yZy9lY2xpcHNlL2pkdC9jb3JlL2RvbS9EZWZhdWx0QmluZGluZ1Jlc29s
dmVyLmphdmENCj09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09
PT09PT09PT09PT09PT09PT09PT0NClJDUyBmaWxlOiAvY3Zzcm9vdC9lY2xpcHNlL29yZy5lY2xp
cHNlLmpkdC5jb3JlL2RvbS9vcmcvZWNsaXBzZS9qZHQvY29yZS9kb20vRGVmYXVsdEJpbmRpbmdS
ZXNvbHZlci5qYXZhLHYNCnJldHJpZXZpbmcgcmV2aXNpb24gMS4xNzMNCmRpZmYgLXUgLXIxLjE3
MyBEZWZhdWx0QmluZGluZ1Jlc29sdmVyLmphdmENCi0tLSBkb20vb3JnL2VjbGlwc2UvamR0L2Nv
cmUvZG9tL0RlZmF1bHRCaW5kaW5nUmVzb2x2ZXIuamF2YQkxMyBBcHIgMjAxMSAxNDoxMDoyOSAt
MDAwMAkxLjE3Mw0KKysrIGRvbS9vcmcvZWNsaXBzZS9qZHQvY29yZS9kb20vRGVmYXVsdEJpbmRp
bmdSZXNvbHZlci5qYXZhCTE0IEFwciAyMDExIDE1OjU1OjQ5IC0wMDAwDQpAQCAtMTUyMywxMSAr
MTUyMyw4IEBADQogCQkJCQkJcmV0dXJuIG51bGw7DQogCQkJCQl9DQogCQkJCQlBcnJheVR5cGUg
YXJyYXlUeXBlID0gKEFycmF5VHlwZSkgdHlwZTsNCi0JCQkJCWlmICh0eXBlQmluZGluZy5pc0Fy
cmF5VHlwZSgpKSB7DQotCQkJCQkJQXJyYXlCaW5kaW5nIGFycmF5QmluZGluZyA9IChBcnJheUJp
bmRpbmcpIHR5cGVCaW5kaW5nOw0KLQkJCQkJCXJldHVybiBnZXRUeXBlQmluZGluZyh0aGlzLnNj
b3BlLmNyZWF0ZUFycmF5VHlwZShhcnJheUJpbmRpbmcubGVhZkNvbXBvbmVudFR5cGUsIGFycmF5
VHlwZS5nZXREaW1lbnNpb25zKCkpKTsNCi0JCQkJCX0NCi0JCQkJCXJldHVybiBnZXRUeXBlQmlu
ZGluZyh0aGlzLnNjb3BlLmNyZWF0ZUFycmF5VHlwZSh0eXBlQmluZGluZywgYXJyYXlUeXBlLmdl
dERpbWVuc2lvbnMoKSkpOw0KKwkJCQkJQXJyYXlCaW5kaW5nIGFycmF5QmluZGluZyA9IChBcnJh
eUJpbmRpbmcpIHR5cGVCaW5kaW5nOw0KKwkJCQkJcmV0dXJuIGdldFR5cGVCaW5kaW5nKHRoaXMu
c2NvcGUuY3JlYXRlQXJyYXlUeXBlKGFycmF5QmluZGluZy5sZWFmQ29tcG9uZW50VHlwZSwgYXJy
YXlUeXBlLmdldERpbWVuc2lvbnMoKSkpOw0KIAkJCQl9DQogCQkJCWlmICh0eXBlQmluZGluZy5p
c0FycmF5VHlwZSgpKSB7DQogCQkJCQl0eXBlQmluZGluZyA9ICgoQXJyYXlCaW5kaW5nKSB0eXBl
QmluZGluZykubGVhZkNvbXBvbmVudFR5cGU7DQpAQCAtMTU2NywxMSArMTU2NCw4IEBADQogCQkJ
CQlpZiAodGhpcy5zY29wZSA9PSBudWxsKSB7DQogCQkJCQkJcmV0dXJuIG51bGw7DQogCQkJCQl9
DQotCQkJCQlpZiAoYmluZGluZy5pc0FycmF5VHlwZSgpKSB7DQotCQkJCQkJQXJyYXlCaW5kaW5n
IGFycmF5QmluZGluZyA9IChBcnJheUJpbmRpbmcpIGJpbmRpbmc7DQotCQkJCQkJcmV0dXJuIGdl
dFR5cGVCaW5kaW5nKHRoaXMuc2NvcGUuY3JlYXRlQXJyYXlUeXBlKGFycmF5QmluZGluZy5sZWFm
Q29tcG9uZW50VHlwZSwgYXJyYXlUeXBlLmdldERpbWVuc2lvbnMoKSkpOw0KLQkJCQkJfQ0KLQkJ
CQkJcmV0dXJuIGdldFR5cGVCaW5kaW5nKHRoaXMuc2NvcGUuY3JlYXRlQXJyYXlUeXBlKGJpbmRp
bmcsIGFycmF5VHlwZS5nZXREaW1lbnNpb25zKCkpKTsNCisJCQkJCUFycmF5QmluZGluZyBhcnJh
eUJpbmRpbmcgPSAoQXJyYXlCaW5kaW5nKSBiaW5kaW5nOw0KKwkJCQkJcmV0dXJuIGdldFR5cGVC
aW5kaW5nKHRoaXMuc2NvcGUuY3JlYXRlQXJyYXlUeXBlKGFycmF5QmluZGluZy5sZWFmQ29tcG9u
ZW50VHlwZSwgYXJyYXlUeXBlLmdldERpbWVuc2lvbnMoKSkpOw0KIAkJCQl9IGVsc2UgaWYgKGJp
bmRpbmcuaXNBcnJheVR5cGUoKSkgew0KIAkJCQkJQXJyYXlCaW5kaW5nIGFycmF5QmluZGluZyA9
IChBcnJheUJpbmRpbmcpIGJpbmRpbmc7DQogCQkJCQlyZXR1cm4gZ2V0VHlwZUJpbmRpbmcoYXJy
YXlCaW5kaW5nLmxlYWZDb21wb25lbnRUeXBlKTsNCg==
</data>

          </attachment>
          <attachment
              isobsolete="0"
              ispatch="1"
              isprivate="0"
          >
            <attachid>193439</attachid>
            <date>2011-04-17 13:31:00 -0400</date>
            <delta_ts>2011-04-17 13:31:18 -0400</delta_ts>
            <desc>my proposal</desc>
            <filename>Bug_342671_SH1.patch</filename>
            <type>text/plain</type>
            <size>10970</size>
            <attacher name="Stephan Herrmann">stephan.herrmann</attacher>
            
              <data encoding="base64">IyMjIEVjbGlwc2UgV29ya3NwYWNlIFBhdGNoIDEuMAojUCBvcmcuZWNsaXBzZS5qZHQuY29yZQpJ
bmRleDogY29tcGlsZXIvb3JnL2VjbGlwc2UvamR0L2ludGVybmFsL2NvbXBpbGVyL2FzdC9QYXJh
bWV0ZXJpemVkUXVhbGlmaWVkVHlwZVJlZmVyZW5jZS5qYXZhCj09PT09PT09PT09PT09PT09PT09
PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT0KUkNTIGZpbGU6
IC9jdnNyb290L2VjbGlwc2Uvb3JnLmVjbGlwc2UuamR0LmNvcmUvY29tcGlsZXIvb3JnL2VjbGlw
c2UvamR0L2ludGVybmFsL2NvbXBpbGVyL2FzdC9QYXJhbWV0ZXJpemVkUXVhbGlmaWVkVHlwZVJl
ZmVyZW5jZS5qYXZhLHYKcmV0cmlldmluZyByZXZpc2lvbiAxLjYzCmRpZmYgLXUgLXIxLjYzIFBh
cmFtZXRlcml6ZWRRdWFsaWZpZWRUeXBlUmVmZXJlbmNlLmphdmEKLS0tIGNvbXBpbGVyL29yZy9l
Y2xpcHNlL2pkdC9pbnRlcm5hbC9jb21waWxlci9hc3QvUGFyYW1ldGVyaXplZFF1YWxpZmllZFR5
cGVSZWZlcmVuY2UuamF2YQkxIE5vdiAyMDEwIDE0OjE1OjQ2IC0wMDAwCTEuNjMKKysrIGNvbXBp
bGVyL29yZy9lY2xpcHNlL2pkdC9pbnRlcm5hbC9jb21waWxlci9hc3QvUGFyYW1ldGVyaXplZFF1
YWxpZmllZFR5cGVSZWZlcmVuY2UuamF2YQkxNyBBcHIgMjAxMSAxNzowMzo0MyAtMDAwMApAQCAt
MSw1ICsxLDUgQEAKIC8qKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioq
KioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqCi0gKiBDb3B5cmlnaHQgKGMpIDIw
MDAsIDIwMTAgSUJNIENvcnBvcmF0aW9uIGFuZCBvdGhlcnMuCisgKiBDb3B5cmlnaHQgKGMpIDIw
MDAsIDIwMTEgSUJNIENvcnBvcmF0aW9uIGFuZCBvdGhlcnMuCiAgKiBBbGwgcmlnaHRzIHJlc2Vy
dmVkLiBUaGlzIHByb2dyYW0gYW5kIHRoZSBhY2NvbXBhbnlpbmcgbWF0ZXJpYWxzCiAgKiBhcmUg
bWFkZSBhdmFpbGFibGUgdW5kZXIgdGhlIHRlcm1zIG9mIHRoZSBFY2xpcHNlIFB1YmxpYyBMaWNl
bnNlIHYxLjAKICAqIHdoaWNoIGFjY29tcGFuaWVzIHRoaXMgZGlzdHJpYnV0aW9uLCBhbmQgaXMg
YXZhaWxhYmxlIGF0CkBAIC0xMjgsNiArMTI4LDExIEBACiAJCQl9CiAJCX0KIAkJdGhpcy5iaXRz
IHw9IEFTVE5vZGUuRGlkUmVzb2x2ZTsKKwkJVHlwZUJpbmRpbmcgdHlwZSA9IGludGVybmFsUmVz
b2x2ZUxlYWZUeXBlKHNjb3BlLCBjaGVja0JvdW5kcyk7CisJCWNyZWF0ZUFycmF5VHlwZShzY29w
ZSk7CisJCXJldHVybiB0eXBlID09IG51bGwgPyB0eXBlIDogdGhpcy5yZXNvbHZlZFR5cGU7CisJ
fQorCXByaXZhdGUgVHlwZUJpbmRpbmcgaW50ZXJuYWxSZXNvbHZlTGVhZlR5cGUoU2NvcGUgc2Nv
cGUsIGJvb2xlYW4gY2hlY2tCb3VuZHMpIHsKIAkJYm9vbGVhbiBpc0NsYXNzU2NvcGUgPSBzY29w
ZS5raW5kID09IFNjb3BlLkNMQVNTX1NDT1BFOwogCQlCaW5kaW5nIGJpbmRpbmcgPSBzY29wZS5n
ZXRQYWNrYWdlKHRoaXMudG9rZW5zKTsKIAkJaWYgKGJpbmRpbmcgIT0gbnVsbCAmJiAhYmluZGlu
Zy5pc1ZhbGlkQmluZGluZygpKSB7CkBAIC0yMzYsMTEgKzI0MSw2IEBACiAJCQkJCXRoaXMucmVz
b2x2ZWRUeXBlID0gIChxdWFsaWZ5aW5nVHlwZSAhPSBudWxsICYmIHF1YWxpZnlpbmdUeXBlLmlz
UGFyYW1ldGVyaXplZFR5cGUoKSkKIAkJCQkJCT8gc2NvcGUuZW52aXJvbm1lbnQoKS5jcmVhdGVQ
YXJhbWV0ZXJpemVkVHlwZShjdXJyZW50T3JpZ2luYWwsIG51bGwsIHF1YWxpZnlpbmdUeXBlKQog
CQkJCQkJOiBjdXJyZW50VHlwZTsKLQkJCQkJaWYgKHRoaXMuZGltZW5zaW9ucyA+IDApIHsKLQkJ
CQkJCWlmICh0aGlzLmRpbWVuc2lvbnMgPiAyNTUpCi0JCQkJCQkJc2NvcGUucHJvYmxlbVJlcG9y
dGVyKCkudG9vTWFueURpbWVuc2lvbnModGhpcyk7Ci0JCQkJCQl0aGlzLnJlc29sdmVkVHlwZSA9
IHNjb3BlLmNyZWF0ZUFycmF5VHlwZSh0aGlzLnJlc29sdmVkVHlwZSwgdGhpcy5kaW1lbnNpb25z
KTsKLQkJCQkJfQogCQkJCQlyZXR1cm4gdGhpcy5yZXNvbHZlZFR5cGU7CiAJCQkJfSBlbHNlIGlm
IChhcmdMZW5ndGggIT0gdHlwZVZhcmlhYmxlcy5sZW5ndGgpIHsgLy8gY2hlY2sgYXJpdHkKIAkJ
CQkJc2NvcGUucHJvYmxlbVJlcG9ydGVyKCkuaW5jb3JyZWN0QXJpdHlGb3JQYXJhbWV0ZXJpemVk
VHlwZSh0aGlzLCBjdXJyZW50VHlwZSwgYXJnVHlwZXMsIGkpOwpAQCAtMjgzLDEzICsyODMsMTQg
QEAKIAkJCQlyZXBvcnREZXByZWNhdGVkVHlwZShxdWFsaWZ5aW5nVHlwZSwgc2NvcGUsIGkpOwog
CQkJdGhpcy5yZXNvbHZlZFR5cGUgPSBxdWFsaWZ5aW5nVHlwZTsKIAkJfQotCQkvLyBhcnJheSB0
eXBlID8KKwkJcmV0dXJuIHRoaXMucmVzb2x2ZWRUeXBlOworCX0KKwlwdWJsaWMgdm9pZCBjcmVh
dGVBcnJheVR5cGUoU2NvcGUgc2NvcGUpIHsKIAkJaWYgKHRoaXMuZGltZW5zaW9ucyA+IDApIHsK
IAkJCWlmICh0aGlzLmRpbWVuc2lvbnMgPiAyNTUpCiAJCQkJc2NvcGUucHJvYmxlbVJlcG9ydGVy
KCkudG9vTWFueURpbWVuc2lvbnModGhpcyk7CiAJCQl0aGlzLnJlc29sdmVkVHlwZSA9IHNjb3Bl
LmNyZWF0ZUFycmF5VHlwZSh0aGlzLnJlc29sdmVkVHlwZSwgdGhpcy5kaW1lbnNpb25zKTsKIAkJ
fQotCQlyZXR1cm4gdGhpcy5yZXNvbHZlZFR5cGU7CiAJfQogCiAJcHVibGljIFN0cmluZ0J1ZmZl
ciBwcmludEV4cHJlc3Npb24oaW50IGluZGVudCwgU3RyaW5nQnVmZmVyIG91dHB1dCkgewpJbmRl
eDogY29tcGlsZXIvb3JnL2VjbGlwc2UvamR0L2ludGVybmFsL2NvbXBpbGVyL2FzdC9QYXJhbWV0
ZXJpemVkU2luZ2xlVHlwZVJlZmVyZW5jZS5qYXZhCj09PT09PT09PT09PT09PT09PT09PT09PT09
PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT0KUkNTIGZpbGU6IC9jdnNy
b290L2VjbGlwc2Uvb3JnLmVjbGlwc2UuamR0LmNvcmUvY29tcGlsZXIvb3JnL2VjbGlwc2UvamR0
L2ludGVybmFsL2NvbXBpbGVyL2FzdC9QYXJhbWV0ZXJpemVkU2luZ2xlVHlwZVJlZmVyZW5jZS5q
YXZhLHYKcmV0cmlldmluZyByZXZpc2lvbiAxLjU0CmRpZmYgLXUgLXIxLjU0IFBhcmFtZXRlcml6
ZWRTaW5nbGVUeXBlUmVmZXJlbmNlLmphdmEKLS0tIGNvbXBpbGVyL29yZy9lY2xpcHNlL2pkdC9p
bnRlcm5hbC9jb21waWxlci9hc3QvUGFyYW1ldGVyaXplZFNpbmdsZVR5cGVSZWZlcmVuY2UuamF2
YQkxIE5vdiAyMDEwIDE0OjE1OjQ2IC0wMDAwCTEuNTQKKysrIGNvbXBpbGVyL29yZy9lY2xpcHNl
L2pkdC9pbnRlcm5hbC9jb21waWxlci9hc3QvUGFyYW1ldGVyaXplZFNpbmdsZVR5cGVSZWZlcmVu
Y2UuamF2YQkxNyBBcHIgMjAxMSAxNzowMzo0MyAtMDAwMApAQCAtMSw1ICsxLDUgQEAKIC8qKioq
KioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioq
KioqKioqKioqKioqKioqKioqCi0gKiBDb3B5cmlnaHQgKGMpIDIwMDAsIDIwMTAgSUJNIENvcnBv
cmF0aW9uIGFuZCBvdGhlcnMuCisgKiBDb3B5cmlnaHQgKGMpIDIwMDAsIDIwMTEgSUJNIENvcnBv
cmF0aW9uIGFuZCBvdGhlcnMuCiAgKiBBbGwgcmlnaHRzIHJlc2VydmVkLiBUaGlzIHByb2dyYW0g
YW5kIHRoZSBhY2NvbXBhbnlpbmcgbWF0ZXJpYWxzCiAgKiBhcmUgbWFkZSBhdmFpbGFibGUgdW5k
ZXIgdGhlIHRlcm1zIG9mIHRoZSBFY2xpcHNlIFB1YmxpYyBMaWNlbnNlIHYxLjAKICAqIHdoaWNo
IGFjY29tcGFuaWVzIHRoaXMgZGlzdHJpYnV0aW9uLCBhbmQgaXMgYXZhaWxhYmxlIGF0CkBAIC0x
MDUsMTUgKzEwNSwyOCBAQAogCQkJCX0KIAkJCX0KIAkJfQotCQlib29sZWFuIGhhc0dlbmVyaWNF
cnJvciA9IGZhbHNlOwotCQlSZWZlcmVuY2VCaW5kaW5nIGN1cnJlbnRUeXBlOwogCQl0aGlzLmJp
dHMgfD0gQVNUTm9kZS5EaWRSZXNvbHZlOworCQlUeXBlQmluZGluZyB0eXBlID0gaW50ZXJuYWxS
ZXNvbHZlTGVhZlR5cGUoc2NvcGUsIGVuY2xvc2luZ1R5cGUsIGNoZWNrQm91bmRzKTsKKwkJLy8g
aGFuZGxlIHRocmVlIGRpZmZlcmVudCBvdXRjb21lczoKKwkJaWYgKHR5cGUgPT0gbnVsbCkgewkJ
IAorCQkJdGhpcy5yZXNvbHZlZFR5cGUgPSBjcmVhdGVBcnJheVR5cGUoc2NvcGUsIHRoaXMucmVz
b2x2ZWRUeXBlKTsKKwkJCXJldHVybiBudWxsOwkJCQkJCQkvLyBubyB1c2VmdWwgdHlwZSwgYnV0
IHN0aWxsIGNhcHR1cmVkIGRpbWVuc2lvbnMgaW50byB0aGlzLnJlc29sdmVkVHlwZQorCQl9IGVs
c2UgeworCQkJdHlwZSA9IGNyZWF0ZUFycmF5VHlwZShzY29wZSwgdHlwZSk7CisJCQlpZiAoIXRo
aXMucmVzb2x2ZWRUeXBlLmlzVmFsaWRCaW5kaW5nKCkpCisJCQkJcmV0dXJuIHR5cGU7CQkJCQkJ
Ly8gZm91bmQgc29tZSBlcnJvciwgYnV0IGNvdWxkIHJlY292ZXIgdXNlZnVsIHR5cGUgKGxpa2Ug
Y2xvc2VzdE1hdGNoKQkKKwkJCWVsc2UgCisJCQkJcmV0dXJuIHRoaXMucmVzb2x2ZWRUeXBlID0g
dHlwZTsgCS8vIG5vIGNvbXBsYWludCwga2VlcCBmdWxseSByZXNvbHZlZCB0eXBlIChpbmNsLiBk
aW1lbnNpb25zKQorCQl9CisJfQorCXByaXZhdGUgVHlwZUJpbmRpbmcgaW50ZXJuYWxSZXNvbHZl
TGVhZlR5cGUoU2NvcGUgc2NvcGUsIFJlZmVyZW5jZUJpbmRpbmcgZW5jbG9zaW5nVHlwZSwgYm9v
bGVhbiBjaGVja0JvdW5kcykgeworCQlSZWZlcmVuY2VCaW5kaW5nIGN1cnJlbnRUeXBlOwogCQlp
ZiAoZW5jbG9zaW5nVHlwZSA9PSBudWxsKSB7CiAJCQl0aGlzLnJlc29sdmVkVHlwZSA9IHNjb3Bl
LmdldFR5cGUodGhpcy50b2tlbik7CiAJCQlpZiAodGhpcy5yZXNvbHZlZFR5cGUuaXNWYWxpZEJp
bmRpbmcoKSkgewogCQkJCWN1cnJlbnRUeXBlID0gKFJlZmVyZW5jZUJpbmRpbmcpIHRoaXMucmVz
b2x2ZWRUeXBlOwogCQkJfSBlbHNlIHsKLQkJCQloYXNHZW5lcmljRXJyb3IgPSB0cnVlOworCQkJ
CQogCQkJCXJlcG9ydEludmFsaWRUeXBlKHNjb3BlKTsKIAkJCQlzd2l0Y2ggKHRoaXMucmVzb2x2
ZWRUeXBlLnByb2JsZW1JZCgpKSB7CiAJCQkJCWNhc2UgUHJvYmxlbVJlYXNvbnMuTm90Rm91bmQg
OgpAQCAtMTUwLDcgKzE2Myw2IEBACiAJCX0gZWxzZSB7IC8vIHJlc29sdmluZyBtZW1iZXIgdHlw
ZSAocmVsYXRpdmVseSB0byBlbmNsb3NpbmdUeXBlKQogCQkJdGhpcy5yZXNvbHZlZFR5cGUgPSBj
dXJyZW50VHlwZSA9IHNjb3BlLmdldE1lbWJlclR5cGUodGhpcy50b2tlbiwgZW5jbG9zaW5nVHlw
ZSk7CiAJCQlpZiAoIXRoaXMucmVzb2x2ZWRUeXBlLmlzVmFsaWRCaW5kaW5nKCkpIHsKLQkJCQlo
YXNHZW5lcmljRXJyb3IgPSB0cnVlOwogCQkJCXNjb3BlLnByb2JsZW1SZXBvcnRlcigpLmludmFs
aWRFbmNsb3NpbmdUeXBlKHRoaXMsIGN1cnJlbnRUeXBlLCBlbmNsb3NpbmdUeXBlKTsKIAkJCQly
ZXR1cm4gbnVsbDsKIAkJCX0KQEAgLTIwNSwxNiArMjE3LDkgQEAKIAkJCX0KIAkJCS8vIHJlc2ls
aWVuY2UgZG8gbm90IHJlYnVpbGQgYSBwYXJhbWV0ZXJpemVkIHR5cGUgdW5sZXNzIGNvbXBsaWFu
Y2UgaXMgYWxsb3dpbmcgaXQKIAkJCWlmICghaXNDb21wbGlhbnQxNSkgewotCQkJCS8vIGFycmF5
IHR5cGUgPwotCQkJCVR5cGVCaW5kaW5nIHR5cGUgPSBjdXJyZW50VHlwZTsKLQkJCQlpZiAodGhp
cy5kaW1lbnNpb25zID4gMCkgewotCQkJCQlpZiAodGhpcy5kaW1lbnNpb25zID4gMjU1KQotCQkJ
CQkJc2NvcGUucHJvYmxlbVJlcG9ydGVyKCkudG9vTWFueURpbWVuc2lvbnModGhpcyk7Ci0JCQkJ
CXR5cGUgPSBzY29wZS5jcmVhdGVBcnJheVR5cGUodHlwZSwgdGhpcy5kaW1lbnNpb25zKTsKLQkJ
CQl9Ci0JCQkJaWYgKGhhc0dlbmVyaWNFcnJvcikKLQkJCQkJcmV0dXJuIHR5cGU7Ci0JCQkJcmV0
dXJuIHRoaXMucmVzb2x2ZWRUeXBlID0gdHlwZTsKKwkJCQlpZiAoIXRoaXMucmVzb2x2ZWRUeXBl
LmlzVmFsaWRCaW5kaW5nKCkpCisJCQkJCXJldHVybiBjdXJyZW50VHlwZTsKKwkJCQlyZXR1cm4g
dGhpcy5yZXNvbHZlZFR5cGUgPSBjdXJyZW50VHlwZTsKIAkJCX0KIAkJCS8vIGlmIG1pc3Npbmcg
Z2VuZXJpYyB0eXBlLCBhbmQgY29tcGxpYW5jZSA+PSAxLjUsIHRoZW4gd2lsbCByZWJ1aWxkIGEg
cGFyYW1ldGVyaXplZCBiaW5kaW5nCiAJCX0gZWxzZSBpZiAoYXJnTGVuZ3RoICE9IHR5cGVWYXJp
YWJsZXMubGVuZ3RoKSB7IC8vIGNoZWNrIGFyaXR5CkBAIC0yMzgsMTcgKzI0MywxOCBAQAogCQlp
ZiAoaXNUeXBlVXNlRGVwcmVjYXRlZChwYXJhbWV0ZXJpemVkVHlwZSwgc2NvcGUpKQogCQkJcmVw
b3J0RGVwcmVjYXRlZFR5cGUocGFyYW1ldGVyaXplZFR5cGUsIHNjb3BlKTsKIAotCQlUeXBlQmlu
ZGluZyB0eXBlID0gcGFyYW1ldGVyaXplZFR5cGU7Ci0JCS8vIGFycmF5IHR5cGUgPworCQlpZiAo
IXRoaXMucmVzb2x2ZWRUeXBlLmlzVmFsaWRCaW5kaW5nKCkpIHsKKwkJCXJldHVybiBwYXJhbWV0
ZXJpemVkVHlwZTsKKwkJfQorCQlyZXR1cm4gdGhpcy5yZXNvbHZlZFR5cGUgPSBwYXJhbWV0ZXJp
emVkVHlwZTsKKwl9CisJcHVibGljIFR5cGVCaW5kaW5nIGNyZWF0ZUFycmF5VHlwZShTY29wZSBz
Y29wZSwgVHlwZUJpbmRpbmcgdHlwZSkgewogCQlpZiAodGhpcy5kaW1lbnNpb25zID4gMCkgewog
CQkJaWYgKHRoaXMuZGltZW5zaW9ucyA+IDI1NSkKIAkJCQlzY29wZS5wcm9ibGVtUmVwb3J0ZXIo
KS50b29NYW55RGltZW5zaW9ucyh0aGlzKTsKLQkJCXR5cGUgPSBzY29wZS5jcmVhdGVBcnJheVR5
cGUodHlwZSwgdGhpcy5kaW1lbnNpb25zKTsKLQkJfQotCQlpZiAoaGFzR2VuZXJpY0Vycm9yKSB7
Ci0JCQlyZXR1cm4gdHlwZTsKKwkJCXJldHVybiBzY29wZS5jcmVhdGVBcnJheVR5cGUodHlwZSwg
dGhpcy5kaW1lbnNpb25zKTsKIAkJfQotCQlyZXR1cm4gdGhpcy5yZXNvbHZlZFR5cGUgPSB0eXBl
OworCQlyZXR1cm4gdHlwZTsKIAl9CiAKIAlwdWJsaWMgU3RyaW5nQnVmZmVyIHByaW50RXhwcmVz
c2lvbihpbnQgaW5kZW50LCBTdHJpbmdCdWZmZXIgb3V0cHV0KXsKSW5kZXg6IGRvbS9vcmcvZWNs
aXBzZS9qZHQvY29yZS9kb20vRGVmYXVsdEJpbmRpbmdSZXNvbHZlci5qYXZhCj09PT09PT09PT09
PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT0K
UkNTIGZpbGU6IC9jdnNyb290L2VjbGlwc2Uvb3JnLmVjbGlwc2UuamR0LmNvcmUvZG9tL29yZy9l
Y2xpcHNlL2pkdC9jb3JlL2RvbS9EZWZhdWx0QmluZGluZ1Jlc29sdmVyLmphdmEsdgpyZXRyaWV2
aW5nIHJldmlzaW9uIDEuMTczCmRpZmYgLXUgLXIxLjE3MyBEZWZhdWx0QmluZGluZ1Jlc29sdmVy
LmphdmEKLS0tIGRvbS9vcmcvZWNsaXBzZS9qZHQvY29yZS9kb20vRGVmYXVsdEJpbmRpbmdSZXNv
bHZlci5qYXZhCTEzIEFwciAyMDExIDE0OjEwOjI5IC0wMDAwCTEuMTczCisrKyBkb20vb3JnL2Vj
bGlwc2UvamR0L2NvcmUvZG9tL0RlZmF1bHRCaW5kaW5nUmVzb2x2ZXIuamF2YQkxNyBBcHIgMjAx
MSAxNzowMzo0NyAtMDAwMApAQCAtMTUyMywxMSArMTUyMyw4IEBACiAJCQkJCQlyZXR1cm4gbnVs
bDsKIAkJCQkJfQogCQkJCQlBcnJheVR5cGUgYXJyYXlUeXBlID0gKEFycmF5VHlwZSkgdHlwZTsK
LQkJCQkJaWYgKHR5cGVCaW5kaW5nLmlzQXJyYXlUeXBlKCkpIHsKLQkJCQkJCUFycmF5QmluZGlu
ZyBhcnJheUJpbmRpbmcgPSAoQXJyYXlCaW5kaW5nKSB0eXBlQmluZGluZzsKLQkJCQkJCXJldHVy
biBnZXRUeXBlQmluZGluZyh0aGlzLnNjb3BlLmNyZWF0ZUFycmF5VHlwZShhcnJheUJpbmRpbmcu
bGVhZkNvbXBvbmVudFR5cGUsIGFycmF5VHlwZS5nZXREaW1lbnNpb25zKCkpKTsKLQkJCQkJfQot
CQkJCQlyZXR1cm4gZ2V0VHlwZUJpbmRpbmcodGhpcy5zY29wZS5jcmVhdGVBcnJheVR5cGUodHlw
ZUJpbmRpbmcsIGFycmF5VHlwZS5nZXREaW1lbnNpb25zKCkpKTsKKwkJCQkJQXJyYXlCaW5kaW5n
IGFycmF5QmluZGluZyA9IChBcnJheUJpbmRpbmcpIHR5cGVCaW5kaW5nOworCQkJCQlyZXR1cm4g
Z2V0VHlwZUJpbmRpbmcodGhpcy5zY29wZS5jcmVhdGVBcnJheVR5cGUoYXJyYXlCaW5kaW5nLmxl
YWZDb21wb25lbnRUeXBlLCBhcnJheVR5cGUuZ2V0RGltZW5zaW9ucygpKSk7CiAJCQkJfQogCQkJ
CWlmICh0eXBlQmluZGluZy5pc0FycmF5VHlwZSgpKSB7CiAJCQkJCXR5cGVCaW5kaW5nID0gKChB
cnJheUJpbmRpbmcpIHR5cGVCaW5kaW5nKS5sZWFmQ29tcG9uZW50VHlwZTsKQEAgLTE1NjcsMTEg
KzE1NjQsOCBAQAogCQkJCQlpZiAodGhpcy5zY29wZSA9PSBudWxsKSB7CiAJCQkJCQlyZXR1cm4g
bnVsbDsKIAkJCQkJfQotCQkJCQlpZiAoYmluZGluZy5pc0FycmF5VHlwZSgpKSB7Ci0JCQkJCQlB
cnJheUJpbmRpbmcgYXJyYXlCaW5kaW5nID0gKEFycmF5QmluZGluZykgYmluZGluZzsKLQkJCQkJ
CXJldHVybiBnZXRUeXBlQmluZGluZyh0aGlzLnNjb3BlLmNyZWF0ZUFycmF5VHlwZShhcnJheUJp
bmRpbmcubGVhZkNvbXBvbmVudFR5cGUsIGFycmF5VHlwZS5nZXREaW1lbnNpb25zKCkpKTsKLQkJ
CQkJfQotCQkJCQlyZXR1cm4gZ2V0VHlwZUJpbmRpbmcodGhpcy5zY29wZS5jcmVhdGVBcnJheVR5
cGUoYmluZGluZywgYXJyYXlUeXBlLmdldERpbWVuc2lvbnMoKSkpOworCQkJCQlBcnJheUJpbmRp
bmcgYXJyYXlCaW5kaW5nID0gKEFycmF5QmluZGluZykgYmluZGluZzsKKwkJCQkJcmV0dXJuIGdl
dFR5cGVCaW5kaW5nKHRoaXMuc2NvcGUuY3JlYXRlQXJyYXlUeXBlKGFycmF5QmluZGluZy5sZWFm
Q29tcG9uZW50VHlwZSwgYXJyYXlUeXBlLmdldERpbWVuc2lvbnMoKSkpOwogCQkJCX0gZWxzZSBp
ZiAoYmluZGluZy5pc0FycmF5VHlwZSgpKSB7CiAJCQkJCUFycmF5QmluZGluZyBhcnJheUJpbmRp
bmcgPSAoQXJyYXlCaW5kaW5nKSBiaW5kaW5nOwogCQkJCQlyZXR1cm4gZ2V0VHlwZUJpbmRpbmco
YXJyYXlCaW5kaW5nLmxlYWZDb21wb25lbnRUeXBlKTsKI1Agb3JnLmVjbGlwc2UuamR0LmNvcmUu
dGVzdHMubW9kZWwKSW5kZXg6IHNyYy9vcmcvZWNsaXBzZS9qZHQvY29yZS90ZXN0cy9kb20vQVNU
Q29udmVydGVyMTVUZXN0LmphdmEKPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09
PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PQpSQ1MgZmlsZTogL2N2c3Jvb3QvZWNsaXBz
ZS9vcmcuZWNsaXBzZS5qZHQuY29yZS50ZXN0cy5tb2RlbC9zcmMvb3JnL2VjbGlwc2UvamR0L2Nv
cmUvdGVzdHMvZG9tL0FTVENvbnZlcnRlcjE1VGVzdC5qYXZhLHYKcmV0cmlldmluZyByZXZpc2lv
biAxLjMwNgpkaWZmIC11IC1yMS4zMDYgQVNUQ29udmVydGVyMTVUZXN0LmphdmEKLS0tIHNyYy9v
cmcvZWNsaXBzZS9qZHQvY29yZS90ZXN0cy9kb20vQVNUQ29udmVydGVyMTVUZXN0LmphdmEJMTMg
QXByIDIwMTEgMTQ6MTA6MjkgLTAwMDAJMS4zMDYKKysrIHNyYy9vcmcvZWNsaXBzZS9qZHQvY29y
ZS90ZXN0cy9kb20vQVNUQ29udmVydGVyMTVUZXN0LmphdmEJMTcgQXByIDIwMTEgMTc6MDQ6MTAg
LTAwMDAKQEAgLTQ5LDcgKzQ5LDcgQEAKIAlzdGF0aWMgewogLy8JCVRFU1RTX05VTUJFUlMgPSBu
ZXcgaW50W10geyAzNTEsIDM1MiB9OwogLy8JCVRFU1RTX1JBTkdFID0gbmV3IGludFtdIHsgMzI1
LCAtMSB9OwotLy8JCVRFU1RTX05BTUVTID0gbmV3IFN0cmluZ1tdIHsidGVzdDAyMDQifTsKKy8v
CQlURVNUU19OQU1FUyA9IG5ldyBTdHJpbmdbXSB7InRlc3QwMzUifTsKIAl9CiAJcHVibGljIHN0
YXRpYyBUZXN0IHN1aXRlKCkgewogCQlyZXR1cm4gYnVpbGRNb2RlbFRlc3RTdWl0ZShBU1RDb252
ZXJ0ZXIxNVRlc3QuY2xhc3MpOwpAQCAtMTEyOTUsNiArMTEyOTUsMTcgQEAKIAkJYXNzZXJ0RXF1
YWxzKCJXcm9uZyBmdWxseSBxdWFsaWZpZWQgbmFtZSIsICJ0ZXN0MDM1MS5JMVtdIiwgdHlwZUJp
bmRpbmcuZ2V0UXVhbGlmaWVkTmFtZSgpKTsKIAl9CiAJLy9odHRwczovL2J1Z3MuZWNsaXBzZS5v
cmcvYnVncy9zaG93X2J1Zy5jZ2k/aWQ9MzQyNjcxCisJcHVibGljIHZvaWQgdGVzdDAzNTFhKCkg
dGhyb3dzIEphdmFNb2RlbEV4Y2VwdGlvbiB7CisJCUlDb21waWxhdGlvblVuaXQgc291cmNlVW5p
dCA9IGdldENvbXBpbGF0aW9uVW5pdCgiQ29udmVydGVyMTUiICwgInNyYyIsICJ0ZXN0MDM1MSIs
ICJYLmphdmEiKTsgLy8kTk9OLU5MUy0xJCAvLyROT04tTkxTLTIkIC8vJE5PTi1OTFMtMyQgLy8k
Tk9OLU5MUy00JAorCQlBU1ROb2RlIHJlc3VsdCA9IHJ1bkpMUzNDb252ZXJzaW9uKHNvdXJjZVVu
aXQsIHRydWUsIHRydWUpOworCQlhc3NlcnRUcnVlKCJOb3QgYSBjb21waWxhdGlvbiB1bml0Iiwg
cmVzdWx0LmdldE5vZGVUeXBlKCkgPT0gQVNUTm9kZS5DT01QSUxBVElPTl9VTklUKTsKKwkJQ29t
cGlsYXRpb25Vbml0IHVuaXQgPSAoQ29tcGlsYXRpb25Vbml0KSByZXN1bHQ7CisJCU1ldGhvZERl
Y2xhcmF0aW9uIG1ldGhvZERlY2xhcmF0aW9uID0gKE1ldGhvZERlY2xhcmF0aW9uKSBnZXRBU1RO
b2RlKHVuaXQsIDAsIDApOworCQlUeXBlIGNvbXBvbmVudFR5cGUgPSAoKEFycmF5VHlwZSltZXRo
b2REZWNsYXJhdGlvbi5nZXRSZXR1cm5UeXBlMigpKS5nZXRDb21wb25lbnRUeXBlKCk7CisJCUlU
eXBlQmluZGluZyB0eXBlQmluZGluZyA9IGNvbXBvbmVudFR5cGUucmVzb2x2ZUJpbmRpbmcoKTsK
KwkJYXNzZXJ0RXF1YWxzKCJXcm9uZyBmdWxseSBxdWFsaWZpZWQgbmFtZSIsICJ0ZXN0MDM1MS5J
MSIsIHR5cGVCaW5kaW5nLmdldFF1YWxpZmllZE5hbWUoKSk7CisJfQorCS8vaHR0cHM6Ly9idWdz
LmVjbGlwc2Uub3JnL2J1Z3Mvc2hvd19idWcuY2dpP2lkPTM0MjY3MQogCXB1YmxpYyB2b2lkIHRl
c3QwMzUyKCkgdGhyb3dzIEphdmFNb2RlbEV4Y2VwdGlvbiB7CiAJCUlDb21waWxhdGlvblVuaXQg
c291cmNlVW5pdCA9IGdldENvbXBpbGF0aW9uVW5pdCgiQ29udmVydGVyMTUiICwgInNyYyIsICJ0
ZXN0MDM1MiIsICJYLmphdmEiKTsgLy8kTk9OLU5MUy0xJCAvLyROT04tTkxTLTIkIC8vJE5PTi1O
TFMtMyQgLy8kTk9OLU5MUy00JAogCQlBU1ROb2RlIHJlc3VsdCA9IHJ1bkpMUzNDb252ZXJzaW9u
KHNvdXJjZVVuaXQsIHRydWUsIHRydWUpOwo=
</data>

          </attachment>
      

    </bug>

</bugzilla>