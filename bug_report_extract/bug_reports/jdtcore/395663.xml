<?xml version="1.0" encoding="UTF-8" standalone="yes" ?>
<!DOCTYPE bugzilla SYSTEM "https://bugs.eclipse.org/bugs/page.cgi?id=bugzilla.dtd">

<bugzilla version="4.4.7"
          urlbase="https://bugs.eclipse.org/bugs/"
          
          maintainer="webmaster@eclipse.org"
>

    <bug>
          <bug_id>395663</bug_id>
          
          <creation_ts>2012-12-04 02:06:00 -0500</creation_ts>
          <short_desc>[1.8][ast rewrite] Add rewrite support for annotations on varargs</short_desc>
          <delta_ts>2013-03-01 10:54:33 -0500</delta_ts>
          <reporter_accessible>1</reporter_accessible>
          <cclist_accessible>1</cclist_accessible>
          <classification_id>2</classification_id>
          <classification>Eclipse</classification>
          <product>JDT</product>
          <component>Core</component>
          <version>3.8</version>
          <rep_platform>PC</rep_platform>
          <op_sys>Windows 7</op_sys>
          <bug_status>RESOLVED</bug_status>
          <resolution>FIXED</resolution>
          
          
          <bug_file_loc></bug_file_loc>
          <status_whiteboard></status_whiteboard>
          <keywords></keywords>
          <priority>P3</priority>
          <bug_severity>enhancement</bug_severity>
          <target_milestone>BETA J8</target_milestone>
          <dependson>391898</dependson>
          <blocked>398940</blocked>
          <everconfirmed>1</everconfirmed>
          <reporter name="Manoj Palat Away Until May 11 2015">manpalat</reporter>
          <assigned_to name="Manoj Palat Away Until May 11 2015">manpalat</assigned_to>
          <cc>jarthana</cc>
    
    <cc>markus_keller</cc>
    
    <cc>srikanth_sankaran</cc>
          
          <votes>0</votes>

      

      

      

          <comment_sort_order>oldest_to_newest</comment_sort_order>  
          <long_desc isprivate="0" >
    <commentid>2190184</commentid>
    <comment_count>0</comment_count>
    <who name="Manoj Palat Away Until May 11 2015">manpalat</who>
    <bug_when>2012-12-04 02:06:22 -0500</bug_when>
    <thetext></thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>2190688</commentid>
    <comment_count>1</comment_count>
      <attachid>224287</attachid>
    <who name="Manoj Palat Away Until May 11 2015">manpalat</who>
    <bug_when>2012-12-04 21:21:06 -0500</bug_when>
    <thetext>Created attachment 224287
Proposed Patch

Modified Patch to suit the changes made while reworking Bug 391898</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>2215190</commentid>
    <comment_count>2</comment_count>
      <attachid>226900</attachid>
    <who name="Manoj Palat Away Until May 11 2015">manpalat</who>
    <bug_when>2013-02-12 03:32:16 -0500</bug_when>
    <thetext>Created attachment 226900
Proposed Patch

Patch updated to the latest source and additional tests added.</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>2216991</commentid>
    <comment_count>3</comment_count>
    <who name="Markus Keller">markus_keller</who>
    <bug_when>2013-02-14 13:58:26 -0500</bug_when>
    <thetext>ASTRewriteAnalyzer:
- rewriteVarargsAnnotations(..) doesn&apos;t need the API level check.
- Don&apos;t create a third copy of rewriteModifiers2(..). Merge rewriteTypeAnnotations(..) and rewriteVarargsAnnotations(..) functionality into rewriteModifiers2(..). Moving lastChild up like in rewriteTypeAnnotations(..) makes sense.
- visit(SingleVariableDeclaration):
  - computes ellipsisEnd twice
  - node.varargsAnnotations().toString().length() is not correct

ASTRewriteFormatter:
- VARARGS_ANNOTATION_SEPARATION doesn&apos;t look correct nor necessary. PARAM_ANNOTATION_SEPARATION is already broken, since the first string contains a syntax error (missing parameter type). I&apos;ll fix that in BETA_JAVA8.

- If we need a new FormattingPrefix, then it would be one that measures the space between type/annotation and &quot;...&quot;. But note that the formatter currently doesn&apos;t work for Java 8, see bug 400830.
The default formatting option for whitespace in front of &quot;...&quot; is &quot;disabled&quot;, so there shouldn&apos;t be any space there in the tests.</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>2219020</commentid>
    <comment_count>4</comment_count>
      <attachid>227309</attachid>
    <who name="Manoj Palat Away Until May 11 2015">manpalat</who>
    <bug_when>2013-02-19 21:09:56 -0500</bug_when>
    <thetext>Created attachment 227309
Proposed Patch

Comments addressed with the notes below:

- rewriteTypeAnnotations() and rewriteVarargsAnnotations() have been made as wrapper functions for rewriteModifiers2() and call sites have not been changed to enhance readability. Can modify the call sites as well if deemed better.

- Formatter changes : using the existing formatter without defining a new formatter. need to be reviewed closely.</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>2224618</commentid>
    <comment_count>5</comment_count>
    <who name="Markus Keller">markus_keller</who>
    <bug_when>2013-03-01 10:54:33 -0500</bug_when>
    <thetext>The merging of ASTRewriteAnalyzer#rewriteModifiers2(..) looked good.

The tests had a nice selection of rewrites, but showed a few remaining problems:
- foo12 was not used. Added another variant for that one.
- Handling of spaces was not addressed. I know this is a tricky business, and it also took me a while to understand how things work. When I was done investigating, I already had the fix together, so I just released everything at once. As you can see, I also added a variant in testVarArgs_since_3 to test the &quot;space before ellipsis&quot; formatter option. This was already missing in 3.8, but it became more apparent now.

Fixed with http://git.eclipse.org/c/jdt/eclipse.jdt.core.git/commit/?id=6cb1a46319677820636b0fbe76d096b92fe1835a

Manoj, please have a look at my changes and speak up if you think something&apos;s weird.</thetext>
  </long_desc>
      
          <attachment
              isobsolete="1"
              ispatch="1"
              isprivate="0"
          >
            <attachid>224287</attachid>
            <date>2012-12-04 21:21:00 -0500</date>
            <delta_ts>2013-02-12 03:32:16 -0500</delta_ts>
            <desc>Proposed Patch</desc>
            <filename>Bug-395663--18compilerASTRewrite-Implementation-Add-.patch</filename>
            <type>text/plain</type>
            <size>16366</size>
            <attacher name="Manoj Palat Away Until May 11 2015">manpalat</attacher>
            
              <data encoding="base64">ZGlmZiAtLWdpdCBhL29yZy5lY2xpcHNlLmpkdC5jb3JlLnRlc3RzLm1vZGVsL3NyYy9vcmcvZWNs
aXBzZS9qZHQvY29yZS90ZXN0cy9yZXdyaXRlL2Rlc2NyaWJpbmcvQVNUUmV3cml0aW5nTWV0aG9k
RGVjbFRlc3QuamF2YSBiL29yZy5lY2xpcHNlLmpkdC5jb3JlLnRlc3RzLm1vZGVsL3NyYy9vcmcv
ZWNsaXBzZS9qZHQvY29yZS90ZXN0cy9yZXdyaXRlL2Rlc2NyaWJpbmcvQVNUUmV3cml0aW5nTWV0
aG9kRGVjbFRlc3QuamF2YQppbmRleCA2M2IwYWE1Li43OTkwMWE5IDEwMDY0NAotLS0gYS9vcmcu
ZWNsaXBzZS5qZHQuY29yZS50ZXN0cy5tb2RlbC9zcmMvb3JnL2VjbGlwc2UvamR0L2NvcmUvdGVz
dHMvcmV3cml0ZS9kZXNjcmliaW5nL0FTVFJld3JpdGluZ01ldGhvZERlY2xUZXN0LmphdmEKKysr
IGIvb3JnLmVjbGlwc2UuamR0LmNvcmUudGVzdHMubW9kZWwvc3JjL29yZy9lY2xpcHNlL2pkdC9j
b3JlL3Rlc3RzL3Jld3JpdGUvZGVzY3JpYmluZy9BU1RSZXdyaXRpbmdNZXRob2REZWNsVGVzdC5q
YXZhCkBAIC0xLDUgKzEsNSBAQAogLyoqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioq
KioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioKLSAqIENvcHlyaWdo
dCAoYykgMjAwMCwgMjAxMCBJQk0gQ29ycG9yYXRpb24gYW5kIG90aGVycy4KKyAqIENvcHlyaWdo
dCAoYykgMjAwMCwgMjAxMiBJQk0gQ29ycG9yYXRpb24gYW5kIG90aGVycy4KICAqIEFsbCByaWdo
dHMgcmVzZXJ2ZWQuIFRoaXMgcHJvZ3JhbSBhbmQgdGhlIGFjY29tcGFueWluZyBtYXRlcmlhbHMK
ICAqIGFyZSBtYWRlIGF2YWlsYWJsZSB1bmRlciB0aGUgdGVybXMgb2YgdGhlIEVjbGlwc2UgUHVi
bGljIExpY2Vuc2UgdjEuMAogICogd2hpY2ggYWNjb21wYW5pZXMgdGhpcyBkaXN0cmlidXRpb24s
IGFuZCBpcyBhdmFpbGFibGUgYXQKQEAgLTIzNTAsOSArMjM1MCw5IEBACiAJCVN0cmluZ0J1ZmZl
ciBidWY9IG5ldyBTdHJpbmdCdWZmZXIoKTsKIAkJYnVmLmFwcGVuZCgicGFja2FnZSB0ZXN0MTtc
biIpOwogCQlidWYuYXBwZW5kKCJwdWJsaWMgY2xhc3MgREQge1xuIik7Ci0JCWJ1Zi5hcHBlbmQo
IiAgICBwcml2YXRlIHZvaWQgZm9vMShTdHJpbmcgZm9ybWF0LCBPYmplY3QuLi4gYXJncyl7XG4i
KTsKKwkJYnVmLmFwcGVuZCgiICAgIHB1YmxpYyB2b2lkIGZvbzEoU3RyaW5nIGZvcm1hdCwgT2Jq
ZWN0Li4uIGFyZ3Mpe1xuIik7CiAJCWJ1Zi5hcHBlbmQoIiAgICB9XG4iKTsKLQkJYnVmLmFwcGVu
ZCgiICAgIHByaXZhdGUgdm9pZCBmb28yKFN0cmluZyBmb3JtYXQsIE9iamVjdFtdIGFyZ3MpIHtc
biIpOworCQlidWYuYXBwZW5kKCIgICAgcHVibGljIHZvaWQgZm9vMihTdHJpbmcgZm9ybWF0LCBP
YmplY3RbXSBhcmdzKSB7XG4iKTsKIAkJYnVmLmFwcGVuZCgiICAgIH1cbiIpOwogCQlidWYuYXBw
ZW5kKCJ9XG4iKTsKIAkJSUNvbXBpbGF0aW9uVW5pdCBjdT0gcGFjazEuY3JlYXRlQ29tcGlsYXRp
b25Vbml0KCJERC5qYXZhIiwgYnVmLnRvU3RyaW5nKCksIGZhbHNlLCBudWxsKTsKQEAgLTIzNzgs
OSArMjM3OCw5IEBACiAJCWJ1Zj0gbmV3IFN0cmluZ0J1ZmZlcigpOwogCQlidWYuYXBwZW5kKCJw
YWNrYWdlIHRlc3QxO1xuIik7CiAJCWJ1Zi5hcHBlbmQoInB1YmxpYyBjbGFzcyBERCB7XG4iKTsK
LQkJYnVmLmFwcGVuZCgiICAgIHByaXZhdGUgdm9pZCBmb28xKFN0cmluZyBmb3JtYXQsIE9iamVj
dCBhcmdzKXtcbiIpOworCQlidWYuYXBwZW5kKCIgICAgcHVibGljIHZvaWQgZm9vMShTdHJpbmcg
Zm9ybWF0LCBPYmplY3QgYXJncyl7XG4iKTsKIAkJYnVmLmFwcGVuZCgiICAgIH1cbiIpOwotCQli
dWYuYXBwZW5kKCIgICAgcHJpdmF0ZSB2b2lkIGZvbzIoU3RyaW5nIGZvcm1hdCwgaW50Li4uIGFy
Z3MpIHtcbiIpOworCQlidWYuYXBwZW5kKCIgICAgcHVibGljIHZvaWQgZm9vMihTdHJpbmcgZm9y
bWF0LCBpbnQuLi4gYXJncykge1xuIik7CiAJCWJ1Zi5hcHBlbmQoIiAgICB9XG4iKTsKIAkJYnVm
LmFwcGVuZCgifVxuIik7CiAJCWFzc2VydEVxdWFsU3RyaW5nKHByZXZpZXcsIGJ1Zi50b1N0cmlu
ZygpKTsKQEAgLTI4NzEsNSArMjg3MSwxMzQgQEAKIAkJYXNzZXJ0RXF1YWxTdHJpbmcocHJldmll
dywgYnVmLnRvU3RyaW5nKCkpOwogCX0KIAorCS8vIGh0dHBzOi8vYnVncy5lY2xpcHNlLm9yZy9i
dWdzL3Nob3dfYnVnLmNnaT9pZD0zOTE4OTgKKwlwdWJsaWMgdm9pZCB0ZXN0VmFyQXJnc0Fubm90
YXRpb25zKCkgdGhyb3dzIEV4Y2VwdGlvbiB7CiAKKwkJSVBhY2thZ2VGcmFnbWVudCBwYWNrMT0g
dGhpcy5zb3VyY2VGb2xkZXIuY3JlYXRlUGFja2FnZUZyYWdtZW50KCJ0ZXN0MSIsIGZhbHNlLCBu
dWxsKTsKKwkJU3RyaW5nQnVmZmVyIGJ1Zj0gbmV3IFN0cmluZ0J1ZmZlcigpOworCQlidWYuYXBw
ZW5kKCJwYWNrYWdlIHRlc3QxO1xuIik7CisJCWJ1Zi5hcHBlbmQoIkBpbnRlcmZhY2UgTWFya2Vy
IHtcbiIpOworCQlidWYuYXBwZW5kKCJ9XG4iKTsKKwkJYnVmLmFwcGVuZCgicHVibGljIGNsYXNz
IEREIHtcbiIpOworCQlidWYuYXBwZW5kKCIgICAgcHVibGljIHZvaWQgZm9vMShTdHJpbmcgZm9y
bWF0LCBPYmplY3QgQE1hcmtlci4uLiBhcmdzKXtcbiIpOworCQlidWYuYXBwZW5kKCIgICAgfVxu
Iik7CisJCWJ1Zi5hcHBlbmQoIiAgICBwdWJsaWMgdm9pZCBmb28yKE9iamVjdCAuLi4gYXJncykg
e1xuIik7CisJCWJ1Zi5hcHBlbmQoIiAgICB9XG4iKTsKKwkJYnVmLmFwcGVuZCgiICAgIHB1Ymxp
YyB2b2lkIGZvbzMoT2JqZWN0IEBNYXJrZXIgLi4uIGFyZ3MpIHtcbiIpOworCQlidWYuYXBwZW5k
KCIgICAgfVxuIik7CisJCWJ1Zi5hcHBlbmQoIiAgICBwdWJsaWMgdm9pZCBmb280KE9iamVjdCBA
TWFya2VyLi4uIGFyZ3MpIHtcbiIpOyAKKwkJYnVmLmFwcGVuZCgiICAgIH1cbiIpOworCQlidWYu
YXBwZW5kKCIgICAgcHVibGljIHZvaWQgZm9vNShPYmplY3QgLi4uIGFyZ3MpIHtcbiIpOyAKKwkJ
YnVmLmFwcGVuZCgiICAgIH1cbiIpOworCQlidWYuYXBwZW5kKCIgICAgcHVibGljIHZvaWQgZm9v
NihPYmplY3QgYXJncykge1xuIik7CisJCWJ1Zi5hcHBlbmQoIiAgICB9XG4iKTsKKwkJYnVmLmFw
cGVuZCgiICAgIHB1YmxpYyB2b2lkIGZvbzcoT2JqZWN0IEBNYXJrZXIgLi4uIGFyZ3MpIHtcbiIp
OworCQlidWYuYXBwZW5kKCIgICAgfVxuIik7CQkKKwkJYnVmLmFwcGVuZCgiICAgIHB1YmxpYyB2
b2lkIGZvbzgoT2JqZWN0IEBNYXJrZXIgLi4uIGFyZ3MpIHtcbiIpOworCQlidWYuYXBwZW5kKCIg
ICAgfVxuIik7CQkKKwkJYnVmLmFwcGVuZCgiICAgIHB1YmxpYyB2b2lkIGZvbzkoQEIgQEMgaW50
IEBBLi4uIGEpIHtcbiIpOworCQlidWYuYXBwZW5kKCIgICAgfVxuIik7CisJCWJ1Zi5hcHBlbmQo
In1cbiIpOworCQlJQ29tcGlsYXRpb25Vbml0IGN1PSBwYWNrMS5jcmVhdGVDb21waWxhdGlvblVu
aXQoIkRELmphdmEiLCBidWYudG9TdHJpbmcoKSwgZmFsc2UsIG51bGwpOworCisJCUNvbXBpbGF0
aW9uVW5pdCBhc3RSb290PSBjcmVhdGVBU1QoQVNULkpMUzgsIGN1LCBmYWxzZSk7CisJCUFTVCBh
c3Q9IGFzdFJvb3QuZ2V0QVNUKCk7CisJCUFTVFJld3JpdGUgcmV3cml0ZT0gQVNUUmV3cml0ZS5j
cmVhdGUoYXN0Um9vdC5nZXRBU1QoKSk7CisJCVR5cGVEZWNsYXJhdGlvbiB0eXBlPSBmaW5kVHlw
ZURlY2xhcmF0aW9uKGFzdFJvb3QsICJERCIpOworCQkKKwkJeworCQkJLy8gUmVtb3ZlIGFubm90
YXRpb24gZnJvbSBmaXJzdCBtZXRob2QgYXJncyAtIGJvdW5kYXJ5IGNvbmRpdGlvbiAtCisJCQkv
LyAtIG9ubHkgb25lIGFubm90YXRpb24gc2hvdWxkIGJlIHByZXNlbnQuCisJCQlNZXRob2REZWNs
YXJhdGlvbiBtZXRob2REZWNsPSBmaW5kTWV0aG9kRGVjbGFyYXRpb24odHlwZSwgImZvbzEiKTsK
KwkJCVNpbmdsZVZhcmlhYmxlRGVjbGFyYXRpb24gcGFyYW0gPSAoU2luZ2xlVmFyaWFibGVEZWNs
YXJhdGlvbikgbWV0aG9kRGVjbC5wYXJhbWV0ZXJzKCkuZ2V0KDEpOworCQkJcmV3cml0ZS5yZW1v
dmUoKEFTVE5vZGUpcGFyYW0udmFyYXJnc0Fubm90YXRpb25zKCkuZ2V0KDApLCBudWxsKTsKKwkJ
CQorCQkJLy8gQWRkIG9uZSBhbm5vdGF0aW9uIHRvIHRoZSBzZWNvbmQgbWV0aG9kIC0gYm91bmRh
cnkgY29uZGl0aW9uIAorCQkJLy8gLSBubyBhbm5vdGF0aW9uIHNob3VsZCBiZSBwcmVzZW50CisJ
CQltZXRob2REZWNsPSBmaW5kTWV0aG9kRGVjbGFyYXRpb24odHlwZSwgImZvbzIiKTsKKwkJCXBh
cmFtID0gKFNpbmdsZVZhcmlhYmxlRGVjbGFyYXRpb24pIG1ldGhvZERlY2wucGFyYW1ldGVycygp
LmdldCgwKTsKKwkJCU1hcmtlckFubm90YXRpb24gbWFya2VyQW5ub3RhdGlvbj0gYXN0Lm5ld01h
cmtlckFubm90YXRpb24oKTsKKwkJCW1hcmtlckFubm90YXRpb24uc2V0VHlwZU5hbWUoYXN0Lm5l
d1NpbXBsZU5hbWUoIlgiKSk7CisJCQlMaXN0UmV3cml0ZSBsaXN0UmV3cml0ZT0gcmV3cml0ZS5n
ZXRMaXN0UmV3cml0ZShwYXJhbSwgU2luZ2xlVmFyaWFibGVEZWNsYXJhdGlvbi5WQVJBUkdTX0FO
Tk9UQVRJT05TX1BST1BFUlRZKTsKKwkJCWxpc3RSZXdyaXRlLmluc2VydEZpcnN0KG1hcmtlckFu
bm90YXRpb24sIG51bGwpOworCisJCQkvLyBSZW1vdmUgdGhlIHZhcmFyZ3MgcHJvcGVydHkgLSBh
bm5vdGF0aW9uKHMpIHNob3VsZCBkaXNhcHBlYXIKKwkJCW1ldGhvZERlY2w9IGZpbmRNZXRob2RE
ZWNsYXJhdGlvbih0eXBlLCAiZm9vMyIpOworCQkJcGFyYW0gPSAoU2luZ2xlVmFyaWFibGVEZWNs
YXJhdGlvbikgbWV0aG9kRGVjbC5wYXJhbWV0ZXJzKCkuZ2V0KDApOworCQkJcmV3cml0ZS5zZXQo
cGFyYW0sIFNpbmdsZVZhcmlhYmxlRGVjbGFyYXRpb24uVkFSQVJHU19QUk9QRVJUWSwgQm9vbGVh
bi5GQUxTRSwgbnVsbCk7CisKKwkJCS8vIFJlbW92ZSB0aGUgdmFyYXJncyBwcm9wZXJ0eSAtIGFu
bm90YXRpb24ocykgc2hvdWxkIGRpc2FwcGVhcgorCQkJLy8gLSBkaWZmZXJzIGZyb20gdGhlIGFi
b3ZlIGR1ZSB0byB0aGUgYWJzZW5jZSBvZiBhIGJsYW5rIGJlZm9yZSAuLi4KKwkJCW1ldGhvZERl
Y2w9IGZpbmRNZXRob2REZWNsYXJhdGlvbih0eXBlLCAiZm9vNCIpOworCQkJcGFyYW0gPSAoU2lu
Z2xlVmFyaWFibGVEZWNsYXJhdGlvbikgbWV0aG9kRGVjbC5wYXJhbWV0ZXJzKCkuZ2V0KDApOwor
CQkJcmV3cml0ZS5zZXQocGFyYW0sIFNpbmdsZVZhcmlhYmxlRGVjbGFyYXRpb24uVkFSQVJHU19Q
Uk9QRVJUWSwgQm9vbGVhbi5GQUxTRSwgbnVsbCk7CisKKwkJCS8vIFJlbW92ZSB0aGUgdmFyYXJn
cyBwcm9wZXJ0eSAtIEV4aXN0aW5nIGZ1bmN0aW9uYWxpdHkgdW5jaGFuZ2VkIHdpdGhvdXQgYW5u
b3RhdGlvbnMKKwkJCW1ldGhvZERlY2w9IGZpbmRNZXRob2REZWNsYXJhdGlvbih0eXBlLCAiZm9v
NSIpOworCQkJcGFyYW0gPSAoU2luZ2xlVmFyaWFibGVEZWNsYXJhdGlvbikgbWV0aG9kRGVjbC5w
YXJhbWV0ZXJzKCkuZ2V0KDApOworCQkJcmV3cml0ZS5zZXQocGFyYW0sIFNpbmdsZVZhcmlhYmxl
RGVjbGFyYXRpb24uVkFSQVJHU19QUk9QRVJUWSwgQm9vbGVhbi5GQUxTRSwgbnVsbCk7CisKKwkJ
CS8vIEFkZCB0aGUgdmFyYXJncyBwcm9wZXJ0eSAgYW5kIGFubm90YXRpb24KKwkJCW1ldGhvZERl
Y2w9IGZpbmRNZXRob2REZWNsYXJhdGlvbih0eXBlLCAiZm9vNiIpOworCQkJcGFyYW0gPSAoU2lu
Z2xlVmFyaWFibGVEZWNsYXJhdGlvbikgbWV0aG9kRGVjbC5wYXJhbWV0ZXJzKCkuZ2V0KDApOwor
CQkJcmV3cml0ZS5zZXQocGFyYW0sIFNpbmdsZVZhcmlhYmxlRGVjbGFyYXRpb24uVkFSQVJHU19Q
Uk9QRVJUWSwgQm9vbGVhbi5UUlVFLCBudWxsKTsKKwkJCW1hcmtlckFubm90YXRpb249IGFzdC5u
ZXdNYXJrZXJBbm5vdGF0aW9uKCk7CisJCQltYXJrZXJBbm5vdGF0aW9uLnNldFR5cGVOYW1lKGFz
dC5uZXdTaW1wbGVOYW1lKCJYIikpOworCQkJbGlzdFJld3JpdGU9IHJld3JpdGUuZ2V0TGlzdFJl
d3JpdGUocGFyYW0sIFNpbmdsZVZhcmlhYmxlRGVjbGFyYXRpb24uVkFSQVJHU19BTk5PVEFUSU9O
U19QUk9QRVJUWSk7CisJCQlsaXN0UmV3cml0ZS5pbnNlcnRGaXJzdChtYXJrZXJBbm5vdGF0aW9u
LCBudWxsKTsKKworCQkJLy8gUmVwbGFjZSBhbm5vdGF0aW9uCisJCQltZXRob2REZWNsPSBmaW5k
TWV0aG9kRGVjbGFyYXRpb24odHlwZSwgImZvbzciKTsKKwkJCXBhcmFtID0gKFNpbmdsZVZhcmlh
YmxlRGVjbGFyYXRpb24pIG1ldGhvZERlY2wucGFyYW1ldGVycygpLmdldCgwKTsKKwkJCW1hcmtl
ckFubm90YXRpb249IGFzdC5uZXdNYXJrZXJBbm5vdGF0aW9uKCk7CisJCQltYXJrZXJBbm5vdGF0
aW9uLnNldFR5cGVOYW1lKGFzdC5uZXdTaW1wbGVOYW1lKCJYIikpOworCQkJcmV3cml0ZS5yZXBs
YWNlKChBU1ROb2RlKXBhcmFtLnZhcmFyZ3NBbm5vdGF0aW9ucygpLmdldCgwKSwgbWFya2VyQW5u
b3RhdGlvbiwgbnVsbCk7CisKKwkJCS8vIFJlc2V0IGFuZCBTZXQgVmFyYXJncyAtIG91dHB1dCBz
aG91bGQgbm90IGNoYW5nZS4KKwkJCW1ldGhvZERlY2w9IGZpbmRNZXRob2REZWNsYXJhdGlvbih0
eXBlLCAiZm9vOCIpOworCQkJcGFyYW0gPSAoU2luZ2xlVmFyaWFibGVEZWNsYXJhdGlvbikgbWV0
aG9kRGVjbC5wYXJhbWV0ZXJzKCkuZ2V0KDApOworCQkJcmV3cml0ZS5zZXQocGFyYW0sIFNpbmds
ZVZhcmlhYmxlRGVjbGFyYXRpb24uVkFSQVJHU19QUk9QRVJUWSwgQm9vbGVhbi5GQUxTRSwgbnVs
bCk7CisJCQlyZXdyaXRlLnNldChwYXJhbSwgU2luZ2xlVmFyaWFibGVEZWNsYXJhdGlvbi5WQVJB
UkdTX1BST1BFUlRZLCBCb29sZWFuLlRSVUUsIG51bGwpOworCisJCQkvLyBBZGQgbXVsdGlwbGUg
KHR3bykgYW5ub3RhdGlvbnMsIHJlbW92ZSBhbiBleGlzdGluZyBhbm5vdGF0aW9uCisJCQltZXRo
b2REZWNsPSBmaW5kTWV0aG9kRGVjbGFyYXRpb24odHlwZSwgImZvbzkiKTsKKwkJCXBhcmFtID0g
KFNpbmdsZVZhcmlhYmxlRGVjbGFyYXRpb24pIG1ldGhvZERlY2wucGFyYW1ldGVycygpLmdldCgw
KTsKKwkJCW1hcmtlckFubm90YXRpb249IGFzdC5uZXdNYXJrZXJBbm5vdGF0aW9uKCk7CisJCQlt
YXJrZXJBbm5vdGF0aW9uLnNldFR5cGVOYW1lKGFzdC5uZXdTaW1wbGVOYW1lKCJYIikpOworCQkJ
bGlzdFJld3JpdGU9IHJld3JpdGUuZ2V0TGlzdFJld3JpdGUocGFyYW0sIFNpbmdsZVZhcmlhYmxl
RGVjbGFyYXRpb24uVkFSQVJHU19BTk5PVEFUSU9OU19QUk9QRVJUWSk7CisJCQlsaXN0UmV3cml0
ZS5pbnNlcnRGaXJzdChtYXJrZXJBbm5vdGF0aW9uLCBudWxsKTsKKwkJCW1hcmtlckFubm90YXRp
b249IGFzdC5uZXdNYXJrZXJBbm5vdGF0aW9uKCk7CisJCQltYXJrZXJBbm5vdGF0aW9uLnNldFR5
cGVOYW1lKGFzdC5uZXdTaW1wbGVOYW1lKCJZIikpOworCQkJbGlzdFJld3JpdGUuaW5zZXJ0Rmly
c3QobWFya2VyQW5ub3RhdGlvbiwgbnVsbCk7CisJCQlyZXdyaXRlLnJlbW92ZSgoQVNUTm9kZSlw
YXJhbS52YXJhcmdzQW5ub3RhdGlvbnMoKS5nZXQoMCksIG51bGwpOworCisJCX0KKwkJU3RyaW5n
IHByZXZpZXc9IGV2YWx1YXRlUmV3cml0ZShjdSwgcmV3cml0ZSk7CisKKwkJYnVmPSBuZXcgU3Ry
aW5nQnVmZmVyKCk7CisJCWJ1Zi5hcHBlbmQoInBhY2thZ2UgdGVzdDE7XG4iKTsKKwkJYnVmLmFw
cGVuZCgiQGludGVyZmFjZSBNYXJrZXIge1xuIik7CisJCWJ1Zi5hcHBlbmQoIn1cbiIpOworCQli
dWYuYXBwZW5kKCJwdWJsaWMgY2xhc3MgREQge1xuIik7CisJCWJ1Zi5hcHBlbmQoIiAgICBwdWJs
aWMgdm9pZCBmb28xKFN0cmluZyBmb3JtYXQsIE9iamVjdCAuLi4gYXJncyl7XG4iKTsKKwkJYnVm
LmFwcGVuZCgiICAgIH1cbiIpOworCQlidWYuYXBwZW5kKCIgICAgcHVibGljIHZvaWQgZm9vMihP
YmplY3QgQFggLi4uIGFyZ3MpIHtcbiIpOworCQlidWYuYXBwZW5kKCIgICAgfVxuIik7CisJCWJ1
Zi5hcHBlbmQoIiAgICBwdWJsaWMgdm9pZCBmb28zKE9iamVjdCBhcmdzKSB7XG4iKTsKKwkJYnVm
LmFwcGVuZCgiICAgIH1cbiIpOworCQlidWYuYXBwZW5kKCIgICAgcHVibGljIHZvaWQgZm9vNChP
YmplY3QgYXJncykge1xuIik7CisJCWJ1Zi5hcHBlbmQoIiAgICB9XG4iKTsKKwkJYnVmLmFwcGVu
ZCgiICAgIHB1YmxpYyB2b2lkIGZvbzUoT2JqZWN0IGFyZ3MpIHtcbiIpOworCQlidWYuYXBwZW5k
KCIgICAgfVxuIik7CisJCWJ1Zi5hcHBlbmQoIiAgICBwdWJsaWMgdm9pZCBmb282KE9iamVjdCBA
WCAuLi5hcmdzKSB7XG4iKTsKKwkJYnVmLmFwcGVuZCgiICAgIH1cbiIpOworCQlidWYuYXBwZW5k
KCIgICAgcHVibGljIHZvaWQgZm9vNyhPYmplY3QgQFggLi4uIGFyZ3MpIHtcbiIpOworCQlidWYu
YXBwZW5kKCIgICAgfVxuIik7CQkKKwkJYnVmLmFwcGVuZCgiICAgIHB1YmxpYyB2b2lkIGZvbzgo
T2JqZWN0IEBNYXJrZXIgLi4uIGFyZ3MpIHtcbiIpOworCQlidWYuYXBwZW5kKCIgICAgfVxuIik7
CQkKKwkJYnVmLmFwcGVuZCgiICAgIHB1YmxpYyB2b2lkIGZvbzkoQEIgQEMgaW50IEBZIEBYIC4u
LiBhKSB7XG4iKTsKKwkJYnVmLmFwcGVuZCgiICAgIH1cbiIpOworCQlidWYuYXBwZW5kKCJ9XG4i
KTsKKwkJYXNzZXJ0RXF1YWxTdHJpbmcocHJldmlldywgYnVmLnRvU3RyaW5nKCkpOwkKKwl9CiB9
CmRpZmYgLS1naXQgYS9vcmcuZWNsaXBzZS5qZHQuY29yZS9kb20vb3JnL2VjbGlwc2UvamR0L2lu
dGVybmFsL2NvcmUvZG9tL3Jld3JpdGUvQVNUUmV3cml0ZUFuYWx5emVyLmphdmEgYi9vcmcuZWNs
aXBzZS5qZHQuY29yZS9kb20vb3JnL2VjbGlwc2UvamR0L2ludGVybmFsL2NvcmUvZG9tL3Jld3Jp
dGUvQVNUUmV3cml0ZUFuYWx5emVyLmphdmEKaW5kZXggYjI2MTFhMS4uMTZkODk3OCAxMDA2NDQK
LS0tIGEvb3JnLmVjbGlwc2UuamR0LmNvcmUvZG9tL29yZy9lY2xpcHNlL2pkdC9pbnRlcm5hbC9j
b3JlL2RvbS9yZXdyaXRlL0FTVFJld3JpdGVBbmFseXplci5qYXZhCisrKyBiL29yZy5lY2xpcHNl
LmpkdC5jb3JlL2RvbS9vcmcvZWNsaXBzZS9qZHQvaW50ZXJuYWwvY29yZS9kb20vcmV3cml0ZS9B
U1RSZXdyaXRlQW5hbHl6ZXIuamF2YQpAQCAtMTU0NCw2ICsxNTQ0LDUyIEBACiAJCXJldHVybiBl
bmRQb3M7CiAJfQogCisJLy8gaHR0cHM6Ly9idWdzLmVjbGlwc2Uub3JnL2J1Z3Mvc2hvd19idWcu
Y2dpP2lkPTM5MTg5OAorCXByaXZhdGUgaW50IHJld3JpdGVWYXJhcmdzQW5ub3RhdGlvbnMoQVNU
Tm9kZSBub2RlLCBDaGlsZExpc3RQcm9wZXJ0eURlc2NyaXB0b3IgcHJvcGVydHksIGludCBwb3Mp
IHsKKwkJaWYgKG5vZGUuZ2V0QVNUKCkuYXBpTGV2ZWwoKSA8IEFTVC5KTFM4KSB7CisJCQlyZXR1
cm4gcG9zOworCQl9CisJCVJld3JpdGVFdmVudCBldmVudD0gZ2V0RXZlbnQobm9kZSwgcHJvcGVy
dHkpOwkJCisJCWlmIChldmVudCA9PSBudWxsIHx8IGV2ZW50LmdldENoYW5nZUtpbmQoKSA9PSBS
ZXdyaXRlRXZlbnQuVU5DSEFOR0VEKSB7CisJCQlyZXR1cm4gZG9WaXNpdChub2RlLCBwcm9wZXJ0
eSwgcG9zKTsKKwkJfQorCQlSZXdyaXRlRXZlbnRbXSBjaGlsZHJlbj0gZXZlbnQuZ2V0Q2hpbGRy
ZW4oKTsKKwkJYm9vbGVhbiBpc0FsbEluc2VydD0gaXNBbGxPZktpbmQoY2hpbGRyZW4sIFJld3Jp
dGVFdmVudC5JTlNFUlRFRCk7CisJCWJvb2xlYW4gaXNBbGxSZW1vdmU9IGlzQWxsT2ZLaW5kKGNo
aWxkcmVuLCBSZXdyaXRlRXZlbnQuUkVNT1ZFRCk7CisJCWlmIChpc0FsbEluc2VydCB8fCBpc0Fs
bFJlbW92ZSkgeworCQkJLy8gdXBkYXRlIHBvcworCQkJdHJ5IHsKKwkJCQlwb3M9IGdldFNjYW5u
ZXIoKS5nZXROZXh0U3RhcnRPZmZzZXQocG9zLCBmYWxzZSk7CisJCQl9IGNhdGNoIChDb3JlRXhj
ZXB0aW9uIGUpIHsKKwkJCQloYW5kbGVFeGNlcHRpb24oZSk7CisJCQl9CisJCX0KKworCQlQcmVm
aXggZm9ybWF0dGVyUHJlZml4OworCQlmb3JtYXR0ZXJQcmVmaXg9IHRoaXMuZm9ybWF0dGVyLlZB
UkFSR1NfQU5OT1RBVElPTl9TRVBBUkFUSU9OOworCQlpbnQgZW5kUG9zPSBuZXcgTW9kaWZpZXJS
ZXdyaXRlcihmb3JtYXR0ZXJQcmVmaXgpLnJld3JpdGVMaXN0KG5vZGUsIHByb3BlcnR5LCBwb3Ms
IFV0aWwuRU1QVFlfU1RSSU5HLCAiICIpOyAvLyROT04tTkxTLTEkIAorCQl0cnkgeworCQkJaW50
IG5leHRQb3M9IGdldFNjYW5uZXIoKS5nZXROZXh0U3RhcnRPZmZzZXQoZW5kUG9zLCBmYWxzZSk7
CisKKwkJCWJvb2xlYW4gbGFzdFVuY2hhbmdlZD0gY2hpbGRyZW5bY2hpbGRyZW4ubGVuZ3RoIC0g
MV0uZ2V0Q2hhbmdlS2luZCgpICE9IFJld3JpdGVFdmVudC5VTkNIQU5HRUQ7CisJCQlpZiAoaXNB
bGxSZW1vdmUpIHsKKwkJCWRvVGV4dFJlbW92ZShlbmRQb3MsIG5leHRQb3MgLSBlbmRQb3MsIGdl
dEVkaXRHcm91cChjaGlsZHJlbltjaGlsZHJlbi5sZW5ndGggLSAxXSkpOworCQkJCXJldHVybiBu
ZXh0UG9zOworCQkJfSBlbHNlIGlmIChpc0FsbEluc2VydCB8fCAobmV4dFBvcyA9PSBlbmRQb3Mg
JiYgbGFzdFVuY2hhbmdlZCkpIHsgLy8gc2VlIGJ1ZyAxNjU2NTQKKwkJCQlSZXdyaXRlRXZlbnQg
bGFzdENoaWxkPSBjaGlsZHJlbltjaGlsZHJlbi5sZW5ndGggLSAxXTsKKwkJCQlTdHJpbmcgc2Vw
YXJhdG9yOworCQkJCWlmIChsYXN0Q2hpbGQuZ2V0TmV3VmFsdWUoKSBpbnN0YW5jZW9mIEFubm90
YXRpb24pIHsKKwkJCQkJc2VwYXJhdG9yPSBmb3JtYXR0ZXJQcmVmaXguZ2V0UHJlZml4KGdldElu
ZGVudChwb3MpKTsKKwkJCQl9IGVsc2UgeworCQkJCQlzZXBhcmF0b3I9IFN0cmluZy52YWx1ZU9m
KCcgJyk7CisJCQkJfQorCQkJCWRvVGV4dEluc2VydChlbmRQb3MsIHNlcGFyYXRvciwgZ2V0RWRp
dEdyb3VwKGxhc3RDaGlsZCkpOworCQkJfQorCQl9IGNhdGNoIChDb3JlRXhjZXB0aW9uIGUpIHsK
KwkJCWhhbmRsZUV4Y2VwdGlvbihlKTsKKwkJfQorCQlyZXR1cm4gZW5kUG9zOworCX0KIAogCXBy
aXZhdGUgdm9pZCByZXBsYWNlT3BlcmF0aW9uKGludCBwb3NCZWZvcmVPcGVyYXRpb24sIFN0cmlu
ZyBuZXdPcGVyYXRpb24sIFRleHRFZGl0R3JvdXAgZWRpdEdyb3VwKSB7CiAJCXRyeSB7CkBAIC0y
ODMyLDEwICsyODc4LDIwIEBACiAJCWlmIChub2RlLmdldEFTVCgpLmFwaUxldmVsKCkgPj0gSkxT
M19JTlRFUk5BTCkgewogCQkJaWYgKGlzQ2hhbmdlZChub2RlLCBTaW5nbGVWYXJpYWJsZURlY2xh
cmF0aW9uLlZBUkFSR1NfUFJPUEVSVFkpKSB7CiAJCQkJaWYgKGdldE5ld1ZhbHVlKG5vZGUsIFNp
bmdsZVZhcmlhYmxlRGVjbGFyYXRpb24uVkFSQVJHU19QUk9QRVJUWSkuZXF1YWxzKEJvb2xlYW4u
VFJVRSkpIHsKKwkJCQkJLy8gaHR0cHM6Ly9idWdzLmVjbGlwc2Uub3JnL2J1Z3Mvc2hvd19idWcu
Y2dpP2lkPTM5MTg5OAorCQkJCQlwb3MgPSByZXdyaXRlVmFyYXJnc0Fubm90YXRpb25zKG5vZGUs
IFNpbmdsZVZhcmlhYmxlRGVjbGFyYXRpb24uVkFSQVJHU19BTk5PVEFUSU9OU19QUk9QRVJUWSwg
cG9zKTsKIAkJCQkJZG9UZXh0SW5zZXJ0KHBvcywgIi4uLiIsIGdldEVkaXRHcm91cChub2RlLCBT
aW5nbGVWYXJpYWJsZURlY2xhcmF0aW9uLlZBUkFSR1NfUFJPUEVSVFkpKTsgLy8kTk9OLU5MUy0x
JAogCQkJCX0gZWxzZSB7CiAJCQkJCXRyeSB7CiAJCQkJCQlpbnQgZWxsaXBzaXNFbmQ9IGdldFNj
YW5uZXIoKS5nZXROZXh0RW5kT2Zmc2V0KHBvcywgdHJ1ZSk7CisJCQkJCQkvLyBodHRwczovL2J1
Z3MuZWNsaXBzZS5vcmcvYnVncy9zaG93X2J1Zy5jZ2k/aWQ9MzkxODk4CisJCQkJCQlpZiAobm9k
ZS5nZXRBU1QoKS5hcGlMZXZlbCgpID49IEFTVC5KTFM4ICYmIG5vZGUudmFyYXJnc0Fubm90YXRp
b25zKCkuc2l6ZSgpID4gMCApIHsKKwkJCQkJCQlpbnQgYW5ub3RhdGlvblN0YXJ0UG9zaXRpb24g
PSBub2RlLmdldFR5cGUoKS5nZXRTdGFydFBvc2l0aW9uKCkgKyBub2RlLmdldFR5cGUoKS5nZXRM
ZW5ndGgoKTsKKwkJCQkJCQlpbnQgYW5ub3RhdGlvbkVuZFBvc2l0aW9uID0gYW5ub3RhdGlvblN0
YXJ0UG9zaXRpb24gKyBub2RlLnZhcmFyZ3NBbm5vdGF0aW9ucygpLnRvU3RyaW5nKCkubGVuZ3Ro
KCkgLSAxOworCQkJCQkJCWVsbGlwc2lzRW5kID0gZ2V0U2Nhbm5lcigpLmdldE5leHRFbmRPZmZz
ZXQoYW5ub3RhdGlvbkVuZFBvc2l0aW9uLCB0cnVlKTsKKwkJCQkJCX0gZWxzZSB7CisJCQkJCQkJ
ZWxsaXBzaXNFbmQ9IGdldFNjYW5uZXIoKS5nZXROZXh0RW5kT2Zmc2V0KHBvcywgdHJ1ZSk7CisJ
CQkJCQl9CQkJCQkJCQogCQkJCQkJZG9UZXh0UmVtb3ZlKHBvcywgZWxsaXBzaXNFbmQgLSBwb3Ms
IGdldEVkaXRHcm91cChub2RlLCBTaW5nbGVWYXJpYWJsZURlY2xhcmF0aW9uLlZBUkFSR1NfUFJP
UEVSVFkpKTsKIAkJCQkJfSBjYXRjaCAoQ29yZUV4Y2VwdGlvbiBlKSB7CiAJCQkJCQloYW5kbGVF
eGNlcHRpb24oZSk7CkBAIC0yODQ0LDYgKzI5MDAsMTIgQEAKIAkJCX0KIAkJCWlmICghbm9kZS5p
c1ZhcmFyZ3MoKSkgewogCQkJCWVuc3VyZVNwYWNlQWZ0ZXJSZXBsYWNlKG5vZGUsIFNpbmdsZVZh
cmlhYmxlRGVjbGFyYXRpb24uVFlQRV9QUk9QRVJUWSk7CisJCQl9IGVsc2Ugey8vIGh0dHBzOi8v
YnVncy5lY2xpcHNlLm9yZy9idWdzL3Nob3dfYnVnLmNnaT9pZD0zOTE4OTgKKwkJCQlpZiAobm9k
ZS5nZXRBU1QoKS5hcGlMZXZlbCgpID49IEFTVC5KTFM4ICYmICFpc0NoYW5nZWQobm9kZSwgU2lu
Z2xlVmFyaWFibGVEZWNsYXJhdGlvbi5WQVJBUkdTX1BST1BFUlRZKQorCQkJCQkJJiYgbm9kZS5p
c1ZhcmFyZ3MoKSkgeworCQkJCQlpbnQgYW5ub3RhdGlvblN0YXJ0UG9zaXRpb24gPSBub2RlLmdl
dFR5cGUoKS5nZXRTdGFydFBvc2l0aW9uKCkgKyBub2RlLmdldFR5cGUoKS5nZXRMZW5ndGgoKTsK
KwkJCQkJcG9zID0gcmV3cml0ZVZhcmFyZ3NBbm5vdGF0aW9ucyhub2RlLCBTaW5nbGVWYXJpYWJs
ZURlY2xhcmF0aW9uLlZBUkFSR1NfQU5OT1RBVElPTlNfUFJPUEVSVFksIGFubm90YXRpb25TdGFy
dFBvc2l0aW9uKTsKKwkJCQl9CiAJCQl9CiAJCX0gZWxzZSB7CiAJCQllbnN1cmVTcGFjZUFmdGVy
UmVwbGFjZShub2RlLCBTaW5nbGVWYXJpYWJsZURlY2xhcmF0aW9uLlRZUEVfUFJPUEVSVFkpOwpk
aWZmIC0tZ2l0IGEvb3JnLmVjbGlwc2UuamR0LmNvcmUvZG9tL29yZy9lY2xpcHNlL2pkdC9pbnRl
cm5hbC9jb3JlL2RvbS9yZXdyaXRlL0FTVFJld3JpdGVGbGF0dGVuZXIuamF2YSBiL29yZy5lY2xp
cHNlLmpkdC5jb3JlL2RvbS9vcmcvZWNsaXBzZS9qZHQvaW50ZXJuYWwvY29yZS9kb20vcmV3cml0
ZS9BU1RSZXdyaXRlRmxhdHRlbmVyLmphdmEKaW5kZXggMTRkMmI1OS4uZDM4N2JjYSAxMDA2NDQK
LS0tIGEvb3JnLmVjbGlwc2UuamR0LmNvcmUvZG9tL29yZy9lY2xpcHNlL2pkdC9pbnRlcm5hbC9j
b3JlL2RvbS9yZXdyaXRlL0FTVFJld3JpdGVGbGF0dGVuZXIuamF2YQorKysgYi9vcmcuZWNsaXBz
ZS5qZHQuY29yZS9kb20vb3JnL2VjbGlwc2UvamR0L2ludGVybmFsL2NvcmUvZG9tL3Jld3JpdGUv
QVNUUmV3cml0ZUZsYXR0ZW5lci5qYXZhCkBAIC03ODcsNiArNzg3LDExIEBACiAJCQl2aXNpdExp
c3Qobm9kZSwgU2luZ2xlVmFyaWFibGVEZWNsYXJhdGlvbi5NT0RJRklFUlMyX1BST1BFUlRZLCBT
dHJpbmcudmFsdWVPZignICcpLCBVdGlsLkVNUFRZX1NUUklORywgU3RyaW5nLnZhbHVlT2YoJyAn
KSk7CiAJCX0KIAkJZ2V0Q2hpbGROb2RlKG5vZGUsIFNpbmdsZVZhcmlhYmxlRGVjbGFyYXRpb24u
VFlQRV9QUk9QRVJUWSkuYWNjZXB0KHRoaXMpOworCQkKKwkJLy8gaHR0cHM6Ly9idWdzLmVjbGlw
c2Uub3JnL2J1Z3Mvc2hvd19idWcuY2dpP2lkPTM5MTg5OAorCQlpZiAobm9kZS5nZXRBU1QoKS5h
cGlMZXZlbCgpID49IEFTVC5KTFM4ICAmJiBub2RlLmlzVmFyYXJncygpKSB7CisJCQl2aXNpdExp
c3Qobm9kZSwgU2luZ2xlVmFyaWFibGVEZWNsYXJhdGlvbi5WQVJBUkdTX0FOTk9UQVRJT05TX1BS
T1BFUlRZLCBTdHJpbmcudmFsdWVPZignICcpLCBVdGlsLkVNUFRZX1NUUklORywgU3RyaW5nLnZh
bHVlT2YoJyAnKSk7CisJCX0KIAkJaWYgKG5vZGUuZ2V0QVNUKCkuYXBpTGV2ZWwoKSA+PSBKTFMz
X0lOVEVSTkFMKSB7CiAJCQlpZiAoZ2V0Qm9vbGVhbkF0dHJpYnV0ZShub2RlLCBTaW5nbGVWYXJp
YWJsZURlY2xhcmF0aW9uLlZBUkFSR1NfUFJPUEVSVFkpKSB7CiAJCQkJdGhpcy5yZXN1bHQuYXBw
ZW5kKCIuLi4iKTsvLyROT04tTkxTLTEkCmRpZmYgLS1naXQgYS9vcmcuZWNsaXBzZS5qZHQuY29y
ZS9kb20vb3JnL2VjbGlwc2UvamR0L2ludGVybmFsL2NvcmUvZG9tL3Jld3JpdGUvQVNUUmV3cml0
ZUZvcm1hdHRlci5qYXZhIGIvb3JnLmVjbGlwc2UuamR0LmNvcmUvZG9tL29yZy9lY2xpcHNlL2pk
dC9pbnRlcm5hbC9jb3JlL2RvbS9yZXdyaXRlL0FTVFJld3JpdGVGb3JtYXR0ZXIuamF2YQppbmRl
eCA4ZTM5ZjdkLi5kNWM2ZmNlIDEwMDY0NAotLS0gYS9vcmcuZWNsaXBzZS5qZHQuY29yZS9kb20v
b3JnL2VjbGlwc2UvamR0L2ludGVybmFsL2NvcmUvZG9tL3Jld3JpdGUvQVNUUmV3cml0ZUZvcm1h
dHRlci5qYXZhCisrKyBiL29yZy5lY2xpcHNlLmpkdC5jb3JlL2RvbS9vcmcvZWNsaXBzZS9qZHQv
aW50ZXJuYWwvY29yZS9kb20vcmV3cml0ZS9BU1RSZXdyaXRlRm9ybWF0dGVyLmphdmEKQEAgLTEs
MTAgKzEsMTQgQEAKIC8qKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioq
KioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqCi0gKiBDb3B5cmlnaHQgKGMpIDIw
MDAsIDIwMTEgSUJNIENvcnBvcmF0aW9uIGFuZCBvdGhlcnMuCisgKiBDb3B5cmlnaHQgKGMpIDIw
MDAsIDIwMTIgSUJNIENvcnBvcmF0aW9uIGFuZCBvdGhlcnMuCiAgKiBBbGwgcmlnaHRzIHJlc2Vy
dmVkLiBUaGlzIHByb2dyYW0gYW5kIHRoZSBhY2NvbXBhbnlpbmcgbWF0ZXJpYWxzCiAgKiBhcmUg
bWFkZSBhdmFpbGFibGUgdW5kZXIgdGhlIHRlcm1zIG9mIHRoZSBFY2xpcHNlIFB1YmxpYyBMaWNl
bnNlIHYxLjAKICAqIHdoaWNoIGFjY29tcGFuaWVzIHRoaXMgZGlzdHJpYnV0aW9uLCBhbmQgaXMg
YXZhaWxhYmxlIGF0CiAgKiBodHRwOi8vd3d3LmVjbGlwc2Uub3JnL2xlZ2FsL2VwbC12MTAuaHRt
bAogICoKKyAqIFRoaXMgaXMgYW4gaW1wbGVtZW50YXRpb24gb2YgYW4gZWFybHktZHJhZnQgc3Bl
Y2lmaWNhdGlvbiBkZXZlbG9wZWQgdW5kZXIgdGhlIEphdmEKKyAqIENvbW11bml0eSBQcm9jZXNz
IChKQ1ApIGFuZCBpcyBtYWRlIGF2YWlsYWJsZSBmb3IgdGVzdGluZyBhbmQgZXZhbHVhdGlvbiBw
dXJwb3NlcworICogb25seS4gVGhlIGNvZGUgaXMgbm90IGNvbXBhdGlibGUgd2l0aCBhbnkgc3Bl
Y2lmaWNhdGlvbiBvZiB0aGUgSkNQLgorICogCiAgKiBDb250cmlidXRvcnM6CiAgKiAgICAgSUJN
IENvcnBvcmF0aW9uIC0gaW5pdGlhbCBBUEkgYW5kIGltcGxlbWVudGF0aW9uCiAgKioqKioqKioq
KioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioq
KioqKioqKioqKioqKi8KQEAgLTU1MCw2ICs1NTQsNyBAQAogCXB1YmxpYyBmaW5hbCBQcmVmaXgg
RklSU1RfRU5VTV9DT05TVD0gbmV3IEZvcm1hdHRpbmdQcmVmaXgoImVudW0gRSB7IFg7fSIsICJ7
IFgiICwgQ29kZUZvcm1hdHRlci5LX0NPTVBJTEFUSU9OX1VOSVQpOyAvLyROT04tTkxTLTEkIC8v
JE5PTi1OTFMtMiQKIAlwdWJsaWMgZmluYWwgUHJlZml4IEFOTk9UQVRJT05fU0VQQVJBVElPTj0g
bmV3IEZvcm1hdHRpbmdQcmVmaXgoIkBBIEBCIGNsYXNzIEMge30iLCAiQSBAIiAsIENvZGVGb3Jt
YXR0ZXIuS19DT01QSUxBVElPTl9VTklUKTsgLy8kTk9OLU5MUy0xJCAvLyROT04tTkxTLTIkCiAJ
cHVibGljIGZpbmFsIFByZWZpeCBQQVJBTV9BTk5PVEFUSU9OX1NFUEFSQVRJT049IG5ldyBGb3Jt
YXR0aW5nUHJlZml4KCJ2b2lkIGZvbyhAQSBAQiBwKSB7IH0iLCAiQSBAIiAsIENvZGVGb3JtYXR0
ZXIuS19DTEFTU19CT0RZX0RFQ0xBUkFUSU9OUyk7IC8vJE5PTi1OTFMtMSQgLy8kTk9OLU5MUy0y
JAorCXB1YmxpYyBmaW5hbCBQcmVmaXggVkFSQVJHU19BTk5PVEFUSU9OX1NFUEFSQVRJT049IG5l
dyBGb3JtYXR0aW5nUHJlZml4KCJ2b2lkIGZvbyhwIEBBIEBCLi4uKSB7IH0iLCAiQSBAIiAsIENv
ZGVGb3JtYXR0ZXIuS19DTEFTU19CT0RZX0RFQ0xBUkFUSU9OUyk7IC8vJE5PTi1OTFMtMSQgLy8k
Tk9OLU5MUy0yJAogCXB1YmxpYyBmaW5hbCBQcmVmaXggVFJZX1JFU09VUkNFUyA9IG5ldyBGb3Jt
YXR0aW5nUHJlZml4KCJ0cnkgKEEgYSA9IG5ldyBBKCk7IEIgYiA9IG5ldyBCKCkpIHt9IiwgIjsg
QiIgLCBDb2RlRm9ybWF0dGVyLktfU1RBVEVNRU5UUyk7IC8vJE5PTi1OTFMtMSQgLy8kTk9OLU5M
Uy0yJAogCXB1YmxpYyBmaW5hbCBQcmVmaXggVFJZX1JFU09VUkNFU19QQVJFTiA9IG5ldyBGb3Jt
YXR0aW5nUHJlZml4KCJ0cnkgKEEgYSA9IG5ldyBBKCk7IEIgYiA9IG5ldyBCKCkpIHt9IiwgInkg
KCIgLCBDb2RlRm9ybWF0dGVyLktfU1RBVEVNRU5UUyk7IC8vJE5PTi1OTFMtMSQgLy8kTk9OLU5M
Uy0yJAogCQ==
</data>

          </attachment>
          <attachment
              isobsolete="1"
              ispatch="1"
              isprivate="0"
          >
            <attachid>226900</attachid>
            <date>2013-02-12 03:32:00 -0500</date>
            <delta_ts>2013-02-19 21:09:56 -0500</delta_ts>
            <desc>Proposed Patch</desc>
            <filename>Fix-for-Bug-395663-18ast-rewrite-Add-rewrite-support.patch</filename>
            <type>text/plain</type>
            <size>16339</size>
            <attacher name="Manoj Palat Away Until May 11 2015">manpalat</attacher>
            
              <data encoding="base64">ZGlmZiAtLWdpdCBhL29yZy5lY2xpcHNlLmpkdC5jb3JlLnRlc3RzLm1vZGVsL3NyYy9vcmcvZWNs
aXBzZS9qZHQvY29yZS90ZXN0cy9yZXdyaXRlL2Rlc2NyaWJpbmcvQVNUUmV3cml0aW5nTWV0aG9k
RGVjbFRlc3QuamF2YSBiL29yZy5lY2xpcHNlLmpkdC5jb3JlLnRlc3RzLm1vZGVsL3NyYy9vcmcv
ZWNsaXBzZS9qZHQvY29yZS90ZXN0cy9yZXdyaXRlL2Rlc2NyaWJpbmcvQVNUUmV3cml0aW5nTWV0
aG9kRGVjbFRlc3QuamF2YQppbmRleCAxMTM2NDJhLi5mNTUyNjUxIDEwMDY0NAotLS0gYS9vcmcu
ZWNsaXBzZS5qZHQuY29yZS50ZXN0cy5tb2RlbC9zcmMvb3JnL2VjbGlwc2UvamR0L2NvcmUvdGVz
dHMvcmV3cml0ZS9kZXNjcmliaW5nL0FTVFJld3JpdGluZ01ldGhvZERlY2xUZXN0LmphdmEKKysr
IGIvb3JnLmVjbGlwc2UuamR0LmNvcmUudGVzdHMubW9kZWwvc3JjL29yZy9lY2xpcHNlL2pkdC9j
b3JlL3Rlc3RzL3Jld3JpdGUvZGVzY3JpYmluZy9BU1RSZXdyaXRpbmdNZXRob2REZWNsVGVzdC5q
YXZhCkBAIC0yODgyLDUgKzI4ODIsMTU2IEBACiAJCWFzc2VydEVxdWFsU3RyaW5nKHByZXZpZXcs
IGJ1Zi50b1N0cmluZygpKTsKIAl9CiAKKwlwdWJsaWMgdm9pZCB0ZXN0VmFyQXJnc0Fubm90YXRp
b25zKCkgdGhyb3dzIEV4Y2VwdGlvbiB7CisJCUlQYWNrYWdlRnJhZ21lbnQgcGFjazE9IHRoaXMu
c291cmNlRm9sZGVyLmNyZWF0ZVBhY2thZ2VGcmFnbWVudCgidGVzdDEiLCBmYWxzZSwgbnVsbCk7
CisJCVN0cmluZ0J1ZmZlciBidWY9IG5ldyBTdHJpbmdCdWZmZXIoKTsKKwkJYnVmLmFwcGVuZCgi
cGFja2FnZSB0ZXN0MTtcbiIpOworCQlidWYuYXBwZW5kKCJAaW50ZXJmYWNlIE1hcmtlciB7XG4i
KTsKKwkJYnVmLmFwcGVuZCgifVxuIik7CisJCWJ1Zi5hcHBlbmQoInB1YmxpYyBjbGFzcyBERCB7
XG4iKTsKKwkJYnVmLmFwcGVuZCgiICAgIHB1YmxpYyB2b2lkIGZvbzEoU3RyaW5nIGZvcm1hdCwg
T2JqZWN0IEBNYXJrZXIuLi4gYXJncyl7XG4iKTsKKwkJYnVmLmFwcGVuZCgiICAgIH1cbiIpOwor
CQlidWYuYXBwZW5kKCIgICAgcHVibGljIHZvaWQgZm9vMihPYmplY3QgLi4uIGFyZ3MpIHtcbiIp
OworCQlidWYuYXBwZW5kKCIgICAgfVxuIik7CisJCWJ1Zi5hcHBlbmQoIiAgICBwdWJsaWMgdm9p
ZCBmb28zKE9iamVjdCBATWFya2VyIC4uLiBhcmdzKSB7XG4iKTsKKwkJYnVmLmFwcGVuZCgiICAg
IH1cbiIpOworCQlidWYuYXBwZW5kKCIgICAgcHVibGljIHZvaWQgZm9vNChPYmplY3QgQE1hcmtl
ci4uLiBhcmdzKSB7XG4iKTsgCisJCWJ1Zi5hcHBlbmQoIiAgICB9XG4iKTsKKwkJYnVmLmFwcGVu
ZCgiICAgIHB1YmxpYyB2b2lkIGZvbzUoT2JqZWN0IC4uLiBhcmdzKSB7XG4iKTsgCisJCWJ1Zi5h
cHBlbmQoIiAgICB9XG4iKTsKKwkJYnVmLmFwcGVuZCgiICAgIHB1YmxpYyB2b2lkIGZvbzYoT2Jq
ZWN0IGFyZ3MpIHtcbiIpOworCQlidWYuYXBwZW5kKCIgICAgfVxuIik7CisJCWJ1Zi5hcHBlbmQo
IiAgICBwdWJsaWMgdm9pZCBmb283KE9iamVjdCBATWFya2VyIC4uLiBhcmdzKSB7XG4iKTsKKwkJ
YnVmLmFwcGVuZCgiICAgIH1cbiIpOwkJCisJCWJ1Zi5hcHBlbmQoIiAgICBwdWJsaWMgdm9pZCBm
b284KE9iamVjdCBATWFya2VyIC4uLiBhcmdzKSB7XG4iKTsKKwkJYnVmLmFwcGVuZCgiICAgIH1c
biIpOwkJCisJCWJ1Zi5hcHBlbmQoIiAgICBwdWJsaWMgdm9pZCBmb285KEBCIEBDIGludCBAQS4u
LiBhKSB7XG4iKTsKKwkJYnVmLmFwcGVuZCgiICAgIH1cbiIpOworCQlidWYuYXBwZW5kKCIgICAg
cHVibGljIHZvaWQgZm9vMTAoT2JqZWN0IGFyZ3MpIHtcbiIpOworCQlidWYuYXBwZW5kKCIgICAg
fVxuIik7CisJCWJ1Zi5hcHBlbmQoIiAgICBwdWJsaWMgdm9pZCBmb28xMShPYmplY3QgQE1hcmtl
ciAuLi4gYXJncykge1xuIik7CisJCWJ1Zi5hcHBlbmQoIiAgICB9XG4iKTsKKwkJYnVmLmFwcGVu
ZCgiICAgIHB1YmxpYyB2b2lkIGZvbzEyKE9iamVjdC4uLiBhcmdzKSB7XG4iKTsKKwkJYnVmLmFw
cGVuZCgiICAgIH1cbiIpOworCQlidWYuYXBwZW5kKCJ9XG4iKTsKKwkJSUNvbXBpbGF0aW9uVW5p
dCBjdT0gcGFjazEuY3JlYXRlQ29tcGlsYXRpb25Vbml0KCJERC5qYXZhIiwgYnVmLnRvU3RyaW5n
KCksIGZhbHNlLCBudWxsKTsKKwkJCisJCUNvbXBpbGF0aW9uVW5pdCBhc3RSb290PSBjcmVhdGVB
U1QoQVNULkpMUzgsIGN1LCBmYWxzZSk7CisJCUFTVCBhc3Q9IGFzdFJvb3QuZ2V0QVNUKCk7CisJ
CUFTVFJld3JpdGUgcmV3cml0ZT0gQVNUUmV3cml0ZS5jcmVhdGUoYXN0Um9vdC5nZXRBU1QoKSk7
CisJCVR5cGVEZWNsYXJhdGlvbiB0eXBlPSBmaW5kVHlwZURlY2xhcmF0aW9uKGFzdFJvb3QsICJE
RCIpOworCQkKKwkJeworCQkJLy8gUmVtb3ZlIGFubm90YXRpb24gZnJvbSBmaXJzdCBtZXRob2Qg
YXJncyAtIGJvdW5kYXJ5IGNvbmRpdGlvbiAtCisJCQkvLyAtIG9ubHkgb25lIGFubm90YXRpb24g
c2hvdWxkIGJlIHByZXNlbnQuCisJCQlNZXRob2REZWNsYXJhdGlvbiBtZXRob2REZWNsPSBmaW5k
TWV0aG9kRGVjbGFyYXRpb24odHlwZSwgImZvbzEiKTsKKwkJCVNpbmdsZVZhcmlhYmxlRGVjbGFy
YXRpb24gcGFyYW0gPSAoU2luZ2xlVmFyaWFibGVEZWNsYXJhdGlvbikgbWV0aG9kRGVjbC5wYXJh
bWV0ZXJzKCkuZ2V0KDEpOworCQkJcmV3cml0ZS5yZW1vdmUoKEFTVE5vZGUpcGFyYW0udmFyYXJn
c0Fubm90YXRpb25zKCkuZ2V0KDApLCBudWxsKTsKKwkJCQorCQkJLy8gQWRkIG9uZSBhbm5vdGF0
aW9uIHRvIHRoZSBzZWNvbmQgbWV0aG9kIC0gYm91bmRhcnkgY29uZGl0aW9uIAorCQkJLy8gLSBu
byBhbm5vdGF0aW9uIHNob3VsZCBiZSBwcmVzZW50CisJCQltZXRob2REZWNsPSBmaW5kTWV0aG9k
RGVjbGFyYXRpb24odHlwZSwgImZvbzIiKTsKKwkJCXBhcmFtID0gKFNpbmdsZVZhcmlhYmxlRGVj
bGFyYXRpb24pIG1ldGhvZERlY2wucGFyYW1ldGVycygpLmdldCgwKTsKKwkJCU1hcmtlckFubm90
YXRpb24gbWFya2VyQW5ub3RhdGlvbj0gYXN0Lm5ld01hcmtlckFubm90YXRpb24oKTsKKwkJCW1h
cmtlckFubm90YXRpb24uc2V0VHlwZU5hbWUoYXN0Lm5ld1NpbXBsZU5hbWUoIlgiKSk7CisJCQlM
aXN0UmV3cml0ZSBsaXN0UmV3cml0ZT0gcmV3cml0ZS5nZXRMaXN0UmV3cml0ZShwYXJhbSwgU2lu
Z2xlVmFyaWFibGVEZWNsYXJhdGlvbi5WQVJBUkdTX0FOTk9UQVRJT05TX1BST1BFUlRZKTsKKwkJ
CWxpc3RSZXdyaXRlLmluc2VydEZpcnN0KG1hcmtlckFubm90YXRpb24sIG51bGwpOworCQkJCisJ
CQkvLyBSZW1vdmUgdGhlIHZhcmFyZ3MgcHJvcGVydHkgLSBhbm5vdGF0aW9uKHMpIHNob3VsZCBk
aXNhcHBlYXIKKwkJCW1ldGhvZERlY2w9IGZpbmRNZXRob2REZWNsYXJhdGlvbih0eXBlLCAiZm9v
MyIpOworCQkJcGFyYW0gPSAoU2luZ2xlVmFyaWFibGVEZWNsYXJhdGlvbikgbWV0aG9kRGVjbC5w
YXJhbWV0ZXJzKCkuZ2V0KDApOworCQkJcmV3cml0ZS5zZXQocGFyYW0sIFNpbmdsZVZhcmlhYmxl
RGVjbGFyYXRpb24uVkFSQVJHU19QUk9QRVJUWSwgQm9vbGVhbi5GQUxTRSwgbnVsbCk7CisJCQkK
KwkJCS8vIFJlbW92ZSB0aGUgdmFyYXJncyBwcm9wZXJ0eSAtIGFubm90YXRpb24ocykgc2hvdWxk
IGRpc2FwcGVhcgorCQkJLy8gLSBkaWZmZXJzIGZyb20gdGhlIGFib3ZlIGR1ZSB0byB0aGUgYWJz
ZW5jZSBvZiBhIGJsYW5rIGJlZm9yZSAuLi4KKwkJCW1ldGhvZERlY2w9IGZpbmRNZXRob2REZWNs
YXJhdGlvbih0eXBlLCAiZm9vNCIpOworCQkJcGFyYW0gPSAoU2luZ2xlVmFyaWFibGVEZWNsYXJh
dGlvbikgbWV0aG9kRGVjbC5wYXJhbWV0ZXJzKCkuZ2V0KDApOworCQkJcmV3cml0ZS5zZXQocGFy
YW0sIFNpbmdsZVZhcmlhYmxlRGVjbGFyYXRpb24uVkFSQVJHU19QUk9QRVJUWSwgQm9vbGVhbi5G
QUxTRSwgbnVsbCk7CisJCQkKKwkJCS8vIFJlbW92ZSB0aGUgdmFyYXJncyBwcm9wZXJ0eSAtIEV4
aXN0aW5nIGZ1bmN0aW9uYWxpdHkgdW5jaGFuZ2VkIHdpdGhvdXQgYW5ub3RhdGlvbnMKKwkJCW1l
dGhvZERlY2w9IGZpbmRNZXRob2REZWNsYXJhdGlvbih0eXBlLCAiZm9vNSIpOworCQkJcGFyYW0g
PSAoU2luZ2xlVmFyaWFibGVEZWNsYXJhdGlvbikgbWV0aG9kRGVjbC5wYXJhbWV0ZXJzKCkuZ2V0
KDApOworCQkJcmV3cml0ZS5zZXQocGFyYW0sIFNpbmdsZVZhcmlhYmxlRGVjbGFyYXRpb24uVkFS
QVJHU19QUk9QRVJUWSwgQm9vbGVhbi5GQUxTRSwgbnVsbCk7CisJCQkKKwkJCS8vIEFkZCB0aGUg
dmFyYXJncyBwcm9wZXJ0eSAgYW5kIGFubm90YXRpb24KKwkJCW1ldGhvZERlY2w9IGZpbmRNZXRo
b2REZWNsYXJhdGlvbih0eXBlLCAiZm9vNiIpOworCQkJcGFyYW0gPSAoU2luZ2xlVmFyaWFibGVE
ZWNsYXJhdGlvbikgbWV0aG9kRGVjbC5wYXJhbWV0ZXJzKCkuZ2V0KDApOworCQkJcmV3cml0ZS5z
ZXQocGFyYW0sIFNpbmdsZVZhcmlhYmxlRGVjbGFyYXRpb24uVkFSQVJHU19QUk9QRVJUWSwgQm9v
bGVhbi5UUlVFLCBudWxsKTsKKwkJCW1hcmtlckFubm90YXRpb249IGFzdC5uZXdNYXJrZXJBbm5v
dGF0aW9uKCk7CisJCQltYXJrZXJBbm5vdGF0aW9uLnNldFR5cGVOYW1lKGFzdC5uZXdTaW1wbGVO
YW1lKCJYIikpOworCQkJbGlzdFJld3JpdGU9IHJld3JpdGUuZ2V0TGlzdFJld3JpdGUocGFyYW0s
IFNpbmdsZVZhcmlhYmxlRGVjbGFyYXRpb24uVkFSQVJHU19BTk5PVEFUSU9OU19QUk9QRVJUWSk7
CisJCQlsaXN0UmV3cml0ZS5pbnNlcnRGaXJzdChtYXJrZXJBbm5vdGF0aW9uLCBudWxsKTsKKwkJ
CQorCQkJLy8gUmVwbGFjZSBhbm5vdGF0aW9uCisJCQltZXRob2REZWNsPSBmaW5kTWV0aG9kRGVj
bGFyYXRpb24odHlwZSwgImZvbzciKTsKKwkJCXBhcmFtID0gKFNpbmdsZVZhcmlhYmxlRGVjbGFy
YXRpb24pIG1ldGhvZERlY2wucGFyYW1ldGVycygpLmdldCgwKTsKKwkJCW1hcmtlckFubm90YXRp
b249IGFzdC5uZXdNYXJrZXJBbm5vdGF0aW9uKCk7CisJCQltYXJrZXJBbm5vdGF0aW9uLnNldFR5
cGVOYW1lKGFzdC5uZXdTaW1wbGVOYW1lKCJYIikpOworCQkJcmV3cml0ZS5yZXBsYWNlKChBU1RO
b2RlKXBhcmFtLnZhcmFyZ3NBbm5vdGF0aW9ucygpLmdldCgwKSwgbWFya2VyQW5ub3RhdGlvbiwg
bnVsbCk7CisJCQkKKwkJCS8vIFJlc2V0IGFuZCBTZXQgVmFyYXJncyAtIG91dHB1dCBzaG91bGQg
bm90IGNoYW5nZS4KKwkJCW1ldGhvZERlY2w9IGZpbmRNZXRob2REZWNsYXJhdGlvbih0eXBlLCAi
Zm9vOCIpOworCQkJcGFyYW0gPSAoU2luZ2xlVmFyaWFibGVEZWNsYXJhdGlvbikgbWV0aG9kRGVj
bC5wYXJhbWV0ZXJzKCkuZ2V0KDApOworCQkJcmV3cml0ZS5zZXQocGFyYW0sIFNpbmdsZVZhcmlh
YmxlRGVjbGFyYXRpb24uVkFSQVJHU19QUk9QRVJUWSwgQm9vbGVhbi5GQUxTRSwgbnVsbCk7CisJ
CQlyZXdyaXRlLnNldChwYXJhbSwgU2luZ2xlVmFyaWFibGVEZWNsYXJhdGlvbi5WQVJBUkdTX1BS
T1BFUlRZLCBCb29sZWFuLlRSVUUsIG51bGwpOworCQkJCisJCQkvLyBBZGQgbXVsdGlwbGUgKHR3
bykgYW5ub3RhdGlvbnMsIHJlbW92ZSBhbiBleGlzdGluZyBhbm5vdGF0aW9uCisJCQltZXRob2RE
ZWNsPSBmaW5kTWV0aG9kRGVjbGFyYXRpb24odHlwZSwgImZvbzkiKTsKKwkJCXBhcmFtID0gKFNp
bmdsZVZhcmlhYmxlRGVjbGFyYXRpb24pIG1ldGhvZERlY2wucGFyYW1ldGVycygpLmdldCgwKTsK
KwkJCW1hcmtlckFubm90YXRpb249IGFzdC5uZXdNYXJrZXJBbm5vdGF0aW9uKCk7CisJCQltYXJr
ZXJBbm5vdGF0aW9uLnNldFR5cGVOYW1lKGFzdC5uZXdTaW1wbGVOYW1lKCJYIikpOworCQkJbGlz
dFJld3JpdGU9IHJld3JpdGUuZ2V0TGlzdFJld3JpdGUocGFyYW0sIFNpbmdsZVZhcmlhYmxlRGVj
bGFyYXRpb24uVkFSQVJHU19BTk5PVEFUSU9OU19QUk9QRVJUWSk7CisJCQlsaXN0UmV3cml0ZS5p
bnNlcnRGaXJzdChtYXJrZXJBbm5vdGF0aW9uLCBudWxsKTsKKwkJCW1hcmtlckFubm90YXRpb249
IGFzdC5uZXdNYXJrZXJBbm5vdGF0aW9uKCk7CisJCQltYXJrZXJBbm5vdGF0aW9uLnNldFR5cGVO
YW1lKGFzdC5uZXdTaW1wbGVOYW1lKCJZIikpOworCQkJbGlzdFJld3JpdGUuaW5zZXJ0Rmlyc3Qo
bWFya2VyQW5ub3RhdGlvbiwgbnVsbCk7CisJCQlyZXdyaXRlLnJlbW92ZSgoQVNUTm9kZSlwYXJh
bS52YXJhcmdzQW5ub3RhdGlvbnMoKS5nZXQoMCksIG51bGwpOworCQkJCisJCQkvLyBBZGQgdGhl
IHZhcmFyZ3MgcHJvcGVydHkKKwkJCW1ldGhvZERlY2w9IGZpbmRNZXRob2REZWNsYXJhdGlvbih0
eXBlLCAiZm9vMTAiKTsKKwkJCXBhcmFtID0gKFNpbmdsZVZhcmlhYmxlRGVjbGFyYXRpb24pIG1l
dGhvZERlY2wucGFyYW1ldGVycygpLmdldCgwKTsKKwkJCXJld3JpdGUuc2V0KHBhcmFtLCBTaW5n
bGVWYXJpYWJsZURlY2xhcmF0aW9uLlZBUkFSR1NfUFJPUEVSVFksIEJvb2xlYW4uVFJVRSwgbnVs
bCk7CisJCQkKKwkJCS8vIFJlbW92ZSB0aGUgYW5ub3RhdGlvbnMgYW5kIHZhcmFyZ3MgcHJvcGVy
dHkgYXMgd2VsbC4KKwkJCW1ldGhvZERlY2w9IGZpbmRNZXRob2REZWNsYXJhdGlvbih0eXBlLCAi
Zm9vMTEiKTsKKwkJCXBhcmFtID0gKFNpbmdsZVZhcmlhYmxlRGVjbGFyYXRpb24pIG1ldGhvZERl
Y2wucGFyYW1ldGVycygpLmdldCgwKTsKKwkJCXJld3JpdGUucmVtb3ZlKChBU1ROb2RlKXBhcmFt
LnZhcmFyZ3NBbm5vdGF0aW9ucygpLmdldCgwKSwgbnVsbCk7CisJCQlyZXdyaXRlLnNldChwYXJh
bSwgU2luZ2xlVmFyaWFibGVEZWNsYXJhdGlvbi5WQVJBUkdTX1BST1BFUlRZLCBCb29sZWFuLkZB
TFNFLCBudWxsKTsKKwkJCQorCQl9CisJCVN0cmluZyBwcmV2aWV3PSBldmFsdWF0ZVJld3JpdGUo
Y3UsIHJld3JpdGUpOworCQkKKwkJYnVmPSBuZXcgU3RyaW5nQnVmZmVyKCk7CisJCWJ1Zi5hcHBl
bmQoInBhY2thZ2UgdGVzdDE7XG4iKTsKKwkJYnVmLmFwcGVuZCgiQGludGVyZmFjZSBNYXJrZXIg
e1xuIik7CisJCWJ1Zi5hcHBlbmQoIn1cbiIpOworCQlidWYuYXBwZW5kKCJwdWJsaWMgY2xhc3Mg
REQge1xuIik7CisJCWJ1Zi5hcHBlbmQoIiAgICBwdWJsaWMgdm9pZCBmb28xKFN0cmluZyBmb3Jt
YXQsIE9iamVjdCAuLi4gYXJncyl7XG4iKTsKKwkJYnVmLmFwcGVuZCgiICAgIH1cbiIpOworCQli
dWYuYXBwZW5kKCIgICAgcHVibGljIHZvaWQgZm9vMihPYmplY3QgQFggLi4uIGFyZ3MpIHtcbiIp
OworCQlidWYuYXBwZW5kKCIgICAgfVxuIik7CisJCWJ1Zi5hcHBlbmQoIiAgICBwdWJsaWMgdm9p
ZCBmb28zKE9iamVjdCBhcmdzKSB7XG4iKTsKKwkJYnVmLmFwcGVuZCgiICAgIH1cbiIpOworCQli
dWYuYXBwZW5kKCIgICAgcHVibGljIHZvaWQgZm9vNChPYmplY3QgYXJncykge1xuIik7CisJCWJ1
Zi5hcHBlbmQoIiAgICB9XG4iKTsKKwkJYnVmLmFwcGVuZCgiICAgIHB1YmxpYyB2b2lkIGZvbzUo
T2JqZWN0IGFyZ3MpIHtcbiIpOworCQlidWYuYXBwZW5kKCIgICAgfVxuIik7CisJCWJ1Zi5hcHBl
bmQoIiAgICBwdWJsaWMgdm9pZCBmb282KE9iamVjdCBAWCAuLi5hcmdzKSB7XG4iKTsKKwkJYnVm
LmFwcGVuZCgiICAgIH1cbiIpOworCQlidWYuYXBwZW5kKCIgICAgcHVibGljIHZvaWQgZm9vNyhP
YmplY3QgQFggLi4uIGFyZ3MpIHtcbiIpOworCQlidWYuYXBwZW5kKCIgICAgfVxuIik7CQkKKwkJ
YnVmLmFwcGVuZCgiICAgIHB1YmxpYyB2b2lkIGZvbzgoT2JqZWN0IEBNYXJrZXIgLi4uIGFyZ3Mp
IHtcbiIpOworCQlidWYuYXBwZW5kKCIgICAgfVxuIik7CQkKKwkJYnVmLmFwcGVuZCgiICAgIHB1
YmxpYyB2b2lkIGZvbzkoQEIgQEMgaW50IEBZIEBYIC4uLiBhKSB7XG4iKTsKKwkJYnVmLmFwcGVu
ZCgiICAgIH1cbiIpOworCQlidWYuYXBwZW5kKCIgICAgcHVibGljIHZvaWQgZm9vMTAoT2JqZWN0
Li4uIGFyZ3MpIHtcbiIpOworCQlidWYuYXBwZW5kKCIgICAgfVxuIik7CisJCWJ1Zi5hcHBlbmQo
IiAgICBwdWJsaWMgdm9pZCBmb28xMShPYmplY3QgYXJncykge1xuIik7CisJCWJ1Zi5hcHBlbmQo
IiAgICB9XG4iKTsKKwkJYnVmLmFwcGVuZCgiICAgIHB1YmxpYyB2b2lkIGZvbzEyKE9iamVjdC4u
LiBhcmdzKSB7XG4iKTsKKwkJYnVmLmFwcGVuZCgiICAgIH1cbiIpOworCQlidWYuYXBwZW5kKCJ9
XG4iKTsKKwkJYXNzZXJ0RXF1YWxTdHJpbmcocHJldmlldywgYnVmLnRvU3RyaW5nKCkpOwkKKwl9
CiAKIH0KZGlmZiAtLWdpdCBhL29yZy5lY2xpcHNlLmpkdC5jb3JlL2RvbS9vcmcvZWNsaXBzZS9q
ZHQvaW50ZXJuYWwvY29yZS9kb20vcmV3cml0ZS9BU1RSZXdyaXRlQW5hbHl6ZXIuamF2YSBiL29y
Zy5lY2xpcHNlLmpkdC5jb3JlL2RvbS9vcmcvZWNsaXBzZS9qZHQvaW50ZXJuYWwvY29yZS9kb20v
cmV3cml0ZS9BU1RSZXdyaXRlQW5hbHl6ZXIuamF2YQppbmRleCA4OTJjMDY4Li4zYjYxZGIzIDEw
MDY0NAotLS0gYS9vcmcuZWNsaXBzZS5qZHQuY29yZS9kb20vb3JnL2VjbGlwc2UvamR0L2ludGVy
bmFsL2NvcmUvZG9tL3Jld3JpdGUvQVNUUmV3cml0ZUFuYWx5emVyLmphdmEKKysrIGIvb3JnLmVj
bGlwc2UuamR0LmNvcmUvZG9tL29yZy9lY2xpcHNlL2pkdC9pbnRlcm5hbC9jb3JlL2RvbS9yZXdy
aXRlL0FTVFJld3JpdGVBbmFseXplci5qYXZhCkBAIC0xNTYzLDYgKzE1NjMsNTEgQEAKIAkJcmV0
dXJuIGVuZFBvczsKIAl9CiAKKwlwcml2YXRlIGludCByZXdyaXRlVmFyYXJnc0Fubm90YXRpb25z
KEFTVE5vZGUgbm9kZSwgQ2hpbGRMaXN0UHJvcGVydHlEZXNjcmlwdG9yIHByb3BlcnR5LCBpbnQg
cG9zKSB7CisJCWlmIChub2RlLmdldEFTVCgpLmFwaUxldmVsKCkgPCBBU1QuSkxTOCkgeworCQkJ
cmV0dXJuIHBvczsKKwkJfQorCQlSZXdyaXRlRXZlbnQgZXZlbnQ9IGdldEV2ZW50KG5vZGUsIHBy
b3BlcnR5KTsJCQorCQlpZiAoZXZlbnQgPT0gbnVsbCB8fCBldmVudC5nZXRDaGFuZ2VLaW5kKCkg
PT0gUmV3cml0ZUV2ZW50LlVOQ0hBTkdFRCkgeworCQkJcmV0dXJuIGRvVmlzaXQobm9kZSwgcHJv
cGVydHksIHBvcyk7CisJCX0KKwkJUmV3cml0ZUV2ZW50W10gY2hpbGRyZW49IGV2ZW50LmdldENo
aWxkcmVuKCk7CisJCWJvb2xlYW4gaXNBbGxJbnNlcnQ9IGlzQWxsT2ZLaW5kKGNoaWxkcmVuLCBS
ZXdyaXRlRXZlbnQuSU5TRVJURUQpOworCQlib29sZWFuIGlzQWxsUmVtb3ZlPSBpc0FsbE9mS2lu
ZChjaGlsZHJlbiwgUmV3cml0ZUV2ZW50LlJFTU9WRUQpOworCQlpZiAoaXNBbGxJbnNlcnQgfHwg
aXNBbGxSZW1vdmUpIHsKKwkJCS8vIHVwZGF0ZSBwb3MKKwkJCXRyeSB7CisJCQkJcG9zPSBnZXRT
Y2FubmVyKCkuZ2V0TmV4dFN0YXJ0T2Zmc2V0KHBvcywgZmFsc2UpOworCQkJfSBjYXRjaCAoQ29y
ZUV4Y2VwdGlvbiBlKSB7CisJCQkJaGFuZGxlRXhjZXB0aW9uKGUpOworCQkJfQorCQl9CisJCQor
CQlQcmVmaXggZm9ybWF0dGVyUHJlZml4OworCQlmb3JtYXR0ZXJQcmVmaXg9IHRoaXMuZm9ybWF0
dGVyLlZBUkFSR1NfQU5OT1RBVElPTl9TRVBBUkFUSU9OOworCQlpbnQgZW5kUG9zPSBuZXcgTW9k
aWZpZXJSZXdyaXRlcihmb3JtYXR0ZXJQcmVmaXgpLnJld3JpdGVMaXN0KG5vZGUsIHByb3BlcnR5
LCBwb3MsIFV0aWwuRU1QVFlfU1RSSU5HLCAiICIpOyAvLyROT04tTkxTLTEkIAorCQl0cnkgewor
CQkJaW50IG5leHRQb3M9IGdldFNjYW5uZXIoKS5nZXROZXh0U3RhcnRPZmZzZXQoZW5kUG9zLCBm
YWxzZSk7CisJCQkKKwkJCWJvb2xlYW4gbGFzdFVuY2hhbmdlZD0gY2hpbGRyZW5bY2hpbGRyZW4u
bGVuZ3RoIC0gMV0uZ2V0Q2hhbmdlS2luZCgpICE9IFJld3JpdGVFdmVudC5VTkNIQU5HRUQ7CisJ
CQlpZiAoaXNBbGxSZW1vdmUpIHsKKwkJCWRvVGV4dFJlbW92ZShlbmRQb3MsIG5leHRQb3MgLSBl
bmRQb3MsIGdldEVkaXRHcm91cChjaGlsZHJlbltjaGlsZHJlbi5sZW5ndGggLSAxXSkpOworCQkJ
CXJldHVybiBuZXh0UG9zOworCQkJfSBlbHNlIGlmIChpc0FsbEluc2VydCB8fCAobmV4dFBvcyA9
PSBlbmRQb3MgJiYgbGFzdFVuY2hhbmdlZCkpIHsgLy8gc2VlIGJ1ZyAxNjU2NTQKKwkJCQlSZXdy
aXRlRXZlbnQgbGFzdENoaWxkPSBjaGlsZHJlbltjaGlsZHJlbi5sZW5ndGggLSAxXTsKKwkJCQlT
dHJpbmcgc2VwYXJhdG9yOworCQkJCWlmIChsYXN0Q2hpbGQuZ2V0TmV3VmFsdWUoKSBpbnN0YW5j
ZW9mIEFubm90YXRpb24pIHsKKwkJCQkJc2VwYXJhdG9yPSBmb3JtYXR0ZXJQcmVmaXguZ2V0UHJl
Zml4KGdldEluZGVudChwb3MpKTsKKwkJCQl9IGVsc2UgeworCQkJCQlzZXBhcmF0b3I9IFN0cmlu
Zy52YWx1ZU9mKCcgJyk7CisJCQkJfQorCQkJCWRvVGV4dEluc2VydChlbmRQb3MsIHNlcGFyYXRv
ciwgZ2V0RWRpdEdyb3VwKGxhc3RDaGlsZCkpOworCQkJfQorCQl9IGNhdGNoIChDb3JlRXhjZXB0
aW9uIGUpIHsKKwkJCWhhbmRsZUV4Y2VwdGlvbihlKTsKKwkJfQorCQlyZXR1cm4gZW5kUG9zOwor
CX0KIAogCXByaXZhdGUgdm9pZCByZXBsYWNlT3BlcmF0aW9uKGludCBwb3NCZWZvcmVPcGVyYXRp
b24sIFN0cmluZyBuZXdPcGVyYXRpb24sIFRleHRFZGl0R3JvdXAgZWRpdEdyb3VwKSB7CiAJCXRy
eSB7CkBAIC0yODM4LDIzICsyODgzLDM3IEBACiAJCQlyZXR1cm4gZG9WaXNpdFVuY2hhbmdlZENo
aWxkcmVuKG5vZGUpOwogCQl9CiAJCWludCBwb3M9IG5vZGUuZ2V0U3RhcnRQb3NpdGlvbigpOwot
CQlpZiAobm9kZS5nZXRBU1QoKS5hcGlMZXZlbCgpID09IEpMUzJfSU5URVJOQUwpIHsKKwkJaW50
IGFwaUxldmVsID0gbm9kZS5nZXRBU1QoKS5hcGlMZXZlbCgpOworCQlpZiAoYXBpTGV2ZWwgPT0g
SkxTMl9JTlRFUk5BTCkgewogCQkJcmV3cml0ZU1vZGlmaWVycyhub2RlLCBTaW5nbGVWYXJpYWJs
ZURlY2xhcmF0aW9uLk1PRElGSUVSU19QUk9QRVJUWSwgcG9zKTsKIAkJfSBlbHNlIHsKIAkJCXJl
d3JpdGVNb2RpZmllcnMyKG5vZGUsIFNpbmdsZVZhcmlhYmxlRGVjbGFyYXRpb24uTU9ESUZJRVJT
Ml9QUk9QRVJUWSwgcG9zKTsKIAkJfQogCQlwb3M9IHJld3JpdGVSZXF1aXJlZE5vZGUobm9kZSwg
U2luZ2xlVmFyaWFibGVEZWNsYXJhdGlvbi5UWVBFX1BST1BFUlRZKTsKLQkJaWYgKG5vZGUuZ2V0
QVNUKCkuYXBpTGV2ZWwoKSA+PSBKTFMzX0lOVEVSTkFMKSB7CisJCWlmIChhcGlMZXZlbCA+PSBK
TFMzX0lOVEVSTkFMKSB7CiAJCQlpZiAoaXNDaGFuZ2VkKG5vZGUsIFNpbmdsZVZhcmlhYmxlRGVj
bGFyYXRpb24uVkFSQVJHU19QUk9QRVJUWSkpIHsKIAkJCQlpZiAoZ2V0TmV3VmFsdWUobm9kZSwg
U2luZ2xlVmFyaWFibGVEZWNsYXJhdGlvbi5WQVJBUkdTX1BST1BFUlRZKS5lcXVhbHMoQm9vbGVh
bi5UUlVFKSkgeworCQkJCQlwb3MgPSBhcGlMZXZlbCA+PSBBU1QuSkxTOCA/IHJld3JpdGVWYXJh
cmdzQW5ub3RhdGlvbnMobm9kZSwgU2luZ2xlVmFyaWFibGVEZWNsYXJhdGlvbi5WQVJBUkdTX0FO
Tk9UQVRJT05TX1BST1BFUlRZLCBwb3MpIDogcG9zOwogCQkJCQlkb1RleHRJbnNlcnQocG9zLCAi
Li4uIiwgZ2V0RWRpdEdyb3VwKG5vZGUsIFNpbmdsZVZhcmlhYmxlRGVjbGFyYXRpb24uVkFSQVJH
U19QUk9QRVJUWSkpOyAvLyROT04tTkxTLTEkCiAJCQkJfSBlbHNlIHsKIAkJCQkJdHJ5IHsKIAkJ
CQkJCWludCBlbGxpcHNpc0VuZD0gZ2V0U2Nhbm5lcigpLmdldE5leHRFbmRPZmZzZXQocG9zLCB0
cnVlKTsKKwkJCQkJCWlmIChhcGlMZXZlbCA+PSBBU1QuSkxTOCAmJiBub2RlLnZhcmFyZ3NBbm5v
dGF0aW9ucygpLnNpemUoKSA+IDAgKSB7CisJCQkJCQkJaW50IGFubm90YXRpb25TdGFydFBvc2l0
aW9uID0gbm9kZS5nZXRUeXBlKCkuZ2V0U3RhcnRQb3NpdGlvbigpICsgbm9kZS5nZXRUeXBlKCku
Z2V0TGVuZ3RoKCk7CisJCQkJCQkJaW50IGFubm90YXRpb25FbmRQb3NpdGlvbiA9IGFubm90YXRp
b25TdGFydFBvc2l0aW9uICsgbm9kZS52YXJhcmdzQW5ub3RhdGlvbnMoKS50b1N0cmluZygpLmxl
bmd0aCgpIC0gMTsKKwkJCQkJCQllbGxpcHNpc0VuZCA9IGdldFNjYW5uZXIoKS5nZXROZXh0RW5k
T2Zmc2V0KGFubm90YXRpb25FbmRQb3NpdGlvbiwgdHJ1ZSk7CisJCQkJCQl9IGVsc2UgeworCQkJ
CQkJCWVsbGlwc2lzRW5kPSBnZXRTY2FubmVyKCkuZ2V0TmV4dEVuZE9mZnNldChwb3MsIHRydWUp
OworCQkJCQkJfQogCQkJCQkJZG9UZXh0UmVtb3ZlKHBvcywgZWxsaXBzaXNFbmQgLSBwb3MsIGdl
dEVkaXRHcm91cChub2RlLCBTaW5nbGVWYXJpYWJsZURlY2xhcmF0aW9uLlZBUkFSR1NfUFJPUEVS
VFkpKTsKIAkJCQkJfSBjYXRjaCAoQ29yZUV4Y2VwdGlvbiBlKSB7CiAJCQkJCQloYW5kbGVFeGNl
cHRpb24oZSk7CiAJCQkJCX0KKwkJCQl9CisJCQl9IGVsc2UgeworCQkJCWlmIChhcGlMZXZlbCA+
PSBBU1QuSkxTOCAmJiBub2RlLmlzVmFyYXJncygpKSB7CisJCQkJCWludCBhbm5vdGF0aW9uU3Rh
cnRQb3NpdGlvbiA9IG5vZGUuZ2V0VHlwZSgpLmdldFN0YXJ0UG9zaXRpb24oKSArIG5vZGUuZ2V0
VHlwZSgpLmdldExlbmd0aCgpOworCQkJCQlwb3MgPSByZXdyaXRlVmFyYXJnc0Fubm90YXRpb25z
KG5vZGUsIFNpbmdsZVZhcmlhYmxlRGVjbGFyYXRpb24uVkFSQVJHU19BTk5PVEFUSU9OU19QUk9Q
RVJUWSwgYW5ub3RhdGlvblN0YXJ0UG9zaXRpb24pOwogCQkJCX0KIAkJCX0KIAkJCWlmICghbm9k
ZS5pc1ZhcmFyZ3MoKSkgewpAQCAtMjg2NSw3ICsyOTI0LDggQEAKIAkJfQogCiAJCXBvcz0gcmV3
cml0ZVJlcXVpcmVkTm9kZShub2RlLCBTaW5nbGVWYXJpYWJsZURlY2xhcmF0aW9uLk5BTUVfUFJP
UEVSVFkpOwotCQlpbnQgZXh0cmFEaW1zPSByZXdyaXRlRXh0cmFEaW1lbnNpb25zKG5vZGUsIElO
VEVSTkFMX1ZBUklBQkxFX0VYVFJBX0RJTUVOU0lPTlNfUFJPUEVSVFksIHBvcyk7CisJCWludCBl
eHRyYURpbXM9IGFwaUxldmVsIDwgQVNULkpMUzggPyByZXdyaXRlRXh0cmFEaW1lbnNpb25zKG5v
ZGUsIElOVEVSTkFMX1ZBUklBQkxFX0VYVFJBX0RJTUVOU0lPTlNfUFJPUEVSVFksIHBvcykgOgor
CQkJcmV3cml0ZU5vZGVMaXN0KG5vZGUsIFNpbmdsZVZhcmlhYmxlRGVjbGFyYXRpb24uRVhUUkFf
RElNRU5TSU9OX0lORk9TX1BST1BFUlRZLCBwb3MsIFV0aWwuRU1QVFlfU1RSSU5HLCAiICIpOy8v
JE5PTi1OTFMtMSQKIAogCQlpZiAoZXh0cmFEaW1zID4gMCkgewogCQkJaW50IGtpbmQ9IGdldENo
YW5nZUtpbmQobm9kZSwgU2luZ2xlVmFyaWFibGVEZWNsYXJhdGlvbi5JTklUSUFMSVpFUl9QUk9Q
RVJUWSk7CmRpZmYgLS1naXQgYS9vcmcuZWNsaXBzZS5qZHQuY29yZS9kb20vb3JnL2VjbGlwc2Uv
amR0L2ludGVybmFsL2NvcmUvZG9tL3Jld3JpdGUvQVNUUmV3cml0ZUZsYXR0ZW5lci5qYXZhIGIv
b3JnLmVjbGlwc2UuamR0LmNvcmUvZG9tL29yZy9lY2xpcHNlL2pkdC9pbnRlcm5hbC9jb3JlL2Rv
bS9yZXdyaXRlL0FTVFJld3JpdGVGbGF0dGVuZXIuamF2YQppbmRleCBlZDUyMWQxLi42ZTc1M2E4
IDEwMDY0NAotLS0gYS9vcmcuZWNsaXBzZS5qZHQuY29yZS9kb20vb3JnL2VjbGlwc2UvamR0L2lu
dGVybmFsL2NvcmUvZG9tL3Jld3JpdGUvQVNUUmV3cml0ZUZsYXR0ZW5lci5qYXZhCisrKyBiL29y
Zy5lY2xpcHNlLmpkdC5jb3JlL2RvbS9vcmcvZWNsaXBzZS9qZHQvaW50ZXJuYWwvY29yZS9kb20v
cmV3cml0ZS9BU1RSZXdyaXRlRmxhdHRlbmVyLmphdmEKQEAgLTgwMyw2ICs4MDMsOSBAQAogCQkJ
dmlzaXRMaXN0KG5vZGUsIFNpbmdsZVZhcmlhYmxlRGVjbGFyYXRpb24uTU9ESUZJRVJTMl9QUk9Q
RVJUWSwgU3RyaW5nLnZhbHVlT2YoJyAnKSwgVXRpbC5FTVBUWV9TVFJJTkcsIFN0cmluZy52YWx1
ZU9mKCcgJykpOwogCQl9CiAJCWdldENoaWxkTm9kZShub2RlLCBTaW5nbGVWYXJpYWJsZURlY2xh
cmF0aW9uLlRZUEVfUFJPUEVSVFkpLmFjY2VwdCh0aGlzKTsKKwkJaWYgKG5vZGUuZ2V0QVNUKCku
YXBpTGV2ZWwoKSA+PSBBU1QuSkxTOCAgJiYgbm9kZS5pc1ZhcmFyZ3MoKSkgeworCQkJdmlzaXRM
aXN0KG5vZGUsIFNpbmdsZVZhcmlhYmxlRGVjbGFyYXRpb24uVkFSQVJHU19BTk5PVEFUSU9OU19Q
Uk9QRVJUWSwgU3RyaW5nLnZhbHVlT2YoJyAnKSwgVXRpbC5FTVBUWV9TVFJJTkcsIFN0cmluZy52
YWx1ZU9mKCcgJykpOworCQl9CiAJCWlmIChub2RlLmdldEFTVCgpLmFwaUxldmVsKCkgPj0gSkxT
M19JTlRFUk5BTCkgewogCQkJaWYgKGdldEJvb2xlYW5BdHRyaWJ1dGUobm9kZSwgU2luZ2xlVmFy
aWFibGVEZWNsYXJhdGlvbi5WQVJBUkdTX1BST1BFUlRZKSkgewogCQkJCXRoaXMucmVzdWx0LmFw
cGVuZCgiLi4uIik7Ly8kTk9OLU5MUy0xJApkaWZmIC0tZ2l0IGEvb3JnLmVjbGlwc2UuamR0LmNv
cmUvZG9tL29yZy9lY2xpcHNlL2pkdC9pbnRlcm5hbC9jb3JlL2RvbS9yZXdyaXRlL0FTVFJld3Jp
dGVGb3JtYXR0ZXIuamF2YSBiL29yZy5lY2xpcHNlLmpkdC5jb3JlL2RvbS9vcmcvZWNsaXBzZS9q
ZHQvaW50ZXJuYWwvY29yZS9kb20vcmV3cml0ZS9BU1RSZXdyaXRlRm9ybWF0dGVyLmphdmEKaW5k
ZXggOGUzOWY3ZC4uN2UwMGI4OCAxMDA2NDQKLS0tIGEvb3JnLmVjbGlwc2UuamR0LmNvcmUvZG9t
L29yZy9lY2xpcHNlL2pkdC9pbnRlcm5hbC9jb3JlL2RvbS9yZXdyaXRlL0FTVFJld3JpdGVGb3Jt
YXR0ZXIuamF2YQorKysgYi9vcmcuZWNsaXBzZS5qZHQuY29yZS9kb20vb3JnL2VjbGlwc2UvamR0
L2ludGVybmFsL2NvcmUvZG9tL3Jld3JpdGUvQVNUUmV3cml0ZUZvcm1hdHRlci5qYXZhCkBAIC0x
LDkgKzEsMTMgQEAKIC8qKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioq
KioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqCi0gKiBDb3B5cmlnaHQgKGMpIDIw
MDAsIDIwMTEgSUJNIENvcnBvcmF0aW9uIGFuZCBvdGhlcnMuCisgKiBDb3B5cmlnaHQgKGMpIDIw
MDAsIDIwMTMgSUJNIENvcnBvcmF0aW9uIGFuZCBvdGhlcnMuCiAgKiBBbGwgcmlnaHRzIHJlc2Vy
dmVkLiBUaGlzIHByb2dyYW0gYW5kIHRoZSBhY2NvbXBhbnlpbmcgbWF0ZXJpYWxzCiAgKiBhcmUg
bWFkZSBhdmFpbGFibGUgdW5kZXIgdGhlIHRlcm1zIG9mIHRoZSBFY2xpcHNlIFB1YmxpYyBMaWNl
bnNlIHYxLjAKICAqIHdoaWNoIGFjY29tcGFuaWVzIHRoaXMgZGlzdHJpYnV0aW9uLCBhbmQgaXMg
YXZhaWxhYmxlIGF0CiAgKiBodHRwOi8vd3d3LmVjbGlwc2Uub3JnL2xlZ2FsL2VwbC12MTAuaHRt
bAorICoKKyAqIFRoaXMgaXMgYW4gaW1wbGVtZW50YXRpb24gb2YgYW4gZWFybHktZHJhZnQgc3Bl
Y2lmaWNhdGlvbiBkZXZlbG9wZWQgdW5kZXIgdGhlIEphdmEKKyAqIENvbW11bml0eSBQcm9jZXNz
IChKQ1ApIGFuZCBpcyBtYWRlIGF2YWlsYWJsZSBmb3IgdGVzdGluZyBhbmQgZXZhbHVhdGlvbiBw
dXJwb3NlcworICogb25seS4gVGhlIGNvZGUgaXMgbm90IGNvbXBhdGlibGUgd2l0aCBhbnkgc3Bl
Y2lmaWNhdGlvbiBvZiB0aGUgSkNQLgogICoKICAqIENvbnRyaWJ1dG9yczoKICAqICAgICBJQk0g
Q29ycG9yYXRpb24gLSBpbml0aWFsIEFQSSBhbmQgaW1wbGVtZW50YXRpb24KQEAgLTU1MCw2ICs1
NTQsNyBAQAogCXB1YmxpYyBmaW5hbCBQcmVmaXggRklSU1RfRU5VTV9DT05TVD0gbmV3IEZvcm1h
dHRpbmdQcmVmaXgoImVudW0gRSB7IFg7fSIsICJ7IFgiICwgQ29kZUZvcm1hdHRlci5LX0NPTVBJ
TEFUSU9OX1VOSVQpOyAvLyROT04tTkxTLTEkIC8vJE5PTi1OTFMtMiQKIAlwdWJsaWMgZmluYWwg
UHJlZml4IEFOTk9UQVRJT05fU0VQQVJBVElPTj0gbmV3IEZvcm1hdHRpbmdQcmVmaXgoIkBBIEBC
IGNsYXNzIEMge30iLCAiQSBAIiAsIENvZGVGb3JtYXR0ZXIuS19DT01QSUxBVElPTl9VTklUKTsg
Ly8kTk9OLU5MUy0xJCAvLyROT04tTkxTLTIkCiAJcHVibGljIGZpbmFsIFByZWZpeCBQQVJBTV9B
Tk5PVEFUSU9OX1NFUEFSQVRJT049IG5ldyBGb3JtYXR0aW5nUHJlZml4KCJ2b2lkIGZvbyhAQSBA
QiBwKSB7IH0iLCAiQSBAIiAsIENvZGVGb3JtYXR0ZXIuS19DTEFTU19CT0RZX0RFQ0xBUkFUSU9O
Uyk7IC8vJE5PTi1OTFMtMSQgLy8kTk9OLU5MUy0yJAorCXB1YmxpYyBmaW5hbCBQcmVmaXggVkFS
QVJHU19BTk5PVEFUSU9OX1NFUEFSQVRJT049IG5ldyBGb3JtYXR0aW5nUHJlZml4KCJ2b2lkIGZv
byhwIEBBIEBCLi4uKSB7IH0iLCAiQSBAIiAsIENvZGVGb3JtYXR0ZXIuS19DTEFTU19CT0RZX0RF
Q0xBUkFUSU9OUyk7IC8vJE5PTi1OTFMtMSQgLy8kTk9OLU5MUy0yJAogCXB1YmxpYyBmaW5hbCBQ
cmVmaXggVFJZX1JFU09VUkNFUyA9IG5ldyBGb3JtYXR0aW5nUHJlZml4KCJ0cnkgKEEgYSA9IG5l
dyBBKCk7IEIgYiA9IG5ldyBCKCkpIHt9IiwgIjsgQiIgLCBDb2RlRm9ybWF0dGVyLktfU1RBVEVN
RU5UUyk7IC8vJE5PTi1OTFMtMSQgLy8kTk9OLU5MUy0yJAogCXB1YmxpYyBmaW5hbCBQcmVmaXgg
VFJZX1JFU09VUkNFU19QQVJFTiA9IG5ldyBGb3JtYXR0aW5nUHJlZml4KCJ0cnkgKEEgYSA9IG5l
dyBBKCk7IEIgYiA9IG5ldyBCKCkpIHt9IiwgInkgKCIgLCBDb2RlRm9ybWF0dGVyLktfU1RBVEVN
RU5UUyk7IC8vJE5PTi1OTFMtMSQgLy8kTk9OLU5MUy0yJAogCQ==
</data>

          </attachment>
          <attachment
              isobsolete="0"
              ispatch="1"
              isprivate="0"
          >
            <attachid>227309</attachid>
            <date>2013-02-19 21:09:00 -0500</date>
            <delta_ts>2013-02-19 21:09:56 -0500</delta_ts>
            <desc>Proposed Patch</desc>
            <filename>Fix-for-Bug-395663--18ast-rewrite-Add-rewrite-suppor.patch</filename>
            <type>text/plain</type>
            <size>14238</size>
            <attacher name="Manoj Palat Away Until May 11 2015">manpalat</attacher>
            
              <data encoding="base64">ZGlmZiAtLWdpdCBhL29yZy5lY2xpcHNlLmpkdC5jb3JlLnRlc3RzLm1vZGVsL3NyYy9vcmcvZWNs
aXBzZS9qZHQvY29yZS90ZXN0cy9yZXdyaXRlL2Rlc2NyaWJpbmcvQVNUUmV3cml0aW5nTWV0aG9k
RGVjbFRlc3QuamF2YSBiL29yZy5lY2xpcHNlLmpkdC5jb3JlLnRlc3RzLm1vZGVsL3NyYy9vcmcv
ZWNsaXBzZS9qZHQvY29yZS90ZXN0cy9yZXdyaXRlL2Rlc2NyaWJpbmcvQVNUUmV3cml0aW5nTWV0
aG9kRGVjbFRlc3QuamF2YQppbmRleCBlMDljYjdmLi5jZTQyNjViIDEwMDY0NAotLS0gYS9vcmcu
ZWNsaXBzZS5qZHQuY29yZS50ZXN0cy5tb2RlbC9zcmMvb3JnL2VjbGlwc2UvamR0L2NvcmUvdGVz
dHMvcmV3cml0ZS9kZXNjcmliaW5nL0FTVFJld3JpdGluZ01ldGhvZERlY2xUZXN0LmphdmEKKysr
IGIvb3JnLmVjbGlwc2UuamR0LmNvcmUudGVzdHMubW9kZWwvc3JjL29yZy9lY2xpcHNlL2pkdC9j
b3JlL3Rlc3RzL3Jld3JpdGUvZGVzY3JpYmluZy9BU1RSZXdyaXRpbmdNZXRob2REZWNsVGVzdC5q
YXZhCkBAIC0yODg3LDUgKzI4ODcsMTU2IEBACiAJCWFzc2VydEVxdWFsU3RyaW5nKHByZXZpZXcs
IGJ1Zi50b1N0cmluZygpKTsKIAl9CiAKKwlwdWJsaWMgdm9pZCB0ZXN0VmFyQXJnc0Fubm90YXRp
b25zKCkgdGhyb3dzIEV4Y2VwdGlvbiB7CisJCUlQYWNrYWdlRnJhZ21lbnQgcGFjazE9IHRoaXMu
c291cmNlRm9sZGVyLmNyZWF0ZVBhY2thZ2VGcmFnbWVudCgidGVzdDEiLCBmYWxzZSwgbnVsbCk7
CisJCVN0cmluZ0J1ZmZlciBidWY9IG5ldyBTdHJpbmdCdWZmZXIoKTsKKwkJYnVmLmFwcGVuZCgi
cGFja2FnZSB0ZXN0MTtcbiIpOworCQlidWYuYXBwZW5kKCJAaW50ZXJmYWNlIE1hcmtlciB7XG4i
KTsKKwkJYnVmLmFwcGVuZCgifVxuIik7CisJCWJ1Zi5hcHBlbmQoInB1YmxpYyBjbGFzcyBERCB7
XG4iKTsKKwkJYnVmLmFwcGVuZCgiICAgIHB1YmxpYyB2b2lkIGZvbzEoU3RyaW5nIGZvcm1hdCwg
T2JqZWN0IEBNYXJrZXIuLi4gYXJncyl7XG4iKTsKKwkJYnVmLmFwcGVuZCgiICAgIH1cbiIpOwor
CQlidWYuYXBwZW5kKCIgICAgcHVibGljIHZvaWQgZm9vMihPYmplY3QgLi4uIGFyZ3MpIHtcbiIp
OworCQlidWYuYXBwZW5kKCIgICAgfVxuIik7CisJCWJ1Zi5hcHBlbmQoIiAgICBwdWJsaWMgdm9p
ZCBmb28zKE9iamVjdCBATWFya2VyIC4uLiBhcmdzKSB7XG4iKTsKKwkJYnVmLmFwcGVuZCgiICAg
IH1cbiIpOworCQlidWYuYXBwZW5kKCIgICAgcHVibGljIHZvaWQgZm9vNChPYmplY3QgQE1hcmtl
ci4uLiBhcmdzKSB7XG4iKTsgCisJCWJ1Zi5hcHBlbmQoIiAgICB9XG4iKTsKKwkJYnVmLmFwcGVu
ZCgiICAgIHB1YmxpYyB2b2lkIGZvbzUoT2JqZWN0IC4uLiBhcmdzKSB7XG4iKTsgCisJCWJ1Zi5h
cHBlbmQoIiAgICB9XG4iKTsKKwkJYnVmLmFwcGVuZCgiICAgIHB1YmxpYyB2b2lkIGZvbzYoT2Jq
ZWN0IGFyZ3MpIHtcbiIpOworCQlidWYuYXBwZW5kKCIgICAgfVxuIik7CisJCWJ1Zi5hcHBlbmQo
IiAgICBwdWJsaWMgdm9pZCBmb283KE9iamVjdCBATWFya2VyIC4uLiBhcmdzKSB7XG4iKTsKKwkJ
YnVmLmFwcGVuZCgiICAgIH1cbiIpOwkJCisJCWJ1Zi5hcHBlbmQoIiAgICBwdWJsaWMgdm9pZCBm
b284KE9iamVjdCBATWFya2VyIC4uLiBhcmdzKSB7XG4iKTsKKwkJYnVmLmFwcGVuZCgiICAgIH1c
biIpOwkJCisJCWJ1Zi5hcHBlbmQoIiAgICBwdWJsaWMgdm9pZCBmb285KEBCIEBDIGludCBAQS4u
LiBhKSB7XG4iKTsKKwkJYnVmLmFwcGVuZCgiICAgIH1cbiIpOworCQlidWYuYXBwZW5kKCIgICAg
cHVibGljIHZvaWQgZm9vMTAoT2JqZWN0IGFyZ3MpIHtcbiIpOworCQlidWYuYXBwZW5kKCIgICAg
fVxuIik7CisJCWJ1Zi5hcHBlbmQoIiAgICBwdWJsaWMgdm9pZCBmb28xMShPYmplY3QgQE1hcmtl
ciAuLi4gYXJncykge1xuIik7CisJCWJ1Zi5hcHBlbmQoIiAgICB9XG4iKTsKKwkJYnVmLmFwcGVu
ZCgiICAgIHB1YmxpYyB2b2lkIGZvbzEyKE9iamVjdC4uLiBhcmdzKSB7XG4iKTsKKwkJYnVmLmFw
cGVuZCgiICAgIH1cbiIpOworCQlidWYuYXBwZW5kKCJ9XG4iKTsKKwkJSUNvbXBpbGF0aW9uVW5p
dCBjdT0gcGFjazEuY3JlYXRlQ29tcGlsYXRpb25Vbml0KCJERC5qYXZhIiwgYnVmLnRvU3RyaW5n
KCksIGZhbHNlLCBudWxsKTsKKwkJCisJCUNvbXBpbGF0aW9uVW5pdCBhc3RSb290PSBjcmVhdGVB
U1QoQVNULkpMUzgsIGN1LCBmYWxzZSk7CisJCUFTVCBhc3Q9IGFzdFJvb3QuZ2V0QVNUKCk7CisJ
CUFTVFJld3JpdGUgcmV3cml0ZT0gQVNUUmV3cml0ZS5jcmVhdGUoYXN0Um9vdC5nZXRBU1QoKSk7
CisJCVR5cGVEZWNsYXJhdGlvbiB0eXBlPSBmaW5kVHlwZURlY2xhcmF0aW9uKGFzdFJvb3QsICJE
RCIpOworCQkKKwkJeworCQkJLy8gUmVtb3ZlIGFubm90YXRpb24gZnJvbSBmaXJzdCBtZXRob2Qg
YXJncyAtIGJvdW5kYXJ5IGNvbmRpdGlvbiAtCisJCQkvLyAtIG9ubHkgb25lIGFubm90YXRpb24g
c2hvdWxkIGJlIHByZXNlbnQuCisJCQlNZXRob2REZWNsYXJhdGlvbiBtZXRob2REZWNsPSBmaW5k
TWV0aG9kRGVjbGFyYXRpb24odHlwZSwgImZvbzEiKTsKKwkJCVNpbmdsZVZhcmlhYmxlRGVjbGFy
YXRpb24gcGFyYW0gPSAoU2luZ2xlVmFyaWFibGVEZWNsYXJhdGlvbikgbWV0aG9kRGVjbC5wYXJh
bWV0ZXJzKCkuZ2V0KDEpOworCQkJcmV3cml0ZS5yZW1vdmUoKEFTVE5vZGUpcGFyYW0udmFyYXJn
c0Fubm90YXRpb25zKCkuZ2V0KDApLCBudWxsKTsKKwkJCQorCQkJLy8gQWRkIG9uZSBhbm5vdGF0
aW9uIHRvIHRoZSBzZWNvbmQgbWV0aG9kIC0gYm91bmRhcnkgY29uZGl0aW9uIAorCQkJLy8gLSBu
byBhbm5vdGF0aW9uIHNob3VsZCBiZSBwcmVzZW50CisJCQltZXRob2REZWNsPSBmaW5kTWV0aG9k
RGVjbGFyYXRpb24odHlwZSwgImZvbzIiKTsKKwkJCXBhcmFtID0gKFNpbmdsZVZhcmlhYmxlRGVj
bGFyYXRpb24pIG1ldGhvZERlY2wucGFyYW1ldGVycygpLmdldCgwKTsKKwkJCU1hcmtlckFubm90
YXRpb24gbWFya2VyQW5ub3RhdGlvbj0gYXN0Lm5ld01hcmtlckFubm90YXRpb24oKTsKKwkJCW1h
cmtlckFubm90YXRpb24uc2V0VHlwZU5hbWUoYXN0Lm5ld1NpbXBsZU5hbWUoIlgiKSk7CisJCQlM
aXN0UmV3cml0ZSBsaXN0UmV3cml0ZT0gcmV3cml0ZS5nZXRMaXN0UmV3cml0ZShwYXJhbSwgU2lu
Z2xlVmFyaWFibGVEZWNsYXJhdGlvbi5WQVJBUkdTX0FOTk9UQVRJT05TX1BST1BFUlRZKTsKKwkJ
CWxpc3RSZXdyaXRlLmluc2VydEZpcnN0KG1hcmtlckFubm90YXRpb24sIG51bGwpOworCQkJCisJ
CQkvLyBSZW1vdmUgdGhlIHZhcmFyZ3MgcHJvcGVydHkgLSBhbm5vdGF0aW9uKHMpIHNob3VsZCBk
aXNhcHBlYXIKKwkJCW1ldGhvZERlY2w9IGZpbmRNZXRob2REZWNsYXJhdGlvbih0eXBlLCAiZm9v
MyIpOworCQkJcGFyYW0gPSAoU2luZ2xlVmFyaWFibGVEZWNsYXJhdGlvbikgbWV0aG9kRGVjbC5w
YXJhbWV0ZXJzKCkuZ2V0KDApOworCQkJcmV3cml0ZS5zZXQocGFyYW0sIFNpbmdsZVZhcmlhYmxl
RGVjbGFyYXRpb24uVkFSQVJHU19QUk9QRVJUWSwgQm9vbGVhbi5GQUxTRSwgbnVsbCk7CisJCQkK
KwkJCS8vIFJlbW92ZSB0aGUgdmFyYXJncyBwcm9wZXJ0eSAtIGFubm90YXRpb24ocykgc2hvdWxk
IGRpc2FwcGVhcgorCQkJLy8gLSBkaWZmZXJzIGZyb20gdGhlIGFib3ZlIGR1ZSB0byB0aGUgYWJz
ZW5jZSBvZiBhIGJsYW5rIGJlZm9yZSAuLi4KKwkJCW1ldGhvZERlY2w9IGZpbmRNZXRob2REZWNs
YXJhdGlvbih0eXBlLCAiZm9vNCIpOworCQkJcGFyYW0gPSAoU2luZ2xlVmFyaWFibGVEZWNsYXJh
dGlvbikgbWV0aG9kRGVjbC5wYXJhbWV0ZXJzKCkuZ2V0KDApOworCQkJcmV3cml0ZS5zZXQocGFy
YW0sIFNpbmdsZVZhcmlhYmxlRGVjbGFyYXRpb24uVkFSQVJHU19QUk9QRVJUWSwgQm9vbGVhbi5G
QUxTRSwgbnVsbCk7CisJCQkKKwkJCS8vIFJlbW92ZSB0aGUgdmFyYXJncyBwcm9wZXJ0eSAtIEV4
aXN0aW5nIGZ1bmN0aW9uYWxpdHkgdW5jaGFuZ2VkIHdpdGhvdXQgYW5ub3RhdGlvbnMKKwkJCW1l
dGhvZERlY2w9IGZpbmRNZXRob2REZWNsYXJhdGlvbih0eXBlLCAiZm9vNSIpOworCQkJcGFyYW0g
PSAoU2luZ2xlVmFyaWFibGVEZWNsYXJhdGlvbikgbWV0aG9kRGVjbC5wYXJhbWV0ZXJzKCkuZ2V0
KDApOworCQkJcmV3cml0ZS5zZXQocGFyYW0sIFNpbmdsZVZhcmlhYmxlRGVjbGFyYXRpb24uVkFS
QVJHU19QUk9QRVJUWSwgQm9vbGVhbi5GQUxTRSwgbnVsbCk7CisJCQkKKwkJCS8vIEFkZCB0aGUg
dmFyYXJncyBwcm9wZXJ0eSAgYW5kIGFubm90YXRpb24KKwkJCW1ldGhvZERlY2w9IGZpbmRNZXRo
b2REZWNsYXJhdGlvbih0eXBlLCAiZm9vNiIpOworCQkJcGFyYW0gPSAoU2luZ2xlVmFyaWFibGVE
ZWNsYXJhdGlvbikgbWV0aG9kRGVjbC5wYXJhbWV0ZXJzKCkuZ2V0KDApOworCQkJcmV3cml0ZS5z
ZXQocGFyYW0sIFNpbmdsZVZhcmlhYmxlRGVjbGFyYXRpb24uVkFSQVJHU19QUk9QRVJUWSwgQm9v
bGVhbi5UUlVFLCBudWxsKTsKKwkJCW1hcmtlckFubm90YXRpb249IGFzdC5uZXdNYXJrZXJBbm5v
dGF0aW9uKCk7CisJCQltYXJrZXJBbm5vdGF0aW9uLnNldFR5cGVOYW1lKGFzdC5uZXdTaW1wbGVO
YW1lKCJYIikpOworCQkJbGlzdFJld3JpdGU9IHJld3JpdGUuZ2V0TGlzdFJld3JpdGUocGFyYW0s
IFNpbmdsZVZhcmlhYmxlRGVjbGFyYXRpb24uVkFSQVJHU19BTk5PVEFUSU9OU19QUk9QRVJUWSk7
CisJCQlsaXN0UmV3cml0ZS5pbnNlcnRGaXJzdChtYXJrZXJBbm5vdGF0aW9uLCBudWxsKTsKKwkJ
CQorCQkJLy8gUmVwbGFjZSBhbm5vdGF0aW9uCisJCQltZXRob2REZWNsPSBmaW5kTWV0aG9kRGVj
bGFyYXRpb24odHlwZSwgImZvbzciKTsKKwkJCXBhcmFtID0gKFNpbmdsZVZhcmlhYmxlRGVjbGFy
YXRpb24pIG1ldGhvZERlY2wucGFyYW1ldGVycygpLmdldCgwKTsKKwkJCW1hcmtlckFubm90YXRp
b249IGFzdC5uZXdNYXJrZXJBbm5vdGF0aW9uKCk7CisJCQltYXJrZXJBbm5vdGF0aW9uLnNldFR5
cGVOYW1lKGFzdC5uZXdTaW1wbGVOYW1lKCJYIikpOworCQkJcmV3cml0ZS5yZXBsYWNlKChBU1RO
b2RlKXBhcmFtLnZhcmFyZ3NBbm5vdGF0aW9ucygpLmdldCgwKSwgbWFya2VyQW5ub3RhdGlvbiwg
bnVsbCk7CisJCQkKKwkJCS8vIFJlc2V0IGFuZCBTZXQgVmFyYXJncyAtIG91dHB1dCBzaG91bGQg
bm90IGNoYW5nZS4KKwkJCW1ldGhvZERlY2w9IGZpbmRNZXRob2REZWNsYXJhdGlvbih0eXBlLCAi
Zm9vOCIpOworCQkJcGFyYW0gPSAoU2luZ2xlVmFyaWFibGVEZWNsYXJhdGlvbikgbWV0aG9kRGVj
bC5wYXJhbWV0ZXJzKCkuZ2V0KDApOworCQkJcmV3cml0ZS5zZXQocGFyYW0sIFNpbmdsZVZhcmlh
YmxlRGVjbGFyYXRpb24uVkFSQVJHU19QUk9QRVJUWSwgQm9vbGVhbi5GQUxTRSwgbnVsbCk7CisJ
CQlyZXdyaXRlLnNldChwYXJhbSwgU2luZ2xlVmFyaWFibGVEZWNsYXJhdGlvbi5WQVJBUkdTX1BS
T1BFUlRZLCBCb29sZWFuLlRSVUUsIG51bGwpOworCQkJCisJCQkvLyBBZGQgbXVsdGlwbGUgKHR3
bykgYW5ub3RhdGlvbnMsIHJlbW92ZSBhbiBleGlzdGluZyBhbm5vdGF0aW9uCisJCQltZXRob2RE
ZWNsPSBmaW5kTWV0aG9kRGVjbGFyYXRpb24odHlwZSwgImZvbzkiKTsKKwkJCXBhcmFtID0gKFNp
bmdsZVZhcmlhYmxlRGVjbGFyYXRpb24pIG1ldGhvZERlY2wucGFyYW1ldGVycygpLmdldCgwKTsK
KwkJCW1hcmtlckFubm90YXRpb249IGFzdC5uZXdNYXJrZXJBbm5vdGF0aW9uKCk7CisJCQltYXJr
ZXJBbm5vdGF0aW9uLnNldFR5cGVOYW1lKGFzdC5uZXdTaW1wbGVOYW1lKCJYIikpOworCQkJbGlz
dFJld3JpdGU9IHJld3JpdGUuZ2V0TGlzdFJld3JpdGUocGFyYW0sIFNpbmdsZVZhcmlhYmxlRGVj
bGFyYXRpb24uVkFSQVJHU19BTk5PVEFUSU9OU19QUk9QRVJUWSk7CisJCQlsaXN0UmV3cml0ZS5p
bnNlcnRGaXJzdChtYXJrZXJBbm5vdGF0aW9uLCBudWxsKTsKKwkJCW1hcmtlckFubm90YXRpb249
IGFzdC5uZXdNYXJrZXJBbm5vdGF0aW9uKCk7CisJCQltYXJrZXJBbm5vdGF0aW9uLnNldFR5cGVO
YW1lKGFzdC5uZXdTaW1wbGVOYW1lKCJZIikpOworCQkJbGlzdFJld3JpdGUuaW5zZXJ0Rmlyc3Qo
bWFya2VyQW5ub3RhdGlvbiwgbnVsbCk7CisJCQlyZXdyaXRlLnJlbW92ZSgoQVNUTm9kZSlwYXJh
bS52YXJhcmdzQW5ub3RhdGlvbnMoKS5nZXQoMCksIG51bGwpOworCQkJCisJCQkvLyBBZGQgdGhl
IHZhcmFyZ3MgcHJvcGVydHkKKwkJCW1ldGhvZERlY2w9IGZpbmRNZXRob2REZWNsYXJhdGlvbih0
eXBlLCAiZm9vMTAiKTsKKwkJCXBhcmFtID0gKFNpbmdsZVZhcmlhYmxlRGVjbGFyYXRpb24pIG1l
dGhvZERlY2wucGFyYW1ldGVycygpLmdldCgwKTsKKwkJCXJld3JpdGUuc2V0KHBhcmFtLCBTaW5n
bGVWYXJpYWJsZURlY2xhcmF0aW9uLlZBUkFSR1NfUFJPUEVSVFksIEJvb2xlYW4uVFJVRSwgbnVs
bCk7CisJCQkKKwkJCS8vIFJlbW92ZSB0aGUgYW5ub3RhdGlvbnMgYW5kIHZhcmFyZ3MgcHJvcGVy
dHkgYXMgd2VsbC4KKwkJCW1ldGhvZERlY2w9IGZpbmRNZXRob2REZWNsYXJhdGlvbih0eXBlLCAi
Zm9vMTEiKTsKKwkJCXBhcmFtID0gKFNpbmdsZVZhcmlhYmxlRGVjbGFyYXRpb24pIG1ldGhvZERl
Y2wucGFyYW1ldGVycygpLmdldCgwKTsKKwkJCXJld3JpdGUucmVtb3ZlKChBU1ROb2RlKXBhcmFt
LnZhcmFyZ3NBbm5vdGF0aW9ucygpLmdldCgwKSwgbnVsbCk7CisJCQlyZXdyaXRlLnNldChwYXJh
bSwgU2luZ2xlVmFyaWFibGVEZWNsYXJhdGlvbi5WQVJBUkdTX1BST1BFUlRZLCBCb29sZWFuLkZB
TFNFLCBudWxsKTsKKwkJCQorCQl9CisJCVN0cmluZyBwcmV2aWV3PSBldmFsdWF0ZVJld3JpdGUo
Y3UsIHJld3JpdGUpOworCQkKKwkJYnVmPSBuZXcgU3RyaW5nQnVmZmVyKCk7CisJCWJ1Zi5hcHBl
bmQoInBhY2thZ2UgdGVzdDE7XG4iKTsKKwkJYnVmLmFwcGVuZCgiQGludGVyZmFjZSBNYXJrZXIg
e1xuIik7CisJCWJ1Zi5hcHBlbmQoIn1cbiIpOworCQlidWYuYXBwZW5kKCJwdWJsaWMgY2xhc3Mg
REQge1xuIik7CisJCWJ1Zi5hcHBlbmQoIiAgICBwdWJsaWMgdm9pZCBmb28xKFN0cmluZyBmb3Jt
YXQsIE9iamVjdCAuLi4gYXJncyl7XG4iKTsKKwkJYnVmLmFwcGVuZCgiICAgIH1cbiIpOworCQli
dWYuYXBwZW5kKCIgICAgcHVibGljIHZvaWQgZm9vMihPYmplY3QgQFggLi4uIGFyZ3MpIHtcbiIp
OworCQlidWYuYXBwZW5kKCIgICAgfVxuIik7CisJCWJ1Zi5hcHBlbmQoIiAgICBwdWJsaWMgdm9p
ZCBmb28zKE9iamVjdCBhcmdzKSB7XG4iKTsKKwkJYnVmLmFwcGVuZCgiICAgIH1cbiIpOworCQli
dWYuYXBwZW5kKCIgICAgcHVibGljIHZvaWQgZm9vNChPYmplY3QgYXJncykge1xuIik7CisJCWJ1
Zi5hcHBlbmQoIiAgICB9XG4iKTsKKwkJYnVmLmFwcGVuZCgiICAgIHB1YmxpYyB2b2lkIGZvbzUo
T2JqZWN0IGFyZ3MpIHtcbiIpOworCQlidWYuYXBwZW5kKCIgICAgfVxuIik7CisJCWJ1Zi5hcHBl
bmQoIiAgICBwdWJsaWMgdm9pZCBmb282KE9iamVjdCBAWCAuLi5hcmdzKSB7XG4iKTsKKwkJYnVm
LmFwcGVuZCgiICAgIH1cbiIpOworCQlidWYuYXBwZW5kKCIgICAgcHVibGljIHZvaWQgZm9vNyhP
YmplY3QgQFggLi4uIGFyZ3MpIHtcbiIpOworCQlidWYuYXBwZW5kKCIgICAgfVxuIik7CQkKKwkJ
YnVmLmFwcGVuZCgiICAgIHB1YmxpYyB2b2lkIGZvbzgoT2JqZWN0IEBNYXJrZXIgLi4uIGFyZ3Mp
IHtcbiIpOworCQlidWYuYXBwZW5kKCIgICAgfVxuIik7CQkKKwkJYnVmLmFwcGVuZCgiICAgIHB1
YmxpYyB2b2lkIGZvbzkoQEIgQEMgaW50IEBZIEBYIC4uLiBhKSB7XG4iKTsKKwkJYnVmLmFwcGVu
ZCgiICAgIH1cbiIpOworCQlidWYuYXBwZW5kKCIgICAgcHVibGljIHZvaWQgZm9vMTAoT2JqZWN0
Li4uIGFyZ3MpIHtcbiIpOworCQlidWYuYXBwZW5kKCIgICAgfVxuIik7CisJCWJ1Zi5hcHBlbmQo
IiAgICBwdWJsaWMgdm9pZCBmb28xMShPYmplY3QgYXJncykge1xuIik7CisJCWJ1Zi5hcHBlbmQo
IiAgICB9XG4iKTsKKwkJYnVmLmFwcGVuZCgiICAgIHB1YmxpYyB2b2lkIGZvbzEyKE9iamVjdC4u
LiBhcmdzKSB7XG4iKTsKKwkJYnVmLmFwcGVuZCgiICAgIH1cbiIpOworCQlidWYuYXBwZW5kKCJ9
XG4iKTsKKwkJYXNzZXJ0RXF1YWxTdHJpbmcocHJldmlldywgYnVmLnRvU3RyaW5nKCkpOwkKKwl9
CiAKIH0KZGlmZiAtLWdpdCBhL29yZy5lY2xpcHNlLmpkdC5jb3JlL2RvbS9vcmcvZWNsaXBzZS9q
ZHQvaW50ZXJuYWwvY29yZS9kb20vcmV3cml0ZS9BU1RSZXdyaXRlQW5hbHl6ZXIuamF2YSBiL29y
Zy5lY2xpcHNlLmpkdC5jb3JlL2RvbS9vcmcvZWNsaXBzZS9qZHQvaW50ZXJuYWwvY29yZS9kb20v
cmV3cml0ZS9BU1RSZXdyaXRlQW5hbHl6ZXIuamF2YQppbmRleCBmNzljNmRkLi5iZjczYzU3IDEw
MDY0NAotLS0gYS9vcmcuZWNsaXBzZS5qZHQuY29yZS9kb20vb3JnL2VjbGlwc2UvamR0L2ludGVy
bmFsL2NvcmUvZG9tL3Jld3JpdGUvQVNUUmV3cml0ZUFuYWx5emVyLmphdmEKKysrIGIvb3JnLmVj
bGlwc2UuamR0LmNvcmUvZG9tL29yZy9lY2xpcHNlL2pkdC9pbnRlcm5hbC9jb3JlL2RvbS9yZXdy
aXRlL0FTVFJld3JpdGVBbmFseXplci5qYXZhCkBAIC0xNTAzLDcgKzE1MDMsNyBAQAogCQl9CiAK
IAkJUHJlZml4IGZvcm1hdHRlclByZWZpeDsKLQkJaWYgKHByb3BlcnR5ID09IFNpbmdsZVZhcmlh
YmxlRGVjbGFyYXRpb24uTU9ESUZJRVJTMl9QUk9QRVJUWSkKKwkJaWYgKHByb3BlcnR5ID09IFNp
bmdsZVZhcmlhYmxlRGVjbGFyYXRpb24uTU9ESUZJRVJTMl9QUk9QRVJUWSB8fCBwcm9wZXJ0eSA9
PSBTaW5nbGVWYXJpYWJsZURlY2xhcmF0aW9uLlZBUkFSR1NfQU5OT1RBVElPTlNfUFJPUEVSVFkp
CiAJCQlmb3JtYXR0ZXJQcmVmaXg9IHRoaXMuZm9ybWF0dGVyLlBBUkFNX0FOTk9UQVRJT05fU0VQ
QVJBVElPTjsKIAkJZWxzZQogCQkJZm9ybWF0dGVyUHJlZml4PSB0aGlzLmZvcm1hdHRlci5BTk5P
VEFUSU9OX1NFUEFSQVRJT047CkBAIC0xNTEyLDE0ICsxNTEyLDEzIEBACiAKIAkJdHJ5IHsKIAkJ
CWludCBuZXh0UG9zPSBnZXRTY2FubmVyKCkuZ2V0TmV4dFN0YXJ0T2Zmc2V0KGVuZFBvcywgZmFs
c2UpOwotCi0JCQlib29sZWFuIGxhc3RVbmNoYW5nZWQ9IGNoaWxkcmVuW2NoaWxkcmVuLmxlbmd0
aCAtIDFdLmdldENoYW5nZUtpbmQoKSAhPSBSZXdyaXRlRXZlbnQuVU5DSEFOR0VEOworCQkJUmV3
cml0ZUV2ZW50IGxhc3RDaGlsZCA9IGNoaWxkcmVuW2NoaWxkcmVuLmxlbmd0aCAtIDFdOworCQkJ
Ym9vbGVhbiBsYXN0VW5jaGFuZ2VkPSBsYXN0Q2hpbGQuZ2V0Q2hhbmdlS2luZCgpICE9IFJld3Jp
dGVFdmVudC5VTkNIQU5HRUQ7CiAKIAkJCWlmIChpc0FsbFJlbW92ZSkgewotCQkJCWRvVGV4dFJl
bW92ZShlbmRQb3MsIG5leHRQb3MgLSBlbmRQb3MsIGdldEVkaXRHcm91cChjaGlsZHJlbltjaGls
ZHJlbi5sZW5ndGggLSAxXSkpOworCQkJCWRvVGV4dFJlbW92ZShlbmRQb3MsIG5leHRQb3MgLSBl
bmRQb3MsIGdldEVkaXRHcm91cChsYXN0Q2hpbGQpKTsKIAkJCQlyZXR1cm4gbmV4dFBvczsKIAkJ
CX0gZWxzZSBpZiAoaXNBbGxJbnNlcnQgfHwgKG5leHRQb3MgPT0gZW5kUG9zICYmIGxhc3RVbmNo
YW5nZWQpKSB7IC8vIHNlZSBidWcgMTY1NjU0Ci0JCQkJUmV3cml0ZUV2ZW50IGxhc3RDaGlsZD0g
Y2hpbGRyZW5bY2hpbGRyZW4ubGVuZ3RoIC0gMV07CiAJCQkJU3RyaW5nIHNlcGFyYXRvcjsKIAkJ
CQlpZiAobGFzdENoaWxkLmdldE5ld1ZhbHVlKCkgaW5zdGFuY2VvZiBBbm5vdGF0aW9uKSB7CiAJ
CQkJCXNlcGFyYXRvcj0gZm9ybWF0dGVyUHJlZml4LmdldFByZWZpeChnZXRJbmRlbnQocG9zKSk7
CkBAIC0xNTM1LDQyICsxNTM0LDEyIEBACiAJfQogCQogCXByaXZhdGUgaW50IHJld3JpdGVUeXBl
QW5ub3RhdGlvbnMoQVNUTm9kZSBub2RlLCBDaGlsZExpc3RQcm9wZXJ0eURlc2NyaXB0b3IgcHJv
cGVydHksIGludCBwb3MpIHsKLQkJUmV3cml0ZUV2ZW50IGV2ZW50ID0gZ2V0RXZlbnQobm9kZSwg
cHJvcGVydHkpOwotCQlpZiAoZXZlbnQgPT0gbnVsbCB8fCBldmVudC5nZXRDaGFuZ2VLaW5kKCkg
PT0gUmV3cml0ZUV2ZW50LlVOQ0hBTkdFRCkgewotCQkJcmV0dXJuIGRvVmlzaXQobm9kZSwgcHJv
cGVydHksIHBvcyk7Ci0JCX0KLQkJUmV3cml0ZUV2ZW50W10gY2hpbGRyZW4gPSBldmVudC5nZXRD
aGlsZHJlbigpOwotCQlib29sZWFuIGlzQWxsSW5zZXJ0ID0gaXNBbGxPZktpbmQoY2hpbGRyZW4s
IFJld3JpdGVFdmVudC5JTlNFUlRFRCk7Ci0JCWJvb2xlYW4gaXNBbGxSZW1vdmUgPSBpc0FsbE9m
S2luZChjaGlsZHJlbiwgUmV3cml0ZUV2ZW50LlJFTU9WRUQpOwotCQlpZiAoaXNBbGxJbnNlcnQg
fHwgaXNBbGxSZW1vdmUpIHsKLQkJCXRyeSB7Ci0JCQkJcG9zID0gZ2V0U2Nhbm5lcigpLmdldE5l
eHRTdGFydE9mZnNldChwb3MsIGZhbHNlKTsKLQkJCX0gY2F0Y2ggKENvcmVFeGNlcHRpb24gZSkg
ewotCQkJCWhhbmRsZUV4Y2VwdGlvbihlKTsKLQkJCX0KLQkJfQotIAotCQlQcmVmaXggZm9ybWF0
dGVyUHJlZml4ID0gdGhpcy5mb3JtYXR0ZXIuQU5OT1RBVElPTl9TRVBBUkFUSU9OOwotIAotCQlp
bnQgZW5kUG9zID0gbmV3IE1vZGlmaWVyUmV3cml0ZXIoZm9ybWF0dGVyUHJlZml4KS5yZXdyaXRl
TGlzdChub2RlLCBwcm9wZXJ0eSwgcG9zLCBVdGlsLkVNUFRZX1NUUklORywgIiAiKTsgLy8kTk9O
LU5MUy0xJCAKLSAKLQkJdHJ5IHsKLQkJCWludCBuZXh0UG9zID0gZ2V0U2Nhbm5lcigpLmdldE5l
eHRTdGFydE9mZnNldChlbmRQb3MsIGZhbHNlKTsKLQkJCVJld3JpdGVFdmVudCBsYXN0Q2hpbGQg
PSBjaGlsZHJlbltjaGlsZHJlbi5sZW5ndGggLSAxXTsKLQkJCWJvb2xlYW4gbGFzdFVuY2hhbmdl
ZCA9IGxhc3RDaGlsZC5nZXRDaGFuZ2VLaW5kKCkgIT0gUmV3cml0ZUV2ZW50LlVOQ0hBTkdFRDsK
LSAKLQkJCWlmIChpc0FsbFJlbW92ZSkgewotCQkJCWRvVGV4dFJlbW92ZShlbmRQb3MsIG5leHRQ
b3MgLSBlbmRQb3MsIGdldEVkaXRHcm91cChsYXN0Q2hpbGQpKTsKLQkJCQlyZXR1cm4gbmV4dFBv
czsKLQkJCX0gZWxzZSBpZiAoaXNBbGxJbnNlcnQgfHwgKG5leHRQb3MgPT0gZW5kUG9zICYmIGxh
c3RVbmNoYW5nZWQpKSB7Ci0JCQkJZG9UZXh0SW5zZXJ0KGVuZFBvcywgZm9ybWF0dGVyUHJlZml4
LmdldFByZWZpeChnZXRJbmRlbnQocG9zKSksIGdldEVkaXRHcm91cChsYXN0Q2hpbGQpKTsKLQkJ
CX0KLQkJfSBjYXRjaCAoQ29yZUV4Y2VwdGlvbiBlKSB7Ci0JCQloYW5kbGVFeGNlcHRpb24oZSk7
Ci0JCX0KLQkJcmV0dXJuIGVuZFBvczsKKwkJcmV0dXJuIHJld3JpdGVNb2RpZmllcnMyKG5vZGUs
IHByb3BlcnR5LCBwb3MpOwogCX0KIAorCXByaXZhdGUgaW50IHJld3JpdGVWYXJhcmdzQW5ub3Rh
dGlvbnMoQVNUTm9kZSBub2RlLCBDaGlsZExpc3RQcm9wZXJ0eURlc2NyaXB0b3IgcHJvcGVydHks
IGludCBwb3MpIHsKKwkJcmV0dXJuIHJld3JpdGVNb2RpZmllcnMyKG5vZGUsIHByb3BlcnR5LCBw
b3MpOworCX0KIAogCXByaXZhdGUgdm9pZCByZXBsYWNlT3BlcmF0aW9uKGludCBwb3NCZWZvcmVP
cGVyYXRpb24sIFN0cmluZyBuZXdPcGVyYXRpb24sIFRleHRFZGl0R3JvdXAgZWRpdEdyb3VwKSB7
CiAJCXRyeSB7CkBAIC0yODcxLDE1ICsyODQwLDI5IEBACiAJCWlmIChhcGlMZXZlbCA+PSBKTFMz
X0lOVEVSTkFMKSB7CiAJCQlpZiAoaXNDaGFuZ2VkKG5vZGUsIFNpbmdsZVZhcmlhYmxlRGVjbGFy
YXRpb24uVkFSQVJHU19QUk9QRVJUWSkpIHsKIAkJCQlpZiAoZ2V0TmV3VmFsdWUobm9kZSwgU2lu
Z2xlVmFyaWFibGVEZWNsYXJhdGlvbi5WQVJBUkdTX1BST1BFUlRZKS5lcXVhbHMoQm9vbGVhbi5U
UlVFKSkgeworCQkJCQlwb3MgPSBhcGlMZXZlbCA+PSBBU1QuSkxTOCA/IHJld3JpdGVWYXJhcmdz
QW5ub3RhdGlvbnMobm9kZSwgU2luZ2xlVmFyaWFibGVEZWNsYXJhdGlvbi5WQVJBUkdTX0FOTk9U
QVRJT05TX1BST1BFUlRZLCBwb3MpIDogcG9zOwogCQkJCQlkb1RleHRJbnNlcnQocG9zLCAiLi4u
IiwgZ2V0RWRpdEdyb3VwKG5vZGUsIFNpbmdsZVZhcmlhYmxlRGVjbGFyYXRpb24uVkFSQVJHU19Q
Uk9QRVJUWSkpOyAvLyROT04tTkxTLTEkCiAJCQkJfSBlbHNlIHsKIAkJCQkJdHJ5IHsKLQkJCQkJ
CWludCBlbGxpcHNpc0VuZD0gZ2V0U2Nhbm5lcigpLmdldE5leHRFbmRPZmZzZXQocG9zLCB0cnVl
KTsKKwkJCQkJCWludCBlbGxpcHNpc0VuZDsKKwkJCQkJCWludCBub09mQW5ub3RhdGlvbnMgPSBh
cGlMZXZlbCA+PSBBU1QuSkxTOCA/IG5vZGUudmFyYXJnc0Fubm90YXRpb25zKCkuc2l6ZSgpIDog
MDsKKwkJCQkJCWlmIChub09mQW5ub3RhdGlvbnMgPiAwICkgeworCQkJCQkJCUFubm90YXRpb24g
YW5ub3RhdGlvbiA9IChBbm5vdGF0aW9uKW5vZGUudmFyYXJnc0Fubm90YXRpb25zKCkuZ2V0KG5v
T2ZBbm5vdGF0aW9ucyAtIDEpOworCQkJCQkJCWludCBhbm5vdGF0aW9uRW5kUG9zaXRpb24gPSAg
YW5ub3RhdGlvbi5nZXRTdGFydFBvc2l0aW9uKCkgKyBhbm5vdGF0aW9uLmdldExlbmd0aCgpOwor
CQkJCQkJCWVsbGlwc2lzRW5kID0gZ2V0U2Nhbm5lcigpLmdldE5leHRFbmRPZmZzZXQoYW5ub3Rh
dGlvbkVuZFBvc2l0aW9uLCB0cnVlKTsKKwkJCQkJCQl9IGVsc2UgeworCQkJCQkJCQllbGxpcHNp
c0VuZD0gZ2V0U2Nhbm5lcigpLmdldE5leHRFbmRPZmZzZXQocG9zLCB0cnVlKTsKKwkJCQkJCQl9
CiAJCQkJCQlkb1RleHRSZW1vdmUocG9zLCBlbGxpcHNpc0VuZCAtIHBvcywgZ2V0RWRpdEdyb3Vw
KG5vZGUsIFNpbmdsZVZhcmlhYmxlRGVjbGFyYXRpb24uVkFSQVJHU19QUk9QRVJUWSkpOwogCQkJ
CQl9IGNhdGNoIChDb3JlRXhjZXB0aW9uIGUpIHsKIAkJCQkJCWhhbmRsZUV4Y2VwdGlvbihlKTsK
IAkJCQkJfQogCQkJCX0KKwkJCX0gZWxzZSB7CisJCQkJaWYgKGFwaUxldmVsID49IEFTVC5KTFM4
ICYmIG5vZGUuaXNWYXJhcmdzKCkpIHsKKwkJCQkJaW50IGFubm90YXRpb25TdGFydFBvc2l0aW9u
ID0gbm9kZS5nZXRUeXBlKCkuZ2V0U3RhcnRQb3NpdGlvbigpICsgbm9kZS5nZXRUeXBlKCkuZ2V0
TGVuZ3RoKCk7CisJCQkJCXBvcyA9IHJld3JpdGVWYXJhcmdzQW5ub3RhdGlvbnMobm9kZSwgU2lu
Z2xlVmFyaWFibGVEZWNsYXJhdGlvbi5WQVJBUkdTX0FOTk9UQVRJT05TX1BST1BFUlRZLCBhbm5v
dGF0aW9uU3RhcnRQb3NpdGlvbik7CisJCQkJfQogCQkJfQogCQkJaWYgKCFub2RlLmlzVmFyYXJn
cygpKSB7CiAJCQkJZW5zdXJlU3BhY2VBZnRlclJlcGxhY2Uobm9kZSwgU2luZ2xlVmFyaWFibGVE
ZWNsYXJhdGlvbi5UWVBFX1BST1BFUlRZKTsKZGlmZiAtLWdpdCBhL29yZy5lY2xpcHNlLmpkdC5j
b3JlL2RvbS9vcmcvZWNsaXBzZS9qZHQvaW50ZXJuYWwvY29yZS9kb20vcmV3cml0ZS9BU1RSZXdy
aXRlRmxhdHRlbmVyLmphdmEgYi9vcmcuZWNsaXBzZS5qZHQuY29yZS9kb20vb3JnL2VjbGlwc2Uv
amR0L2ludGVybmFsL2NvcmUvZG9tL3Jld3JpdGUvQVNUUmV3cml0ZUZsYXR0ZW5lci5qYXZhCmlu
ZGV4IDY0ODVhZmYuLmMzNzlkYjEgMTAwNjQ0Ci0tLSBhL29yZy5lY2xpcHNlLmpkdC5jb3JlL2Rv
bS9vcmcvZWNsaXBzZS9qZHQvaW50ZXJuYWwvY29yZS9kb20vcmV3cml0ZS9BU1RSZXdyaXRlRmxh
dHRlbmVyLmphdmEKKysrIGIvb3JnLmVjbGlwc2UuamR0LmNvcmUvZG9tL29yZy9lY2xpcHNlL2pk
dC9pbnRlcm5hbC9jb3JlL2RvbS9yZXdyaXRlL0FTVFJld3JpdGVGbGF0dGVuZXIuamF2YQpAQCAt
ODE0LDYgKzgxNCw5IEBACiAJCQl2aXNpdExpc3Qobm9kZSwgU2luZ2xlVmFyaWFibGVEZWNsYXJh
dGlvbi5NT0RJRklFUlMyX1BST1BFUlRZLCBTdHJpbmcudmFsdWVPZignICcpLCBVdGlsLkVNUFRZ
X1NUUklORywgU3RyaW5nLnZhbHVlT2YoJyAnKSk7CiAJCX0KIAkJZ2V0Q2hpbGROb2RlKG5vZGUs
IFNpbmdsZVZhcmlhYmxlRGVjbGFyYXRpb24uVFlQRV9QUk9QRVJUWSkuYWNjZXB0KHRoaXMpOwor
CQlpZiAobm9kZS5nZXRBU1QoKS5hcGlMZXZlbCgpID49IEFTVC5KTFM4ICAmJiBub2RlLmlzVmFy
YXJncygpKSB7CisJCQl2aXNpdExpc3Qobm9kZSwgU2luZ2xlVmFyaWFibGVEZWNsYXJhdGlvbi5W
QVJBUkdTX0FOTk9UQVRJT05TX1BST1BFUlRZLCBTdHJpbmcudmFsdWVPZignICcpLCBVdGlsLkVN
UFRZX1NUUklORywgU3RyaW5nLnZhbHVlT2YoJyAnKSk7CisJCX0KIAkJaWYgKG5vZGUuZ2V0QVNU
KCkuYXBpTGV2ZWwoKSA+PSBKTFMzX0lOVEVSTkFMKSB7CiAJCQlpZiAoZ2V0Qm9vbGVhbkF0dHJp
YnV0ZShub2RlLCBTaW5nbGVWYXJpYWJsZURlY2xhcmF0aW9uLlZBUkFSR1NfUFJPUEVSVFkpKSB7
CiAJCQkJdGhpcy5yZXN1bHQuYXBwZW5kKCIuLi4iKTsvLyROT04tTkxTLTEk
</data>

          </attachment>
      

    </bug>

</bugzilla>