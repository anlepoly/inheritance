<?xml version="1.0" encoding="UTF-8" standalone="yes" ?>
<!DOCTYPE bugzilla SYSTEM "https://bugs.eclipse.org/bugs/page.cgi?id=bugzilla.dtd">

<bugzilla version="4.4.7"
          urlbase="https://bugs.eclipse.org/bugs/"
          
          maintainer="webmaster@eclipse.org"
>

    <bug>
          <bug_id>364672</bug_id>
          
          <creation_ts>2011-11-24 01:23:00 -0500</creation_ts>
          <short_desc>[compiler] ecj fails to compile valid calls to varargs method</short_desc>
          <delta_ts>2011-12-05 10:15:32 -0500</delta_ts>
          <reporter_accessible>1</reporter_accessible>
          <cclist_accessible>1</cclist_accessible>
          <classification_id>2</classification_id>
          <classification>Eclipse</classification>
          <product>JDT</product>
          <component>Core</component>
          <version>3.8</version>
          <rep_platform>All</rep_platform>
          <op_sys>All</op_sys>
          <bug_status>VERIFIED</bug_status>
          <resolution>FIXED</resolution>
          
          
          <bug_file_loc></bug_file_loc>
          <status_whiteboard></status_whiteboard>
          <keywords></keywords>
          <priority>P3</priority>
          <bug_severity>major</bug_severity>
          <target_milestone>3.8 M4</target_milestone>
          
          
          <everconfirmed>1</everconfirmed>
          <reporter name="Ayushman Jain">amj87.iitr</reporter>
          <assigned_to name="Srikanth Sankaran">srikanth_sankaran</assigned_to>
          <cc>Olivier_Thomann</cc>
    
    <cc>satyam.kandula</cc>
          
          <votes>0</votes>

      

      

      

          <comment_sort_order>oldest_to_newest</comment_sort_order>  
          <long_desc isprivate="0" >
    <commentid>2031253</commentid>
    <comment_count>0</comment_count>
    <who name="Ayushman Jain">amj87.iitr</who>
    <bug_when>2011-11-24 01:23:14 -0500</bug_when>
    <thetext>HEAD

X.java
---------------%&lt;--------------
package snippet;
public class X {
			private class Z {} 
			public void foo() {
					Z[] zs = null;
					Y.bar(zs, new Z());
			}
			public static void main(String[] args) {}
}

Y.java
--------------%&lt;------------------
public class Y {
			public native static &lt;T&gt; void bar(T[] t, T t1, T... t2);
}


This fails to compile after the fix for bug 346042. There are also some missing code implementation errors such as this:

public class X {
	public static final String CONSTANT = &quot;&quot;;
	private static class A {
		A(String s, String s2, String s3, A... a) {}
	}
	private static class B extends A {
		B(String s, String s2) {
			super(s, s2, CONSTANT);
		}
	}
	private static void foo(Object o, A ... a) {
	}
	private static B bar() {
		return null;
	}
	public static void main(String[] args) {
		Object o = null;
		foo(o, bar(), bar());
	}
}</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>2031312</commentid>
    <comment_count>1</comment_count>
    <who name="Srikanth Sankaran">srikanth_sankaran</who>
    <bug_when>2011-11-24 04:25:59 -0500</bug_when>
    <thetext>Fix &amp; tests released in 3.8 stream for M4 via commit id: 0cdfad471234fb0caaef062f9838420246a133df.

Many thanks to Olivier for reporting, triaging and the patch which was
released via the above commit id.

There were two problems with the fix for bug 346042. There is some code
path between method resolution and constructor resolution. The fix for
bug 346042 made some changes in the common code path and followed it up
with suitable changes on the method resolution path after they fork.
The corresponding change was missing in the constructor resolution path
after the fork resulting in one of the issues.

The other issue is due to this landmine:

org.eclipse.jdt.internal.compiler.lookup.ReferenceBinding.canBeSeenBy(PackageBinding) reads:

/**
 * Answer true if the receiver is visible to the invocationPackage.
 */
public final boolean canBeSeenBy(PackageBinding invocationPackage) {
	if (isPublic()) return true;
	if (isPrivate()) return false;

	// isProtected() or isDefault()
	return invocationPackage == this.fPackage;
}

which does patently wrong things in some cases. I&apos;ll follow up this 
with another defect to have this code investigated.</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>2031314</commentid>
    <comment_count>2</comment_count>
    <who name="Srikanth Sankaran">srikanth_sankaran</who>
    <bug_when>2011-11-24 04:29:42 -0500</bug_when>
    <thetext>(In reply to comment #1)

&gt; which does patently wrong things in some cases. I&apos;ll follow up this 
&gt; with another defect to have this code investigated.

https://bugs.eclipse.org/bugs/show_bug.cgi?id=364690 raised.</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>2035750</commentid>
    <comment_count>3</comment_count>
    <who name="Satyam Kandula">satyam.kandula</who>
    <bug_when>2011-12-05 10:15:32 -0500</bug_when>
    <thetext>Verified for 3.8M4 using build I20111202-0800</thetext>
  </long_desc>
      
      

    </bug>

</bugzilla>