<?xml version="1.0" encoding="UTF-8" standalone="yes" ?>
<!DOCTYPE bugzilla SYSTEM "https://bugs.eclipse.org/bugs/page.cgi?id=bugzilla.dtd">

<bugzilla version="4.4.7"
          urlbase="https://bugs.eclipse.org/bugs/"
          
          maintainer="webmaster@eclipse.org"
>

    <bug>
          <bug_id>416380</bug_id>
          
          <creation_ts>2013-09-02 17:33:00 -0400</creation_ts>
          <short_desc>[compiler] better error message for illegal use of regular type as an annotation</short_desc>
          <delta_ts>2014-08-06 12:30:50 -0400</delta_ts>
          <reporter_accessible>1</reporter_accessible>
          <cclist_accessible>1</cclist_accessible>
          <classification_id>2</classification_id>
          <classification>Eclipse</classification>
          <product>JDT</product>
          <component>Core</component>
          <version>4.4</version>
          <rep_platform>All</rep_platform>
          <op_sys>All</op_sys>
          <bug_status>VERIFIED</bug_status>
          <resolution>FIXED</resolution>
          
          
          <bug_file_loc></bug_file_loc>
          <status_whiteboard></status_whiteboard>
          <keywords></keywords>
          <priority>P3</priority>
          <bug_severity>minor</bug_severity>
          <target_milestone>4.5 M1</target_milestone>
          
          <blocked>441273</blocked>
          <everconfirmed>1</everconfirmed>
          <reporter name="Stephan Herrmann">stephan.herrmann</reporter>
          <assigned_to name="Jay Arthanareeswaran">jarthana</assigned_to>
          <cc>jarthana</cc>
    
    <cc>shankhba</cc>
    
    <cc>srikanth_sankaran</cc>
          
          <votes>0</votes>

      

      

      

          <comment_sort_order>oldest_to_newest</comment_sort_order>  
          <long_desc isprivate="0" >
    <commentid>2301866</commentid>
    <comment_count>0</comment_count>
    <who name="Stephan Herrmann">stephan.herrmann</who>
    <bug_when>2013-09-02 17:33:59 -0400</bug_when>
    <thetext>Consider this example:

  import java.lang.annotation.*;
  ...
  &lt;T extends Annotation&gt; String foo(@T String s) { return null; }

ecj will answer:

  &lt;T extends Annotation&gt; String foo(@T String s) { return null; }
                                     ^
  Type mismatch: cannot convert from T to Annotation

Mh, that&apos;s the wrong error to show, T *is* compatible to Annotation.

Looking at JLS 9.6:

  &quot;A consequence of the fact that an annotation type cannot explicitly declare a
   superclass or superinterface is that a subclass or subinterface of an annotation type
   is never itself an annotation type.&quot;

subtyping isn&apos;t actually the issue we&apos;re interested in. 
The thing *must be an annotation type*, and that&apos;s what ecj should complain about
(and its how the check is already implemented ...)

Not marking [1.8] since the problem already exists in master, 
although this is even more fun with JSR 308 :)</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>2428102</commentid>
    <comment_count>1</comment_count>
      <attachid>245096</attachid>
    <who name="Jay Arthanareeswaran">jarthana</who>
    <bug_when>2014-07-16 01:35:02 -0400</bug_when>
    <thetext>Created attachment 245096
New error message

(In reply to Stephan Herrmann from comment #0)
&gt; Not marking [1.8] since the problem already exists in master, 
&gt; although this is even more fun with JSR 308 :)

&quot;although this is even more fun with JSR 308 :)&quot;

Did you mean anything in particular with this? :) Or is the bug just about a new error message for this case? How about this?

    T is not an annotation type</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>2428617</commentid>
    <comment_count>2</comment_count>
    <who name="Jay Arthanareeswaran">jarthana</who>
    <bug_when>2014-07-17 02:34:54 -0400</bug_when>
    <thetext>(In reply to Jayaprakash Arthanareeswaran from comment #1)
&gt; Created attachment 245096 [details]
&gt; New error message

Released after fixing few more failing tests:

http://git.eclipse.org/c/jdt/eclipse.jdt.core.git/commit/?id=bcf624b1ce6e13e2b036810ff6dc2d3f0a5db2bf</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>2436025</commentid>
    <comment_count>3</comment_count>
    <who name="shankha banerjee">shankhba</who>
    <bug_when>2014-08-05 23:01:28 -0400</bug_when>
    <thetext>Verified for 4.5 M1 using I20140804-2000 build.</thetext>
  </long_desc>
      
          <attachment
              isobsolete="0"
              ispatch="1"
              isprivate="0"
          >
            <attachid>245096</attachid>
            <date>2014-07-16 01:35:00 -0400</date>
            <delta_ts>2014-07-16 01:35:02 -0400</delta_ts>
            <desc>New error message</desc>
            <filename>Bug-416380.patch</filename>
            <type>text/plain</type>
            <size>4470</size>
            <attacher name="Jay Arthanareeswaran">jarthana</attacher>
            
              <data encoding="base64">ZGlmZiAtLWdpdCBhL29yZy5lY2xpcHNlLmpkdC5jb3JlLnRlc3RzLmNvbXBpbGVyL3NyYy9vcmcv
ZWNsaXBzZS9qZHQvY29yZS90ZXN0cy9jb21waWxlci9yZWdyZXNzaW9uL0NvbXBpbGVySW52b2Nh
dGlvblRlc3RzLmphdmEgYi9vcmcuZWNsaXBzZS5qZHQuY29yZS50ZXN0cy5jb21waWxlci9zcmMv
b3JnL2VjbGlwc2UvamR0L2NvcmUvdGVzdHMvY29tcGlsZXIvcmVncmVzc2lvbi9Db21waWxlcklu
dm9jYXRpb25UZXN0cy5qYXZhCmluZGV4IDQ5M2Q0OTguLjVhYjJlNWMgMTAwNjQ0Ci0tLSBhL29y
Zy5lY2xpcHNlLmpkdC5jb3JlLnRlc3RzLmNvbXBpbGVyL3NyYy9vcmcvZWNsaXBzZS9qZHQvY29y
ZS90ZXN0cy9jb21waWxlci9yZWdyZXNzaW9uL0NvbXBpbGVySW52b2NhdGlvblRlc3RzLmphdmEK
KysrIGIvb3JnLmVjbGlwc2UuamR0LmNvcmUudGVzdHMuY29tcGlsZXIvc3JjL29yZy9lY2xpcHNl
L2pkdC9jb3JlL3Rlc3RzL2NvbXBpbGVyL3JlZ3Jlc3Npb24vQ29tcGlsZXJJbnZvY2F0aW9uVGVz
dHMuamF2YQpAQCAtODMzLDQgKzgzMyw1IEBACiAJCWV4cGVjdGVkUHJvYmxlbUF0dHJpYnV0ZXMu
cHV0KCJOb25TdGF0aWNPckFsaWVuVHlwZVJlY2VpdmVyIiwgbmV3IFByb2JsZW1BdHRyaWJ1dGVz
KENhdGVnb3JpemVkUHJvYmxlbS5DQVRfTUVNQkVSKSk7CiAJCWV4cGVjdGVkUHJvYmxlbUF0dHJp
YnV0ZXMucHV0KCJOb25TdGF0aWNUeXBlRnJvbVN0YXRpY0ludm9jYXRpb24iLCBuZXcgUHJvYmxl
bUF0dHJpYnV0ZXMoQ2F0ZWdvcml6ZWRQcm9ibGVtLkNBVF9JTlRFUk5BTCkpOworCQlleHBlY3Rl
ZFByb2JsZW1BdHRyaWJ1dGVzLnB1dCgiTm90QW5ub2F0aW9uVHlwZSIsIG5ldyBQcm9ibGVtQXR0
cmlidXRlcyhDYXRlZ29yaXplZFByb2JsZW0uQ0FUX1RZUEUpKTsKIAkJZXhwZWN0ZWRQcm9ibGVt
QXR0cmlidXRlcy5wdXQoIk5vdFZpc2libGVDb25zdHJ1Y3RvciIsIG5ldyBQcm9ibGVtQXR0cmli
dXRlcyhDYXRlZ29yaXplZFByb2JsZW0uQ0FUX01FTUJFUikpOwogCQlleHBlY3RlZFByb2JsZW1B
dHRyaWJ1dGVzLnB1dCgiTm90VmlzaWJsZUNvbnN0cnVjdG9ySW5EZWZhdWx0Q29uc3RydWN0b3Ii
LCBuZXcgUHJvYmxlbUF0dHJpYnV0ZXMoQ2F0ZWdvcml6ZWRQcm9ibGVtLkNBVF9NRU1CRVIpKTsK
QEAgLTE2NTMsNCArMTY1NCw1IEBACiAJCWV4cGVjdGVkUHJvYmxlbUF0dHJpYnV0ZXMucHV0KCJO
b25TdGF0aWNPckFsaWVuVHlwZVJlY2VpdmVyIiwgU0tJUCk7CiAJCWV4cGVjdGVkUHJvYmxlbUF0
dHJpYnV0ZXMucHV0KCJOb25TdGF0aWNUeXBlRnJvbVN0YXRpY0ludm9jYXRpb24iLCBTS0lQKTsK
KwkJZXhwZWN0ZWRQcm9ibGVtQXR0cmlidXRlcy5wdXQoIk5vdEFubm9hdGlvblR5cGUiLCBTS0lQ
KTsKIAkJZXhwZWN0ZWRQcm9ibGVtQXR0cmlidXRlcy5wdXQoIk5vdFZpc2libGVDb25zdHJ1Y3Rv
ciIsIFNLSVApOwogCQlleHBlY3RlZFByb2JsZW1BdHRyaWJ1dGVzLnB1dCgiTm90VmlzaWJsZUNv
bnN0cnVjdG9ySW5EZWZhdWx0Q29uc3RydWN0b3IiLCBTS0lQKTsKZGlmZiAtLWdpdCBhL29yZy5l
Y2xpcHNlLmpkdC5jb3JlL2NvbXBpbGVyL29yZy9lY2xpcHNlL2pkdC9jb3JlL2NvbXBpbGVyL0lQ
cm9ibGVtLmphdmEgYi9vcmcuZWNsaXBzZS5qZHQuY29yZS9jb21waWxlci9vcmcvZWNsaXBzZS9q
ZHQvY29yZS9jb21waWxlci9JUHJvYmxlbS5qYXZhCmluZGV4IDBmMTcxM2EuLmI4NGU1ZTQgMTAw
NjQ0Ci0tLSBhL29yZy5lY2xpcHNlLmpkdC5jb3JlL2NvbXBpbGVyL29yZy9lY2xpcHNlL2pkdC9j
b3JlL2NvbXBpbGVyL0lQcm9ibGVtLmphdmEKKysrIGIvb3JnLmVjbGlwc2UuamR0LmNvcmUvY29t
cGlsZXIvb3JnL2VjbGlwc2UvamR0L2NvcmUvY29tcGlsZXIvSVByb2JsZW0uamF2YQpAQCAtNDAz
LDQgKzQwMyw2IEBACiAJLyoqIEBzaW5jZSAzLjMgKi8KIAlpbnQgVHlwZUhpZGluZ1R5cGUgPSBU
eXBlUmVsYXRlZCArIDMzOworCS8qKiBAc2luY2UgMy4xMSAqLworCWludCBOb3RBbm5vYXRpb25U
eXBlID0gVHlwZVJlbGF0ZWQgKyAzNDsKIAogCS8vIHZhcmlhYmxlcwpkaWZmIC0tZ2l0IGEvb3Jn
LmVjbGlwc2UuamR0LmNvcmUvY29tcGlsZXIvb3JnL2VjbGlwc2UvamR0L2ludGVybmFsL2NvbXBp
bGVyL2FzdC9Bbm5vdGF0aW9uLmphdmEgYi9vcmcuZWNsaXBzZS5qZHQuY29yZS9jb21waWxlci9v
cmcvZWNsaXBzZS9qZHQvaW50ZXJuYWwvY29tcGlsZXIvYXN0L0Fubm90YXRpb24uamF2YQppbmRl
eCBiODY2ZmIxLi40ZDE5MDRmIDEwMDY0NAotLS0gYS9vcmcuZWNsaXBzZS5qZHQuY29yZS9jb21w
aWxlci9vcmcvZWNsaXBzZS9qZHQvaW50ZXJuYWwvY29tcGlsZXIvYXN0L0Fubm90YXRpb24uamF2
YQorKysgYi9vcmcuZWNsaXBzZS5qZHQuY29yZS9jb21waWxlci9vcmcvZWNsaXBzZS9qZHQvaW50
ZXJuYWwvY29tcGlsZXIvYXN0L0Fubm90YXRpb24uamF2YQpAQCAtNzk4LDUgKzc5OCw1IEBACiAJ
CS8vIGVuc3VyZSB0eXBlIHJlZmVycyB0byBhbiBhbm5vdGF0aW9uIHR5cGUKIAkJaWYgKCF0eXBl
QmluZGluZy5pc0Fubm90YXRpb25UeXBlKCkgJiYgdHlwZUJpbmRpbmcuaXNWYWxpZEJpbmRpbmco
KSkgewotCQkJc2NvcGUucHJvYmxlbVJlcG9ydGVyKCkudHlwZU1pc21hdGNoRXJyb3IodHlwZUJp
bmRpbmcsIHNjb3BlLmdldEphdmFMYW5nQW5ub3RhdGlvbkFubm90YXRpb24oKSwgdGhpcy50eXBl
LCBudWxsKTsKKwkJCXNjb3BlLnByb2JsZW1SZXBvcnRlcigpLm5vdEFubm90YXRpb25UeXBlKHR5
cGVCaW5kaW5nLCB0aGlzLnR5cGUpOwogCQkJcmV0dXJuIG51bGw7CiAJCX0KZGlmZiAtLWdpdCBh
L29yZy5lY2xpcHNlLmpkdC5jb3JlL2NvbXBpbGVyL29yZy9lY2xpcHNlL2pkdC9pbnRlcm5hbC9j
b21waWxlci9wcm9ibGVtL1Byb2JsZW1SZXBvcnRlci5qYXZhIGIvb3JnLmVjbGlwc2UuamR0LmNv
cmUvY29tcGlsZXIvb3JnL2VjbGlwc2UvamR0L2ludGVybmFsL2NvbXBpbGVyL3Byb2JsZW0vUHJv
YmxlbVJlcG9ydGVyLmphdmEKaW5kZXggZDQzODBmNS4uYjk0OGI5MSAxMDA2NDQKLS0tIGEvb3Jn
LmVjbGlwc2UuamR0LmNvcmUvY29tcGlsZXIvb3JnL2VjbGlwc2UvamR0L2ludGVybmFsL2NvbXBp
bGVyL3Byb2JsZW0vUHJvYmxlbVJlcG9ydGVyLmphdmEKKysrIGIvb3JnLmVjbGlwc2UuamR0LmNv
cmUvY29tcGlsZXIvb3JnL2VjbGlwc2UvamR0L2ludGVybmFsL2NvbXBpbGVyL3Byb2JsZW0vUHJv
YmxlbVJlcG9ydGVyLmphdmEKQEAgLTc4MDcsNCArNzgwNywxMiBAQAogCQl0eXBlUGFyYW0uc291
cmNlRW5kKTsKIH0KK3B1YmxpYyB2b2lkIG5vdEFubm90YXRpb25UeXBlKFR5cGVCaW5kaW5nIGFj
dHVhbFR5cGUsIEFTVE5vZGUgbG9jYXRpb24pIHsKKwl0aGlzLmhhbmRsZSgKKwkJCUlQcm9ibGVt
Lk5vdEFubm9hdGlvblR5cGUsCisJCQluZXcgU3RyaW5nW10ge25ldyBTdHJpbmcoYWN0dWFsVHlw
ZS5sZWFmQ29tcG9uZW50VHlwZSgpLnJlYWRhYmxlTmFtZSgpKX0sCisJCQluZXcgU3RyaW5nW10g
e25ldyBTdHJpbmcoYWN0dWFsVHlwZS5sZWFmQ29tcG9uZW50VHlwZSgpLnNob3J0UmVhZGFibGVO
YW1lKCkpfSwKKwkJCWxvY2F0aW9uLnNvdXJjZVN0YXJ0LAorCQkJbG9jYXRpb24uc291cmNlRW5k
KTsKK30KIHB1YmxpYyB2b2lkIHR5cGVNaXNtYXRjaEVycm9yKFR5cGVCaW5kaW5nIGFjdHVhbFR5
cGUsIFR5cGVCaW5kaW5nIGV4cGVjdGVkVHlwZSwgQVNUTm9kZSBsb2NhdGlvbiwgQVNUTm9kZSBl
eHBlY3RpbmdMb2NhdGlvbikgewogCWlmICh0aGlzLm9wdGlvbnMuc291cmNlTGV2ZWwgPCBDbGFz
c0ZpbGVDb25zdGFudHMuSkRLMV81KSB7IC8vIGRvbid0IGV4cG9zZSB0eXBlIHZhcmlhYmxlIG5h
bWVzLCBjb21wbGFpbiBvbiBlcmFzZWQgdHlwZXMKZGlmZiAtLWdpdCBhL29yZy5lY2xpcHNlLmpk
dC5jb3JlL2NvbXBpbGVyL29yZy9lY2xpcHNlL2pkdC9pbnRlcm5hbC9jb21waWxlci9wcm9ibGVt
L21lc3NhZ2VzLnByb3BlcnRpZXMgYi9vcmcuZWNsaXBzZS5qZHQuY29yZS9jb21waWxlci9vcmcv
ZWNsaXBzZS9qZHQvaW50ZXJuYWwvY29tcGlsZXIvcHJvYmxlbS9tZXNzYWdlcy5wcm9wZXJ0aWVz
CmluZGV4IDM2ZGFlNDMuLjliYjFkMTYgMTAwNjQ0Ci0tLSBhL29yZy5lY2xpcHNlLmpkdC5jb3Jl
L2NvbXBpbGVyL29yZy9lY2xpcHNlL2pkdC9pbnRlcm5hbC9jb21waWxlci9wcm9ibGVtL21lc3Nh
Z2VzLnByb3BlcnRpZXMKKysrIGIvb3JnLmVjbGlwc2UuamR0LmNvcmUvY29tcGlsZXIvb3JnL2Vj
bGlwc2UvamR0L2ludGVybmFsL2NvbXBpbGVyL3Byb2JsZW0vbWVzc2FnZXMucHJvcGVydGllcwpA
QCAtNzUsNCArNzUsNSBAQAogMzIgPSBUaGUgbWVtYmVyIGVudW0gezB9IG11c3QgYmUgZGVmaW5l
ZCBpbnNpZGUgYSBzdGF0aWMgbWVtYmVyIHR5cGUKIDMzID0gVGhlIHR5cGUgezB9IGlzIGhpZGlu
ZyB0aGUgdHlwZSB7MX0KKzM0ID0gezB9IGlzIG5vdCBhbiBhbm5vdGF0aW9uIHR5cGUKIAogNTAg
PSB7MH0gY2Fubm90IGJlIHJlc29sdmVk
</data>

          </attachment>
      

    </bug>

</bugzilla>