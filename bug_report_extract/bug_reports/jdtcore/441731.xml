<?xml version="1.0" encoding="UTF-8" standalone="yes" ?>
<!DOCTYPE bugzilla SYSTEM "https://bugs.eclipse.org/bugs/page.cgi?id=bugzilla.dtd">

<bugzilla version="4.4.7"
          urlbase="https://bugs.eclipse.org/bugs/"
          
          maintainer="webmaster@eclipse.org"
>

    <bug>
          <bug_id>441731</bug_id>
          
          <creation_ts>2014-08-13 15:49:00 -0400</creation_ts>
          <short_desc>JDT reports unnecessary cast, using the Quickfix to remove it creates syntax error</short_desc>
          <delta_ts>2014-10-28 06:12:21 -0400</delta_ts>
          <reporter_accessible>1</reporter_accessible>
          <cclist_accessible>1</cclist_accessible>
          <classification_id>2</classification_id>
          <classification>Eclipse</classification>
          <product>JDT</product>
          <component>Core</component>
          <version>4.4</version>
          <rep_platform>All</rep_platform>
          <op_sys>All</op_sys>
          <bug_status>VERIFIED</bug_status>
          <resolution>FIXED</resolution>
          
          
          <bug_file_loc></bug_file_loc>
          <status_whiteboard></status_whiteboard>
          <keywords></keywords>
          <priority>P3</priority>
          <bug_severity>normal</bug_severity>
          <target_milestone>4.5 M3</target_milestone>
          
          
          <everconfirmed>1</everconfirmed>
          <reporter name="Lars Vogel">lars.vogel</reporter>
          <assigned_to name="Sasikanth Bharadwaj">saammana</assigned_to>
          <cc>daniel_megert</cc>
    
    <cc>jarthana</cc>
    
    <cc>manpalat</cc>
    
    <cc>noopur_gupta</cc>
    
    <cc>srikanth_sankaran</cc>
    
    <cc>stephan.herrmann</cc>
          
          <votes>0</votes>

      

      

      <flag name="review"
          id="63590"
          type_id="1"
          status="+"
          setter="srikanth_sankaran"
    />

          <comment_sort_order>oldest_to_newest</comment_sort_order>  
          <long_desc isprivate="0" >
    <commentid>2438726</commentid>
    <comment_count>0</comment_count>
    <who name="Lars Vogel">lars.vogel</who>
    <bug_when>2014-08-13 15:49:44 -0400</bug_when>
    <thetext>In org.eclipse.e4.ui.workbench.renderers.swt.WBWRenderer I see the following code:

public void processContents(MElementContainer&lt;MUIElement&gt; me) {
		if (!(((MUIElement) me) instanceof MWindow))
			return;
...more
}

JDT marks (MUIElement) me as unnecessary cast but if I remove this cast, I get an syntax error. 

Is this a wrong warning message?</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>2438856</commentid>
    <comment_count>1</comment_count>
    <who name="Noopur Gupta">noopur_gupta</who>
    <bug_when>2014-08-14 02:10:20 -0400</bug_when>
    <thetext>Note that there is no warning message on the next line:
MWindow wbwModel = (MWindow) ((MUIElement) me);

Moving to JDT/Core for comments on the warning.</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>2438962</commentid>
    <comment_count>2</comment_count>
    <who name="Jay Arthanareeswaran">jarthana</who>
    <bug_when>2014-08-14 06:07:03 -0400</bug_when>
    <thetext>(In reply to Noopur Gupta from comment #1)
&gt; Note that there is no warning message on the next line:
&gt; MWindow wbwModel = (MWindow) ((MUIElement) me);
&gt; 
&gt; Moving to JDT/Core for comments on the warning.

Had a quick look and the only reason that line got away was (not rightly, though) is because of this line:

if (this.expression instanceof CastExpression) {
		this.expression.bits |= ASTNode.DisableUnnecessaryCastCheck;
		exprContainCast = true;
	}


Stephan, got some clue?</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>2443514</commentid>
    <comment_count>3</comment_count>
    <who name="Srikanth Sankaran">srikanth_sankaran</who>
    <bug_when>2014-08-26 08:01:30 -0400</bug_when>
    <thetext>Sasi, this would be a good one to work on.</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>2460886</commentid>
    <comment_count>4</comment_count>
      <attachid>247671</attachid>
    <who name="Sasikanth Bharadwaj">saammana</who>
    <bug_when>2014-10-07 06:10:40 -0400</bug_when>
    <thetext>Created attachment 247671
Proposed fix and test</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>2460891</commentid>
    <comment_count>5</comment_count>
    <who name="Sasikanth Bharadwaj">saammana</who>
    <bug_when>2014-10-07 06:14:46 -0400</bug_when>
    <thetext>CastExpression.checkUnsafeCast() tags the cast as unnecessary based on the fact that the match and cast type are one and the same. Tightened this check to do the tagging only if the expression type is not provably distinct from cast type for parameterized types.
Srikanth, please review. All tests pass</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>2464534</commentid>
    <comment_count>6</comment_count>
    <who name="Srikanth Sankaran">srikanth_sankaran</who>
    <bug_when>2014-10-14 06:09:22 -0400</bug_when>
    <thetext>Looks good. Please go ahead and release and resolve Sasi. Thanks.</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>2465397</commentid>
    <comment_count>7</comment_count>
    <who name="Sasikanth Bharadwaj">saammana</who>
    <bug_when>2014-10-15 07:04:20 -0400</bug_when>
    <thetext>Fix and test released via http://git.eclipse.org/c/jdt/eclipse.jdt.core.git/commit/?id=fa93f38829626102128c1414c7fc758c38fc404d</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>2472845</commentid>
    <comment_count>8</comment_count>
    <who name="Manoj Palat Away Until May 11 2015">manpalat</who>
    <bug_when>2014-10-28 06:12:21 -0400</bug_when>
    <thetext>Verified for Eclipse Mars 4.5M3 Build id: I20141027-2000</thetext>
  </long_desc>
      
          <attachment
              isobsolete="0"
              ispatch="1"
              isprivate="0"
          >
            <attachid>247671</attachid>
            <date>2014-10-07 06:10:00 -0400</date>
            <delta_ts>2014-10-07 06:10:40 -0400</delta_ts>
            <desc>Proposed fix and test</desc>
            <filename>fix-and-test-for-bug441731.patch</filename>
            <type>text/plain</type>
            <size>2594</size>
            <attacher name="Sasikanth Bharadwaj">saammana</attacher>
            
              <data encoding="base64">ZGlmZiAtLWdpdCBhL29yZy5lY2xpcHNlLmpkdC5jb3JlLnRlc3RzLmNvbXBpbGVyL3NyYy9vcmcv
ZWNsaXBzZS9qZHQvY29yZS90ZXN0cy9jb21waWxlci9yZWdyZXNzaW9uL0Nhc3RUZXN0LmphdmEg
Yi9vcmcuZWNsaXBzZS5qZHQuY29yZS50ZXN0cy5jb21waWxlci9zcmMvb3JnL2VjbGlwc2UvamR0
L2NvcmUvdGVzdHMvY29tcGlsZXIvcmVncmVzc2lvbi9DYXN0VGVzdC5qYXZhCmluZGV4IDcwZTNl
MWQuLjUzMjFhY2UgMTAwNjQ0Ci0tLSBhL29yZy5lY2xpcHNlLmpkdC5jb3JlLnRlc3RzLmNvbXBp
bGVyL3NyYy9vcmcvZWNsaXBzZS9qZHQvY29yZS90ZXN0cy9jb21waWxlci9yZWdyZXNzaW9uL0Nh
c3RUZXN0LmphdmEKKysrIGIvb3JnLmVjbGlwc2UuamR0LmNvcmUudGVzdHMuY29tcGlsZXIvc3Jj
L29yZy9lY2xpcHNlL2pkdC9jb3JlL3Rlc3RzL2NvbXBpbGVyL3JlZ3Jlc3Npb24vQ2FzdFRlc3Qu
amF2YQpAQCAtMzA5Myw2ICszMDkzLDI4IEBACiAJfQogfQogCisvLyBodHRwczovL2J1Z3MuZWNs
aXBzZS5vcmcvYnVncy9zaG93X2J1Zy5jZ2k/aWQ9NDQxNzMxIEpEVCByZXBvcnRzIHVubmVjZXNz
YXJ5IGNhc3QsIHVzaW5nIHRoZSBRdWlja2ZpeCB0byByZW1vdmUgaXQgY3JlYXRlcyBzeW50YXgg
ZXJyb3IKK3B1YmxpYyB2b2lkIHRlc3Q0NDE3MzEoKSB7CisJaWYgKHRoaXMuY29tcGxpYW5jZUxl
dmVsIDwgQ2xhc3NGaWxlQ29uc3RhbnRzLkpESzFfNSkKKwkJcmV0dXJuOworCU1hcCBjdXN0b21P
cHRpb25zID0gZ2V0Q29tcGlsZXJPcHRpb25zKCk7CisJY3VzdG9tT3B0aW9ucy5wdXQoQ29tcGls
ZXJPcHRpb25zLk9QVElPTl9SZXBvcnRVbm5lY2Vzc2FyeVR5cGVDaGVjaywgQ29tcGlsZXJPcHRp
b25zLkVSUk9SKTsKKwl0aGlzLnJ1bkNvbmZvcm1UZXN0KAorCQluZXcgU3RyaW5nW10geworCQkJ
IlguamF2YSIsCisJCQkiaW50ZXJmYWNlIE1VSUVsZW1lbnQge31cbiIgKyAKKwkJCSJpbnRlcmZh
Y2UgTVVJRWxlbWVudENvbnRhaW5lcjxUIGV4dGVuZHMgTVVJRWxlbWVudD4gZXh0ZW5kcyBNVUlF
bGVtZW50e31cbiIgKyAKKwkJCSJpbnRlcmZhY2UgTVdpbmRvd0VsZW1lbnQgZXh0ZW5kcyBNVUlF
bGVtZW50IHt9XG4iICsgCisJCQkiaW50ZXJmYWNlIE1XaW5kb3cgZXh0ZW5kcyBNVUlFbGVtZW50
Q29udGFpbmVyPE1XaW5kb3dFbGVtZW50PiB7fVxuIiArIAorCQkJInB1YmxpYyBjbGFzcyBYIHtc
biIgKyAKKwkJCSIJdm9pZCB0ZXN0KE1VSUVsZW1lbnRDb250YWluZXI8TVVJRWxlbWVudD4gbWUp
IHtcbiIgKyAKKwkJCSIJCWlmKCgoTVVJRWxlbWVudCkgbWUpIGluc3RhbmNlb2YgTVdpbmRvdykg
cmV0dXJuO1xuIiArIAorCQkJIgkJTVdpbmRvdyBtdyA9IChNV2luZG93KSgoTVVJRWxlbWVudClt
ZSk7XG4iICsgCisJCQkiCX1cbiIgKyAKKwkJCSJ9XG4iCisJCX0sCisJCWN1c3RvbU9wdGlvbnMp
OworfQogcHVibGljIHN0YXRpYyBDbGFzcyB0ZXN0Q2xhc3MoKSB7CiAJcmV0dXJuIENhc3RUZXN0
LmNsYXNzOwogfQpkaWZmIC0tZ2l0IGEvb3JnLmVjbGlwc2UuamR0LmNvcmUvY29tcGlsZXIvb3Jn
L2VjbGlwc2UvamR0L2ludGVybmFsL2NvbXBpbGVyL2FzdC9DYXN0RXhwcmVzc2lvbi5qYXZhIGIv
b3JnLmVjbGlwc2UuamR0LmNvcmUvY29tcGlsZXIvb3JnL2VjbGlwc2UvamR0L2ludGVybmFsL2Nv
bXBpbGVyL2FzdC9DYXN0RXhwcmVzc2lvbi5qYXZhCmluZGV4IDhmNjM4ZDguLmFiZjkyZDcgMTAw
NjQ0Ci0tLSBhL29yZy5lY2xpcHNlLmpkdC5jb3JlL2NvbXBpbGVyL29yZy9lY2xpcHNlL2pkdC9p
bnRlcm5hbC9jb21waWxlci9hc3QvQ2FzdEV4cHJlc3Npb24uamF2YQorKysgYi9vcmcuZWNsaXBz
ZS5qZHQuY29yZS9jb21waWxlci9vcmcvZWNsaXBzZS9qZHQvaW50ZXJuYWwvY29tcGlsZXIvYXN0
L0Nhc3RFeHByZXNzaW9uLmphdmEKQEAgLTMyMiw3ICszMjIsOCBAQAogCiBwdWJsaWMgYm9vbGVh
biBjaGVja1Vuc2FmZUNhc3QoU2NvcGUgc2NvcGUsIFR5cGVCaW5kaW5nIGNhc3RUeXBlLCBUeXBl
QmluZGluZyBleHByZXNzaW9uVHlwZSwgVHlwZUJpbmRpbmcgbWF0Y2gsIGJvb2xlYW4gaXNOYXJy
b3dpbmcpIHsKIAlpZiAoVHlwZUJpbmRpbmcuZXF1YWxzRXF1YWxzKG1hdGNoLCBjYXN0VHlwZSkp
IHsKLQkJaWYgKCFpc05hcnJvd2luZyAmJiBUeXBlQmluZGluZy5lcXVhbHNFcXVhbHMobWF0Y2gs
IHRoaXMucmVzb2x2ZWRUeXBlLmxlYWZDb21wb25lbnRUeXBlKCkpKSB7IC8vIGRvIG5vdCB0YWcg
YXMgdW5uZWNlc3Nhcnkgd2hlbiByZWN1cnNpbmcgdGhyb3VnaCB1cHBlciBib3VuZHMKKwkJaWYg
KCFpc05hcnJvd2luZyAmJiBUeXBlQmluZGluZy5lcXVhbHNFcXVhbHMobWF0Y2gsIHRoaXMucmVz
b2x2ZWRUeXBlLmxlYWZDb21wb25lbnRUeXBlKCkpIC8vIGRvIG5vdCB0YWcgYXMgdW5uZWNlc3Nh
cnkgd2hlbiByZWN1cnNpbmcgdGhyb3VnaCB1cHBlciBib3VuZHMKKwkJCQkmJiAhKGV4cHJlc3Np
b25UeXBlLmlzUGFyYW1ldGVyaXplZFR5cGUoKSAmJiBleHByZXNzaW9uVHlwZS5pc1Byb3ZhYmx5
RGlzdGluY3QoY2FzdFR5cGUpKSkgewogCQkJdGFnQXNVbm5lY2Vzc2FyeUNhc3Qoc2NvcGUsIGNh
c3RUeXBlKTsKIAkJfQogCQlyZXR1cm4gdHJ1ZTs=
</data>

          </attachment>
      

    </bug>

</bugzilla>