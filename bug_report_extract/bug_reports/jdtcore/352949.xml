<?xml version="1.0" encoding="UTF-8" standalone="yes" ?>
<!DOCTYPE bugzilla SYSTEM "https://bugs.eclipse.org/bugs/page.cgi?id=bugzilla.dtd">

<bugzilla version="4.4.7"
          urlbase="https://bugs.eclipse.org/bugs/"
          
          maintainer="webmaster@eclipse.org"
>

    <bug>
          <bug_id>352949</bug_id>
          
          <creation_ts>2011-07-24 10:26:00 -0400</creation_ts>
          <short_desc>Impossible to process package-level annotations with an AnnotationProcessor</short_desc>
          <delta_ts>2012-04-30 05:17:48 -0400</delta_ts>
          <reporter_accessible>1</reporter_accessible>
          <cclist_accessible>1</cclist_accessible>
          <classification_id>2</classification_id>
          <classification>Eclipse</classification>
          <product>JDT</product>
          <component>APT</component>
          <version>3.7</version>
          <rep_platform>PC</rep_platform>
          <op_sys>Windows 7</op_sys>
          <bug_status>VERIFIED</bug_status>
          <resolution>FIXED</resolution>
          
          
          <bug_file_loc></bug_file_loc>
          <status_whiteboard></status_whiteboard>
          <keywords></keywords>
          <priority>P3</priority>
          <bug_severity>normal</bug_severity>
          <target_milestone>3.8 M7</target_milestone>
          
          
          <everconfirmed>1</everconfirmed>
          <reporter name="Yves Bontemps">yves_bontemps</reporter>
          <assigned_to name="Satyam Kandula">satyam.kandula</assigned_to>
          <cc>eclipse</cc>
    
    <cc>markus_keller</cc>
    
    <cc>Olivier_Thomann</cc>
    
    <cc>satyam.kandula</cc>
    
    <cc>srikanth_sankaran</cc>
          
          <votes>0</votes>

      

      

      <flag name="review"
          id="50416"
          type_id="1"
          status="+"
          setter="eclipse"
    />

          <comment_sort_order>oldest_to_newest</comment_sort_order>  
          <long_desc isprivate="0" >
    <commentid>1969261</commentid>
    <comment_count>0</comment_count>
    <who name="Yves Bontemps">yves_bontemps</who>
    <bug_when>2011-07-24 10:26:34 -0400</bug_when>
    <thetext>Build Identifier: 20110615-0604

In org.eclipse.jdt.apt.core.internal.util.Factory#createDeclaration, there is no case statement to handle the case where the binding is a Package.  

The consequence is that an AnnotationProcessor contributed via the annotationProcessorFactory extension point will crash whenever there are package-level annotations (provided via a package-info.java file, typically).


Reproducible: Always

Steps to Reproduce:
1. Create a package-level annotation type
2. Create and contribute an AnnotationProcessor (via the org.eclipse.jdt.apt.core.annotationProcessorFactory extension point) that simply enumerates all the annotated types in the current environment.
3. Start a debug workbench and set it up to use your annotation processor.
4. Create a java project and annotate a package in it with a package-info.java file.

When building the project, the annotation processor crashes (see attached stack trace)</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>1969262</commentid>
    <comment_count>1</comment_count>
      <attachid>200242</attachid>
    <who name="Yves Bontemps">yves_bontemps</who>
    <bug_when>2011-07-24 10:28:13 -0400</bug_when>
    <thetext>Created attachment 200242
Stack trace</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>1969273</commentid>
    <comment_count>2</comment_count>
    <who name="Walter Harley">eclipse</who>
    <bug_when>2011-07-24 12:24:30 -0400</bug_when>
    <thetext>Package-level annotations actually present quite a few problems; because of the way they were specified, there is no way to write an efficient processor that uses them in an incremental compilation situation. (Basically, the compiler can&apos;t tell if a package-level annotation exists without searching every element in every fragment of the package, across the entire classpath including jars. In general package-info.java won&apos;t have changed in a given compilation, so it won&apos;t be recompiled, so it&apos;s invisible without a search.)

But that doesn&apos;t excuse the crash! Thanks for the clear report; I&apos;ll try to get this fixed in 3.7.1.</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>1979413</commentid>
    <comment_count>3</comment_count>
    <who name="Olivier Thomann">Olivier_Thomann</who>
    <bug_when>2011-08-16 11:23:04 -0400</bug_when>
    <thetext>Moving to 3.7.2 once available. Too late for 3.7.1 given that there is no patch attached to it.</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>2046819</commentid>
    <comment_count>4</comment_count>
    <who name="Markus Keller">markus_keller</who>
    <bug_when>2012-01-05 14:36:11 -0500</bug_when>
    <thetext>Assigning a target milestone to at least fix the crash for 3.8.</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>2047186</commentid>
    <comment_count>5</comment_count>
    <who name="Olivier Thomann">Olivier_Thomann</who>
    <bug_when>2012-01-06 10:28:13 -0500</bug_when>
    <thetext>Yves, could you please provide a test case that will help us to recreate the issue?
Thanks.</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>2082960</commentid>
    <comment_count>6</comment_count>
    <who name="Srikanth Sankaran">srikanth_sankaran</who>
    <bug_when>2012-03-20 02:14:51 -0400</bug_when>
    <thetext>(In reply to comment #5)
&gt; Yves, could you please provide a test case that will help us to recreate the
&gt; issue?

Any update on this request Yves ? Thanks.</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>2083223</commentid>
    <comment_count>7</comment_count>
    <who name="Srikanth Sankaran">srikanth_sankaran</who>
    <bug_when>2012-03-20 11:32:59 -0400</bug_when>
    <thetext>If you plan to include a fix for this in 3.8 M7, please adjust the
target suitably, so it becomes easier to track.</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>2098843</commentid>
    <comment_count>8</comment_count>
      <attachid>214597</attachid>
    <who name="Satyam Kandula">satyam.kandula</who>
    <bug_when>2012-04-26 09:01:08 -0400</bug_when>
    <thetext>Created attachment 214597
Patch to fix the exception

Here is a simple patch to just fix the exception during the processing of the annotations.
apt.exe is returning null for the call to getDeclarationsAnnotatedWith() even when the processing file is just package-info.java. Hence, this patch does the same - better than throwing an exception.</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>2098846</commentid>
    <comment_count>9</comment_count>
      <attachid>214599</attachid>
    <who name="Satyam Kandula">satyam.kandula</who>
    <bug_when>2012-04-26 09:05:50 -0400</bug_when>
    <thetext>Created attachment 214599
Patch to support annotations on package.

This is a better patch which tries to imitate &apos;apt&apos; much more further. This still doesn&apos;t fix getDeclarationsAnnotatedWith() to return package-info, but handles getPackage() and getAnnotationMirrors() on the package better.</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>2098856</commentid>
    <comment_count>10</comment_count>
    <who name="Satyam Kandula">satyam.kandula</who>
    <bug_when>2012-04-26 09:11:51 -0400</bug_when>
    <thetext>Walter, M7 is next week and we better fix this bug by this week. Sorry for pushing it so late :(. I have included here two patches. If you have sufficient time, can you look at both the patches and give your comments. We can try to give a better support in M7 if we can manage it. 
If you don&apos;t have time, please spare little time :) and do a quick check for the patch in comment 8 (Patch to fix the exception) and see if this is is good enough for 3.8. We could take care of a better fix in 3.9.  Thanks in advance.</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>2099242</commentid>
    <comment_count>11</comment_count>
    <who name="Walter Harley">eclipse</who>
    <bug_when>2012-04-26 18:20:41 -0400</bug_when>
    <thetext>Apologies for slow response - will look these over tomorrow (Friday).</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>2099968</commentid>
    <comment_count>12</comment_count>
    <who name="Walter Harley">eclipse</who>
    <bug_when>2012-04-27 19:29:53 -0400</bug_when>
    <thetext>The patch to fix the exception looks good.  

I glanced over the patch to add real support and I don&apos;t see anything wrong with it, but I probably would need to spend more time than I did to add much value.</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>2099987</commentid>
    <comment_count>13</comment_count>
    <who name="Satyam Kandula">satyam.kandula</who>
    <bug_when>2012-04-28 01:12:11 -0400</bug_when>
    <thetext>(In reply to comment #12)
&gt; The patch to fix the exception looks good.
&gt; 
&gt; I glanced over the patch to add real support and I don&apos;t see anything wrong
&gt; with it, but I probably would need to spend more time than I did to add much
&gt; value.
Walter, Thanks for your comments. Filed bug 377990 to support the package-level annotation in detail.</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>2099988</commentid>
    <comment_count>14</comment_count>
    <who name="Satyam Kandula">satyam.kandula</who>
    <bug_when>2012-04-28 01:13:33 -0400</bug_when>
    <thetext>Released the &apos;patch to fix the exception&apos; using commit b308074bc5b31f3a5857e47f87565296fbba4a15.</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>2100328</commentid>
    <comment_count>15</comment_count>
    <who name="Srikanth Sankaran">srikanth_sankaran</who>
    <bug_when>2012-04-30 05:17:48 -0400</bug_when>
    <thetext>Verified for 3.8 M7 using build id: I20120429-2000</thetext>
  </long_desc>
      
          <attachment
              isobsolete="0"
              ispatch="0"
              isprivate="0"
          >
            <attachid>200242</attachid>
            <date>2011-07-24 10:28:00 -0400</date>
            <delta_ts>2011-07-24 10:28:13 -0400</delta_ts>
            <desc>Stack trace</desc>
            <filename>stacktrace-package-level-annot.log</filename>
            <type>application/octet-stream</type>
            <size>4275</size>
            <attacher name="Yves Bontemps">yves_bontemps</attacher>
            
              <data encoding="base64">ZWNsaXBzZS5idWlsZElkPUkyMDExMDYxMy0xNzM2DQpqYXZhLnZlcnNpb249MS42LjBfMjYNCmph
dmEudmVuZG9yPVN1biBNaWNyb3N5c3RlbXMgSW5jLg0KQm9vdExvYWRlciBjb25zdGFudHM6IE9T
PXdpbjMyLCBBUkNIPXg4Nl82NCwgV1M9d2luMzIsIE5MPWZyX0JFDQpGcmFtZXdvcmsgYXJndW1l
bnRzOiAgLXByb2R1Y3Qgb3JnLmVjbGlwc2UucGxhdGZvcm0uaWRlDQpDb21tYW5kLWxpbmUgYXJn
dW1lbnRzOiAgLXByb2R1Y3Qgb3JnLmVjbGlwc2UucGxhdGZvcm0uaWRlIC1kYXRhIEM6XFVzZXJz
XFl2ZXNcd29ya3NwYWNlLy4uL3J1bnRpbWUtRWNsaXBzZUFwcGxpY2F0aW9uIC1kZXYgZmlsZTpD
Oi9Vc2Vycy9ZdmVzL3dvcmtzcGFjZS8ubWV0YWRhdGEvLnBsdWdpbnMvb3JnLmVjbGlwc2UucGRl
LmNvcmUvRWNsaXBzZSBBcHBsaWNhdGlvbi9kZXYucHJvcGVydGllcyAtb3Mgd2luMzIgLXdzIHdp
bjMyIC1hcmNoIHg4Nl82NCAtY29uc29sZUxvZw0KDQpXYXJuaW5nDQpTdW4gSnVsIDI0IDE2OjI1
OjI1IENFU1QgMjAxMQ0KVW5leHBlY3RlZCBmYWlsdXJlIHJ1bm5pbmcgQVBUIG9uIHRoZSBmaWxl
KHMpOiBwYWNrYWdlLWluZm8uamF2YQ0KDQpqYXZhLmxhbmcuSWxsZWdhbFN0YXRlRXhjZXB0aW9u
OiBmYWlsZWQgdG8gY3JlYXRlIGRlY2xhcmF0aW9uIGZyb20gcGFja2FnZSB0ZXN0LnBhY2sNCglh
dCBvcmcuZWNsaXBzZS5qZHQuYXB0LmNvcmUuaW50ZXJuYWwudXRpbC5GYWN0b3J5LmNyZWF0ZURl
Y2xhcmF0aW9uKEZhY3RvcnkuamF2YToxMTIpDQoJYXQgb3JnLmVjbGlwc2UuamR0LmFwdC5jb3Jl
LmludGVybmFsLmVudi5CYXNlUHJvY2Vzc29yRW52LmdldERlY2xhcmF0aW9ucyhCYXNlUHJvY2Vz
c29yRW52LmphdmE6Mzc0KQ0KCWF0IG9yZy5lY2xpcHNlLmpkdC5hcHQuY29yZS5pbnRlcm5hbC5l
bnYuQmFzZVByb2Nlc3NvckVudi5nZXREZWNsYXJhdGlvbnNBbm5vdGF0ZWRXaXRoKEJhc2VQcm9j
ZXNzb3JFbnYuamF2YTozMDUpDQoJYXQgb3JnLmVjbGlwc2UuamR0LmFwdC5jb3JlLmludGVybmFs
LmVudi5CYXNlUHJvY2Vzc29yRW52LmdldERlY2xhcmF0aW9uc0Fubm90YXRlZFdpdGgoQmFzZVBy
b2Nlc3NvckVudi5qYXZhOjI3OSkNCglhdCBjb20uYm9udGVtcHMuYW5ub3RhdGlvbi5wcm9jZXNz
b3IuTXlGYWN0b3J5JE15UHJvY2Vzc29yLnByb2Nlc3MoTXlGYWN0b3J5LmphdmE6NTkpDQoJYXQg
b3JnLmVjbGlwc2UuamR0LmFwdC5jb3JlLmludGVybmFsLkFQVERpc3BhdGNoUnVubmFibGUuZGlz
cGF0Y2hUb0ZpbGVCYXNlZFByb2Nlc3NvcihBUFREaXNwYXRjaFJ1bm5hYmxlLmphdmE6NjU2KQ0K
CWF0IG9yZy5lY2xpcHNlLmpkdC5hcHQuY29yZS5pbnRlcm5hbC5BUFREaXNwYXRjaFJ1bm5hYmxl
LnJ1bkFQVEluRmlsZUJhc2VkTW9kZShBUFREaXNwYXRjaFJ1bm5hYmxlLmphdmE6MzQ1KQ0KCWF0
IG9yZy5lY2xpcHNlLmpkdC5hcHQuY29yZS5pbnRlcm5hbC5BUFREaXNwYXRjaFJ1bm5hYmxlLmJ1
aWxkKEFQVERpc3BhdGNoUnVubmFibGUuamF2YTo2ODMpDQoJYXQgb3JnLmVjbGlwc2UuamR0LmFw
dC5jb3JlLmludGVybmFsLkFQVERpc3BhdGNoUnVubmFibGUuYWNjZXNzJDEoQVBURGlzcGF0Y2hS
dW5uYWJsZS5qYXZhOjY3NSkNCglhdCBvcmcuZWNsaXBzZS5qZHQuYXB0LmNvcmUuaW50ZXJuYWwu
QVBURGlzcGF0Y2hSdW5uYWJsZSQxLnJ1bihBUFREaXNwYXRjaFJ1bm5hYmxlLmphdmE6MjczKQ0K
CWF0IG9yZy5lY2xpcHNlLmpkdC5hcHQuY29yZS5pbnRlcm5hbC5lbnYuQnVpbGRFbnYkQ2FsbGJh
Y2tSZXF1ZXN0b3IuYWNjZXB0QmluZGluZyhCdWlsZEVudi5qYXZhOjYxMSkNCglhdCBvcmcuZWNs
aXBzZS5qZHQuY29yZS5kb20uQ29tcGlsYXRpb25Vbml0UmVzb2x2ZXIucmVzb2x2ZShDb21waWxh
dGlvblVuaXRSZXNvbHZlci5qYXZhOjkyNSkNCglhdCBvcmcuZWNsaXBzZS5qZHQuY29yZS5kb20u
Q29tcGlsYXRpb25Vbml0UmVzb2x2ZXIucmVzb2x2ZShDb21waWxhdGlvblVuaXRSZXNvbHZlci5q
YXZhOjU3NykNCglhdCBvcmcuZWNsaXBzZS5qZHQuY29yZS5kb20uQVNUUGFyc2VyLmNyZWF0ZUFT
VHMoQVNUUGFyc2VyLmphdmE6ODg4KQ0KCWF0IG9yZy5lY2xpcHNlLmpkdC5hcHQuY29yZS5pbnRl
cm5hbC5lbnYuQmFzZVByb2Nlc3NvckVudi5jcmVhdGVBU1RzKEJhc2VQcm9jZXNzb3JFbnYuamF2
YTo4NTkpDQoJYXQgb3JnLmVjbGlwc2UuamR0LmFwdC5jb3JlLmludGVybmFsLmVudi5CdWlsZEVu
di5jcmVhdGVBU1RzKEJ1aWxkRW52LmphdmE6MzU2KQ0KCWF0IG9yZy5lY2xpcHNlLmpkdC5hcHQu
Y29yZS5pbnRlcm5hbC5lbnYuQWJzdHJhY3RDb21waWxhdGlvbkVudi5uZXdCdWlsZEVudihBYnN0
cmFjdENvbXBpbGF0aW9uRW52LmphdmE6MTExKQ0KCWF0IG9yZy5lY2xpcHNlLmpkdC5hcHQuY29y
ZS5pbnRlcm5hbC5BUFREaXNwYXRjaFJ1bm5hYmxlLmJ1aWxkKEFQVERpc3BhdGNoUnVubmFibGUu
amF2YToyODMpDQoJYXQgb3JnLmVjbGlwc2UuamR0LmFwdC5jb3JlLmludGVybmFsLkFQVERpc3Bh
dGNoUnVubmFibGUucnVuKEFQVERpc3BhdGNoUnVubmFibGUuamF2YToyMjUpDQoJYXQgb3JnLmVj
bGlwc2UuY29yZS5pbnRlcm5hbC5yZXNvdXJjZXMuV29ya3NwYWNlLnJ1bihXb3Jrc3BhY2UuamF2
YToyMzQ0KQ0KCWF0IG9yZy5lY2xpcHNlLmpkdC5hcHQuY29yZS5pbnRlcm5hbC5BUFREaXNwYXRj
aFJ1bm5hYmxlLnJ1bkFQVER1cmluZ0J1aWxkKEFQVERpc3BhdGNoUnVubmFibGUuamF2YToxNTAp
DQoJYXQgb3JnLmVjbGlwc2UuamR0LmFwdC5jb3JlLmludGVybmFsLkFwdENvbXBpbGF0aW9uUGFy
dGljaXBhbnQucHJvY2Vzc0Fubm90YXRpb25zKEFwdENvbXBpbGF0aW9uUGFydGljaXBhbnQuamF2
YToxOTMpDQoJYXQgb3JnLmVjbGlwc2UuamR0LmludGVybmFsLmNvcmUuYnVpbGRlci5BYnN0cmFj
dEltYWdlQnVpbGRlci5wcm9jZXNzQW5ub3RhdGlvbnMoQWJzdHJhY3RJbWFnZUJ1aWxkZXIuamF2
YTo2MjcpDQoJYXQgb3JnLmVjbGlwc2UuamR0LmludGVybmFsLmNvcmUuYnVpbGRlci5BYnN0cmFj
dEltYWdlQnVpbGRlci5jb21waWxlKEFic3RyYWN0SW1hZ2VCdWlsZGVyLmphdmE6MzM4KQ0KCWF0
IG9yZy5lY2xpcHNlLmpkdC5pbnRlcm5hbC5jb3JlLmJ1aWxkZXIuQmF0Y2hJbWFnZUJ1aWxkZXIu
YnVpbGQoQmF0Y2hJbWFnZUJ1aWxkZXIuamF2YTo2MCkNCglhdCBvcmcuZWNsaXBzZS5qZHQuaW50
ZXJuYWwuY29yZS5idWlsZGVyLkphdmFCdWlsZGVyLmJ1aWxkQWxsKEphdmFCdWlsZGVyLmphdmE6
MjU0KQ0KCWF0IG9yZy5lY2xpcHNlLmpkdC5pbnRlcm5hbC5jb3JlLmJ1aWxkZXIuSmF2YUJ1aWxk
ZXIuYnVpbGQoSmF2YUJ1aWxkZXIuamF2YToxNzMpDQoJYXQgb3JnLmVjbGlwc2UuY29yZS5pbnRl
cm5hbC5ldmVudHMuQnVpbGRNYW5hZ2VyJDIucnVuKEJ1aWxkTWFuYWdlci5qYXZhOjcyOCkNCglh
dCBvcmcuZWNsaXBzZS5jb3JlLnJ1bnRpbWUuU2FmZVJ1bm5lci5ydW4oU2FmZVJ1bm5lci5qYXZh
OjQyKQ0KCWF0IG9yZy5lY2xpcHNlLmNvcmUuaW50ZXJuYWwuZXZlbnRzLkJ1aWxkTWFuYWdlci5i
YXNpY0J1aWxkKEJ1aWxkTWFuYWdlci5qYXZhOjE5OSkNCglhdCBvcmcuZWNsaXBzZS5jb3JlLmlu
dGVybmFsLmV2ZW50cy5CdWlsZE1hbmFnZXIuYmFzaWNCdWlsZChCdWlsZE1hbmFnZXIuamF2YToy
MzkpDQoJYXQgb3JnLmVjbGlwc2UuY29yZS5pbnRlcm5hbC5ldmVudHMuQnVpbGRNYW5hZ2VyJDEu
cnVuKEJ1aWxkTWFuYWdlci5qYXZhOjI5MikNCglhdCBvcmcuZWNsaXBzZS5jb3JlLnJ1bnRpbWUu
U2FmZVJ1bm5lci5ydW4oU2FmZVJ1bm5lci5qYXZhOjQyKQ0KCWF0IG9yZy5lY2xpcHNlLmNvcmUu
aW50ZXJuYWwuZXZlbnRzLkJ1aWxkTWFuYWdlci5iYXNpY0J1aWxkKEJ1aWxkTWFuYWdlci5qYXZh
OjI5NSkNCglhdCBvcmcuZWNsaXBzZS5jb3JlLmludGVybmFsLmV2ZW50cy5CdWlsZE1hbmFnZXIu
YmFzaWNCdWlsZExvb3AoQnVpbGRNYW5hZ2VyLmphdmE6MzUxKQ0KCWF0IG9yZy5lY2xpcHNlLmNv
cmUuaW50ZXJuYWwuZXZlbnRzLkJ1aWxkTWFuYWdlci5idWlsZChCdWlsZE1hbmFnZXIuamF2YToz
NzQpDQoJYXQgb3JnLmVjbGlwc2UuY29yZS5pbnRlcm5hbC5ldmVudHMuQXV0b0J1aWxkSm9iLmRv
QnVpbGQoQXV0b0J1aWxkSm9iLmphdmE6MTQzKQ0KCWF0IG9yZy5lY2xpcHNlLmNvcmUuaW50ZXJu
YWwuZXZlbnRzLkF1dG9CdWlsZEpvYi5ydW4oQXV0b0J1aWxkSm9iLmphdmE6MjQxKQ0KCWF0IG9y
Zy5lY2xpcHNlLmNvcmUuaW50ZXJuYWwuam9icy5Xb3JrZXIucnVuKFdvcmtlci5qYXZhOjU0KQ0K
</data>

          </attachment>
          <attachment
              isobsolete="0"
              ispatch="1"
              isprivate="0"
          >
            <attachid>214597</attachid>
            <date>2012-04-26 09:01:00 -0400</date>
            <delta_ts>2012-04-26 09:01:08 -0400</delta_ts>
            <desc>Patch to fix the exception</desc>
            <filename>PatchFixException.txt</filename>
            <type>text/plain</type>
            <size>5010</size>
            <attacher name="Satyam Kandula">satyam.kandula</attacher>
            
              <data encoding="base64">ZGlmZiAtLWdpdCBhL29yZy5lY2xpcHNlLmpkdC5hcHQuY29yZS9zcmMvb3JnL2VjbGlwc2UvamR0
L2FwdC9jb3JlL2ludGVybmFsL3V0aWwvRmFjdG9yeS5qYXZhIGIvb3JnLmVjbGlwc2UuamR0LmFw
dC5jb3JlL3NyYy9vcmcvZWNsaXBzZS9qZHQvYXB0L2NvcmUvaW50ZXJuYWwvdXRpbC9GYWN0b3J5
LmphdmEKaW5kZXggN2ZkYmY1NS4uMDhkYzc1MiAxMDA2NDQKLS0tIGEvb3JnLmVjbGlwc2UuamR0
LmFwdC5jb3JlL3NyYy9vcmcvZWNsaXBzZS9qZHQvYXB0L2NvcmUvaW50ZXJuYWwvdXRpbC9GYWN0
b3J5LmphdmEKKysrIGIvb3JnLmVjbGlwc2UuamR0LmFwdC5jb3JlL3NyYy9vcmcvZWNsaXBzZS9q
ZHQvYXB0L2NvcmUvaW50ZXJuYWwvdXRpbC9GYWN0b3J5LmphdmEKQEAgLTEsNSArMSw1IEBACiAv
KioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioq
KioqKioqKioqKioqKioqKioqKioqKgotICogQ29weXJpZ2h0IChjKSAyMDA1LCAyMDA4IEJFQSBT
eXN0ZW1zLCBJbmMuCisgKiBDb3B5cmlnaHQgKGMpIDIwMDUsIDIwMTIgQkVBIFN5c3RlbXMsIElu
Yy4gYW5kIG90aGVycwogICogQWxsIHJpZ2h0cyByZXNlcnZlZC4gVGhpcyBwcm9ncmFtIGFuZCB0
aGUgYWNjb21wYW55aW5nIG1hdGVyaWFscwogICogYXJlIG1hZGUgYXZhaWxhYmxlIHVuZGVyIHRo
ZSB0ZXJtcyBvZiB0aGUgRWNsaXBzZSBQdWJsaWMgTGljZW5zZSB2MS4wCiAgKiB3aGljaCBhY2Nv
bXBhbmllcyB0aGlzIGRpc3RyaWJ1dGlvbiwgYW5kIGlzIGF2YWlsYWJsZSBhdApAQCAtMTA3LDcg
KzEwNywxMiBAQAogICAgICAgICAgICAgaWYoIGRlY2xhcmluZ1R5cGUgIT0gbnVsbCAmJiBkZWNs
YXJpbmdUeXBlLmlzQW5ub3RhdGlvbigpICkKICAgICAgICAgICAgICAgICByZXR1cm4gbmV3IEFu
bm90YXRpb25FbGVtZW50RGVjbGFyYXRpb25JbXBsKG1ldGhvZCwgZW52KTsKICAgICAgICAgICAg
IGVsc2UKLSAgICAgICAgICAgICAgICByZXR1cm4gbmV3IE1ldGhvZERlY2xhcmF0aW9uSW1wbCht
ZXRob2QsIGVudik7ICAgICAgICAgICAgIAorICAgICAgICAgICAgICAgIHJldHVybiBuZXcgTWV0
aG9kRGVjbGFyYXRpb25JbXBsKG1ldGhvZCwgZW52KTsKKyAgICAgICAgY2FzZSBJQmluZGluZy5Q
QUNLQUdFOgorICAgICAgICAgICAgLy8gaHR0cHM6Ly9idWdzLmVjbGlwc2Uub3JnL2J1Z3Mvc2hv
d19idWcuY2dpP2lkPTM1Mjk0OQorICAgICAgICAgICAgLy8gRG9uJ3QgdGhyb3cgYW4gZXhjZXB0
aW9uLCBidXQganVzdCByZXR1cm4gbnVsbC4gCisgICAgICAgIAkvLyBhcHQgYWxzbyBkb2Vzbid0
IHJldHVybiBhIHZhbHVlCisgICAgICAgIAlyZXR1cm4gbnVsbDsKICAgICAgICAgZGVmYXVsdDoK
ICAgICAgICAgICAgIHRocm93IG5ldyBJbGxlZ2FsU3RhdGVFeGNlcHRpb24oImZhaWxlZCB0byBj
cmVhdGUgZGVjbGFyYXRpb24gZnJvbSAiICsgYmluZGluZyk7IC8vJE5PTi1OTFMtMSQKICAgICAg
ICAgfSAgICAgCmRpZmYgLS1naXQgYS9vcmcuZWNsaXBzZS5qZHQuYXB0LnRlc3RzL3NyYy9vcmcv
ZWNsaXBzZS9qZHQvYXB0L3Rlc3RzL01pcnJvckRlY2xhcmF0aW9uVGVzdHMuamF2YSBiL29yZy5l
Y2xpcHNlLmpkdC5hcHQudGVzdHMvc3JjL29yZy9lY2xpcHNlL2pkdC9hcHQvdGVzdHMvTWlycm9y
RGVjbGFyYXRpb25UZXN0cy5qYXZhCmluZGV4IDk5ZmJmNDcuLjVmMDA0MWEgMTAwNjQ0Ci0tLSBh
L29yZy5lY2xpcHNlLmpkdC5hcHQudGVzdHMvc3JjL29yZy9lY2xpcHNlL2pkdC9hcHQvdGVzdHMv
TWlycm9yRGVjbGFyYXRpb25UZXN0cy5qYXZhCisrKyBiL29yZy5lY2xpcHNlLmpkdC5hcHQudGVz
dHMvc3JjL29yZy9lY2xpcHNlL2pkdC9hcHQvdGVzdHMvTWlycm9yRGVjbGFyYXRpb25UZXN0cy5q
YXZhCkBAIC0xMiw2ICsxMiw3IEBACiAKIHBhY2thZ2Ugb3JnLmVjbGlwc2UuamR0LmFwdC50ZXN0
czsKIAoraW1wb3J0IGphdmEudXRpbC5Db2xsZWN0aW9uOwogaW1wb3J0IGphdmEudXRpbC5NYXA7
CiAKIGltcG9ydCBqdW5pdC5mcmFtZXdvcmsuVGVzdDsKQEAgLTI2Miw2ICsyNjMsMzEgQEAKIAkJ
YXNzZXJ0VHJ1ZSgiUHJvY2Vzc29yIG5vdCBpbnZva2VkIiwgcC5jYWxsZWQpOwogCX0KIAkKKwlw
dWJsaWMgdm9pZCB0ZXN0UGFja2FnZUluZm8oKSB7CisJCVBhY2thZ2VJbmZvUHJvYyBwID0gbmV3
IFBhY2thZ2VJbmZvUHJvYygpOyAKKwkJR2VuZXJpY0ZhY3Rvcnkuc2V0UHJvY2Vzc29yKHApOwor
CQkKKwkJSVByb2plY3QgcHJvamVjdCA9IGVudi5nZXRQcm9qZWN0KCBnZXRQcm9qZWN0TmFtZSgp
ICk7CisJCUlQYXRoIHNyY1Jvb3QgPSBnZXRTb3VyY2VQYXRoKCk7CisJCUlQYXRoIHBrZyA9IGVu
di5hZGRQYWNrYWdlKHNyY1Jvb3QsICJwa2ciKTsKKwkJU3RyaW5nIGNvbnRlbnRzID0gIkBQa2dB
bm5vdGF0aW9uXG4iICsKKwkJCQkJCSAgIkBHZW5lcmljQW5ub3RhdGlvblxuIiArCisJCQkJCQkg
ICJwYWNrYWdlIHBrZztcbiIgKworCQkJCQkJICAiaW1wb3J0IG9yZy5lY2xpcHNlLmpkdC5hcHQu
dGVzdHMuYW5ub3RhdGlvbnMuZ2VuZXJpYy4qOyI7CisJCWVudi5hZGRGaWxlKHBrZywgInBhY2th
Z2UtaW5mby5qYXZhIiwgY29udGVudHMpOworCQlTdHJpbmcgYW5uQ29udGVudHMgPQorCQkJCSJw
YWNrYWdlIHBrZztcbiIgKworCQkJCSJcbiIgKworCQkJCSJAaW50ZXJmYWNlIFBrZ0Fubm90YXRp
b24ge1xuIiArCisJCQkJIiAgICBTdHJpbmcgdmFsdWUoKSBkZWZhdWx0IFwiZGVmXCI7XG4iICsK
KwkJCQkifVxuIjsKKwkJZW52LmFkZENsYXNzKHNyY1Jvb3QsICJwa2ciLCAicGtnQW5ub3RhdGlv
biIsIGFubkNvbnRlbnRzKTsKKwkJZnVsbEJ1aWxkKCBwcm9qZWN0LmdldEZ1bGxQYXRoKCkgKTsK
KwkJZXhwZWN0aW5nTm9Qcm9ibGVtcygpOworCQkKKwkJYXNzZXJ0VHJ1ZSgiUHJvY2Vzc29yIG5v
dCBpbnZva2VkIiwgcC5jYWxsZWQpOworCX0KKwkKIAlzdGF0aWMgY2xhc3MgVGVzdExvY2F0aW9u
UHJvYyBleHRlbmRzIEFic3RyYWN0R2VuZXJpY1Byb2Nlc3NvciB7CiAKIAkJYm9vbGVhbiBjYWxs
ZWQ7CkBAIC0yODQsNyArMzEwLDcgQEAKIAkJCiAJCXB1YmxpYyB2b2lkIF9wcm9jZXNzKCkgewog
CQkJY2FsbGVkID0gdHJ1ZTsKLQkJCVR5cGVEZWNsYXJhdGlvbiB0ZENvZGUgPSBlbnYuZ2V0VHlw
ZURlY2xhcmF0aW9uKFNvdXJjZU1pcnJvckNvZGVFeGFtcGxlLkNPREVfUEFDS0FHRSArICIuIiAr
IFNvdXJjZU1pcnJvckNvZGVFeGFtcGxlLkFOTk9fQ09ERV9DTEFTU19OQU1FKTsKKwkJCVR5cGVE
ZWNsYXJhdGlvbiB0ZENvZGUgPSBlbnYuZ2V0VHlwZURlY2xhcmF0aW9uKFNvdXJjZU1pcnJvckNv
ZGVFeGFtcGxlLkNPREVfUEFDS0FHRSArICIuIiArIFNvdXJjZU1pcnJvckNvZGVFeGFtcGxlLkNP
REVfQ0xBU1NfTkFNRSk7CiAJCQlmb3IgKEFubm90YXRpb25NaXJyb3IgYW0gOiB0ZENvZGUuZ2V0
QW5ub3RhdGlvbk1pcnJvcnMoKSkgewogCQkJCWlmICgiR2VuZXJpY0Fubm90YXRpb24iLmVxdWFs
cyhhbS5nZXRBbm5vdGF0aW9uVHlwZSgpLmdldERlY2xhcmF0aW9uKCkuZ2V0U2ltcGxlTmFtZSgp
KSkgewogCQkJCQljb250aW51ZTsKQEAgLTMwMCw2ICszMjYsMzYgQEAKIAkJfQogCX0KIAkKKwlz
dGF0aWMgY2xhc3MgUGFja2FnZUluZm9Qcm9jIGV4dGVuZHMgQWJzdHJhY3RHZW5lcmljUHJvY2Vz
c29yIHsKKwkJCisJCWJvb2xlYW4gY2FsbGVkOworCQkKKwkJcHVibGljIHZvaWQgX3Byb2Nlc3Mo
KSB7CisJCQljYWxsZWQgPSB0cnVlOworCQkJQW5ub3RhdGlvblR5cGVEZWNsYXJhdGlvbiBhbm5v
RGVjbCA9IChBbm5vdGF0aW9uVHlwZURlY2xhcmF0aW9uKWVudi5nZXRUeXBlRGVjbGFyYXRpb24o
InBrZy5Qa2dBbm5vdGF0aW9uIik7CisJCQlhc3NlcnRUcnVlKG51bGwgIT0gYW5ub0RlY2wpOwkJ
CQorCQkJLy8gZ2V0IHRoZSBhbm5vdGF0ZWQgZGVjbGFyYXRpb25zCisJCQlDb2xsZWN0aW9uPERl
Y2xhcmF0aW9uPiBhbm5vdGF0ZWREZWNscyA9IGVudi5nZXREZWNsYXJhdGlvbnNBbm5vdGF0ZWRX
aXRoKGFubm9EZWNsKTsKKwkJCS8vIGRvbid0IHJldHVybiB0aGUgcGFja2FnZSBkZWNsYXJhdGlv
biAtIHdlbGwsIGFwdCBpcyBkb2luZyB0aGF0Li4gCisJCQlhc3NlcnRUcnVlKGFubm90YXRlZERl
Y2xzID09IG51bGwgIHx8IGFubm90YXRlZERlY2xzLnNpemUoKSA9PSAwKTsgCisJCQkKKwkJCS8v
VE9ETzogdGVzdCB0byBzdXBwb3J0IHBhY2thZ2UgYW5ub3RhdGlvbgorCQkJLy8gUGFja2FnZURl
Y2xhcmF0aW9uIHBkQ29kZSA9IGVudi5nZXRQYWNrYWdlKCJwa2ciKTsKKwkJCS8vIGZvciAoQW5u
b3RhdGlvbk1pcnJvciBhbSA6IHBkQ29kZS5nZXRBbm5vdGF0aW9uTWlycm9ycygpKSB7CisJCQkv
LwlpZiAoIkdlbmVyaWNBbm5vdGF0aW9uIi5lcXVhbHMoYW0uZ2V0QW5ub3RhdGlvblR5cGUoKS5n
ZXREZWNsYXJhdGlvbigpLmdldFNpbXBsZU5hbWUoKSkpIHsKKwkJCS8vCQljb250aW51ZTsKKwkJ
CS8vCX0KKwkJCS8vCWFzc2VydFRydWUobnVsbCAhPSBhbS5nZXRQb3NpdGlvbigpKTsKKwkJCS8v
CUFubm90YXRpb25UeXBlRGVjbGFyYXRpb24gYXRkID0gYW0uZ2V0QW5ub3RhdGlvblR5cGUoKS5n
ZXREZWNsYXJhdGlvbigpOworCQkJLy8JYXNzZXJ0VHJ1ZShudWxsICE9IGF0ZC5nZXRQb3NpdGlv
bigpKTsKKwkJCS8vCWZvciAoTWFwLkVudHJ5PEFubm90YXRpb25UeXBlRWxlbWVudERlY2xhcmF0
aW9uLCBBbm5vdGF0aW9uVmFsdWU+IGVudHJ5IDogYW0uZ2V0RWxlbWVudFZhbHVlcygpLmVudHJ5
U2V0KCkpIHsKKwkJCS8vCQlhc3NlcnROb3ROdWxsKGVudHJ5LmdldEtleSgpLmdldFBvc2l0aW9u
KCkpOworCQkJLy8JCWFzc2VydE5vdE51bGwoZW50cnkuZ2V0S2V5KCkuZ2V0RGVmYXVsdFZhbHVl
KCkuZ2V0UG9zaXRpb24oKSk7CisJCQkvLwl9CisJCQkvLyB9CisJCX0KKwl9CisJCiAJcHVibGlj
IHZvaWQgdGVzdEVudkZhY3RvcnkoKSB0aHJvd3MgSmF2YU1vZGVsRXhjZXB0aW9uIHsKIAogCQlJ
UHJvamVjdCBwcm9qZWN0ID0gZW52LmdldFByb2plY3QoZ2V0UHJvamVjdE5hbWUoKSk7
</data>

          </attachment>
          <attachment
              isobsolete="0"
              ispatch="1"
              isprivate="0"
          >
            <attachid>214599</attachid>
            <date>2012-04-26 09:05:00 -0400</date>
            <delta_ts>2012-04-26 09:05:50 -0400</delta_ts>
            <desc>Patch to support annotations on package.</desc>
            <filename>patch.txt</filename>
            <type>text/plain</type>
            <size>17014</size>
            <attacher name="Satyam Kandula">satyam.kandula</attacher>
            
              <data encoding="base64">ZGlmZiAtLWdpdCBhL29yZy5lY2xpcHNlLmpkdC5hcHQuY29yZS9zcmMvb3JnL2VjbGlwc2UvamR0
L2FwdC9jb3JlL2ludGVybmFsL2RlY2xhcmF0aW9uL0Fubm90YXRpb25NaXJyb3JJbXBsLmphdmEg
Yi9vcmcuZWNsaXBzZS5qZHQuYXB0LmNvcmUvc3JjL29yZy9lY2xpcHNlL2pkdC9hcHQvY29yZS9p
bnRlcm5hbC9kZWNsYXJhdGlvbi9Bbm5vdGF0aW9uTWlycm9ySW1wbC5qYXZhCmluZGV4IDBmNzEw
ODQuLjY1OTEyNzEgMTAwNjQ0Ci0tLSBhL29yZy5lY2xpcHNlLmpkdC5hcHQuY29yZS9zcmMvb3Jn
L2VjbGlwc2UvamR0L2FwdC9jb3JlL2ludGVybmFsL2RlY2xhcmF0aW9uL0Fubm90YXRpb25NaXJy
b3JJbXBsLmphdmEKKysrIGIvb3JnLmVjbGlwc2UuamR0LmFwdC5jb3JlL3NyYy9vcmcvZWNsaXBz
ZS9qZHQvYXB0L2NvcmUvaW50ZXJuYWwvZGVjbGFyYXRpb24vQW5ub3RhdGlvbk1pcnJvckltcGwu
amF2YQpAQCAtMjM1LDYgKzIzNSw3IEBACiAJeyAKIAkJaWYoIGlzRnJvbVNvdXJjZSgpICl7CiAJ
CQlmaW5hbCBDb21waWxhdGlvblVuaXQgdW5pdCA9IF9hbm5vdGF0ZWQuZ2V0Q29tcGlsYXRpb25V
bml0KCk7CisJCQlpZiAodW5pdCA9PSBudWxsKSByZXR1cm4gbnVsbDsKIAkJCWZpbmFsIEFTVE5v
ZGUgbm9kZSA9IHVuaXQuZmluZERlY2xhcmluZ05vZGUoX2RvbUFubm90YXRpb24pOwogCQkJaWYo
IG5vZGUgaW5zdGFuY2VvZiBvcmcuZWNsaXBzZS5qZHQuY29yZS5kb20uQW5ub3RhdGlvbiApCiAJ
CQkJcmV0dXJuIChvcmcuZWNsaXBzZS5qZHQuY29yZS5kb20uQW5ub3RhdGlvbilub2RlOwkJCQpk
aWZmIC0tZ2l0IGEvb3JnLmVjbGlwc2UuamR0LmFwdC5jb3JlL3NyYy9vcmcvZWNsaXBzZS9qZHQv
YXB0L2NvcmUvaW50ZXJuYWwvZGVjbGFyYXRpb24vTWVtYmVyRGVjbGFyYXRpb25JbXBsLmphdmEg
Yi9vcmcuZWNsaXBzZS5qZHQuYXB0LmNvcmUvc3JjL29yZy9lY2xpcHNlL2pkdC9hcHQvY29yZS9p
bnRlcm5hbC9kZWNsYXJhdGlvbi9NZW1iZXJEZWNsYXJhdGlvbkltcGwuamF2YQppbmRleCBiMDE5
ZjViLi4zMDEwMGU5IDEwMDY0NAotLS0gYS9vcmcuZWNsaXBzZS5qZHQuYXB0LmNvcmUvc3JjL29y
Zy9lY2xpcHNlL2pkdC9hcHQvY29yZS9pbnRlcm5hbC9kZWNsYXJhdGlvbi9NZW1iZXJEZWNsYXJh
dGlvbkltcGwuamF2YQorKysgYi9vcmcuZWNsaXBzZS5qZHQuYXB0LmNvcmUvc3JjL29yZy9lY2xp
cHNlL2pkdC9hcHQvY29yZS9pbnRlcm5hbC9kZWNsYXJhdGlvbi9NZW1iZXJEZWNsYXJhdGlvbklt
cGwuamF2YQpAQCAtMSw1ICsxLDUgQEAKIC8qKioqKioqKioqKioqKioqKioqKioqKioqKioqKioq
KioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqCi0gKiBDb3B5
cmlnaHQgKGMpIDIwMDUsIDIwMDcgQkVBIFN5c3RlbXMsIEluYy4KKyAqIENvcHlyaWdodCAoYykg
MjAwNSwgMjAxMiBCRUEgU3lzdGVtcywgSW5jLgogICogQWxsIHJpZ2h0cyByZXNlcnZlZC4gVGhp
cyBwcm9ncmFtIGFuZCB0aGUgYWNjb21wYW55aW5nIG1hdGVyaWFscwogICogYXJlIG1hZGUgYXZh
aWxhYmxlIHVuZGVyIHRoZSB0ZXJtcyBvZiB0aGUgRWNsaXBzZSBQdWJsaWMgTGljZW5zZSB2MS4w
CiAgKiB3aGljaCBhY2NvbXBhbmllcyB0aGlzIGRpc3RyaWJ1dGlvbiwgYW5kIGlzIGF2YWlsYWJs
ZSBhdApAQCAtNjIsOCArNjIsNyBAQAogCQkJaW5zdGFuY2VzID0gKChJVmFyaWFibGVCaW5kaW5n
KWJpbmRpbmcpLmdldEFubm90YXRpb25zKCk7CiAJCQlicmVhazsKIAkJY2FzZSBJQmluZGluZy5Q
QUNLQUdFOgotCQkJLy8gVE9ETzogc3VwcG9ydCBwYWNrYWdlIGFubm90YXRpb24KLQkJCXJldHVy
biBudWxsOworCQkJaW5zdGFuY2VzID0gKChJUGFja2FnZUJpbmRpbmcpYmluZGluZykuZ2V0QW5u
b3RhdGlvbnMoKTsKIAkJZGVmYXVsdDoJCQkKIAkJCXRocm93IG5ldyBJbGxlZ2FsU3RhdGVFeGNl
cHRpb24oKTsKIAkJfQpAQCAtOTIsNyArOTEsNyBAQAogICAgICAgICByZXR1cm4gbnVsbDsKICAg
ICB9ICAgIAogCi0JLyoqCisgICAgLyoqCiAJICogQHJldHVybiB0aGUgc291cmNlIHBvc2l0aW9u
IG9mIHRoaXMgZGVjbGFyYXRpb24uIAogCSAqICAgICAgICAgUmV0dXJuIG51bGwgaWYgdGhpcyBk
ZWNsYXJhdGlvbiBkaWQgbm90IGNvbWUgZnJvbSBzb3VyY2Ugb3IgCiAJICogICAgICAgICBpZiB0
aGUgZGVjbGFyYXRpb24gaXMgKG9yIGlzIHBhcnQgb2YpIGEgc2Vjb25kYXJ5IHR5cGUgdGhhdCBp
cyBkZWZpbmVkIApkaWZmIC0tZ2l0IGEvb3JnLmVjbGlwc2UuamR0LmFwdC5jb3JlL3NyYy9vcmcv
ZWNsaXBzZS9qZHQvYXB0L2NvcmUvaW50ZXJuYWwvZGVjbGFyYXRpb24vUGFja2FnZURlY2xhcmF0
aW9uSW1wbC5qYXZhIGIvb3JnLmVjbGlwc2UuamR0LmFwdC5jb3JlL3NyYy9vcmcvZWNsaXBzZS9q
ZHQvYXB0L2NvcmUvaW50ZXJuYWwvZGVjbGFyYXRpb24vUGFja2FnZURlY2xhcmF0aW9uSW1wbC5q
YXZhCmluZGV4IDM5OWUzNTUuLmRjYzkzMjAgMTAwNjQ0Ci0tLSBhL29yZy5lY2xpcHNlLmpkdC5h
cHQuY29yZS9zcmMvb3JnL2VjbGlwc2UvamR0L2FwdC9jb3JlL2ludGVybmFsL2RlY2xhcmF0aW9u
L1BhY2thZ2VEZWNsYXJhdGlvbkltcGwuamF2YQorKysgYi9vcmcuZWNsaXBzZS5qZHQuYXB0LmNv
cmUvc3JjL29yZy9lY2xpcHNlL2pkdC9hcHQvY29yZS9pbnRlcm5hbC9kZWNsYXJhdGlvbi9QYWNr
YWdlRGVjbGFyYXRpb25JbXBsLmphdmEKQEAgLTEsNSArMSw1IEBACiAvKioqKioqKioqKioqKioq
KioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioq
KioqKioqKgotICogQ29weXJpZ2h0IChjKSAyMDA1LCAyMDA4IEJFQSBTeXN0ZW1zLCBJbmMuCisg
KiBDb3B5cmlnaHQgKGMpIDIwMDUsIDIwMTIgQkVBIFN5c3RlbXMsIEluYy4gYW5kIG90aGVycwog
ICogQWxsIHJpZ2h0cyByZXNlcnZlZC4gVGhpcyBwcm9ncmFtIGFuZCB0aGUgYWNjb21wYW55aW5n
IG1hdGVyaWFscwogICogYXJlIG1hZGUgYXZhaWxhYmxlIHVuZGVyIHRoZSB0ZXJtcyBvZiB0aGUg
RWNsaXBzZSBQdWJsaWMgTGljZW5zZSB2MS4wCiAgKiB3aGljaCBhY2NvbXBhbmllcyB0aGlzIGRp
c3RyaWJ1dGlvbiwgYW5kIGlzIGF2YWlsYWJsZSBhdApAQCAtNTQsNiArNTQsOSBAQAogCS8vIExh
emlseSBpbml0aWFsaXplZCB1bmxlc3Mgc3BlY2lmaWVkIGluIGNvbnN0cnVjdG9yLgogCXByaXZh
dGUgSVBhY2thZ2VGcmFnbWVudFtdIF9wa2dGcmFnbWVudHMgPSBudWxsOwogCQorCS8vIGJvb2xl
YW4gdG8gaW5kaWNhdGUgaWYgdGhpcyBpcyBnZXR0aW5nIGNyZWF0ZWQgZm9yIGEgcGFja2FnZS1p
bmZvLgorCXByaXZhdGUgZmluYWwgYm9vbGVhbiBfaXNQa2dJbmZvOyAKKwkKICAgICBwdWJsaWMg
UGFja2FnZURlY2xhcmF0aW9uSW1wbCgKIAkJCWZpbmFsIElQYWNrYWdlQmluZGluZyBiaW5kaW5n
LCAKIAkJCWZpbmFsIFR5cGVEZWNsYXJhdGlvbkltcGwgdHlwZURlY2wsIApAQCAtNjQsNyArNjcs
OCBAQAogICAgICAgICAJIHR5cGVEZWNsLCAKICAgICAgICAgCSBlbnYsIAogICAgICAgICAJIGhp
ZGVTb3VyY2VQb3NpdGlvbiwgCi0gICAgICAgIAkgbnVsbCk7CisgICAgICAgIAkgbnVsbCwKKyAg
ICAgICAgCSBmYWxzZSk7CiAgICAgfQogICAgIAogICAgIHB1YmxpYyBQYWNrYWdlRGVjbGFyYXRp
b25JbXBsKApAQCAtNzQsMTAgKzc4LDI3IEBACiAJCQlmaW5hbCBib29sZWFuIGhpZGVTb3VyY2VQ
b3NpdGlvbiwKIAkJCWZpbmFsIElQYWNrYWdlRnJhZ21lbnRbXSBwa2dGcmFnbWVudHMpCiAgICAg
eworICAgIAl0aGlzKGJpbmRpbmcsIAorICAgICAgICAgICAJIHR5cGVEZWNsLCAKKyAgICAgICAg
ICAgCSBlbnYsIAorICAgICAgICAgICAJIGhpZGVTb3VyY2VQb3NpdGlvbiwgCisgICAgICAgICAg
IAkgcGtnRnJhZ21lbnRzLAorICAgICAgICAgICAJIGZhbHNlKTsKKyAgICB9CisgICAgCisgICAg
cHVibGljIFBhY2thZ2VEZWNsYXJhdGlvbkltcGwoCisJCQlmaW5hbCBJUGFja2FnZUJpbmRpbmcg
YmluZGluZywgCisJCQlmaW5hbCBUeXBlRGVjbGFyYXRpb25JbXBsIHR5cGVEZWNsLCAKKwkJCWZp
bmFsIEJhc2VQcm9jZXNzb3JFbnYgZW52LAorCQkJZmluYWwgYm9vbGVhbiBoaWRlU291cmNlUG9z
aXRpb24sCisJCQlmaW5hbCBJUGFja2FnZUZyYWdtZW50W10gcGtnRnJhZ21lbnRzLAorCQkJZmlu
YWwgYm9vbGVhbiBpc1BrZ0luZm8pCisgICAgewogICAgICAgICBzdXBlcihiaW5kaW5nLCBlbnYp
OyAgIAogCQlfdHlwZURlY2wgPSB0eXBlRGVjbDsKIAkJX2hpZGVTb3VyY2VQb3NpdGlvbiA9IGhp
ZGVTb3VyY2VQb3NpdGlvbjsKIAkJX3BrZ0ZyYWdtZW50cyA9IHBrZ0ZyYWdtZW50czsKKwkJX2lz
UGtnSW5mbyA9IGlzUGtnSW5mbzsKICAgICB9CiAKICAgICBwdWJsaWMgSVBhY2thZ2VCaW5kaW5n
IGdldFBhY2thZ2VCaW5kaW5nKCl7IHJldHVybiAoSVBhY2thZ2VCaW5kaW5nKV9iaW5kaW5nOyB9
CkBAIC0xNzEsNyArMTkyLDggQEAKIAkJaWYgKF9oaWRlU291cmNlUG9zaXRpb24pCiAJCQlyZXR1
cm4gbnVsbDsKIAkJaWYgKGlzRnJvbVNvdXJjZSgpKXsKLQkJCWZpbmFsIENvbXBpbGF0aW9uVW5p
dCB1bml0ID0gX3R5cGVEZWNsLmdldENvbXBpbGF0aW9uVW5pdCgpOworCQkJZmluYWwgQ29tcGls
YXRpb25Vbml0IHVuaXQgPSBfaXNQa2dJbmZvID8gZ2V0Q29tcGlsYXRpb25Vbml0KCkgOiBfdHlw
ZURlY2wuZ2V0Q29tcGlsYXRpb25Vbml0KCk7CisJCQlpZiAodW5pdCA9PSBudWxsKSByZXR1cm4g
bnVsbDsKIAkJCWZpbmFsIEFTVE5vZGUgbm9kZSA9IHVuaXQuZmluZERlY2xhcmluZ05vZGUoZ2V0
RGVjbGFyYXRpb25CaW5kaW5nKCkpOwogCQkJaWYoIG5vZGUgPT0gbnVsbCApIHJldHVybiBudWxs
OwogCQkJZmluYWwgaW50IHN0YXJ0ID0gbm9kZS5nZXRTdGFydFBvc2l0aW9uKCk7CQkJCkBAIC0y
MDQsNyArMjI2LDcgQEAKIAkKIAlwdWJsaWMgSVBhY2thZ2VCaW5kaW5nIGdldERlY2xhcmF0aW9u
QmluZGluZygpeyByZXR1cm4gKElQYWNrYWdlQmluZGluZylfYmluZGluZzsgfQogCi0JcHVibGlj
IGJvb2xlYW4gaXNGcm9tU291cmNlKCl7IHJldHVybiBfdHlwZURlY2wgIT0gbnVsbCAmJiBfdHlw
ZURlY2wuaXNGcm9tU291cmNlKCk7IH0KKwlwdWJsaWMgYm9vbGVhbiBpc0Zyb21Tb3VyY2UoKXsg
cmV0dXJuIF9pc1BrZ0luZm8gPT0gdHJ1ZSB8fCAoX3R5cGVEZWNsICE9IG51bGwgJiYgX3R5cGVE
ZWNsLmlzRnJvbVNvdXJjZSgpKTsgfQogCQogCS8qKgogCSAqIE1ha2Ugc3VyZSB0byBjYWxsIHRo
aXMgYmVmb3JlIGF0dGVtcHRpbmcgdG8gYWNjZXNzIF9wa2dGcmFnbWVudHMuCmRpZmYgLS1naXQg
YS9vcmcuZWNsaXBzZS5qZHQuYXB0LmNvcmUvc3JjL29yZy9lY2xpcHNlL2pkdC9hcHQvY29yZS9p
bnRlcm5hbC9lbnYvQmFzZVByb2Nlc3NvckVudi5qYXZhIGIvb3JnLmVjbGlwc2UuamR0LmFwdC5j
b3JlL3NyYy9vcmcvZWNsaXBzZS9qZHQvYXB0L2NvcmUvaW50ZXJuYWwvZW52L0Jhc2VQcm9jZXNz
b3JFbnYuamF2YQppbmRleCA4YWFiOWFjLi45NGY4NzYyIDEwMDY0NAotLS0gYS9vcmcuZWNsaXBz
ZS5qZHQuYXB0LmNvcmUvc3JjL29yZy9lY2xpcHNlL2pkdC9hcHQvY29yZS9pbnRlcm5hbC9lbnYv
QmFzZVByb2Nlc3NvckVudi5qYXZhCisrKyBiL29yZy5lY2xpcHNlLmpkdC5hcHQuY29yZS9zcmMv
b3JnL2VjbGlwc2UvamR0L2FwdC9jb3JlL2ludGVybmFsL2Vudi9CYXNlUHJvY2Vzc29yRW52Lmph
dmEKQEAgLTEsNSArMSw1IEBACiAvKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioq
KioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKgotICogQ29weXJpZ2h0
IChjKSAyMDA1LCAyMDA5IEJFQSBTeXN0ZW1zIEluYy4gYW5kIG90aGVycworICogQ29weXJpZ2h0
IChjKSAyMDA1LCAyMDEyIEJFQSBTeXN0ZW1zIEluYy4gYW5kIG90aGVycwogICogQWxsIHJpZ2h0
cyByZXNlcnZlZC4gVGhpcyBwcm9ncmFtIGFuZCB0aGUgYWNjb21wYW55aW5nIG1hdGVyaWFscwog
ICogYXJlIG1hZGUgYXZhaWxhYmxlIHVuZGVyIHRoZSB0ZXJtcyBvZiB0aGUgRWNsaXBzZSBQdWJs
aWMgTGljZW5zZSB2MS4wCiAgKiB3aGljaCBhY2NvbXBhbmllcyB0aGlzIGRpc3RyaWJ1dGlvbiwg
YW5kIGlzIGF2YWlsYWJsZSBhdApAQCAtNTMzLDYgKzUzMyw3IEBACiAJewogCQlpZiAobmFtZSA9
PSBudWxsKQogCQkJdGhyb3cgbmV3IElsbGVnYWxBcmd1bWVudEV4Y2VwdGlvbigibmFtZSBjYW5u
b3QgYmUgbnVsbCIpOyAvLyROT04tTkxTLTEkCQkKKwkJCQkKIAkJSVBhY2thZ2VGcmFnbWVudFtd
IHBrZ0ZyYWdzID0gUGFja2FnZVV0aWwuZ2V0UGFja2FnZUZyYWdtZW50cyhuYW1lLCB0aGlzKTsK
IAogCQkvLyBObyBwYWNrYWdlcyBmb3VuZCwgbnVsbCBleHBlY3RlZApAQCAtNTUyLDYgKzU1Mywx
NSBAQAogCQkJfQogCQkJaWYgKGNvbnRhaW5zTm9KYXZhUmVzb3VyY2VzKQogCQkJCXJldHVybiBu
ZXcgUGFja2FnZURlY2xhcmF0aW9uSW1wbE5vQmluZGluZyhwa2dGcmFncyk7CisJCQkKKwkJCWlm
IChfYXN0Um9vdCAhPSBudWxsICYmIF9hc3RSb290LnR5cGVzKCkuc2l6ZSgpID09IDApIHsKKwkJ
CQlpZiAoX2FzdFJvb3QuZ2V0UGFja2FnZSgpLmdldE5hbWUoKS5nZXRGdWxseVF1YWxpZmllZE5h
bWUoKS5lcXVhbHMobmFtZSkpIHsKKwkJCQkJaWYgKF9maWxlICE9IG51bGwgJiYgInBhY2thZ2Ut
aW5mby5qYXZhIi5lcXVhbHNJZ25vcmVDYXNlKF9maWxlLmdldE5hbWUoKSkpIHsgLy8kTk9OLU5M
Uy0xJAorCQkJCQkJSVBhY2thZ2VCaW5kaW5nIGJpbmRpbmcgPSBfYXN0Um9vdC5nZXRQYWNrYWdl
KCkucmVzb2x2ZUJpbmRpbmcoKTsKKwkJCQkJCXJldHVybiBuZXcgUGFja2FnZURlY2xhcmF0aW9u
SW1wbChiaW5kaW5nLCBudWxsLCB0aGlzLCB0cnVlLCBwa2dGcmFncywgdHJ1ZSk7CisJCQkJCX0K
KwkJCQl9CisJCQl9CiAKIAkJCS8vIFdlIHNob3VsZCBiZSBhYmxlIHRvIGNyZWF0ZSBhIGNsYXNz
IG9yCiAJCQkvLyBzb3VyY2UgZmlsZSBmcm9tIG9uZSBvZiB0aGUgcGFja2FnZXMuCkBAIC02NzYs
MTAgKzY4NiwxNCBAQAogICAgIHsKICAgICAgICAgYXNzZXJ0IGJpbmRpbmcuZ2V0S2luZCgpID09
IElCaW5kaW5nLlRZUEUgfHwKICAgICAgICAgICAgICAgIGJpbmRpbmcuZ2V0S2luZCgpID09IElC
aW5kaW5nLk1FVEhPRCB8fAotICAgICAgICAgICAgICAgYmluZGluZy5nZXRLaW5kKCkgPT0gSUJp
bmRpbmcuVkFSSUFCTEUgOworICAgICAgICAgICAgICAgYmluZGluZy5nZXRLaW5kKCkgPT0gSUJp
bmRpbmcuVkFSSUFCTEUgfHwKKyAgICAgICAgICAgICAgIGJpbmRpbmcuZ2V0S2luZCgpID09IElC
aW5kaW5nLlBBQ0tBR0U7CiAgICAgICAgIENvbXBpbGF0aW9uVW5pdCBkb21Vbml0ID0gc2VhcmNo
TG9jYWxseUZvckJpbmRpbmcoYmluZGluZyk7ICAgICAgICAKICAgICAgICAgaWYoIGRvbVVuaXQg
IT0gbnVsbCApIAogICAgICAgICAJcmV0dXJuIGRvbVVuaXQ7CisgICAgICAgIGlmIChiaW5kaW5n
LmdldEtpbmQoKSA9PSBJQmluZGluZy5QQUNLQUdFKSB7CisgICAgICAgIAlyZXR1cm4gbnVsbDsK
KyAgICAgICAgfQogICAgICAgICBlbHNlewogCQkJZmluYWwgSU1lbWJlciBtZW1iZXIgPSAoSU1l
bWJlciliaW5kaW5nLmdldEphdmFFbGVtZW50KCk7CiAJCQlmaW5hbCBJQ29tcGlsYXRpb25Vbml0
IHVuaXQ7CmRpZmYgLS1naXQgYS9vcmcuZWNsaXBzZS5qZHQuYXB0LmNvcmUvc3JjL29yZy9lY2xp
cHNlL2pkdC9hcHQvY29yZS9pbnRlcm5hbC91dGlsL0ZhY3RvcnkuamF2YSBiL29yZy5lY2xpcHNl
LmpkdC5hcHQuY29yZS9zcmMvb3JnL2VjbGlwc2UvamR0L2FwdC9jb3JlL2ludGVybmFsL3V0aWwv
RmFjdG9yeS5qYXZhCmluZGV4IDdmZGJmNTUuLjA4ZGM3NTIgMTAwNjQ0Ci0tLSBhL29yZy5lY2xp
cHNlLmpkdC5hcHQuY29yZS9zcmMvb3JnL2VjbGlwc2UvamR0L2FwdC9jb3JlL2ludGVybmFsL3V0
aWwvRmFjdG9yeS5qYXZhCisrKyBiL29yZy5lY2xpcHNlLmpkdC5hcHQuY29yZS9zcmMvb3JnL2Vj
bGlwc2UvamR0L2FwdC9jb3JlL2ludGVybmFsL3V0aWwvRmFjdG9yeS5qYXZhCkBAIC0xLDUgKzEs
NSBAQAogLyoqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioq
KioqKioqKioqKioqKioqKioqKioqKioqKioqKioKLSAqIENvcHlyaWdodCAoYykgMjAwNSwgMjAw
OCBCRUEgU3lzdGVtcywgSW5jLgorICogQ29weXJpZ2h0IChjKSAyMDA1LCAyMDEyIEJFQSBTeXN0
ZW1zLCBJbmMuIGFuZCBvdGhlcnMKICAqIEFsbCByaWdodHMgcmVzZXJ2ZWQuIFRoaXMgcHJvZ3Jh
bSBhbmQgdGhlIGFjY29tcGFueWluZyBtYXRlcmlhbHMKICAqIGFyZSBtYWRlIGF2YWlsYWJsZSB1
bmRlciB0aGUgdGVybXMgb2YgdGhlIEVjbGlwc2UgUHVibGljIExpY2Vuc2UgdjEuMAogICogd2hp
Y2ggYWNjb21wYW5pZXMgdGhpcyBkaXN0cmlidXRpb24sIGFuZCBpcyBhdmFpbGFibGUgYXQKQEAg
LTEwNyw3ICsxMDcsMTIgQEAKICAgICAgICAgICAgIGlmKCBkZWNsYXJpbmdUeXBlICE9IG51bGwg
JiYgZGVjbGFyaW5nVHlwZS5pc0Fubm90YXRpb24oKSApCiAgICAgICAgICAgICAgICAgcmV0dXJu
IG5ldyBBbm5vdGF0aW9uRWxlbWVudERlY2xhcmF0aW9uSW1wbChtZXRob2QsIGVudik7CiAgICAg
ICAgICAgICBlbHNlCi0gICAgICAgICAgICAgICAgcmV0dXJuIG5ldyBNZXRob2REZWNsYXJhdGlv
bkltcGwobWV0aG9kLCBlbnYpOyAgICAgICAgICAgICAKKyAgICAgICAgICAgICAgICByZXR1cm4g
bmV3IE1ldGhvZERlY2xhcmF0aW9uSW1wbChtZXRob2QsIGVudik7CisgICAgICAgIGNhc2UgSUJp
bmRpbmcuUEFDS0FHRToKKyAgICAgICAgICAgIC8vIGh0dHBzOi8vYnVncy5lY2xpcHNlLm9yZy9i
dWdzL3Nob3dfYnVnLmNnaT9pZD0zNTI5NDkKKyAgICAgICAgICAgIC8vIERvbid0IHRocm93IGFu
IGV4Y2VwdGlvbiwgYnV0IGp1c3QgcmV0dXJuIG51bGwuIAorICAgICAgICAJLy8gYXB0IGFsc28g
ZG9lc24ndCByZXR1cm4gYSB2YWx1ZQorICAgICAgICAJcmV0dXJuIG51bGw7CiAgICAgICAgIGRl
ZmF1bHQ6CiAgICAgICAgICAgICB0aHJvdyBuZXcgSWxsZWdhbFN0YXRlRXhjZXB0aW9uKCJmYWls
ZWQgdG8gY3JlYXRlIGRlY2xhcmF0aW9uIGZyb20gIiArIGJpbmRpbmcpOyAvLyROT04tTkxTLTEk
CiAgICAgICAgIH0gICAgIApkaWZmIC0tZ2l0IGEvb3JnLmVjbGlwc2UuamR0LmFwdC50ZXN0cy9z
cmMvb3JnL2VjbGlwc2UvamR0L2FwdC90ZXN0cy9NaXJyb3JEZWNsYXJhdGlvblRlc3RzLmphdmEg
Yi9vcmcuZWNsaXBzZS5qZHQuYXB0LnRlc3RzL3NyYy9vcmcvZWNsaXBzZS9qZHQvYXB0L3Rlc3Rz
L01pcnJvckRlY2xhcmF0aW9uVGVzdHMuamF2YQppbmRleCA5OWZiZjQ3Li4wYmVjZGQ4IDEwMDY0
NAotLS0gYS9vcmcuZWNsaXBzZS5qZHQuYXB0LnRlc3RzL3NyYy9vcmcvZWNsaXBzZS9qZHQvYXB0
L3Rlc3RzL01pcnJvckRlY2xhcmF0aW9uVGVzdHMuamF2YQorKysgYi9vcmcuZWNsaXBzZS5qZHQu
YXB0LnRlc3RzL3NyYy9vcmcvZWNsaXBzZS9qZHQvYXB0L3Rlc3RzL01pcnJvckRlY2xhcmF0aW9u
VGVzdHMuamF2YQpAQCAtMTIsNiArMTIsNyBAQAogCiBwYWNrYWdlIG9yZy5lY2xpcHNlLmpkdC5h
cHQudGVzdHM7CiAKK2ltcG9ydCBqYXZhLnV0aWwuQ29sbGVjdGlvbjsKIGltcG9ydCBqYXZhLnV0
aWwuTWFwOwogCiBpbXBvcnQganVuaXQuZnJhbWV3b3JrLlRlc3Q7CkBAIC0zNiw2ICszNyw3IEBA
CiBpbXBvcnQgY29tLnN1bi5taXJyb3IuZGVjbGFyYXRpb24uQW5ub3RhdGlvblR5cGVFbGVtZW50
RGVjbGFyYXRpb247CiBpbXBvcnQgY29tLnN1bi5taXJyb3IuZGVjbGFyYXRpb24uQW5ub3RhdGlv
blZhbHVlOwogaW1wb3J0IGNvbS5zdW4ubWlycm9yLmRlY2xhcmF0aW9uLkRlY2xhcmF0aW9uOwor
aW1wb3J0IGNvbS5zdW4ubWlycm9yLmRlY2xhcmF0aW9uLlBhY2thZ2VEZWNsYXJhdGlvbjsKIGlt
cG9ydCBjb20uc3VuLm1pcnJvci5kZWNsYXJhdGlvbi5UeXBlRGVjbGFyYXRpb247CiBpbXBvcnQg
Y29tLnN1bi5taXJyb3IudXRpbC5Tb3VyY2VQb3NpdGlvbjsKIApAQCAtMjYyLDYgKzI2NCw1OSBA
QAogCQlhc3NlcnRUcnVlKCJQcm9jZXNzb3Igbm90IGludm9rZWQiLCBwLmNhbGxlZCk7CiAJfQog
CQorCXB1YmxpYyB2b2lkIHRlc3RQYWNrYWdlSW5mbygpIHsKKwkJUGFja2FnZUluZm9Qcm9jIHAg
PSBuZXcgUGFja2FnZUluZm9Qcm9jKHRydWUpOyAKKwkJR2VuZXJpY0ZhY3Rvcnkuc2V0UHJvY2Vz
c29yKHApOworCQkKKwkJSVByb2plY3QgcHJvamVjdCA9IGVudi5nZXRQcm9qZWN0KCBnZXRQcm9q
ZWN0TmFtZSgpICk7CisJCUlQYXRoIHNyY1Jvb3QgPSBnZXRTb3VyY2VQYXRoKCk7CisJCUlQYXRo
IHBrZyA9IGVudi5hZGRQYWNrYWdlKHNyY1Jvb3QsICJwa2ciKTsKKwkJU3RyaW5nIGNvbnRlbnRz
ID0gIkBQa2dBbm5vdGF0aW9uXG4iICsKKwkJCQkJCSAgIkBHZW5lcmljQW5ub3RhdGlvblxuIiAr
CisJCQkJCQkgICJwYWNrYWdlIHBrZztcbiIgKworCQkJCQkJICAiaW1wb3J0IG9yZy5lY2xpcHNl
LmpkdC5hcHQudGVzdHMuYW5ub3RhdGlvbnMuZ2VuZXJpYy4qOyI7CisJCWVudi5hZGRGaWxlKHBr
ZywgInBhY2thZ2UtaW5mby5qYXZhIiwgY29udGVudHMpOworCQlTdHJpbmcgYW5uQ29udGVudHMg
PQorCQkJCSJwYWNrYWdlIHBrZztcbiIgKworCQkJCSJcbiIgKworCQkJCSJAaW50ZXJmYWNlIFBr
Z0Fubm90YXRpb24ge1xuIiArCisJCQkJIiAgICBTdHJpbmcgdmFsdWUoKSBkZWZhdWx0IFwiZGVm
XCI7XG4iICsKKwkJCQkifVxuIjsKKwkJZW52LmFkZENsYXNzKHNyY1Jvb3QsICJwa2ciLCAiUGtn
QW5ub3RhdGlvbiIsIGFubkNvbnRlbnRzKTsKKwkJZnVsbEJ1aWxkKCBwcm9qZWN0LmdldEZ1bGxQ
YXRoKCkgKTsKKwkJZXhwZWN0aW5nTm9Qcm9ibGVtcygpOworCQkKKwkJYXNzZXJ0VHJ1ZSgiUHJv
Y2Vzc29yIG5vdCBpbnZva2VkIiwgcC5jYWxsZWQpOworCX0KKwkKKwlwdWJsaWMgdm9pZCB0ZXN0
UGFja2FnZUluZm9PZk90aGVyQ2xhc3MoKSB7CisJCVBhY2thZ2VJbmZvUHJvYyBwID0gbmV3IFBh
Y2thZ2VJbmZvUHJvYyhmYWxzZSk7IAorCQlHZW5lcmljRmFjdG9yeS5zZXRQcm9jZXNzb3IocCk7
CisJCQorCQlJUHJvamVjdCBwcm9qZWN0ID0gZW52LmdldFByb2plY3QoIGdldFByb2plY3ROYW1l
KCkgKTsKKwkJSVBhdGggc3JjUm9vdCA9IGdldFNvdXJjZVBhdGgoKTsKKwkJSVBhdGggcGtnID0g
ZW52LmFkZFBhY2thZ2Uoc3JjUm9vdCwgInBrZyIpOworCQlTdHJpbmcgY29udGVudHMgPSAiQFBr
Z0Fubm90YXRpb25cbiIgKworCQkJCQkJICAicGFja2FnZSBwa2c7IjsKKwkJZW52LmFkZEZpbGUo
cGtnLCAicGFja2FnZS1pbmZvLmphdmEiLCBjb250ZW50cyk7CisJCVN0cmluZyBhbm5Db250ZW50
cyA9CisJCQkJInBhY2thZ2UgcGtnO1xuIiArCisJCQkJIlxuIiArCisJCQkJIkBpbnRlcmZhY2Ug
UGtnQW5ub3RhdGlvbiB7XG4iICsKKwkJCQkiICAgIFN0cmluZyB2YWx1ZSgpIGRlZmF1bHQgXCJk
ZWZcIjtcbiIgKworCQkJCSJ9XG4iOworCQllbnYuYWRkQ2xhc3Moc3JjUm9vdCwgInBrZyIsICJQ
a2dBbm5vdGF0aW9uIiwgYW5uQ29udGVudHMpOworCQljb250ZW50cyA9ICJwYWNrYWdlIG90aGVy
cGtnO1xuIisKKwkJICAgICAgICAgICAiaW1wb3J0IG9yZy5lY2xpcHNlLmpkdC5hcHQudGVzdHMu
YW5ub3RhdGlvbnMuZ2VuZXJpYy4qO1xuIisKKwkJICAgICAgICAgICAiQEdlbmVyaWNBbm5vdGF0
aW9uXG4iICsKKwkJICAgICAgICAgICAiY2xhc3MgVGVzdHt9IjsKKwkJZW52LmFkZENsYXNzKHNy
Y1Jvb3QsICJvdGhlcnBrZyIsICJUZXN0IiwgY29udGVudHMpOworCQlmdWxsQnVpbGQoIHByb2pl
Y3QuZ2V0RnVsbFBhdGgoKSApOworCQlleHBlY3RpbmdOb1Byb2JsZW1zKCk7CisJCQorCQlhc3Nl
cnRUcnVlKCJQcm9jZXNzb3Igbm90IGludm9rZWQiLCBwLmNhbGxlZCk7CisJfQorCQogCXN0YXRp
YyBjbGFzcyBUZXN0TG9jYXRpb25Qcm9jIGV4dGVuZHMgQWJzdHJhY3RHZW5lcmljUHJvY2Vzc29y
IHsKIAogCQlib29sZWFuIGNhbGxlZDsKQEAgLTI4NCw3ICszMzksNyBAQAogCQkKIAkJcHVibGlj
IHZvaWQgX3Byb2Nlc3MoKSB7CiAJCQljYWxsZWQgPSB0cnVlOwotCQkJVHlwZURlY2xhcmF0aW9u
IHRkQ29kZSA9IGVudi5nZXRUeXBlRGVjbGFyYXRpb24oU291cmNlTWlycm9yQ29kZUV4YW1wbGUu
Q09ERV9QQUNLQUdFICsgIi4iICsgU291cmNlTWlycm9yQ29kZUV4YW1wbGUuQU5OT19DT0RFX0NM
QVNTX05BTUUpOworCQkJVHlwZURlY2xhcmF0aW9uIHRkQ29kZSA9IGVudi5nZXRUeXBlRGVjbGFy
YXRpb24oU291cmNlTWlycm9yQ29kZUV4YW1wbGUuQ09ERV9QQUNLQUdFICsgIi4iICsgU291cmNl
TWlycm9yQ29kZUV4YW1wbGUuQ09ERV9DTEFTU19OQU1FKTsKIAkJCWZvciAoQW5ub3RhdGlvbk1p
cnJvciBhbSA6IHRkQ29kZS5nZXRBbm5vdGF0aW9uTWlycm9ycygpKSB7CiAJCQkJaWYgKCJHZW5l
cmljQW5ub3RhdGlvbiIuZXF1YWxzKGFtLmdldEFubm90YXRpb25UeXBlKCkuZ2V0RGVjbGFyYXRp
b24oKS5nZXRTaW1wbGVOYW1lKCkpKSB7CiAJCQkJCWNvbnRpbnVlOwpAQCAtMzAwLDYgKzM1NSw0
NCBAQAogCQl9CiAJfQogCQorCXN0YXRpYyBjbGFzcyBQYWNrYWdlSW5mb1Byb2MgZXh0ZW5kcyBB
YnN0cmFjdEdlbmVyaWNQcm9jZXNzb3IgeworCQkKKwkJYm9vbGVhbiBjYWxsZWQ7CisJCWJvb2xl
YW4gYW5ub3RJblNhbWVQa2c7CisJCXB1YmxpYyBQYWNrYWdlSW5mb1Byb2MoYm9vbGVhbiBhbm5v
dEluU2FtZVBrZykgeworCQkJdGhpcy5hbm5vdEluU2FtZVBrZyA9IGFubm90SW5TYW1lUGtnOwor
CQl9CisJCXB1YmxpYyB2b2lkIF9wcm9jZXNzKCkgeworCQkJY2FsbGVkID0gdHJ1ZTsKKwkJCUFu
bm90YXRpb25UeXBlRGVjbGFyYXRpb24gYW5ub0RlY2wgPSAoQW5ub3RhdGlvblR5cGVEZWNsYXJh
dGlvbillbnYuZ2V0VHlwZURlY2xhcmF0aW9uKCJwa2cuUGtnQW5ub3RhdGlvbiIpOworCQkJYXNz
ZXJ0VHJ1ZShudWxsICE9IGFubm9EZWNsKTsJCQkKKwkJCS8vIGdldCB0aGUgYW5ub3RhdGVkIGRl
Y2xhcmF0aW9ucworCQkJQ29sbGVjdGlvbjxEZWNsYXJhdGlvbj4gYW5ub3RhdGVkRGVjbHMgPSBl
bnYuZ2V0RGVjbGFyYXRpb25zQW5ub3RhdGVkV2l0aChhbm5vRGVjbCk7CisJCQkvLyBkb24ndCBy
ZXR1cm4gdGhlIHBhY2thZ2UgZGVjbGFyYXRpb24gLSB3ZWxsLCBhcHQgaXMgZG9pbmcgdGhhdC4u
IAorCQkJYXNzZXJ0VHJ1ZShhbm5vdGF0ZWREZWNscyA9PSBudWxsICB8fCBhbm5vdGF0ZWREZWNs
cy5zaXplKCkgPT0gMCk7IAorCQkJCisJCQlQYWNrYWdlRGVjbGFyYXRpb24gcGRDb2RlID0gZW52
LmdldFBhY2thZ2UoInBrZyIpOworCQkJZm9yIChBbm5vdGF0aW9uTWlycm9yIGFtIDogcGRDb2Rl
LmdldEFubm90YXRpb25NaXJyb3JzKCkpIHsKKwkJCQlpZiAoIkdlbmVyaWNBbm5vdGF0aW9uIi5l
cXVhbHMoYW0uZ2V0QW5ub3RhdGlvblR5cGUoKS5nZXREZWNsYXJhdGlvbigpLmdldFNpbXBsZU5h
bWUoKSkpIHsKKwkJCQkJY29udGludWU7CisJCQkJfQorCQkJCWlmICh0aGlzLmFubm90SW5TYW1l
UGtnKSB7CisJCQkJCWFzc2VydFRydWUobnVsbCAhPSBhbS5nZXRQb3NpdGlvbigpKTsKKwkJCQl9
ZWxzZSB7CisJCQkJCS8vIHBhY2thZ2UtaW5mby5qYXZhIGluIG5vdCBnZXR0aW5nIHByb2Nlc3Nl
ZAorCQkJCQkvLyBhbmQgaGVuY2UgdGhpcyBpcyBPSy4uCisJCQkJCWFzc2VydFRydWUobnVsbCA9
PSBhbS5nZXRQb3NpdGlvbigpKTsKKwkJCQl9CisJCQkJQW5ub3RhdGlvblR5cGVEZWNsYXJhdGlv
biBhdGQgPSBhbS5nZXRBbm5vdGF0aW9uVHlwZSgpLmdldERlY2xhcmF0aW9uKCk7CisJCQkJYXNz
ZXJ0VHJ1ZShudWxsICE9IGF0ZC5nZXRQb3NpdGlvbigpKTsKKwkJCQlmb3IgKE1hcC5FbnRyeTxB
bm5vdGF0aW9uVHlwZUVsZW1lbnREZWNsYXJhdGlvbiwgQW5ub3RhdGlvblZhbHVlPiBlbnRyeSA6
IGFtLmdldEVsZW1lbnRWYWx1ZXMoKS5lbnRyeVNldCgpKSB7CisJCQkJCWFzc2VydE5vdE51bGwo
ZW50cnkuZ2V0S2V5KCkuZ2V0UG9zaXRpb24oKSk7CisJCQkJCWFzc2VydE5vdE51bGwoZW50cnku
Z2V0S2V5KCkuZ2V0RGVmYXVsdFZhbHVlKCkuZ2V0UG9zaXRpb24oKSk7CisJCQkJfQorCQkJIH0K
KwkJfQorCX0KKwkKIAlwdWJsaWMgdm9pZCB0ZXN0RW52RmFjdG9yeSgpIHRocm93cyBKYXZhTW9k
ZWxFeGNlcHRpb24gewogCiAJCUlQcm9qZWN0IHByb2plY3QgPSBlbnYuZ2V0UHJvamVjdChnZXRQ
cm9qZWN0TmFtZSgpKTsKZGlmZiAtLWdpdCBhL29yZy5lY2xpcHNlLmpkdC5jb3JlL2RvbS9vcmcv
ZWNsaXBzZS9qZHQvY29yZS9kb20vUGFja2FnZUJpbmRpbmcuamF2YSBiL29yZy5lY2xpcHNlLmpk
dC5jb3JlL2RvbS9vcmcvZWNsaXBzZS9qZHQvY29yZS9kb20vUGFja2FnZUJpbmRpbmcuamF2YQpp
bmRleCAxNDg1ODRlLi5iY2I0ODUxIDEwMDY0NAotLS0gYS9vcmcuZWNsaXBzZS5qZHQuY29yZS9k
b20vb3JnL2VjbGlwc2UvamR0L2NvcmUvZG9tL1BhY2thZ2VCaW5kaW5nLmphdmEKKysrIGIvb3Jn
LmVjbGlwc2UuamR0LmNvcmUvZG9tL29yZy9lY2xpcHNlL2pkdC9jb3JlL2RvbS9QYWNrYWdlQmlu
ZGluZy5qYXZhCkBAIC01NSw2ICs1NSwxOSBAQAogCiAJcHVibGljIElBbm5vdGF0aW9uQmluZGlu
Z1tdIGdldEFubm90YXRpb25zKCkgewogCQl0cnkgeworCQkJQVNUTm9kZSBub2RlID0gdGhpcy5y
ZXNvbHZlci5maW5kRGVjbGFyaW5nTm9kZSh0aGlzKTsKKwkJCWlmIChub2RlICE9IG51bGwpIHsK
KwkJCQlBU1ROb2RlIHBhcmVudCA9IG5vZGUuZ2V0UGFyZW50KCk7CisJCQkJaWYgKHBhcmVudCBp
bnN0YW5jZW9mIENvbXBpbGF0aW9uVW5pdCAmJiAoKENvbXBpbGF0aW9uVW5pdClwYXJlbnQpLnR5
cGVzKCkuc2l6ZSgpID09IDApIHsKKwkJCQkJb3JnLmVjbGlwc2UuamR0LmludGVybmFsLmNvbXBp
bGVyLmFzdC5BU1ROb2RlIGNvbXBOb2RlID0gdGhpcy5yZXNvbHZlci5nZXRDb3JyZXNwb25kaW5n
Tm9kZShwYXJlbnQpOworCQkJCQlpZiAoY29tcE5vZGUgIT0gbnVsbCkgeworCQkJCQkJb3JnLmVj
bGlwc2UuamR0LmludGVybmFsLmNvbXBpbGVyLmFzdC5UeXBlRGVjbGFyYXRpb25bXSB0eXBlRGVj
bCA9ICgob3JnLmVjbGlwc2UuamR0LmludGVybmFsLmNvbXBpbGVyLmFzdC5Db21waWxhdGlvblVu
aXREZWNsYXJhdGlvbiljb21wTm9kZSkudHlwZXM7CisJCQkJCQlpZiAodHlwZURlY2wgIT0gbnVs
bCAmJiB0eXBlRGVjbC5sZW5ndGggPT0gMSAmJiBDaGFyT3BlcmF0aW9uLmVxdWFscyh0eXBlRGVj
bFswXS5uYW1lLCBUeXBlQ29uc3RhbnRzLlBBQ0tBR0VfSU5GT19OQU1FKSkgeworCQkJCQkJCXJl
dHVybiBnZXRBbm5vdGF0aW9ucygoUGFja2FnZURlY2xhcmF0aW9uKW5vZGUpOworCQkJCQkJfQor
CQkJCQl9CisJCQkJfQorCQkJfQogCQkJSU5hbWVFbnZpcm9ubWVudCBuYW1lRW52aXJvbm1lbnQg
PSB0aGlzLmJpbmRpbmcuZW52aXJvbm1lbnQubmFtZUVudmlyb25tZW50OwogCQkJaWYgKCEobmFt
ZUVudmlyb25tZW50IGluc3RhbmNlb2YgU2VhcmNoYWJsZUVudmlyb25tZW50KSkKIAkJCQlyZXR1
cm4gQW5ub3RhdGlvbkJpbmRpbmcuTm9Bbm5vdGF0aW9uczsKQEAgLTgyLDE4ICs5NSw3IEBACiAJ
CQkJCQkJQ29tcGlsYXRpb25Vbml0IGRvbVVuaXQgPSAoQ29tcGlsYXRpb25Vbml0KSBwLmNyZWF0
ZUFTVChudWxsKTsKIAkJCQkJCQlQYWNrYWdlRGVjbGFyYXRpb24gcGtnRGVjbCA9IGRvbVVuaXQu
Z2V0UGFja2FnZSgpOwogCQkJCQkJCWlmIChwa2dEZWNsICE9IG51bGwpIHsKLQkJCQkJCQkJTGlz
dCBhbm5vcyA9IHBrZ0RlY2wuYW5ub3RhdGlvbnMoKTsKLQkJCQkJCQkJaWYgKGFubm9zID09IG51
bGwgfHwgYW5ub3MuaXNFbXB0eSgpKQotCQkJCQkJCQkJcmV0dXJuIEFubm90YXRpb25CaW5kaW5n
Lk5vQW5ub3RhdGlvbnM7Ci0JCQkJCQkJCUlBbm5vdGF0aW9uQmluZGluZ1tdIHJlc3VsdCA9IG5l
dyBJQW5ub3RhdGlvbkJpbmRpbmdbYW5ub3Muc2l6ZSgpXTsKLQkJCQkJCQkJaW50IGluZGV4PTA7
Ci0JCSAJCQkJCQlmb3IgKEl0ZXJhdG9yIGl0ID0gYW5ub3MuaXRlcmF0b3IoKTsgaXQuaGFzTmV4
dCgpOyBpbmRleCsrKSB7Ci0JCQkJCQkJCQlyZXN1bHRbaW5kZXhdID0gKChBbm5vdGF0aW9uKSBp
dC5uZXh0KCkpLnJlc29sdmVBbm5vdGF0aW9uQmluZGluZygpOwotCQkJCQkJCQkJLy8gbm90IHJl
c29sdmluZyBiaW5kaW5ncwotCQkJCQkJCQkJaWYgKHJlc3VsdFtpbmRleF0gPT0gbnVsbCkKLQkJ
CQkJCQkJCQlyZXR1cm4gQW5ub3RhdGlvbkJpbmRpbmcuTm9Bbm5vdGF0aW9uczsKLQkJCQkJCQkJ
fQotCQkJCQkJCQlyZXR1cm4gcmVzdWx0OworCQkJCQkJCQlyZXR1cm4gZ2V0QW5ub3RhdGlvbnMo
cGtnRGVjbCk7CiAJCQkJCQkJfQogCQkJCQkJfQogCQkJCQkJYnJlYWs7CkBAIC0xMjcsNiArMTI5
LDIxIEBACiAJCXJldHVybiBBbm5vdGF0aW9uQmluZGluZy5Ob0Fubm90YXRpb25zOwogCX0KIAor
CXByaXZhdGUgSUFubm90YXRpb25CaW5kaW5nW10gZ2V0QW5ub3RhdGlvbnMoUGFja2FnZURlY2xh
cmF0aW9uIHBrZ0RlY2wpIHsKKwkJTGlzdCBhbm5vcyA9IHBrZ0RlY2wuYW5ub3RhdGlvbnMoKTsK
KwkJaWYgKGFubm9zID09IG51bGwgfHwgYW5ub3MuaXNFbXB0eSgpKQorCQkJcmV0dXJuIEFubm90
YXRpb25CaW5kaW5nLk5vQW5ub3RhdGlvbnM7CisJCUlBbm5vdGF0aW9uQmluZGluZ1tdIHJlc3Vs
dCA9IG5ldyBJQW5ub3RhdGlvbkJpbmRpbmdbYW5ub3Muc2l6ZSgpXTsKKwkJaW50IGluZGV4PTA7
CisJCWZvciAoSXRlcmF0b3IgaXQgPSBhbm5vcy5pdGVyYXRvcigpOyBpdC5oYXNOZXh0KCk7IGlu
ZGV4KyspIHsKKwkJCXJlc3VsdFtpbmRleF0gPSAoKEFubm90YXRpb24pIGl0Lm5leHQoKSkucmVz
b2x2ZUFubm90YXRpb25CaW5kaW5nKCk7CisJCQkvLyBub3QgcmVzb2x2aW5nIGJpbmRpbmdzCisJ
CQlpZiAocmVzdWx0W2luZGV4XSA9PSBudWxsKQorCQkJCXJldHVybiBBbm5vdGF0aW9uQmluZGlu
Zy5Ob0Fubm90YXRpb25zOworCQl9CisJCXJldHVybiByZXN1bHQ7CisJfQorCiAJLyoKIAkgKiBA
c2VlIElCaW5kaW5nI2dldE5hbWUoKQogCSAqLw==
</data>

          </attachment>
      

    </bug>

</bugzilla>