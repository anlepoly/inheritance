<?xml version="1.0" encoding="UTF-8" standalone="yes" ?>
<!DOCTYPE bugzilla SYSTEM "https://bugs.eclipse.org/bugs/page.cgi?id=bugzilla.dtd">

<bugzilla version="4.4.7"
          urlbase="https://bugs.eclipse.org/bugs/"
          
          maintainer="webmaster@eclipse.org"
>

    <bug>
          <bug_id>434394</bug_id>
          
          <creation_ts>2014-05-08 05:05:00 -0400</creation_ts>
          <short_desc>[1.8] inference fails in some cases when conditional expression is involved</short_desc>
          <delta_ts>2014-11-30 18:27:43 -0500</delta_ts>
          <reporter_accessible>1</reporter_accessible>
          <cclist_accessible>1</cclist_accessible>
          <classification_id>2</classification_id>
          <classification>Eclipse</classification>
          <product>JDT</product>
          <component>Core</component>
          <version>4.4</version>
          <rep_platform>PC</rep_platform>
          <op_sys>Windows 7</op_sys>
          <bug_status>RESOLVED</bug_status>
          <resolution>FIXED</resolution>
          
          
          <bug_file_loc></bug_file_loc>
          <status_whiteboard></status_whiteboard>
          <keywords></keywords>
          <priority>P3</priority>
          <bug_severity>normal</bug_severity>
          <target_milestone>4.5 M3</target_milestone>
          
          
          <everconfirmed>1</everconfirmed>
          <reporter name="Sasikanth Bharadwaj">saammana</reporter>
          <assigned_to name="Srikanth Sankaran">srikanth_sankaran</assigned_to>
          <cc>jarthana</cc>
    
    <cc>srikanth_sankaran</cc>
    
    <cc>stephan.herrmann</cc>
          
          <votes>0</votes>

      

      

      

          <comment_sort_order>oldest_to_newest</comment_sort_order>  
          <long_desc isprivate="0" >
    <commentid>2398688</commentid>
    <comment_count>0</comment_count>
    <who name="Sasikanth Bharadwaj">saammana</who>
    <bug_when>2014-05-08 05:05:59 -0400</bug_when>
    <thetext>The following code causes compilation error in eclipse but compiles fine with javac.

import java.util.ArrayList;
import java.util.Collections;
import java.util.Comparator;
import java.util.List;

public class InferenceProblem {
  public void bla() {
    boolean b = Boolean.TRUE.booleanValue();
    
    List&lt;String&gt; c1 = new ArrayList&lt;&gt;();
    Collections.sort(c1, new Foo(new State&lt;&gt;((b ? new Val&lt;&gt;(&quot;AAAA&quot;) : new Val&lt;&gt;(&quot;BBBB&quot;))))); // Cannot infer type arguments for State
    Collections.sort(c1,new Foo(b ? new State&lt;&gt;(new Val&lt;&gt;(&quot;AAAA&quot;)) : new State&lt;&gt;(new Val&lt;&gt;(&quot;BBBB&quot;)))); // this is fine
   
  }

  static class Foo implements Comparator&lt;String&gt;{

	  public Foo(State&lt;String&gt; st) {
		  //
	  }
	@Override
	public int compare(String o1, String o2) {
		// TODO Auto-generated method stub
		return 0;
	}
	  
  }
	static class State&lt;R&gt; {
		State(Val&lt;?&gt; o) {
		}
	}
	static class Val&lt;T&gt; {
		Val(T t) {}
	}
}</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>2399191</commentid>
    <comment_count>1</comment_count>
    <who name="Jay Arthanareeswaran">jarthana</who>
    <bug_when>2014-05-09 02:36:52 -0400</bug_when>
    <thetext>Stephan, can you a take a look at this and see if this needs/can be addressed in Luna? Thanks!</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>2403893</commentid>
    <comment_count>2</comment_count>
    <who name="Jay Arthanareeswaran">jarthana</who>
    <bug_when>2014-05-20 00:01:07 -0400</bug_when>
    <thetext>This is not a 1.8 specific bug nor is a regression in Luna. I can see the problem with Kepler as well.

Sasi, can you please confirm?</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>2403959</commentid>
    <comment_count>3</comment_count>
    <who name="Sasikanth Bharadwaj">saammana</who>
    <bug_when>2014-05-20 04:16:19 -0400</bug_when>
    <thetext>(In reply to comment #2)
&gt; This is not a 1.8 specific bug nor is a regression in Luna. I can see the
&gt; problem with Kepler as well.
&gt; 
&gt; Sasi, can you please confirm?
I have tried this only with Luna &amp; 1.8, will try with older versions and update</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>2433122</commentid>
    <comment_count>4</comment_count>
    <who name="Stephan Herrmann">stephan.herrmann</who>
    <bug_when>2014-07-29 10:22:37 -0400</bug_when>
    <thetext>(In reply to Sasikanth Bharadwaj from comment #3)
&gt; (In reply to comment #2)
&gt; &gt; This is not a 1.8 specific bug nor is a regression in Luna. I can see the
&gt; &gt; problem with Kepler as well.
&gt; &gt; 
&gt; &gt; Sasi, can you please confirm?
&gt; I have tried this only with Luna &amp; 1.8, will try with older versions and
&gt; update

If this indeed occurs in other versions, too, I&apos;d like to pass this one on...</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>2455584</commentid>
    <comment_count>5</comment_count>
    <who name="Srikanth Sankaran">srikanth_sankaran</who>
    <bug_when>2014-09-23 23:16:56 -0400</bug_when>
    <thetext>(In reply to Jayaprakash Arthanareeswaran from comment #2)
&gt; This is not a 1.8 specific bug nor is a regression in Luna. I can see the
&gt; problem with Kepler as well.

We are supposed to reject the code at 1.7- and likely compile in 1.8. 1.8 defines
better semantics of target type propagation for reference conditionals.

javac 1.7 and ECJ 1.7 reject it.</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>2462489</commentid>
    <comment_count>6</comment_count>
    <who name="Srikanth Sankaran">srikanth_sankaran</who>
    <bug_when>2014-10-09 14:33:46 -0400</bug_when>
    <thetext>Patch set at https://bugs.eclipse.org/bugs/show_bug.cgi?id=437444
solves this problem.</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>2467644</commentid>
    <comment_count>7</comment_count>
    <who name="Srikanth Sankaran">srikanth_sankaran</who>
    <bug_when>2014-10-19 00:24:14 -0400</bug_when>
    <thetext>(In reply to Srikanth Sankaran from comment #6)
&gt; Patch set at https://bugs.eclipse.org/bugs/show_bug.cgi?id=437444
&gt; solves this problem.

So, I&apos;ll take this to closure. Thanks.</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>2471789</commentid>
    <comment_count>8</comment_count>
    <who name="Srikanth Sankaran">srikanth_sankaran</who>
    <bug_when>2014-10-25 12:39:55 -0400</bug_when>
    <thetext>junit released here: http://git.eclipse.org/c/jdt/eclipse.jdt.core.git/commit/?id=86bf731eb8aa7a8b6103fb2b5f43509848efb179.

This is fixed as part of http://git.eclipse.org/c/jdt/eclipse.jdt.core.git/commit/?id=f357f309273e0bfe8345ff708d18fa83c6a34931 made on behalf of 
https://bugs.eclipse.org/bugs/show_bug.cgi?id=437444</thetext>
  </long_desc>
      
      

    </bug>

</bugzilla>