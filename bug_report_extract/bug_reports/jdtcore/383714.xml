<?xml version="1.0" encoding="UTF-8" standalone="yes" ?>
<!DOCTYPE bugzilla SYSTEM "https://bugs.eclipse.org/bugs/page.cgi?id=bugzilla.dtd">

<bugzilla version="4.4.7"
          urlbase="https://bugs.eclipse.org/bugs/"
          
          maintainer="webmaster@eclipse.org"
>

    <bug>
          <bug_id>383714</bug_id>
          
          <creation_ts>2012-06-28 01:37:00 -0400</creation_ts>
          <short_desc>[1.8][compiler] Compile fails to reject 1.8 constructs at 1.7- modes.</short_desc>
          <delta_ts>2012-07-11 04:04:27 -0400</delta_ts>
          <reporter_accessible>1</reporter_accessible>
          <cclist_accessible>1</cclist_accessible>
          <classification_id>2</classification_id>
          <classification>Eclipse</classification>
          <product>JDT</product>
          <component>Core</component>
          <version>3.8</version>
          <rep_platform>All</rep_platform>
          <op_sys>All</op_sys>
          <bug_status>RESOLVED</bug_status>
          <resolution>FIXED</resolution>
          
          
          <bug_file_loc></bug_file_loc>
          <status_whiteboard></status_whiteboard>
          <keywords></keywords>
          <priority>P3</priority>
          <bug_severity>enhancement</bug_severity>
          <target_milestone>BETA J8</target_milestone>
          
          <blocked>380188</blocked>
          <everconfirmed>1</everconfirmed>
          <reporter name="Srikanth Sankaran">srikanth_sankaran</reporter>
          <assigned_to name="Srikanth Sankaran">srikanth_sankaran</assigned_to>
          <cc>amj87.iitr</cc>
    
    <cc>markus_keller</cc>
    
    <cc>stephan.herrmann</cc>
          
          <votes>0</votes>

      

      

      

          <comment_sort_order>oldest_to_newest</comment_sort_order>  
          <long_desc isprivate="0" >
    <commentid>2130117</commentid>
    <comment_count>0</comment_count>
    <who name="Srikanth Sankaran">srikanth_sankaran</who>
    <bug_when>2012-06-28 01:37:45 -0400</bug_when>
    <thetext>BETA_JAVA8:

This is a spin off by splitting bug 381358 into two: One dealing with
correctness issues (the current bug) and the other dealing with quality of
diagnostics (bug 381358). This is so that the correctness issues could be
worked on an a priority basis:

(1) The following program does not elicit an error message at the
moment, when compiled as a 1.7- project. It should be rejected with
a message that reads &quot;Default methods are available only at source 
level 1.8 or above&quot;

// -----
interface I {
  public void foo() default { System.out.println(&quot;Place holder&quot;); }
}

(2) The following program should be rejected at 1.7-, but is not at 
the moment:
// ---
interface I {
  void foo(int p);
}
public class X {
  I i = System::exit;
}

(3) 
// ---------------------------
interface I {
  int foo(int p);
}
public class X {
  I i = p -&gt; 10;
}</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>2130415</commentid>
    <comment_count>1</comment_count>
    <who name="Srikanth Sankaran">srikanth_sankaran</who>
    <bug_when>2012-06-28 09:36:09 -0400</bug_when>
    <thetext>Fix and tests released via http://git.eclipse.org/c/jdt/eclipse.jdt.core.git/commit/?id=8ff32a67561d85d16e0a42904446ef1ba698078c</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>2135456</commentid>
    <comment_count>2</comment_count>
    <who name="Ayushman Jain">amj87.iitr</who>
    <bug_when>2012-07-11 03:40:08 -0400</bug_when>
    <thetext>In this program, a few constructs are properly reported, but others aren&apos;t
(Using 1.7 compliance)

interface I {
	
}
public class Action&lt;K&gt; {
	class Inner {
		
	}
	
	&lt;T&gt; Action&lt;T&gt; retT(T t) {
		return new Action&lt;T&gt;();
	}
	
	
	public void f1(Object[] o[][]) {}
    public void foo() { 
        I len1 = Action::&lt;String&gt;bar ;  // reported as method ref. not allowed
    	I len2 = Action&lt;Integer&gt;::&lt;String&gt;bar ;  // syntax error
        I len3 = Action&lt;Integer&gt;::bar ;   // syntax error
    }
}

Just like the first expression, it&apos;ll be nice to have the &quot;Method references are allowed only at source level 1.8 or above&quot; warning on the last two expressions.</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>2135476</commentid>
    <comment_count>3</comment_count>
    <who name="Srikanth Sankaran">srikanth_sankaran</who>
    <bug_when>2012-07-11 04:04:27 -0400</bug_when>
    <thetext>(In reply to comment #2)

&gt;         I len1 = Action::&lt;String&gt;bar ;  // reported as method ref. not allowed

This is because, this does not require any look ahead.

&gt;         I len2 = Action&lt;Integer&gt;::&lt;String&gt;bar ;  // syntax error
&gt;         I len3 = Action&lt;Integer&gt;::bar ;   // syntax error

These require look ahead to be recognized as ReferenceExpressions and
look ahead is turned off at 1.7-.

As mentioned elsewhere, if early experiments that show that always-look-ahead
policy results in near zero degradation stand scrutiny, then we may adopt that
policy and the quality of error messages (the subject of bug 381358) should
improve.

See also https://bugs.eclipse.org/bugs/show_bug.cgi?id=383378#c9
Ayush, does the PRECEDES set look right ?

See also  https://bugs.eclipse.org/bugs/show_bug.cgi?id=383378#c11
 https://bugs.eclipse.org/bugs/show_bug.cgi?id=383378#c13
 https://bugs.eclipse.org/bugs/show_bug.cgi?id=383378#16</thetext>
  </long_desc>
      
      

    </bug>

</bugzilla>