<?xml version="1.0" encoding="UTF-8" standalone="yes" ?>
<!DOCTYPE bugzilla SYSTEM "https://bugs.eclipse.org/bugs/page.cgi?id=bugzilla.dtd">

<bugzilla version="4.4.7"
          urlbase="https://bugs.eclipse.org/bugs/"
          
          maintainer="webmaster@eclipse.org"
>

    <bug>
          <bug_id>400650</bug_id>
          
          <creation_ts>2013-02-13 01:45:00 -0500</creation_ts>
          <short_desc>[1.8] ASTRewrite Implementation and Testing of annotations on subtypes of Type and TypeParameter</short_desc>
          <delta_ts>2013-04-04 06:24:00 -0400</delta_ts>
          <reporter_accessible>1</reporter_accessible>
          <cclist_accessible>1</cclist_accessible>
          <classification_id>2</classification_id>
          <classification>Eclipse</classification>
          <product>JDT</product>
          <component>Core</component>
          <version>4.3</version>
          <rep_platform>PC</rep_platform>
          <op_sys>Windows 7</op_sys>
          <bug_status>RESOLVED</bug_status>
          <resolution>FIXED</resolution>
          
          
          <bug_file_loc></bug_file_loc>
          <status_whiteboard></status_whiteboard>
          <keywords></keywords>
          <priority>P3</priority>
          <bug_severity>normal</bug_severity>
          <target_milestone>BETA J8</target_milestone>
          
          <blocked>398940</blocked>
          <everconfirmed>1</everconfirmed>
          <reporter name="Manoj Palat Away Until May 11 2015">manpalat</reporter>
          <assigned_to name="shankha banerjee">shankhba</assigned_to>
          <cc>jarthana</cc>
    
    <cc>manpalat</cc>
    
    <cc>shankhba</cc>
    
    <cc>srikanth_sankaran</cc>
          
          <votes>0</votes>

      

      

      <flag name="review"
          id="56323"
          type_id="1"
          status="+"
          setter="srikanth_sankaran"
    />
    <flag name="review"
          id="56331"
          type_id="1"
          status="+"
          setter="srikanth_sankaran"
    />

          <comment_sort_order>oldest_to_newest</comment_sort_order>  
          <long_desc isprivate="0" >
    <commentid>2215905</commentid>
    <comment_count>0</comment_count>
    <who name="Manoj Palat Away Until May 11 2015">manpalat</who>
    <bug_when>2013-02-13 01:45:24 -0500</bug_when>
    <thetext>For the entire Type Hieararchy (AnnotatableType) and Type Parameter hierarchy - ASTRewrite implementation [to be done in cases missing or corrected in cases existing if need be].

This is the ASTRewrite Equivalent of bug 391890.</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>2222621</commentid>
    <comment_count>1</comment_count>
      <attachid>227672</attachid>
    <who name="Manoj Palat Away Until May 11 2015">manpalat</who>
    <bug_when>2013-02-27 09:42:05 -0500</bug_when>
    <thetext>Created attachment 227672
Test Cases - WIP</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>2230117</commentid>
    <comment_count>2</comment_count>
    <who name="Srikanth Sankaran">srikanth_sankaran</who>
    <bug_when>2013-03-12 23:27:05 -0400</bug_when>
    <thetext>Shankha, please work with Manoj on this own to divide up the work. TIA.</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>2238269</commentid>
    <comment_count>3</comment_count>
      <attachid>229202</attachid>
    <who name="shankha banerjee">shankhba</who>
    <bug_when>2013-04-01 09:07:15 -0400</bug_when>
    <thetext>Created attachment 229202
Test cases for AST rewrite for type annotations

One bug found.
I have added a test case:
testEmptyListInsertAnnotation().

Review is needed for this patch.</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>2238271</commentid>
    <comment_count>4</comment_count>
    <who name="shankha banerjee">shankhba</who>
    <bug_when>2013-04-01 09:32:21 -0400</bug_when>
    <thetext>Bug filed for the failing test case:
Bug 404668 (https://bugs.eclipse.org/bugs/show_bug.cgi?id=404668)</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>2238482</commentid>
    <comment_count>5</comment_count>
    <who name="Manoj Palat Away Until May 11 2015">manpalat</who>
    <bug_when>2013-04-02 04:13:37 -0400</bug_when>
    <thetext>1.Move the tests to a new class/file, ASTRewritingTypeAnnotations.java


2.testTypeArgumentsParameterizedClassesAnnotations() : 2nd test -
//Replace an use of an annotation
rewrite.replace((ASTNode) simpleType.annotations().get(0),markerAnnotation, null);
//Empty annotations list
rewrite.remove((ASTNode) simpleType.annotations().get(0), null);
 =&gt; no effect for the first statement - change the test

3. testRewriteInsertAPIAnnotation(): first block - remove the comments

4. testRewriteInsertAPIAnnotation(): first block - first statement - no effect.

5. testEmptyListInsertAnnotations() fails - since a bug is already filed, comment this test out using _test*.</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>2238508</commentid>
    <comment_count>6</comment_count>
      <attachid>229226</attachid>
    <who name="shankha banerjee">shankhba</who>
    <bug_when>2013-04-02 05:11:24 -0400</bug_when>
    <thetext>Created attachment 229226
Test cases for AST rewrite for type annotations

Modified patch for comments specified in 
 Comment 5 Manoj Palat 2013-04-02 04:13:37 EDT</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>2239454</commentid>
    <comment_count>7</comment_count>
    <who name="Manoj Palat Away Until May 11 2015">manpalat</who>
    <bug_when>2013-04-04 04:23:33 -0400</bug_when>
    <thetext>Srikanth: Patch looks good. Please release.</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>2239460</commentid>
    <comment_count>8</comment_count>
    <who name="Srikanth Sankaran">srikanth_sankaran</who>
    <bug_when>2013-04-04 04:34:51 -0400</bug_when>
    <thetext>(In reply to comment #7)
&gt; Srikanth: Patch looks good. Please release.

The new ASTRewritingTypeAnnotationsTest does not appear to be hooked up
anywhere - How will these tests run ?</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>2239484</commentid>
    <comment_count>9</comment_count>
      <attachid>229319</attachid>
    <who name="shankha banerjee">shankhba</who>
    <bug_when>2013-04-04 05:43:35 -0400</bug_when>
    <thetext>Created attachment 229319
New patch to ensure the test cases are part of test suite ASTRewritingTest.java

New patch which contains changes necessary for the tests to run. They have been added as part of ASTRewritingTest.java</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>2239497</commentid>
    <comment_count>10</comment_count>
    <who name="Srikanth Sankaran">srikanth_sankaran</who>
    <bug_when>2013-04-04 06:05:36 -0400</bug_when>
    <thetext>This test only patch was reviewed by Manoj. Thanks Shankha &amp; Manoj.</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>2239503</commentid>
    <comment_count>11</comment_count>
    <who name="Srikanth Sankaran">srikanth_sankaran</who>
    <bug_when>2013-04-04 06:24:00 -0400</bug_when>
    <thetext>Does the series of buf.append calls make any sense ? Why won&apos;t it be a single
call ? I am not asking for the patch to be modified, but in future, we need to
ask such questions when copy pasting code.</thetext>
  </long_desc>
      
          <attachment
              isobsolete="0"
              ispatch="0"
              isprivate="0"
          >
            <attachid>227672</attachid>
            <date>2013-02-27 09:42:00 -0500</date>
            <delta_ts>2013-02-27 09:42:05 -0500</delta_ts>
            <desc>Test Cases - WIP</desc>
            <filename>ASTRewritingTypeAnnotationsTest.java</filename>
            <type>application/octet-stream</type>
            <size>14839</size>
            <attacher name="Manoj Palat Away Until May 11 2015">manpalat</attacher>
            
              <data encoding="base64">cGFja2FnZSBvcmcuZWNsaXBzZS5qZHQuY29yZS50ZXN0cy5yZXdyaXRlLmRlc2NyaWJpbmc7CgoK
aW1wb3J0IGphdmEudXRpbC5MaXN0OwoKaW1wb3J0IGp1bml0LmZyYW1ld29yay5UZXN0OwoKaW1w
b3J0IG9yZy5lY2xpcHNlLmpkdC5jb3JlLklDb21waWxhdGlvblVuaXQ7CmltcG9ydCBvcmcuZWNs
aXBzZS5qZHQuY29yZS5JUGFja2FnZUZyYWdtZW50OwppbXBvcnQgb3JnLmVjbGlwc2UuamR0LmNv
cmUuZG9tLkFTVDsKaW1wb3J0IG9yZy5lY2xpcHNlLmpkdC5jb3JlLmRvbS5BU1ROb2RlOwppbXBv
cnQgb3JnLmVjbGlwc2UuamR0LmNvcmUuZG9tLkFubm90YXRpb247CmltcG9ydCBvcmcuZWNsaXBz
ZS5qZHQuY29yZS5kb20uQXNzaWdubWVudDsKaW1wb3J0IG9yZy5lY2xpcHNlLmpkdC5jb3JlLmRv
bS5DYXN0RXhwcmVzc2lvbjsKaW1wb3J0IG9yZy5lY2xpcHNlLmpkdC5jb3JlLmRvbS5Db21waWxh
dGlvblVuaXQ7CmltcG9ydCBvcmcuZWNsaXBzZS5qZHQuY29yZS5kb20uRXhwcmVzc2lvblN0YXRl
bWVudDsKaW1wb3J0IG9yZy5lY2xpcHNlLmpkdC5jb3JlLmRvbS5FeHRyYURpbWVuc2lvbjsKaW1w
b3J0IG9yZy5lY2xpcHNlLmpkdC5jb3JlLmRvbS5GaWVsZERlY2xhcmF0aW9uOwppbXBvcnQgb3Jn
LmVjbGlwc2UuamR0LmNvcmUuZG9tLklBbm5vdGF0aW9uQmluZGluZzsKaW1wb3J0IG9yZy5lY2xp
cHNlLmpkdC5jb3JlLmRvbS5NYXJrZXJBbm5vdGF0aW9uOwppbXBvcnQgb3JnLmVjbGlwc2UuamR0
LmNvcmUuZG9tLk1ldGhvZERlY2xhcmF0aW9uOwppbXBvcnQgb3JnLmVjbGlwc2UuamR0LmNvcmUu
ZG9tLlF1YWxpZmllZFR5cGU7CmltcG9ydCBvcmcuZWNsaXBzZS5qZHQuY29yZS5kb20uU2ltcGxl
VHlwZTsKaW1wb3J0IG9yZy5lY2xpcHNlLmpkdC5jb3JlLmRvbS5UeXBlRGVjbGFyYXRpb247Cmlt
cG9ydCBvcmcuZWNsaXBzZS5qZHQuY29yZS5kb20uVmFyaWFibGVEZWNsYXJhdGlvbkZyYWdtZW50
OwppbXBvcnQgb3JnLmVjbGlwc2UuamR0LmNvcmUuZG9tLlZhcmlhYmxlRGVjbGFyYXRpb25TdGF0
ZW1lbnQ7CmltcG9ydCBvcmcuZWNsaXBzZS5qZHQuY29yZS5kb20ucmV3cml0ZS5BU1RSZXdyaXRl
OwppbXBvcnQgb3JnLmVjbGlwc2UuamR0LmNvcmUuZG9tLnJld3JpdGUuTGlzdFJld3JpdGU7Cgpw
dWJsaWMgY2xhc3MgQVNUUmV3cml0aW5nVHlwZUFubm90YXRpb25zVGVzdCBleHRlbmRzIEFTVFJl
d3JpdGluZ1Rlc3R7CgoJcHVibGljIEFTVFJld3JpdGluZ1R5cGVBbm5vdGF0aW9uc1Rlc3QoU3Ry
aW5nIG5hbWUpIHsKCQlzdXBlcihuYW1lKTsKCX0KCglwdWJsaWMgIEFTVFJld3JpdGluZ1R5cGVB
bm5vdGF0aW9uc1Rlc3QoU3RyaW5nIG5hbWUsIGludCBhcGlMZXZlbCkgewoJCXN1cGVyKG5hbWUs
IGFwaUxldmVsKTsKCX0KCglwdWJsaWMgc3RhdGljIFRlc3Qgc3VpdGUoKSB7CgkJcmV0dXJuIGNy
ZWF0ZVN1aXRlKEFTVFJld3JpdGluZ1R5cGVBbm5vdGF0aW9uc1Rlc3QuY2xhc3MpOwoJfQoKCS8v
IGh0dHBzOi8vYnVncy5lY2xpcHNlLm9yZy9idWdzL3Nob3dfYnVnLmNnaT9pZD00MDA2NTAKCXB1
YmxpYyB2b2lkIF90ZXN0QXJyYXlUeXBlMDAxKCkgdGhyb3dzIEV4Y2VwdGlvbiB7CgkJaWYgKHRo
aXMuYXBpTGV2ZWwgPCBBU1QuSkxTOCkgcmV0dXJuOwoJCUlQYWNrYWdlRnJhZ21lbnQgcGFjazE9
IHRoaXMuc291cmNlRm9sZGVyLmNyZWF0ZVBhY2thZ2VGcmFnbWVudCgidGVzdDEiLCBmYWxzZSwg
bnVsbCk7CgkJU3RyaW5nQnVmZmVyIGJ1Zj0gbmV3IFN0cmluZ0J1ZmZlcigpOwoJCWJ1Zi5hcHBl
bmQoInBhY2thZ2UgdGVzdDE7XG4iKTsKCQlidWYuYXBwZW5kKCJpbXBvcnQgamF2YS5sYW5nLmFu
bm90YXRpb24uRWxlbWVudFR5cGU7XG4iKTsKCQlidWYuYXBwZW5kKCJwdWJsaWMgY2xhc3MgWCB7
XG4iKTsKCQlidWYuYXBwZW5kKCIgCWNsYXNzIFkge1xuIik7CgkJYnVmLmFwcGVuZCgiCQlAQW5u
b3QgaW50IEBBbm5vdDEgW10gYSBAQW5ub3QyIEBBbm5vdDMgW10gQEFubm90MyBAQW5ub3QyIFtd
IEBBbm5vdDQgW10sIGIgQEFubm90MiBAQW5ub3QzIFtdIEBBbm5vdDQgW10sIGMgW11bXVtdO1xu
Iik7ICAKCQlidWYuYXBwZW5kKCIJCXB1YmxpYyB2b2lkIGZvbzEoQEFubm90IGludCBAQW5ub3Qx
IFtdIHAgQEFubm90MiBAQW5ub3QzIFtdIEBBbm5vdDMgQEFubm90MiBbXSBAQW5ub3Q0IEBBbm5v
dDMgW10pIHt9XG4iKTsKCQlidWYuYXBwZW5kKCIJCXB1YmxpYyB2b2lkIGZvbzIoQEFubm90IGlu
dCBwIFtdW10pIHt9XG4iKTsKCQlidWYuYXBwZW5kKCIJCUBBbm5vdCBTdHJpbmcgQEFubm90MSBb
XSBmb28zKCkgQEFubm90MSBAQW5ub3QyIFtdW10geyByZXR1cm4gbnVsbDsgfVxuIik7IAoJCWJ1
Zi5hcHBlbmQoIgl9XG4iKTsKCQlidWYuYXBwZW5kKCJ9XG4iKTsKCQlidWYuYXBwZW5kKCJAamF2
YS5sYW5nLmFubm90YXRpb24uVGFyZ2V0KHZhbHVlID0ge0VsZW1lbnRUeXBlLlRZUEVfVVNFfSlc
biIpOyAKCQlidWYuYXBwZW5kKCJAaW50ZXJmYWNlIEFubm90IHt9XG4iKTsKCQlidWYuYXBwZW5k
KCJAamF2YS5sYW5nLmFubm90YXRpb24uVGFyZ2V0KHZhbHVlID0ge0VsZW1lbnRUeXBlLlRZUEVf
VVNFfSlcbiIpOyAKCQlidWYuYXBwZW5kKCJAaW50ZXJmYWNlIEFubm90MSB7fVxuIik7CgkJYnVm
LmFwcGVuZCgiQGphdmEubGFuZy5hbm5vdGF0aW9uLlRhcmdldCh2YWx1ZSA9IHtFbGVtZW50VHlw
ZS5UWVBFX1VTRX0pXG4iKTsKCQlidWYuYXBwZW5kKCJAaW50ZXJmYWNlIEFubm90MiB7fVxuIik7
CgkJYnVmLmFwcGVuZCgiQGphdmEubGFuZy5hbm5vdGF0aW9uLlRhcmdldCh2YWx1ZSA9IHtFbGVt
ZW50VHlwZS5UWVBFX1VTRX0pXG4iKTsgCgkJYnVmLmFwcGVuZCgiQGludGVyZmFjZSBBbm5vdDMg
e31cbiIpOwoJCWJ1Zi5hcHBlbmQoIkBqYXZhLmxhbmcuYW5ub3RhdGlvbi5UYXJnZXQodmFsdWUg
PSB7RWxlbWVudFR5cGUuVFlQRV9VU0V9KVxuIik7CgkJYnVmLmFwcGVuZCgiQGludGVyZmFjZSBB
bm5vdDQge30iKTsKCQlJQ29tcGlsYXRpb25Vbml0IGN1PSBwYWNrMS5jcmVhdGVDb21waWxhdGlv
blVuaXQoIlguamF2YSIsIGJ1Zi50b1N0cmluZygpLCBmYWxzZSwgbnVsbCk7CgoJCUNvbXBpbGF0
aW9uVW5pdCBhc3RSb290PSBjcmVhdGVBU1QoY3UpOwoJCUFTVFJld3JpdGUgcmV3cml0ZT0gQVNU
UmV3cml0ZS5jcmVhdGUoYXN0Um9vdC5nZXRBU1QoKSk7CgkJQVNUIGFzdD0gYXN0Um9vdC5nZXRB
U1QoKTsKCQlUeXBlRGVjbGFyYXRpb24gdHlwZT0gZmluZFR5cGVEZWNsYXJhdGlvbihhc3RSb290
LCAiWCIpOwoJCXR5cGUgPSAoVHlwZURlY2xhcmF0aW9uKSB0eXBlLmJvZHlEZWNsYXJhdGlvbnMo
KS5nZXQoMCk7CgkJCgkJRmllbGREZWNsYXJhdGlvbiBmaWVsZCA9IHR5cGUuZ2V0RmllbGRzKClb
MF07CgkJTGlzdCBmcmFnbWVudHMgPSBmaWVsZC5mcmFnbWVudHMoKTsKCQlhc3NlcnRFcXVhbHMo
IkluY29ycmVjdCBubyBvZiBmcmFnbWVudHMiLCAzLCBmcmFnbWVudHMuc2l6ZSgpKTsKCQlWYXJp
YWJsZURlY2xhcmF0aW9uRnJhZ21lbnQgZnJhZ21lbnQgPSAoVmFyaWFibGVEZWNsYXJhdGlvbkZy
YWdtZW50KSBmcmFnbWVudHMuZ2V0KDApOwoJCWZyYWdtZW50ID0gKFZhcmlhYmxlRGVjbGFyYXRp
b25GcmFnbWVudCkgZnJhZ21lbnRzLmdldCgxKTsKCQlFeHRyYURpbWVuc2lvbiBleHRyYURpbWVu
c2lvbiA9IChFeHRyYURpbWVuc2lvbikgZnJhZ21lbnQuZXh0cmFEaW1lbnNpb25JbmZvcygpLmdl
dCgwKTsKCQlBbm5vdGF0aW9uIGFubm90YXRpb24gPSAoQW5ub3RhdGlvbikgZXh0cmFEaW1lbnNp
b24uYW5ub3RhdGlvbnMoKS5nZXQoMCk7CgkJSUFubm90YXRpb25CaW5kaW5nIGJpbmRpbmcgPSBh
bm5vdGF0aW9uLnJlc29sdmVBbm5vdGF0aW9uQmluZGluZygpOwoJCS8qIENoZWNrIGZvciBub24t
bnVsbCBiaW5kaW5nIC0gY2FuIHNoaWZ0IHRoaXMgdG8gY29udmVydGVyMThUZXN0cyAqLwoJfQoJ
Ly8gaHR0cHM6Ly9idWdzLmVjbGlwc2Uub3JnL2J1Z3Mvc2hvd19idWcuY2dpP2lkPTQwMDY1MAoJ
cHVibGljIHZvaWQgX3Rlc3RQcmltaXRpdmVUeXBlQW5ub3RhdGlvbnMoKSB0aHJvd3MgRXhjZXB0
aW9uIHsKCQlpZiAodGhpcy5hcGlMZXZlbCA8IEFTVC5KTFM4KSByZXR1cm47CgkJSVBhY2thZ2VG
cmFnbWVudCBwYWNrMT0gdGhpcy5zb3VyY2VGb2xkZXIuY3JlYXRlUGFja2FnZUZyYWdtZW50KCJ0
ZXN0MSIsIGZhbHNlLCBudWxsKTsKCQlTdHJpbmdCdWZmZXIgYnVmPSBuZXcgU3RyaW5nQnVmZmVy
KCk7CgkJYnVmLmFwcGVuZCgicGFja2FnZSB0ZXN0MTtcbiIpOwoJCWJ1Zi5hcHBlbmQoImltcG9y
dCBqYXZhLmxhbmcuYW5ub3RhdGlvbi5FbGVtZW50VHlwZTtcbiIpOwoJCWJ1Zi5hcHBlbmQoInB1
YmxpYyBjbGFzcyBYIHtcbiIpOwoJCWJ1Zi5hcHBlbmQoIglwdWJsaWMgQEFubm90IGludCBiO1xu
Iik7ICAKCQlidWYuYXBwZW5kKCJAamF2YS5sYW5nLmFubm90YXRpb24uVGFyZ2V0KHZhbHVlID0g
e0VsZW1lbnRUeXBlLlRZUEVfVVNFfSlcbiIpOyAKCQlidWYuYXBwZW5kKCJAaW50ZXJmYWNlIEFu
bm90IHt9XG4iKTsKCQlJQ29tcGlsYXRpb25Vbml0IGN1PSBwYWNrMS5jcmVhdGVDb21waWxhdGlv
blVuaXQoIlguamF2YSIsIGJ1Zi50b1N0cmluZygpLCBmYWxzZSwgbnVsbCk7CgoJCUNvbXBpbGF0
aW9uVW5pdCBhc3RSb290PSBjcmVhdGVBU1QoY3UpOwoJCUFTVFJld3JpdGUgcmV3cml0ZT0gQVNU
UmV3cml0ZS5jcmVhdGUoYXN0Um9vdC5nZXRBU1QoKSk7CgkJQVNUIGFzdD0gYXN0Um9vdC5nZXRB
U1QoKTsKCQlUeXBlRGVjbGFyYXRpb24gdHlwZT0gZmluZFR5cGVEZWNsYXJhdGlvbihhc3RSb290
LCAiWCIpOwoJCQoJCUZpZWxkRGVjbGFyYXRpb24gZmllbGQgPSB0eXBlLmdldEZpZWxkcygpWzBd
OwoJCUFubm90YXRpb24gYW5ub3RhdGlvbiA9ICAoQW5ub3RhdGlvbilmaWVsZC5tb2RpZmllcnMo
KS5nZXQoMSk7CgkJewoJCQlNYXJrZXJBbm5vdGF0aW9uIG1hcmtlckFubm90YXRpb249IGFzdC5u
ZXdNYXJrZXJBbm5vdGF0aW9uKCk7CgkJCW1hcmtlckFubm90YXRpb24uc2V0VHlwZU5hbWUoYXN0
Lm5ld1NpbXBsZU5hbWUoIkEiKSk7CgoJCQlMaXN0UmV3cml0ZSBsaXN0UmV3cml0ZT0gcmV3cml0
ZS5nZXRMaXN0UmV3cml0ZShmaWVsZCwgRmllbGREZWNsYXJhdGlvbi5NT0RJRklFUlMyX1BST1BF
UlRZKTsKCQkJbGlzdFJld3JpdGUuaW5zZXJ0QmVmb3JlKG1hcmtlckFubm90YXRpb24sIGFubm90
YXRpb24sIG51bGwpOwoJCX0KCQlTdHJpbmcgcHJldmlldyA9IGV2YWx1YXRlUmV3cml0ZShjdSwg
cmV3cml0ZSk7CgkJYnVmPSBuZXcgU3RyaW5nQnVmZmVyKCk7CgkJYnVmLmFwcGVuZCgicGFja2Fn
ZSB0ZXN0MTtcbiIpOwoJCWJ1Zi5hcHBlbmQoImltcG9ydCBqYXZhLmxhbmcuYW5ub3RhdGlvbi5F
bGVtZW50VHlwZTtcbiIpOwoJCWJ1Zi5hcHBlbmQoInB1YmxpYyBjbGFzcyBYIHtcbiIpOwoJCWJ1
Zi5hcHBlbmQoIglwdWJsaWMgQEFcbiIpOyAgCgkJYnVmLmFwcGVuZCgiICAgIEBBbm5vdCBpbnQg
YjtcbiIpOyAgCgkJYnVmLmFwcGVuZCgiQGphdmEubGFuZy5hbm5vdGF0aW9uLlRhcmdldCh2YWx1
ZSA9IHtFbGVtZW50VHlwZS5UWVBFX1VTRX0pXG4iKTsgCgkJYnVmLmFwcGVuZCgiQGludGVyZmFj
ZSBBbm5vdCB7fVxuIik7CgkJYXNzZXJ0RXF1YWxTdHJpbmcocHJldmlldywgYnVmLnRvU3RyaW5n
KCkpOwoJfQoKCS8vIGh0dHBzOi8vYnVncy5lY2xpcHNlLm9yZy9idWdzL3Nob3dfYnVnLmNnaT9p
ZD00MDA2NTAKCS8qKiBAZGVwcmVjYXRlZCB1c2luZyBkZXByZWNhdGVkIGNvZGUgKi8KCXB1Ymxp
YyB2b2lkIF90ZXN0U2ltcGxlVHlwZUFubm90YXRpb25zKCkgdGhyb3dzIEV4Y2VwdGlvbiB7CgkJ
aWYgKHRoaXMuYXBpTGV2ZWwgPCBBU1QuSkxTOCkgcmV0dXJuOwoJCUlQYWNrYWdlRnJhZ21lbnQg
cGFjazE9IHRoaXMuc291cmNlRm9sZGVyLmNyZWF0ZVBhY2thZ2VGcmFnbWVudCgidGVzdDEiLCBm
YWxzZSwgbnVsbCk7CgkJU3RyaW5nQnVmZmVyIGJ1Zj0gbmV3IFN0cmluZ0J1ZmZlcigpOwoKCQli
dWYuYXBwZW5kKCJwYWNrYWdlIHRlc3QxO1xuIik7CgkJYnVmLmFwcGVuZCgiaW1wb3J0IGphdmEu
bGFuZy5hbm5vdGF0aW9uLlRhcmdldDtcbiIpOwoJCWJ1Zi5hcHBlbmQoInB1YmxpYyBjbGFzcyBY
IHtcbiIpOwoJCWJ1Zi5hcHBlbmQoIglwdWJsaWMgc3RhdGljIHZvaWQgbWFpbihTdHJpbmdbXSBh
cmdzKSB7XG4iKTsKCQlidWYuYXBwZW5kKCIJCU91dGVyIG91dGVyID0gbmV3IE91dGVyKCk7XG4i
KTsJCQoJCWJ1Zi5hcHBlbmQoIgkJT2JqZWN0IG15T2JqZWN0ID0gbmV3IE9iamVjdCgpO1xuIik7
CgkJYnVmLmFwcGVuZCgiCQlTdHJpbmcgbXlTdHJpbmc7XG4iKTsKCQlidWYuYXBwZW5kKCIJCW15
U3RyaW5nID0gKGphdmEubGFuZy5ATWFya2VyIFN0cmluZykgbXlPYmplY3Q7XG4iKTsKCQlidWYu
YXBwZW5kKCIJCU91dGVyLklubmVyIGZpcnN0ID0gb3V0ZXIubmV3IElubmVyKCk7XG4iKTsKCQli
dWYuYXBwZW5kKCIJCU91dGVyLiBATWFya2VyMiBJbm5lciBzZWNvbmQgPSBvdXRlci5uZXcgSW5u
ZXIoKSA7XG4iKTsKCQlidWYuYXBwZW5kKCIJCU91dGVyLklubmVyLiBATWFya2VyMSBEZWVwZXIg
ZGVlcGVyID0gc2Vjb25kLm5ldyBEZWVwZXIoKTtcbiIpOwoJCWJ1Zi5hcHBlbmQoIgkJT3V0ZXIu
QE1hcmtlcjEgSW5uZXIuQE1hcmtlcjIgRGVlcGVyIGRlZXBlcjIgPSAgc2Vjb25kLm5ldyBEZWVw
ZXIoKTtcbiIpOwoJCWJ1Zi5hcHBlbmQoIgl9XG4iKTsKCQlidWYuYXBwZW5kKCJ9XG4iKTsKCQli
dWYuYXBwZW5kKCJjbGFzcyBPdXRlciB7XG4iKTsKCQlidWYuYXBwZW5kKCIJcHVibGljIGNsYXNz
IElubmVyIHtcbiIpOwoJCWJ1Zi5hcHBlbmQoIgkJcHVibGljIGNsYXNzIERlZXBlciB7XG4iKTsK
CQlidWYuYXBwZW5kKCIJCX1cbiIpOwoJCWJ1Zi5hcHBlbmQoIgl9XG4iKTsKCQlidWYuYXBwZW5k
KCJ9XG4iKTsKCQlidWYuYXBwZW5kKCJAVGFyZ2V0IChqYXZhLmxhbmcuYW5ub3RhdGlvbi5FbGVt
ZW50VHlwZS5UWVBFX1VTRSlcbiIgKTsKCQlidWYuYXBwZW5kKCJAaW50ZXJmYWNlIE1hcmtlciB7
fVxuIik7CgkJYnVmLmFwcGVuZCgiQFRhcmdldCAoamF2YS5sYW5nLmFubm90YXRpb24uRWxlbWVu
dFR5cGUuVFlQRV9VU0UpXG4iKTsKCQlidWYuYXBwZW5kKCJAaW50ZXJmYWNlIE1hcmtlcjEge31c
biIpOwoJCWJ1Zi5hcHBlbmQoIkBUYXJnZXQgKGphdmEubGFuZy5hbm5vdGF0aW9uLkVsZW1lbnRU
eXBlLlRZUEVfVVNFKVxuIik7CgkJYnVmLmFwcGVuZCgiQGludGVyZmFjZSBNYXJrZXIyIHt9XG4i
KTsJCQoKCQlJQ29tcGlsYXRpb25Vbml0IGN1PSBwYWNrMS5jcmVhdGVDb21waWxhdGlvblVuaXQo
IlguamF2YSIsIGJ1Zi50b1N0cmluZygpLCBmYWxzZSwgbnVsbCk7CgkJQ29tcGlsYXRpb25Vbml0
IGFzdFJvb3Q9IGNyZWF0ZUFTVChjdSk7CgkJQVNUUmV3cml0ZSByZXdyaXRlPSBBU1RSZXdyaXRl
LmNyZWF0ZShhc3RSb290LmdldEFTVCgpKTsKCQlBU1QgYXN0PSBhc3RSb290LmdldEFTVCgpOwoK
CQl7CgkJCS8vIHJlcGxhY2UgIGFubm90YXRpb24KCQkJVHlwZURlY2xhcmF0aW9uIHR5cGUgPSBm
aW5kVHlwZURlY2xhcmF0aW9uKGFzdFJvb3QsICJYIik7CgkJCU1ldGhvZERlY2xhcmF0aW9uIG1l
dGhvZERlY2xhcmF0aW9uID0gZmluZE1ldGhvZERlY2xhcmF0aW9uKHR5cGUsICJtYWluIik7CgkJ
CUxpc3Qgc3RhdGVtZW50cyA9IG1ldGhvZERlY2xhcmF0aW9uLmdldEJvZHkoKS5zdGF0ZW1lbnRz
KCk7CgkJCUV4cHJlc3Npb25TdGF0ZW1lbnQgZXhwcmVzc2lvblN0YXRlbWVudCA9IChFeHByZXNz
aW9uU3RhdGVtZW50KSBzdGF0ZW1lbnRzLmdldCgzKTsKCQkJQXNzaWdubWVudCBhc3NpZ25tZW50
ID0gKEFzc2lnbm1lbnQpIGV4cHJlc3Npb25TdGF0ZW1lbnQuZ2V0RXhwcmVzc2lvbigpOwoJCQlh
c3NlcnROb3ROdWxsKGFzc2lnbm1lbnQpOwoJCQlDYXN0RXhwcmVzc2lvbiBjYXN0RXhwcmVzc2lv
biA9IChDYXN0RXhwcmVzc2lvbilhc3NpZ25tZW50LmdldFJpZ2h0SGFuZFNpZGUoKTsKCQkJYXNz
ZXJ0Tm90TnVsbChjYXN0RXhwcmVzc2lvbik7CgkJCVNpbXBsZVR5cGUgc2ltcGxlVHlwZSA9IChT
aW1wbGVUeXBlKSBjYXN0RXhwcmVzc2lvbi5nZXRUeXBlKCk7CgkJCWFzc2VydE5vdE51bGwoc2lt
cGxlVHlwZSk7CgkJCU1hcmtlckFubm90YXRpb24gbWFya2VyQW5ub3RhdGlvbiA9IGFzdC5uZXdN
YXJrZXJBbm5vdGF0aW9uKCk7CgkJCW1hcmtlckFubm90YXRpb24uc2V0VHlwZU5hbWUoYXN0Lm5l
d1NpbXBsZU5hbWUoIm5ld01hcmtlcjEiKSk7CgkJCXJld3JpdGUucmVwbGFjZSgoQVNUTm9kZSlz
aW1wbGVUeXBlLmFubm90YXRpb25zKCkuZ2V0KDApLCBtYXJrZXJBbm5vdGF0aW9uLCBudWxsKTsK
CQkJCgkJCS8vIGFkZCBhbm5vdGF0aW9uCgkJCVZhcmlhYmxlRGVjbGFyYXRpb25TdGF0ZW1lbnQg
dmFyaWFibGVEZWNsYXJhdGlvblN0YXRlbWVudCA9IChWYXJpYWJsZURlY2xhcmF0aW9uU3RhdGVt
ZW50KSBzdGF0ZW1lbnRzLmdldCg0KTsKCQkJUXVhbGlmaWVkVHlwZSBxdWFsaWZpZWRUeXBlMiA9
IGFzdC5uZXdRdWFsaWZpZWRUeXBlKGFzdC5uZXdTaW1wbGVUeXBlKGFzdC5uZXdTaW1wbGVOYW1l
KCJPdXRlciIpKSwgYXN0Lm5ld1NpbXBsZU5hbWUoIklubmVyIikpOwoJCQltYXJrZXJBbm5vdGF0
aW9uID0gYXN0Lm5ld01hcmtlckFubm90YXRpb24oKTsKCQkJbWFya2VyQW5ub3RhdGlvbi5zZXRU
eXBlTmFtZShhc3QubmV3U2ltcGxlTmFtZSgibmV3TWFya2VyMiIpKTsKCQkJcXVhbGlmaWVkVHlw
ZTIuYW5ub3RhdGlvbnMoKS5hZGQobWFya2VyQW5ub3RhdGlvbik7CgkJCXJld3JpdGUucmVwbGFj
ZSh2YXJpYWJsZURlY2xhcmF0aW9uU3RhdGVtZW50LmdldFR5cGUoKSwgcXVhbGlmaWVkVHlwZTIs
IG51bGwpOwoJCQkKCQkJLy8gcmVwbGFjZSBhbm5vdGF0aW9uCgkJCXZhcmlhYmxlRGVjbGFyYXRp
b25TdGF0ZW1lbnQgPSAoVmFyaWFibGVEZWNsYXJhdGlvblN0YXRlbWVudCkgc3RhdGVtZW50cy5n
ZXQoNSk7CgkJCXNpbXBsZVR5cGUgPSAoU2ltcGxlVHlwZSkgdmFyaWFibGVEZWNsYXJhdGlvblN0
YXRlbWVudC5nZXRUeXBlKCk7CgkJCWFzc2VydE5vdE51bGwoc2ltcGxlVHlwZSk7CgkJCW1hcmtl
ckFubm90YXRpb24gPSBhc3QubmV3TWFya2VyQW5ub3RhdGlvbigpOwoJCQltYXJrZXJBbm5vdGF0
aW9uLnNldFR5cGVOYW1lKGFzdC5uZXdTaW1wbGVOYW1lKCJuZXdNYXJrZXIyIikpOwoJCQlyZXdy
aXRlLnJlcGxhY2UoKEFTVE5vZGUpc2ltcGxlVHlwZS5hbm5vdGF0aW9ucygpLmdldCgwKSwgbWFy
a2VyQW5ub3RhdGlvbiwgbnVsbCk7CgkJfQoJCQoJCVN0cmluZyBwcmV2aWV3PSBldmFsdWF0ZVJl
d3JpdGUoY3UsIHJld3JpdGUpOwoKCQlidWY9IG5ldyBTdHJpbmdCdWZmZXIoKTsKCQlidWYuYXBw
ZW5kKCJwYWNrYWdlIHRlc3QxO1xuIik7CgkJYnVmLmFwcGVuZCgiaW1wb3J0IGphdmEubGFuZy5h
bm5vdGF0aW9uLlRhcmdldDtcbiIpOwoJCWJ1Zi5hcHBlbmQoInB1YmxpYyBjbGFzcyBYIHtcbiIp
OwoJCWJ1Zi5hcHBlbmQoIglwdWJsaWMgc3RhdGljIHZvaWQgbWFpbihTdHJpbmdbXSBhcmdzKSB7
XG4iKTsKCQlidWYuYXBwZW5kKCIJCU91dGVyIG91dGVyID0gbmV3IE91dGVyKCk7XG4iKTsJCQoJ
CWJ1Zi5hcHBlbmQoIgkJT2JqZWN0IG15T2JqZWN0ID0gbmV3IE9iamVjdCgpO1xuIik7CgkJYnVm
LmFwcGVuZCgiCQlTdHJpbmcgbXlTdHJpbmc7XG4iKTsKCQlidWYuYXBwZW5kKCIJCW15U3RyaW5n
ID0gKGphdmEubGFuZy5AbmV3TWFya2VyMSBTdHJpbmcpIG15T2JqZWN0O1xuIik7CgkJYnVmLmFw
cGVuZCgiCQlPdXRlci5AbmV3TWFya2VyMiBJbm5lciBmaXJzdCA9IG91dGVyLm5ldyBJbm5lcigp
O1xuIik7CgkJYnVmLmFwcGVuZCgiCQlPdXRlci4gQG5ld01hcmtlcjIgSW5uZXIgc2Vjb25kID0g
b3V0ZXIubmV3IElubmVyKCkgO1xuIik7CgkJYnVmLmFwcGVuZCgiCQlPdXRlci5Jbm5lci4gQE1h
cmtlcjEgRGVlcGVyIGRlZXBlciA9IHNlY29uZC5uZXcgRGVlcGVyKCk7XG4iKTsKCQlidWYuYXBw
ZW5kKCIJCU91dGVyLkBNYXJrZXIxIElubmVyLkBNYXJrZXIyIERlZXBlciBkZWVwZXIyID0gIHNl
Y29uZC5uZXcgRGVlcGVyKCk7XG4iKTsKCQlidWYuYXBwZW5kKCIJfVxuIik7CgkJYnVmLmFwcGVu
ZCgifVxuIik7CgkJYnVmLmFwcGVuZCgiY2xhc3MgT3V0ZXIge1xuIik7CgkJYnVmLmFwcGVuZCgi
CXB1YmxpYyBjbGFzcyBJbm5lciB7XG4iKTsKCQlidWYuYXBwZW5kKCIJCXB1YmxpYyBjbGFzcyBE
ZWVwZXIge1xuIik7CgkJYnVmLmFwcGVuZCgiCQl9XG4iKTsKCQlidWYuYXBwZW5kKCIJfVxuIik7
CgkJYnVmLmFwcGVuZCgifVxuIik7CgkJYnVmLmFwcGVuZCgiQFRhcmdldCAoamF2YS5sYW5nLmFu
bm90YXRpb24uRWxlbWVudFR5cGUuVFlQRV9VU0UpXG4iICk7CgkJYnVmLmFwcGVuZCgiQGludGVy
ZmFjZSBNYXJrZXIge31cbiIpOwoJCWJ1Zi5hcHBlbmQoIkBUYXJnZXQgKGphdmEubGFuZy5hbm5v
dGF0aW9uLkVsZW1lbnRUeXBlLlRZUEVfVVNFKVxuIik7CgkJYnVmLmFwcGVuZCgiQGludGVyZmFj
ZSBNYXJrZXIxIHt9XG4iKTsKCQlidWYuYXBwZW5kKCJAVGFyZ2V0IChqYXZhLmxhbmcuYW5ub3Rh
dGlvbi5FbGVtZW50VHlwZS5UWVBFX1VTRSlcbiIpOwoJCWJ1Zi5hcHBlbmQoIkBpbnRlcmZhY2Ug
TWFya2VyMiB7fVxuIik7CQkKCQlhc3NlcnRFcXVhbFN0cmluZyhwcmV2aWV3LCBidWYudG9TdHJp
bmcoKSk7Cgl9CgkKCS8vIGh0dHBzOi8vYnVncy5lY2xpcHNlLm9yZy9idWdzL3Nob3dfYnVnLmNn
aT9pZD00MDA2NTAKCXB1YmxpYyB2b2lkIHRlc3RRdWFsaWZpZWRUeXBlQW5ub3RhdGlvbnMoKSB0
aHJvd3MgRXhjZXB0aW9uIHsKCQlpZiAodGhpcy5hcGlMZXZlbCA8IEFTVC5KTFM4KSByZXR1cm47
CgkJSVBhY2thZ2VGcmFnbWVudCBwYWNrMT0gdGhpcy5zb3VyY2VGb2xkZXIuY3JlYXRlUGFja2Fn
ZUZyYWdtZW50KCJ0ZXN0MSIsIGZhbHNlLCBudWxsKTsKCQlTdHJpbmdCdWZmZXIgYnVmPSBuZXcg
U3RyaW5nQnVmZmVyKCk7CgoJCWJ1Zi5hcHBlbmQoInBhY2thZ2UgdGVzdDE7XG4iKTsKCQlidWYu
YXBwZW5kKCJpbXBvcnQgamF2YS5sYW5nLmFubm90YXRpb24uVGFyZ2V0O1xuIik7CgkJYnVmLmFw
cGVuZCgicHVibGljIGNsYXNzIFgge1xuIik7CgkJYnVmLmFwcGVuZCgiCXB1YmxpYyBzdGF0aWMg
dm9pZCBtYWluKFN0cmluZ1tdIGFyZ3MpIHtcbiIpOwoJCWJ1Zi5hcHBlbmQoIgkJT3V0ZXIgb3V0
ZXIgPSBuZXcgT3V0ZXIoKTtcbiIpOwkJCgkJYnVmLmFwcGVuZCgiCQlPdXRlci5Jbm5lciBmaXJz
dCA9IG91dGVyLm5ldyBJbm5lcigpO1xuIik7CgkJYnVmLmFwcGVuZCgiCQlPdXRlci4gQE1hcmtl
cjIgSW5uZXIgc2Vjb25kID0gb3V0ZXIubmV3IElubmVyKCkgO1xuIik7CgkJYnVmLmFwcGVuZCgi
CQlPdXRlci5Jbm5lci4gQE1hcmtlcjEgRGVlcGVyIGRlZXBlciA9IHNlY29uZC5uZXcgRGVlcGVy
KCk7XG4iKTsKCQlidWYuYXBwZW5kKCIJCU91dGVyLkBNYXJrZXIxIElubmVyLkBNYXJrZXIyIEBN
YXJrZXIzIERlZXBlciBkZWVwZXIyID0gIHNlY29uZC5uZXcgRGVlcGVyKCk7XG4iKTsKCQlidWYu
YXBwZW5kKCIJfVxuIik7CgkJYnVmLmFwcGVuZCgifVxuIik7CgkJYnVmLmFwcGVuZCgiY2xhc3Mg
T3V0ZXIge1xuIik7CgkJYnVmLmFwcGVuZCgiCXB1YmxpYyBjbGFzcyBJbm5lciB7XG4iKTsKCQli
dWYuYXBwZW5kKCIJCXB1YmxpYyBjbGFzcyBEZWVwZXIge1xuIik7CgkJYnVmLmFwcGVuZCgiCQl9
XG4iKTsKCQlidWYuYXBwZW5kKCIJfVxuIik7CgkJYnVmLmFwcGVuZCgifVxuIik7CgkJYnVmLmFw
cGVuZCgiQFRhcmdldCAoamF2YS5sYW5nLmFubm90YXRpb24uRWxlbWVudFR5cGUuVFlQRV9VU0Up
XG4iICk7CgkJYnVmLmFwcGVuZCgiQGludGVyZmFjZSBNYXJrZXIge31cbiIpOwoJCWJ1Zi5hcHBl
bmQoIkBUYXJnZXQgKGphdmEubGFuZy5hbm5vdGF0aW9uLkVsZW1lbnRUeXBlLlRZUEVfVVNFKVxu
Iik7CgkJYnVmLmFwcGVuZCgiQGludGVyZmFjZSBNYXJrZXIxIHt9XG4iKTsKCQlidWYuYXBwZW5k
KCJAVGFyZ2V0IChqYXZhLmxhbmcuYW5ub3RhdGlvbi5FbGVtZW50VHlwZS5UWVBFX1VTRSlcbiIp
OwoJCWJ1Zi5hcHBlbmQoIkBpbnRlcmZhY2UgTWFya2VyMiB7fVxuIik7CQkKCQlidWYuYXBwZW5k
KCJAVGFyZ2V0IChqYXZhLmxhbmcuYW5ub3RhdGlvbi5FbGVtZW50VHlwZS5UWVBFX1VTRSlcbiIp
OwoJCWJ1Zi5hcHBlbmQoIkBpbnRlcmZhY2UgTWFya2VyMyB7fVxuIik7CQkKCgkJSUNvbXBpbGF0
aW9uVW5pdCBjdT0gcGFjazEuY3JlYXRlQ29tcGlsYXRpb25Vbml0KCJYLmphdmEiLCBidWYudG9T
dHJpbmcoKSwgZmFsc2UsIG51bGwpOwoJCUNvbXBpbGF0aW9uVW5pdCBhc3RSb290PSBjcmVhdGVB
U1QoY3UpOwoJCUFTVFJld3JpdGUgcmV3cml0ZT0gQVNUUmV3cml0ZS5jcmVhdGUoYXN0Um9vdC5n
ZXRBU1QoKSk7CgkJQVNUIGFzdD0gYXN0Um9vdC5nZXRBU1QoKTsKCgkJewoJCQlUeXBlRGVjbGFy
YXRpb24gdHlwZSA9IGZpbmRUeXBlRGVjbGFyYXRpb24oYXN0Um9vdCwgIlgiKTsKCQkJTWV0aG9k
RGVjbGFyYXRpb24gbWV0aG9kRGVjbGFyYXRpb24gPSBmaW5kTWV0aG9kRGVjbGFyYXRpb24odHlw
ZSwgIm1haW4iKTsKCQkJTGlzdCBzdGF0ZW1lbnRzID0gbWV0aG9kRGVjbGFyYXRpb24uZ2V0Qm9k
eSgpLnN0YXRlbWVudHMoKTsKCgkJCS8vIHJlcGxhY2UgYW5ub3RhdGlvbgoJCQlWYXJpYWJsZURl
Y2xhcmF0aW9uU3RhdGVtZW50IHZhcmlhYmxlRGVjbGFyYXRpb25TdGF0ZW1lbnQgPSAoVmFyaWFi
bGVEZWNsYXJhdGlvblN0YXRlbWVudCkgc3RhdGVtZW50cy5nZXQoNCk7CgkJCVF1YWxpZmllZFR5
cGUgcXVhbGlmaWVkVHlwZSA9IChRdWFsaWZpZWRUeXBlKSB2YXJpYWJsZURlY2xhcmF0aW9uU3Rh
dGVtZW50LmdldFR5cGUoKTsKCQkJYXNzZXJ0Tm90TnVsbChxdWFsaWZpZWRUeXBlKTsKCQkJTWFy
a2VyQW5ub3RhdGlvbiBtYXJrZXJBbm5vdGF0aW9uID0gYXN0Lm5ld01hcmtlckFubm90YXRpb24o
KTsKCQkJbWFya2VyQW5ub3RhdGlvbi5zZXRUeXBlTmFtZShhc3QubmV3U2ltcGxlTmFtZSgibmV3
TWFya2VyMiIpKTsKCQkJcmV3cml0ZS5yZXBsYWNlKChBU1ROb2RlKXF1YWxpZmllZFR5cGUuYW5u
b3RhdGlvbnMoKS5nZXQoMCksIG1hcmtlckFubm90YXRpb24sIG51bGwpOwoJCQkKCQkJLy8gcmVt
b3ZlIGFubm90YXRpb24KCQkJcmV3cml0ZS5yZW1vdmUoKEFTVE5vZGUpcXVhbGlmaWVkVHlwZS5h
bm5vdGF0aW9ucygpLmdldCgxKSxudWxsKTsKCQkJCgkJCS8vIGluc2VydCBhbm5vdGF0aW9uCgkJ
CU1hcmtlckFubm90YXRpb24gbWFya2VyQW5ub3RhdGlvbjEgPSBhc3QubmV3TWFya2VyQW5ub3Rh
dGlvbigpOwoJCQltYXJrZXJBbm5vdGF0aW9uMS5zZXRUeXBlTmFtZShhc3QubmV3U2ltcGxlTmFt
ZSgibmV3TWFya2VyNCIpKTsKCQkJcmV3cml0ZS5nZXRMaXN0UmV3cml0ZShxdWFsaWZpZWRUeXBl
LCBRdWFsaWZpZWRUeXBlLkFOTk9UQVRJT05TX1BST1BFUlRZKS5pbnNlcnRMYXN0KG1hcmtlckFu
bm90YXRpb24xLCBudWxsKTsKCgkJfQoJCQoJCVN0cmluZyBwcmV2aWV3PSBldmFsdWF0ZVJld3Jp
dGUoY3UsIHJld3JpdGUpOwoKCQlidWY9IG5ldyBTdHJpbmdCdWZmZXIoKTsKCQlidWYuYXBwZW5k
KCJwYWNrYWdlIHRlc3QxO1xuIik7CgkJYnVmLmFwcGVuZCgiaW1wb3J0IGphdmEubGFuZy5hbm5v
dGF0aW9uLlRhcmdldDtcbiIpOwoJCWJ1Zi5hcHBlbmQoInB1YmxpYyBjbGFzcyBYIHtcbiIpOwoJ
CWJ1Zi5hcHBlbmQoIglwdWJsaWMgc3RhdGljIHZvaWQgbWFpbihTdHJpbmdbXSBhcmdzKSB7XG4i
KTsKCQlidWYuYXBwZW5kKCIJCU91dGVyIG91dGVyID0gbmV3IE91dGVyKCk7XG4iKTsJCQoJCWJ1
Zi5hcHBlbmQoIgkJT3V0ZXIuSW5uZXIgZmlyc3QgPSBvdXRlci5uZXcgSW5uZXIoKTtcbiIpOwoJ
CWJ1Zi5hcHBlbmQoIgkJT3V0ZXIuIEBNYXJrZXIyIElubmVyIHNlY29uZCA9IG91dGVyLm5ldyBJ
bm5lcigpIDtcbiIpOwoJCWJ1Zi5hcHBlbmQoIgkJT3V0ZXIuSW5uZXIuIEBNYXJrZXIxIERlZXBl
ciBkZWVwZXIgPSBzZWNvbmQubmV3IERlZXBlcigpO1xuIik7CgkJYnVmLmFwcGVuZCgiCQlPdXRl
ci5ATWFya2VyMSBJbm5lci5AbmV3TWFya2VyMiBAbmV3TWFya2VyNCBEZWVwZXIgZGVlcGVyMiA9
ICBzZWNvbmQubmV3IERlZXBlcigpO1xuIik7CgkJYnVmLmFwcGVuZCgiCX1cbiIpOwoJCWJ1Zi5h
cHBlbmQoIn1cbiIpOwoJCWJ1Zi5hcHBlbmQoImNsYXNzIE91dGVyIHtcbiIpOwoJCWJ1Zi5hcHBl
bmQoIglwdWJsaWMgY2xhc3MgSW5uZXIge1xuIik7CgkJYnVmLmFwcGVuZCgiCQlwdWJsaWMgY2xh
c3MgRGVlcGVyIHtcbiIpOwoJCWJ1Zi5hcHBlbmQoIgkJfVxuIik7CgkJYnVmLmFwcGVuZCgiCX1c
biIpOwoJCWJ1Zi5hcHBlbmQoIn1cbiIpOwoJCWJ1Zi5hcHBlbmQoIkBUYXJnZXQgKGphdmEubGFu
Zy5hbm5vdGF0aW9uLkVsZW1lbnRUeXBlLlRZUEVfVVNFKVxuIiApOwoJCWJ1Zi5hcHBlbmQoIkBp
bnRlcmZhY2UgTWFya2VyIHt9XG4iKTsKCQlidWYuYXBwZW5kKCJAVGFyZ2V0IChqYXZhLmxhbmcu
YW5ub3RhdGlvbi5FbGVtZW50VHlwZS5UWVBFX1VTRSlcbiIpOwoJCWJ1Zi5hcHBlbmQoIkBpbnRl
cmZhY2UgTWFya2VyMSB7fVxuIik7CgkJYnVmLmFwcGVuZCgiQFRhcmdldCAoamF2YS5sYW5nLmFu
bm90YXRpb24uRWxlbWVudFR5cGUuVFlQRV9VU0UpXG4iKTsKCQlidWYuYXBwZW5kKCJAaW50ZXJm
YWNlIE1hcmtlcjIge31cbiIpOwkJCgkJYnVmLmFwcGVuZCgiQFRhcmdldCAoamF2YS5sYW5nLmFu
bm90YXRpb24uRWxlbWVudFR5cGUuVFlQRV9VU0UpXG4iKTsKCQlidWYuYXBwZW5kKCJAaW50ZXJm
YWNlIE1hcmtlcjMge31cbiIpOwkJCgkJYXNzZXJ0RXF1YWxTdHJpbmcocHJldmlldywgYnVmLnRv
U3RyaW5nKCkpOwoJfQoJCn0KCg==
</data>

          </attachment>
          <attachment
              isobsolete="1"
              ispatch="1"
              isprivate="0"
          >
            <attachid>229202</attachid>
            <date>2013-04-01 09:07:00 -0400</date>
            <delta_ts>2013-04-02 05:11:24 -0400</delta_ts>
            <desc>Test cases for AST rewrite for type annotations</desc>
            <filename>patch.txt</filename>
            <type>text/plain</type>
            <size>41662</size>
            <attacher name="shankha banerjee">shankhba</attacher>
            
              <data encoding="base64">ZGlmZiAtLWdpdCBhL29yZy5lY2xpcHNlLmpkdC5jb3JlLnRlc3RzLm1vZGVsL3NyYy9vcmcvZWNs
aXBzZS9qZHQvY29yZS90ZXN0cy9yZXdyaXRlL2Rlc2NyaWJpbmcvQVNUUmV3cml0aW5nRXhwcmVz
c2lvbnNUZXN0LmphdmEgYi9vcmcuZWNsaXBzZS5qZHQuY29yZS50ZXN0cy5tb2RlbC9zcmMvb3Jn
L2VjbGlwc2UvamR0L2NvcmUvdGVzdHMvcmV3cml0ZS9kZXNjcmliaW5nL0FTVFJld3JpdGluZ0V4
cHJlc3Npb25zVGVzdC5qYXZhCmluZGV4IGI3MGE0NjAuLjFiY2NmZmUgMTAwNjQ0Ci0tLSBhL29y
Zy5lY2xpcHNlLmpkdC5jb3JlLnRlc3RzLm1vZGVsL3NyYy9vcmcvZWNsaXBzZS9qZHQvY29yZS90
ZXN0cy9yZXdyaXRlL2Rlc2NyaWJpbmcvQVNUUmV3cml0aW5nRXhwcmVzc2lvbnNUZXN0LmphdmEK
KysrIGIvb3JnLmVjbGlwc2UuamR0LmNvcmUudGVzdHMubW9kZWwvc3JjL29yZy9lY2xpcHNlL2pk
dC9jb3JlL3Rlc3RzL3Jld3JpdGUvZGVzY3JpYmluZy9BU1RSZXdyaXRpbmdFeHByZXNzaW9uc1Rl
c3QuamF2YQpAQCAtMjE0MCw0ICsyMTQwLDgzNiBAQCBwdWJsaWMgY2xhc3MgQVNUUmV3cml0aW5n
RXhwcmVzc2lvbnNUZXN0IGV4dGVuZHMgQVNUUmV3cml0aW5nVGVzdCB7CiAKIAl9CiAKKwlwdWJs
aWMgdm9pZCB0ZXN0Q2FzdEFubm90YXRpb25zKCkgdGhyb3dzIEV4Y2VwdGlvbiB7CisJCWlmICh0
aGlzLmFwaUxldmVsIDwgQVNULkpMUzgpIHJldHVybjsKKwkJSVBhY2thZ2VGcmFnbWVudCBwYWNr
MT0gdGhpcy5zb3VyY2VGb2xkZXIuY3JlYXRlUGFja2FnZUZyYWdtZW50KCJ0ZXN0MSIsIGZhbHNl
LCBudWxsKTsKKwkJU3RyaW5nQnVmZmVyIGJ1Zj0gbmV3IFN0cmluZ0J1ZmZlcigpOworCQlidWYu
YXBwZW5kKCJwYWNrYWdlIHRlc3QxO1xuIik7CisJCWJ1Zi5hcHBlbmQoImltcG9ydCBqYXZhLmxh
bmcuYW5ub3RhdGlvbi5FbGVtZW50VHlwZTtcbiIpOworCQlidWYuYXBwZW5kKCJwdWJsaWMgY2xh
c3MgWCB7XG4iKTsKKwkJYnVmLmFwcGVuZCgiCVN0cmluZyBteU9iamVjdCA9IFwiRm9vXCI7XG4i
KTsKKwkJYnVmLmFwcGVuZCgiCXB1YmxpYyB2b2lkIGZvbygpIHtcbiIpOworCQlidWYuYXBwZW5k
KCIJCVN0cmluZyBteVN0cmluZyA9IChAQW5ub3QgU3RyaW5nKSBteU9iamVjdDtcbiIpOworCQli
dWYuYXBwZW5kKCIJCVN0cmluZyBteVN0cmluZzEgPSAoQEFubm90MSBAQW5ub3QgU3RyaW5nKSBt
eU9iamVjdDtcbiIpOworCQlidWYuYXBwZW5kKCIJfVxuIik7CisJCWJ1Zi5hcHBlbmQoIn1cbiIp
OworCQlidWYuYXBwZW5kKCJAamF2YS5sYW5nLmFubm90YXRpb24uVGFyZ2V0KHZhbHVlID0ge0Vs
ZW1lbnRUeXBlLlRZUEVfVVNFfSlcbiIpOworCQlidWYuYXBwZW5kKCJAaW50ZXJmYWNlIEFubm90
IHt9XG4iKTsKKwkJYnVmLmFwcGVuZCgiQGphdmEubGFuZy5hbm5vdGF0aW9uLlRhcmdldCh2YWx1
ZSA9IHtFbGVtZW50VHlwZS5UWVBFX1VTRX0pXG4iKTsKKwkJYnVmLmFwcGVuZCgiQGludGVyZmFj
ZSBBbm5vdDEge31cbiIpOworCisJCUlDb21waWxhdGlvblVuaXQgY3U9IHBhY2sxLmNyZWF0ZUNv
bXBpbGF0aW9uVW5pdCgiWC5qYXZhIiwgYnVmLnRvU3RyaW5nKCksIGZhbHNlLCBudWxsKTsKKwkJ
Q29tcGlsYXRpb25Vbml0IGFzdFJvb3Q9IGNyZWF0ZUFTVChjdSk7CisJCUFTVFJld3JpdGUgcmV3
cml0ZT0gQVNUUmV3cml0ZS5jcmVhdGUoYXN0Um9vdC5nZXRBU1QoKSk7CisJCUFTVCBhc3Q9IGFz
dFJvb3QuZ2V0QVNUKCk7CisJCVR5cGVEZWNsYXJhdGlvbiB0eXBlPSBmaW5kVHlwZURlY2xhcmF0
aW9uKGFzdFJvb3QsICJYIik7CisJCU1ldGhvZERlY2xhcmF0aW9uIG1ldGhvZERlY2xhcmF0aW9u
PSBmaW5kTWV0aG9kRGVjbGFyYXRpb24odHlwZSwgImZvbyIpOworCQlMaXN0IHN0YXRlbWVudHM9
IG1ldGhvZERlY2xhcmF0aW9uLmdldEJvZHkoKS5zdGF0ZW1lbnRzKCk7CisJCXsvL0FkZCBhbiB1
c2Ugb2YgYW5ub3RhdGlvbi4KKwkJCVZhcmlhYmxlRGVjbGFyYXRpb25TdGF0ZW1lbnQgIHZhcmlh
YmxlRGVjbGFyYXRpb25TdGF0ZW1lbnQ9IChWYXJpYWJsZURlY2xhcmF0aW9uU3RhdGVtZW50KSBz
dGF0ZW1lbnRzLmdldCgwKTsKKwkJCVZhcmlhYmxlRGVjbGFyYXRpb25GcmFnbWVudCB2YXJpYWJs
ZURlY2xhcmF0aW9uRnJhZ21lbnQ9IChWYXJpYWJsZURlY2xhcmF0aW9uRnJhZ21lbnQpIHZhcmlh
YmxlRGVjbGFyYXRpb25TdGF0ZW1lbnQuZnJhZ21lbnRzKCkuZ2V0KDApOworCQkJQ2FzdEV4cHJl
c3Npb24gY2FzdEV4cHJlc3Npb249IChDYXN0RXhwcmVzc2lvbikgdmFyaWFibGVEZWNsYXJhdGlv
bkZyYWdtZW50LmdldEluaXRpYWxpemVyKCk7CisJCQlTaW1wbGVUeXBlIHNpbXBsZVR5cGU9IChT
aW1wbGVUeXBlKSBjYXN0RXhwcmVzc2lvbi5nZXRUeXBlKCk7CisJCQlNYXJrZXJBbm5vdGF0aW9u
IG1hcmtlckFubm90YXRpb249IGFzdC5uZXdNYXJrZXJBbm5vdGF0aW9uKCk7CisJCQltYXJrZXJB
bm5vdGF0aW9uLnNldFR5cGVOYW1lKGFzdC5uZXdTaW1wbGVOYW1lKCJBbm5vdDIiKSk7CisJCQly
ZXdyaXRlLmdldExpc3RSZXdyaXRlKHNpbXBsZVR5cGUsIFNpbXBsZVR5cGUuQU5OT1RBVElPTlNf
UFJPUEVSVFkpLmluc2VydExhc3QobWFya2VyQW5ub3RhdGlvbiwgbnVsbCk7CisJCX0KKwkJewor
CQkJVmFyaWFibGVEZWNsYXJhdGlvblN0YXRlbWVudCAgdmFyaWFibGVEZWNsYXJhdGlvblN0YXRl
bWVudD0gKFZhcmlhYmxlRGVjbGFyYXRpb25TdGF0ZW1lbnQpIHN0YXRlbWVudHMuZ2V0KDEpOwor
CQkJVmFyaWFibGVEZWNsYXJhdGlvbkZyYWdtZW50IHZhcmlhYmxlRGVjbGFyYXRpb25GcmFnbWVu
dD0gKFZhcmlhYmxlRGVjbGFyYXRpb25GcmFnbWVudCkgdmFyaWFibGVEZWNsYXJhdGlvblN0YXRl
bWVudC5mcmFnbWVudHMoKS5nZXQoMCk7CisJCQlDYXN0RXhwcmVzc2lvbiBjYXN0RXhwcmVzc2lv
bj0gKENhc3RFeHByZXNzaW9uKSB2YXJpYWJsZURlY2xhcmF0aW9uRnJhZ21lbnQuZ2V0SW5pdGlh
bGl6ZXIoKTsKKwkJCVNpbXBsZVR5cGUgc2ltcGxlVHlwZT0gKFNpbXBsZVR5cGUpIGNhc3RFeHBy
ZXNzaW9uLmdldFR5cGUoKTsKKwkJCUxpc3QgYW5ub3RhdGlvbnMgPSBzaW1wbGVUeXBlLmFubm90
YXRpb25zKCk7CisJCQkvL1JlbW92ZSB0aGUgdXNlIG9mIGFuIEFubm90YXRpb24KKwkJCXJld3Jp
dGUucmVtb3ZlKChBU1ROb2RlKWFubm90YXRpb25zLmdldCgxKSwgbnVsbCk7CisJCQkvL1JlcGxh
Y2UgdGhlIHVzZSBvZiBhbiBBbm5vdGF0aW9uCisJCQlNYXJrZXJBbm5vdGF0aW9uIG1hcmtlckFu
bm90YXRpb249IGFzdC5uZXdNYXJrZXJBbm5vdGF0aW9uKCk7CisJCQltYXJrZXJBbm5vdGF0aW9u
LnNldFR5cGVOYW1lKGFzdC5uZXdTaW1wbGVOYW1lKCJBbm5vdDIiKSk7CisJCQlyZXdyaXRlLnJl
cGxhY2UoKEFTVE5vZGUpYW5ub3RhdGlvbnMuZ2V0KDApLCBtYXJrZXJBbm5vdGF0aW9uLCBudWxs
KTsKKwkJfQorCQlTdHJpbmcgcHJldmlldz0gZXZhbHVhdGVSZXdyaXRlKGN1LCByZXdyaXRlKTsK
KwkJYnVmPSBuZXcgU3RyaW5nQnVmZmVyKCk7CisJCWJ1Zi5hcHBlbmQoInBhY2thZ2UgdGVzdDE7
XG4iKTsKKwkJYnVmLmFwcGVuZCgiaW1wb3J0IGphdmEubGFuZy5hbm5vdGF0aW9uLkVsZW1lbnRU
eXBlO1xuIik7CisJCWJ1Zi5hcHBlbmQoInB1YmxpYyBjbGFzcyBYIHtcbiIpOworCQlidWYuYXBw
ZW5kKCIJU3RyaW5nIG15T2JqZWN0ID0gXCJGb29cIjtcbiIpOworCQlidWYuYXBwZW5kKCIJcHVi
bGljIHZvaWQgZm9vKCkge1xuIik7CisJCWJ1Zi5hcHBlbmQoIgkJU3RyaW5nIG15U3RyaW5nID0g
KEBBbm5vdCBAQW5ub3QyIFN0cmluZykgbXlPYmplY3Q7XG4iKTsKKwkJYnVmLmFwcGVuZCgiCQlT
dHJpbmcgbXlTdHJpbmcxID0gKEBBbm5vdDIgU3RyaW5nKSBteU9iamVjdDtcbiIpOworCQlidWYu
YXBwZW5kKCIJfVxuIik7CisJCWJ1Zi5hcHBlbmQoIn1cbiIpOworCQlidWYuYXBwZW5kKCJAamF2
YS5sYW5nLmFubm90YXRpb24uVGFyZ2V0KHZhbHVlID0ge0VsZW1lbnRUeXBlLlRZUEVfVVNFfSlc
biIpOworCQlidWYuYXBwZW5kKCJAaW50ZXJmYWNlIEFubm90IHt9XG4iKTsKKwkJYnVmLmFwcGVu
ZCgiQGphdmEubGFuZy5hbm5vdGF0aW9uLlRhcmdldCh2YWx1ZSA9IHtFbGVtZW50VHlwZS5UWVBF
X1VTRX0pXG4iKTsKKwkJYnVmLmFwcGVuZCgiQGludGVyZmFjZSBBbm5vdDEge31cbiIpOworCQlh
c3NlcnRFcXVhbFN0cmluZyhwcmV2aWV3LCBidWYudG9TdHJpbmcoKSk7CisJfQorCisJcHVibGlj
IHZvaWQgdGVzdFdpbGRjYXJkVHlwZUFyZ3VtZW50QW5ub3RhdGlvbnMoKSB0aHJvd3MgRXhjZXB0
aW9uIHsKKwkJaWYgKHRoaXMuYXBpTGV2ZWwgPCBBU1QuSkxTOCkgcmV0dXJuOworCQlJUGFja2Fn
ZUZyYWdtZW50IHBhY2sxPSB0aGlzLnNvdXJjZUZvbGRlci5jcmVhdGVQYWNrYWdlRnJhZ21lbnQo
InRlc3QxIiwgZmFsc2UsIG51bGwpOworCQlTdHJpbmdCdWZmZXIgYnVmPSBuZXcgU3RyaW5nQnVm
ZmVyKCk7CisJCWJ1Zi5hcHBlbmQoInBhY2thZ2UgdGVzdDE7XG4iKTsKKwkJYnVmLmFwcGVuZCgi
aW1wb3J0IGphdmEubGFuZy5hbm5vdGF0aW9uLkVsZW1lbnRUeXBlO1xuIik7CisJCWJ1Zi5hcHBl
bmQoInB1YmxpYyBjbGFzcyBYIHtcbiIpOworCQlidWYuYXBwZW5kKCIJcHVibGljIGNsYXNzIEhl
bHBlcjxUPiB7XG4iKTsKKwkJYnVmLmFwcGVuZCgiCX1cbiIpOworCQlidWYuYXBwZW5kKCIJcHVi
bGljIGNsYXNzIEJhc2Uge1xuIik7CisJCWJ1Zi5hcHBlbmQoIgl9XG4iKTsKKwkJYnVmLmFwcGVu
ZCgiCXB1YmxpYyBzdGF0aWMgdm9pZCBVbmJvdW5kZWRXaWxkY2FyZDEgKEhlbHBlcjxAQW5ub3Qg
Pz4geCkge1xuIik7CisJCWJ1Zi5hcHBlbmQoIgl9XG4iKTsKKwkJYnVmLmFwcGVuZCgiCXB1Ymxp
YyBzdGF0aWMgdm9pZCBVbmJvdW5kZWRXaWxkY2FyZDIgKEhlbHBlcjxAQW5ub3QxIEBBbm5vdCA/
PiB4KSB7XG4iKTsKKwkJYnVmLmFwcGVuZCgiCX1cbiIpOworCQlidWYuYXBwZW5kKCIJcHVibGlj
IHN0YXRpYyB2b2lkIEJvdW5kZWRXaWxkY2FyZDEgKEhlbHBlcjxAQW5ub3QgPyBleHRlbmRzIEJh
c2U+IHgpIHtcbiIpOworCQlidWYuYXBwZW5kKCIJfVxuIik7CisJCWJ1Zi5hcHBlbmQoIglwdWJs
aWMgc3RhdGljIHZvaWQgQm91bmRlZFdpbGRjYXJkMiAoSGVscGVyPEBBbm5vdDEgQEFubm90ID8g
ZXh0ZW5kcyBCYXNlPiB4KSB7XG4iKTsKKwkJYnVmLmFwcGVuZCgiCX1cbiIpOworCQlidWYuYXBw
ZW5kKCJ9XG4iKTsKKwkJYnVmLmFwcGVuZCgiQGphdmEubGFuZy5hbm5vdGF0aW9uLlRhcmdldCAo
RWxlbWVudFR5cGUuVFlQRV9VU0UpXG4iKTsKKwkJYnVmLmFwcGVuZCgiQGludGVyZmFjZSBBbm5v
dCB7fVxuIik7CisJCWJ1Zi5hcHBlbmQoIkBqYXZhLmxhbmcuYW5ub3RhdGlvbi5UYXJnZXQgKEVs
ZW1lbnRUeXBlLlRZUEVfVVNFKVxuIik7CisJCWJ1Zi5hcHBlbmQoIkBpbnRlcmZhY2UgQW5ub3Qx
IHt9XG4iKTsKKworCQlJQ29tcGlsYXRpb25Vbml0IGN1PSBwYWNrMS5jcmVhdGVDb21waWxhdGlv
blVuaXQoIlguamF2YSIsIGJ1Zi50b1N0cmluZygpLCBmYWxzZSwgbnVsbCk7CisJCUNvbXBpbGF0
aW9uVW5pdCBhc3RSb290PSBjcmVhdGVBU1QoY3UpOworCQlBU1RSZXdyaXRlIHJld3JpdGU9IEFT
VFJld3JpdGUuY3JlYXRlKGFzdFJvb3QuZ2V0QVNUKCkpOworCQlBU1QgYXN0PSBhc3RSb290Lmdl
dEFTVCgpOworCQlUeXBlRGVjbGFyYXRpb24gdHlwZT0gZmluZFR5cGVEZWNsYXJhdGlvbihhc3RS
b290LCAiWCIpOworCQl7Ly9BZGQgYW4gdXNlIG9mIGFuIGFubm90YXRpb24uCisJCQlNZXRob2RE
ZWNsYXJhdGlvbiBtZXRob2REZWNsYXJhdGlvbj0gZmluZE1ldGhvZERlY2xhcmF0aW9uKHR5cGUs
ICJVbmJvdW5kZWRXaWxkY2FyZDEiKTsKKwkJCUxpc3QgcGFyYW1ldGVycz0gbWV0aG9kRGVjbGFy
YXRpb24ucGFyYW1ldGVycygpOworCQkJU2luZ2xlVmFyaWFibGVEZWNsYXJhdGlvbiBzaW5nbGVW
YXJpYWJsZURlY2xhcmF0aW9uPSAoU2luZ2xlVmFyaWFibGVEZWNsYXJhdGlvbikgcGFyYW1ldGVy
cy5nZXQoMCk7CisJCQlQYXJhbWV0ZXJpemVkVHlwZSBwYXJhbWV0ZXJpemVkVHlwZT0gKFBhcmFt
ZXRlcml6ZWRUeXBlKSBzaW5nbGVWYXJpYWJsZURlY2xhcmF0aW9uLmdldFR5cGUoKTsKKwkJCVdp
bGRjYXJkVHlwZSB3aWxkY2FyZFR5cGU9IChXaWxkY2FyZFR5cGUpIHBhcmFtZXRlcml6ZWRUeXBl
LnR5cGVBcmd1bWVudHMoKS5nZXQoMCk7CisJCQlNYXJrZXJBbm5vdGF0aW9uIG1hcmtlckFubm90
YXRpb249IGFzdC5uZXdNYXJrZXJBbm5vdGF0aW9uKCk7CisJCQltYXJrZXJBbm5vdGF0aW9uLnNl
dFR5cGVOYW1lKGFzdC5uZXdTaW1wbGVOYW1lKCJBbm5vdDIiKSk7CisJCQlyZXdyaXRlLmdldExp
c3RSZXdyaXRlKHdpbGRjYXJkVHlwZSwgV2lsZGNhcmRUeXBlLkFOTk9UQVRJT05TX1BST1BFUlRZ
KS5pbnNlcnRMYXN0KG1hcmtlckFubm90YXRpb24sIG51bGwpOworCisJCQltZXRob2REZWNsYXJh
dGlvbj0gZmluZE1ldGhvZERlY2xhcmF0aW9uKHR5cGUsICJCb3VuZGVkV2lsZGNhcmQxIik7CisJ
CQlwYXJhbWV0ZXJzPSBtZXRob2REZWNsYXJhdGlvbi5wYXJhbWV0ZXJzKCk7CisJCQlzaW5nbGVW
YXJpYWJsZURlY2xhcmF0aW9uPSAoU2luZ2xlVmFyaWFibGVEZWNsYXJhdGlvbikgcGFyYW1ldGVy
cy5nZXQoMCk7CisJCQlwYXJhbWV0ZXJpemVkVHlwZT0gKFBhcmFtZXRlcml6ZWRUeXBlKSBzaW5n
bGVWYXJpYWJsZURlY2xhcmF0aW9uLmdldFR5cGUoKTsKKwkJCXdpbGRjYXJkVHlwZT0gKFdpbGRj
YXJkVHlwZSkgcGFyYW1ldGVyaXplZFR5cGUudHlwZUFyZ3VtZW50cygpLmdldCgwKTsKKwkJCW1h
cmtlckFubm90YXRpb249IGFzdC5uZXdNYXJrZXJBbm5vdGF0aW9uKCk7CisJCQltYXJrZXJBbm5v
dGF0aW9uLnNldFR5cGVOYW1lKGFzdC5uZXdTaW1wbGVOYW1lKCJBbm5vdDIiKSk7CisJCQlyZXdy
aXRlLmdldExpc3RSZXdyaXRlKHdpbGRjYXJkVHlwZSwgV2lsZGNhcmRUeXBlLkFOTk9UQVRJT05T
X1BST1BFUlRZKS5pbnNlcnRMYXN0KG1hcmtlckFubm90YXRpb24sIG51bGwpOworCQl9CisJCXsK
KwkJCU1ldGhvZERlY2xhcmF0aW9uIG1ldGhvZERlY2xhcmF0aW9uPSBmaW5kTWV0aG9kRGVjbGFy
YXRpb24odHlwZSwgIlVuYm91bmRlZFdpbGRjYXJkMiIpOworCQkJTGlzdCBwYXJhbWV0ZXJzPSBt
ZXRob2REZWNsYXJhdGlvbi5wYXJhbWV0ZXJzKCk7CisJCQlTaW5nbGVWYXJpYWJsZURlY2xhcmF0
aW9uIHNpbmdsZVZhcmlhYmxlRGVjbGFyYXRpb249IChTaW5nbGVWYXJpYWJsZURlY2xhcmF0aW9u
KSBwYXJhbWV0ZXJzLmdldCgwKTsKKwkJCVBhcmFtZXRlcml6ZWRUeXBlIHBhcmFtZXRlcml6ZWRU
eXBlPSAoUGFyYW1ldGVyaXplZFR5cGUpIHNpbmdsZVZhcmlhYmxlRGVjbGFyYXRpb24uZ2V0VHlw
ZSgpOworCQkJV2lsZGNhcmRUeXBlIHdpbGRjYXJkVHlwZT0gKFdpbGRjYXJkVHlwZSkgcGFyYW1l
dGVyaXplZFR5cGUudHlwZUFyZ3VtZW50cygpLmdldCgwKTsKKworCQkJbWV0aG9kRGVjbGFyYXRp
b249IGZpbmRNZXRob2REZWNsYXJhdGlvbih0eXBlLCAiQm91bmRlZFdpbGRjYXJkMiIpOworCQkJ
cGFyYW1ldGVycz0gbWV0aG9kRGVjbGFyYXRpb24ucGFyYW1ldGVycygpOworCQkJc2luZ2xlVmFy
aWFibGVEZWNsYXJhdGlvbj0gKFNpbmdsZVZhcmlhYmxlRGVjbGFyYXRpb24pIHBhcmFtZXRlcnMu
Z2V0KDApOworCQkJcGFyYW1ldGVyaXplZFR5cGU9IChQYXJhbWV0ZXJpemVkVHlwZSkgc2luZ2xl
VmFyaWFibGVEZWNsYXJhdGlvbi5nZXRUeXBlKCk7CisJCQlXaWxkY2FyZFR5cGUgd2lsZGNhcmRU
eXBlMj0gKFdpbGRjYXJkVHlwZSkgcGFyYW1ldGVyaXplZFR5cGUudHlwZUFyZ3VtZW50cygpLmdl
dCgwKTsKKworCQkJLy9SZW1vdmUgdGhlIHVzZSBvZiBhbiBhbm5vdGF0aW9uCisJCQlyZXdyaXRl
LnJlbW92ZSgoTWFya2VyQW5ub3RhdGlvbikgd2lsZGNhcmRUeXBlLmFubm90YXRpb25zKCkuZ2V0
KDEpLCBudWxsKTsKKwkJCXJld3JpdGUucmVtb3ZlKChNYXJrZXJBbm5vdGF0aW9uKSB3aWxkY2Fy
ZFR5cGUyLmFubm90YXRpb25zKCkuZ2V0KDEpLCBudWxsKTsKKworCQkJTWFya2VyQW5ub3RhdGlv
biBtYXJrZXJBbm5vdGF0aW9uPSBhc3QubmV3TWFya2VyQW5ub3RhdGlvbigpOworCQkJbWFya2Vy
QW5ub3RhdGlvbi5zZXRUeXBlTmFtZShhc3QubmV3U2ltcGxlTmFtZSgiQW5ub3QyIikpOworCQkJ
TWFya2VyQW5ub3RhdGlvbiBtYXJrZXJBbm5vdGF0aW9uMj0gYXN0Lm5ld01hcmtlckFubm90YXRp
b24oKTsKKwkJCW1hcmtlckFubm90YXRpb24yLnNldFR5cGVOYW1lKGFzdC5uZXdTaW1wbGVOYW1l
KCJBbm5vdDIiKSk7CisKKwkJCS8vUmVwbGFjZSB0aGUgdXNlIG9mIGFuIGFubm90YXRpb24KKwkJ
CXJld3JpdGUucmVwbGFjZSgoTWFya2VyQW5ub3RhdGlvbikgd2lsZGNhcmRUeXBlLmFubm90YXRp
b25zKCkuZ2V0KDApLCBtYXJrZXJBbm5vdGF0aW9uLCBudWxsKTsKKwkJCXJld3JpdGUucmVwbGFj
ZSgoTWFya2VyQW5ub3RhdGlvbikgd2lsZGNhcmRUeXBlMi5hbm5vdGF0aW9ucygpLmdldCgwKSwg
bWFya2VyQW5ub3RhdGlvbjIsIG51bGwpOworCQl9CisJCVN0cmluZyBwcmV2aWV3PSBldmFsdWF0
ZVJld3JpdGUoY3UsIHJld3JpdGUpOworCQlidWYgPSBuZXcgU3RyaW5nQnVmZmVyKCk7CisJCWJ1
Zi5hcHBlbmQoInBhY2thZ2UgdGVzdDE7XG4iKTsKKwkJYnVmLmFwcGVuZCgiaW1wb3J0IGphdmEu
bGFuZy5hbm5vdGF0aW9uLkVsZW1lbnRUeXBlO1xuIik7CisJCWJ1Zi5hcHBlbmQoInB1YmxpYyBj
bGFzcyBYIHtcbiIpOworCQlidWYuYXBwZW5kKCIJcHVibGljIGNsYXNzIEhlbHBlcjxUPiB7XG4i
KTsKKwkJYnVmLmFwcGVuZCgiCX1cbiIpOworCQlidWYuYXBwZW5kKCIJcHVibGljIGNsYXNzIEJh
c2Uge1xuIik7CisJCWJ1Zi5hcHBlbmQoIgl9XG4iKTsKKwkJYnVmLmFwcGVuZCgiCXB1YmxpYyBz
dGF0aWMgdm9pZCBVbmJvdW5kZWRXaWxkY2FyZDEgKEhlbHBlcjxAQW5ub3QgQEFubm90MiA/PiB4
KSB7XG4iKTsKKwkJYnVmLmFwcGVuZCgiCX1cbiIpOworCQlidWYuYXBwZW5kKCIJcHVibGljIHN0
YXRpYyB2b2lkIFVuYm91bmRlZFdpbGRjYXJkMiAoSGVscGVyPEBBbm5vdDIgPz4geCkge1xuIik7
CisJCWJ1Zi5hcHBlbmQoIgl9XG4iKTsKKwkJYnVmLmFwcGVuZCgiCXB1YmxpYyBzdGF0aWMgdm9p
ZCBCb3VuZGVkV2lsZGNhcmQxIChIZWxwZXI8QEFubm90IEBBbm5vdDIgPyBleHRlbmRzIEJhc2U+
IHgpIHtcbiIpOworCQlidWYuYXBwZW5kKCIJfVxuIik7CisJCWJ1Zi5hcHBlbmQoIglwdWJsaWMg
c3RhdGljIHZvaWQgQm91bmRlZFdpbGRjYXJkMiAoSGVscGVyPEBBbm5vdDIgPyBleHRlbmRzIEJh
c2U+IHgpIHtcbiIpOworCQlidWYuYXBwZW5kKCIJfVxuIik7CisJCWJ1Zi5hcHBlbmQoIn1cbiIp
OworCQlidWYuYXBwZW5kKCJAamF2YS5sYW5nLmFubm90YXRpb24uVGFyZ2V0IChFbGVtZW50VHlw
ZS5UWVBFX1VTRSlcbiIpOworCQlidWYuYXBwZW5kKCJAaW50ZXJmYWNlIEFubm90IHt9XG4iKTsK
KwkJYnVmLmFwcGVuZCgiQGphdmEubGFuZy5hbm5vdGF0aW9uLlRhcmdldCAoRWxlbWVudFR5cGUu
VFlQRV9VU0UpXG4iKTsKKwkJYnVmLmFwcGVuZCgiQGludGVyZmFjZSBBbm5vdDEge31cbiIpOwor
CQlhc3NlcnRFcXVhbFN0cmluZyhwcmV2aWV3LCBidWYudG9TdHJpbmcoKSk7CisJfQorCisJcHVi
bGljIHZvaWQgdGVzdFdpbGRjYXJkQm91ZEFubm90YXRpb24oKSB0aHJvd3MgRXhjZXB0aW9uIHsK
KwkJaWYgKHRoaXMuYXBpTGV2ZWwgPCBBU1QuSkxTOCkgcmV0dXJuOworCQlJUGFja2FnZUZyYWdt
ZW50IHBhY2sxPSB0aGlzLnNvdXJjZUZvbGRlci5jcmVhdGVQYWNrYWdlRnJhZ21lbnQoInRlc3Qx
IiwgZmFsc2UsIG51bGwpOworCQlTdHJpbmdCdWZmZXIgYnVmPSBuZXcgU3RyaW5nQnVmZmVyKCk7
CisKKwkJYnVmLmFwcGVuZCgicHVibGljIGNsYXNzIFgge1xuIik7CisJCWJ1Zi5hcHBlbmQoIglw
dWJsaWMgY2xhc3MgSGVscGVyPFQ+IHtcbiIpOworCQlidWYuYXBwZW5kKCIJfVxuIik7CisJCWJ1
Zi5hcHBlbmQoIglwdWJsaWMgY2xhc3MgQmFzZSB7XG4iKTsKKwkJYnVmLmFwcGVuZCgiCX1cbiIp
OworCQlidWYuYXBwZW5kKCIJcHVibGljIHN0YXRpYyB2b2lkIGZvbzEgKEhlbHBlcjw/IGV4dGVu
ZHMgQEFubm90IEJhc2U+IHgpIHtcbiIpOworCQlidWYuYXBwZW5kKCIJfVxuIik7CisJCWJ1Zi5h
cHBlbmQoIglwdWJsaWMgc3RhdGljIHZvaWQgZm9vMiAoSGVscGVyPD8gZXh0ZW5kcyBAQW5ub3Qx
IEBBbm5vdCBCYXNlPiB4KSB7XG4iKTsKKwkJYnVmLmFwcGVuZCgiCX1cbiIpOworCQlidWYuYXBw
ZW5kKCJ9XG4iKTsKKworCQlJQ29tcGlsYXRpb25Vbml0IGN1PSBwYWNrMS5jcmVhdGVDb21waWxh
dGlvblVuaXQoIlguamF2YSIsIGJ1Zi50b1N0cmluZygpLCBmYWxzZSwgbnVsbCk7CisJCUNvbXBp
bGF0aW9uVW5pdCBhc3RSb290PSBjcmVhdGVBU1QoY3UpOworCQlBU1RSZXdyaXRlIHJld3JpdGU9
IEFTVFJld3JpdGUuY3JlYXRlKGFzdFJvb3QuZ2V0QVNUKCkpOworCQlBU1QgYXN0PSBhc3RSb290
LmdldEFTVCgpOworCQlUeXBlRGVjbGFyYXRpb24gdHlwZT0gZmluZFR5cGVEZWNsYXJhdGlvbihh
c3RSb290LCAiWCIpOworCQl7CisJCQlNZXRob2REZWNsYXJhdGlvbiBtZXRob2REZWNsYXJhdGlv
bj0gZmluZE1ldGhvZERlY2xhcmF0aW9uKHR5cGUsICJmb28xIik7CisJCQlMaXN0IHBhcmFtZXRl
cnM9IG1ldGhvZERlY2xhcmF0aW9uLnBhcmFtZXRlcnMoKTsKKwkJCVNpbmdsZVZhcmlhYmxlRGVj
bGFyYXRpb24gc2luZ2xlVmFyaWFibGVEZWNsYXJhdGlvbj0gKFNpbmdsZVZhcmlhYmxlRGVjbGFy
YXRpb24pIHBhcmFtZXRlcnMuZ2V0KDApOworCQkJUGFyYW1ldGVyaXplZFR5cGUgcGFyYW1ldGVy
aXplZFR5cGU9IChQYXJhbWV0ZXJpemVkVHlwZSkgc2luZ2xlVmFyaWFibGVEZWNsYXJhdGlvbi5n
ZXRUeXBlKCk7CisJCQlXaWxkY2FyZFR5cGUgd2lsZGNhcmRUeXBlPSAoV2lsZGNhcmRUeXBlKSBw
YXJhbWV0ZXJpemVkVHlwZS50eXBlQXJndW1lbnRzKCkuZ2V0KDApOworCQkJU2ltcGxlVHlwZSBz
aW1wbGVUeXBlPSAoU2ltcGxlVHlwZSkgd2lsZGNhcmRUeXBlLmdldEJvdW5kKCk7CisJCQlNYXJr
ZXJBbm5vdGF0aW9uIG1hcmtlckFubm90YXRpb249IGFzdC5uZXdNYXJrZXJBbm5vdGF0aW9uKCk7
CisJCQltYXJrZXJBbm5vdGF0aW9uLnNldFR5cGVOYW1lKGFzdC5uZXdTaW1wbGVOYW1lKCJBbm5v
dDIiKSk7CisJCQlyZXdyaXRlLmdldExpc3RSZXdyaXRlKHNpbXBsZVR5cGUsIFNpbXBsZVR5cGUu
QU5OT1RBVElPTlNfUFJPUEVSVFkpLmluc2VydExhc3QobWFya2VyQW5ub3RhdGlvbiwgbnVsbCk7
CisJCX0KKwkJeworCQkJTWV0aG9kRGVjbGFyYXRpb24gbWV0aG9kRGVjbGFyYXRpb249IGZpbmRN
ZXRob2REZWNsYXJhdGlvbih0eXBlLCAiZm9vMiIpOworCQkJTGlzdCBwYXJhbWV0ZXJzPSBtZXRo
b2REZWNsYXJhdGlvbi5wYXJhbWV0ZXJzKCk7CisJCQlTaW5nbGVWYXJpYWJsZURlY2xhcmF0aW9u
IHNpbmdsZVZhcmlhYmxlRGVjbGFyYXRpb249IChTaW5nbGVWYXJpYWJsZURlY2xhcmF0aW9uKSBw
YXJhbWV0ZXJzLmdldCgwKTsKKwkJCVBhcmFtZXRlcml6ZWRUeXBlIHBhcmFtZXRlcml6ZWRUeXBl
PSAoUGFyYW1ldGVyaXplZFR5cGUpIHNpbmdsZVZhcmlhYmxlRGVjbGFyYXRpb24uZ2V0VHlwZSgp
OworCQkJV2lsZGNhcmRUeXBlIHdpbGRjYXJkVHlwZT0gKFdpbGRjYXJkVHlwZSkgcGFyYW1ldGVy
aXplZFR5cGUudHlwZUFyZ3VtZW50cygpLmdldCgwKTsKKwkJCVNpbXBsZVR5cGUgc2ltcGxlVHlw
ZT0gKFNpbXBsZVR5cGUpIHdpbGRjYXJkVHlwZS5nZXRCb3VuZCgpOworCQkJLy9SZW1vdmUgdGhl
IHVzZSBvZiBhbm5vdGF0aW9uCisJCQlyZXdyaXRlLnJlbW92ZSgoTWFya2VyQW5ub3RhdGlvbikg
c2ltcGxlVHlwZS5hbm5vdGF0aW9ucygpLmdldCgxKSwgbnVsbCk7CisJCQkvL1JlcGxhY2UgdGhl
IHVzZSBvZiBhbm5vdGF0aW9uCisJCQlNYXJrZXJBbm5vdGF0aW9uIG1hcmtlckFubm90YXRpb249
IGFzdC5uZXdNYXJrZXJBbm5vdGF0aW9uKCk7CisJCQltYXJrZXJBbm5vdGF0aW9uLnNldFR5cGVO
YW1lKGFzdC5uZXdTaW1wbGVOYW1lKCJBbm5vdDIiKSk7CisJCQlyZXdyaXRlLnJlcGxhY2UoKE1h
cmtlckFubm90YXRpb24pIHNpbXBsZVR5cGUuYW5ub3RhdGlvbnMoKS5nZXQoMCksIG1hcmtlckFu
bm90YXRpb24sIG51bGwpOworCQl9CisJCVN0cmluZyBwcmV2aWV3PSBldmFsdWF0ZVJld3JpdGUo
Y3UsIHJld3JpdGUpOworCQlidWYgPSBuZXcgU3RyaW5nQnVmZmVyKCk7CisJCWJ1Zi5hcHBlbmQo
InB1YmxpYyBjbGFzcyBYIHtcbiIpOworCQlidWYuYXBwZW5kKCIJcHVibGljIGNsYXNzIEhlbHBl
cjxUPiB7XG4iKTsKKwkJYnVmLmFwcGVuZCgiCX1cbiIpOworCQlidWYuYXBwZW5kKCIJcHVibGlj
IGNsYXNzIEJhc2Uge1xuIik7CisJCWJ1Zi5hcHBlbmQoIgl9XG4iKTsKKwkJYnVmLmFwcGVuZCgi
CXB1YmxpYyBzdGF0aWMgdm9pZCBmb28xIChIZWxwZXI8PyBleHRlbmRzIEBBbm5vdCBAQW5ub3Qy
IEJhc2U+IHgpIHtcbiIpOworCQlidWYuYXBwZW5kKCIJfVxuIik7CisJCWJ1Zi5hcHBlbmQoIglw
dWJsaWMgc3RhdGljIHZvaWQgZm9vMiAoSGVscGVyPD8gZXh0ZW5kcyBAQW5ub3QyIEJhc2U+IHgp
IHtcbiIpOworCQlidWYuYXBwZW5kKCIJfVxuIik7CisJCWJ1Zi5hcHBlbmQoIn1cbiIpOworCQlh
c3NlcnRFcXVhbFN0cmluZyhwcmV2aWV3LCBidWYudG9TdHJpbmcoKSk7CisJfQorCisJcHVibGlj
IHZvaWQgdGVzdFR5cGVQYXJhbWV0ZXJCb3VuZEFubm90YXRpb25zKCkgdGhyb3dzIEV4Y2VwdGlv
biB7CisJCWlmICh0aGlzLmFwaUxldmVsIDwgQVNULkpMUzgpIHJldHVybjsKKwkJSVBhY2thZ2VG
cmFnbWVudCBwYWNrMT0gdGhpcy5zb3VyY2VGb2xkZXIuY3JlYXRlUGFja2FnZUZyYWdtZW50KCJ0
ZXN0MSIsIGZhbHNlLCBudWxsKTsKKwkJU3RyaW5nQnVmZmVyIGJ1Zj0gbmV3IFN0cmluZ0J1ZmZl
cigpOworCisJCWJ1Zi5hcHBlbmQoImltcG9ydCBqYXZhLmxhbmcuYW5ub3RhdGlvbi5FbGVtZW50
VHlwZTtcbiIpOworCQlidWYuYXBwZW5kKCJcbiIpOworCQlidWYuYXBwZW5kKCJwdWJsaWMgY2xh
c3MgWCB7XG4iKTsKKwkJYnVmLmFwcGVuZCgiCXB1YmxpYyBjbGFzcyBCYXNlIHtcbiIpOworCQli
dWYuYXBwZW5kKCIJfVxuIik7CisJCWJ1Zi5hcHBlbmQoIglwdWJsaWMgPFggZXh0ZW5kcyBAQW5u
b3QgQmFzZT4gdm9pZCBmb28xIChYIHgpIHtcbiIpOworCQlidWYuYXBwZW5kKCIJfVxuIik7CisJ
CWJ1Zi5hcHBlbmQoIglwdWJsaWMgPFggZXh0ZW5kcyBAQW5ub3QxIEBBbm5vdCBCYXNlPiB2b2lk
IGZvbzIgKFggeCkge1xuIik7CisJCWJ1Zi5hcHBlbmQoIgl9XG4iKTsKKwkJYnVmLmFwcGVuZCgi
fVxuIik7CisJCWJ1Zi5hcHBlbmQoIlxuIik7CisJCWJ1Zi5hcHBlbmQoIkBqYXZhLmxhbmcuYW5u
b3RhdGlvbi5UYXJnZXQgKEVsZW1lbnRUeXBlLlRZUEVfVVNFKSBcbiIpOworCQlidWYuYXBwZW5k
KCJAaW50ZXJmYWNlIEFubm90IHt9XG4iKTsKKwkJYnVmLmFwcGVuZCgiXG4iKTsKKwkJYnVmLmFw
cGVuZCgiQGphdmEubGFuZy5hbm5vdGF0aW9uLlRhcmdldCAoRWxlbWVudFR5cGUuVFlQRV9VU0Up
IFxuIik7CisJCWJ1Zi5hcHBlbmQoIkBpbnRlcmZhY2UgQW5ub3QxIHt9XG4iKTsKKworCQlJQ29t
cGlsYXRpb25Vbml0IGN1PSBwYWNrMS5jcmVhdGVDb21waWxhdGlvblVuaXQoIlguamF2YSIsIGJ1
Zi50b1N0cmluZygpLCBmYWxzZSwgbnVsbCk7CisJCUNvbXBpbGF0aW9uVW5pdCBhc3RSb290PSBj
cmVhdGVBU1QoY3UpOworCQlBU1RSZXdyaXRlIHJld3JpdGU9IEFTVFJld3JpdGUuY3JlYXRlKGFz
dFJvb3QuZ2V0QVNUKCkpOworCQlBU1QgYXN0PSBhc3RSb290LmdldEFTVCgpOworCQlUeXBlRGVj
bGFyYXRpb24gdHlwZT0gZmluZFR5cGVEZWNsYXJhdGlvbihhc3RSb290LCAiWCIpOworCQl7Ly9B
ZGQgYW4gdXNlIG9mIGFubm90YXRpb24KKwkJCU1ldGhvZERlY2xhcmF0aW9uIG1ldGhvZERlY2xh
cmF0aW9uPSBmaW5kTWV0aG9kRGVjbGFyYXRpb24odHlwZSwgImZvbzEiKTsKKwkJCVR5cGVQYXJh
bWV0ZXIgdHlwZVBhcmFtZXRlcj0gKFR5cGVQYXJhbWV0ZXIpIG1ldGhvZERlY2xhcmF0aW9uLnR5
cGVQYXJhbWV0ZXJzKCkuZ2V0KDApOworCQkJU2ltcGxlVHlwZSBzaW1wbGVUeXBlPSAoU2ltcGxl
VHlwZSkgdHlwZVBhcmFtZXRlci50eXBlQm91bmRzKCkuZ2V0KDApOworCQkJTWFya2VyQW5ub3Rh
dGlvbiBtYXJrZXJBbm5vdGF0aW9uPSBhc3QubmV3TWFya2VyQW5ub3RhdGlvbigpOworCQkJbWFy
a2VyQW5ub3RhdGlvbi5zZXRUeXBlTmFtZShhc3QubmV3U2ltcGxlTmFtZSgiQW5ub3QyIikpOwor
CQkJcmV3cml0ZS5nZXRMaXN0UmV3cml0ZShzaW1wbGVUeXBlLCBTaW1wbGVUeXBlLkFOTk9UQVRJ
T05TX1BST1BFUlRZKS5pbnNlcnRMYXN0KG1hcmtlckFubm90YXRpb24sIG51bGwpOworCQl9CisJ
CXsKKwkJCU1ldGhvZERlY2xhcmF0aW9uIG1ldGhvZERlY2xhcmF0aW9uPSBmaW5kTWV0aG9kRGVj
bGFyYXRpb24odHlwZSwgImZvbzIiKTsKKwkJCVR5cGVQYXJhbWV0ZXIgdHlwZVBhcmFtZXRlcj0g
KFR5cGVQYXJhbWV0ZXIpIG1ldGhvZERlY2xhcmF0aW9uLnR5cGVQYXJhbWV0ZXJzKCkuZ2V0KDAp
OworCQkJU2ltcGxlVHlwZSBzaW1wbGVUeXBlPSAoU2ltcGxlVHlwZSkgdHlwZVBhcmFtZXRlci50
eXBlQm91bmRzKCkuZ2V0KDApOworCQkJLy9SZW1vdmUgYW4gdXNlIG9mIGFubm90YXRpb24KKwkJ
CXJld3JpdGUucmVtb3ZlKChNYXJrZXJBbm5vdGF0aW9uKSBzaW1wbGVUeXBlLmFubm90YXRpb25z
KCkuZ2V0KDEpLCBudWxsKTsKKwkJCS8vUmVwbGFjZSBhbiB1c2Ugb2YgYW5ub3RhdGlvbgorCQkJ
TWFya2VyQW5ub3RhdGlvbiBtYXJrZXJBbm5vdGF0aW9uPSBhc3QubmV3TWFya2VyQW5ub3RhdGlv
bigpOworCQkJbWFya2VyQW5ub3RhdGlvbi5zZXRUeXBlTmFtZShhc3QubmV3U2ltcGxlTmFtZSgi
QW5ub3QyIikpOworCQkJcmV3cml0ZS5yZXBsYWNlKChNYXJrZXJBbm5vdGF0aW9uKSBzaW1wbGVU
eXBlLmFubm90YXRpb25zKCkuZ2V0KDApLCBtYXJrZXJBbm5vdGF0aW9uLCBudWxsKTsKKwkJfQor
CQlTdHJpbmcgcHJldmlldz0gZXZhbHVhdGVSZXdyaXRlKGN1LCByZXdyaXRlKTsKKwkJYnVmID0g
bmV3IFN0cmluZ0J1ZmZlcigpOworCQlidWYuYXBwZW5kKCJpbXBvcnQgamF2YS5sYW5nLmFubm90
YXRpb24uRWxlbWVudFR5cGU7XG4iKTsKKwkJYnVmLmFwcGVuZCgiXG4iKTsKKwkJYnVmLmFwcGVu
ZCgicHVibGljIGNsYXNzIFgge1xuIik7CisJCWJ1Zi5hcHBlbmQoIglwdWJsaWMgY2xhc3MgQmFz
ZSB7XG4iKTsKKwkJYnVmLmFwcGVuZCgiCX1cbiIpOworCQlidWYuYXBwZW5kKCIJcHVibGljIDxY
IGV4dGVuZHMgQEFubm90IEBBbm5vdDIgQmFzZT4gdm9pZCBmb28xIChYIHgpIHtcbiIpOworCQli
dWYuYXBwZW5kKCIJfVxuIik7CisJCWJ1Zi5hcHBlbmQoIglwdWJsaWMgPFggZXh0ZW5kcyBAQW5u
b3QyIEJhc2U+IHZvaWQgZm9vMiAoWCB4KSB7XG4iKTsKKwkJYnVmLmFwcGVuZCgiCX1cbiIpOwor
CQlidWYuYXBwZW5kKCJ9XG4iKTsKKwkJYnVmLmFwcGVuZCgiXG4iKTsKKwkJYnVmLmFwcGVuZCgi
QGphdmEubGFuZy5hbm5vdGF0aW9uLlRhcmdldCAoRWxlbWVudFR5cGUuVFlQRV9VU0UpIFxuIik7
CisJCWJ1Zi5hcHBlbmQoIkBpbnRlcmZhY2UgQW5ub3Qge31cbiIpOworCQlidWYuYXBwZW5kKCJc
biIpOworCQlidWYuYXBwZW5kKCJAamF2YS5sYW5nLmFubm90YXRpb24uVGFyZ2V0IChFbGVtZW50
VHlwZS5UWVBFX1VTRSkgXG4iKTsKKwkJYnVmLmFwcGVuZCgiQGludGVyZmFjZSBBbm5vdDEge31c
biIpOworCQlhc3NlcnRFcXVhbFN0cmluZyhwcmV2aWV3LCBidWYudG9TdHJpbmcoKSk7CisJfQor
CisJcHVibGljIHZvaWQgdGVzdFR5cGVBcmd1bWVudHNQYXJhbWV0ZXJpemVkQ2xhc3Nlc0Fubm90
YXRpb25zKCkgdGhyb3dzIEV4Y2VwdGlvbiB7CisJCWlmICh0aGlzLmFwaUxldmVsIDwgQVNULkpM
UzgpIHJldHVybjsKKwkJSVBhY2thZ2VGcmFnbWVudCBwYWNrMT0gdGhpcy5zb3VyY2VGb2xkZXIu
Y3JlYXRlUGFja2FnZUZyYWdtZW50KCJ0ZXN0MSIsIGZhbHNlLCBudWxsKTsKKwkJU3RyaW5nQnVm
ZmVyIGJ1Zj0gbmV3IFN0cmluZ0J1ZmZlcigpOworCisJCWJ1Zi5hcHBlbmQoImltcG9ydCBqYXZh
LmxhbmcuYW5ub3RhdGlvbi5FbGVtZW50VHlwZTtcbiIpOworCQlidWYuYXBwZW5kKCJcbiIpOwor
CQlidWYuYXBwZW5kKCJwdWJsaWMgY2xhc3MgWCB7XG4iKTsKKwkJYnVmLmFwcGVuZCgiCXB1Ymxp
YyBjbGFzcyBIZWxwZXIgPFQxLCBUMj4ge1xuIik7CisJCWJ1Zi5hcHBlbmQoIgl9XG4iKTsKKwkJ
YnVmLmFwcGVuZCgiCXB1YmxpYyB2b2lkIGZvbygpIHtcbiIpOworCQlidWYuYXBwZW5kKCIJCUhl
bHBlcjxAQW5ub3QgU3RyaW5nLCBAQW5ub3QgQEFubm90MSBTdHJpbmc+IHg7XG4iKTsKKwkJYnVm
LmFwcGVuZCgiCX1cbiIpOworCQlidWYuYXBwZW5kKCJ9XG4iKTsKKwkJYnVmLmFwcGVuZCgiXG4i
KTsKKwkJYnVmLmFwcGVuZCgiQGphdmEubGFuZy5hbm5vdGF0aW9uLlRhcmdldCAoRWxlbWVudFR5
cGUuVFlQRV9VU0UpIFxuIik7CisJCWJ1Zi5hcHBlbmQoIkBpbnRlcmZhY2UgQW5ub3Qge31cbiIp
OworCQlidWYuYXBwZW5kKCJcbiIpOworCQlidWYuYXBwZW5kKCJAamF2YS5sYW5nLmFubm90YXRp
b24uVGFyZ2V0IChFbGVtZW50VHlwZS5UWVBFX1VTRSkgXG4iKTsKKwkJYnVmLmFwcGVuZCgiQGlu
dGVyZmFjZSBBbm5vdDEge31cbiIpOworCisJCUlDb21waWxhdGlvblVuaXQgY3U9IHBhY2sxLmNy
ZWF0ZUNvbXBpbGF0aW9uVW5pdCgiWC5qYXZhIiwgYnVmLnRvU3RyaW5nKCksIGZhbHNlLCBudWxs
KTsKKwkJQ29tcGlsYXRpb25Vbml0IGFzdFJvb3Q9IGNyZWF0ZUFTVChjdSk7CisJCUFTVFJld3Jp
dGUgcmV3cml0ZT0gQVNUUmV3cml0ZS5jcmVhdGUoYXN0Um9vdC5nZXRBU1QoKSk7CisJCUFTVCBh
c3Q9IGFzdFJvb3QuZ2V0QVNUKCk7CisJCVR5cGVEZWNsYXJhdGlvbiB0eXBlPSBmaW5kVHlwZURl
Y2xhcmF0aW9uKGFzdFJvb3QsICJYIik7CisJCU1ldGhvZERlY2xhcmF0aW9uIG1ldGhvZERlY2xh
cmF0aW9uPSBmaW5kTWV0aG9kRGVjbGFyYXRpb24odHlwZSwgImZvbyIpOworCQlMaXN0IHN0YXRl
bWVudHM9IG1ldGhvZERlY2xhcmF0aW9uLmdldEJvZHkoKS5zdGF0ZW1lbnRzKCk7CisJCVZhcmlh
YmxlRGVjbGFyYXRpb25TdGF0ZW1lbnQgIHZhcmlhYmxlRGVjbGFyYXRpb25TdGF0ZW1lbnQ9IChW
YXJpYWJsZURlY2xhcmF0aW9uU3RhdGVtZW50KSBzdGF0ZW1lbnRzLmdldCgwKTsKKwkJUGFyYW1l
dGVyaXplZFR5cGUgcGFyYW1ldGVyaXplZFR5cGU9IChQYXJhbWV0ZXJpemVkVHlwZSkgdmFyaWFi
bGVEZWNsYXJhdGlvblN0YXRlbWVudC5nZXRUeXBlKCk7CisJCXsvLyBBZGQgYW4gdXNlIG9mIGFu
bm90YXRpb24KKwkJCVNpbXBsZVR5cGUgc2ltcGxlVHlwZT0gKFNpbXBsZVR5cGUpIHBhcmFtZXRl
cml6ZWRUeXBlLnR5cGVBcmd1bWVudHMoKS5nZXQoMCk7CisJCQlNYXJrZXJBbm5vdGF0aW9uIG1h
cmtlckFubm90YXRpb249IGFzdC5uZXdNYXJrZXJBbm5vdGF0aW9uKCk7CisJCQltYXJrZXJBbm5v
dGF0aW9uLnNldFR5cGVOYW1lKGFzdC5uZXdTaW1wbGVOYW1lKCJBbm5vdDIiKSk7CisJCQlyZXdy
aXRlLmdldExpc3RSZXdyaXRlKHNpbXBsZVR5cGUsIFNpbXBsZVR5cGUuQU5OT1RBVElPTlNfUFJP
UEVSVFkpLmluc2VydExhc3QobWFya2VyQW5ub3RhdGlvbiwgbnVsbCk7CisJCX0KKwkJeworCQkJ
U2ltcGxlVHlwZSBzaW1wbGVUeXBlPSAoU2ltcGxlVHlwZSkgcGFyYW1ldGVyaXplZFR5cGUudHlw
ZUFyZ3VtZW50cygpLmdldCgxKTsKKwkJCU1hcmtlckFubm90YXRpb24gbWFya2VyQW5ub3RhdGlv
bj0gYXN0Lm5ld01hcmtlckFubm90YXRpb24oKTsKKwkJCW1hcmtlckFubm90YXRpb24uc2V0VHlw
ZU5hbWUoYXN0Lm5ld1NpbXBsZU5hbWUoIkFubm90MiIpKTsKKwkJCS8vUmVtb3ZlIGFuIHVzZSBv
ZiBhbiBhbm5vdGF0aW9uCisJCQlyZXdyaXRlLnJlbW92ZSgoQVNUTm9kZSkgc2ltcGxlVHlwZS5h
bm5vdGF0aW9ucygpLmdldCgxKSwgbnVsbCk7CisJCQkvL1JlcGxhY2UgYW4gdXNlIG9mIGFuIGFu
bm90YXRpb24KKwkJCXJld3JpdGUucmVwbGFjZSgoQVNUTm9kZSkgc2ltcGxlVHlwZS5hbm5vdGF0
aW9ucygpLmdldCgwKSwgbWFya2VyQW5ub3RhdGlvbiwgbnVsbCk7CisJCQkvL0VtcHR5IGFubm90
YXRpb25zIGxpc3QKKwkJCXJld3JpdGUucmVtb3ZlKChBU1ROb2RlKSBzaW1wbGVUeXBlLmFubm90
YXRpb25zKCkuZ2V0KDApLCBudWxsKTsKKwkJfQorCQlTdHJpbmcgcHJldmlldz0gZXZhbHVhdGVS
ZXdyaXRlKGN1LCByZXdyaXRlKTsKKwkJYnVmID0gbmV3IFN0cmluZ0J1ZmZlcigpOworCQlidWYu
YXBwZW5kKCJpbXBvcnQgamF2YS5sYW5nLmFubm90YXRpb24uRWxlbWVudFR5cGU7XG4iKTsKKwkJ
YnVmLmFwcGVuZCgiXG4iKTsKKwkJYnVmLmFwcGVuZCgicHVibGljIGNsYXNzIFgge1xuIik7CisJ
CWJ1Zi5hcHBlbmQoIglwdWJsaWMgY2xhc3MgSGVscGVyIDxUMSwgVDI+IHtcbiIpOworCQlidWYu
YXBwZW5kKCIJfVxuIik7CisJCWJ1Zi5hcHBlbmQoIglwdWJsaWMgdm9pZCBmb28oKSB7XG4iKTsK
KwkJYnVmLmFwcGVuZCgiCQlIZWxwZXI8QEFubm90IEBBbm5vdDIgU3RyaW5nLCBTdHJpbmc+IHg7
XG4iKTsKKwkJYnVmLmFwcGVuZCgiCX1cbiIpOworCQlidWYuYXBwZW5kKCJ9XG4iKTsKKwkJYnVm
LmFwcGVuZCgiXG4iKTsKKwkJYnVmLmFwcGVuZCgiQGphdmEubGFuZy5hbm5vdGF0aW9uLlRhcmdl
dCAoRWxlbWVudFR5cGUuVFlQRV9VU0UpIFxuIik7CisJCWJ1Zi5hcHBlbmQoIkBpbnRlcmZhY2Ug
QW5ub3Qge31cbiIpOworCQlidWYuYXBwZW5kKCJcbiIpOworCQlidWYuYXBwZW5kKCJAamF2YS5s
YW5nLmFubm90YXRpb24uVGFyZ2V0IChFbGVtZW50VHlwZS5UWVBFX1VTRSkgXG4iKTsKKwkJYnVm
LmFwcGVuZCgiQGludGVyZmFjZSBBbm5vdDEge31cbiIpOworCQlhc3NlcnRFcXVhbFN0cmluZyhw
cmV2aWV3LCBidWYudG9TdHJpbmcoKSk7CisJfQorCisJcHVibGljIHZvaWQgdGVzdFR5cGVBcmd1
bWVudHNNZXRob2RJbnZvY2F0aW9uKCkgdGhyb3dzIEV4Y2VwdGlvbiB7CisJCWlmICh0aGlzLmFw
aUxldmVsIDwgQVNULkpMUzgpIHJldHVybjsKKwkJSVBhY2thZ2VGcmFnbWVudCBwYWNrMT0gdGhp
cy5zb3VyY2VGb2xkZXIuY3JlYXRlUGFja2FnZUZyYWdtZW50KCJ0ZXN0MSIsIGZhbHNlLCBudWxs
KTsKKwkJU3RyaW5nQnVmZmVyIGJ1Zj0gbmV3IFN0cmluZ0J1ZmZlcigpOworCisJCWJ1Zi5hcHBl
bmQoImltcG9ydCBqYXZhLmxhbmcuYW5ub3RhdGlvbi5FbGVtZW50VHlwZTtcbiIpOworCQlidWYu
YXBwZW5kKCJcbiIpOworCQlidWYuYXBwZW5kKCJwdWJsaWMgY2xhc3MgWCB7XG4iKTsKKwkJYnVm
LmFwcGVuZCgiCXB1YmxpYyBjbGFzcyBCYXIge1xuIik7CisJCWJ1Zi5hcHBlbmQoIgl9XG4iKTsK
KwkJYnVmLmFwcGVuZCgiCVxuIik7CisJCWJ1Zi5hcHBlbmQoIglwdWJsaWMgY2xhc3MgSGVscGVy
IHtcbiIpOworCQlidWYuYXBwZW5kKCIJCXB1YmxpYyA8VD4gdm9pZCBmb28oKSB7XG4iKTsKKwkJ
YnVmLmFwcGVuZCgiCQl9XG4iKTsKKwkJYnVmLmFwcGVuZCgiCX1cbiIpOworCQlidWYuYXBwZW5k
KCIJXG4iKTsKKwkJYnVmLmFwcGVuZCgiCXB1YmxpYyB2b2lkIHpvbygpIHtcbiIpOworCQlidWYu
YXBwZW5kKCIJCUhlbHBlciBvID0gbmV3IEhlbHBlcigpO1xuIik7CisJCWJ1Zi5hcHBlbmQoIgkJ
by48QEFubm90IEJhcj5mb28oKTtcbiIpOworCQlidWYuYXBwZW5kKCIJCW8uPEBBbm5vdCBAQW5u
b3QxIEJhcj5mb28oKTtcbiIpOworCQlidWYuYXBwZW5kKCIJfVxuIik7CisJCWJ1Zi5hcHBlbmQo
In1cbiIpOworCQlidWYuYXBwZW5kKCJcbiIpOworCQlidWYuYXBwZW5kKCJAamF2YS5sYW5nLmFu
bm90YXRpb24uVGFyZ2V0IChFbGVtZW50VHlwZS5UWVBFX1VTRSkgXG4iKTsKKwkJYnVmLmFwcGVu
ZCgiQGludGVyZmFjZSBBbm5vdCB7fVxuIik7CisJCWJ1Zi5hcHBlbmQoIlxuIik7CisJCWJ1Zi5h
cHBlbmQoIkBqYXZhLmxhbmcuYW5ub3RhdGlvbi5UYXJnZXQgKEVsZW1lbnRUeXBlLlRZUEVfVVNF
KSBcbiIpOworCQlidWYuYXBwZW5kKCJAaW50ZXJmYWNlIEFubm90MSB7fVxuIik7CisKKwkJSUNv
bXBpbGF0aW9uVW5pdCBjdT0gcGFjazEuY3JlYXRlQ29tcGlsYXRpb25Vbml0KCJYLmphdmEiLCBi
dWYudG9TdHJpbmcoKSwgZmFsc2UsIG51bGwpOworCQlDb21waWxhdGlvblVuaXQgYXN0Um9vdD0g
Y3JlYXRlQVNUKGN1KTsKKwkJQVNUUmV3cml0ZSByZXdyaXRlPSBBU1RSZXdyaXRlLmNyZWF0ZShh
c3RSb290LmdldEFTVCgpKTsKKwkJQVNUIGFzdD0gYXN0Um9vdC5nZXRBU1QoKTsKKwkJVHlwZURl
Y2xhcmF0aW9uIHR5cGU9IGZpbmRUeXBlRGVjbGFyYXRpb24oYXN0Um9vdCwgIlgiKTsKKwkJTWV0
aG9kRGVjbGFyYXRpb24gbWV0aG9kRGVjbGFyYXRpb24gPSBmaW5kTWV0aG9kRGVjbGFyYXRpb24o
dHlwZSwgInpvbyIpOworCQlMaXN0IHN0YXRlbUxpc3QgPSBtZXRob2REZWNsYXJhdGlvbi5nZXRC
b2R5KCkuc3RhdGVtZW50cygpOworCQl7Ly8gQWRkIGFuIHVzZSBvZiBhbiBhbm5vdGF0aW9uCisJ
CQlFeHByZXNzaW9uU3RhdGVtZW50IGV4cHJlc3Npb249IChFeHByZXNzaW9uU3RhdGVtZW50KSBz
dGF0ZW1MaXN0LmdldCgxKTsKKwkJCU1ldGhvZEludm9jYXRpb24gbWV0aG9kSW52b2NhdGlvbj0g
KE1ldGhvZEludm9jYXRpb24pIGV4cHJlc3Npb24uZ2V0RXhwcmVzc2lvbigpOworCQkJU2ltcGxl
VHlwZSBzaW1wbGVUeXBlID0gKFNpbXBsZVR5cGUpIG1ldGhvZEludm9jYXRpb24udHlwZUFyZ3Vt
ZW50cygpLmdldCgwKTsKKwkJCU1hcmtlckFubm90YXRpb24gbWFya2VyQW5ub3RhdGlvbj0gYXN0
Lm5ld01hcmtlckFubm90YXRpb24oKTsKKwkJCW1hcmtlckFubm90YXRpb24uc2V0VHlwZU5hbWUo
YXN0Lm5ld1NpbXBsZU5hbWUoIkFubm90MiIpKTsKKwkJCXJld3JpdGUuZ2V0TGlzdFJld3JpdGUo
c2ltcGxlVHlwZSwgU2ltcGxlVHlwZS5BTk5PVEFUSU9OU19QUk9QRVJUWSkuaW5zZXJ0TGFzdCht
YXJrZXJBbm5vdGF0aW9uLCBudWxsKTsKKwkJfQorCQl7CisJCQlFeHByZXNzaW9uU3RhdGVtZW50
IGV4cHJlc3Npb249IChFeHByZXNzaW9uU3RhdGVtZW50KSBzdGF0ZW1MaXN0LmdldCgyKTsKKwkJ
CU1ldGhvZEludm9jYXRpb24gbWV0aG9kSW52b2NhdGlvbj0gKE1ldGhvZEludm9jYXRpb24pIGV4
cHJlc3Npb24uZ2V0RXhwcmVzc2lvbigpOworCQkJU2ltcGxlVHlwZSBzaW1wbGVUeXBlID0gKFNp
bXBsZVR5cGUpIG1ldGhvZEludm9jYXRpb24udHlwZUFyZ3VtZW50cygpLmdldCgwKTsKKwkJCXJl
d3JpdGUucmVtb3ZlKChNYXJrZXJBbm5vdGF0aW9uKXNpbXBsZVR5cGUuYW5ub3RhdGlvbnMoKS5n
ZXQoMSksIG51bGwpOworCQkJTWFya2VyQW5ub3RhdGlvbiBtYXJrZXJBbm5vdGF0aW9uPSBhc3Qu
bmV3TWFya2VyQW5ub3RhdGlvbigpOworCQkJbWFya2VyQW5ub3RhdGlvbi5zZXRUeXBlTmFtZShh
c3QubmV3U2ltcGxlTmFtZSgiQW5ub3QyIikpOworCQkJcmV3cml0ZS5yZXBsYWNlKChNYXJrZXJB
bm5vdGF0aW9uKXNpbXBsZVR5cGUuYW5ub3RhdGlvbnMoKS5nZXQoMCksIG1hcmtlckFubm90YXRp
b24sIG51bGwpOworCQl9CisJCVN0cmluZyBwcmV2aWV3PSBldmFsdWF0ZVJld3JpdGUoY3UsIHJl
d3JpdGUpOworCQlidWYgPSBuZXcgU3RyaW5nQnVmZmVyKCk7CisJCWJ1Zi5hcHBlbmQoImltcG9y
dCBqYXZhLmxhbmcuYW5ub3RhdGlvbi5FbGVtZW50VHlwZTtcbiIpOworCQlidWYuYXBwZW5kKCJc
biIpOworCQlidWYuYXBwZW5kKCJwdWJsaWMgY2xhc3MgWCB7XG4iKTsKKwkJYnVmLmFwcGVuZCgi
CXB1YmxpYyBjbGFzcyBCYXIge1xuIik7CisJCWJ1Zi5hcHBlbmQoIgl9XG4iKTsKKwkJYnVmLmFw
cGVuZCgiCVxuIik7CisJCWJ1Zi5hcHBlbmQoIglwdWJsaWMgY2xhc3MgSGVscGVyIHtcbiIpOwor
CQlidWYuYXBwZW5kKCIJCXB1YmxpYyA8VD4gdm9pZCBmb28oKSB7XG4iKTsKKwkJYnVmLmFwcGVu
ZCgiCQl9XG4iKTsKKwkJYnVmLmFwcGVuZCgiCX1cbiIpOworCQlidWYuYXBwZW5kKCIJXG4iKTsK
KwkJYnVmLmFwcGVuZCgiCXB1YmxpYyB2b2lkIHpvbygpIHtcbiIpOworCQlidWYuYXBwZW5kKCIJ
CUhlbHBlciBvID0gbmV3IEhlbHBlcigpO1xuIik7CisJCWJ1Zi5hcHBlbmQoIgkJby48QEFubm90
IEBBbm5vdDIgQmFyPmZvbygpO1xuIik7CisJCWJ1Zi5hcHBlbmQoIgkJby48QEFubm90MiBCYXI+
Zm9vKCk7XG4iKTsKKwkJYnVmLmFwcGVuZCgiCX1cbiIpOworCQlidWYuYXBwZW5kKCJ9XG4iKTsK
KwkJYnVmLmFwcGVuZCgiXG4iKTsKKwkJYnVmLmFwcGVuZCgiQGphdmEubGFuZy5hbm5vdGF0aW9u
LlRhcmdldCAoRWxlbWVudFR5cGUuVFlQRV9VU0UpIFxuIik7CisJCWJ1Zi5hcHBlbmQoIkBpbnRl
cmZhY2UgQW5ub3Qge31cbiIpOworCQlidWYuYXBwZW5kKCJcbiIpOworCQlidWYuYXBwZW5kKCJA
amF2YS5sYW5nLmFubm90YXRpb24uVGFyZ2V0IChFbGVtZW50VHlwZS5UWVBFX1VTRSkgXG4iKTsK
KwkJYnVmLmFwcGVuZCgiQGludGVyZmFjZSBBbm5vdDEge31cbiIpOworCQlhc3NlcnRFcXVhbFN0
cmluZyhwcmV2aWV3LCBidWYudG9TdHJpbmcoKSk7CisJfQorCisJcHVibGljIHZvaWQgdGVzdENs
YXNzSW5oZXJpdGVuY2VBbm5vdGF0aW9ucygpIHRocm93cyBFeGNlcHRpb24geworCQlpZiAodGhp
cy5hcGlMZXZlbCA8IEFTVC5KTFM4KSByZXR1cm47CisJCUlQYWNrYWdlRnJhZ21lbnQgcGFjazE9
IHRoaXMuc291cmNlRm9sZGVyLmNyZWF0ZVBhY2thZ2VGcmFnbWVudCgidGVzdDEiLCBmYWxzZSwg
bnVsbCk7CisJCVN0cmluZ0J1ZmZlciBidWY9IG5ldyBTdHJpbmdCdWZmZXIoKTsKKworCQlidWYu
YXBwZW5kKCJpbXBvcnQgamF2YS5sYW5nLmFubm90YXRpb24uRWxlbWVudFR5cGU7XG4iKTsKKwkJ
YnVmLmFwcGVuZCgiXG4iKTsKKwkJYnVmLmFwcGVuZCgicHVibGljIGNsYXNzIFgge1xuIik7CisJ
CWJ1Zi5hcHBlbmQoIglwdWJsaWMgaW50ZXJmYWNlIEhlbHBlcjxUPiB7XG4iKTsKKwkJYnVmLmFw
cGVuZCgiCX1cbiIpOworCQlidWYuYXBwZW5kKCIJcHVibGljIGNsYXNzIEZvbzE8VD4gaW1wbGVt
ZW50cyBAQW5ub3QgSGVscGVyPFQ+IHtcbiIpOworCQlidWYuYXBwZW5kKCIJfVxuIik7CisJCWJ1
Zi5hcHBlbmQoIglwdWJsaWMgY2xhc3MgRm9vMjxUPiBpbXBsZW1lbnRzIEBBbm5vdCBAQW5ub3Qx
IEhlbHBlcjxUPiB7XG4iKTsKKwkJYnVmLmFwcGVuZCgiCX1cbiIpOworCQlidWYuYXBwZW5kKCJ9
XG4iKTsKKwkJYnVmLmFwcGVuZCgiXG4iKTsKKwkJYnVmLmFwcGVuZCgiQGphdmEubGFuZy5hbm5v
dGF0aW9uLlRhcmdldCAoRWxlbWVudFR5cGUuVFlQRV9VU0UpXG4iKTsKKwkJYnVmLmFwcGVuZCgi
QGludGVyZmFjZSBBbm5vdCB7fVxuIik7CisJCWJ1Zi5hcHBlbmQoIlxuIik7CisJCWJ1Zi5hcHBl
bmQoIkBqYXZhLmxhbmcuYW5ub3RhdGlvbi5UYXJnZXQgKEVsZW1lbnRUeXBlLlRZUEVfVVNFKVxu
Iik7CisJCWJ1Zi5hcHBlbmQoIkBpbnRlcmZhY2UgQW5ub3QxIHt9XG4iKTsKKworCQlJQ29tcGls
YXRpb25Vbml0IGN1PSBwYWNrMS5jcmVhdGVDb21waWxhdGlvblVuaXQoIlguamF2YSIsIGJ1Zi50
b1N0cmluZygpLCBmYWxzZSwgbnVsbCk7CisJCUNvbXBpbGF0aW9uVW5pdCBhc3RSb290PSBjcmVh
dGVBU1QoY3UpOworCQlBU1RSZXdyaXRlIHJld3JpdGU9IEFTVFJld3JpdGUuY3JlYXRlKGFzdFJv
b3QuZ2V0QVNUKCkpOworCQlBU1QgYXN0PSBhc3RSb290LmdldEFTVCgpOworCQlUeXBlRGVjbGFy
YXRpb24gdHlwZT0gZmluZFR5cGVEZWNsYXJhdGlvbihhc3RSb290LCAiWCIpOworCQl7Ly9BZGQg
dGhlIHVzZSBvZiBhbiBhbm5vdGF0aW9uCisJCQlUeXBlRGVjbGFyYXRpb24gdHlwZURlY2xhcmF0
aW9uPSAoVHlwZURlY2xhcmF0aW9uKSB0eXBlLmJvZHlEZWNsYXJhdGlvbnMoKS5nZXQoMSk7CisJ
CQlQYXJhbWV0ZXJpemVkVHlwZSBwYXJhbWV0ZXJpemVkVHlwZT0gKFBhcmFtZXRlcml6ZWRUeXBl
KSB0eXBlRGVjbGFyYXRpb24uc3VwZXJJbnRlcmZhY2VUeXBlcygpLmdldCgwKTsKKwkJCVNpbXBs
ZVR5cGUgc2ltcGxlVHlwZT0gKFNpbXBsZVR5cGUpIHBhcmFtZXRlcml6ZWRUeXBlLmdldFR5cGUo
KTsKKwkJCU1hcmtlckFubm90YXRpb24gbWFya2VyQW5ub3RhdGlvbj0gYXN0Lm5ld01hcmtlckFu
bm90YXRpb24oKTsKKwkJCW1hcmtlckFubm90YXRpb24uc2V0VHlwZU5hbWUoYXN0Lm5ld1NpbXBs
ZU5hbWUoIkFubm90MiIpKTsKKwkJCXJld3JpdGUuZ2V0TGlzdFJld3JpdGUoc2ltcGxlVHlwZSwg
U2ltcGxlVHlwZS5BTk5PVEFUSU9OU19QUk9QRVJUWSkuaW5zZXJ0TGFzdChtYXJrZXJBbm5vdGF0
aW9uLCBudWxsKTsKKwkJfQorCQl7CisJCQlUeXBlRGVjbGFyYXRpb24gdHlwZURlY2xhcmF0aW9u
PSAoVHlwZURlY2xhcmF0aW9uKSB0eXBlLmJvZHlEZWNsYXJhdGlvbnMoKS5nZXQoMik7CisJCQlQ
YXJhbWV0ZXJpemVkVHlwZSBwYXJhbWV0ZXJpemVkVHlwZT0gKFBhcmFtZXRlcml6ZWRUeXBlKSB0
eXBlRGVjbGFyYXRpb24uc3VwZXJJbnRlcmZhY2VUeXBlcygpLmdldCgwKTsKKwkJCVNpbXBsZVR5
cGUgc2ltcGxlVHlwZT0gKFNpbXBsZVR5cGUpIHBhcmFtZXRlcml6ZWRUeXBlLmdldFR5cGUoKTsK
KwkJCS8vUmVtb3ZlIHRoZSB1c2Ugb2YgYW4gYW5ub3RhdGlvbgorCQkJcmV3cml0ZS5yZW1vdmUo
KE1hcmtlckFubm90YXRpb24pIHNpbXBsZVR5cGUuYW5ub3RhdGlvbnMoKS5nZXQoMSksIG51bGwp
OworCQkJLy9SZXBsYWNlIHRoZSB1c2Ugb2YgYW4gYW5ub3RhdGlvbgorCQkJTWFya2VyQW5ub3Rh
dGlvbiBtYXJrZXJBbm5vdGF0aW9uPSBhc3QubmV3TWFya2VyQW5ub3RhdGlvbigpOworCQkJbWFy
a2VyQW5ub3RhdGlvbi5zZXRUeXBlTmFtZShhc3QubmV3U2ltcGxlTmFtZSgiQW5ub3QyIikpOwor
CQkJcmV3cml0ZS5yZXBsYWNlKChNYXJrZXJBbm5vdGF0aW9uKSBzaW1wbGVUeXBlLmFubm90YXRp
b25zKCkuZ2V0KDApLCBtYXJrZXJBbm5vdGF0aW9uLCBudWxsKTsKKwkJfQorCQlTdHJpbmcgcHJl
dmlldz0gZXZhbHVhdGVSZXdyaXRlKGN1LCByZXdyaXRlKTsKKwkJYnVmID0gbmV3IFN0cmluZ0J1
ZmZlcigpOworCQlidWYuYXBwZW5kKCJpbXBvcnQgamF2YS5sYW5nLmFubm90YXRpb24uRWxlbWVu
dFR5cGU7XG4iKTsKKwkJYnVmLmFwcGVuZCgiXG4iKTsKKwkJYnVmLmFwcGVuZCgicHVibGljIGNs
YXNzIFgge1xuIik7CisJCWJ1Zi5hcHBlbmQoIglwdWJsaWMgaW50ZXJmYWNlIEhlbHBlcjxUPiB7
XG4iKTsKKwkJYnVmLmFwcGVuZCgiCX1cbiIpOworCQlidWYuYXBwZW5kKCIJcHVibGljIGNsYXNz
IEZvbzE8VD4gaW1wbGVtZW50cyBAQW5ub3QgQEFubm90MiBIZWxwZXI8VD4ge1xuIik7CisJCWJ1
Zi5hcHBlbmQoIgl9XG4iKTsKKwkJYnVmLmFwcGVuZCgiCXB1YmxpYyBjbGFzcyBGb28yPFQ+IGlt
cGxlbWVudHMgQEFubm90MiBIZWxwZXI8VD4ge1xuIik7CisJCWJ1Zi5hcHBlbmQoIgl9XG4iKTsK
KwkJYnVmLmFwcGVuZCgifVxuIik7CisJCWJ1Zi5hcHBlbmQoIlxuIik7CisJCWJ1Zi5hcHBlbmQo
IkBqYXZhLmxhbmcuYW5ub3RhdGlvbi5UYXJnZXQgKEVsZW1lbnRUeXBlLlRZUEVfVVNFKVxuIik7
CisJCWJ1Zi5hcHBlbmQoIkBpbnRlcmZhY2UgQW5ub3Qge31cbiIpOworCQlidWYuYXBwZW5kKCJc
biIpOworCQlidWYuYXBwZW5kKCJAamF2YS5sYW5nLmFubm90YXRpb24uVGFyZ2V0IChFbGVtZW50
VHlwZS5UWVBFX1VTRSlcbiIpOworCQlidWYuYXBwZW5kKCJAaW50ZXJmYWNlIEFubm90MSB7fVxu
Iik7CisJCWFzc2VydEVxdWFsU3RyaW5nKHByZXZpZXcsIGJ1Zi50b1N0cmluZygpKTsKKwl9CisK
KwlwdWJsaWMgdm9pZCB0ZXN0VHlwZVRlc3RzKCkgdGhyb3dzIEV4Y2VwdGlvbiB7CisJCWlmICh0
aGlzLmFwaUxldmVsIDwgQVNULkpMUzgpIHJldHVybjsKKwkJSVBhY2thZ2VGcmFnbWVudCBwYWNr
MT0gdGhpcy5zb3VyY2VGb2xkZXIuY3JlYXRlUGFja2FnZUZyYWdtZW50KCJ0ZXN0MSIsIGZhbHNl
LCBudWxsKTsKKwkJU3RyaW5nQnVmZmVyIGJ1Zj0gbmV3IFN0cmluZ0J1ZmZlcigpOworCisJCWJ1
Zi5hcHBlbmQoImltcG9ydCBqYXZhLmxhbmcuYW5ub3RhdGlvbi5FbGVtZW50VHlwZTtcbiIpOwor
CQlidWYuYXBwZW5kKCJcbiIpOworCQlidWYuYXBwZW5kKCJwdWJsaWMgY2xhc3MgWCB7XG4iKTsK
KwkJYnVmLmFwcGVuZCgiCXB1YmxpYyBjbGFzcyBIZWxwZXIge1xuIik7CisJCWJ1Zi5hcHBlbmQo
Igl9XG4iKTsKKwkJYnVmLmFwcGVuZCgiCVxuIik7CisJCWJ1Zi5hcHBlbmQoIglwdWJsaWMgdm9p
ZCBmb28oKSB7XG4iKTsKKwkJYnVmLmFwcGVuZCgiCUhlbHBlciBhID0gbmV3IEBBbm5vdCBIZWxw
ZXIoKTtcbiIpOworCQlidWYuYXBwZW5kKCIJYm9vbGVhbiB4ID0gdHJ1ZTtcbiIpOworCQlidWYu
YXBwZW5kKCIJeCA9IGEgaW5zdGFuY2VvZiBAQW5ub3QgSGVscGVyO1xuIik7CisJCWJ1Zi5hcHBl
bmQoIgl4ID0gYSBpbnN0YW5jZW9mIEBBbm5vdCBAQW5ub3QxIEhlbHBlcjtcbiIpOworCQlidWYu
YXBwZW5kKCIJfVxuIik7CisJCWJ1Zi5hcHBlbmQoIn1cbiIpOworCQlidWYuYXBwZW5kKCJcbiIp
OworCQlidWYuYXBwZW5kKCJAamF2YS5sYW5nLmFubm90YXRpb24uVGFyZ2V0IChFbGVtZW50VHlw
ZS5UWVBFX1VTRSlcbiIpOworCQlidWYuYXBwZW5kKCJAaW50ZXJmYWNlIEFubm90IHt9XG4iKTsK
KwkJYnVmLmFwcGVuZCgiXG4iKTsKKwkJYnVmLmFwcGVuZCgiQGphdmEubGFuZy5hbm5vdGF0aW9u
LlRhcmdldCAoRWxlbWVudFR5cGUuVFlQRV9VU0UpXG4iKTsKKwkJYnVmLmFwcGVuZCgiQGludGVy
ZmFjZSBBbm5vdDEge31cbiIpOworCisJCUlDb21waWxhdGlvblVuaXQgY3U9IHBhY2sxLmNyZWF0
ZUNvbXBpbGF0aW9uVW5pdCgiWC5qYXZhIiwgYnVmLnRvU3RyaW5nKCksIGZhbHNlLCBudWxsKTsK
KwkJQ29tcGlsYXRpb25Vbml0IGFzdFJvb3Q9IGNyZWF0ZUFTVChjdSk7CisJCUFTVFJld3JpdGUg
cmV3cml0ZT0gQVNUUmV3cml0ZS5jcmVhdGUoYXN0Um9vdC5nZXRBU1QoKSk7CisJCUFTVCBhc3Q9
IGFzdFJvb3QuZ2V0QVNUKCk7CisJCVR5cGVEZWNsYXJhdGlvbiB0eXBlPSBmaW5kVHlwZURlY2xh
cmF0aW9uKGFzdFJvb3QsICJYIik7CisJCU1ldGhvZERlY2xhcmF0aW9uIG1ldGhvZERlY2xhcmF0
aW9uPSBmaW5kTWV0aG9kRGVjbGFyYXRpb24odHlwZSwgImZvbyIpOworCQl7Ly9BZGQgYW4gdXNl
IG9mIGFubm90YXRpb24KKwkJCUV4cHJlc3Npb25TdGF0ZW1lbnQgZXhwcmVzc2lvblN0YXRlbWVu
dD0gKEV4cHJlc3Npb25TdGF0ZW1lbnQpIG1ldGhvZERlY2xhcmF0aW9uLmdldEJvZHkoKS5zdGF0
ZW1lbnRzKCkuZ2V0KDIpOworCQkJQXNzaWdubWVudCBhc3NpZ25tZW50PSAoQXNzaWdubWVudCkg
ZXhwcmVzc2lvblN0YXRlbWVudC5nZXRFeHByZXNzaW9uKCk7CisJCQlJbnN0YW5jZW9mRXhwcmVz
c2lvbiBpbnN0YW5jZW9mRXhwcmVzc2lvbj0gKEluc3RhbmNlb2ZFeHByZXNzaW9uKSBhc3NpZ25t
ZW50LmdldFJpZ2h0SGFuZFNpZGUoKTsKKwkJCVNpbXBsZVR5cGUgc2ltcGxlVHlwZSA9IChTaW1w
bGVUeXBlKSBpbnN0YW5jZW9mRXhwcmVzc2lvbi5nZXRSaWdodE9wZXJhbmQoKTsKKwkJCU1hcmtl
ckFubm90YXRpb24gbWFya2VyQW5ub3RhdGlvbj0gYXN0Lm5ld01hcmtlckFubm90YXRpb24oKTsK
KwkJCW1hcmtlckFubm90YXRpb24uc2V0VHlwZU5hbWUoYXN0Lm5ld1NpbXBsZU5hbWUoIkFubm90
MiIpKTsKKwkJCXJld3JpdGUuZ2V0TGlzdFJld3JpdGUoc2ltcGxlVHlwZSwgU2ltcGxlVHlwZS5B
Tk5PVEFUSU9OU19QUk9QRVJUWSkuaW5zZXJ0TGFzdChtYXJrZXJBbm5vdGF0aW9uLCBudWxsKTsK
KwkJfQorCQl7CisJCQlFeHByZXNzaW9uU3RhdGVtZW50IGV4cHJlc3Npb25TdGF0ZW1lbnQ9IChF
eHByZXNzaW9uU3RhdGVtZW50KSBtZXRob2REZWNsYXJhdGlvbi5nZXRCb2R5KCkuc3RhdGVtZW50
cygpLmdldCgzKTsKKwkJCUFzc2lnbm1lbnQgYXNzaWdubWVudD0gKEFzc2lnbm1lbnQpIGV4cHJl
c3Npb25TdGF0ZW1lbnQuZ2V0RXhwcmVzc2lvbigpOworCQkJSW5zdGFuY2VvZkV4cHJlc3Npb24g
aW5zdGFuY2VvZkV4cHJlc3Npb249IChJbnN0YW5jZW9mRXhwcmVzc2lvbikgYXNzaWdubWVudC5n
ZXRSaWdodEhhbmRTaWRlKCk7CisJCQlTaW1wbGVUeXBlIHNpbXBsZVR5cGUgPSAoU2ltcGxlVHlw
ZSkgaW5zdGFuY2VvZkV4cHJlc3Npb24uZ2V0UmlnaHRPcGVyYW5kKCk7CisJCQkvL1JlbW92ZSBh
biB1c2Ugb2YgYW5ub3RhdGlvbgorCQkJcmV3cml0ZS5yZW1vdmUoKE1hcmtlckFubm90YXRpb24p
IHNpbXBsZVR5cGUuYW5ub3RhdGlvbnMoKS5nZXQoMSksIG51bGwpOworCQkJTWFya2VyQW5ub3Rh
dGlvbiBtYXJrZXJBbm5vdGF0aW9uPSBhc3QubmV3TWFya2VyQW5ub3RhdGlvbigpOworCQkJbWFy
a2VyQW5ub3RhdGlvbi5zZXRUeXBlTmFtZShhc3QubmV3U2ltcGxlTmFtZSgiQW5ub3QyIikpOwor
CQkJLy9SZXBsYWNlIGFuIHVzZSBvZiBhbm5vdGF0aW9uCisJCQlyZXdyaXRlLnJlcGxhY2UoKE1h
cmtlckFubm90YXRpb24pIHNpbXBsZVR5cGUuYW5ub3RhdGlvbnMoKS5nZXQoMCksIG1hcmtlckFu
bm90YXRpb24sIG51bGwpOworCQl9CisJCVN0cmluZyBwcmV2aWV3PSBldmFsdWF0ZVJld3JpdGUo
Y3UsIHJld3JpdGUpOworCQlidWYgPSBuZXcgU3RyaW5nQnVmZmVyKCk7CisJCWJ1Zi5hcHBlbmQo
ImltcG9ydCBqYXZhLmxhbmcuYW5ub3RhdGlvbi5FbGVtZW50VHlwZTtcbiIpOworCQlidWYuYXBw
ZW5kKCJcbiIpOworCQlidWYuYXBwZW5kKCJwdWJsaWMgY2xhc3MgWCB7XG4iKTsKKwkJYnVmLmFw
cGVuZCgiCXB1YmxpYyBjbGFzcyBIZWxwZXIge1xuIik7CisJCWJ1Zi5hcHBlbmQoIgl9XG4iKTsK
KwkJYnVmLmFwcGVuZCgiCVxuIik7CisJCWJ1Zi5hcHBlbmQoIglwdWJsaWMgdm9pZCBmb28oKSB7
XG4iKTsKKwkJYnVmLmFwcGVuZCgiCUhlbHBlciBhID0gbmV3IEBBbm5vdCBIZWxwZXIoKTtcbiIp
OworCQlidWYuYXBwZW5kKCIJYm9vbGVhbiB4ID0gdHJ1ZTtcbiIpOworCQlidWYuYXBwZW5kKCIJ
eCA9IGEgaW5zdGFuY2VvZiBAQW5ub3QgQEFubm90MiBIZWxwZXI7XG4iKTsKKwkJYnVmLmFwcGVu
ZCgiCXggPSBhIGluc3RhbmNlb2YgQEFubm90MiBIZWxwZXI7XG4iKTsKKwkJYnVmLmFwcGVuZCgi
CX1cbiIpOworCQlidWYuYXBwZW5kKCJ9XG4iKTsKKwkJYnVmLmFwcGVuZCgiXG4iKTsKKwkJYnVm
LmFwcGVuZCgiQGphdmEubGFuZy5hbm5vdGF0aW9uLlRhcmdldCAoRWxlbWVudFR5cGUuVFlQRV9V
U0UpXG4iKTsKKwkJYnVmLmFwcGVuZCgiQGludGVyZmFjZSBBbm5vdCB7fVxuIik7CisJCWJ1Zi5h
cHBlbmQoIlxuIik7CisJCWJ1Zi5hcHBlbmQoIkBqYXZhLmxhbmcuYW5ub3RhdGlvbi5UYXJnZXQg
KEVsZW1lbnRUeXBlLlRZUEVfVVNFKVxuIik7CisJCWJ1Zi5hcHBlbmQoIkBpbnRlcmZhY2UgQW5u
b3QxIHt9XG4iKTsKKwkJYXNzZXJ0RXF1YWxTdHJpbmcocHJldmlldywgYnVmLnRvU3RyaW5nKCkp
OworCX0KKworCXB1YmxpYyB2b2lkIHRlc3RDb25zdHJ1Y3Rvckludm9jYXRpb24oKSB0aHJvd3Mg
RXhjZXB0aW9uIHsKKwkJaWYgKHRoaXMuYXBpTGV2ZWwgPCBBU1QuSkxTOCkgcmV0dXJuOworCQlJ
UGFja2FnZUZyYWdtZW50IHBhY2sxPSB0aGlzLnNvdXJjZUZvbGRlci5jcmVhdGVQYWNrYWdlRnJh
Z21lbnQoInRlc3QxIiwgZmFsc2UsIG51bGwpOworCQlTdHJpbmdCdWZmZXIgYnVmPSBuZXcgU3Ry
aW5nQnVmZmVyKCk7CisJCWJ1Zi5hcHBlbmQoImltcG9ydCBqYXZhLmxhbmcuYW5ub3RhdGlvbi5F
bGVtZW50VHlwZTtcbiIpOworCQlidWYuYXBwZW5kKCIgXG4iKTsKKwkJYnVmLmFwcGVuZCgicHVi
bGljIGNsYXNzIFgge1xuIik7CisJCWJ1Zi5hcHBlbmQoIglwdWJsaWMgY2xhc3MgSGVscGVyIHtc
biIpOworCQlidWYuYXBwZW5kKCIJfQlcbiIpOworCQlidWYuYXBwZW5kKCIJcHVibGljIHZvaWQg
Zm9vKCkge1xuIik7CisJCWJ1Zi5hcHBlbmQoIgkJSGVscGVyIG9iaiA9IG5ldyBAQW5ub3QgSGVs
cGVyKCk7XG4iKTsKKwkJYnVmLmFwcGVuZCgiCQlvYmogPSBuZXcgQEFubm90IEBBbm5vdDEgSGVs
cGVyKCk7XG4iKTsKKwkJYnVmLmFwcGVuZCgiCX1cbiIpOworCQlidWYuYXBwZW5kKCJ9XG4iKTsK
KwkJYnVmLmFwcGVuZCgiXG4iKTsKKwkJYnVmLmFwcGVuZCgiQGphdmEubGFuZy5hbm5vdGF0aW9u
LlRhcmdldCAoRWxlbWVudFR5cGUuVFlQRV9VU0UpXG4iKTsKKwkJYnVmLmFwcGVuZCgiQGludGVy
ZmFjZSBBbm5vdCB7fVxuIik7CisJCWJ1Zi5hcHBlbmQoIlxuIik7CisJCWJ1Zi5hcHBlbmQoIkBq
YXZhLmxhbmcuYW5ub3RhdGlvbi5UYXJnZXQgKEVsZW1lbnRUeXBlLlRZUEVfVVNFKVxuIik7CisJ
CWJ1Zi5hcHBlbmQoIkBpbnRlcmZhY2UgQW5ub3QxIHt9XG4iKTsKKworCQlJQ29tcGlsYXRpb25V
bml0IGN1PSBwYWNrMS5jcmVhdGVDb21waWxhdGlvblVuaXQoIlguamF2YSIsIGJ1Zi50b1N0cmlu
ZygpLCBmYWxzZSwgbnVsbCk7CisJCUNvbXBpbGF0aW9uVW5pdCBhc3RSb290PSBjcmVhdGVBU1Qo
Y3UpOworCQlBU1RSZXdyaXRlIHJld3JpdGU9IEFTVFJld3JpdGUuY3JlYXRlKGFzdFJvb3QuZ2V0
QVNUKCkpOworCQlBU1QgYXN0PSBhc3RSb290LmdldEFTVCgpOworCQlUeXBlRGVjbGFyYXRpb24g
dHlwZT0gZmluZFR5cGVEZWNsYXJhdGlvbihhc3RSb290LCAiWCIpOworCQlNZXRob2REZWNsYXJh
dGlvbiBtZXRob2REZWNsYXJhdGlvbj0gZmluZE1ldGhvZERlY2xhcmF0aW9uKHR5cGUsICJmb28i
KTsKKwkJTGlzdCBzdGF0ZW1lbnRzPSBtZXRob2REZWNsYXJhdGlvbi5nZXRCb2R5KCkuc3RhdGVt
ZW50cygpOworCQl7Ly9BZGQgYW4gdXNlIG9mIGFubm90YXRpb24KKwkJCVZhcmlhYmxlRGVjbGFy
YXRpb25TdGF0ZW1lbnQgIHZhcmlhYmxlRGVjbGFyYXRpb25TdGF0ZW1lbnQ9IChWYXJpYWJsZURl
Y2xhcmF0aW9uU3RhdGVtZW50KSBzdGF0ZW1lbnRzLmdldCgwKTsKKwkJCVZhcmlhYmxlRGVjbGFy
YXRpb25GcmFnbWVudCB2YXJpYWJsZURlY2xhcmF0aW9uRnJhZ21lbnQ9IChWYXJpYWJsZURlY2xh
cmF0aW9uRnJhZ21lbnQpIHZhcmlhYmxlRGVjbGFyYXRpb25TdGF0ZW1lbnQuZnJhZ21lbnRzKCku
Z2V0KDApOworCQkJQ2xhc3NJbnN0YW5jZUNyZWF0aW9uIGNsYXNzSW5zdGFuY2VDcmVhdGlvbiA9
IChDbGFzc0luc3RhbmNlQ3JlYXRpb24pIHZhcmlhYmxlRGVjbGFyYXRpb25GcmFnbWVudC5nZXRJ
bml0aWFsaXplcigpOworCQkJU2ltcGxlVHlwZSBzaW1wbGVUeXBlID0gKFNpbXBsZVR5cGUpIGNs
YXNzSW5zdGFuY2VDcmVhdGlvbi5nZXRUeXBlKCk7CisJCQlNYXJrZXJBbm5vdGF0aW9uIG1hcmtl
ckFubm90YXRpb249IGFzdC5uZXdNYXJrZXJBbm5vdGF0aW9uKCk7CisJCQltYXJrZXJBbm5vdGF0
aW9uLnNldFR5cGVOYW1lKGFzdC5uZXdTaW1wbGVOYW1lKCJBbm5vdDIiKSk7CisJCQlyZXdyaXRl
LmdldExpc3RSZXdyaXRlKHNpbXBsZVR5cGUsIFNpbXBsZVR5cGUuQU5OT1RBVElPTlNfUFJPUEVS
VFkpLmluc2VydExhc3QobWFya2VyQW5ub3RhdGlvbiwgbnVsbCk7CisJCX0KKwkJeworCQkJRXhw
cmVzc2lvblN0YXRlbWVudCBleHByZXNzaW9uU3RhdGVtZW50PSAoRXhwcmVzc2lvblN0YXRlbWVu
dCkgbWV0aG9kRGVjbGFyYXRpb24uZ2V0Qm9keSgpLnN0YXRlbWVudHMoKS5nZXQoMSk7CisJCQlB
c3NpZ25tZW50IGFzc2lnbm1lbnQ9IChBc3NpZ25tZW50KSBleHByZXNzaW9uU3RhdGVtZW50Lmdl
dEV4cHJlc3Npb24oKTsKKwkJCUNsYXNzSW5zdGFuY2VDcmVhdGlvbiBjbGFzc0luc3RhbmNlQ3Jl
YXRpb24gPSAoQ2xhc3NJbnN0YW5jZUNyZWF0aW9uKSBhc3NpZ25tZW50LmdldFJpZ2h0SGFuZFNp
ZGUoKTsKKwkJCVNpbXBsZVR5cGUgc2ltcGxlVHlwZSA9IChTaW1wbGVUeXBlKSBjbGFzc0luc3Rh
bmNlQ3JlYXRpb24uZ2V0VHlwZSgpOworCQkJLy9SZW1vdmUgYW4gdXNlIG9mIGFubm90YXRpb24K
KwkJCXJld3JpdGUucmVtb3ZlKChNYXJrZXJBbm5vdGF0aW9uKSBzaW1wbGVUeXBlLmFubm90YXRp
b25zKCkuZ2V0KDEpLCBudWxsKTsKKwkJCU1hcmtlckFubm90YXRpb24gbWFya2VyQW5ub3RhdGlv
bj0gYXN0Lm5ld01hcmtlckFubm90YXRpb24oKTsKKwkJCW1hcmtlckFubm90YXRpb24uc2V0VHlw
ZU5hbWUoYXN0Lm5ld1NpbXBsZU5hbWUoIkFubm90MiIpKTsKKwkJCS8vUmVwbGFjZSBhbiB1c2Ug
b2YgYW5ub3RhdGlvbgorCQkJcmV3cml0ZS5yZXBsYWNlKChNYXJrZXJBbm5vdGF0aW9uKSBzaW1w
bGVUeXBlLmFubm90YXRpb25zKCkuZ2V0KDApLCBtYXJrZXJBbm5vdGF0aW9uLCBudWxsKTsKKwkJ
fQorCQlTdHJpbmcgcHJldmlldz0gZXZhbHVhdGVSZXdyaXRlKGN1LCByZXdyaXRlKTsKKwkJYnVm
ID0gbmV3IFN0cmluZ0J1ZmZlcigpOworCQlidWYuYXBwZW5kKCJpbXBvcnQgamF2YS5sYW5nLmFu
bm90YXRpb24uRWxlbWVudFR5cGU7XG4iKTsKKwkJYnVmLmFwcGVuZCgiIFxuIik7CisJCWJ1Zi5h
cHBlbmQoInB1YmxpYyBjbGFzcyBYIHtcbiIpOworCQlidWYuYXBwZW5kKCIJcHVibGljIGNsYXNz
IEhlbHBlciB7XG4iKTsKKwkJYnVmLmFwcGVuZCgiCX0JXG4iKTsKKwkJYnVmLmFwcGVuZCgiCXB1
YmxpYyB2b2lkIGZvbygpIHtcbiIpOworCQlidWYuYXBwZW5kKCIJCUhlbHBlciBvYmogPSBuZXcg
QEFubm90IEBBbm5vdDIgSGVscGVyKCk7XG4iKTsKKwkJYnVmLmFwcGVuZCgiCQlvYmogPSBuZXcg
QEFubm90MiBIZWxwZXIoKTtcbiIpOworCQlidWYuYXBwZW5kKCIJfVxuIik7CisJCWJ1Zi5hcHBl
bmQoIn1cbiIpOworCQlidWYuYXBwZW5kKCJcbiIpOworCQlidWYuYXBwZW5kKCJAamF2YS5sYW5n
LmFubm90YXRpb24uVGFyZ2V0IChFbGVtZW50VHlwZS5UWVBFX1VTRSlcbiIpOworCQlidWYuYXBw
ZW5kKCJAaW50ZXJmYWNlIEFubm90IHt9XG4iKTsKKwkJYnVmLmFwcGVuZCgiXG4iKTsKKwkJYnVm
LmFwcGVuZCgiQGphdmEubGFuZy5hbm5vdGF0aW9uLlRhcmdldCAoRWxlbWVudFR5cGUuVFlQRV9V
U0UpXG4iKTsKKwkJYnVmLmFwcGVuZCgiQGludGVyZmFjZSBBbm5vdDEge31cbiIpOworCQlhc3Nl
cnRFcXVhbFN0cmluZyhwcmV2aWV3LCBidWYudG9TdHJpbmcoKSk7CisJfQorCisJcHVibGljIHZv
aWQgdGVzdENvbnN0cnVjdG9yRGVjbGFyYXRpb24oKSB0aHJvd3MgRXhjZXB0aW9uIHsKKwkJaWYg
KHRoaXMuYXBpTGV2ZWwgPCBBU1QuSkxTOCkgcmV0dXJuOworCQlJUGFja2FnZUZyYWdtZW50IHBh
Y2sxPSB0aGlzLnNvdXJjZUZvbGRlci5jcmVhdGVQYWNrYWdlRnJhZ21lbnQoInRlc3QxIiwgZmFs
c2UsIG51bGwpOworCQlTdHJpbmdCdWZmZXIgYnVmPSBuZXcgU3RyaW5nQnVmZmVyKCk7CisJCWJ1
Zi5hcHBlbmQoImltcG9ydCBqYXZhLmxhbmcuYW5ub3RhdGlvbi5FbGVtZW50VHlwZTtcbiIpOwor
CQlidWYuYXBwZW5kKCJcbiIpOworCQlidWYuYXBwZW5kKCJwdWJsaWMgY2xhc3MgWCB7XG4iKTsK
KwkJYnVmLmFwcGVuZCgiCUBBbm5vdCBYICgpIHtcbiIpOworCQlidWYuYXBwZW5kKCIJfVxuIik7
CisJCWJ1Zi5hcHBlbmQoIglAQW5ub3QgQEFubm90MSBYIChpbnQgeCkge1xuIik7CisJCWJ1Zi5h
cHBlbmQoIgl9XG4iKTsKKwkJYnVmLmFwcGVuZCgifVxuIik7CisJCWJ1Zi5hcHBlbmQoIlxuIik7
CisJCWJ1Zi5hcHBlbmQoIkBqYXZhLmxhbmcuYW5ub3RhdGlvbi5UYXJnZXQgKEVsZW1lbnRUeXBl
LlRZUEVfVVNFKVxuIik7CisJCWJ1Zi5hcHBlbmQoIkBpbnRlcmZhY2UgQW5ub3Qge31cbiIpOwor
CQlidWYuYXBwZW5kKCJcbiIpOworCQlidWYuYXBwZW5kKCJAamF2YS5sYW5nLmFubm90YXRpb24u
VGFyZ2V0IChFbGVtZW50VHlwZS5UWVBFX1VTRSlcbiIpOworCQlidWYuYXBwZW5kKCJAaW50ZXJm
YWNlIEFubm90MSB7fVxuIik7CisKKwkJSUNvbXBpbGF0aW9uVW5pdCBjdT0gcGFjazEuY3JlYXRl
Q29tcGlsYXRpb25Vbml0KCJYLmphdmEiLCBidWYudG9TdHJpbmcoKSwgZmFsc2UsIG51bGwpOwor
CQlDb21waWxhdGlvblVuaXQgYXN0Um9vdD0gY3JlYXRlQVNUKGN1KTsKKwkJQVNUUmV3cml0ZSBy
ZXdyaXRlPSBBU1RSZXdyaXRlLmNyZWF0ZShhc3RSb290LmdldEFTVCgpKTsKKwkJQVNUIGFzdD0g
YXN0Um9vdC5nZXRBU1QoKTsKKwkJVHlwZURlY2xhcmF0aW9uIHR5cGU9IGZpbmRUeXBlRGVjbGFy
YXRpb24oYXN0Um9vdCwgIlgiKTsKKwkJey8vQWRkIHRoZSB1c2Ugb2YgYW5ub3RhdGlvbgorCQkJ
TWV0aG9kRGVjbGFyYXRpb24gbWV0aG9kRGVjbGFyYXRpb249IChNZXRob2REZWNsYXJhdGlvbikg
dHlwZS5ib2R5RGVjbGFyYXRpb25zKCkuZ2V0KDApOworCQkJTWFya2VyQW5ub3RhdGlvbiBtYXJr
ZXJBbm5vdGF0aW9uPSBhc3QubmV3TWFya2VyQW5ub3RhdGlvbigpOworCQkJbWFya2VyQW5ub3Rh
dGlvbi5zZXRUeXBlTmFtZShhc3QubmV3U2ltcGxlTmFtZSgiQW5ub3QyIikpOworCQkJcmV3cml0
ZS5nZXRMaXN0UmV3cml0ZShtZXRob2REZWNsYXJhdGlvbiwgTWV0aG9kRGVjbGFyYXRpb24uTU9E
SUZJRVJTMl9QUk9QRVJUWSkuaW5zZXJ0TGFzdChtYXJrZXJBbm5vdGF0aW9uLCBudWxsKTsKKwkJ
fQorCQl7CisJCQkvL1JlbW92ZSB0aGUgdXNlIG9mIGFubm90YXRpb24KKwkJCU1ldGhvZERlY2xh
cmF0aW9uIG1ldGhvZERlY2xhcmF0aW9uPSAoTWV0aG9kRGVjbGFyYXRpb24pIHR5cGUuYm9keURl
Y2xhcmF0aW9ucygpLmdldCgxKTsKKwkJCXJld3JpdGUucmVtb3ZlKChNYXJrZXJBbm5vdGF0aW9u
KSBtZXRob2REZWNsYXJhdGlvbi5tb2RpZmllcnMoKS5nZXQoMSksIG51bGwpOworCQkJLy9SZXBs
YWNlIHRoZSB1c2Ugb2YgYW5ub3RhdGlvbgorCQkJTWFya2VyQW5ub3RhdGlvbiBtYXJrZXJBbm5v
dGF0aW9uPSBhc3QubmV3TWFya2VyQW5ub3RhdGlvbigpOworCQkJbWFya2VyQW5ub3RhdGlvbi5z
ZXRUeXBlTmFtZShhc3QubmV3U2ltcGxlTmFtZSgiQW5ub3QyIikpOworCQkJcmV3cml0ZS5yZXBs
YWNlKChNYXJrZXJBbm5vdGF0aW9uKSBtZXRob2REZWNsYXJhdGlvbi5tb2RpZmllcnMoKS5nZXQo
MCksIG1hcmtlckFubm90YXRpb24sIG51bGwpOworCQl9CisJCVN0cmluZyBwcmV2aWV3PSBldmFs
dWF0ZVJld3JpdGUoY3UsIHJld3JpdGUpOworCQlidWYgPSBuZXcgU3RyaW5nQnVmZmVyKCk7CisJ
CWJ1Zi5hcHBlbmQoImltcG9ydCBqYXZhLmxhbmcuYW5ub3RhdGlvbi5FbGVtZW50VHlwZTtcbiIp
OworCQlidWYuYXBwZW5kKCJcbiIpOworCQlidWYuYXBwZW5kKCJwdWJsaWMgY2xhc3MgWCB7XG4i
KTsKKwkJYnVmLmFwcGVuZCgiCUBBbm5vdFxuIik7CisJCWJ1Zi5hcHBlbmQoIiAgICBAQW5ub3Qy
IFggKCkge1xuIik7CisJCWJ1Zi5hcHBlbmQoIgl9XG4iKTsKKwkJYnVmLmFwcGVuZCgiCUBBbm5v
dDIgWCAoaW50IHgpIHtcbiIpOworCQlidWYuYXBwZW5kKCIJfVxuIik7CisJCWJ1Zi5hcHBlbmQo
In1cbiIpOworCQlidWYuYXBwZW5kKCJcbiIpOworCQlidWYuYXBwZW5kKCJAamF2YS5sYW5nLmFu
bm90YXRpb24uVGFyZ2V0IChFbGVtZW50VHlwZS5UWVBFX1VTRSlcbiIpOworCQlidWYuYXBwZW5k
KCJAaW50ZXJmYWNlIEFubm90IHt9XG4iKTsKKwkJYnVmLmFwcGVuZCgiXG4iKTsKKwkJYnVmLmFw
cGVuZCgiQGphdmEubGFuZy5hbm5vdGF0aW9uLlRhcmdldCAoRWxlbWVudFR5cGUuVFlQRV9VU0Up
XG4iKTsKKwkJYnVmLmFwcGVuZCgiQGludGVyZmFjZSBBbm5vdDEge31cbiIpOworCQlhc3NlcnRF
cXVhbFN0cmluZyhwcmV2aWV3LCBidWYudG9TdHJpbmcoKSk7CisJfQorCisJcHVibGljIHZvaWQg
dGVzdFJld3JpdGVJbnNlcnRBUElBbm5vdGF0aW9uKCkgdGhyb3dzIEV4Y2VwdGlvbiB7CisJCWlm
ICh0aGlzLmFwaUxldmVsIDwgQVNULkpMUzgpIHJldHVybjsKKwkJSVBhY2thZ2VGcmFnbWVudCBw
YWNrMT0gdGhpcy5zb3VyY2VGb2xkZXIuY3JlYXRlUGFja2FnZUZyYWdtZW50KCJ0ZXN0MSIsIGZh
bHNlLCBudWxsKTsKKwkJU3RyaW5nQnVmZmVyIGJ1Zj0gbmV3IFN0cmluZ0J1ZmZlcigpOworCisJ
CWJ1Zi5hcHBlbmQoImltcG9ydCBqYXZhLmxhbmcuYW5ub3RhdGlvbi5FbGVtZW50VHlwZTtcbiIp
OworCQlidWYuYXBwZW5kKCJcbiIpOworCQlidWYuYXBwZW5kKCJwdWJsaWMgY2xhc3MgWCB7XG4i
KTsKKwkJYnVmLmFwcGVuZCgiCXB1YmxpYyBjbGFzcyBIZWxwZXIgPFQxLCBUMj4ge1xuIik7CisJ
CWJ1Zi5hcHBlbmQoIgl9XG4iKTsKKwkJYnVmLmFwcGVuZCgiCXB1YmxpYyB2b2lkIGZvbygpIHtc
biIpOworCQlidWYuYXBwZW5kKCIJCUhlbHBlcjxAQW5ub3QgQEFubm90MSBTdHJpbmc+IHg7XG4i
KTsKKwkJYnVmLmFwcGVuZCgiCX1cbiIpOworCQlidWYuYXBwZW5kKCJ9XG4iKTsKKwkJYnVmLmFw
cGVuZCgiXG4iKTsKKwkJYnVmLmFwcGVuZCgiQGphdmEubGFuZy5hbm5vdGF0aW9uLlRhcmdldCAo
RWxlbWVudFR5cGUuVFlQRV9VU0UpIFxuIik7CisJCWJ1Zi5hcHBlbmQoIkBpbnRlcmZhY2UgQW5u
b3Qge31cbiIpOworCQlidWYuYXBwZW5kKCJcbiIpOworCQlidWYuYXBwZW5kKCJAamF2YS5sYW5n
LmFubm90YXRpb24uVGFyZ2V0IChFbGVtZW50VHlwZS5UWVBFX1VTRSkgXG4iKTsKKwkJYnVmLmFw
cGVuZCgiQGludGVyZmFjZSBBbm5vdDEge31cbiIpOworCisJCUlDb21waWxhdGlvblVuaXQgY3U9
IHBhY2sxLmNyZWF0ZUNvbXBpbGF0aW9uVW5pdCgiWC5qYXZhIiwgYnVmLnRvU3RyaW5nKCksIGZh
bHNlLCBudWxsKTsKKwkJQ29tcGlsYXRpb25Vbml0IGFzdFJvb3Q9IGNyZWF0ZUFTVChjdSk7CisJ
CUFTVFJld3JpdGUgcmV3cml0ZT0gQVNUUmV3cml0ZS5jcmVhdGUoYXN0Um9vdC5nZXRBU1QoKSk7
CisJCUFTVCBhc3Q9IGFzdFJvb3QuZ2V0QVNUKCk7CisJCVR5cGVEZWNsYXJhdGlvbiB0eXBlPSBm
aW5kVHlwZURlY2xhcmF0aW9uKGFzdFJvb3QsICJYIik7CisJCU1ldGhvZERlY2xhcmF0aW9uIG1l
dGhvZERlY2xhcmF0aW9uPSBmaW5kTWV0aG9kRGVjbGFyYXRpb24odHlwZSwgImZvbyIpOworCQlM
aXN0IHN0YXRlbWVudHM9IG1ldGhvZERlY2xhcmF0aW9uLmdldEJvZHkoKS5zdGF0ZW1lbnRzKCk7
CisJCVZhcmlhYmxlRGVjbGFyYXRpb25TdGF0ZW1lbnQgdmFyaWFibGVEZWNsYXJhdGlvblN0YXRl
bWVudD0gKFZhcmlhYmxlRGVjbGFyYXRpb25TdGF0ZW1lbnQpIHN0YXRlbWVudHMuZ2V0KDApOwor
CQlQYXJhbWV0ZXJpemVkVHlwZSBwYXJhbWV0ZXJpemVkVHlwZT0gKFBhcmFtZXRlcml6ZWRUeXBl
KSB2YXJpYWJsZURlY2xhcmF0aW9uU3RhdGVtZW50LmdldFR5cGUoKTsKKwkJeworCQkJU2ltcGxl
VHlwZSBzaW1wbGVUeXBlPSAoU2ltcGxlVHlwZSkgcGFyYW1ldGVyaXplZFR5cGUudHlwZUFyZ3Vt
ZW50cygpLmdldCgwKTsKKwkJCS8vUGxlYXNlIHJlbW92ZSB0aGUgY29tbWVudCBmcm9tIHRoZSBm
b2xsb3dpbmcgcGllY2Ugb2YgY29kZSB3aGVuIHRoZSBkZWZlY3RzIGZvcgorCQkJLy9lbXB0eSBp
bnNlcnRpb24gYW5kIGluc2VydEZpcnN0IGFyZQorCQkJLy9JbnNlcnRpb24gb24gYSBlbXB0eSAo
TWFya2VyQW5ub3RhdGlvbikgbGlzdAorCQkJLy9NYXJrZXJBbm5vdGF0aW9uIG1hcmtlckFubm90
YXRpb249IGFzdC5uZXdNYXJrZXJBbm5vdGF0aW9uKCk7CisJCQkvL21hcmtlckFubm90YXRpb24u
c2V0VHlwZU5hbWUoYXN0Lm5ld1NpbXBsZU5hbWUoIkFubm90MiIpKTsKKwkJCS8vcmV3cml0ZS5n
ZXRMaXN0UmV3cml0ZShzaW1wbGVUeXBlLCBTaW1wbGVUeXBlLkFOTk9UQVRJT05TX1BST1BFUlRZ
KS5pbnNlcnRMYXN0KG1hcmtlckFubm90YXRpb24sIG51bGwpOworCisJCQlzaW1wbGVUeXBlPSAo
U2ltcGxlVHlwZSkgcGFyYW1ldGVyaXplZFR5cGUudHlwZUFyZ3VtZW50cygpLmdldCgwKTsKKwkJ
CS8vSW5zZXJ0IGZpcnN0CisJCQlNYXJrZXJBbm5vdGF0aW9uIG1hcmtlckFubm90YXRpb249IGFz
dC5uZXdNYXJrZXJBbm5vdGF0aW9uKCk7CisJCQltYXJrZXJBbm5vdGF0aW9uLnNldFR5cGVOYW1l
KGFzdC5uZXdTaW1wbGVOYW1lKCJBbm5vdDIiKSk7CisJCQlyZXdyaXRlLmdldExpc3RSZXdyaXRl
KHNpbXBsZVR5cGUsIFNpbXBsZVR5cGUuQU5OT1RBVElPTlNfUFJPUEVSVFkpLmluc2VydEZpcnN0
KG1hcmtlckFubm90YXRpb24sIG51bGwpOworCisJCQkvL0luc2VydEF0CisJCQltYXJrZXJBbm5v
dGF0aW9uPSBhc3QubmV3TWFya2VyQW5ub3RhdGlvbigpOworCQkJbWFya2VyQW5ub3RhdGlvbi5z
ZXRUeXBlTmFtZShhc3QubmV3U2ltcGxlTmFtZSgiQW5ub3QzIikpOworCQkJcmV3cml0ZS5nZXRM
aXN0UmV3cml0ZShzaW1wbGVUeXBlLCBTaW1wbGVUeXBlLkFOTk9UQVRJT05TX1BST1BFUlRZKS5p
bnNlcnRBdChtYXJrZXJBbm5vdGF0aW9uLCAxLCBudWxsKTsKKworCQkJLy9JbnNlcnQgYWZ0ZXIK
KwkJCW1hcmtlckFubm90YXRpb249IGFzdC5uZXdNYXJrZXJBbm5vdGF0aW9uKCk7CisJCQltYXJr
ZXJBbm5vdGF0aW9uLnNldFR5cGVOYW1lKGFzdC5uZXdTaW1wbGVOYW1lKCJBbm5vdDQiKSk7CisJ
CQlyZXdyaXRlLmdldExpc3RSZXdyaXRlKHNpbXBsZVR5cGUsIFNpbXBsZVR5cGUuQU5OT1RBVElP
TlNfUFJPUEVSVFkpLmluc2VydEFmdGVyKG1hcmtlckFubm90YXRpb24sIChNYXJrZXJBbm5vdGF0
aW9uKSBzaW1wbGVUeXBlLmFubm90YXRpb25zKCkuZ2V0KDEpLCBudWxsKTsKKworCQkJLy9JbnNl
cnQgYmVmb3JlCisJCQltYXJrZXJBbm5vdGF0aW9uPSBhc3QubmV3TWFya2VyQW5ub3RhdGlvbigp
OworCQkJbWFya2VyQW5ub3RhdGlvbi5zZXRUeXBlTmFtZShhc3QubmV3U2ltcGxlTmFtZSgiQW5u
b3Q1IikpOworCQkJcmV3cml0ZS5nZXRMaXN0UmV3cml0ZShzaW1wbGVUeXBlLCBTaW1wbGVUeXBl
LkFOTk9UQVRJT05TX1BST1BFUlRZKS5pbnNlcnRCZWZvcmUobWFya2VyQW5ub3RhdGlvbiwgKE1h
cmtlckFubm90YXRpb24pIHNpbXBsZVR5cGUuYW5ub3RhdGlvbnMoKS5nZXQoMSksIG51bGwpOwor
CQl9CisJCVN0cmluZyBwcmV2aWV3PSBldmFsdWF0ZVJld3JpdGUoY3UsIHJld3JpdGUpOworCQli
dWYgPSBuZXcgU3RyaW5nQnVmZmVyKCk7CisJCWJ1Zi5hcHBlbmQoImltcG9ydCBqYXZhLmxhbmcu
YW5ub3RhdGlvbi5FbGVtZW50VHlwZTtcbiIpOworCQlidWYuYXBwZW5kKCJcbiIpOworCQlidWYu
YXBwZW5kKCJwdWJsaWMgY2xhc3MgWCB7XG4iKTsKKwkJYnVmLmFwcGVuZCgiCXB1YmxpYyBjbGFz
cyBIZWxwZXIgPFQxLCBUMj4ge1xuIik7CisJCWJ1Zi5hcHBlbmQoIgl9XG4iKTsKKwkJYnVmLmFw
cGVuZCgiCXB1YmxpYyB2b2lkIGZvbygpIHtcbiIpOworCQlidWYuYXBwZW5kKCIJCUhlbHBlcjxA
QW5ub3QyIEBBbm5vdDMgQEFubm90IEBBbm5vdDUgQEFubm90MSBAQW5ub3Q0IFN0cmluZz4geDtc
biIpOworCQlidWYuYXBwZW5kKCIJfVxuIik7CisJCWJ1Zi5hcHBlbmQoIn1cbiIpOworCQlidWYu
YXBwZW5kKCJcbiIpOworCQlidWYuYXBwZW5kKCJAamF2YS5sYW5nLmFubm90YXRpb24uVGFyZ2V0
IChFbGVtZW50VHlwZS5UWVBFX1VTRSkgXG4iKTsKKwkJYnVmLmFwcGVuZCgiQGludGVyZmFjZSBB
bm5vdCB7fVxuIik7CisJCWJ1Zi5hcHBlbmQoIlxuIik7CisJCWJ1Zi5hcHBlbmQoIkBqYXZhLmxh
bmcuYW5ub3RhdGlvbi5UYXJnZXQgKEVsZW1lbnRUeXBlLlRZUEVfVVNFKSBcbiIpOworCQlidWYu
YXBwZW5kKCJAaW50ZXJmYWNlIEFubm90MSB7fVxuIik7CisJCWFzc2VydEVxdWFsU3RyaW5nKHBy
ZXZpZXcsIGJ1Zi50b1N0cmluZygpKTsKKwl9CisKKwlwdWJsaWMgdm9pZCB0ZXN0RW1wdHlMaXN0
SW5zZXJ0QW5ub3RhdGlvbigpIHRocm93cyBFeGNlcHRpb24geworCQlpZiAodGhpcy5hcGlMZXZl
bCA8IEFTVC5KTFM4KSByZXR1cm47CisJCUlQYWNrYWdlRnJhZ21lbnQgcGFjazE9IHRoaXMuc291
cmNlRm9sZGVyLmNyZWF0ZVBhY2thZ2VGcmFnbWVudCgidGVzdDEiLCBmYWxzZSwgbnVsbCk7CisJ
CVN0cmluZ0J1ZmZlciBidWY9IG5ldyBTdHJpbmdCdWZmZXIoKTsKKwkJYnVmLmFwcGVuZCgicGFj
a2FnZSB0ZXN0MTtcbiIpOworCQlidWYuYXBwZW5kKCJwdWJsaWMgY2xhc3MgWCB7XG4iKTsKKwkJ
YnVmLmFwcGVuZCgiCVN0cmluZyBteU9iamVjdCA9IFwiRm9vXCI7XG4iKTsKKwkJYnVmLmFwcGVu
ZCgiCXB1YmxpYyB2b2lkIGZvbygpIHtcbiIpOworCQlidWYuYXBwZW5kKCIJCVN0cmluZyBteVN0
cmluZyA9IChTdHJpbmcpIG15T2JqZWN0O1xuIik7CisJCWJ1Zi5hcHBlbmQoIgl9XG4iKTsKKwkJ
YnVmLmFwcGVuZCgifVxuIik7CisKKwkJSUNvbXBpbGF0aW9uVW5pdCBjdT0gcGFjazEuY3JlYXRl
Q29tcGlsYXRpb25Vbml0KCJYLmphdmEiLCBidWYudG9TdHJpbmcoKSwgZmFsc2UsIG51bGwpOwor
CQlDb21waWxhdGlvblVuaXQgYXN0Um9vdD0gY3JlYXRlQVNUKGN1KTsKKwkJQVNUUmV3cml0ZSBy
ZXdyaXRlPSBBU1RSZXdyaXRlLmNyZWF0ZShhc3RSb290LmdldEFTVCgpKTsKKwkJQVNUIGFzdD0g
YXN0Um9vdC5nZXRBU1QoKTsKKwkJVHlwZURlY2xhcmF0aW9uIHR5cGU9IGZpbmRUeXBlRGVjbGFy
YXRpb24oYXN0Um9vdCwgIlgiKTsKKwkJTWV0aG9kRGVjbGFyYXRpb24gbWV0aG9kRGVjbGFyYXRp
b249IGZpbmRNZXRob2REZWNsYXJhdGlvbih0eXBlLCAiZm9vIik7CisJCUxpc3Qgc3RhdGVtZW50
cz0gbWV0aG9kRGVjbGFyYXRpb24uZ2V0Qm9keSgpLnN0YXRlbWVudHMoKTsKKwkJey8vQWRkIGFu
IHVzZSBvZiBhbm5vdGF0aW9uLgorCQkJVmFyaWFibGVEZWNsYXJhdGlvblN0YXRlbWVudCAgdmFy
aWFibGVEZWNsYXJhdGlvblN0YXRlbWVudD0gKFZhcmlhYmxlRGVjbGFyYXRpb25TdGF0ZW1lbnQp
IHN0YXRlbWVudHMuZ2V0KDApOworCQkJVmFyaWFibGVEZWNsYXJhdGlvbkZyYWdtZW50IHZhcmlh
YmxlRGVjbGFyYXRpb25GcmFnbWVudD0gKFZhcmlhYmxlRGVjbGFyYXRpb25GcmFnbWVudCkgdmFy
aWFibGVEZWNsYXJhdGlvblN0YXRlbWVudC5mcmFnbWVudHMoKS5nZXQoMCk7CisJCQlDYXN0RXhw
cmVzc2lvbiBjYXN0RXhwcmVzc2lvbj0gKENhc3RFeHByZXNzaW9uKSB2YXJpYWJsZURlY2xhcmF0
aW9uRnJhZ21lbnQuZ2V0SW5pdGlhbGl6ZXIoKTsKKwkJCVNpbXBsZVR5cGUgc2ltcGxlVHlwZT0g
KFNpbXBsZVR5cGUpIGNhc3RFeHByZXNzaW9uLmdldFR5cGUoKTsKKwkJCU1hcmtlckFubm90YXRp
b24gbWFya2VyQW5ub3RhdGlvbj0gYXN0Lm5ld01hcmtlckFubm90YXRpb24oKTsKKwkJCW1hcmtl
ckFubm90YXRpb24uc2V0VHlwZU5hbWUoYXN0Lm5ld1NpbXBsZU5hbWUoIkFubm90IikpOworCQkJ
cmV3cml0ZS5nZXRMaXN0UmV3cml0ZShzaW1wbGVUeXBlLCBTaW1wbGVUeXBlLkFOTk9UQVRJT05T
X1BST1BFUlRZKS5pbnNlcnRMYXN0KG1hcmtlckFubm90YXRpb24sIG51bGwpOworCQl9CisJCVN0
cmluZyBwcmV2aWV3PSBldmFsdWF0ZVJld3JpdGUoY3UsIHJld3JpdGUpOworCQlidWY9IG5ldyBT
dHJpbmdCdWZmZXIoKTsKKwkJYnVmLmFwcGVuZCgicGFja2FnZSB0ZXN0MTtcbiIpOworCQlidWYu
YXBwZW5kKCJwdWJsaWMgY2xhc3MgWCB7XG4iKTsKKwkJYnVmLmFwcGVuZCgiCVN0cmluZyBteU9i
amVjdCA9IFwiRm9vXCI7XG4iKTsKKwkJYnVmLmFwcGVuZCgiCXB1YmxpYyB2b2lkIGZvbygpIHtc
biIpOworCQlidWYuYXBwZW5kKCIJCVN0cmluZyBteVN0cmluZyA9IChAQW5ub3QgU3RyaW5nKSBt
eU9iamVjdDtcbiIpOy8vQWN0dWFsOiBTdHJpbmcgbXlTdHJpbmcgPSAoIEBBbm5vdFN0cmluZykg
bXlPYmplY3Q7CisJCWJ1Zi5hcHBlbmQoIgl9XG4iKTsKKwkJYnVmLmFwcGVuZCgifVxuIik7CisJ
CWFzc2VydEVxdWFsU3RyaW5nKHByZXZpZXcsIGJ1Zi50b1N0cmluZygpKTsKKwl9CiB9Cg==
</data>

          </attachment>
          <attachment
              isobsolete="1"
              ispatch="1"
              isprivate="0"
          >
            <attachid>229226</attachid>
            <date>2013-04-02 05:11:00 -0400</date>
            <delta_ts>2013-04-04 05:43:35 -0400</delta_ts>
            <desc>Test cases for AST rewrite for type annotations</desc>
            <filename>patch.txt</filename>
            <type>text/plain</type>
            <size>42435</size>
            <attacher name="shankha banerjee">shankhba</attacher>
            
              <data encoding="base64">ZGlmZiAtLWdpdCBhL29yZy5lY2xpcHNlLmpkdC5jb3JlLnRlc3RzLm1vZGVsL3NyYy9vcmcvZWNs
aXBzZS9qZHQvY29yZS90ZXN0cy9yZXdyaXRlL2Rlc2NyaWJpbmcvQVNUUmV3cml0aW5nVHlwZUFu
bm90YXRpb25zVGVzdC5qYXZhIGIvb3JnLmVjbGlwc2UuamR0LmNvcmUudGVzdHMubW9kZWwvc3Jj
L29yZy9lY2xpcHNlL2pkdC9jb3JlL3Rlc3RzL3Jld3JpdGUvZGVzY3JpYmluZy9BU1RSZXdyaXRp
bmdUeXBlQW5ub3RhdGlvbnNUZXN0LmphdmEKbmV3IGZpbGUgbW9kZSAxMDA2NDQKaW5kZXggMDAw
MDAwMC4uOTE1NTI2OAotLS0gL2Rldi9udWxsCisrKyBiL29yZy5lY2xpcHNlLmpkdC5jb3JlLnRl
c3RzLm1vZGVsL3NyYy9vcmcvZWNsaXBzZS9qZHQvY29yZS90ZXN0cy9yZXdyaXRlL2Rlc2NyaWJp
bmcvQVNUUmV3cml0aW5nVHlwZUFubm90YXRpb25zVGVzdC5qYXZhCkBAIC0wLDAgKzEsODYzIEBA
CisvKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioq
KioqKioqKioqKioqKioqKioqKioqKioqKgorICogQ29weXJpZ2h0IChjKSAyMDEzIElCTSBDb3Jw
b3JhdGlvbiBhbmQgb3RoZXJzLgorICogQWxsIHJpZ2h0cyByZXNlcnZlZC4gVGhpcyBwcm9ncmFt
IGFuZCB0aGUgYWNjb21wYW55aW5nIG1hdGVyaWFscworICogYXJlIG1hZGUgYXZhaWxhYmxlIHVu
ZGVyIHRoZSB0ZXJtcyBvZiB0aGUgRWNsaXBzZSBQdWJsaWMgTGljZW5zZSB2MS4wCisgKiB3aGlj
aCBhY2NvbXBhbmllcyB0aGlzIGRpc3RyaWJ1dGlvbiwgYW5kIGlzIGF2YWlsYWJsZSBhdAorICog
aHR0cDovL3d3dy5lY2xpcHNlLm9yZy9sZWdhbC9lcGwtdjEwLmh0bWwKKyAqCisgKiBUaGlzIGlz
IGFuIGltcGxlbWVudGF0aW9uIG9mIGFuIGVhcmx5LWRyYWZ0IHNwZWNpZmljYXRpb24gZGV2ZWxv
cGVkIHVuZGVyIHRoZSBKYXZhCisgKiBDb21tdW5pdHkgUHJvY2VzcyAoSkNQKSBhbmQgaXMgbWFk
ZSBhdmFpbGFibGUgZm9yIHRlc3RpbmcgYW5kIGV2YWx1YXRpb24gcHVycG9zZXMKKyAqIG9ubHku
IFRoZSBjb2RlIGlzIG5vdCBjb21wYXRpYmxlIHdpdGggYW55IHNwZWNpZmljYXRpb24gb2YgdGhl
IEpDUC4KKyAqCisgKiBDb250cmlidXRvcnM6CisgKiAgICAgSUJNIENvcnBvcmF0aW9uIC0gaW5p
dGlhbCBBUEkgYW5kIGltcGxlbWVudGF0aW9uCisgKioqKioqKioqKioqKioqKioqKioqKioqKioq
KioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKi8KK3Bh
Y2thZ2Ugb3JnLmVjbGlwc2UuamR0LmNvcmUudGVzdHMucmV3cml0ZS5kZXNjcmliaW5nOworaW1w
b3J0IGphdmEudXRpbC5MaXN0OworCitpbXBvcnQganVuaXQuZnJhbWV3b3JrLlRlc3Q7CisKK2lt
cG9ydCBvcmcuZWNsaXBzZS5qZHQuY29yZS5JQ29tcGlsYXRpb25Vbml0OworaW1wb3J0IG9yZy5l
Y2xpcHNlLmpkdC5jb3JlLklQYWNrYWdlRnJhZ21lbnQ7CitpbXBvcnQgb3JnLmVjbGlwc2UuamR0
LmNvcmUuZG9tLio7CitpbXBvcnQgb3JnLmVjbGlwc2UuamR0LmNvcmUuZG9tLnJld3JpdGUuQVNU
UmV3cml0ZTsKKworcHVibGljIGNsYXNzIEFTVFJld3JpdGluZ1R5cGVBbm5vdGF0aW9uc1Rlc3Qg
ZXh0ZW5kcyBBU1RSZXdyaXRpbmdUZXN0IHsKKworCXB1YmxpYyBBU1RSZXdyaXRpbmdUeXBlQW5u
b3RhdGlvbnNUZXN0KFN0cmluZyBuYW1lKSB7CisJCXN1cGVyKG5hbWUpOworCX0KKwlwdWJsaWMg
QVNUUmV3cml0aW5nVHlwZUFubm90YXRpb25zVGVzdChTdHJpbmcgbmFtZSwgaW50IGFwaUxldmVs
KSB7CisJCXN1cGVyKG5hbWUsIGFwaUxldmVsKTsKKwl9CisKKwlwdWJsaWMgc3RhdGljIFRlc3Qg
c3VpdGUoKSB7CisJCXJldHVybiBjcmVhdGVTdWl0ZShBU1RSZXdyaXRpbmdUeXBlQW5ub3RhdGlv
bnNUZXN0LmNsYXNzKTsKKwl9CisKKwlwdWJsaWMgdm9pZCB0ZXN0Q2FzdEFubm90YXRpb25zKCkg
dGhyb3dzIEV4Y2VwdGlvbiB7CisJCWlmICh0aGlzLmFwaUxldmVsIDwgQVNULkpMUzgpIHJldHVy
bjsKKwkJSVBhY2thZ2VGcmFnbWVudCBwYWNrMT0gdGhpcy5zb3VyY2VGb2xkZXIuY3JlYXRlUGFj
a2FnZUZyYWdtZW50KCJ0ZXN0MSIsIGZhbHNlLCBudWxsKTsKKwkJU3RyaW5nQnVmZmVyIGJ1Zj0g
bmV3IFN0cmluZ0J1ZmZlcigpOworCQlidWYuYXBwZW5kKCJwYWNrYWdlIHRlc3QxO1xuIik7CisJ
CWJ1Zi5hcHBlbmQoImltcG9ydCBqYXZhLmxhbmcuYW5ub3RhdGlvbi5FbGVtZW50VHlwZTtcbiIp
OworCQlidWYuYXBwZW5kKCJwdWJsaWMgY2xhc3MgWCB7XG4iKTsKKwkJYnVmLmFwcGVuZCgiCVN0
cmluZyBteU9iamVjdCA9IFwiRm9vXCI7XG4iKTsKKwkJYnVmLmFwcGVuZCgiCXB1YmxpYyB2b2lk
IGZvbygpIHtcbiIpOworCQlidWYuYXBwZW5kKCIJCVN0cmluZyBteVN0cmluZyA9IChAQW5ub3Qg
U3RyaW5nKSBteU9iamVjdDtcbiIpOworCQlidWYuYXBwZW5kKCIJCVN0cmluZyBteVN0cmluZzEg
PSAoQEFubm90MSBAQW5ub3QgU3RyaW5nKSBteU9iamVjdDtcbiIpOworCQlidWYuYXBwZW5kKCIJ
fVxuIik7CisJCWJ1Zi5hcHBlbmQoIn1cbiIpOworCQlidWYuYXBwZW5kKCJAamF2YS5sYW5nLmFu
bm90YXRpb24uVGFyZ2V0KHZhbHVlID0ge0VsZW1lbnRUeXBlLlRZUEVfVVNFfSlcbiIpOworCQli
dWYuYXBwZW5kKCJAaW50ZXJmYWNlIEFubm90IHt9XG4iKTsKKwkJYnVmLmFwcGVuZCgiQGphdmEu
bGFuZy5hbm5vdGF0aW9uLlRhcmdldCh2YWx1ZSA9IHtFbGVtZW50VHlwZS5UWVBFX1VTRX0pXG4i
KTsKKwkJYnVmLmFwcGVuZCgiQGludGVyZmFjZSBBbm5vdDEge31cbiIpOworCisJCUlDb21waWxh
dGlvblVuaXQgY3U9IHBhY2sxLmNyZWF0ZUNvbXBpbGF0aW9uVW5pdCgiWC5qYXZhIiwgYnVmLnRv
U3RyaW5nKCksIGZhbHNlLCBudWxsKTsKKwkJQ29tcGlsYXRpb25Vbml0IGFzdFJvb3Q9IGNyZWF0
ZUFTVChjdSk7CisJCUFTVFJld3JpdGUgcmV3cml0ZT0gQVNUUmV3cml0ZS5jcmVhdGUoYXN0Um9v
dC5nZXRBU1QoKSk7CisJCUFTVCBhc3Q9IGFzdFJvb3QuZ2V0QVNUKCk7CisJCVR5cGVEZWNsYXJh
dGlvbiB0eXBlPSBmaW5kVHlwZURlY2xhcmF0aW9uKGFzdFJvb3QsICJYIik7CisJCU1ldGhvZERl
Y2xhcmF0aW9uIG1ldGhvZERlY2xhcmF0aW9uPSBmaW5kTWV0aG9kRGVjbGFyYXRpb24odHlwZSwg
ImZvbyIpOworCQlMaXN0IHN0YXRlbWVudHM9IG1ldGhvZERlY2xhcmF0aW9uLmdldEJvZHkoKS5z
dGF0ZW1lbnRzKCk7CisJCXsvL0FkZCBhbiB1c2Ugb2YgYW5ub3RhdGlvbi4KKwkJCVZhcmlhYmxl
RGVjbGFyYXRpb25TdGF0ZW1lbnQgIHZhcmlhYmxlRGVjbGFyYXRpb25TdGF0ZW1lbnQ9IChWYXJp
YWJsZURlY2xhcmF0aW9uU3RhdGVtZW50KSBzdGF0ZW1lbnRzLmdldCgwKTsKKwkJCVZhcmlhYmxl
RGVjbGFyYXRpb25GcmFnbWVudCB2YXJpYWJsZURlY2xhcmF0aW9uRnJhZ21lbnQ9IChWYXJpYWJs
ZURlY2xhcmF0aW9uRnJhZ21lbnQpIHZhcmlhYmxlRGVjbGFyYXRpb25TdGF0ZW1lbnQuZnJhZ21l
bnRzKCkuZ2V0KDApOworCQkJQ2FzdEV4cHJlc3Npb24gY2FzdEV4cHJlc3Npb249IChDYXN0RXhw
cmVzc2lvbikgdmFyaWFibGVEZWNsYXJhdGlvbkZyYWdtZW50LmdldEluaXRpYWxpemVyKCk7CisJ
CQlTaW1wbGVUeXBlIHNpbXBsZVR5cGU9IChTaW1wbGVUeXBlKSBjYXN0RXhwcmVzc2lvbi5nZXRU
eXBlKCk7CisJCQlNYXJrZXJBbm5vdGF0aW9uIG1hcmtlckFubm90YXRpb249IGFzdC5uZXdNYXJr
ZXJBbm5vdGF0aW9uKCk7CisJCQltYXJrZXJBbm5vdGF0aW9uLnNldFR5cGVOYW1lKGFzdC5uZXdT
aW1wbGVOYW1lKCJBbm5vdDIiKSk7CisJCQlyZXdyaXRlLmdldExpc3RSZXdyaXRlKHNpbXBsZVR5
cGUsIFNpbXBsZVR5cGUuQU5OT1RBVElPTlNfUFJPUEVSVFkpLmluc2VydExhc3QobWFya2VyQW5u
b3RhdGlvbiwgbnVsbCk7CisJCX0KKwkJeworCQkJVmFyaWFibGVEZWNsYXJhdGlvblN0YXRlbWVu
dCAgdmFyaWFibGVEZWNsYXJhdGlvblN0YXRlbWVudD0gKFZhcmlhYmxlRGVjbGFyYXRpb25TdGF0
ZW1lbnQpIHN0YXRlbWVudHMuZ2V0KDEpOworCQkJVmFyaWFibGVEZWNsYXJhdGlvbkZyYWdtZW50
IHZhcmlhYmxlRGVjbGFyYXRpb25GcmFnbWVudD0gKFZhcmlhYmxlRGVjbGFyYXRpb25GcmFnbWVu
dCkgdmFyaWFibGVEZWNsYXJhdGlvblN0YXRlbWVudC5mcmFnbWVudHMoKS5nZXQoMCk7CisJCQlD
YXN0RXhwcmVzc2lvbiBjYXN0RXhwcmVzc2lvbj0gKENhc3RFeHByZXNzaW9uKSB2YXJpYWJsZURl
Y2xhcmF0aW9uRnJhZ21lbnQuZ2V0SW5pdGlhbGl6ZXIoKTsKKwkJCVNpbXBsZVR5cGUgc2ltcGxl
VHlwZT0gKFNpbXBsZVR5cGUpIGNhc3RFeHByZXNzaW9uLmdldFR5cGUoKTsKKwkJCUxpc3QgYW5u
b3RhdGlvbnMgPSBzaW1wbGVUeXBlLmFubm90YXRpb25zKCk7CisJCQkvL1JlbW92ZSB0aGUgdXNl
IG9mIGFuIEFubm90YXRpb24KKwkJCXJld3JpdGUucmVtb3ZlKChBU1ROb2RlKWFubm90YXRpb25z
LmdldCgxKSwgbnVsbCk7CisJCQkvL1JlcGxhY2UgdGhlIHVzZSBvZiBhbiBBbm5vdGF0aW9uCisJ
CQlNYXJrZXJBbm5vdGF0aW9uIG1hcmtlckFubm90YXRpb249IGFzdC5uZXdNYXJrZXJBbm5vdGF0
aW9uKCk7CisJCQltYXJrZXJBbm5vdGF0aW9uLnNldFR5cGVOYW1lKGFzdC5uZXdTaW1wbGVOYW1l
KCJBbm5vdDIiKSk7CisJCQlyZXdyaXRlLnJlcGxhY2UoKEFTVE5vZGUpYW5ub3RhdGlvbnMuZ2V0
KDApLCBtYXJrZXJBbm5vdGF0aW9uLCBudWxsKTsKKwkJfQorCQlTdHJpbmcgcHJldmlldz0gZXZh
bHVhdGVSZXdyaXRlKGN1LCByZXdyaXRlKTsKKwkJYnVmPSBuZXcgU3RyaW5nQnVmZmVyKCk7CisJ
CWJ1Zi5hcHBlbmQoInBhY2thZ2UgdGVzdDE7XG4iKTsKKwkJYnVmLmFwcGVuZCgiaW1wb3J0IGph
dmEubGFuZy5hbm5vdGF0aW9uLkVsZW1lbnRUeXBlO1xuIik7CisJCWJ1Zi5hcHBlbmQoInB1Ymxp
YyBjbGFzcyBYIHtcbiIpOworCQlidWYuYXBwZW5kKCIJU3RyaW5nIG15T2JqZWN0ID0gXCJGb29c
IjtcbiIpOworCQlidWYuYXBwZW5kKCIJcHVibGljIHZvaWQgZm9vKCkge1xuIik7CisJCWJ1Zi5h
cHBlbmQoIgkJU3RyaW5nIG15U3RyaW5nID0gKEBBbm5vdCBAQW5ub3QyIFN0cmluZykgbXlPYmpl
Y3Q7XG4iKTsKKwkJYnVmLmFwcGVuZCgiCQlTdHJpbmcgbXlTdHJpbmcxID0gKEBBbm5vdDIgU3Ry
aW5nKSBteU9iamVjdDtcbiIpOworCQlidWYuYXBwZW5kKCIJfVxuIik7CisJCWJ1Zi5hcHBlbmQo
In1cbiIpOworCQlidWYuYXBwZW5kKCJAamF2YS5sYW5nLmFubm90YXRpb24uVGFyZ2V0KHZhbHVl
ID0ge0VsZW1lbnRUeXBlLlRZUEVfVVNFfSlcbiIpOworCQlidWYuYXBwZW5kKCJAaW50ZXJmYWNl
IEFubm90IHt9XG4iKTsKKwkJYnVmLmFwcGVuZCgiQGphdmEubGFuZy5hbm5vdGF0aW9uLlRhcmdl
dCh2YWx1ZSA9IHtFbGVtZW50VHlwZS5UWVBFX1VTRX0pXG4iKTsKKwkJYnVmLmFwcGVuZCgiQGlu
dGVyZmFjZSBBbm5vdDEge31cbiIpOworCQlhc3NlcnRFcXVhbFN0cmluZyhwcmV2aWV3LCBidWYu
dG9TdHJpbmcoKSk7CisJfQorCisJcHVibGljIHZvaWQgdGVzdFdpbGRjYXJkVHlwZUFyZ3VtZW50
QW5ub3RhdGlvbnMoKSB0aHJvd3MgRXhjZXB0aW9uIHsKKwkJaWYgKHRoaXMuYXBpTGV2ZWwgPCBB
U1QuSkxTOCkgcmV0dXJuOworCQlJUGFja2FnZUZyYWdtZW50IHBhY2sxPSB0aGlzLnNvdXJjZUZv
bGRlci5jcmVhdGVQYWNrYWdlRnJhZ21lbnQoInRlc3QxIiwgZmFsc2UsIG51bGwpOworCQlTdHJp
bmdCdWZmZXIgYnVmPSBuZXcgU3RyaW5nQnVmZmVyKCk7CisJCWJ1Zi5hcHBlbmQoInBhY2thZ2Ug
dGVzdDE7XG4iKTsKKwkJYnVmLmFwcGVuZCgiaW1wb3J0IGphdmEubGFuZy5hbm5vdGF0aW9uLkVs
ZW1lbnRUeXBlO1xuIik7CisJCWJ1Zi5hcHBlbmQoInB1YmxpYyBjbGFzcyBYIHtcbiIpOworCQli
dWYuYXBwZW5kKCIJcHVibGljIGNsYXNzIEhlbHBlcjxUPiB7XG4iKTsKKwkJYnVmLmFwcGVuZCgi
CX1cbiIpOworCQlidWYuYXBwZW5kKCIJcHVibGljIGNsYXNzIEJhc2Uge1xuIik7CisJCWJ1Zi5h
cHBlbmQoIgl9XG4iKTsKKwkJYnVmLmFwcGVuZCgiCXB1YmxpYyBzdGF0aWMgdm9pZCBVbmJvdW5k
ZWRXaWxkY2FyZDEgKEhlbHBlcjxAQW5ub3QgPz4geCkge1xuIik7CisJCWJ1Zi5hcHBlbmQoIgl9
XG4iKTsKKwkJYnVmLmFwcGVuZCgiCXB1YmxpYyBzdGF0aWMgdm9pZCBVbmJvdW5kZWRXaWxkY2Fy
ZDIgKEhlbHBlcjxAQW5ub3QxIEBBbm5vdCA/PiB4KSB7XG4iKTsKKwkJYnVmLmFwcGVuZCgiCX1c
biIpOworCQlidWYuYXBwZW5kKCIJcHVibGljIHN0YXRpYyB2b2lkIEJvdW5kZWRXaWxkY2FyZDEg
KEhlbHBlcjxAQW5ub3QgPyBleHRlbmRzIEJhc2U+IHgpIHtcbiIpOworCQlidWYuYXBwZW5kKCIJ
fVxuIik7CisJCWJ1Zi5hcHBlbmQoIglwdWJsaWMgc3RhdGljIHZvaWQgQm91bmRlZFdpbGRjYXJk
MiAoSGVscGVyPEBBbm5vdDEgQEFubm90ID8gZXh0ZW5kcyBCYXNlPiB4KSB7XG4iKTsKKwkJYnVm
LmFwcGVuZCgiCX1cbiIpOworCQlidWYuYXBwZW5kKCJ9XG4iKTsKKwkJYnVmLmFwcGVuZCgiQGph
dmEubGFuZy5hbm5vdGF0aW9uLlRhcmdldCAoRWxlbWVudFR5cGUuVFlQRV9VU0UpXG4iKTsKKwkJ
YnVmLmFwcGVuZCgiQGludGVyZmFjZSBBbm5vdCB7fVxuIik7CisJCWJ1Zi5hcHBlbmQoIkBqYXZh
LmxhbmcuYW5ub3RhdGlvbi5UYXJnZXQgKEVsZW1lbnRUeXBlLlRZUEVfVVNFKVxuIik7CisJCWJ1
Zi5hcHBlbmQoIkBpbnRlcmZhY2UgQW5ub3QxIHt9XG4iKTsKKworCQlJQ29tcGlsYXRpb25Vbml0
IGN1PSBwYWNrMS5jcmVhdGVDb21waWxhdGlvblVuaXQoIlguamF2YSIsIGJ1Zi50b1N0cmluZygp
LCBmYWxzZSwgbnVsbCk7CisJCUNvbXBpbGF0aW9uVW5pdCBhc3RSb290PSBjcmVhdGVBU1QoY3Up
OworCQlBU1RSZXdyaXRlIHJld3JpdGU9IEFTVFJld3JpdGUuY3JlYXRlKGFzdFJvb3QuZ2V0QVNU
KCkpOworCQlBU1QgYXN0PSBhc3RSb290LmdldEFTVCgpOworCQlUeXBlRGVjbGFyYXRpb24gdHlw
ZT0gZmluZFR5cGVEZWNsYXJhdGlvbihhc3RSb290LCAiWCIpOworCQl7Ly9BZGQgYW4gdXNlIG9m
IGFuIGFubm90YXRpb24uCisJCQlNZXRob2REZWNsYXJhdGlvbiBtZXRob2REZWNsYXJhdGlvbj0g
ZmluZE1ldGhvZERlY2xhcmF0aW9uKHR5cGUsICJVbmJvdW5kZWRXaWxkY2FyZDEiKTsKKwkJCUxp
c3QgcGFyYW1ldGVycz0gbWV0aG9kRGVjbGFyYXRpb24ucGFyYW1ldGVycygpOworCQkJU2luZ2xl
VmFyaWFibGVEZWNsYXJhdGlvbiBzaW5nbGVWYXJpYWJsZURlY2xhcmF0aW9uPSAoU2luZ2xlVmFy
aWFibGVEZWNsYXJhdGlvbikgcGFyYW1ldGVycy5nZXQoMCk7CisJCQlQYXJhbWV0ZXJpemVkVHlw
ZSBwYXJhbWV0ZXJpemVkVHlwZT0gKFBhcmFtZXRlcml6ZWRUeXBlKSBzaW5nbGVWYXJpYWJsZURl
Y2xhcmF0aW9uLmdldFR5cGUoKTsKKwkJCVdpbGRjYXJkVHlwZSB3aWxkY2FyZFR5cGU9IChXaWxk
Y2FyZFR5cGUpIHBhcmFtZXRlcml6ZWRUeXBlLnR5cGVBcmd1bWVudHMoKS5nZXQoMCk7CisJCQlN
YXJrZXJBbm5vdGF0aW9uIG1hcmtlckFubm90YXRpb249IGFzdC5uZXdNYXJrZXJBbm5vdGF0aW9u
KCk7CisJCQltYXJrZXJBbm5vdGF0aW9uLnNldFR5cGVOYW1lKGFzdC5uZXdTaW1wbGVOYW1lKCJB
bm5vdDIiKSk7CisJCQlyZXdyaXRlLmdldExpc3RSZXdyaXRlKHdpbGRjYXJkVHlwZSwgV2lsZGNh
cmRUeXBlLkFOTk9UQVRJT05TX1BST1BFUlRZKS5pbnNlcnRMYXN0KG1hcmtlckFubm90YXRpb24s
IG51bGwpOworCisJCQltZXRob2REZWNsYXJhdGlvbj0gZmluZE1ldGhvZERlY2xhcmF0aW9uKHR5
cGUsICJCb3VuZGVkV2lsZGNhcmQxIik7CisJCQlwYXJhbWV0ZXJzPSBtZXRob2REZWNsYXJhdGlv
bi5wYXJhbWV0ZXJzKCk7CisJCQlzaW5nbGVWYXJpYWJsZURlY2xhcmF0aW9uPSAoU2luZ2xlVmFy
aWFibGVEZWNsYXJhdGlvbikgcGFyYW1ldGVycy5nZXQoMCk7CisJCQlwYXJhbWV0ZXJpemVkVHlw
ZT0gKFBhcmFtZXRlcml6ZWRUeXBlKSBzaW5nbGVWYXJpYWJsZURlY2xhcmF0aW9uLmdldFR5cGUo
KTsKKwkJCXdpbGRjYXJkVHlwZT0gKFdpbGRjYXJkVHlwZSkgcGFyYW1ldGVyaXplZFR5cGUudHlw
ZUFyZ3VtZW50cygpLmdldCgwKTsKKwkJCW1hcmtlckFubm90YXRpb249IGFzdC5uZXdNYXJrZXJB
bm5vdGF0aW9uKCk7CisJCQltYXJrZXJBbm5vdGF0aW9uLnNldFR5cGVOYW1lKGFzdC5uZXdTaW1w
bGVOYW1lKCJBbm5vdDIiKSk7CisJCQlyZXdyaXRlLmdldExpc3RSZXdyaXRlKHdpbGRjYXJkVHlw
ZSwgV2lsZGNhcmRUeXBlLkFOTk9UQVRJT05TX1BST1BFUlRZKS5pbnNlcnRMYXN0KG1hcmtlckFu
bm90YXRpb24sIG51bGwpOworCQl9CisJCXsKKwkJCU1ldGhvZERlY2xhcmF0aW9uIG1ldGhvZERl
Y2xhcmF0aW9uPSBmaW5kTWV0aG9kRGVjbGFyYXRpb24odHlwZSwgIlVuYm91bmRlZFdpbGRjYXJk
MiIpOworCQkJTGlzdCBwYXJhbWV0ZXJzPSBtZXRob2REZWNsYXJhdGlvbi5wYXJhbWV0ZXJzKCk7
CisJCQlTaW5nbGVWYXJpYWJsZURlY2xhcmF0aW9uIHNpbmdsZVZhcmlhYmxlRGVjbGFyYXRpb249
IChTaW5nbGVWYXJpYWJsZURlY2xhcmF0aW9uKSBwYXJhbWV0ZXJzLmdldCgwKTsKKwkJCVBhcmFt
ZXRlcml6ZWRUeXBlIHBhcmFtZXRlcml6ZWRUeXBlPSAoUGFyYW1ldGVyaXplZFR5cGUpIHNpbmds
ZVZhcmlhYmxlRGVjbGFyYXRpb24uZ2V0VHlwZSgpOworCQkJV2lsZGNhcmRUeXBlIHdpbGRjYXJk
VHlwZT0gKFdpbGRjYXJkVHlwZSkgcGFyYW1ldGVyaXplZFR5cGUudHlwZUFyZ3VtZW50cygpLmdl
dCgwKTsKKworCQkJbWV0aG9kRGVjbGFyYXRpb249IGZpbmRNZXRob2REZWNsYXJhdGlvbih0eXBl
LCAiQm91bmRlZFdpbGRjYXJkMiIpOworCQkJcGFyYW1ldGVycz0gbWV0aG9kRGVjbGFyYXRpb24u
cGFyYW1ldGVycygpOworCQkJc2luZ2xlVmFyaWFibGVEZWNsYXJhdGlvbj0gKFNpbmdsZVZhcmlh
YmxlRGVjbGFyYXRpb24pIHBhcmFtZXRlcnMuZ2V0KDApOworCQkJcGFyYW1ldGVyaXplZFR5cGU9
IChQYXJhbWV0ZXJpemVkVHlwZSkgc2luZ2xlVmFyaWFibGVEZWNsYXJhdGlvbi5nZXRUeXBlKCk7
CisJCQlXaWxkY2FyZFR5cGUgd2lsZGNhcmRUeXBlMj0gKFdpbGRjYXJkVHlwZSkgcGFyYW1ldGVy
aXplZFR5cGUudHlwZUFyZ3VtZW50cygpLmdldCgwKTsKKworCQkJLy9SZW1vdmUgdGhlIHVzZSBv
ZiBhbiBhbm5vdGF0aW9uCisJCQlyZXdyaXRlLnJlbW92ZSgoTWFya2VyQW5ub3RhdGlvbikgd2ls
ZGNhcmRUeXBlLmFubm90YXRpb25zKCkuZ2V0KDEpLCBudWxsKTsKKwkJCXJld3JpdGUucmVtb3Zl
KChNYXJrZXJBbm5vdGF0aW9uKSB3aWxkY2FyZFR5cGUyLmFubm90YXRpb25zKCkuZ2V0KDEpLCBu
dWxsKTsKKworCQkJTWFya2VyQW5ub3RhdGlvbiBtYXJrZXJBbm5vdGF0aW9uPSBhc3QubmV3TWFy
a2VyQW5ub3RhdGlvbigpOworCQkJbWFya2VyQW5ub3RhdGlvbi5zZXRUeXBlTmFtZShhc3QubmV3
U2ltcGxlTmFtZSgiQW5ub3QyIikpOworCQkJTWFya2VyQW5ub3RhdGlvbiBtYXJrZXJBbm5vdGF0
aW9uMj0gYXN0Lm5ld01hcmtlckFubm90YXRpb24oKTsKKwkJCW1hcmtlckFubm90YXRpb24yLnNl
dFR5cGVOYW1lKGFzdC5uZXdTaW1wbGVOYW1lKCJBbm5vdDIiKSk7CisKKwkJCS8vUmVwbGFjZSB0
aGUgdXNlIG9mIGFuIGFubm90YXRpb24KKwkJCXJld3JpdGUucmVwbGFjZSgoTWFya2VyQW5ub3Rh
dGlvbikgd2lsZGNhcmRUeXBlLmFubm90YXRpb25zKCkuZ2V0KDApLCBtYXJrZXJBbm5vdGF0aW9u
LCBudWxsKTsKKwkJCXJld3JpdGUucmVwbGFjZSgoTWFya2VyQW5ub3RhdGlvbikgd2lsZGNhcmRU
eXBlMi5hbm5vdGF0aW9ucygpLmdldCgwKSwgbWFya2VyQW5ub3RhdGlvbjIsIG51bGwpOworCQl9
CisJCVN0cmluZyBwcmV2aWV3PSBldmFsdWF0ZVJld3JpdGUoY3UsIHJld3JpdGUpOworCQlidWYg
PSBuZXcgU3RyaW5nQnVmZmVyKCk7CisJCWJ1Zi5hcHBlbmQoInBhY2thZ2UgdGVzdDE7XG4iKTsK
KwkJYnVmLmFwcGVuZCgiaW1wb3J0IGphdmEubGFuZy5hbm5vdGF0aW9uLkVsZW1lbnRUeXBlO1xu
Iik7CisJCWJ1Zi5hcHBlbmQoInB1YmxpYyBjbGFzcyBYIHtcbiIpOworCQlidWYuYXBwZW5kKCIJ
cHVibGljIGNsYXNzIEhlbHBlcjxUPiB7XG4iKTsKKwkJYnVmLmFwcGVuZCgiCX1cbiIpOworCQli
dWYuYXBwZW5kKCIJcHVibGljIGNsYXNzIEJhc2Uge1xuIik7CisJCWJ1Zi5hcHBlbmQoIgl9XG4i
KTsKKwkJYnVmLmFwcGVuZCgiCXB1YmxpYyBzdGF0aWMgdm9pZCBVbmJvdW5kZWRXaWxkY2FyZDEg
KEhlbHBlcjxAQW5ub3QgQEFubm90MiA/PiB4KSB7XG4iKTsKKwkJYnVmLmFwcGVuZCgiCX1cbiIp
OworCQlidWYuYXBwZW5kKCIJcHVibGljIHN0YXRpYyB2b2lkIFVuYm91bmRlZFdpbGRjYXJkMiAo
SGVscGVyPEBBbm5vdDIgPz4geCkge1xuIik7CisJCWJ1Zi5hcHBlbmQoIgl9XG4iKTsKKwkJYnVm
LmFwcGVuZCgiCXB1YmxpYyBzdGF0aWMgdm9pZCBCb3VuZGVkV2lsZGNhcmQxIChIZWxwZXI8QEFu
bm90IEBBbm5vdDIgPyBleHRlbmRzIEJhc2U+IHgpIHtcbiIpOworCQlidWYuYXBwZW5kKCIJfVxu
Iik7CisJCWJ1Zi5hcHBlbmQoIglwdWJsaWMgc3RhdGljIHZvaWQgQm91bmRlZFdpbGRjYXJkMiAo
SGVscGVyPEBBbm5vdDIgPyBleHRlbmRzIEJhc2U+IHgpIHtcbiIpOworCQlidWYuYXBwZW5kKCIJ
fVxuIik7CisJCWJ1Zi5hcHBlbmQoIn1cbiIpOworCQlidWYuYXBwZW5kKCJAamF2YS5sYW5nLmFu
bm90YXRpb24uVGFyZ2V0IChFbGVtZW50VHlwZS5UWVBFX1VTRSlcbiIpOworCQlidWYuYXBwZW5k
KCJAaW50ZXJmYWNlIEFubm90IHt9XG4iKTsKKwkJYnVmLmFwcGVuZCgiQGphdmEubGFuZy5hbm5v
dGF0aW9uLlRhcmdldCAoRWxlbWVudFR5cGUuVFlQRV9VU0UpXG4iKTsKKwkJYnVmLmFwcGVuZCgi
QGludGVyZmFjZSBBbm5vdDEge31cbiIpOworCQlhc3NlcnRFcXVhbFN0cmluZyhwcmV2aWV3LCBi
dWYudG9TdHJpbmcoKSk7CisJfQorCisJcHVibGljIHZvaWQgdGVzdFdpbGRjYXJkQm91ZEFubm90
YXRpb24oKSB0aHJvd3MgRXhjZXB0aW9uIHsKKwkJaWYgKHRoaXMuYXBpTGV2ZWwgPCBBU1QuSkxT
OCkgcmV0dXJuOworCQlJUGFja2FnZUZyYWdtZW50IHBhY2sxPSB0aGlzLnNvdXJjZUZvbGRlci5j
cmVhdGVQYWNrYWdlRnJhZ21lbnQoInRlc3QxIiwgZmFsc2UsIG51bGwpOworCQlTdHJpbmdCdWZm
ZXIgYnVmPSBuZXcgU3RyaW5nQnVmZmVyKCk7CisKKwkJYnVmLmFwcGVuZCgicHVibGljIGNsYXNz
IFgge1xuIik7CisJCWJ1Zi5hcHBlbmQoIglwdWJsaWMgY2xhc3MgSGVscGVyPFQ+IHtcbiIpOwor
CQlidWYuYXBwZW5kKCIJfVxuIik7CisJCWJ1Zi5hcHBlbmQoIglwdWJsaWMgY2xhc3MgQmFzZSB7
XG4iKTsKKwkJYnVmLmFwcGVuZCgiCX1cbiIpOworCQlidWYuYXBwZW5kKCIJcHVibGljIHN0YXRp
YyB2b2lkIGZvbzEgKEhlbHBlcjw/IGV4dGVuZHMgQEFubm90IEJhc2U+IHgpIHtcbiIpOworCQli
dWYuYXBwZW5kKCIJfVxuIik7CisJCWJ1Zi5hcHBlbmQoIglwdWJsaWMgc3RhdGljIHZvaWQgZm9v
MiAoSGVscGVyPD8gZXh0ZW5kcyBAQW5ub3QxIEBBbm5vdCBCYXNlPiB4KSB7XG4iKTsKKwkJYnVm
LmFwcGVuZCgiCX1cbiIpOworCQlidWYuYXBwZW5kKCJ9XG4iKTsKKworCQlJQ29tcGlsYXRpb25V
bml0IGN1PSBwYWNrMS5jcmVhdGVDb21waWxhdGlvblVuaXQoIlguamF2YSIsIGJ1Zi50b1N0cmlu
ZygpLCBmYWxzZSwgbnVsbCk7CisJCUNvbXBpbGF0aW9uVW5pdCBhc3RSb290PSBjcmVhdGVBU1Qo
Y3UpOworCQlBU1RSZXdyaXRlIHJld3JpdGU9IEFTVFJld3JpdGUuY3JlYXRlKGFzdFJvb3QuZ2V0
QVNUKCkpOworCQlBU1QgYXN0PSBhc3RSb290LmdldEFTVCgpOworCQlUeXBlRGVjbGFyYXRpb24g
dHlwZT0gZmluZFR5cGVEZWNsYXJhdGlvbihhc3RSb290LCAiWCIpOworCQl7CisJCQlNZXRob2RE
ZWNsYXJhdGlvbiBtZXRob2REZWNsYXJhdGlvbj0gZmluZE1ldGhvZERlY2xhcmF0aW9uKHR5cGUs
ICJmb28xIik7CisJCQlMaXN0IHBhcmFtZXRlcnM9IG1ldGhvZERlY2xhcmF0aW9uLnBhcmFtZXRl
cnMoKTsKKwkJCVNpbmdsZVZhcmlhYmxlRGVjbGFyYXRpb24gc2luZ2xlVmFyaWFibGVEZWNsYXJh
dGlvbj0gKFNpbmdsZVZhcmlhYmxlRGVjbGFyYXRpb24pIHBhcmFtZXRlcnMuZ2V0KDApOworCQkJ
UGFyYW1ldGVyaXplZFR5cGUgcGFyYW1ldGVyaXplZFR5cGU9IChQYXJhbWV0ZXJpemVkVHlwZSkg
c2luZ2xlVmFyaWFibGVEZWNsYXJhdGlvbi5nZXRUeXBlKCk7CisJCQlXaWxkY2FyZFR5cGUgd2ls
ZGNhcmRUeXBlPSAoV2lsZGNhcmRUeXBlKSBwYXJhbWV0ZXJpemVkVHlwZS50eXBlQXJndW1lbnRz
KCkuZ2V0KDApOworCQkJU2ltcGxlVHlwZSBzaW1wbGVUeXBlPSAoU2ltcGxlVHlwZSkgd2lsZGNh
cmRUeXBlLmdldEJvdW5kKCk7CisJCQlNYXJrZXJBbm5vdGF0aW9uIG1hcmtlckFubm90YXRpb249
IGFzdC5uZXdNYXJrZXJBbm5vdGF0aW9uKCk7CisJCQltYXJrZXJBbm5vdGF0aW9uLnNldFR5cGVO
YW1lKGFzdC5uZXdTaW1wbGVOYW1lKCJBbm5vdDIiKSk7CisJCQlyZXdyaXRlLmdldExpc3RSZXdy
aXRlKHNpbXBsZVR5cGUsIFNpbXBsZVR5cGUuQU5OT1RBVElPTlNfUFJPUEVSVFkpLmluc2VydExh
c3QobWFya2VyQW5ub3RhdGlvbiwgbnVsbCk7CisJCX0KKwkJeworCQkJTWV0aG9kRGVjbGFyYXRp
b24gbWV0aG9kRGVjbGFyYXRpb249IGZpbmRNZXRob2REZWNsYXJhdGlvbih0eXBlLCAiZm9vMiIp
OworCQkJTGlzdCBwYXJhbWV0ZXJzPSBtZXRob2REZWNsYXJhdGlvbi5wYXJhbWV0ZXJzKCk7CisJ
CQlTaW5nbGVWYXJpYWJsZURlY2xhcmF0aW9uIHNpbmdsZVZhcmlhYmxlRGVjbGFyYXRpb249IChT
aW5nbGVWYXJpYWJsZURlY2xhcmF0aW9uKSBwYXJhbWV0ZXJzLmdldCgwKTsKKwkJCVBhcmFtZXRl
cml6ZWRUeXBlIHBhcmFtZXRlcml6ZWRUeXBlPSAoUGFyYW1ldGVyaXplZFR5cGUpIHNpbmdsZVZh
cmlhYmxlRGVjbGFyYXRpb24uZ2V0VHlwZSgpOworCQkJV2lsZGNhcmRUeXBlIHdpbGRjYXJkVHlw
ZT0gKFdpbGRjYXJkVHlwZSkgcGFyYW1ldGVyaXplZFR5cGUudHlwZUFyZ3VtZW50cygpLmdldCgw
KTsKKwkJCVNpbXBsZVR5cGUgc2ltcGxlVHlwZT0gKFNpbXBsZVR5cGUpIHdpbGRjYXJkVHlwZS5n
ZXRCb3VuZCgpOworCQkJLy9SZW1vdmUgdGhlIHVzZSBvZiBhbm5vdGF0aW9uCisJCQlyZXdyaXRl
LnJlbW92ZSgoTWFya2VyQW5ub3RhdGlvbikgc2ltcGxlVHlwZS5hbm5vdGF0aW9ucygpLmdldCgx
KSwgbnVsbCk7CisJCQkvL1JlcGxhY2UgdGhlIHVzZSBvZiBhbm5vdGF0aW9uCisJCQlNYXJrZXJB
bm5vdGF0aW9uIG1hcmtlckFubm90YXRpb249IGFzdC5uZXdNYXJrZXJBbm5vdGF0aW9uKCk7CisJ
CQltYXJrZXJBbm5vdGF0aW9uLnNldFR5cGVOYW1lKGFzdC5uZXdTaW1wbGVOYW1lKCJBbm5vdDIi
KSk7CisJCQlyZXdyaXRlLnJlcGxhY2UoKE1hcmtlckFubm90YXRpb24pIHNpbXBsZVR5cGUuYW5u
b3RhdGlvbnMoKS5nZXQoMCksIG1hcmtlckFubm90YXRpb24sIG51bGwpOworCQl9CisJCVN0cmlu
ZyBwcmV2aWV3PSBldmFsdWF0ZVJld3JpdGUoY3UsIHJld3JpdGUpOworCQlidWYgPSBuZXcgU3Ry
aW5nQnVmZmVyKCk7CisJCWJ1Zi5hcHBlbmQoInB1YmxpYyBjbGFzcyBYIHtcbiIpOworCQlidWYu
YXBwZW5kKCIJcHVibGljIGNsYXNzIEhlbHBlcjxUPiB7XG4iKTsKKwkJYnVmLmFwcGVuZCgiCX1c
biIpOworCQlidWYuYXBwZW5kKCIJcHVibGljIGNsYXNzIEJhc2Uge1xuIik7CisJCWJ1Zi5hcHBl
bmQoIgl9XG4iKTsKKwkJYnVmLmFwcGVuZCgiCXB1YmxpYyBzdGF0aWMgdm9pZCBmb28xIChIZWxw
ZXI8PyBleHRlbmRzIEBBbm5vdCBAQW5ub3QyIEJhc2U+IHgpIHtcbiIpOworCQlidWYuYXBwZW5k
KCIJfVxuIik7CisJCWJ1Zi5hcHBlbmQoIglwdWJsaWMgc3RhdGljIHZvaWQgZm9vMiAoSGVscGVy
PD8gZXh0ZW5kcyBAQW5ub3QyIEJhc2U+IHgpIHtcbiIpOworCQlidWYuYXBwZW5kKCIJfVxuIik7
CisJCWJ1Zi5hcHBlbmQoIn1cbiIpOworCQlhc3NlcnRFcXVhbFN0cmluZyhwcmV2aWV3LCBidWYu
dG9TdHJpbmcoKSk7CisJfQorCisJcHVibGljIHZvaWQgdGVzdFR5cGVQYXJhbWV0ZXJCb3VuZEFu
bm90YXRpb25zKCkgdGhyb3dzIEV4Y2VwdGlvbiB7CisJCWlmICh0aGlzLmFwaUxldmVsIDwgQVNU
LkpMUzgpIHJldHVybjsKKwkJSVBhY2thZ2VGcmFnbWVudCBwYWNrMT0gdGhpcy5zb3VyY2VGb2xk
ZXIuY3JlYXRlUGFja2FnZUZyYWdtZW50KCJ0ZXN0MSIsIGZhbHNlLCBudWxsKTsKKwkJU3RyaW5n
QnVmZmVyIGJ1Zj0gbmV3IFN0cmluZ0J1ZmZlcigpOworCisJCWJ1Zi5hcHBlbmQoImltcG9ydCBq
YXZhLmxhbmcuYW5ub3RhdGlvbi5FbGVtZW50VHlwZTtcbiIpOworCQlidWYuYXBwZW5kKCJcbiIp
OworCQlidWYuYXBwZW5kKCJwdWJsaWMgY2xhc3MgWCB7XG4iKTsKKwkJYnVmLmFwcGVuZCgiCXB1
YmxpYyBjbGFzcyBCYXNlIHtcbiIpOworCQlidWYuYXBwZW5kKCIJfVxuIik7CisJCWJ1Zi5hcHBl
bmQoIglwdWJsaWMgPFggZXh0ZW5kcyBAQW5ub3QgQmFzZT4gdm9pZCBmb28xIChYIHgpIHtcbiIp
OworCQlidWYuYXBwZW5kKCIJfVxuIik7CisJCWJ1Zi5hcHBlbmQoIglwdWJsaWMgPFggZXh0ZW5k
cyBAQW5ub3QxIEBBbm5vdCBCYXNlPiB2b2lkIGZvbzIgKFggeCkge1xuIik7CisJCWJ1Zi5hcHBl
bmQoIgl9XG4iKTsKKwkJYnVmLmFwcGVuZCgifVxuIik7CisJCWJ1Zi5hcHBlbmQoIlxuIik7CisJ
CWJ1Zi5hcHBlbmQoIkBqYXZhLmxhbmcuYW5ub3RhdGlvbi5UYXJnZXQgKEVsZW1lbnRUeXBlLlRZ
UEVfVVNFKSBcbiIpOworCQlidWYuYXBwZW5kKCJAaW50ZXJmYWNlIEFubm90IHt9XG4iKTsKKwkJ
YnVmLmFwcGVuZCgiXG4iKTsKKwkJYnVmLmFwcGVuZCgiQGphdmEubGFuZy5hbm5vdGF0aW9uLlRh
cmdldCAoRWxlbWVudFR5cGUuVFlQRV9VU0UpIFxuIik7CisJCWJ1Zi5hcHBlbmQoIkBpbnRlcmZh
Y2UgQW5ub3QxIHt9XG4iKTsKKworCQlJQ29tcGlsYXRpb25Vbml0IGN1PSBwYWNrMS5jcmVhdGVD
b21waWxhdGlvblVuaXQoIlguamF2YSIsIGJ1Zi50b1N0cmluZygpLCBmYWxzZSwgbnVsbCk7CisJ
CUNvbXBpbGF0aW9uVW5pdCBhc3RSb290PSBjcmVhdGVBU1QoY3UpOworCQlBU1RSZXdyaXRlIHJl
d3JpdGU9IEFTVFJld3JpdGUuY3JlYXRlKGFzdFJvb3QuZ2V0QVNUKCkpOworCQlBU1QgYXN0PSBh
c3RSb290LmdldEFTVCgpOworCQlUeXBlRGVjbGFyYXRpb24gdHlwZT0gZmluZFR5cGVEZWNsYXJh
dGlvbihhc3RSb290LCAiWCIpOworCQl7Ly9BZGQgYW4gdXNlIG9mIGFubm90YXRpb24KKwkJCU1l
dGhvZERlY2xhcmF0aW9uIG1ldGhvZERlY2xhcmF0aW9uPSBmaW5kTWV0aG9kRGVjbGFyYXRpb24o
dHlwZSwgImZvbzEiKTsKKwkJCVR5cGVQYXJhbWV0ZXIgdHlwZVBhcmFtZXRlcj0gKFR5cGVQYXJh
bWV0ZXIpIG1ldGhvZERlY2xhcmF0aW9uLnR5cGVQYXJhbWV0ZXJzKCkuZ2V0KDApOworCQkJU2lt
cGxlVHlwZSBzaW1wbGVUeXBlPSAoU2ltcGxlVHlwZSkgdHlwZVBhcmFtZXRlci50eXBlQm91bmRz
KCkuZ2V0KDApOworCQkJTWFya2VyQW5ub3RhdGlvbiBtYXJrZXJBbm5vdGF0aW9uPSBhc3QubmV3
TWFya2VyQW5ub3RhdGlvbigpOworCQkJbWFya2VyQW5ub3RhdGlvbi5zZXRUeXBlTmFtZShhc3Qu
bmV3U2ltcGxlTmFtZSgiQW5ub3QyIikpOworCQkJcmV3cml0ZS5nZXRMaXN0UmV3cml0ZShzaW1w
bGVUeXBlLCBTaW1wbGVUeXBlLkFOTk9UQVRJT05TX1BST1BFUlRZKS5pbnNlcnRMYXN0KG1hcmtl
ckFubm90YXRpb24sIG51bGwpOworCQl9CisJCXsKKwkJCU1ldGhvZERlY2xhcmF0aW9uIG1ldGhv
ZERlY2xhcmF0aW9uPSBmaW5kTWV0aG9kRGVjbGFyYXRpb24odHlwZSwgImZvbzIiKTsKKwkJCVR5
cGVQYXJhbWV0ZXIgdHlwZVBhcmFtZXRlcj0gKFR5cGVQYXJhbWV0ZXIpIG1ldGhvZERlY2xhcmF0
aW9uLnR5cGVQYXJhbWV0ZXJzKCkuZ2V0KDApOworCQkJU2ltcGxlVHlwZSBzaW1wbGVUeXBlPSAo
U2ltcGxlVHlwZSkgdHlwZVBhcmFtZXRlci50eXBlQm91bmRzKCkuZ2V0KDApOworCQkJLy9SZW1v
dmUgYW4gdXNlIG9mIGFubm90YXRpb24KKwkJCXJld3JpdGUucmVtb3ZlKChNYXJrZXJBbm5vdGF0
aW9uKSBzaW1wbGVUeXBlLmFubm90YXRpb25zKCkuZ2V0KDEpLCBudWxsKTsKKwkJCS8vUmVwbGFj
ZSBhbiB1c2Ugb2YgYW5ub3RhdGlvbgorCQkJTWFya2VyQW5ub3RhdGlvbiBtYXJrZXJBbm5vdGF0
aW9uPSBhc3QubmV3TWFya2VyQW5ub3RhdGlvbigpOworCQkJbWFya2VyQW5ub3RhdGlvbi5zZXRU
eXBlTmFtZShhc3QubmV3U2ltcGxlTmFtZSgiQW5ub3QyIikpOworCQkJcmV3cml0ZS5yZXBsYWNl
KChNYXJrZXJBbm5vdGF0aW9uKSBzaW1wbGVUeXBlLmFubm90YXRpb25zKCkuZ2V0KDApLCBtYXJr
ZXJBbm5vdGF0aW9uLCBudWxsKTsKKwkJfQorCQlTdHJpbmcgcHJldmlldz0gZXZhbHVhdGVSZXdy
aXRlKGN1LCByZXdyaXRlKTsKKwkJYnVmID0gbmV3IFN0cmluZ0J1ZmZlcigpOworCQlidWYuYXBw
ZW5kKCJpbXBvcnQgamF2YS5sYW5nLmFubm90YXRpb24uRWxlbWVudFR5cGU7XG4iKTsKKwkJYnVm
LmFwcGVuZCgiXG4iKTsKKwkJYnVmLmFwcGVuZCgicHVibGljIGNsYXNzIFgge1xuIik7CisJCWJ1
Zi5hcHBlbmQoIglwdWJsaWMgY2xhc3MgQmFzZSB7XG4iKTsKKwkJYnVmLmFwcGVuZCgiCX1cbiIp
OworCQlidWYuYXBwZW5kKCIJcHVibGljIDxYIGV4dGVuZHMgQEFubm90IEBBbm5vdDIgQmFzZT4g
dm9pZCBmb28xIChYIHgpIHtcbiIpOworCQlidWYuYXBwZW5kKCIJfVxuIik7CisJCWJ1Zi5hcHBl
bmQoIglwdWJsaWMgPFggZXh0ZW5kcyBAQW5ub3QyIEJhc2U+IHZvaWQgZm9vMiAoWCB4KSB7XG4i
KTsKKwkJYnVmLmFwcGVuZCgiCX1cbiIpOworCQlidWYuYXBwZW5kKCJ9XG4iKTsKKwkJYnVmLmFw
cGVuZCgiXG4iKTsKKwkJYnVmLmFwcGVuZCgiQGphdmEubGFuZy5hbm5vdGF0aW9uLlRhcmdldCAo
RWxlbWVudFR5cGUuVFlQRV9VU0UpIFxuIik7CisJCWJ1Zi5hcHBlbmQoIkBpbnRlcmZhY2UgQW5u
b3Qge31cbiIpOworCQlidWYuYXBwZW5kKCJcbiIpOworCQlidWYuYXBwZW5kKCJAamF2YS5sYW5n
LmFubm90YXRpb24uVGFyZ2V0IChFbGVtZW50VHlwZS5UWVBFX1VTRSkgXG4iKTsKKwkJYnVmLmFw
cGVuZCgiQGludGVyZmFjZSBBbm5vdDEge31cbiIpOworCQlhc3NlcnRFcXVhbFN0cmluZyhwcmV2
aWV3LCBidWYudG9TdHJpbmcoKSk7CisJfQorCisJcHVibGljIHZvaWQgdGVzdFR5cGVBcmd1bWVu
dHNQYXJhbWV0ZXJpemVkQ2xhc3Nlc0Fubm90YXRpb25zKCkgdGhyb3dzIEV4Y2VwdGlvbiB7CisJ
CWlmICh0aGlzLmFwaUxldmVsIDwgQVNULkpMUzgpIHJldHVybjsKKwkJSVBhY2thZ2VGcmFnbWVu
dCBwYWNrMT0gdGhpcy5zb3VyY2VGb2xkZXIuY3JlYXRlUGFja2FnZUZyYWdtZW50KCJ0ZXN0MSIs
IGZhbHNlLCBudWxsKTsKKwkJU3RyaW5nQnVmZmVyIGJ1Zj0gbmV3IFN0cmluZ0J1ZmZlcigpOwor
CisJCWJ1Zi5hcHBlbmQoImltcG9ydCBqYXZhLmxhbmcuYW5ub3RhdGlvbi5FbGVtZW50VHlwZTtc
biIpOworCQlidWYuYXBwZW5kKCJcbiIpOworCQlidWYuYXBwZW5kKCJwdWJsaWMgY2xhc3MgWCB7
XG4iKTsKKwkJYnVmLmFwcGVuZCgiCXB1YmxpYyBjbGFzcyBIZWxwZXIgPFQxLCBUMj4ge1xuIik7
CisJCWJ1Zi5hcHBlbmQoIgl9XG4iKTsKKwkJYnVmLmFwcGVuZCgiCXB1YmxpYyB2b2lkIGZvbygp
IHtcbiIpOworCQlidWYuYXBwZW5kKCIJCUhlbHBlcjxAQW5ub3QgU3RyaW5nLCBAQW5ub3QgQEFu
bm90MSBTdHJpbmc+IHg7XG4iKTsKKwkJYnVmLmFwcGVuZCgiCX1cbiIpOworCQlidWYuYXBwZW5k
KCJ9XG4iKTsKKwkJYnVmLmFwcGVuZCgiXG4iKTsKKwkJYnVmLmFwcGVuZCgiQGphdmEubGFuZy5h
bm5vdGF0aW9uLlRhcmdldCAoRWxlbWVudFR5cGUuVFlQRV9VU0UpIFxuIik7CisJCWJ1Zi5hcHBl
bmQoIkBpbnRlcmZhY2UgQW5ub3Qge31cbiIpOworCQlidWYuYXBwZW5kKCJcbiIpOworCQlidWYu
YXBwZW5kKCJAamF2YS5sYW5nLmFubm90YXRpb24uVGFyZ2V0IChFbGVtZW50VHlwZS5UWVBFX1VT
RSkgXG4iKTsKKwkJYnVmLmFwcGVuZCgiQGludGVyZmFjZSBBbm5vdDEge31cbiIpOworCisJCUlD
b21waWxhdGlvblVuaXQgY3U9IHBhY2sxLmNyZWF0ZUNvbXBpbGF0aW9uVW5pdCgiWC5qYXZhIiwg
YnVmLnRvU3RyaW5nKCksIGZhbHNlLCBudWxsKTsKKwkJQ29tcGlsYXRpb25Vbml0IGFzdFJvb3Q9
IGNyZWF0ZUFTVChjdSk7CisJCUFTVFJld3JpdGUgcmV3cml0ZT0gQVNUUmV3cml0ZS5jcmVhdGUo
YXN0Um9vdC5nZXRBU1QoKSk7CisJCUFTVCBhc3Q9IGFzdFJvb3QuZ2V0QVNUKCk7CisJCVR5cGVE
ZWNsYXJhdGlvbiB0eXBlPSBmaW5kVHlwZURlY2xhcmF0aW9uKGFzdFJvb3QsICJYIik7CisJCU1l
dGhvZERlY2xhcmF0aW9uIG1ldGhvZERlY2xhcmF0aW9uPSBmaW5kTWV0aG9kRGVjbGFyYXRpb24o
dHlwZSwgImZvbyIpOworCQlMaXN0IHN0YXRlbWVudHM9IG1ldGhvZERlY2xhcmF0aW9uLmdldEJv
ZHkoKS5zdGF0ZW1lbnRzKCk7CisJCVZhcmlhYmxlRGVjbGFyYXRpb25TdGF0ZW1lbnQgIHZhcmlh
YmxlRGVjbGFyYXRpb25TdGF0ZW1lbnQ9IChWYXJpYWJsZURlY2xhcmF0aW9uU3RhdGVtZW50KSBz
dGF0ZW1lbnRzLmdldCgwKTsKKwkJUGFyYW1ldGVyaXplZFR5cGUgcGFyYW1ldGVyaXplZFR5cGU9
IChQYXJhbWV0ZXJpemVkVHlwZSkgdmFyaWFibGVEZWNsYXJhdGlvblN0YXRlbWVudC5nZXRUeXBl
KCk7CisJCXsvLyBBZGQgYW4gdXNlIG9mIGFubm90YXRpb24KKwkJCVNpbXBsZVR5cGUgc2ltcGxl
VHlwZT0gKFNpbXBsZVR5cGUpIHBhcmFtZXRlcml6ZWRUeXBlLnR5cGVBcmd1bWVudHMoKS5nZXQo
MCk7CisJCQlNYXJrZXJBbm5vdGF0aW9uIG1hcmtlckFubm90YXRpb249IGFzdC5uZXdNYXJrZXJB
bm5vdGF0aW9uKCk7CisJCQltYXJrZXJBbm5vdGF0aW9uLnNldFR5cGVOYW1lKGFzdC5uZXdTaW1w
bGVOYW1lKCJBbm5vdDIiKSk7CisJCQlyZXdyaXRlLmdldExpc3RSZXdyaXRlKHNpbXBsZVR5cGUs
IFNpbXBsZVR5cGUuQU5OT1RBVElPTlNfUFJPUEVSVFkpLmluc2VydExhc3QobWFya2VyQW5ub3Rh
dGlvbiwgbnVsbCk7CisJCQkvL1JlcGxhY2UgYW4gdXNlIG9mIGFuIGFubm90YXRpb24KKwkJCW1h
cmtlckFubm90YXRpb249IGFzdC5uZXdNYXJrZXJBbm5vdGF0aW9uKCk7CisJCQltYXJrZXJBbm5v
dGF0aW9uLnNldFR5cGVOYW1lKGFzdC5uZXdTaW1wbGVOYW1lKCJBbm5vdDMiKSk7CisJCQlyZXdy
aXRlLnJlcGxhY2UoKEFTVE5vZGUpIHNpbXBsZVR5cGUuYW5ub3RhdGlvbnMoKS5nZXQoMCksIG1h
cmtlckFubm90YXRpb24sIG51bGwpOworCQl9CisJCXsKKwkJCVNpbXBsZVR5cGUgc2ltcGxlVHlw
ZT0gKFNpbXBsZVR5cGUpIHBhcmFtZXRlcml6ZWRUeXBlLnR5cGVBcmd1bWVudHMoKS5nZXQoMSk7
CisJCQkvL1JlbW92ZSBhbiB1c2Ugb2YgYW4gYW5ub3RhdGlvbgorCQkJcmV3cml0ZS5yZW1vdmUo
KEFTVE5vZGUpIHNpbXBsZVR5cGUuYW5ub3RhdGlvbnMoKS5nZXQoMSksIG51bGwpOworCQkJLy9F
bXB0eSBhbm5vdGF0aW9ucyBsaXN0CisJCQlyZXdyaXRlLnJlbW92ZSgoQVNUTm9kZSkgc2ltcGxl
VHlwZS5hbm5vdGF0aW9ucygpLmdldCgwKSwgbnVsbCk7CisJCX0KKwkJU3RyaW5nIHByZXZpZXc9
IGV2YWx1YXRlUmV3cml0ZShjdSwgcmV3cml0ZSk7CisJCWJ1ZiA9IG5ldyBTdHJpbmdCdWZmZXIo
KTsKKwkJYnVmLmFwcGVuZCgiaW1wb3J0IGphdmEubGFuZy5hbm5vdGF0aW9uLkVsZW1lbnRUeXBl
O1xuIik7CisJCWJ1Zi5hcHBlbmQoIlxuIik7CisJCWJ1Zi5hcHBlbmQoInB1YmxpYyBjbGFzcyBY
IHtcbiIpOworCQlidWYuYXBwZW5kKCIJcHVibGljIGNsYXNzIEhlbHBlciA8VDEsIFQyPiB7XG4i
KTsKKwkJYnVmLmFwcGVuZCgiCX1cbiIpOworCQlidWYuYXBwZW5kKCIJcHVibGljIHZvaWQgZm9v
KCkge1xuIik7CisJCWJ1Zi5hcHBlbmQoIgkJSGVscGVyPEBBbm5vdDMgQEFubm90MiBTdHJpbmcs
IFN0cmluZz4geDtcbiIpOworCQlidWYuYXBwZW5kKCIJfVxuIik7CisJCWJ1Zi5hcHBlbmQoIn1c
biIpOworCQlidWYuYXBwZW5kKCJcbiIpOworCQlidWYuYXBwZW5kKCJAamF2YS5sYW5nLmFubm90
YXRpb24uVGFyZ2V0IChFbGVtZW50VHlwZS5UWVBFX1VTRSkgXG4iKTsKKwkJYnVmLmFwcGVuZCgi
QGludGVyZmFjZSBBbm5vdCB7fVxuIik7CisJCWJ1Zi5hcHBlbmQoIlxuIik7CisJCWJ1Zi5hcHBl
bmQoIkBqYXZhLmxhbmcuYW5ub3RhdGlvbi5UYXJnZXQgKEVsZW1lbnRUeXBlLlRZUEVfVVNFKSBc
biIpOworCQlidWYuYXBwZW5kKCJAaW50ZXJmYWNlIEFubm90MSB7fVxuIik7CisJCWFzc2VydEVx
dWFsU3RyaW5nKHByZXZpZXcsIGJ1Zi50b1N0cmluZygpKTsKKwl9CisKKwlwdWJsaWMgdm9pZCB0
ZXN0VHlwZUFyZ3VtZW50c01ldGhvZEludm9jYXRpb24oKSB0aHJvd3MgRXhjZXB0aW9uIHsKKwkJ
aWYgKHRoaXMuYXBpTGV2ZWwgPCBBU1QuSkxTOCkgcmV0dXJuOworCQlJUGFja2FnZUZyYWdtZW50
IHBhY2sxPSB0aGlzLnNvdXJjZUZvbGRlci5jcmVhdGVQYWNrYWdlRnJhZ21lbnQoInRlc3QxIiwg
ZmFsc2UsIG51bGwpOworCQlTdHJpbmdCdWZmZXIgYnVmPSBuZXcgU3RyaW5nQnVmZmVyKCk7CisK
KwkJYnVmLmFwcGVuZCgiaW1wb3J0IGphdmEubGFuZy5hbm5vdGF0aW9uLkVsZW1lbnRUeXBlO1xu
Iik7CisJCWJ1Zi5hcHBlbmQoIlxuIik7CisJCWJ1Zi5hcHBlbmQoInB1YmxpYyBjbGFzcyBYIHtc
biIpOworCQlidWYuYXBwZW5kKCIJcHVibGljIGNsYXNzIEJhciB7XG4iKTsKKwkJYnVmLmFwcGVu
ZCgiCX1cbiIpOworCQlidWYuYXBwZW5kKCIJXG4iKTsKKwkJYnVmLmFwcGVuZCgiCXB1YmxpYyBj
bGFzcyBIZWxwZXIge1xuIik7CisJCWJ1Zi5hcHBlbmQoIgkJcHVibGljIDxUPiB2b2lkIGZvbygp
IHtcbiIpOworCQlidWYuYXBwZW5kKCIJCX1cbiIpOworCQlidWYuYXBwZW5kKCIJfVxuIik7CisJ
CWJ1Zi5hcHBlbmQoIglcbiIpOworCQlidWYuYXBwZW5kKCIJcHVibGljIHZvaWQgem9vKCkge1xu
Iik7CisJCWJ1Zi5hcHBlbmQoIgkJSGVscGVyIG8gPSBuZXcgSGVscGVyKCk7XG4iKTsKKwkJYnVm
LmFwcGVuZCgiCQlvLjxAQW5ub3QgQmFyPmZvbygpO1xuIik7CisJCWJ1Zi5hcHBlbmQoIgkJby48
QEFubm90IEBBbm5vdDEgQmFyPmZvbygpO1xuIik7CisJCWJ1Zi5hcHBlbmQoIgl9XG4iKTsKKwkJ
YnVmLmFwcGVuZCgifVxuIik7CisJCWJ1Zi5hcHBlbmQoIlxuIik7CisJCWJ1Zi5hcHBlbmQoIkBq
YXZhLmxhbmcuYW5ub3RhdGlvbi5UYXJnZXQgKEVsZW1lbnRUeXBlLlRZUEVfVVNFKSBcbiIpOwor
CQlidWYuYXBwZW5kKCJAaW50ZXJmYWNlIEFubm90IHt9XG4iKTsKKwkJYnVmLmFwcGVuZCgiXG4i
KTsKKwkJYnVmLmFwcGVuZCgiQGphdmEubGFuZy5hbm5vdGF0aW9uLlRhcmdldCAoRWxlbWVudFR5
cGUuVFlQRV9VU0UpIFxuIik7CisJCWJ1Zi5hcHBlbmQoIkBpbnRlcmZhY2UgQW5ub3QxIHt9XG4i
KTsKKworCQlJQ29tcGlsYXRpb25Vbml0IGN1PSBwYWNrMS5jcmVhdGVDb21waWxhdGlvblVuaXQo
IlguamF2YSIsIGJ1Zi50b1N0cmluZygpLCBmYWxzZSwgbnVsbCk7CisJCUNvbXBpbGF0aW9uVW5p
dCBhc3RSb290PSBjcmVhdGVBU1QoY3UpOworCQlBU1RSZXdyaXRlIHJld3JpdGU9IEFTVFJld3Jp
dGUuY3JlYXRlKGFzdFJvb3QuZ2V0QVNUKCkpOworCQlBU1QgYXN0PSBhc3RSb290LmdldEFTVCgp
OworCQlUeXBlRGVjbGFyYXRpb24gdHlwZT0gZmluZFR5cGVEZWNsYXJhdGlvbihhc3RSb290LCAi
WCIpOworCQlNZXRob2REZWNsYXJhdGlvbiBtZXRob2REZWNsYXJhdGlvbiA9IGZpbmRNZXRob2RE
ZWNsYXJhdGlvbih0eXBlLCAiem9vIik7CisJCUxpc3Qgc3RhdGVtTGlzdCA9IG1ldGhvZERlY2xh
cmF0aW9uLmdldEJvZHkoKS5zdGF0ZW1lbnRzKCk7CisJCXsvLyBBZGQgYW4gdXNlIG9mIGFuIGFu
bm90YXRpb24KKwkJCUV4cHJlc3Npb25TdGF0ZW1lbnQgZXhwcmVzc2lvbj0gKEV4cHJlc3Npb25T
dGF0ZW1lbnQpIHN0YXRlbUxpc3QuZ2V0KDEpOworCQkJTWV0aG9kSW52b2NhdGlvbiBtZXRob2RJ
bnZvY2F0aW9uPSAoTWV0aG9kSW52b2NhdGlvbikgZXhwcmVzc2lvbi5nZXRFeHByZXNzaW9uKCk7
CisJCQlTaW1wbGVUeXBlIHNpbXBsZVR5cGUgPSAoU2ltcGxlVHlwZSkgbWV0aG9kSW52b2NhdGlv
bi50eXBlQXJndW1lbnRzKCkuZ2V0KDApOworCQkJTWFya2VyQW5ub3RhdGlvbiBtYXJrZXJBbm5v
dGF0aW9uPSBhc3QubmV3TWFya2VyQW5ub3RhdGlvbigpOworCQkJbWFya2VyQW5ub3RhdGlvbi5z
ZXRUeXBlTmFtZShhc3QubmV3U2ltcGxlTmFtZSgiQW5ub3QyIikpOworCQkJcmV3cml0ZS5nZXRM
aXN0UmV3cml0ZShzaW1wbGVUeXBlLCBTaW1wbGVUeXBlLkFOTk9UQVRJT05TX1BST1BFUlRZKS5p
bnNlcnRMYXN0KG1hcmtlckFubm90YXRpb24sIG51bGwpOworCQl9CisJCXsKKwkJCUV4cHJlc3Np
b25TdGF0ZW1lbnQgZXhwcmVzc2lvbj0gKEV4cHJlc3Npb25TdGF0ZW1lbnQpIHN0YXRlbUxpc3Qu
Z2V0KDIpOworCQkJTWV0aG9kSW52b2NhdGlvbiBtZXRob2RJbnZvY2F0aW9uPSAoTWV0aG9kSW52
b2NhdGlvbikgZXhwcmVzc2lvbi5nZXRFeHByZXNzaW9uKCk7CisJCQlTaW1wbGVUeXBlIHNpbXBs
ZVR5cGUgPSAoU2ltcGxlVHlwZSkgbWV0aG9kSW52b2NhdGlvbi50eXBlQXJndW1lbnRzKCkuZ2V0
KDApOworCQkJcmV3cml0ZS5yZW1vdmUoKE1hcmtlckFubm90YXRpb24pc2ltcGxlVHlwZS5hbm5v
dGF0aW9ucygpLmdldCgxKSwgbnVsbCk7CisJCQlNYXJrZXJBbm5vdGF0aW9uIG1hcmtlckFubm90
YXRpb249IGFzdC5uZXdNYXJrZXJBbm5vdGF0aW9uKCk7CisJCQltYXJrZXJBbm5vdGF0aW9uLnNl
dFR5cGVOYW1lKGFzdC5uZXdTaW1wbGVOYW1lKCJBbm5vdDIiKSk7CisJCQlyZXdyaXRlLnJlcGxh
Y2UoKE1hcmtlckFubm90YXRpb24pc2ltcGxlVHlwZS5hbm5vdGF0aW9ucygpLmdldCgwKSwgbWFy
a2VyQW5ub3RhdGlvbiwgbnVsbCk7CisJCX0KKwkJU3RyaW5nIHByZXZpZXc9IGV2YWx1YXRlUmV3
cml0ZShjdSwgcmV3cml0ZSk7CisJCWJ1ZiA9IG5ldyBTdHJpbmdCdWZmZXIoKTsKKwkJYnVmLmFw
cGVuZCgiaW1wb3J0IGphdmEubGFuZy5hbm5vdGF0aW9uLkVsZW1lbnRUeXBlO1xuIik7CisJCWJ1
Zi5hcHBlbmQoIlxuIik7CisJCWJ1Zi5hcHBlbmQoInB1YmxpYyBjbGFzcyBYIHtcbiIpOworCQli
dWYuYXBwZW5kKCIJcHVibGljIGNsYXNzIEJhciB7XG4iKTsKKwkJYnVmLmFwcGVuZCgiCX1cbiIp
OworCQlidWYuYXBwZW5kKCIJXG4iKTsKKwkJYnVmLmFwcGVuZCgiCXB1YmxpYyBjbGFzcyBIZWxw
ZXIge1xuIik7CisJCWJ1Zi5hcHBlbmQoIgkJcHVibGljIDxUPiB2b2lkIGZvbygpIHtcbiIpOwor
CQlidWYuYXBwZW5kKCIJCX1cbiIpOworCQlidWYuYXBwZW5kKCIJfVxuIik7CisJCWJ1Zi5hcHBl
bmQoIglcbiIpOworCQlidWYuYXBwZW5kKCIJcHVibGljIHZvaWQgem9vKCkge1xuIik7CisJCWJ1
Zi5hcHBlbmQoIgkJSGVscGVyIG8gPSBuZXcgSGVscGVyKCk7XG4iKTsKKwkJYnVmLmFwcGVuZCgi
CQlvLjxAQW5ub3QgQEFubm90MiBCYXI+Zm9vKCk7XG4iKTsKKwkJYnVmLmFwcGVuZCgiCQlvLjxA
QW5ub3QyIEJhcj5mb28oKTtcbiIpOworCQlidWYuYXBwZW5kKCIJfVxuIik7CisJCWJ1Zi5hcHBl
bmQoIn1cbiIpOworCQlidWYuYXBwZW5kKCJcbiIpOworCQlidWYuYXBwZW5kKCJAamF2YS5sYW5n
LmFubm90YXRpb24uVGFyZ2V0IChFbGVtZW50VHlwZS5UWVBFX1VTRSkgXG4iKTsKKwkJYnVmLmFw
cGVuZCgiQGludGVyZmFjZSBBbm5vdCB7fVxuIik7CisJCWJ1Zi5hcHBlbmQoIlxuIik7CisJCWJ1
Zi5hcHBlbmQoIkBqYXZhLmxhbmcuYW5ub3RhdGlvbi5UYXJnZXQgKEVsZW1lbnRUeXBlLlRZUEVf
VVNFKSBcbiIpOworCQlidWYuYXBwZW5kKCJAaW50ZXJmYWNlIEFubm90MSB7fVxuIik7CisJCWFz
c2VydEVxdWFsU3RyaW5nKHByZXZpZXcsIGJ1Zi50b1N0cmluZygpKTsKKwl9CisKKwlwdWJsaWMg
dm9pZCB0ZXN0Q2xhc3NJbmhlcml0ZW5jZUFubm90YXRpb25zKCkgdGhyb3dzIEV4Y2VwdGlvbiB7
CisJCWlmICh0aGlzLmFwaUxldmVsIDwgQVNULkpMUzgpIHJldHVybjsKKwkJSVBhY2thZ2VGcmFn
bWVudCBwYWNrMT0gdGhpcy5zb3VyY2VGb2xkZXIuY3JlYXRlUGFja2FnZUZyYWdtZW50KCJ0ZXN0
MSIsIGZhbHNlLCBudWxsKTsKKwkJU3RyaW5nQnVmZmVyIGJ1Zj0gbmV3IFN0cmluZ0J1ZmZlcigp
OworCisJCWJ1Zi5hcHBlbmQoImltcG9ydCBqYXZhLmxhbmcuYW5ub3RhdGlvbi5FbGVtZW50VHlw
ZTtcbiIpOworCQlidWYuYXBwZW5kKCJcbiIpOworCQlidWYuYXBwZW5kKCJwdWJsaWMgY2xhc3Mg
WCB7XG4iKTsKKwkJYnVmLmFwcGVuZCgiCXB1YmxpYyBpbnRlcmZhY2UgSGVscGVyPFQ+IHtcbiIp
OworCQlidWYuYXBwZW5kKCIJfVxuIik7CisJCWJ1Zi5hcHBlbmQoIglwdWJsaWMgY2xhc3MgRm9v
MTxUPiBpbXBsZW1lbnRzIEBBbm5vdCBIZWxwZXI8VD4ge1xuIik7CisJCWJ1Zi5hcHBlbmQoIgl9
XG4iKTsKKwkJYnVmLmFwcGVuZCgiCXB1YmxpYyBjbGFzcyBGb28yPFQ+IGltcGxlbWVudHMgQEFu
bm90IEBBbm5vdDEgSGVscGVyPFQ+IHtcbiIpOworCQlidWYuYXBwZW5kKCIJfVxuIik7CisJCWJ1
Zi5hcHBlbmQoIn1cbiIpOworCQlidWYuYXBwZW5kKCJcbiIpOworCQlidWYuYXBwZW5kKCJAamF2
YS5sYW5nLmFubm90YXRpb24uVGFyZ2V0IChFbGVtZW50VHlwZS5UWVBFX1VTRSlcbiIpOworCQli
dWYuYXBwZW5kKCJAaW50ZXJmYWNlIEFubm90IHt9XG4iKTsKKwkJYnVmLmFwcGVuZCgiXG4iKTsK
KwkJYnVmLmFwcGVuZCgiQGphdmEubGFuZy5hbm5vdGF0aW9uLlRhcmdldCAoRWxlbWVudFR5cGUu
VFlQRV9VU0UpXG4iKTsKKwkJYnVmLmFwcGVuZCgiQGludGVyZmFjZSBBbm5vdDEge31cbiIpOwor
CisJCUlDb21waWxhdGlvblVuaXQgY3U9IHBhY2sxLmNyZWF0ZUNvbXBpbGF0aW9uVW5pdCgiWC5q
YXZhIiwgYnVmLnRvU3RyaW5nKCksIGZhbHNlLCBudWxsKTsKKwkJQ29tcGlsYXRpb25Vbml0IGFz
dFJvb3Q9IGNyZWF0ZUFTVChjdSk7CisJCUFTVFJld3JpdGUgcmV3cml0ZT0gQVNUUmV3cml0ZS5j
cmVhdGUoYXN0Um9vdC5nZXRBU1QoKSk7CisJCUFTVCBhc3Q9IGFzdFJvb3QuZ2V0QVNUKCk7CisJ
CVR5cGVEZWNsYXJhdGlvbiB0eXBlPSBmaW5kVHlwZURlY2xhcmF0aW9uKGFzdFJvb3QsICJYIik7
CisJCXsvL0FkZCB0aGUgdXNlIG9mIGFuIGFubm90YXRpb24KKwkJCVR5cGVEZWNsYXJhdGlvbiB0
eXBlRGVjbGFyYXRpb249IChUeXBlRGVjbGFyYXRpb24pIHR5cGUuYm9keURlY2xhcmF0aW9ucygp
LmdldCgxKTsKKwkJCVBhcmFtZXRlcml6ZWRUeXBlIHBhcmFtZXRlcml6ZWRUeXBlPSAoUGFyYW1l
dGVyaXplZFR5cGUpIHR5cGVEZWNsYXJhdGlvbi5zdXBlckludGVyZmFjZVR5cGVzKCkuZ2V0KDAp
OworCQkJU2ltcGxlVHlwZSBzaW1wbGVUeXBlPSAoU2ltcGxlVHlwZSkgcGFyYW1ldGVyaXplZFR5
cGUuZ2V0VHlwZSgpOworCQkJTWFya2VyQW5ub3RhdGlvbiBtYXJrZXJBbm5vdGF0aW9uPSBhc3Qu
bmV3TWFya2VyQW5ub3RhdGlvbigpOworCQkJbWFya2VyQW5ub3RhdGlvbi5zZXRUeXBlTmFtZShh
c3QubmV3U2ltcGxlTmFtZSgiQW5ub3QyIikpOworCQkJcmV3cml0ZS5nZXRMaXN0UmV3cml0ZShz
aW1wbGVUeXBlLCBTaW1wbGVUeXBlLkFOTk9UQVRJT05TX1BST1BFUlRZKS5pbnNlcnRMYXN0KG1h
cmtlckFubm90YXRpb24sIG51bGwpOworCQl9CisJCXsKKwkJCVR5cGVEZWNsYXJhdGlvbiB0eXBl
RGVjbGFyYXRpb249IChUeXBlRGVjbGFyYXRpb24pIHR5cGUuYm9keURlY2xhcmF0aW9ucygpLmdl
dCgyKTsKKwkJCVBhcmFtZXRlcml6ZWRUeXBlIHBhcmFtZXRlcml6ZWRUeXBlPSAoUGFyYW1ldGVy
aXplZFR5cGUpIHR5cGVEZWNsYXJhdGlvbi5zdXBlckludGVyZmFjZVR5cGVzKCkuZ2V0KDApOwor
CQkJU2ltcGxlVHlwZSBzaW1wbGVUeXBlPSAoU2ltcGxlVHlwZSkgcGFyYW1ldGVyaXplZFR5cGUu
Z2V0VHlwZSgpOworCQkJLy9SZW1vdmUgdGhlIHVzZSBvZiBhbiBhbm5vdGF0aW9uCisJCQlyZXdy
aXRlLnJlbW92ZSgoTWFya2VyQW5ub3RhdGlvbikgc2ltcGxlVHlwZS5hbm5vdGF0aW9ucygpLmdl
dCgxKSwgbnVsbCk7CisJCQkvL1JlcGxhY2UgdGhlIHVzZSBvZiBhbiBhbm5vdGF0aW9uCisJCQlN
YXJrZXJBbm5vdGF0aW9uIG1hcmtlckFubm90YXRpb249IGFzdC5uZXdNYXJrZXJBbm5vdGF0aW9u
KCk7CisJCQltYXJrZXJBbm5vdGF0aW9uLnNldFR5cGVOYW1lKGFzdC5uZXdTaW1wbGVOYW1lKCJB
bm5vdDIiKSk7CisJCQlyZXdyaXRlLnJlcGxhY2UoKE1hcmtlckFubm90YXRpb24pIHNpbXBsZVR5
cGUuYW5ub3RhdGlvbnMoKS5nZXQoMCksIG1hcmtlckFubm90YXRpb24sIG51bGwpOworCQl9CisJ
CVN0cmluZyBwcmV2aWV3PSBldmFsdWF0ZVJld3JpdGUoY3UsIHJld3JpdGUpOworCQlidWYgPSBu
ZXcgU3RyaW5nQnVmZmVyKCk7CisJCWJ1Zi5hcHBlbmQoImltcG9ydCBqYXZhLmxhbmcuYW5ub3Rh
dGlvbi5FbGVtZW50VHlwZTtcbiIpOworCQlidWYuYXBwZW5kKCJcbiIpOworCQlidWYuYXBwZW5k
KCJwdWJsaWMgY2xhc3MgWCB7XG4iKTsKKwkJYnVmLmFwcGVuZCgiCXB1YmxpYyBpbnRlcmZhY2Ug
SGVscGVyPFQ+IHtcbiIpOworCQlidWYuYXBwZW5kKCIJfVxuIik7CisJCWJ1Zi5hcHBlbmQoIglw
dWJsaWMgY2xhc3MgRm9vMTxUPiBpbXBsZW1lbnRzIEBBbm5vdCBAQW5ub3QyIEhlbHBlcjxUPiB7
XG4iKTsKKwkJYnVmLmFwcGVuZCgiCX1cbiIpOworCQlidWYuYXBwZW5kKCIJcHVibGljIGNsYXNz
IEZvbzI8VD4gaW1wbGVtZW50cyBAQW5ub3QyIEhlbHBlcjxUPiB7XG4iKTsKKwkJYnVmLmFwcGVu
ZCgiCX1cbiIpOworCQlidWYuYXBwZW5kKCJ9XG4iKTsKKwkJYnVmLmFwcGVuZCgiXG4iKTsKKwkJ
YnVmLmFwcGVuZCgiQGphdmEubGFuZy5hbm5vdGF0aW9uLlRhcmdldCAoRWxlbWVudFR5cGUuVFlQ
RV9VU0UpXG4iKTsKKwkJYnVmLmFwcGVuZCgiQGludGVyZmFjZSBBbm5vdCB7fVxuIik7CisJCWJ1
Zi5hcHBlbmQoIlxuIik7CisJCWJ1Zi5hcHBlbmQoIkBqYXZhLmxhbmcuYW5ub3RhdGlvbi5UYXJn
ZXQgKEVsZW1lbnRUeXBlLlRZUEVfVVNFKVxuIik7CisJCWJ1Zi5hcHBlbmQoIkBpbnRlcmZhY2Ug
QW5ub3QxIHt9XG4iKTsKKwkJYXNzZXJ0RXF1YWxTdHJpbmcocHJldmlldywgYnVmLnRvU3RyaW5n
KCkpOworCX0KKworCXB1YmxpYyB2b2lkIHRlc3RUeXBlVGVzdHMoKSB0aHJvd3MgRXhjZXB0aW9u
IHsKKwkJaWYgKHRoaXMuYXBpTGV2ZWwgPCBBU1QuSkxTOCkgcmV0dXJuOworCQlJUGFja2FnZUZy
YWdtZW50IHBhY2sxPSB0aGlzLnNvdXJjZUZvbGRlci5jcmVhdGVQYWNrYWdlRnJhZ21lbnQoInRl
c3QxIiwgZmFsc2UsIG51bGwpOworCQlTdHJpbmdCdWZmZXIgYnVmPSBuZXcgU3RyaW5nQnVmZmVy
KCk7CisKKwkJYnVmLmFwcGVuZCgiaW1wb3J0IGphdmEubGFuZy5hbm5vdGF0aW9uLkVsZW1lbnRU
eXBlO1xuIik7CisJCWJ1Zi5hcHBlbmQoIlxuIik7CisJCWJ1Zi5hcHBlbmQoInB1YmxpYyBjbGFz
cyBYIHtcbiIpOworCQlidWYuYXBwZW5kKCIJcHVibGljIGNsYXNzIEhlbHBlciB7XG4iKTsKKwkJ
YnVmLmFwcGVuZCgiCX1cbiIpOworCQlidWYuYXBwZW5kKCIJXG4iKTsKKwkJYnVmLmFwcGVuZCgi
CXB1YmxpYyB2b2lkIGZvbygpIHtcbiIpOworCQlidWYuYXBwZW5kKCIJSGVscGVyIGEgPSBuZXcg
QEFubm90IEhlbHBlcigpO1xuIik7CisJCWJ1Zi5hcHBlbmQoIglib29sZWFuIHggPSB0cnVlO1xu
Iik7CisJCWJ1Zi5hcHBlbmQoIgl4ID0gYSBpbnN0YW5jZW9mIEBBbm5vdCBIZWxwZXI7XG4iKTsK
KwkJYnVmLmFwcGVuZCgiCXggPSBhIGluc3RhbmNlb2YgQEFubm90IEBBbm5vdDEgSGVscGVyO1xu
Iik7CisJCWJ1Zi5hcHBlbmQoIgl9XG4iKTsKKwkJYnVmLmFwcGVuZCgifVxuIik7CisJCWJ1Zi5h
cHBlbmQoIlxuIik7CisJCWJ1Zi5hcHBlbmQoIkBqYXZhLmxhbmcuYW5ub3RhdGlvbi5UYXJnZXQg
KEVsZW1lbnRUeXBlLlRZUEVfVVNFKVxuIik7CisJCWJ1Zi5hcHBlbmQoIkBpbnRlcmZhY2UgQW5u
b3Qge31cbiIpOworCQlidWYuYXBwZW5kKCJcbiIpOworCQlidWYuYXBwZW5kKCJAamF2YS5sYW5n
LmFubm90YXRpb24uVGFyZ2V0IChFbGVtZW50VHlwZS5UWVBFX1VTRSlcbiIpOworCQlidWYuYXBw
ZW5kKCJAaW50ZXJmYWNlIEFubm90MSB7fVxuIik7CisKKwkJSUNvbXBpbGF0aW9uVW5pdCBjdT0g
cGFjazEuY3JlYXRlQ29tcGlsYXRpb25Vbml0KCJYLmphdmEiLCBidWYudG9TdHJpbmcoKSwgZmFs
c2UsIG51bGwpOworCQlDb21waWxhdGlvblVuaXQgYXN0Um9vdD0gY3JlYXRlQVNUKGN1KTsKKwkJ
QVNUUmV3cml0ZSByZXdyaXRlPSBBU1RSZXdyaXRlLmNyZWF0ZShhc3RSb290LmdldEFTVCgpKTsK
KwkJQVNUIGFzdD0gYXN0Um9vdC5nZXRBU1QoKTsKKwkJVHlwZURlY2xhcmF0aW9uIHR5cGU9IGZp
bmRUeXBlRGVjbGFyYXRpb24oYXN0Um9vdCwgIlgiKTsKKwkJTWV0aG9kRGVjbGFyYXRpb24gbWV0
aG9kRGVjbGFyYXRpb249IGZpbmRNZXRob2REZWNsYXJhdGlvbih0eXBlLCAiZm9vIik7CisJCXsv
L0FkZCBhbiB1c2Ugb2YgYW5ub3RhdGlvbgorCQkJRXhwcmVzc2lvblN0YXRlbWVudCBleHByZXNz
aW9uU3RhdGVtZW50PSAoRXhwcmVzc2lvblN0YXRlbWVudCkgbWV0aG9kRGVjbGFyYXRpb24uZ2V0
Qm9keSgpLnN0YXRlbWVudHMoKS5nZXQoMik7CisJCQlBc3NpZ25tZW50IGFzc2lnbm1lbnQ9IChB
c3NpZ25tZW50KSBleHByZXNzaW9uU3RhdGVtZW50LmdldEV4cHJlc3Npb24oKTsKKwkJCUluc3Rh
bmNlb2ZFeHByZXNzaW9uIGluc3RhbmNlb2ZFeHByZXNzaW9uPSAoSW5zdGFuY2VvZkV4cHJlc3Np
b24pIGFzc2lnbm1lbnQuZ2V0UmlnaHRIYW5kU2lkZSgpOworCQkJU2ltcGxlVHlwZSBzaW1wbGVU
eXBlID0gKFNpbXBsZVR5cGUpIGluc3RhbmNlb2ZFeHByZXNzaW9uLmdldFJpZ2h0T3BlcmFuZCgp
OworCQkJTWFya2VyQW5ub3RhdGlvbiBtYXJrZXJBbm5vdGF0aW9uPSBhc3QubmV3TWFya2VyQW5u
b3RhdGlvbigpOworCQkJbWFya2VyQW5ub3RhdGlvbi5zZXRUeXBlTmFtZShhc3QubmV3U2ltcGxl
TmFtZSgiQW5ub3QyIikpOworCQkJcmV3cml0ZS5nZXRMaXN0UmV3cml0ZShzaW1wbGVUeXBlLCBT
aW1wbGVUeXBlLkFOTk9UQVRJT05TX1BST1BFUlRZKS5pbnNlcnRMYXN0KG1hcmtlckFubm90YXRp
b24sIG51bGwpOworCQl9CisJCXsKKwkJCUV4cHJlc3Npb25TdGF0ZW1lbnQgZXhwcmVzc2lvblN0
YXRlbWVudD0gKEV4cHJlc3Npb25TdGF0ZW1lbnQpIG1ldGhvZERlY2xhcmF0aW9uLmdldEJvZHko
KS5zdGF0ZW1lbnRzKCkuZ2V0KDMpOworCQkJQXNzaWdubWVudCBhc3NpZ25tZW50PSAoQXNzaWdu
bWVudCkgZXhwcmVzc2lvblN0YXRlbWVudC5nZXRFeHByZXNzaW9uKCk7CisJCQlJbnN0YW5jZW9m
RXhwcmVzc2lvbiBpbnN0YW5jZW9mRXhwcmVzc2lvbj0gKEluc3RhbmNlb2ZFeHByZXNzaW9uKSBh
c3NpZ25tZW50LmdldFJpZ2h0SGFuZFNpZGUoKTsKKwkJCVNpbXBsZVR5cGUgc2ltcGxlVHlwZSA9
IChTaW1wbGVUeXBlKSBpbnN0YW5jZW9mRXhwcmVzc2lvbi5nZXRSaWdodE9wZXJhbmQoKTsKKwkJ
CS8vUmVtb3ZlIGFuIHVzZSBvZiBhbm5vdGF0aW9uCisJCQlyZXdyaXRlLnJlbW92ZSgoTWFya2Vy
QW5ub3RhdGlvbikgc2ltcGxlVHlwZS5hbm5vdGF0aW9ucygpLmdldCgxKSwgbnVsbCk7CisJCQlN
YXJrZXJBbm5vdGF0aW9uIG1hcmtlckFubm90YXRpb249IGFzdC5uZXdNYXJrZXJBbm5vdGF0aW9u
KCk7CisJCQltYXJrZXJBbm5vdGF0aW9uLnNldFR5cGVOYW1lKGFzdC5uZXdTaW1wbGVOYW1lKCJB
bm5vdDIiKSk7CisJCQkvL1JlcGxhY2UgYW4gdXNlIG9mIGFubm90YXRpb24KKwkJCXJld3JpdGUu
cmVwbGFjZSgoTWFya2VyQW5ub3RhdGlvbikgc2ltcGxlVHlwZS5hbm5vdGF0aW9ucygpLmdldCgw
KSwgbWFya2VyQW5ub3RhdGlvbiwgbnVsbCk7CisJCX0KKwkJU3RyaW5nIHByZXZpZXc9IGV2YWx1
YXRlUmV3cml0ZShjdSwgcmV3cml0ZSk7CisJCWJ1ZiA9IG5ldyBTdHJpbmdCdWZmZXIoKTsKKwkJ
YnVmLmFwcGVuZCgiaW1wb3J0IGphdmEubGFuZy5hbm5vdGF0aW9uLkVsZW1lbnRUeXBlO1xuIik7
CisJCWJ1Zi5hcHBlbmQoIlxuIik7CisJCWJ1Zi5hcHBlbmQoInB1YmxpYyBjbGFzcyBYIHtcbiIp
OworCQlidWYuYXBwZW5kKCIJcHVibGljIGNsYXNzIEhlbHBlciB7XG4iKTsKKwkJYnVmLmFwcGVu
ZCgiCX1cbiIpOworCQlidWYuYXBwZW5kKCIJXG4iKTsKKwkJYnVmLmFwcGVuZCgiCXB1YmxpYyB2
b2lkIGZvbygpIHtcbiIpOworCQlidWYuYXBwZW5kKCIJSGVscGVyIGEgPSBuZXcgQEFubm90IEhl
bHBlcigpO1xuIik7CisJCWJ1Zi5hcHBlbmQoIglib29sZWFuIHggPSB0cnVlO1xuIik7CisJCWJ1
Zi5hcHBlbmQoIgl4ID0gYSBpbnN0YW5jZW9mIEBBbm5vdCBAQW5ub3QyIEhlbHBlcjtcbiIpOwor
CQlidWYuYXBwZW5kKCIJeCA9IGEgaW5zdGFuY2VvZiBAQW5ub3QyIEhlbHBlcjtcbiIpOworCQli
dWYuYXBwZW5kKCIJfVxuIik7CisJCWJ1Zi5hcHBlbmQoIn1cbiIpOworCQlidWYuYXBwZW5kKCJc
biIpOworCQlidWYuYXBwZW5kKCJAamF2YS5sYW5nLmFubm90YXRpb24uVGFyZ2V0IChFbGVtZW50
VHlwZS5UWVBFX1VTRSlcbiIpOworCQlidWYuYXBwZW5kKCJAaW50ZXJmYWNlIEFubm90IHt9XG4i
KTsKKwkJYnVmLmFwcGVuZCgiXG4iKTsKKwkJYnVmLmFwcGVuZCgiQGphdmEubGFuZy5hbm5vdGF0
aW9uLlRhcmdldCAoRWxlbWVudFR5cGUuVFlQRV9VU0UpXG4iKTsKKwkJYnVmLmFwcGVuZCgiQGlu
dGVyZmFjZSBBbm5vdDEge31cbiIpOworCQlhc3NlcnRFcXVhbFN0cmluZyhwcmV2aWV3LCBidWYu
dG9TdHJpbmcoKSk7CisJfQorCisJcHVibGljIHZvaWQgdGVzdENvbnN0cnVjdG9ySW52b2NhdGlv
bigpIHRocm93cyBFeGNlcHRpb24geworCQlpZiAodGhpcy5hcGlMZXZlbCA8IEFTVC5KTFM4KSBy
ZXR1cm47CisJCUlQYWNrYWdlRnJhZ21lbnQgcGFjazE9IHRoaXMuc291cmNlRm9sZGVyLmNyZWF0
ZVBhY2thZ2VGcmFnbWVudCgidGVzdDEiLCBmYWxzZSwgbnVsbCk7CisJCVN0cmluZ0J1ZmZlciBi
dWY9IG5ldyBTdHJpbmdCdWZmZXIoKTsKKwkJYnVmLmFwcGVuZCgiaW1wb3J0IGphdmEubGFuZy5h
bm5vdGF0aW9uLkVsZW1lbnRUeXBlO1xuIik7CisJCWJ1Zi5hcHBlbmQoIiBcbiIpOworCQlidWYu
YXBwZW5kKCJwdWJsaWMgY2xhc3MgWCB7XG4iKTsKKwkJYnVmLmFwcGVuZCgiCXB1YmxpYyBjbGFz
cyBIZWxwZXIge1xuIik7CisJCWJ1Zi5hcHBlbmQoIgl9CVxuIik7CisJCWJ1Zi5hcHBlbmQoIglw
dWJsaWMgdm9pZCBmb28oKSB7XG4iKTsKKwkJYnVmLmFwcGVuZCgiCQlIZWxwZXIgb2JqID0gbmV3
IEBBbm5vdCBIZWxwZXIoKTtcbiIpOworCQlidWYuYXBwZW5kKCIJCW9iaiA9IG5ldyBAQW5ub3Qg
QEFubm90MSBIZWxwZXIoKTtcbiIpOworCQlidWYuYXBwZW5kKCIJfVxuIik7CisJCWJ1Zi5hcHBl
bmQoIn1cbiIpOworCQlidWYuYXBwZW5kKCJcbiIpOworCQlidWYuYXBwZW5kKCJAamF2YS5sYW5n
LmFubm90YXRpb24uVGFyZ2V0IChFbGVtZW50VHlwZS5UWVBFX1VTRSlcbiIpOworCQlidWYuYXBw
ZW5kKCJAaW50ZXJmYWNlIEFubm90IHt9XG4iKTsKKwkJYnVmLmFwcGVuZCgiXG4iKTsKKwkJYnVm
LmFwcGVuZCgiQGphdmEubGFuZy5hbm5vdGF0aW9uLlRhcmdldCAoRWxlbWVudFR5cGUuVFlQRV9V
U0UpXG4iKTsKKwkJYnVmLmFwcGVuZCgiQGludGVyZmFjZSBBbm5vdDEge31cbiIpOworCisJCUlD
b21waWxhdGlvblVuaXQgY3U9IHBhY2sxLmNyZWF0ZUNvbXBpbGF0aW9uVW5pdCgiWC5qYXZhIiwg
YnVmLnRvU3RyaW5nKCksIGZhbHNlLCBudWxsKTsKKwkJQ29tcGlsYXRpb25Vbml0IGFzdFJvb3Q9
IGNyZWF0ZUFTVChjdSk7CisJCUFTVFJld3JpdGUgcmV3cml0ZT0gQVNUUmV3cml0ZS5jcmVhdGUo
YXN0Um9vdC5nZXRBU1QoKSk7CisJCUFTVCBhc3Q9IGFzdFJvb3QuZ2V0QVNUKCk7CisJCVR5cGVE
ZWNsYXJhdGlvbiB0eXBlPSBmaW5kVHlwZURlY2xhcmF0aW9uKGFzdFJvb3QsICJYIik7CisJCU1l
dGhvZERlY2xhcmF0aW9uIG1ldGhvZERlY2xhcmF0aW9uPSBmaW5kTWV0aG9kRGVjbGFyYXRpb24o
dHlwZSwgImZvbyIpOworCQlMaXN0IHN0YXRlbWVudHM9IG1ldGhvZERlY2xhcmF0aW9uLmdldEJv
ZHkoKS5zdGF0ZW1lbnRzKCk7CisJCXsvL0FkZCBhbiB1c2Ugb2YgYW5ub3RhdGlvbgorCQkJVmFy
aWFibGVEZWNsYXJhdGlvblN0YXRlbWVudCAgdmFyaWFibGVEZWNsYXJhdGlvblN0YXRlbWVudD0g
KFZhcmlhYmxlRGVjbGFyYXRpb25TdGF0ZW1lbnQpIHN0YXRlbWVudHMuZ2V0KDApOworCQkJVmFy
aWFibGVEZWNsYXJhdGlvbkZyYWdtZW50IHZhcmlhYmxlRGVjbGFyYXRpb25GcmFnbWVudD0gKFZh
cmlhYmxlRGVjbGFyYXRpb25GcmFnbWVudCkgdmFyaWFibGVEZWNsYXJhdGlvblN0YXRlbWVudC5m
cmFnbWVudHMoKS5nZXQoMCk7CisJCQlDbGFzc0luc3RhbmNlQ3JlYXRpb24gY2xhc3NJbnN0YW5j
ZUNyZWF0aW9uID0gKENsYXNzSW5zdGFuY2VDcmVhdGlvbikgdmFyaWFibGVEZWNsYXJhdGlvbkZy
YWdtZW50LmdldEluaXRpYWxpemVyKCk7CisJCQlTaW1wbGVUeXBlIHNpbXBsZVR5cGUgPSAoU2lt
cGxlVHlwZSkgY2xhc3NJbnN0YW5jZUNyZWF0aW9uLmdldFR5cGUoKTsKKwkJCU1hcmtlckFubm90
YXRpb24gbWFya2VyQW5ub3RhdGlvbj0gYXN0Lm5ld01hcmtlckFubm90YXRpb24oKTsKKwkJCW1h
cmtlckFubm90YXRpb24uc2V0VHlwZU5hbWUoYXN0Lm5ld1NpbXBsZU5hbWUoIkFubm90MiIpKTsK
KwkJCXJld3JpdGUuZ2V0TGlzdFJld3JpdGUoc2ltcGxlVHlwZSwgU2ltcGxlVHlwZS5BTk5PVEFU
SU9OU19QUk9QRVJUWSkuaW5zZXJ0TGFzdChtYXJrZXJBbm5vdGF0aW9uLCBudWxsKTsKKwkJfQor
CQl7CisJCQlFeHByZXNzaW9uU3RhdGVtZW50IGV4cHJlc3Npb25TdGF0ZW1lbnQ9IChFeHByZXNz
aW9uU3RhdGVtZW50KSBtZXRob2REZWNsYXJhdGlvbi5nZXRCb2R5KCkuc3RhdGVtZW50cygpLmdl
dCgxKTsKKwkJCUFzc2lnbm1lbnQgYXNzaWdubWVudD0gKEFzc2lnbm1lbnQpIGV4cHJlc3Npb25T
dGF0ZW1lbnQuZ2V0RXhwcmVzc2lvbigpOworCQkJQ2xhc3NJbnN0YW5jZUNyZWF0aW9uIGNsYXNz
SW5zdGFuY2VDcmVhdGlvbiA9IChDbGFzc0luc3RhbmNlQ3JlYXRpb24pIGFzc2lnbm1lbnQuZ2V0
UmlnaHRIYW5kU2lkZSgpOworCQkJU2ltcGxlVHlwZSBzaW1wbGVUeXBlID0gKFNpbXBsZVR5cGUp
IGNsYXNzSW5zdGFuY2VDcmVhdGlvbi5nZXRUeXBlKCk7CisJCQkvL1JlbW92ZSBhbiB1c2Ugb2Yg
YW5ub3RhdGlvbgorCQkJcmV3cml0ZS5yZW1vdmUoKE1hcmtlckFubm90YXRpb24pIHNpbXBsZVR5
cGUuYW5ub3RhdGlvbnMoKS5nZXQoMSksIG51bGwpOworCQkJTWFya2VyQW5ub3RhdGlvbiBtYXJr
ZXJBbm5vdGF0aW9uPSBhc3QubmV3TWFya2VyQW5ub3RhdGlvbigpOworCQkJbWFya2VyQW5ub3Rh
dGlvbi5zZXRUeXBlTmFtZShhc3QubmV3U2ltcGxlTmFtZSgiQW5ub3QyIikpOworCQkJLy9SZXBs
YWNlIGFuIHVzZSBvZiBhbm5vdGF0aW9uCisJCQlyZXdyaXRlLnJlcGxhY2UoKE1hcmtlckFubm90
YXRpb24pIHNpbXBsZVR5cGUuYW5ub3RhdGlvbnMoKS5nZXQoMCksIG1hcmtlckFubm90YXRpb24s
IG51bGwpOworCQl9CisJCVN0cmluZyBwcmV2aWV3PSBldmFsdWF0ZVJld3JpdGUoY3UsIHJld3Jp
dGUpOworCQlidWYgPSBuZXcgU3RyaW5nQnVmZmVyKCk7CisJCWJ1Zi5hcHBlbmQoImltcG9ydCBq
YXZhLmxhbmcuYW5ub3RhdGlvbi5FbGVtZW50VHlwZTtcbiIpOworCQlidWYuYXBwZW5kKCIgXG4i
KTsKKwkJYnVmLmFwcGVuZCgicHVibGljIGNsYXNzIFgge1xuIik7CisJCWJ1Zi5hcHBlbmQoIglw
dWJsaWMgY2xhc3MgSGVscGVyIHtcbiIpOworCQlidWYuYXBwZW5kKCIJfQlcbiIpOworCQlidWYu
YXBwZW5kKCIJcHVibGljIHZvaWQgZm9vKCkge1xuIik7CisJCWJ1Zi5hcHBlbmQoIgkJSGVscGVy
IG9iaiA9IG5ldyBAQW5ub3QgQEFubm90MiBIZWxwZXIoKTtcbiIpOworCQlidWYuYXBwZW5kKCIJ
CW9iaiA9IG5ldyBAQW5ub3QyIEhlbHBlcigpO1xuIik7CisJCWJ1Zi5hcHBlbmQoIgl9XG4iKTsK
KwkJYnVmLmFwcGVuZCgifVxuIik7CisJCWJ1Zi5hcHBlbmQoIlxuIik7CisJCWJ1Zi5hcHBlbmQo
IkBqYXZhLmxhbmcuYW5ub3RhdGlvbi5UYXJnZXQgKEVsZW1lbnRUeXBlLlRZUEVfVVNFKVxuIik7
CisJCWJ1Zi5hcHBlbmQoIkBpbnRlcmZhY2UgQW5ub3Qge31cbiIpOworCQlidWYuYXBwZW5kKCJc
biIpOworCQlidWYuYXBwZW5kKCJAamF2YS5sYW5nLmFubm90YXRpb24uVGFyZ2V0IChFbGVtZW50
VHlwZS5UWVBFX1VTRSlcbiIpOworCQlidWYuYXBwZW5kKCJAaW50ZXJmYWNlIEFubm90MSB7fVxu
Iik7CisJCWFzc2VydEVxdWFsU3RyaW5nKHByZXZpZXcsIGJ1Zi50b1N0cmluZygpKTsKKwl9CisK
KwlwdWJsaWMgdm9pZCB0ZXN0Q29uc3RydWN0b3JEZWNsYXJhdGlvbigpIHRocm93cyBFeGNlcHRp
b24geworCQlpZiAodGhpcy5hcGlMZXZlbCA8IEFTVC5KTFM4KSByZXR1cm47CisJCUlQYWNrYWdl
RnJhZ21lbnQgcGFjazE9IHRoaXMuc291cmNlRm9sZGVyLmNyZWF0ZVBhY2thZ2VGcmFnbWVudCgi
dGVzdDEiLCBmYWxzZSwgbnVsbCk7CisJCVN0cmluZ0J1ZmZlciBidWY9IG5ldyBTdHJpbmdCdWZm
ZXIoKTsKKwkJYnVmLmFwcGVuZCgiaW1wb3J0IGphdmEubGFuZy5hbm5vdGF0aW9uLkVsZW1lbnRU
eXBlO1xuIik7CisJCWJ1Zi5hcHBlbmQoIlxuIik7CisJCWJ1Zi5hcHBlbmQoInB1YmxpYyBjbGFz
cyBYIHtcbiIpOworCQlidWYuYXBwZW5kKCIJQEFubm90IFggKCkge1xuIik7CisJCWJ1Zi5hcHBl
bmQoIgl9XG4iKTsKKwkJYnVmLmFwcGVuZCgiCUBBbm5vdCBAQW5ub3QxIFggKGludCB4KSB7XG4i
KTsKKwkJYnVmLmFwcGVuZCgiCX1cbiIpOworCQlidWYuYXBwZW5kKCJ9XG4iKTsKKwkJYnVmLmFw
cGVuZCgiXG4iKTsKKwkJYnVmLmFwcGVuZCgiQGphdmEubGFuZy5hbm5vdGF0aW9uLlRhcmdldCAo
RWxlbWVudFR5cGUuVFlQRV9VU0UpXG4iKTsKKwkJYnVmLmFwcGVuZCgiQGludGVyZmFjZSBBbm5v
dCB7fVxuIik7CisJCWJ1Zi5hcHBlbmQoIlxuIik7CisJCWJ1Zi5hcHBlbmQoIkBqYXZhLmxhbmcu
YW5ub3RhdGlvbi5UYXJnZXQgKEVsZW1lbnRUeXBlLlRZUEVfVVNFKVxuIik7CisJCWJ1Zi5hcHBl
bmQoIkBpbnRlcmZhY2UgQW5ub3QxIHt9XG4iKTsKKworCQlJQ29tcGlsYXRpb25Vbml0IGN1PSBw
YWNrMS5jcmVhdGVDb21waWxhdGlvblVuaXQoIlguamF2YSIsIGJ1Zi50b1N0cmluZygpLCBmYWxz
ZSwgbnVsbCk7CisJCUNvbXBpbGF0aW9uVW5pdCBhc3RSb290PSBjcmVhdGVBU1QoY3UpOworCQlB
U1RSZXdyaXRlIHJld3JpdGU9IEFTVFJld3JpdGUuY3JlYXRlKGFzdFJvb3QuZ2V0QVNUKCkpOwor
CQlBU1QgYXN0PSBhc3RSb290LmdldEFTVCgpOworCQlUeXBlRGVjbGFyYXRpb24gdHlwZT0gZmlu
ZFR5cGVEZWNsYXJhdGlvbihhc3RSb290LCAiWCIpOworCQl7Ly9BZGQgdGhlIHVzZSBvZiBhbm5v
dGF0aW9uCisJCQlNZXRob2REZWNsYXJhdGlvbiBtZXRob2REZWNsYXJhdGlvbj0gKE1ldGhvZERl
Y2xhcmF0aW9uKSB0eXBlLmJvZHlEZWNsYXJhdGlvbnMoKS5nZXQoMCk7CisJCQlNYXJrZXJBbm5v
dGF0aW9uIG1hcmtlckFubm90YXRpb249IGFzdC5uZXdNYXJrZXJBbm5vdGF0aW9uKCk7CisJCQlt
YXJrZXJBbm5vdGF0aW9uLnNldFR5cGVOYW1lKGFzdC5uZXdTaW1wbGVOYW1lKCJBbm5vdDIiKSk7
CisJCQlyZXdyaXRlLmdldExpc3RSZXdyaXRlKG1ldGhvZERlY2xhcmF0aW9uLCBNZXRob2REZWNs
YXJhdGlvbi5NT0RJRklFUlMyX1BST1BFUlRZKS5pbnNlcnRMYXN0KG1hcmtlckFubm90YXRpb24s
IG51bGwpOworCQl9CisJCXsKKwkJCS8vUmVtb3ZlIHRoZSB1c2Ugb2YgYW5ub3RhdGlvbgorCQkJ
TWV0aG9kRGVjbGFyYXRpb24gbWV0aG9kRGVjbGFyYXRpb249IChNZXRob2REZWNsYXJhdGlvbikg
dHlwZS5ib2R5RGVjbGFyYXRpb25zKCkuZ2V0KDEpOworCQkJcmV3cml0ZS5yZW1vdmUoKE1hcmtl
ckFubm90YXRpb24pIG1ldGhvZERlY2xhcmF0aW9uLm1vZGlmaWVycygpLmdldCgxKSwgbnVsbCk7
CisJCQkvL1JlcGxhY2UgdGhlIHVzZSBvZiBhbm5vdGF0aW9uCisJCQlNYXJrZXJBbm5vdGF0aW9u
IG1hcmtlckFubm90YXRpb249IGFzdC5uZXdNYXJrZXJBbm5vdGF0aW9uKCk7CisJCQltYXJrZXJB
bm5vdGF0aW9uLnNldFR5cGVOYW1lKGFzdC5uZXdTaW1wbGVOYW1lKCJBbm5vdDIiKSk7CisJCQly
ZXdyaXRlLnJlcGxhY2UoKE1hcmtlckFubm90YXRpb24pIG1ldGhvZERlY2xhcmF0aW9uLm1vZGlm
aWVycygpLmdldCgwKSwgbWFya2VyQW5ub3RhdGlvbiwgbnVsbCk7CisJCX0KKwkJU3RyaW5nIHBy
ZXZpZXc9IGV2YWx1YXRlUmV3cml0ZShjdSwgcmV3cml0ZSk7CisJCWJ1ZiA9IG5ldyBTdHJpbmdC
dWZmZXIoKTsKKwkJYnVmLmFwcGVuZCgiaW1wb3J0IGphdmEubGFuZy5hbm5vdGF0aW9uLkVsZW1l
bnRUeXBlO1xuIik7CisJCWJ1Zi5hcHBlbmQoIlxuIik7CisJCWJ1Zi5hcHBlbmQoInB1YmxpYyBj
bGFzcyBYIHtcbiIpOworCQlidWYuYXBwZW5kKCIJQEFubm90XG4iKTsKKwkJYnVmLmFwcGVuZCgi
ICAgIEBBbm5vdDIgWCAoKSB7XG4iKTsKKwkJYnVmLmFwcGVuZCgiCX1cbiIpOworCQlidWYuYXBw
ZW5kKCIJQEFubm90MiBYIChpbnQgeCkge1xuIik7CisJCWJ1Zi5hcHBlbmQoIgl9XG4iKTsKKwkJ
YnVmLmFwcGVuZCgifVxuIik7CisJCWJ1Zi5hcHBlbmQoIlxuIik7CisJCWJ1Zi5hcHBlbmQoIkBq
YXZhLmxhbmcuYW5ub3RhdGlvbi5UYXJnZXQgKEVsZW1lbnRUeXBlLlRZUEVfVVNFKVxuIik7CisJ
CWJ1Zi5hcHBlbmQoIkBpbnRlcmZhY2UgQW5ub3Qge31cbiIpOworCQlidWYuYXBwZW5kKCJcbiIp
OworCQlidWYuYXBwZW5kKCJAamF2YS5sYW5nLmFubm90YXRpb24uVGFyZ2V0IChFbGVtZW50VHlw
ZS5UWVBFX1VTRSlcbiIpOworCQlidWYuYXBwZW5kKCJAaW50ZXJmYWNlIEFubm90MSB7fVxuIik7
CisJCWFzc2VydEVxdWFsU3RyaW5nKHByZXZpZXcsIGJ1Zi50b1N0cmluZygpKTsKKwl9CisKKwlw
dWJsaWMgdm9pZCB0ZXN0UmV3cml0ZUluc2VydEFQSUFubm90YXRpb24oKSB0aHJvd3MgRXhjZXB0
aW9uIHsKKwkJaWYgKHRoaXMuYXBpTGV2ZWwgPCBBU1QuSkxTOCkgcmV0dXJuOworCQlJUGFja2Fn
ZUZyYWdtZW50IHBhY2sxPSB0aGlzLnNvdXJjZUZvbGRlci5jcmVhdGVQYWNrYWdlRnJhZ21lbnQo
InRlc3QxIiwgZmFsc2UsIG51bGwpOworCQlTdHJpbmdCdWZmZXIgYnVmPSBuZXcgU3RyaW5nQnVm
ZmVyKCk7CisKKwkJYnVmLmFwcGVuZCgiaW1wb3J0IGphdmEubGFuZy5hbm5vdGF0aW9uLkVsZW1l
bnRUeXBlO1xuIik7CisJCWJ1Zi5hcHBlbmQoIlxuIik7CisJCWJ1Zi5hcHBlbmQoInB1YmxpYyBj
bGFzcyBYIHtcbiIpOworCQlidWYuYXBwZW5kKCIJcHVibGljIGNsYXNzIEhlbHBlciA8VDEsIFQy
PiB7XG4iKTsKKwkJYnVmLmFwcGVuZCgiCX1cbiIpOworCQlidWYuYXBwZW5kKCIJcHVibGljIHZv
aWQgZm9vKCkge1xuIik7CisJCWJ1Zi5hcHBlbmQoIgkJSGVscGVyPEBBbm5vdCBAQW5ub3QxIFN0
cmluZz4geDtcbiIpOworCQlidWYuYXBwZW5kKCIJfVxuIik7CisJCWJ1Zi5hcHBlbmQoIn1cbiIp
OworCQlidWYuYXBwZW5kKCJcbiIpOworCQlidWYuYXBwZW5kKCJAamF2YS5sYW5nLmFubm90YXRp
b24uVGFyZ2V0IChFbGVtZW50VHlwZS5UWVBFX1VTRSkgXG4iKTsKKwkJYnVmLmFwcGVuZCgiQGlu
dGVyZmFjZSBBbm5vdCB7fVxuIik7CisJCWJ1Zi5hcHBlbmQoIlxuIik7CisJCWJ1Zi5hcHBlbmQo
IkBqYXZhLmxhbmcuYW5ub3RhdGlvbi5UYXJnZXQgKEVsZW1lbnRUeXBlLlRZUEVfVVNFKSBcbiIp
OworCQlidWYuYXBwZW5kKCJAaW50ZXJmYWNlIEFubm90MSB7fVxuIik7CisKKwkJSUNvbXBpbGF0
aW9uVW5pdCBjdT0gcGFjazEuY3JlYXRlQ29tcGlsYXRpb25Vbml0KCJYLmphdmEiLCBidWYudG9T
dHJpbmcoKSwgZmFsc2UsIG51bGwpOworCQlDb21waWxhdGlvblVuaXQgYXN0Um9vdD0gY3JlYXRl
QVNUKGN1KTsKKwkJQVNUUmV3cml0ZSByZXdyaXRlPSBBU1RSZXdyaXRlLmNyZWF0ZShhc3RSb290
LmdldEFTVCgpKTsKKwkJQVNUIGFzdD0gYXN0Um9vdC5nZXRBU1QoKTsKKwkJVHlwZURlY2xhcmF0
aW9uIHR5cGU9IGZpbmRUeXBlRGVjbGFyYXRpb24oYXN0Um9vdCwgIlgiKTsKKwkJTWV0aG9kRGVj
bGFyYXRpb24gbWV0aG9kRGVjbGFyYXRpb249IGZpbmRNZXRob2REZWNsYXJhdGlvbih0eXBlLCAi
Zm9vIik7CisJCUxpc3Qgc3RhdGVtZW50cz0gbWV0aG9kRGVjbGFyYXRpb24uZ2V0Qm9keSgpLnN0
YXRlbWVudHMoKTsKKwkJVmFyaWFibGVEZWNsYXJhdGlvblN0YXRlbWVudCB2YXJpYWJsZURlY2xh
cmF0aW9uU3RhdGVtZW50PSAoVmFyaWFibGVEZWNsYXJhdGlvblN0YXRlbWVudCkgc3RhdGVtZW50
cy5nZXQoMCk7CisJCVBhcmFtZXRlcml6ZWRUeXBlIHBhcmFtZXRlcml6ZWRUeXBlPSAoUGFyYW1l
dGVyaXplZFR5cGUpIHZhcmlhYmxlRGVjbGFyYXRpb25TdGF0ZW1lbnQuZ2V0VHlwZSgpOworCQl7
CisJCQlTaW1wbGVUeXBlIHNpbXBsZVR5cGU9IChTaW1wbGVUeXBlKSBwYXJhbWV0ZXJpemVkVHlw
ZS50eXBlQXJndW1lbnRzKCkuZ2V0KDApOworCQkJLy9JbnNlcnQgZmlyc3QKKwkJCU1hcmtlckFu
bm90YXRpb24gbWFya2VyQW5ub3RhdGlvbj0gYXN0Lm5ld01hcmtlckFubm90YXRpb24oKTsKKwkJ
CW1hcmtlckFubm90YXRpb24uc2V0VHlwZU5hbWUoYXN0Lm5ld1NpbXBsZU5hbWUoIkFubm90MiIp
KTsKKwkJCXJld3JpdGUuZ2V0TGlzdFJld3JpdGUoc2ltcGxlVHlwZSwgU2ltcGxlVHlwZS5BTk5P
VEFUSU9OU19QUk9QRVJUWSkuaW5zZXJ0Rmlyc3QobWFya2VyQW5ub3RhdGlvbiwgbnVsbCk7CisK
KwkJCS8vSW5zZXJ0QXQKKwkJCW1hcmtlckFubm90YXRpb249IGFzdC5uZXdNYXJrZXJBbm5vdGF0
aW9uKCk7CisJCQltYXJrZXJBbm5vdGF0aW9uLnNldFR5cGVOYW1lKGFzdC5uZXdTaW1wbGVOYW1l
KCJBbm5vdDMiKSk7CisJCQlyZXdyaXRlLmdldExpc3RSZXdyaXRlKHNpbXBsZVR5cGUsIFNpbXBs
ZVR5cGUuQU5OT1RBVElPTlNfUFJPUEVSVFkpLmluc2VydEF0KG1hcmtlckFubm90YXRpb24sIDEs
IG51bGwpOworCisJCQkvL0luc2VydCBhZnRlcgorCQkJbWFya2VyQW5ub3RhdGlvbj0gYXN0Lm5l
d01hcmtlckFubm90YXRpb24oKTsKKwkJCW1hcmtlckFubm90YXRpb24uc2V0VHlwZU5hbWUoYXN0
Lm5ld1NpbXBsZU5hbWUoIkFubm90NCIpKTsKKwkJCXJld3JpdGUuZ2V0TGlzdFJld3JpdGUoc2lt
cGxlVHlwZSwgU2ltcGxlVHlwZS5BTk5PVEFUSU9OU19QUk9QRVJUWSkuaW5zZXJ0QWZ0ZXIobWFy
a2VyQW5ub3RhdGlvbiwgKE1hcmtlckFubm90YXRpb24pIHNpbXBsZVR5cGUuYW5ub3RhdGlvbnMo
KS5nZXQoMSksIG51bGwpOworCisJCQkvL0luc2VydCBiZWZvcmUKKwkJCW1hcmtlckFubm90YXRp
b249IGFzdC5uZXdNYXJrZXJBbm5vdGF0aW9uKCk7CisJCQltYXJrZXJBbm5vdGF0aW9uLnNldFR5
cGVOYW1lKGFzdC5uZXdTaW1wbGVOYW1lKCJBbm5vdDUiKSk7CisJCQlyZXdyaXRlLmdldExpc3RS
ZXdyaXRlKHNpbXBsZVR5cGUsIFNpbXBsZVR5cGUuQU5OT1RBVElPTlNfUFJPUEVSVFkpLmluc2Vy
dEJlZm9yZShtYXJrZXJBbm5vdGF0aW9uLCAoTWFya2VyQW5ub3RhdGlvbikgc2ltcGxlVHlwZS5h
bm5vdGF0aW9ucygpLmdldCgxKSwgbnVsbCk7CisJCX0KKwkJU3RyaW5nIHByZXZpZXc9IGV2YWx1
YXRlUmV3cml0ZShjdSwgcmV3cml0ZSk7CisJCWJ1ZiA9IG5ldyBTdHJpbmdCdWZmZXIoKTsKKwkJ
YnVmLmFwcGVuZCgiaW1wb3J0IGphdmEubGFuZy5hbm5vdGF0aW9uLkVsZW1lbnRUeXBlO1xuIik7
CisJCWJ1Zi5hcHBlbmQoIlxuIik7CisJCWJ1Zi5hcHBlbmQoInB1YmxpYyBjbGFzcyBYIHtcbiIp
OworCQlidWYuYXBwZW5kKCIJcHVibGljIGNsYXNzIEhlbHBlciA8VDEsIFQyPiB7XG4iKTsKKwkJ
YnVmLmFwcGVuZCgiCX1cbiIpOworCQlidWYuYXBwZW5kKCIJcHVibGljIHZvaWQgZm9vKCkge1xu
Iik7CisJCWJ1Zi5hcHBlbmQoIgkJSGVscGVyPEBBbm5vdDIgQEFubm90MyBAQW5ub3QgQEFubm90
NSBAQW5ub3QxIEBBbm5vdDQgU3RyaW5nPiB4O1xuIik7CisJCWJ1Zi5hcHBlbmQoIgl9XG4iKTsK
KwkJYnVmLmFwcGVuZCgifVxuIik7CisJCWJ1Zi5hcHBlbmQoIlxuIik7CisJCWJ1Zi5hcHBlbmQo
IkBqYXZhLmxhbmcuYW5ub3RhdGlvbi5UYXJnZXQgKEVsZW1lbnRUeXBlLlRZUEVfVVNFKSBcbiIp
OworCQlidWYuYXBwZW5kKCJAaW50ZXJmYWNlIEFubm90IHt9XG4iKTsKKwkJYnVmLmFwcGVuZCgi
XG4iKTsKKwkJYnVmLmFwcGVuZCgiQGphdmEubGFuZy5hbm5vdGF0aW9uLlRhcmdldCAoRWxlbWVu
dFR5cGUuVFlQRV9VU0UpIFxuIik7CisJCWJ1Zi5hcHBlbmQoIkBpbnRlcmZhY2UgQW5ub3QxIHt9
XG4iKTsKKwkJYXNzZXJ0RXF1YWxTdHJpbmcocHJldmlldywgYnVmLnRvU3RyaW5nKCkpOworCX0K
KworCXB1YmxpYyB2b2lkIF90ZXN0RW1wdHlMaXN0SW5zZXJ0QW5ub3RhdGlvbigpIHRocm93cyBF
eGNlcHRpb24geworCQlpZiAodGhpcy5hcGlMZXZlbCA8IEFTVC5KTFM4KSByZXR1cm47CisJCUlQ
YWNrYWdlRnJhZ21lbnQgcGFjazE9IHRoaXMuc291cmNlRm9sZGVyLmNyZWF0ZVBhY2thZ2VGcmFn
bWVudCgidGVzdDEiLCBmYWxzZSwgbnVsbCk7CisJCVN0cmluZ0J1ZmZlciBidWY9IG5ldyBTdHJp
bmdCdWZmZXIoKTsKKwkJYnVmLmFwcGVuZCgicGFja2FnZSB0ZXN0MTtcbiIpOworCQlidWYuYXBw
ZW5kKCJwdWJsaWMgY2xhc3MgWCB7XG4iKTsKKwkJYnVmLmFwcGVuZCgiCVN0cmluZyBteU9iamVj
dCA9IFwiRm9vXCI7XG4iKTsKKwkJYnVmLmFwcGVuZCgiCXB1YmxpYyB2b2lkIGZvbygpIHtcbiIp
OworCQlidWYuYXBwZW5kKCIJCVN0cmluZyBteVN0cmluZyA9IChTdHJpbmcpIG15T2JqZWN0O1xu
Iik7CisJCWJ1Zi5hcHBlbmQoIgl9XG4iKTsKKwkJYnVmLmFwcGVuZCgifVxuIik7CisKKwkJSUNv
bXBpbGF0aW9uVW5pdCBjdT0gcGFjazEuY3JlYXRlQ29tcGlsYXRpb25Vbml0KCJYLmphdmEiLCBi
dWYudG9TdHJpbmcoKSwgZmFsc2UsIG51bGwpOworCQlDb21waWxhdGlvblVuaXQgYXN0Um9vdD0g
Y3JlYXRlQVNUKGN1KTsKKwkJQVNUUmV3cml0ZSByZXdyaXRlPSBBU1RSZXdyaXRlLmNyZWF0ZShh
c3RSb290LmdldEFTVCgpKTsKKwkJQVNUIGFzdD0gYXN0Um9vdC5nZXRBU1QoKTsKKwkJVHlwZURl
Y2xhcmF0aW9uIHR5cGU9IGZpbmRUeXBlRGVjbGFyYXRpb24oYXN0Um9vdCwgIlgiKTsKKwkJTWV0
aG9kRGVjbGFyYXRpb24gbWV0aG9kRGVjbGFyYXRpb249IGZpbmRNZXRob2REZWNsYXJhdGlvbih0
eXBlLCAiZm9vIik7CisJCUxpc3Qgc3RhdGVtZW50cz0gbWV0aG9kRGVjbGFyYXRpb24uZ2V0Qm9k
eSgpLnN0YXRlbWVudHMoKTsKKwkJey8vQWRkIGFuIHVzZSBvZiBhbm5vdGF0aW9uLgorCQkJVmFy
aWFibGVEZWNsYXJhdGlvblN0YXRlbWVudCAgdmFyaWFibGVEZWNsYXJhdGlvblN0YXRlbWVudD0g
KFZhcmlhYmxlRGVjbGFyYXRpb25TdGF0ZW1lbnQpIHN0YXRlbWVudHMuZ2V0KDApOworCQkJVmFy
aWFibGVEZWNsYXJhdGlvbkZyYWdtZW50IHZhcmlhYmxlRGVjbGFyYXRpb25GcmFnbWVudD0gKFZh
cmlhYmxlRGVjbGFyYXRpb25GcmFnbWVudCkgdmFyaWFibGVEZWNsYXJhdGlvblN0YXRlbWVudC5m
cmFnbWVudHMoKS5nZXQoMCk7CisJCQlDYXN0RXhwcmVzc2lvbiBjYXN0RXhwcmVzc2lvbj0gKENh
c3RFeHByZXNzaW9uKSB2YXJpYWJsZURlY2xhcmF0aW9uRnJhZ21lbnQuZ2V0SW5pdGlhbGl6ZXIo
KTsKKwkJCVNpbXBsZVR5cGUgc2ltcGxlVHlwZT0gKFNpbXBsZVR5cGUpIGNhc3RFeHByZXNzaW9u
LmdldFR5cGUoKTsKKwkJCU1hcmtlckFubm90YXRpb24gbWFya2VyQW5ub3RhdGlvbj0gYXN0Lm5l
d01hcmtlckFubm90YXRpb24oKTsKKwkJCW1hcmtlckFubm90YXRpb24uc2V0VHlwZU5hbWUoYXN0
Lm5ld1NpbXBsZU5hbWUoIkFubm90IikpOworCQkJcmV3cml0ZS5nZXRMaXN0UmV3cml0ZShzaW1w
bGVUeXBlLCBTaW1wbGVUeXBlLkFOTk9UQVRJT05TX1BST1BFUlRZKS5pbnNlcnRMYXN0KG1hcmtl
ckFubm90YXRpb24sIG51bGwpOworCQl9CisJCVN0cmluZyBwcmV2aWV3PSBldmFsdWF0ZVJld3Jp
dGUoY3UsIHJld3JpdGUpOworCQlidWY9IG5ldyBTdHJpbmdCdWZmZXIoKTsKKwkJYnVmLmFwcGVu
ZCgicGFja2FnZSB0ZXN0MTtcbiIpOworCQlidWYuYXBwZW5kKCJwdWJsaWMgY2xhc3MgWCB7XG4i
KTsKKwkJYnVmLmFwcGVuZCgiCVN0cmluZyBteU9iamVjdCA9IFwiRm9vXCI7XG4iKTsKKwkJYnVm
LmFwcGVuZCgiCXB1YmxpYyB2b2lkIGZvbygpIHtcbiIpOworCQlidWYuYXBwZW5kKCIJCVN0cmlu
ZyBteVN0cmluZyA9IChAQW5ub3QgU3RyaW5nKSBteU9iamVjdDtcbiIpOy8vQWN0dWFsOiBTdHJp
bmcgbXlTdHJpbmcgPSAoIEBBbm5vdFN0cmluZykgbXlPYmplY3Q7CisJCWJ1Zi5hcHBlbmQoIgl9
XG4iKTsKKwkJYnVmLmFwcGVuZCgifVxuIik7CisJCWFzc2VydEVxdWFsU3RyaW5nKHByZXZpZXcs
IGJ1Zi50b1N0cmluZygpKTsKKwl9CisKK30K
</data>

          </attachment>
          <attachment
              isobsolete="0"
              ispatch="1"
              isprivate="0"
          >
            <attachid>229319</attachid>
            <date>2013-04-04 05:43:00 -0400</date>
            <delta_ts>2013-04-04 05:43:35 -0400</delta_ts>
            <desc>New patch to ensure the test cases are part of test suite ASTRewritingTest.java</desc>
            <filename>patch.txt</filename>
            <type>text/plain</type>
            <size>43366</size>
            <attacher name="shankha banerjee">shankhba</attacher>
            
              <data encoding="base64">ZGlmZiAtLWdpdCBhL29yZy5lY2xpcHNlLmpkdC5jb3JlLnRlc3RzLm1vZGVsL3NyYy9vcmcvZWNs
aXBzZS9qZHQvY29yZS90ZXN0cy9yZXdyaXRlL2Rlc2NyaWJpbmcvQVNUUmV3cml0aW5nVGVzdC5q
YXZhIGIvb3JnLmVjbGlwc2UuamR0LmNvcmUudGVzdHMubW9kZWwvc3JjL29yZy9lY2xpcHNlL2pk
dC9jb3JlL3Rlc3RzL3Jld3JpdGUvZGVzY3JpYmluZy9BU1RSZXdyaXRpbmdUZXN0LmphdmEKaW5k
ZXggNTE3OWJhZi4uZGFjMmExZSAxMDA2NDQKLS0tIGEvb3JnLmVjbGlwc2UuamR0LmNvcmUudGVz
dHMubW9kZWwvc3JjL29yZy9lY2xpcHNlL2pkdC9jb3JlL3Rlc3RzL3Jld3JpdGUvZGVzY3JpYmlu
Zy9BU1RSZXdyaXRpbmdUZXN0LmphdmEKKysrIGIvb3JnLmVjbGlwc2UuamR0LmNvcmUudGVzdHMu
bW9kZWwvc3JjL29yZy9lY2xpcHNlL2pkdC9jb3JlL3Rlc3RzL3Jld3JpdGUvZGVzY3JpYmluZy9B
U1RSZXdyaXRpbmdUZXN0LmphdmEKQEAgLTEwNiw2ICsxMDYsNyBAQCBwdWJsaWMgY2xhc3MgQVNU
UmV3cml0aW5nVGVzdCBleHRlbmRzIEFic3RyYWN0SmF2YU1vZGVsVGVzdHMgewogCQlzdWl0ZS5h
ZGRUZXN0KEFTVFJld3JpdGluZ1N0YXRlbWVudHNUZXN0LnN1aXRlKCkpOwogCQlzdWl0ZS5hZGRU
ZXN0KEFTVFJld3JpdGluZ1RyYWNraW5nVGVzdC5zdWl0ZSgpKTsKIAkJc3VpdGUuYWRkVGVzdChB
U1RSZXdyaXRpbmdKYXZhZG9jVGVzdC5zdWl0ZSgpKTsKKwkJc3VpdGUuYWRkVGVzdChBU1RSZXdy
aXRpbmdUeXBlQW5ub3RhdGlvbnNUZXN0LnN1aXRlKCkpOwogCQlzdWl0ZS5hZGRUZXN0KEFTVFJl
d3JpdGluZ1R5cGVEZWNsVGVzdC5zdWl0ZSgpKTsKIAkJc3VpdGUuYWRkVGVzdChBU1RSZXdyaXRp
bmdHcm91cE5vZGVUZXN0LnN1aXRlKCkpOwogCQlzdWl0ZS5hZGRUZXN0KEFTVFJld3JpdGluZ1Jl
dmVydFRlc3Quc3VpdGUoKSk7CmRpZmYgLS1naXQgYS9vcmcuZWNsaXBzZS5qZHQuY29yZS50ZXN0
cy5tb2RlbC9zcmMvb3JnL2VjbGlwc2UvamR0L2NvcmUvdGVzdHMvcmV3cml0ZS9kZXNjcmliaW5n
L0FTVFJld3JpdGluZ1R5cGVBbm5vdGF0aW9uc1Rlc3QuamF2YSBiL29yZy5lY2xpcHNlLmpkdC5j
b3JlLnRlc3RzLm1vZGVsL3NyYy9vcmcvZWNsaXBzZS9qZHQvY29yZS90ZXN0cy9yZXdyaXRlL2Rl
c2NyaWJpbmcvQVNUUmV3cml0aW5nVHlwZUFubm90YXRpb25zVGVzdC5qYXZhCm5ldyBmaWxlIG1v
ZGUgMTAwNjQ0CmluZGV4IDAwMDAwMDAuLjkxNTUyNjgKLS0tIC9kZXYvbnVsbAorKysgYi9vcmcu
ZWNsaXBzZS5qZHQuY29yZS50ZXN0cy5tb2RlbC9zcmMvb3JnL2VjbGlwc2UvamR0L2NvcmUvdGVz
dHMvcmV3cml0ZS9kZXNjcmliaW5nL0FTVFJld3JpdGluZ1R5cGVBbm5vdGF0aW9uc1Rlc3QuamF2
YQpAQCAtMCwwICsxLDg2MyBAQAorLyoqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioq
KioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioKKyAqIENvcHlyaWdo
dCAoYykgMjAxMyBJQk0gQ29ycG9yYXRpb24gYW5kIG90aGVycy4KKyAqIEFsbCByaWdodHMgcmVz
ZXJ2ZWQuIFRoaXMgcHJvZ3JhbSBhbmQgdGhlIGFjY29tcGFueWluZyBtYXRlcmlhbHMKKyAqIGFy
ZSBtYWRlIGF2YWlsYWJsZSB1bmRlciB0aGUgdGVybXMgb2YgdGhlIEVjbGlwc2UgUHVibGljIExp
Y2Vuc2UgdjEuMAorICogd2hpY2ggYWNjb21wYW5pZXMgdGhpcyBkaXN0cmlidXRpb24sIGFuZCBp
cyBhdmFpbGFibGUgYXQKKyAqIGh0dHA6Ly93d3cuZWNsaXBzZS5vcmcvbGVnYWwvZXBsLXYxMC5o
dG1sCisgKgorICogVGhpcyBpcyBhbiBpbXBsZW1lbnRhdGlvbiBvZiBhbiBlYXJseS1kcmFmdCBz
cGVjaWZpY2F0aW9uIGRldmVsb3BlZCB1bmRlciB0aGUgSmF2YQorICogQ29tbXVuaXR5IFByb2Nl
c3MgKEpDUCkgYW5kIGlzIG1hZGUgYXZhaWxhYmxlIGZvciB0ZXN0aW5nIGFuZCBldmFsdWF0aW9u
IHB1cnBvc2VzCisgKiBvbmx5LiBUaGUgY29kZSBpcyBub3QgY29tcGF0aWJsZSB3aXRoIGFueSBz
cGVjaWZpY2F0aW9uIG9mIHRoZSBKQ1AuCisgKgorICogQ29udHJpYnV0b3JzOgorICogICAgIElC
TSBDb3Jwb3JhdGlvbiAtIGluaXRpYWwgQVBJIGFuZCBpbXBsZW1lbnRhdGlvbgorICoqKioqKioq
KioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioq
KioqKioqKioqKioqKiovCitwYWNrYWdlIG9yZy5lY2xpcHNlLmpkdC5jb3JlLnRlc3RzLnJld3Jp
dGUuZGVzY3JpYmluZzsKK2ltcG9ydCBqYXZhLnV0aWwuTGlzdDsKKworaW1wb3J0IGp1bml0LmZy
YW1ld29yay5UZXN0OworCitpbXBvcnQgb3JnLmVjbGlwc2UuamR0LmNvcmUuSUNvbXBpbGF0aW9u
VW5pdDsKK2ltcG9ydCBvcmcuZWNsaXBzZS5qZHQuY29yZS5JUGFja2FnZUZyYWdtZW50OworaW1w
b3J0IG9yZy5lY2xpcHNlLmpkdC5jb3JlLmRvbS4qOworaW1wb3J0IG9yZy5lY2xpcHNlLmpkdC5j
b3JlLmRvbS5yZXdyaXRlLkFTVFJld3JpdGU7CisKK3B1YmxpYyBjbGFzcyBBU1RSZXdyaXRpbmdU
eXBlQW5ub3RhdGlvbnNUZXN0IGV4dGVuZHMgQVNUUmV3cml0aW5nVGVzdCB7CisKKwlwdWJsaWMg
QVNUUmV3cml0aW5nVHlwZUFubm90YXRpb25zVGVzdChTdHJpbmcgbmFtZSkgeworCQlzdXBlcihu
YW1lKTsKKwl9CisJcHVibGljIEFTVFJld3JpdGluZ1R5cGVBbm5vdGF0aW9uc1Rlc3QoU3RyaW5n
IG5hbWUsIGludCBhcGlMZXZlbCkgeworCQlzdXBlcihuYW1lLCBhcGlMZXZlbCk7CisJfQorCisJ
cHVibGljIHN0YXRpYyBUZXN0IHN1aXRlKCkgeworCQlyZXR1cm4gY3JlYXRlU3VpdGUoQVNUUmV3
cml0aW5nVHlwZUFubm90YXRpb25zVGVzdC5jbGFzcyk7CisJfQorCisJcHVibGljIHZvaWQgdGVz
dENhc3RBbm5vdGF0aW9ucygpIHRocm93cyBFeGNlcHRpb24geworCQlpZiAodGhpcy5hcGlMZXZl
bCA8IEFTVC5KTFM4KSByZXR1cm47CisJCUlQYWNrYWdlRnJhZ21lbnQgcGFjazE9IHRoaXMuc291
cmNlRm9sZGVyLmNyZWF0ZVBhY2thZ2VGcmFnbWVudCgidGVzdDEiLCBmYWxzZSwgbnVsbCk7CisJ
CVN0cmluZ0J1ZmZlciBidWY9IG5ldyBTdHJpbmdCdWZmZXIoKTsKKwkJYnVmLmFwcGVuZCgicGFj
a2FnZSB0ZXN0MTtcbiIpOworCQlidWYuYXBwZW5kKCJpbXBvcnQgamF2YS5sYW5nLmFubm90YXRp
b24uRWxlbWVudFR5cGU7XG4iKTsKKwkJYnVmLmFwcGVuZCgicHVibGljIGNsYXNzIFgge1xuIik7
CisJCWJ1Zi5hcHBlbmQoIglTdHJpbmcgbXlPYmplY3QgPSBcIkZvb1wiO1xuIik7CisJCWJ1Zi5h
cHBlbmQoIglwdWJsaWMgdm9pZCBmb28oKSB7XG4iKTsKKwkJYnVmLmFwcGVuZCgiCQlTdHJpbmcg
bXlTdHJpbmcgPSAoQEFubm90IFN0cmluZykgbXlPYmplY3Q7XG4iKTsKKwkJYnVmLmFwcGVuZCgi
CQlTdHJpbmcgbXlTdHJpbmcxID0gKEBBbm5vdDEgQEFubm90IFN0cmluZykgbXlPYmplY3Q7XG4i
KTsKKwkJYnVmLmFwcGVuZCgiCX1cbiIpOworCQlidWYuYXBwZW5kKCJ9XG4iKTsKKwkJYnVmLmFw
cGVuZCgiQGphdmEubGFuZy5hbm5vdGF0aW9uLlRhcmdldCh2YWx1ZSA9IHtFbGVtZW50VHlwZS5U
WVBFX1VTRX0pXG4iKTsKKwkJYnVmLmFwcGVuZCgiQGludGVyZmFjZSBBbm5vdCB7fVxuIik7CisJ
CWJ1Zi5hcHBlbmQoIkBqYXZhLmxhbmcuYW5ub3RhdGlvbi5UYXJnZXQodmFsdWUgPSB7RWxlbWVu
dFR5cGUuVFlQRV9VU0V9KVxuIik7CisJCWJ1Zi5hcHBlbmQoIkBpbnRlcmZhY2UgQW5ub3QxIHt9
XG4iKTsKKworCQlJQ29tcGlsYXRpb25Vbml0IGN1PSBwYWNrMS5jcmVhdGVDb21waWxhdGlvblVu
aXQoIlguamF2YSIsIGJ1Zi50b1N0cmluZygpLCBmYWxzZSwgbnVsbCk7CisJCUNvbXBpbGF0aW9u
VW5pdCBhc3RSb290PSBjcmVhdGVBU1QoY3UpOworCQlBU1RSZXdyaXRlIHJld3JpdGU9IEFTVFJl
d3JpdGUuY3JlYXRlKGFzdFJvb3QuZ2V0QVNUKCkpOworCQlBU1QgYXN0PSBhc3RSb290LmdldEFT
VCgpOworCQlUeXBlRGVjbGFyYXRpb24gdHlwZT0gZmluZFR5cGVEZWNsYXJhdGlvbihhc3RSb290
LCAiWCIpOworCQlNZXRob2REZWNsYXJhdGlvbiBtZXRob2REZWNsYXJhdGlvbj0gZmluZE1ldGhv
ZERlY2xhcmF0aW9uKHR5cGUsICJmb28iKTsKKwkJTGlzdCBzdGF0ZW1lbnRzPSBtZXRob2REZWNs
YXJhdGlvbi5nZXRCb2R5KCkuc3RhdGVtZW50cygpOworCQl7Ly9BZGQgYW4gdXNlIG9mIGFubm90
YXRpb24uCisJCQlWYXJpYWJsZURlY2xhcmF0aW9uU3RhdGVtZW50ICB2YXJpYWJsZURlY2xhcmF0
aW9uU3RhdGVtZW50PSAoVmFyaWFibGVEZWNsYXJhdGlvblN0YXRlbWVudCkgc3RhdGVtZW50cy5n
ZXQoMCk7CisJCQlWYXJpYWJsZURlY2xhcmF0aW9uRnJhZ21lbnQgdmFyaWFibGVEZWNsYXJhdGlv
bkZyYWdtZW50PSAoVmFyaWFibGVEZWNsYXJhdGlvbkZyYWdtZW50KSB2YXJpYWJsZURlY2xhcmF0
aW9uU3RhdGVtZW50LmZyYWdtZW50cygpLmdldCgwKTsKKwkJCUNhc3RFeHByZXNzaW9uIGNhc3RF
eHByZXNzaW9uPSAoQ2FzdEV4cHJlc3Npb24pIHZhcmlhYmxlRGVjbGFyYXRpb25GcmFnbWVudC5n
ZXRJbml0aWFsaXplcigpOworCQkJU2ltcGxlVHlwZSBzaW1wbGVUeXBlPSAoU2ltcGxlVHlwZSkg
Y2FzdEV4cHJlc3Npb24uZ2V0VHlwZSgpOworCQkJTWFya2VyQW5ub3RhdGlvbiBtYXJrZXJBbm5v
dGF0aW9uPSBhc3QubmV3TWFya2VyQW5ub3RhdGlvbigpOworCQkJbWFya2VyQW5ub3RhdGlvbi5z
ZXRUeXBlTmFtZShhc3QubmV3U2ltcGxlTmFtZSgiQW5ub3QyIikpOworCQkJcmV3cml0ZS5nZXRM
aXN0UmV3cml0ZShzaW1wbGVUeXBlLCBTaW1wbGVUeXBlLkFOTk9UQVRJT05TX1BST1BFUlRZKS5p
bnNlcnRMYXN0KG1hcmtlckFubm90YXRpb24sIG51bGwpOworCQl9CisJCXsKKwkJCVZhcmlhYmxl
RGVjbGFyYXRpb25TdGF0ZW1lbnQgIHZhcmlhYmxlRGVjbGFyYXRpb25TdGF0ZW1lbnQ9IChWYXJp
YWJsZURlY2xhcmF0aW9uU3RhdGVtZW50KSBzdGF0ZW1lbnRzLmdldCgxKTsKKwkJCVZhcmlhYmxl
RGVjbGFyYXRpb25GcmFnbWVudCB2YXJpYWJsZURlY2xhcmF0aW9uRnJhZ21lbnQ9IChWYXJpYWJs
ZURlY2xhcmF0aW9uRnJhZ21lbnQpIHZhcmlhYmxlRGVjbGFyYXRpb25TdGF0ZW1lbnQuZnJhZ21l
bnRzKCkuZ2V0KDApOworCQkJQ2FzdEV4cHJlc3Npb24gY2FzdEV4cHJlc3Npb249IChDYXN0RXhw
cmVzc2lvbikgdmFyaWFibGVEZWNsYXJhdGlvbkZyYWdtZW50LmdldEluaXRpYWxpemVyKCk7CisJ
CQlTaW1wbGVUeXBlIHNpbXBsZVR5cGU9IChTaW1wbGVUeXBlKSBjYXN0RXhwcmVzc2lvbi5nZXRU
eXBlKCk7CisJCQlMaXN0IGFubm90YXRpb25zID0gc2ltcGxlVHlwZS5hbm5vdGF0aW9ucygpOwor
CQkJLy9SZW1vdmUgdGhlIHVzZSBvZiBhbiBBbm5vdGF0aW9uCisJCQlyZXdyaXRlLnJlbW92ZSgo
QVNUTm9kZSlhbm5vdGF0aW9ucy5nZXQoMSksIG51bGwpOworCQkJLy9SZXBsYWNlIHRoZSB1c2Ug
b2YgYW4gQW5ub3RhdGlvbgorCQkJTWFya2VyQW5ub3RhdGlvbiBtYXJrZXJBbm5vdGF0aW9uPSBh
c3QubmV3TWFya2VyQW5ub3RhdGlvbigpOworCQkJbWFya2VyQW5ub3RhdGlvbi5zZXRUeXBlTmFt
ZShhc3QubmV3U2ltcGxlTmFtZSgiQW5ub3QyIikpOworCQkJcmV3cml0ZS5yZXBsYWNlKChBU1RO
b2RlKWFubm90YXRpb25zLmdldCgwKSwgbWFya2VyQW5ub3RhdGlvbiwgbnVsbCk7CisJCX0KKwkJ
U3RyaW5nIHByZXZpZXc9IGV2YWx1YXRlUmV3cml0ZShjdSwgcmV3cml0ZSk7CisJCWJ1Zj0gbmV3
IFN0cmluZ0J1ZmZlcigpOworCQlidWYuYXBwZW5kKCJwYWNrYWdlIHRlc3QxO1xuIik7CisJCWJ1
Zi5hcHBlbmQoImltcG9ydCBqYXZhLmxhbmcuYW5ub3RhdGlvbi5FbGVtZW50VHlwZTtcbiIpOwor
CQlidWYuYXBwZW5kKCJwdWJsaWMgY2xhc3MgWCB7XG4iKTsKKwkJYnVmLmFwcGVuZCgiCVN0cmlu
ZyBteU9iamVjdCA9IFwiRm9vXCI7XG4iKTsKKwkJYnVmLmFwcGVuZCgiCXB1YmxpYyB2b2lkIGZv
bygpIHtcbiIpOworCQlidWYuYXBwZW5kKCIJCVN0cmluZyBteVN0cmluZyA9IChAQW5ub3QgQEFu
bm90MiBTdHJpbmcpIG15T2JqZWN0O1xuIik7CisJCWJ1Zi5hcHBlbmQoIgkJU3RyaW5nIG15U3Ry
aW5nMSA9IChAQW5ub3QyIFN0cmluZykgbXlPYmplY3Q7XG4iKTsKKwkJYnVmLmFwcGVuZCgiCX1c
biIpOworCQlidWYuYXBwZW5kKCJ9XG4iKTsKKwkJYnVmLmFwcGVuZCgiQGphdmEubGFuZy5hbm5v
dGF0aW9uLlRhcmdldCh2YWx1ZSA9IHtFbGVtZW50VHlwZS5UWVBFX1VTRX0pXG4iKTsKKwkJYnVm
LmFwcGVuZCgiQGludGVyZmFjZSBBbm5vdCB7fVxuIik7CisJCWJ1Zi5hcHBlbmQoIkBqYXZhLmxh
bmcuYW5ub3RhdGlvbi5UYXJnZXQodmFsdWUgPSB7RWxlbWVudFR5cGUuVFlQRV9VU0V9KVxuIik7
CisJCWJ1Zi5hcHBlbmQoIkBpbnRlcmZhY2UgQW5ub3QxIHt9XG4iKTsKKwkJYXNzZXJ0RXF1YWxT
dHJpbmcocHJldmlldywgYnVmLnRvU3RyaW5nKCkpOworCX0KKworCXB1YmxpYyB2b2lkIHRlc3RX
aWxkY2FyZFR5cGVBcmd1bWVudEFubm90YXRpb25zKCkgdGhyb3dzIEV4Y2VwdGlvbiB7CisJCWlm
ICh0aGlzLmFwaUxldmVsIDwgQVNULkpMUzgpIHJldHVybjsKKwkJSVBhY2thZ2VGcmFnbWVudCBw
YWNrMT0gdGhpcy5zb3VyY2VGb2xkZXIuY3JlYXRlUGFja2FnZUZyYWdtZW50KCJ0ZXN0MSIsIGZh
bHNlLCBudWxsKTsKKwkJU3RyaW5nQnVmZmVyIGJ1Zj0gbmV3IFN0cmluZ0J1ZmZlcigpOworCQli
dWYuYXBwZW5kKCJwYWNrYWdlIHRlc3QxO1xuIik7CisJCWJ1Zi5hcHBlbmQoImltcG9ydCBqYXZh
LmxhbmcuYW5ub3RhdGlvbi5FbGVtZW50VHlwZTtcbiIpOworCQlidWYuYXBwZW5kKCJwdWJsaWMg
Y2xhc3MgWCB7XG4iKTsKKwkJYnVmLmFwcGVuZCgiCXB1YmxpYyBjbGFzcyBIZWxwZXI8VD4ge1xu
Iik7CisJCWJ1Zi5hcHBlbmQoIgl9XG4iKTsKKwkJYnVmLmFwcGVuZCgiCXB1YmxpYyBjbGFzcyBC
YXNlIHtcbiIpOworCQlidWYuYXBwZW5kKCIJfVxuIik7CisJCWJ1Zi5hcHBlbmQoIglwdWJsaWMg
c3RhdGljIHZvaWQgVW5ib3VuZGVkV2lsZGNhcmQxIChIZWxwZXI8QEFubm90ID8+IHgpIHtcbiIp
OworCQlidWYuYXBwZW5kKCIJfVxuIik7CisJCWJ1Zi5hcHBlbmQoIglwdWJsaWMgc3RhdGljIHZv
aWQgVW5ib3VuZGVkV2lsZGNhcmQyIChIZWxwZXI8QEFubm90MSBAQW5ub3QgPz4geCkge1xuIik7
CisJCWJ1Zi5hcHBlbmQoIgl9XG4iKTsKKwkJYnVmLmFwcGVuZCgiCXB1YmxpYyBzdGF0aWMgdm9p
ZCBCb3VuZGVkV2lsZGNhcmQxIChIZWxwZXI8QEFubm90ID8gZXh0ZW5kcyBCYXNlPiB4KSB7XG4i
KTsKKwkJYnVmLmFwcGVuZCgiCX1cbiIpOworCQlidWYuYXBwZW5kKCIJcHVibGljIHN0YXRpYyB2
b2lkIEJvdW5kZWRXaWxkY2FyZDIgKEhlbHBlcjxAQW5ub3QxIEBBbm5vdCA/IGV4dGVuZHMgQmFz
ZT4geCkge1xuIik7CisJCWJ1Zi5hcHBlbmQoIgl9XG4iKTsKKwkJYnVmLmFwcGVuZCgifVxuIik7
CisJCWJ1Zi5hcHBlbmQoIkBqYXZhLmxhbmcuYW5ub3RhdGlvbi5UYXJnZXQgKEVsZW1lbnRUeXBl
LlRZUEVfVVNFKVxuIik7CisJCWJ1Zi5hcHBlbmQoIkBpbnRlcmZhY2UgQW5ub3Qge31cbiIpOwor
CQlidWYuYXBwZW5kKCJAamF2YS5sYW5nLmFubm90YXRpb24uVGFyZ2V0IChFbGVtZW50VHlwZS5U
WVBFX1VTRSlcbiIpOworCQlidWYuYXBwZW5kKCJAaW50ZXJmYWNlIEFubm90MSB7fVxuIik7CisK
KwkJSUNvbXBpbGF0aW9uVW5pdCBjdT0gcGFjazEuY3JlYXRlQ29tcGlsYXRpb25Vbml0KCJYLmph
dmEiLCBidWYudG9TdHJpbmcoKSwgZmFsc2UsIG51bGwpOworCQlDb21waWxhdGlvblVuaXQgYXN0
Um9vdD0gY3JlYXRlQVNUKGN1KTsKKwkJQVNUUmV3cml0ZSByZXdyaXRlPSBBU1RSZXdyaXRlLmNy
ZWF0ZShhc3RSb290LmdldEFTVCgpKTsKKwkJQVNUIGFzdD0gYXN0Um9vdC5nZXRBU1QoKTsKKwkJ
VHlwZURlY2xhcmF0aW9uIHR5cGU9IGZpbmRUeXBlRGVjbGFyYXRpb24oYXN0Um9vdCwgIlgiKTsK
KwkJey8vQWRkIGFuIHVzZSBvZiBhbiBhbm5vdGF0aW9uLgorCQkJTWV0aG9kRGVjbGFyYXRpb24g
bWV0aG9kRGVjbGFyYXRpb249IGZpbmRNZXRob2REZWNsYXJhdGlvbih0eXBlLCAiVW5ib3VuZGVk
V2lsZGNhcmQxIik7CisJCQlMaXN0IHBhcmFtZXRlcnM9IG1ldGhvZERlY2xhcmF0aW9uLnBhcmFt
ZXRlcnMoKTsKKwkJCVNpbmdsZVZhcmlhYmxlRGVjbGFyYXRpb24gc2luZ2xlVmFyaWFibGVEZWNs
YXJhdGlvbj0gKFNpbmdsZVZhcmlhYmxlRGVjbGFyYXRpb24pIHBhcmFtZXRlcnMuZ2V0KDApOwor
CQkJUGFyYW1ldGVyaXplZFR5cGUgcGFyYW1ldGVyaXplZFR5cGU9IChQYXJhbWV0ZXJpemVkVHlw
ZSkgc2luZ2xlVmFyaWFibGVEZWNsYXJhdGlvbi5nZXRUeXBlKCk7CisJCQlXaWxkY2FyZFR5cGUg
d2lsZGNhcmRUeXBlPSAoV2lsZGNhcmRUeXBlKSBwYXJhbWV0ZXJpemVkVHlwZS50eXBlQXJndW1l
bnRzKCkuZ2V0KDApOworCQkJTWFya2VyQW5ub3RhdGlvbiBtYXJrZXJBbm5vdGF0aW9uPSBhc3Qu
bmV3TWFya2VyQW5ub3RhdGlvbigpOworCQkJbWFya2VyQW5ub3RhdGlvbi5zZXRUeXBlTmFtZShh
c3QubmV3U2ltcGxlTmFtZSgiQW5ub3QyIikpOworCQkJcmV3cml0ZS5nZXRMaXN0UmV3cml0ZSh3
aWxkY2FyZFR5cGUsIFdpbGRjYXJkVHlwZS5BTk5PVEFUSU9OU19QUk9QRVJUWSkuaW5zZXJ0TGFz
dChtYXJrZXJBbm5vdGF0aW9uLCBudWxsKTsKKworCQkJbWV0aG9kRGVjbGFyYXRpb249IGZpbmRN
ZXRob2REZWNsYXJhdGlvbih0eXBlLCAiQm91bmRlZFdpbGRjYXJkMSIpOworCQkJcGFyYW1ldGVy
cz0gbWV0aG9kRGVjbGFyYXRpb24ucGFyYW1ldGVycygpOworCQkJc2luZ2xlVmFyaWFibGVEZWNs
YXJhdGlvbj0gKFNpbmdsZVZhcmlhYmxlRGVjbGFyYXRpb24pIHBhcmFtZXRlcnMuZ2V0KDApOwor
CQkJcGFyYW1ldGVyaXplZFR5cGU9IChQYXJhbWV0ZXJpemVkVHlwZSkgc2luZ2xlVmFyaWFibGVE
ZWNsYXJhdGlvbi5nZXRUeXBlKCk7CisJCQl3aWxkY2FyZFR5cGU9IChXaWxkY2FyZFR5cGUpIHBh
cmFtZXRlcml6ZWRUeXBlLnR5cGVBcmd1bWVudHMoKS5nZXQoMCk7CisJCQltYXJrZXJBbm5vdGF0
aW9uPSBhc3QubmV3TWFya2VyQW5ub3RhdGlvbigpOworCQkJbWFya2VyQW5ub3RhdGlvbi5zZXRU
eXBlTmFtZShhc3QubmV3U2ltcGxlTmFtZSgiQW5ub3QyIikpOworCQkJcmV3cml0ZS5nZXRMaXN0
UmV3cml0ZSh3aWxkY2FyZFR5cGUsIFdpbGRjYXJkVHlwZS5BTk5PVEFUSU9OU19QUk9QRVJUWSku
aW5zZXJ0TGFzdChtYXJrZXJBbm5vdGF0aW9uLCBudWxsKTsKKwkJfQorCQl7CisJCQlNZXRob2RE
ZWNsYXJhdGlvbiBtZXRob2REZWNsYXJhdGlvbj0gZmluZE1ldGhvZERlY2xhcmF0aW9uKHR5cGUs
ICJVbmJvdW5kZWRXaWxkY2FyZDIiKTsKKwkJCUxpc3QgcGFyYW1ldGVycz0gbWV0aG9kRGVjbGFy
YXRpb24ucGFyYW1ldGVycygpOworCQkJU2luZ2xlVmFyaWFibGVEZWNsYXJhdGlvbiBzaW5nbGVW
YXJpYWJsZURlY2xhcmF0aW9uPSAoU2luZ2xlVmFyaWFibGVEZWNsYXJhdGlvbikgcGFyYW1ldGVy
cy5nZXQoMCk7CisJCQlQYXJhbWV0ZXJpemVkVHlwZSBwYXJhbWV0ZXJpemVkVHlwZT0gKFBhcmFt
ZXRlcml6ZWRUeXBlKSBzaW5nbGVWYXJpYWJsZURlY2xhcmF0aW9uLmdldFR5cGUoKTsKKwkJCVdp
bGRjYXJkVHlwZSB3aWxkY2FyZFR5cGU9IChXaWxkY2FyZFR5cGUpIHBhcmFtZXRlcml6ZWRUeXBl
LnR5cGVBcmd1bWVudHMoKS5nZXQoMCk7CisKKwkJCW1ldGhvZERlY2xhcmF0aW9uPSBmaW5kTWV0
aG9kRGVjbGFyYXRpb24odHlwZSwgIkJvdW5kZWRXaWxkY2FyZDIiKTsKKwkJCXBhcmFtZXRlcnM9
IG1ldGhvZERlY2xhcmF0aW9uLnBhcmFtZXRlcnMoKTsKKwkJCXNpbmdsZVZhcmlhYmxlRGVjbGFy
YXRpb249IChTaW5nbGVWYXJpYWJsZURlY2xhcmF0aW9uKSBwYXJhbWV0ZXJzLmdldCgwKTsKKwkJ
CXBhcmFtZXRlcml6ZWRUeXBlPSAoUGFyYW1ldGVyaXplZFR5cGUpIHNpbmdsZVZhcmlhYmxlRGVj
bGFyYXRpb24uZ2V0VHlwZSgpOworCQkJV2lsZGNhcmRUeXBlIHdpbGRjYXJkVHlwZTI9IChXaWxk
Y2FyZFR5cGUpIHBhcmFtZXRlcml6ZWRUeXBlLnR5cGVBcmd1bWVudHMoKS5nZXQoMCk7CisKKwkJ
CS8vUmVtb3ZlIHRoZSB1c2Ugb2YgYW4gYW5ub3RhdGlvbgorCQkJcmV3cml0ZS5yZW1vdmUoKE1h
cmtlckFubm90YXRpb24pIHdpbGRjYXJkVHlwZS5hbm5vdGF0aW9ucygpLmdldCgxKSwgbnVsbCk7
CisJCQlyZXdyaXRlLnJlbW92ZSgoTWFya2VyQW5ub3RhdGlvbikgd2lsZGNhcmRUeXBlMi5hbm5v
dGF0aW9ucygpLmdldCgxKSwgbnVsbCk7CisKKwkJCU1hcmtlckFubm90YXRpb24gbWFya2VyQW5u
b3RhdGlvbj0gYXN0Lm5ld01hcmtlckFubm90YXRpb24oKTsKKwkJCW1hcmtlckFubm90YXRpb24u
c2V0VHlwZU5hbWUoYXN0Lm5ld1NpbXBsZU5hbWUoIkFubm90MiIpKTsKKwkJCU1hcmtlckFubm90
YXRpb24gbWFya2VyQW5ub3RhdGlvbjI9IGFzdC5uZXdNYXJrZXJBbm5vdGF0aW9uKCk7CisJCQlt
YXJrZXJBbm5vdGF0aW9uMi5zZXRUeXBlTmFtZShhc3QubmV3U2ltcGxlTmFtZSgiQW5ub3QyIikp
OworCisJCQkvL1JlcGxhY2UgdGhlIHVzZSBvZiBhbiBhbm5vdGF0aW9uCisJCQlyZXdyaXRlLnJl
cGxhY2UoKE1hcmtlckFubm90YXRpb24pIHdpbGRjYXJkVHlwZS5hbm5vdGF0aW9ucygpLmdldCgw
KSwgbWFya2VyQW5ub3RhdGlvbiwgbnVsbCk7CisJCQlyZXdyaXRlLnJlcGxhY2UoKE1hcmtlckFu
bm90YXRpb24pIHdpbGRjYXJkVHlwZTIuYW5ub3RhdGlvbnMoKS5nZXQoMCksIG1hcmtlckFubm90
YXRpb24yLCBudWxsKTsKKwkJfQorCQlTdHJpbmcgcHJldmlldz0gZXZhbHVhdGVSZXdyaXRlKGN1
LCByZXdyaXRlKTsKKwkJYnVmID0gbmV3IFN0cmluZ0J1ZmZlcigpOworCQlidWYuYXBwZW5kKCJw
YWNrYWdlIHRlc3QxO1xuIik7CisJCWJ1Zi5hcHBlbmQoImltcG9ydCBqYXZhLmxhbmcuYW5ub3Rh
dGlvbi5FbGVtZW50VHlwZTtcbiIpOworCQlidWYuYXBwZW5kKCJwdWJsaWMgY2xhc3MgWCB7XG4i
KTsKKwkJYnVmLmFwcGVuZCgiCXB1YmxpYyBjbGFzcyBIZWxwZXI8VD4ge1xuIik7CisJCWJ1Zi5h
cHBlbmQoIgl9XG4iKTsKKwkJYnVmLmFwcGVuZCgiCXB1YmxpYyBjbGFzcyBCYXNlIHtcbiIpOwor
CQlidWYuYXBwZW5kKCIJfVxuIik7CisJCWJ1Zi5hcHBlbmQoIglwdWJsaWMgc3RhdGljIHZvaWQg
VW5ib3VuZGVkV2lsZGNhcmQxIChIZWxwZXI8QEFubm90IEBBbm5vdDIgPz4geCkge1xuIik7CisJ
CWJ1Zi5hcHBlbmQoIgl9XG4iKTsKKwkJYnVmLmFwcGVuZCgiCXB1YmxpYyBzdGF0aWMgdm9pZCBV
bmJvdW5kZWRXaWxkY2FyZDIgKEhlbHBlcjxAQW5ub3QyID8+IHgpIHtcbiIpOworCQlidWYuYXBw
ZW5kKCIJfVxuIik7CisJCWJ1Zi5hcHBlbmQoIglwdWJsaWMgc3RhdGljIHZvaWQgQm91bmRlZFdp
bGRjYXJkMSAoSGVscGVyPEBBbm5vdCBAQW5ub3QyID8gZXh0ZW5kcyBCYXNlPiB4KSB7XG4iKTsK
KwkJYnVmLmFwcGVuZCgiCX1cbiIpOworCQlidWYuYXBwZW5kKCIJcHVibGljIHN0YXRpYyB2b2lk
IEJvdW5kZWRXaWxkY2FyZDIgKEhlbHBlcjxAQW5ub3QyID8gZXh0ZW5kcyBCYXNlPiB4KSB7XG4i
KTsKKwkJYnVmLmFwcGVuZCgiCX1cbiIpOworCQlidWYuYXBwZW5kKCJ9XG4iKTsKKwkJYnVmLmFw
cGVuZCgiQGphdmEubGFuZy5hbm5vdGF0aW9uLlRhcmdldCAoRWxlbWVudFR5cGUuVFlQRV9VU0Up
XG4iKTsKKwkJYnVmLmFwcGVuZCgiQGludGVyZmFjZSBBbm5vdCB7fVxuIik7CisJCWJ1Zi5hcHBl
bmQoIkBqYXZhLmxhbmcuYW5ub3RhdGlvbi5UYXJnZXQgKEVsZW1lbnRUeXBlLlRZUEVfVVNFKVxu
Iik7CisJCWJ1Zi5hcHBlbmQoIkBpbnRlcmZhY2UgQW5ub3QxIHt9XG4iKTsKKwkJYXNzZXJ0RXF1
YWxTdHJpbmcocHJldmlldywgYnVmLnRvU3RyaW5nKCkpOworCX0KKworCXB1YmxpYyB2b2lkIHRl
c3RXaWxkY2FyZEJvdWRBbm5vdGF0aW9uKCkgdGhyb3dzIEV4Y2VwdGlvbiB7CisJCWlmICh0aGlz
LmFwaUxldmVsIDwgQVNULkpMUzgpIHJldHVybjsKKwkJSVBhY2thZ2VGcmFnbWVudCBwYWNrMT0g
dGhpcy5zb3VyY2VGb2xkZXIuY3JlYXRlUGFja2FnZUZyYWdtZW50KCJ0ZXN0MSIsIGZhbHNlLCBu
dWxsKTsKKwkJU3RyaW5nQnVmZmVyIGJ1Zj0gbmV3IFN0cmluZ0J1ZmZlcigpOworCisJCWJ1Zi5h
cHBlbmQoInB1YmxpYyBjbGFzcyBYIHtcbiIpOworCQlidWYuYXBwZW5kKCIJcHVibGljIGNsYXNz
IEhlbHBlcjxUPiB7XG4iKTsKKwkJYnVmLmFwcGVuZCgiCX1cbiIpOworCQlidWYuYXBwZW5kKCIJ
cHVibGljIGNsYXNzIEJhc2Uge1xuIik7CisJCWJ1Zi5hcHBlbmQoIgl9XG4iKTsKKwkJYnVmLmFw
cGVuZCgiCXB1YmxpYyBzdGF0aWMgdm9pZCBmb28xIChIZWxwZXI8PyBleHRlbmRzIEBBbm5vdCBC
YXNlPiB4KSB7XG4iKTsKKwkJYnVmLmFwcGVuZCgiCX1cbiIpOworCQlidWYuYXBwZW5kKCIJcHVi
bGljIHN0YXRpYyB2b2lkIGZvbzIgKEhlbHBlcjw/IGV4dGVuZHMgQEFubm90MSBAQW5ub3QgQmFz
ZT4geCkge1xuIik7CisJCWJ1Zi5hcHBlbmQoIgl9XG4iKTsKKwkJYnVmLmFwcGVuZCgifVxuIik7
CisKKwkJSUNvbXBpbGF0aW9uVW5pdCBjdT0gcGFjazEuY3JlYXRlQ29tcGlsYXRpb25Vbml0KCJY
LmphdmEiLCBidWYudG9TdHJpbmcoKSwgZmFsc2UsIG51bGwpOworCQlDb21waWxhdGlvblVuaXQg
YXN0Um9vdD0gY3JlYXRlQVNUKGN1KTsKKwkJQVNUUmV3cml0ZSByZXdyaXRlPSBBU1RSZXdyaXRl
LmNyZWF0ZShhc3RSb290LmdldEFTVCgpKTsKKwkJQVNUIGFzdD0gYXN0Um9vdC5nZXRBU1QoKTsK
KwkJVHlwZURlY2xhcmF0aW9uIHR5cGU9IGZpbmRUeXBlRGVjbGFyYXRpb24oYXN0Um9vdCwgIlgi
KTsKKwkJeworCQkJTWV0aG9kRGVjbGFyYXRpb24gbWV0aG9kRGVjbGFyYXRpb249IGZpbmRNZXRo
b2REZWNsYXJhdGlvbih0eXBlLCAiZm9vMSIpOworCQkJTGlzdCBwYXJhbWV0ZXJzPSBtZXRob2RE
ZWNsYXJhdGlvbi5wYXJhbWV0ZXJzKCk7CisJCQlTaW5nbGVWYXJpYWJsZURlY2xhcmF0aW9uIHNp
bmdsZVZhcmlhYmxlRGVjbGFyYXRpb249IChTaW5nbGVWYXJpYWJsZURlY2xhcmF0aW9uKSBwYXJh
bWV0ZXJzLmdldCgwKTsKKwkJCVBhcmFtZXRlcml6ZWRUeXBlIHBhcmFtZXRlcml6ZWRUeXBlPSAo
UGFyYW1ldGVyaXplZFR5cGUpIHNpbmdsZVZhcmlhYmxlRGVjbGFyYXRpb24uZ2V0VHlwZSgpOwor
CQkJV2lsZGNhcmRUeXBlIHdpbGRjYXJkVHlwZT0gKFdpbGRjYXJkVHlwZSkgcGFyYW1ldGVyaXpl
ZFR5cGUudHlwZUFyZ3VtZW50cygpLmdldCgwKTsKKwkJCVNpbXBsZVR5cGUgc2ltcGxlVHlwZT0g
KFNpbXBsZVR5cGUpIHdpbGRjYXJkVHlwZS5nZXRCb3VuZCgpOworCQkJTWFya2VyQW5ub3RhdGlv
biBtYXJrZXJBbm5vdGF0aW9uPSBhc3QubmV3TWFya2VyQW5ub3RhdGlvbigpOworCQkJbWFya2Vy
QW5ub3RhdGlvbi5zZXRUeXBlTmFtZShhc3QubmV3U2ltcGxlTmFtZSgiQW5ub3QyIikpOworCQkJ
cmV3cml0ZS5nZXRMaXN0UmV3cml0ZShzaW1wbGVUeXBlLCBTaW1wbGVUeXBlLkFOTk9UQVRJT05T
X1BST1BFUlRZKS5pbnNlcnRMYXN0KG1hcmtlckFubm90YXRpb24sIG51bGwpOworCQl9CisJCXsK
KwkJCU1ldGhvZERlY2xhcmF0aW9uIG1ldGhvZERlY2xhcmF0aW9uPSBmaW5kTWV0aG9kRGVjbGFy
YXRpb24odHlwZSwgImZvbzIiKTsKKwkJCUxpc3QgcGFyYW1ldGVycz0gbWV0aG9kRGVjbGFyYXRp
b24ucGFyYW1ldGVycygpOworCQkJU2luZ2xlVmFyaWFibGVEZWNsYXJhdGlvbiBzaW5nbGVWYXJp
YWJsZURlY2xhcmF0aW9uPSAoU2luZ2xlVmFyaWFibGVEZWNsYXJhdGlvbikgcGFyYW1ldGVycy5n
ZXQoMCk7CisJCQlQYXJhbWV0ZXJpemVkVHlwZSBwYXJhbWV0ZXJpemVkVHlwZT0gKFBhcmFtZXRl
cml6ZWRUeXBlKSBzaW5nbGVWYXJpYWJsZURlY2xhcmF0aW9uLmdldFR5cGUoKTsKKwkJCVdpbGRj
YXJkVHlwZSB3aWxkY2FyZFR5cGU9IChXaWxkY2FyZFR5cGUpIHBhcmFtZXRlcml6ZWRUeXBlLnR5
cGVBcmd1bWVudHMoKS5nZXQoMCk7CisJCQlTaW1wbGVUeXBlIHNpbXBsZVR5cGU9IChTaW1wbGVU
eXBlKSB3aWxkY2FyZFR5cGUuZ2V0Qm91bmQoKTsKKwkJCS8vUmVtb3ZlIHRoZSB1c2Ugb2YgYW5u
b3RhdGlvbgorCQkJcmV3cml0ZS5yZW1vdmUoKE1hcmtlckFubm90YXRpb24pIHNpbXBsZVR5cGUu
YW5ub3RhdGlvbnMoKS5nZXQoMSksIG51bGwpOworCQkJLy9SZXBsYWNlIHRoZSB1c2Ugb2YgYW5u
b3RhdGlvbgorCQkJTWFya2VyQW5ub3RhdGlvbiBtYXJrZXJBbm5vdGF0aW9uPSBhc3QubmV3TWFy
a2VyQW5ub3RhdGlvbigpOworCQkJbWFya2VyQW5ub3RhdGlvbi5zZXRUeXBlTmFtZShhc3QubmV3
U2ltcGxlTmFtZSgiQW5ub3QyIikpOworCQkJcmV3cml0ZS5yZXBsYWNlKChNYXJrZXJBbm5vdGF0
aW9uKSBzaW1wbGVUeXBlLmFubm90YXRpb25zKCkuZ2V0KDApLCBtYXJrZXJBbm5vdGF0aW9uLCBu
dWxsKTsKKwkJfQorCQlTdHJpbmcgcHJldmlldz0gZXZhbHVhdGVSZXdyaXRlKGN1LCByZXdyaXRl
KTsKKwkJYnVmID0gbmV3IFN0cmluZ0J1ZmZlcigpOworCQlidWYuYXBwZW5kKCJwdWJsaWMgY2xh
c3MgWCB7XG4iKTsKKwkJYnVmLmFwcGVuZCgiCXB1YmxpYyBjbGFzcyBIZWxwZXI8VD4ge1xuIik7
CisJCWJ1Zi5hcHBlbmQoIgl9XG4iKTsKKwkJYnVmLmFwcGVuZCgiCXB1YmxpYyBjbGFzcyBCYXNl
IHtcbiIpOworCQlidWYuYXBwZW5kKCIJfVxuIik7CisJCWJ1Zi5hcHBlbmQoIglwdWJsaWMgc3Rh
dGljIHZvaWQgZm9vMSAoSGVscGVyPD8gZXh0ZW5kcyBAQW5ub3QgQEFubm90MiBCYXNlPiB4KSB7
XG4iKTsKKwkJYnVmLmFwcGVuZCgiCX1cbiIpOworCQlidWYuYXBwZW5kKCIJcHVibGljIHN0YXRp
YyB2b2lkIGZvbzIgKEhlbHBlcjw/IGV4dGVuZHMgQEFubm90MiBCYXNlPiB4KSB7XG4iKTsKKwkJ
YnVmLmFwcGVuZCgiCX1cbiIpOworCQlidWYuYXBwZW5kKCJ9XG4iKTsKKwkJYXNzZXJ0RXF1YWxT
dHJpbmcocHJldmlldywgYnVmLnRvU3RyaW5nKCkpOworCX0KKworCXB1YmxpYyB2b2lkIHRlc3RU
eXBlUGFyYW1ldGVyQm91bmRBbm5vdGF0aW9ucygpIHRocm93cyBFeGNlcHRpb24geworCQlpZiAo
dGhpcy5hcGlMZXZlbCA8IEFTVC5KTFM4KSByZXR1cm47CisJCUlQYWNrYWdlRnJhZ21lbnQgcGFj
azE9IHRoaXMuc291cmNlRm9sZGVyLmNyZWF0ZVBhY2thZ2VGcmFnbWVudCgidGVzdDEiLCBmYWxz
ZSwgbnVsbCk7CisJCVN0cmluZ0J1ZmZlciBidWY9IG5ldyBTdHJpbmdCdWZmZXIoKTsKKworCQli
dWYuYXBwZW5kKCJpbXBvcnQgamF2YS5sYW5nLmFubm90YXRpb24uRWxlbWVudFR5cGU7XG4iKTsK
KwkJYnVmLmFwcGVuZCgiXG4iKTsKKwkJYnVmLmFwcGVuZCgicHVibGljIGNsYXNzIFgge1xuIik7
CisJCWJ1Zi5hcHBlbmQoIglwdWJsaWMgY2xhc3MgQmFzZSB7XG4iKTsKKwkJYnVmLmFwcGVuZCgi
CX1cbiIpOworCQlidWYuYXBwZW5kKCIJcHVibGljIDxYIGV4dGVuZHMgQEFubm90IEJhc2U+IHZv
aWQgZm9vMSAoWCB4KSB7XG4iKTsKKwkJYnVmLmFwcGVuZCgiCX1cbiIpOworCQlidWYuYXBwZW5k
KCIJcHVibGljIDxYIGV4dGVuZHMgQEFubm90MSBAQW5ub3QgQmFzZT4gdm9pZCBmb28yIChYIHgp
IHtcbiIpOworCQlidWYuYXBwZW5kKCIJfVxuIik7CisJCWJ1Zi5hcHBlbmQoIn1cbiIpOworCQli
dWYuYXBwZW5kKCJcbiIpOworCQlidWYuYXBwZW5kKCJAamF2YS5sYW5nLmFubm90YXRpb24uVGFy
Z2V0IChFbGVtZW50VHlwZS5UWVBFX1VTRSkgXG4iKTsKKwkJYnVmLmFwcGVuZCgiQGludGVyZmFj
ZSBBbm5vdCB7fVxuIik7CisJCWJ1Zi5hcHBlbmQoIlxuIik7CisJCWJ1Zi5hcHBlbmQoIkBqYXZh
LmxhbmcuYW5ub3RhdGlvbi5UYXJnZXQgKEVsZW1lbnRUeXBlLlRZUEVfVVNFKSBcbiIpOworCQli
dWYuYXBwZW5kKCJAaW50ZXJmYWNlIEFubm90MSB7fVxuIik7CisKKwkJSUNvbXBpbGF0aW9uVW5p
dCBjdT0gcGFjazEuY3JlYXRlQ29tcGlsYXRpb25Vbml0KCJYLmphdmEiLCBidWYudG9TdHJpbmco
KSwgZmFsc2UsIG51bGwpOworCQlDb21waWxhdGlvblVuaXQgYXN0Um9vdD0gY3JlYXRlQVNUKGN1
KTsKKwkJQVNUUmV3cml0ZSByZXdyaXRlPSBBU1RSZXdyaXRlLmNyZWF0ZShhc3RSb290LmdldEFT
VCgpKTsKKwkJQVNUIGFzdD0gYXN0Um9vdC5nZXRBU1QoKTsKKwkJVHlwZURlY2xhcmF0aW9uIHR5
cGU9IGZpbmRUeXBlRGVjbGFyYXRpb24oYXN0Um9vdCwgIlgiKTsKKwkJey8vQWRkIGFuIHVzZSBv
ZiBhbm5vdGF0aW9uCisJCQlNZXRob2REZWNsYXJhdGlvbiBtZXRob2REZWNsYXJhdGlvbj0gZmlu
ZE1ldGhvZERlY2xhcmF0aW9uKHR5cGUsICJmb28xIik7CisJCQlUeXBlUGFyYW1ldGVyIHR5cGVQ
YXJhbWV0ZXI9IChUeXBlUGFyYW1ldGVyKSBtZXRob2REZWNsYXJhdGlvbi50eXBlUGFyYW1ldGVy
cygpLmdldCgwKTsKKwkJCVNpbXBsZVR5cGUgc2ltcGxlVHlwZT0gKFNpbXBsZVR5cGUpIHR5cGVQ
YXJhbWV0ZXIudHlwZUJvdW5kcygpLmdldCgwKTsKKwkJCU1hcmtlckFubm90YXRpb24gbWFya2Vy
QW5ub3RhdGlvbj0gYXN0Lm5ld01hcmtlckFubm90YXRpb24oKTsKKwkJCW1hcmtlckFubm90YXRp
b24uc2V0VHlwZU5hbWUoYXN0Lm5ld1NpbXBsZU5hbWUoIkFubm90MiIpKTsKKwkJCXJld3JpdGUu
Z2V0TGlzdFJld3JpdGUoc2ltcGxlVHlwZSwgU2ltcGxlVHlwZS5BTk5PVEFUSU9OU19QUk9QRVJU
WSkuaW5zZXJ0TGFzdChtYXJrZXJBbm5vdGF0aW9uLCBudWxsKTsKKwkJfQorCQl7CisJCQlNZXRo
b2REZWNsYXJhdGlvbiBtZXRob2REZWNsYXJhdGlvbj0gZmluZE1ldGhvZERlY2xhcmF0aW9uKHR5
cGUsICJmb28yIik7CisJCQlUeXBlUGFyYW1ldGVyIHR5cGVQYXJhbWV0ZXI9IChUeXBlUGFyYW1l
dGVyKSBtZXRob2REZWNsYXJhdGlvbi50eXBlUGFyYW1ldGVycygpLmdldCgwKTsKKwkJCVNpbXBs
ZVR5cGUgc2ltcGxlVHlwZT0gKFNpbXBsZVR5cGUpIHR5cGVQYXJhbWV0ZXIudHlwZUJvdW5kcygp
LmdldCgwKTsKKwkJCS8vUmVtb3ZlIGFuIHVzZSBvZiBhbm5vdGF0aW9uCisJCQlyZXdyaXRlLnJl
bW92ZSgoTWFya2VyQW5ub3RhdGlvbikgc2ltcGxlVHlwZS5hbm5vdGF0aW9ucygpLmdldCgxKSwg
bnVsbCk7CisJCQkvL1JlcGxhY2UgYW4gdXNlIG9mIGFubm90YXRpb24KKwkJCU1hcmtlckFubm90
YXRpb24gbWFya2VyQW5ub3RhdGlvbj0gYXN0Lm5ld01hcmtlckFubm90YXRpb24oKTsKKwkJCW1h
cmtlckFubm90YXRpb24uc2V0VHlwZU5hbWUoYXN0Lm5ld1NpbXBsZU5hbWUoIkFubm90MiIpKTsK
KwkJCXJld3JpdGUucmVwbGFjZSgoTWFya2VyQW5ub3RhdGlvbikgc2ltcGxlVHlwZS5hbm5vdGF0
aW9ucygpLmdldCgwKSwgbWFya2VyQW5ub3RhdGlvbiwgbnVsbCk7CisJCX0KKwkJU3RyaW5nIHBy
ZXZpZXc9IGV2YWx1YXRlUmV3cml0ZShjdSwgcmV3cml0ZSk7CisJCWJ1ZiA9IG5ldyBTdHJpbmdC
dWZmZXIoKTsKKwkJYnVmLmFwcGVuZCgiaW1wb3J0IGphdmEubGFuZy5hbm5vdGF0aW9uLkVsZW1l
bnRUeXBlO1xuIik7CisJCWJ1Zi5hcHBlbmQoIlxuIik7CisJCWJ1Zi5hcHBlbmQoInB1YmxpYyBj
bGFzcyBYIHtcbiIpOworCQlidWYuYXBwZW5kKCIJcHVibGljIGNsYXNzIEJhc2Uge1xuIik7CisJ
CWJ1Zi5hcHBlbmQoIgl9XG4iKTsKKwkJYnVmLmFwcGVuZCgiCXB1YmxpYyA8WCBleHRlbmRzIEBB
bm5vdCBAQW5ub3QyIEJhc2U+IHZvaWQgZm9vMSAoWCB4KSB7XG4iKTsKKwkJYnVmLmFwcGVuZCgi
CX1cbiIpOworCQlidWYuYXBwZW5kKCIJcHVibGljIDxYIGV4dGVuZHMgQEFubm90MiBCYXNlPiB2
b2lkIGZvbzIgKFggeCkge1xuIik7CisJCWJ1Zi5hcHBlbmQoIgl9XG4iKTsKKwkJYnVmLmFwcGVu
ZCgifVxuIik7CisJCWJ1Zi5hcHBlbmQoIlxuIik7CisJCWJ1Zi5hcHBlbmQoIkBqYXZhLmxhbmcu
YW5ub3RhdGlvbi5UYXJnZXQgKEVsZW1lbnRUeXBlLlRZUEVfVVNFKSBcbiIpOworCQlidWYuYXBw
ZW5kKCJAaW50ZXJmYWNlIEFubm90IHt9XG4iKTsKKwkJYnVmLmFwcGVuZCgiXG4iKTsKKwkJYnVm
LmFwcGVuZCgiQGphdmEubGFuZy5hbm5vdGF0aW9uLlRhcmdldCAoRWxlbWVudFR5cGUuVFlQRV9V
U0UpIFxuIik7CisJCWJ1Zi5hcHBlbmQoIkBpbnRlcmZhY2UgQW5ub3QxIHt9XG4iKTsKKwkJYXNz
ZXJ0RXF1YWxTdHJpbmcocHJldmlldywgYnVmLnRvU3RyaW5nKCkpOworCX0KKworCXB1YmxpYyB2
b2lkIHRlc3RUeXBlQXJndW1lbnRzUGFyYW1ldGVyaXplZENsYXNzZXNBbm5vdGF0aW9ucygpIHRo
cm93cyBFeGNlcHRpb24geworCQlpZiAodGhpcy5hcGlMZXZlbCA8IEFTVC5KTFM4KSByZXR1cm47
CisJCUlQYWNrYWdlRnJhZ21lbnQgcGFjazE9IHRoaXMuc291cmNlRm9sZGVyLmNyZWF0ZVBhY2th
Z2VGcmFnbWVudCgidGVzdDEiLCBmYWxzZSwgbnVsbCk7CisJCVN0cmluZ0J1ZmZlciBidWY9IG5l
dyBTdHJpbmdCdWZmZXIoKTsKKworCQlidWYuYXBwZW5kKCJpbXBvcnQgamF2YS5sYW5nLmFubm90
YXRpb24uRWxlbWVudFR5cGU7XG4iKTsKKwkJYnVmLmFwcGVuZCgiXG4iKTsKKwkJYnVmLmFwcGVu
ZCgicHVibGljIGNsYXNzIFgge1xuIik7CisJCWJ1Zi5hcHBlbmQoIglwdWJsaWMgY2xhc3MgSGVs
cGVyIDxUMSwgVDI+IHtcbiIpOworCQlidWYuYXBwZW5kKCIJfVxuIik7CisJCWJ1Zi5hcHBlbmQo
IglwdWJsaWMgdm9pZCBmb28oKSB7XG4iKTsKKwkJYnVmLmFwcGVuZCgiCQlIZWxwZXI8QEFubm90
IFN0cmluZywgQEFubm90IEBBbm5vdDEgU3RyaW5nPiB4O1xuIik7CisJCWJ1Zi5hcHBlbmQoIgl9
XG4iKTsKKwkJYnVmLmFwcGVuZCgifVxuIik7CisJCWJ1Zi5hcHBlbmQoIlxuIik7CisJCWJ1Zi5h
cHBlbmQoIkBqYXZhLmxhbmcuYW5ub3RhdGlvbi5UYXJnZXQgKEVsZW1lbnRUeXBlLlRZUEVfVVNF
KSBcbiIpOworCQlidWYuYXBwZW5kKCJAaW50ZXJmYWNlIEFubm90IHt9XG4iKTsKKwkJYnVmLmFw
cGVuZCgiXG4iKTsKKwkJYnVmLmFwcGVuZCgiQGphdmEubGFuZy5hbm5vdGF0aW9uLlRhcmdldCAo
RWxlbWVudFR5cGUuVFlQRV9VU0UpIFxuIik7CisJCWJ1Zi5hcHBlbmQoIkBpbnRlcmZhY2UgQW5u
b3QxIHt9XG4iKTsKKworCQlJQ29tcGlsYXRpb25Vbml0IGN1PSBwYWNrMS5jcmVhdGVDb21waWxh
dGlvblVuaXQoIlguamF2YSIsIGJ1Zi50b1N0cmluZygpLCBmYWxzZSwgbnVsbCk7CisJCUNvbXBp
bGF0aW9uVW5pdCBhc3RSb290PSBjcmVhdGVBU1QoY3UpOworCQlBU1RSZXdyaXRlIHJld3JpdGU9
IEFTVFJld3JpdGUuY3JlYXRlKGFzdFJvb3QuZ2V0QVNUKCkpOworCQlBU1QgYXN0PSBhc3RSb290
LmdldEFTVCgpOworCQlUeXBlRGVjbGFyYXRpb24gdHlwZT0gZmluZFR5cGVEZWNsYXJhdGlvbihh
c3RSb290LCAiWCIpOworCQlNZXRob2REZWNsYXJhdGlvbiBtZXRob2REZWNsYXJhdGlvbj0gZmlu
ZE1ldGhvZERlY2xhcmF0aW9uKHR5cGUsICJmb28iKTsKKwkJTGlzdCBzdGF0ZW1lbnRzPSBtZXRo
b2REZWNsYXJhdGlvbi5nZXRCb2R5KCkuc3RhdGVtZW50cygpOworCQlWYXJpYWJsZURlY2xhcmF0
aW9uU3RhdGVtZW50ICB2YXJpYWJsZURlY2xhcmF0aW9uU3RhdGVtZW50PSAoVmFyaWFibGVEZWNs
YXJhdGlvblN0YXRlbWVudCkgc3RhdGVtZW50cy5nZXQoMCk7CisJCVBhcmFtZXRlcml6ZWRUeXBl
IHBhcmFtZXRlcml6ZWRUeXBlPSAoUGFyYW1ldGVyaXplZFR5cGUpIHZhcmlhYmxlRGVjbGFyYXRp
b25TdGF0ZW1lbnQuZ2V0VHlwZSgpOworCQl7Ly8gQWRkIGFuIHVzZSBvZiBhbm5vdGF0aW9uCisJ
CQlTaW1wbGVUeXBlIHNpbXBsZVR5cGU9IChTaW1wbGVUeXBlKSBwYXJhbWV0ZXJpemVkVHlwZS50
eXBlQXJndW1lbnRzKCkuZ2V0KDApOworCQkJTWFya2VyQW5ub3RhdGlvbiBtYXJrZXJBbm5vdGF0
aW9uPSBhc3QubmV3TWFya2VyQW5ub3RhdGlvbigpOworCQkJbWFya2VyQW5ub3RhdGlvbi5zZXRU
eXBlTmFtZShhc3QubmV3U2ltcGxlTmFtZSgiQW5ub3QyIikpOworCQkJcmV3cml0ZS5nZXRMaXN0
UmV3cml0ZShzaW1wbGVUeXBlLCBTaW1wbGVUeXBlLkFOTk9UQVRJT05TX1BST1BFUlRZKS5pbnNl
cnRMYXN0KG1hcmtlckFubm90YXRpb24sIG51bGwpOworCQkJLy9SZXBsYWNlIGFuIHVzZSBvZiBh
biBhbm5vdGF0aW9uCisJCQltYXJrZXJBbm5vdGF0aW9uPSBhc3QubmV3TWFya2VyQW5ub3RhdGlv
bigpOworCQkJbWFya2VyQW5ub3RhdGlvbi5zZXRUeXBlTmFtZShhc3QubmV3U2ltcGxlTmFtZSgi
QW5ub3QzIikpOworCQkJcmV3cml0ZS5yZXBsYWNlKChBU1ROb2RlKSBzaW1wbGVUeXBlLmFubm90
YXRpb25zKCkuZ2V0KDApLCBtYXJrZXJBbm5vdGF0aW9uLCBudWxsKTsKKwkJfQorCQl7CisJCQlT
aW1wbGVUeXBlIHNpbXBsZVR5cGU9IChTaW1wbGVUeXBlKSBwYXJhbWV0ZXJpemVkVHlwZS50eXBl
QXJndW1lbnRzKCkuZ2V0KDEpOworCQkJLy9SZW1vdmUgYW4gdXNlIG9mIGFuIGFubm90YXRpb24K
KwkJCXJld3JpdGUucmVtb3ZlKChBU1ROb2RlKSBzaW1wbGVUeXBlLmFubm90YXRpb25zKCkuZ2V0
KDEpLCBudWxsKTsKKwkJCS8vRW1wdHkgYW5ub3RhdGlvbnMgbGlzdAorCQkJcmV3cml0ZS5yZW1v
dmUoKEFTVE5vZGUpIHNpbXBsZVR5cGUuYW5ub3RhdGlvbnMoKS5nZXQoMCksIG51bGwpOworCQl9
CisJCVN0cmluZyBwcmV2aWV3PSBldmFsdWF0ZVJld3JpdGUoY3UsIHJld3JpdGUpOworCQlidWYg
PSBuZXcgU3RyaW5nQnVmZmVyKCk7CisJCWJ1Zi5hcHBlbmQoImltcG9ydCBqYXZhLmxhbmcuYW5u
b3RhdGlvbi5FbGVtZW50VHlwZTtcbiIpOworCQlidWYuYXBwZW5kKCJcbiIpOworCQlidWYuYXBw
ZW5kKCJwdWJsaWMgY2xhc3MgWCB7XG4iKTsKKwkJYnVmLmFwcGVuZCgiCXB1YmxpYyBjbGFzcyBI
ZWxwZXIgPFQxLCBUMj4ge1xuIik7CisJCWJ1Zi5hcHBlbmQoIgl9XG4iKTsKKwkJYnVmLmFwcGVu
ZCgiCXB1YmxpYyB2b2lkIGZvbygpIHtcbiIpOworCQlidWYuYXBwZW5kKCIJCUhlbHBlcjxAQW5u
b3QzIEBBbm5vdDIgU3RyaW5nLCBTdHJpbmc+IHg7XG4iKTsKKwkJYnVmLmFwcGVuZCgiCX1cbiIp
OworCQlidWYuYXBwZW5kKCJ9XG4iKTsKKwkJYnVmLmFwcGVuZCgiXG4iKTsKKwkJYnVmLmFwcGVu
ZCgiQGphdmEubGFuZy5hbm5vdGF0aW9uLlRhcmdldCAoRWxlbWVudFR5cGUuVFlQRV9VU0UpIFxu
Iik7CisJCWJ1Zi5hcHBlbmQoIkBpbnRlcmZhY2UgQW5ub3Qge31cbiIpOworCQlidWYuYXBwZW5k
KCJcbiIpOworCQlidWYuYXBwZW5kKCJAamF2YS5sYW5nLmFubm90YXRpb24uVGFyZ2V0IChFbGVt
ZW50VHlwZS5UWVBFX1VTRSkgXG4iKTsKKwkJYnVmLmFwcGVuZCgiQGludGVyZmFjZSBBbm5vdDEg
e31cbiIpOworCQlhc3NlcnRFcXVhbFN0cmluZyhwcmV2aWV3LCBidWYudG9TdHJpbmcoKSk7CisJ
fQorCisJcHVibGljIHZvaWQgdGVzdFR5cGVBcmd1bWVudHNNZXRob2RJbnZvY2F0aW9uKCkgdGhy
b3dzIEV4Y2VwdGlvbiB7CisJCWlmICh0aGlzLmFwaUxldmVsIDwgQVNULkpMUzgpIHJldHVybjsK
KwkJSVBhY2thZ2VGcmFnbWVudCBwYWNrMT0gdGhpcy5zb3VyY2VGb2xkZXIuY3JlYXRlUGFja2Fn
ZUZyYWdtZW50KCJ0ZXN0MSIsIGZhbHNlLCBudWxsKTsKKwkJU3RyaW5nQnVmZmVyIGJ1Zj0gbmV3
IFN0cmluZ0J1ZmZlcigpOworCisJCWJ1Zi5hcHBlbmQoImltcG9ydCBqYXZhLmxhbmcuYW5ub3Rh
dGlvbi5FbGVtZW50VHlwZTtcbiIpOworCQlidWYuYXBwZW5kKCJcbiIpOworCQlidWYuYXBwZW5k
KCJwdWJsaWMgY2xhc3MgWCB7XG4iKTsKKwkJYnVmLmFwcGVuZCgiCXB1YmxpYyBjbGFzcyBCYXIg
e1xuIik7CisJCWJ1Zi5hcHBlbmQoIgl9XG4iKTsKKwkJYnVmLmFwcGVuZCgiCVxuIik7CisJCWJ1
Zi5hcHBlbmQoIglwdWJsaWMgY2xhc3MgSGVscGVyIHtcbiIpOworCQlidWYuYXBwZW5kKCIJCXB1
YmxpYyA8VD4gdm9pZCBmb28oKSB7XG4iKTsKKwkJYnVmLmFwcGVuZCgiCQl9XG4iKTsKKwkJYnVm
LmFwcGVuZCgiCX1cbiIpOworCQlidWYuYXBwZW5kKCIJXG4iKTsKKwkJYnVmLmFwcGVuZCgiCXB1
YmxpYyB2b2lkIHpvbygpIHtcbiIpOworCQlidWYuYXBwZW5kKCIJCUhlbHBlciBvID0gbmV3IEhl
bHBlcigpO1xuIik7CisJCWJ1Zi5hcHBlbmQoIgkJby48QEFubm90IEJhcj5mb28oKTtcbiIpOwor
CQlidWYuYXBwZW5kKCIJCW8uPEBBbm5vdCBAQW5ub3QxIEJhcj5mb28oKTtcbiIpOworCQlidWYu
YXBwZW5kKCIJfVxuIik7CisJCWJ1Zi5hcHBlbmQoIn1cbiIpOworCQlidWYuYXBwZW5kKCJcbiIp
OworCQlidWYuYXBwZW5kKCJAamF2YS5sYW5nLmFubm90YXRpb24uVGFyZ2V0IChFbGVtZW50VHlw
ZS5UWVBFX1VTRSkgXG4iKTsKKwkJYnVmLmFwcGVuZCgiQGludGVyZmFjZSBBbm5vdCB7fVxuIik7
CisJCWJ1Zi5hcHBlbmQoIlxuIik7CisJCWJ1Zi5hcHBlbmQoIkBqYXZhLmxhbmcuYW5ub3RhdGlv
bi5UYXJnZXQgKEVsZW1lbnRUeXBlLlRZUEVfVVNFKSBcbiIpOworCQlidWYuYXBwZW5kKCJAaW50
ZXJmYWNlIEFubm90MSB7fVxuIik7CisKKwkJSUNvbXBpbGF0aW9uVW5pdCBjdT0gcGFjazEuY3Jl
YXRlQ29tcGlsYXRpb25Vbml0KCJYLmphdmEiLCBidWYudG9TdHJpbmcoKSwgZmFsc2UsIG51bGwp
OworCQlDb21waWxhdGlvblVuaXQgYXN0Um9vdD0gY3JlYXRlQVNUKGN1KTsKKwkJQVNUUmV3cml0
ZSByZXdyaXRlPSBBU1RSZXdyaXRlLmNyZWF0ZShhc3RSb290LmdldEFTVCgpKTsKKwkJQVNUIGFz
dD0gYXN0Um9vdC5nZXRBU1QoKTsKKwkJVHlwZURlY2xhcmF0aW9uIHR5cGU9IGZpbmRUeXBlRGVj
bGFyYXRpb24oYXN0Um9vdCwgIlgiKTsKKwkJTWV0aG9kRGVjbGFyYXRpb24gbWV0aG9kRGVjbGFy
YXRpb24gPSBmaW5kTWV0aG9kRGVjbGFyYXRpb24odHlwZSwgInpvbyIpOworCQlMaXN0IHN0YXRl
bUxpc3QgPSBtZXRob2REZWNsYXJhdGlvbi5nZXRCb2R5KCkuc3RhdGVtZW50cygpOworCQl7Ly8g
QWRkIGFuIHVzZSBvZiBhbiBhbm5vdGF0aW9uCisJCQlFeHByZXNzaW9uU3RhdGVtZW50IGV4cHJl
c3Npb249IChFeHByZXNzaW9uU3RhdGVtZW50KSBzdGF0ZW1MaXN0LmdldCgxKTsKKwkJCU1ldGhv
ZEludm9jYXRpb24gbWV0aG9kSW52b2NhdGlvbj0gKE1ldGhvZEludm9jYXRpb24pIGV4cHJlc3Np
b24uZ2V0RXhwcmVzc2lvbigpOworCQkJU2ltcGxlVHlwZSBzaW1wbGVUeXBlID0gKFNpbXBsZVR5
cGUpIG1ldGhvZEludm9jYXRpb24udHlwZUFyZ3VtZW50cygpLmdldCgwKTsKKwkJCU1hcmtlckFu
bm90YXRpb24gbWFya2VyQW5ub3RhdGlvbj0gYXN0Lm5ld01hcmtlckFubm90YXRpb24oKTsKKwkJ
CW1hcmtlckFubm90YXRpb24uc2V0VHlwZU5hbWUoYXN0Lm5ld1NpbXBsZU5hbWUoIkFubm90MiIp
KTsKKwkJCXJld3JpdGUuZ2V0TGlzdFJld3JpdGUoc2ltcGxlVHlwZSwgU2ltcGxlVHlwZS5BTk5P
VEFUSU9OU19QUk9QRVJUWSkuaW5zZXJ0TGFzdChtYXJrZXJBbm5vdGF0aW9uLCBudWxsKTsKKwkJ
fQorCQl7CisJCQlFeHByZXNzaW9uU3RhdGVtZW50IGV4cHJlc3Npb249IChFeHByZXNzaW9uU3Rh
dGVtZW50KSBzdGF0ZW1MaXN0LmdldCgyKTsKKwkJCU1ldGhvZEludm9jYXRpb24gbWV0aG9kSW52
b2NhdGlvbj0gKE1ldGhvZEludm9jYXRpb24pIGV4cHJlc3Npb24uZ2V0RXhwcmVzc2lvbigpOwor
CQkJU2ltcGxlVHlwZSBzaW1wbGVUeXBlID0gKFNpbXBsZVR5cGUpIG1ldGhvZEludm9jYXRpb24u
dHlwZUFyZ3VtZW50cygpLmdldCgwKTsKKwkJCXJld3JpdGUucmVtb3ZlKChNYXJrZXJBbm5vdGF0
aW9uKXNpbXBsZVR5cGUuYW5ub3RhdGlvbnMoKS5nZXQoMSksIG51bGwpOworCQkJTWFya2VyQW5u
b3RhdGlvbiBtYXJrZXJBbm5vdGF0aW9uPSBhc3QubmV3TWFya2VyQW5ub3RhdGlvbigpOworCQkJ
bWFya2VyQW5ub3RhdGlvbi5zZXRUeXBlTmFtZShhc3QubmV3U2ltcGxlTmFtZSgiQW5ub3QyIikp
OworCQkJcmV3cml0ZS5yZXBsYWNlKChNYXJrZXJBbm5vdGF0aW9uKXNpbXBsZVR5cGUuYW5ub3Rh
dGlvbnMoKS5nZXQoMCksIG1hcmtlckFubm90YXRpb24sIG51bGwpOworCQl9CisJCVN0cmluZyBw
cmV2aWV3PSBldmFsdWF0ZVJld3JpdGUoY3UsIHJld3JpdGUpOworCQlidWYgPSBuZXcgU3RyaW5n
QnVmZmVyKCk7CisJCWJ1Zi5hcHBlbmQoImltcG9ydCBqYXZhLmxhbmcuYW5ub3RhdGlvbi5FbGVt
ZW50VHlwZTtcbiIpOworCQlidWYuYXBwZW5kKCJcbiIpOworCQlidWYuYXBwZW5kKCJwdWJsaWMg
Y2xhc3MgWCB7XG4iKTsKKwkJYnVmLmFwcGVuZCgiCXB1YmxpYyBjbGFzcyBCYXIge1xuIik7CisJ
CWJ1Zi5hcHBlbmQoIgl9XG4iKTsKKwkJYnVmLmFwcGVuZCgiCVxuIik7CisJCWJ1Zi5hcHBlbmQo
IglwdWJsaWMgY2xhc3MgSGVscGVyIHtcbiIpOworCQlidWYuYXBwZW5kKCIJCXB1YmxpYyA8VD4g
dm9pZCBmb28oKSB7XG4iKTsKKwkJYnVmLmFwcGVuZCgiCQl9XG4iKTsKKwkJYnVmLmFwcGVuZCgi
CX1cbiIpOworCQlidWYuYXBwZW5kKCIJXG4iKTsKKwkJYnVmLmFwcGVuZCgiCXB1YmxpYyB2b2lk
IHpvbygpIHtcbiIpOworCQlidWYuYXBwZW5kKCIJCUhlbHBlciBvID0gbmV3IEhlbHBlcigpO1xu
Iik7CisJCWJ1Zi5hcHBlbmQoIgkJby48QEFubm90IEBBbm5vdDIgQmFyPmZvbygpO1xuIik7CisJ
CWJ1Zi5hcHBlbmQoIgkJby48QEFubm90MiBCYXI+Zm9vKCk7XG4iKTsKKwkJYnVmLmFwcGVuZCgi
CX1cbiIpOworCQlidWYuYXBwZW5kKCJ9XG4iKTsKKwkJYnVmLmFwcGVuZCgiXG4iKTsKKwkJYnVm
LmFwcGVuZCgiQGphdmEubGFuZy5hbm5vdGF0aW9uLlRhcmdldCAoRWxlbWVudFR5cGUuVFlQRV9V
U0UpIFxuIik7CisJCWJ1Zi5hcHBlbmQoIkBpbnRlcmZhY2UgQW5ub3Qge31cbiIpOworCQlidWYu
YXBwZW5kKCJcbiIpOworCQlidWYuYXBwZW5kKCJAamF2YS5sYW5nLmFubm90YXRpb24uVGFyZ2V0
IChFbGVtZW50VHlwZS5UWVBFX1VTRSkgXG4iKTsKKwkJYnVmLmFwcGVuZCgiQGludGVyZmFjZSBB
bm5vdDEge31cbiIpOworCQlhc3NlcnRFcXVhbFN0cmluZyhwcmV2aWV3LCBidWYudG9TdHJpbmco
KSk7CisJfQorCisJcHVibGljIHZvaWQgdGVzdENsYXNzSW5oZXJpdGVuY2VBbm5vdGF0aW9ucygp
IHRocm93cyBFeGNlcHRpb24geworCQlpZiAodGhpcy5hcGlMZXZlbCA8IEFTVC5KTFM4KSByZXR1
cm47CisJCUlQYWNrYWdlRnJhZ21lbnQgcGFjazE9IHRoaXMuc291cmNlRm9sZGVyLmNyZWF0ZVBh
Y2thZ2VGcmFnbWVudCgidGVzdDEiLCBmYWxzZSwgbnVsbCk7CisJCVN0cmluZ0J1ZmZlciBidWY9
IG5ldyBTdHJpbmdCdWZmZXIoKTsKKworCQlidWYuYXBwZW5kKCJpbXBvcnQgamF2YS5sYW5nLmFu
bm90YXRpb24uRWxlbWVudFR5cGU7XG4iKTsKKwkJYnVmLmFwcGVuZCgiXG4iKTsKKwkJYnVmLmFw
cGVuZCgicHVibGljIGNsYXNzIFgge1xuIik7CisJCWJ1Zi5hcHBlbmQoIglwdWJsaWMgaW50ZXJm
YWNlIEhlbHBlcjxUPiB7XG4iKTsKKwkJYnVmLmFwcGVuZCgiCX1cbiIpOworCQlidWYuYXBwZW5k
KCIJcHVibGljIGNsYXNzIEZvbzE8VD4gaW1wbGVtZW50cyBAQW5ub3QgSGVscGVyPFQ+IHtcbiIp
OworCQlidWYuYXBwZW5kKCIJfVxuIik7CisJCWJ1Zi5hcHBlbmQoIglwdWJsaWMgY2xhc3MgRm9v
MjxUPiBpbXBsZW1lbnRzIEBBbm5vdCBAQW5ub3QxIEhlbHBlcjxUPiB7XG4iKTsKKwkJYnVmLmFw
cGVuZCgiCX1cbiIpOworCQlidWYuYXBwZW5kKCJ9XG4iKTsKKwkJYnVmLmFwcGVuZCgiXG4iKTsK
KwkJYnVmLmFwcGVuZCgiQGphdmEubGFuZy5hbm5vdGF0aW9uLlRhcmdldCAoRWxlbWVudFR5cGUu
VFlQRV9VU0UpXG4iKTsKKwkJYnVmLmFwcGVuZCgiQGludGVyZmFjZSBBbm5vdCB7fVxuIik7CisJ
CWJ1Zi5hcHBlbmQoIlxuIik7CisJCWJ1Zi5hcHBlbmQoIkBqYXZhLmxhbmcuYW5ub3RhdGlvbi5U
YXJnZXQgKEVsZW1lbnRUeXBlLlRZUEVfVVNFKVxuIik7CisJCWJ1Zi5hcHBlbmQoIkBpbnRlcmZh
Y2UgQW5ub3QxIHt9XG4iKTsKKworCQlJQ29tcGlsYXRpb25Vbml0IGN1PSBwYWNrMS5jcmVhdGVD
b21waWxhdGlvblVuaXQoIlguamF2YSIsIGJ1Zi50b1N0cmluZygpLCBmYWxzZSwgbnVsbCk7CisJ
CUNvbXBpbGF0aW9uVW5pdCBhc3RSb290PSBjcmVhdGVBU1QoY3UpOworCQlBU1RSZXdyaXRlIHJl
d3JpdGU9IEFTVFJld3JpdGUuY3JlYXRlKGFzdFJvb3QuZ2V0QVNUKCkpOworCQlBU1QgYXN0PSBh
c3RSb290LmdldEFTVCgpOworCQlUeXBlRGVjbGFyYXRpb24gdHlwZT0gZmluZFR5cGVEZWNsYXJh
dGlvbihhc3RSb290LCAiWCIpOworCQl7Ly9BZGQgdGhlIHVzZSBvZiBhbiBhbm5vdGF0aW9uCisJ
CQlUeXBlRGVjbGFyYXRpb24gdHlwZURlY2xhcmF0aW9uPSAoVHlwZURlY2xhcmF0aW9uKSB0eXBl
LmJvZHlEZWNsYXJhdGlvbnMoKS5nZXQoMSk7CisJCQlQYXJhbWV0ZXJpemVkVHlwZSBwYXJhbWV0
ZXJpemVkVHlwZT0gKFBhcmFtZXRlcml6ZWRUeXBlKSB0eXBlRGVjbGFyYXRpb24uc3VwZXJJbnRl
cmZhY2VUeXBlcygpLmdldCgwKTsKKwkJCVNpbXBsZVR5cGUgc2ltcGxlVHlwZT0gKFNpbXBsZVR5
cGUpIHBhcmFtZXRlcml6ZWRUeXBlLmdldFR5cGUoKTsKKwkJCU1hcmtlckFubm90YXRpb24gbWFy
a2VyQW5ub3RhdGlvbj0gYXN0Lm5ld01hcmtlckFubm90YXRpb24oKTsKKwkJCW1hcmtlckFubm90
YXRpb24uc2V0VHlwZU5hbWUoYXN0Lm5ld1NpbXBsZU5hbWUoIkFubm90MiIpKTsKKwkJCXJld3Jp
dGUuZ2V0TGlzdFJld3JpdGUoc2ltcGxlVHlwZSwgU2ltcGxlVHlwZS5BTk5PVEFUSU9OU19QUk9Q
RVJUWSkuaW5zZXJ0TGFzdChtYXJrZXJBbm5vdGF0aW9uLCBudWxsKTsKKwkJfQorCQl7CisJCQlU
eXBlRGVjbGFyYXRpb24gdHlwZURlY2xhcmF0aW9uPSAoVHlwZURlY2xhcmF0aW9uKSB0eXBlLmJv
ZHlEZWNsYXJhdGlvbnMoKS5nZXQoMik7CisJCQlQYXJhbWV0ZXJpemVkVHlwZSBwYXJhbWV0ZXJp
emVkVHlwZT0gKFBhcmFtZXRlcml6ZWRUeXBlKSB0eXBlRGVjbGFyYXRpb24uc3VwZXJJbnRlcmZh
Y2VUeXBlcygpLmdldCgwKTsKKwkJCVNpbXBsZVR5cGUgc2ltcGxlVHlwZT0gKFNpbXBsZVR5cGUp
IHBhcmFtZXRlcml6ZWRUeXBlLmdldFR5cGUoKTsKKwkJCS8vUmVtb3ZlIHRoZSB1c2Ugb2YgYW4g
YW5ub3RhdGlvbgorCQkJcmV3cml0ZS5yZW1vdmUoKE1hcmtlckFubm90YXRpb24pIHNpbXBsZVR5
cGUuYW5ub3RhdGlvbnMoKS5nZXQoMSksIG51bGwpOworCQkJLy9SZXBsYWNlIHRoZSB1c2Ugb2Yg
YW4gYW5ub3RhdGlvbgorCQkJTWFya2VyQW5ub3RhdGlvbiBtYXJrZXJBbm5vdGF0aW9uPSBhc3Qu
bmV3TWFya2VyQW5ub3RhdGlvbigpOworCQkJbWFya2VyQW5ub3RhdGlvbi5zZXRUeXBlTmFtZShh
c3QubmV3U2ltcGxlTmFtZSgiQW5ub3QyIikpOworCQkJcmV3cml0ZS5yZXBsYWNlKChNYXJrZXJB
bm5vdGF0aW9uKSBzaW1wbGVUeXBlLmFubm90YXRpb25zKCkuZ2V0KDApLCBtYXJrZXJBbm5vdGF0
aW9uLCBudWxsKTsKKwkJfQorCQlTdHJpbmcgcHJldmlldz0gZXZhbHVhdGVSZXdyaXRlKGN1LCBy
ZXdyaXRlKTsKKwkJYnVmID0gbmV3IFN0cmluZ0J1ZmZlcigpOworCQlidWYuYXBwZW5kKCJpbXBv
cnQgamF2YS5sYW5nLmFubm90YXRpb24uRWxlbWVudFR5cGU7XG4iKTsKKwkJYnVmLmFwcGVuZCgi
XG4iKTsKKwkJYnVmLmFwcGVuZCgicHVibGljIGNsYXNzIFgge1xuIik7CisJCWJ1Zi5hcHBlbmQo
IglwdWJsaWMgaW50ZXJmYWNlIEhlbHBlcjxUPiB7XG4iKTsKKwkJYnVmLmFwcGVuZCgiCX1cbiIp
OworCQlidWYuYXBwZW5kKCIJcHVibGljIGNsYXNzIEZvbzE8VD4gaW1wbGVtZW50cyBAQW5ub3Qg
QEFubm90MiBIZWxwZXI8VD4ge1xuIik7CisJCWJ1Zi5hcHBlbmQoIgl9XG4iKTsKKwkJYnVmLmFw
cGVuZCgiCXB1YmxpYyBjbGFzcyBGb28yPFQ+IGltcGxlbWVudHMgQEFubm90MiBIZWxwZXI8VD4g
e1xuIik7CisJCWJ1Zi5hcHBlbmQoIgl9XG4iKTsKKwkJYnVmLmFwcGVuZCgifVxuIik7CisJCWJ1
Zi5hcHBlbmQoIlxuIik7CisJCWJ1Zi5hcHBlbmQoIkBqYXZhLmxhbmcuYW5ub3RhdGlvbi5UYXJn
ZXQgKEVsZW1lbnRUeXBlLlRZUEVfVVNFKVxuIik7CisJCWJ1Zi5hcHBlbmQoIkBpbnRlcmZhY2Ug
QW5ub3Qge31cbiIpOworCQlidWYuYXBwZW5kKCJcbiIpOworCQlidWYuYXBwZW5kKCJAamF2YS5s
YW5nLmFubm90YXRpb24uVGFyZ2V0IChFbGVtZW50VHlwZS5UWVBFX1VTRSlcbiIpOworCQlidWYu
YXBwZW5kKCJAaW50ZXJmYWNlIEFubm90MSB7fVxuIik7CisJCWFzc2VydEVxdWFsU3RyaW5nKHBy
ZXZpZXcsIGJ1Zi50b1N0cmluZygpKTsKKwl9CisKKwlwdWJsaWMgdm9pZCB0ZXN0VHlwZVRlc3Rz
KCkgdGhyb3dzIEV4Y2VwdGlvbiB7CisJCWlmICh0aGlzLmFwaUxldmVsIDwgQVNULkpMUzgpIHJl
dHVybjsKKwkJSVBhY2thZ2VGcmFnbWVudCBwYWNrMT0gdGhpcy5zb3VyY2VGb2xkZXIuY3JlYXRl
UGFja2FnZUZyYWdtZW50KCJ0ZXN0MSIsIGZhbHNlLCBudWxsKTsKKwkJU3RyaW5nQnVmZmVyIGJ1
Zj0gbmV3IFN0cmluZ0J1ZmZlcigpOworCisJCWJ1Zi5hcHBlbmQoImltcG9ydCBqYXZhLmxhbmcu
YW5ub3RhdGlvbi5FbGVtZW50VHlwZTtcbiIpOworCQlidWYuYXBwZW5kKCJcbiIpOworCQlidWYu
YXBwZW5kKCJwdWJsaWMgY2xhc3MgWCB7XG4iKTsKKwkJYnVmLmFwcGVuZCgiCXB1YmxpYyBjbGFz
cyBIZWxwZXIge1xuIik7CisJCWJ1Zi5hcHBlbmQoIgl9XG4iKTsKKwkJYnVmLmFwcGVuZCgiCVxu
Iik7CisJCWJ1Zi5hcHBlbmQoIglwdWJsaWMgdm9pZCBmb28oKSB7XG4iKTsKKwkJYnVmLmFwcGVu
ZCgiCUhlbHBlciBhID0gbmV3IEBBbm5vdCBIZWxwZXIoKTtcbiIpOworCQlidWYuYXBwZW5kKCIJ
Ym9vbGVhbiB4ID0gdHJ1ZTtcbiIpOworCQlidWYuYXBwZW5kKCIJeCA9IGEgaW5zdGFuY2VvZiBA
QW5ub3QgSGVscGVyO1xuIik7CisJCWJ1Zi5hcHBlbmQoIgl4ID0gYSBpbnN0YW5jZW9mIEBBbm5v
dCBAQW5ub3QxIEhlbHBlcjtcbiIpOworCQlidWYuYXBwZW5kKCIJfVxuIik7CisJCWJ1Zi5hcHBl
bmQoIn1cbiIpOworCQlidWYuYXBwZW5kKCJcbiIpOworCQlidWYuYXBwZW5kKCJAamF2YS5sYW5n
LmFubm90YXRpb24uVGFyZ2V0IChFbGVtZW50VHlwZS5UWVBFX1VTRSlcbiIpOworCQlidWYuYXBw
ZW5kKCJAaW50ZXJmYWNlIEFubm90IHt9XG4iKTsKKwkJYnVmLmFwcGVuZCgiXG4iKTsKKwkJYnVm
LmFwcGVuZCgiQGphdmEubGFuZy5hbm5vdGF0aW9uLlRhcmdldCAoRWxlbWVudFR5cGUuVFlQRV9V
U0UpXG4iKTsKKwkJYnVmLmFwcGVuZCgiQGludGVyZmFjZSBBbm5vdDEge31cbiIpOworCisJCUlD
b21waWxhdGlvblVuaXQgY3U9IHBhY2sxLmNyZWF0ZUNvbXBpbGF0aW9uVW5pdCgiWC5qYXZhIiwg
YnVmLnRvU3RyaW5nKCksIGZhbHNlLCBudWxsKTsKKwkJQ29tcGlsYXRpb25Vbml0IGFzdFJvb3Q9
IGNyZWF0ZUFTVChjdSk7CisJCUFTVFJld3JpdGUgcmV3cml0ZT0gQVNUUmV3cml0ZS5jcmVhdGUo
YXN0Um9vdC5nZXRBU1QoKSk7CisJCUFTVCBhc3Q9IGFzdFJvb3QuZ2V0QVNUKCk7CisJCVR5cGVE
ZWNsYXJhdGlvbiB0eXBlPSBmaW5kVHlwZURlY2xhcmF0aW9uKGFzdFJvb3QsICJYIik7CisJCU1l
dGhvZERlY2xhcmF0aW9uIG1ldGhvZERlY2xhcmF0aW9uPSBmaW5kTWV0aG9kRGVjbGFyYXRpb24o
dHlwZSwgImZvbyIpOworCQl7Ly9BZGQgYW4gdXNlIG9mIGFubm90YXRpb24KKwkJCUV4cHJlc3Np
b25TdGF0ZW1lbnQgZXhwcmVzc2lvblN0YXRlbWVudD0gKEV4cHJlc3Npb25TdGF0ZW1lbnQpIG1l
dGhvZERlY2xhcmF0aW9uLmdldEJvZHkoKS5zdGF0ZW1lbnRzKCkuZ2V0KDIpOworCQkJQXNzaWdu
bWVudCBhc3NpZ25tZW50PSAoQXNzaWdubWVudCkgZXhwcmVzc2lvblN0YXRlbWVudC5nZXRFeHBy
ZXNzaW9uKCk7CisJCQlJbnN0YW5jZW9mRXhwcmVzc2lvbiBpbnN0YW5jZW9mRXhwcmVzc2lvbj0g
KEluc3RhbmNlb2ZFeHByZXNzaW9uKSBhc3NpZ25tZW50LmdldFJpZ2h0SGFuZFNpZGUoKTsKKwkJ
CVNpbXBsZVR5cGUgc2ltcGxlVHlwZSA9IChTaW1wbGVUeXBlKSBpbnN0YW5jZW9mRXhwcmVzc2lv
bi5nZXRSaWdodE9wZXJhbmQoKTsKKwkJCU1hcmtlckFubm90YXRpb24gbWFya2VyQW5ub3RhdGlv
bj0gYXN0Lm5ld01hcmtlckFubm90YXRpb24oKTsKKwkJCW1hcmtlckFubm90YXRpb24uc2V0VHlw
ZU5hbWUoYXN0Lm5ld1NpbXBsZU5hbWUoIkFubm90MiIpKTsKKwkJCXJld3JpdGUuZ2V0TGlzdFJl
d3JpdGUoc2ltcGxlVHlwZSwgU2ltcGxlVHlwZS5BTk5PVEFUSU9OU19QUk9QRVJUWSkuaW5zZXJ0
TGFzdChtYXJrZXJBbm5vdGF0aW9uLCBudWxsKTsKKwkJfQorCQl7CisJCQlFeHByZXNzaW9uU3Rh
dGVtZW50IGV4cHJlc3Npb25TdGF0ZW1lbnQ9IChFeHByZXNzaW9uU3RhdGVtZW50KSBtZXRob2RE
ZWNsYXJhdGlvbi5nZXRCb2R5KCkuc3RhdGVtZW50cygpLmdldCgzKTsKKwkJCUFzc2lnbm1lbnQg
YXNzaWdubWVudD0gKEFzc2lnbm1lbnQpIGV4cHJlc3Npb25TdGF0ZW1lbnQuZ2V0RXhwcmVzc2lv
bigpOworCQkJSW5zdGFuY2VvZkV4cHJlc3Npb24gaW5zdGFuY2VvZkV4cHJlc3Npb249IChJbnN0
YW5jZW9mRXhwcmVzc2lvbikgYXNzaWdubWVudC5nZXRSaWdodEhhbmRTaWRlKCk7CisJCQlTaW1w
bGVUeXBlIHNpbXBsZVR5cGUgPSAoU2ltcGxlVHlwZSkgaW5zdGFuY2VvZkV4cHJlc3Npb24uZ2V0
UmlnaHRPcGVyYW5kKCk7CisJCQkvL1JlbW92ZSBhbiB1c2Ugb2YgYW5ub3RhdGlvbgorCQkJcmV3
cml0ZS5yZW1vdmUoKE1hcmtlckFubm90YXRpb24pIHNpbXBsZVR5cGUuYW5ub3RhdGlvbnMoKS5n
ZXQoMSksIG51bGwpOworCQkJTWFya2VyQW5ub3RhdGlvbiBtYXJrZXJBbm5vdGF0aW9uPSBhc3Qu
bmV3TWFya2VyQW5ub3RhdGlvbigpOworCQkJbWFya2VyQW5ub3RhdGlvbi5zZXRUeXBlTmFtZShh
c3QubmV3U2ltcGxlTmFtZSgiQW5ub3QyIikpOworCQkJLy9SZXBsYWNlIGFuIHVzZSBvZiBhbm5v
dGF0aW9uCisJCQlyZXdyaXRlLnJlcGxhY2UoKE1hcmtlckFubm90YXRpb24pIHNpbXBsZVR5cGUu
YW5ub3RhdGlvbnMoKS5nZXQoMCksIG1hcmtlckFubm90YXRpb24sIG51bGwpOworCQl9CisJCVN0
cmluZyBwcmV2aWV3PSBldmFsdWF0ZVJld3JpdGUoY3UsIHJld3JpdGUpOworCQlidWYgPSBuZXcg
U3RyaW5nQnVmZmVyKCk7CisJCWJ1Zi5hcHBlbmQoImltcG9ydCBqYXZhLmxhbmcuYW5ub3RhdGlv
bi5FbGVtZW50VHlwZTtcbiIpOworCQlidWYuYXBwZW5kKCJcbiIpOworCQlidWYuYXBwZW5kKCJw
dWJsaWMgY2xhc3MgWCB7XG4iKTsKKwkJYnVmLmFwcGVuZCgiCXB1YmxpYyBjbGFzcyBIZWxwZXIg
e1xuIik7CisJCWJ1Zi5hcHBlbmQoIgl9XG4iKTsKKwkJYnVmLmFwcGVuZCgiCVxuIik7CisJCWJ1
Zi5hcHBlbmQoIglwdWJsaWMgdm9pZCBmb28oKSB7XG4iKTsKKwkJYnVmLmFwcGVuZCgiCUhlbHBl
ciBhID0gbmV3IEBBbm5vdCBIZWxwZXIoKTtcbiIpOworCQlidWYuYXBwZW5kKCIJYm9vbGVhbiB4
ID0gdHJ1ZTtcbiIpOworCQlidWYuYXBwZW5kKCIJeCA9IGEgaW5zdGFuY2VvZiBAQW5ub3QgQEFu
bm90MiBIZWxwZXI7XG4iKTsKKwkJYnVmLmFwcGVuZCgiCXggPSBhIGluc3RhbmNlb2YgQEFubm90
MiBIZWxwZXI7XG4iKTsKKwkJYnVmLmFwcGVuZCgiCX1cbiIpOworCQlidWYuYXBwZW5kKCJ9XG4i
KTsKKwkJYnVmLmFwcGVuZCgiXG4iKTsKKwkJYnVmLmFwcGVuZCgiQGphdmEubGFuZy5hbm5vdGF0
aW9uLlRhcmdldCAoRWxlbWVudFR5cGUuVFlQRV9VU0UpXG4iKTsKKwkJYnVmLmFwcGVuZCgiQGlu
dGVyZmFjZSBBbm5vdCB7fVxuIik7CisJCWJ1Zi5hcHBlbmQoIlxuIik7CisJCWJ1Zi5hcHBlbmQo
IkBqYXZhLmxhbmcuYW5ub3RhdGlvbi5UYXJnZXQgKEVsZW1lbnRUeXBlLlRZUEVfVVNFKVxuIik7
CisJCWJ1Zi5hcHBlbmQoIkBpbnRlcmZhY2UgQW5ub3QxIHt9XG4iKTsKKwkJYXNzZXJ0RXF1YWxT
dHJpbmcocHJldmlldywgYnVmLnRvU3RyaW5nKCkpOworCX0KKworCXB1YmxpYyB2b2lkIHRlc3RD
b25zdHJ1Y3Rvckludm9jYXRpb24oKSB0aHJvd3MgRXhjZXB0aW9uIHsKKwkJaWYgKHRoaXMuYXBp
TGV2ZWwgPCBBU1QuSkxTOCkgcmV0dXJuOworCQlJUGFja2FnZUZyYWdtZW50IHBhY2sxPSB0aGlz
LnNvdXJjZUZvbGRlci5jcmVhdGVQYWNrYWdlRnJhZ21lbnQoInRlc3QxIiwgZmFsc2UsIG51bGwp
OworCQlTdHJpbmdCdWZmZXIgYnVmPSBuZXcgU3RyaW5nQnVmZmVyKCk7CisJCWJ1Zi5hcHBlbmQo
ImltcG9ydCBqYXZhLmxhbmcuYW5ub3RhdGlvbi5FbGVtZW50VHlwZTtcbiIpOworCQlidWYuYXBw
ZW5kKCIgXG4iKTsKKwkJYnVmLmFwcGVuZCgicHVibGljIGNsYXNzIFgge1xuIik7CisJCWJ1Zi5h
cHBlbmQoIglwdWJsaWMgY2xhc3MgSGVscGVyIHtcbiIpOworCQlidWYuYXBwZW5kKCIJfQlcbiIp
OworCQlidWYuYXBwZW5kKCIJcHVibGljIHZvaWQgZm9vKCkge1xuIik7CisJCWJ1Zi5hcHBlbmQo
IgkJSGVscGVyIG9iaiA9IG5ldyBAQW5ub3QgSGVscGVyKCk7XG4iKTsKKwkJYnVmLmFwcGVuZCgi
CQlvYmogPSBuZXcgQEFubm90IEBBbm5vdDEgSGVscGVyKCk7XG4iKTsKKwkJYnVmLmFwcGVuZCgi
CX1cbiIpOworCQlidWYuYXBwZW5kKCJ9XG4iKTsKKwkJYnVmLmFwcGVuZCgiXG4iKTsKKwkJYnVm
LmFwcGVuZCgiQGphdmEubGFuZy5hbm5vdGF0aW9uLlRhcmdldCAoRWxlbWVudFR5cGUuVFlQRV9V
U0UpXG4iKTsKKwkJYnVmLmFwcGVuZCgiQGludGVyZmFjZSBBbm5vdCB7fVxuIik7CisJCWJ1Zi5h
cHBlbmQoIlxuIik7CisJCWJ1Zi5hcHBlbmQoIkBqYXZhLmxhbmcuYW5ub3RhdGlvbi5UYXJnZXQg
KEVsZW1lbnRUeXBlLlRZUEVfVVNFKVxuIik7CisJCWJ1Zi5hcHBlbmQoIkBpbnRlcmZhY2UgQW5u
b3QxIHt9XG4iKTsKKworCQlJQ29tcGlsYXRpb25Vbml0IGN1PSBwYWNrMS5jcmVhdGVDb21waWxh
dGlvblVuaXQoIlguamF2YSIsIGJ1Zi50b1N0cmluZygpLCBmYWxzZSwgbnVsbCk7CisJCUNvbXBp
bGF0aW9uVW5pdCBhc3RSb290PSBjcmVhdGVBU1QoY3UpOworCQlBU1RSZXdyaXRlIHJld3JpdGU9
IEFTVFJld3JpdGUuY3JlYXRlKGFzdFJvb3QuZ2V0QVNUKCkpOworCQlBU1QgYXN0PSBhc3RSb290
LmdldEFTVCgpOworCQlUeXBlRGVjbGFyYXRpb24gdHlwZT0gZmluZFR5cGVEZWNsYXJhdGlvbihh
c3RSb290LCAiWCIpOworCQlNZXRob2REZWNsYXJhdGlvbiBtZXRob2REZWNsYXJhdGlvbj0gZmlu
ZE1ldGhvZERlY2xhcmF0aW9uKHR5cGUsICJmb28iKTsKKwkJTGlzdCBzdGF0ZW1lbnRzPSBtZXRo
b2REZWNsYXJhdGlvbi5nZXRCb2R5KCkuc3RhdGVtZW50cygpOworCQl7Ly9BZGQgYW4gdXNlIG9m
IGFubm90YXRpb24KKwkJCVZhcmlhYmxlRGVjbGFyYXRpb25TdGF0ZW1lbnQgIHZhcmlhYmxlRGVj
bGFyYXRpb25TdGF0ZW1lbnQ9IChWYXJpYWJsZURlY2xhcmF0aW9uU3RhdGVtZW50KSBzdGF0ZW1l
bnRzLmdldCgwKTsKKwkJCVZhcmlhYmxlRGVjbGFyYXRpb25GcmFnbWVudCB2YXJpYWJsZURlY2xh
cmF0aW9uRnJhZ21lbnQ9IChWYXJpYWJsZURlY2xhcmF0aW9uRnJhZ21lbnQpIHZhcmlhYmxlRGVj
bGFyYXRpb25TdGF0ZW1lbnQuZnJhZ21lbnRzKCkuZ2V0KDApOworCQkJQ2xhc3NJbnN0YW5jZUNy
ZWF0aW9uIGNsYXNzSW5zdGFuY2VDcmVhdGlvbiA9IChDbGFzc0luc3RhbmNlQ3JlYXRpb24pIHZh
cmlhYmxlRGVjbGFyYXRpb25GcmFnbWVudC5nZXRJbml0aWFsaXplcigpOworCQkJU2ltcGxlVHlw
ZSBzaW1wbGVUeXBlID0gKFNpbXBsZVR5cGUpIGNsYXNzSW5zdGFuY2VDcmVhdGlvbi5nZXRUeXBl
KCk7CisJCQlNYXJrZXJBbm5vdGF0aW9uIG1hcmtlckFubm90YXRpb249IGFzdC5uZXdNYXJrZXJB
bm5vdGF0aW9uKCk7CisJCQltYXJrZXJBbm5vdGF0aW9uLnNldFR5cGVOYW1lKGFzdC5uZXdTaW1w
bGVOYW1lKCJBbm5vdDIiKSk7CisJCQlyZXdyaXRlLmdldExpc3RSZXdyaXRlKHNpbXBsZVR5cGUs
IFNpbXBsZVR5cGUuQU5OT1RBVElPTlNfUFJPUEVSVFkpLmluc2VydExhc3QobWFya2VyQW5ub3Rh
dGlvbiwgbnVsbCk7CisJCX0KKwkJeworCQkJRXhwcmVzc2lvblN0YXRlbWVudCBleHByZXNzaW9u
U3RhdGVtZW50PSAoRXhwcmVzc2lvblN0YXRlbWVudCkgbWV0aG9kRGVjbGFyYXRpb24uZ2V0Qm9k
eSgpLnN0YXRlbWVudHMoKS5nZXQoMSk7CisJCQlBc3NpZ25tZW50IGFzc2lnbm1lbnQ9IChBc3Np
Z25tZW50KSBleHByZXNzaW9uU3RhdGVtZW50LmdldEV4cHJlc3Npb24oKTsKKwkJCUNsYXNzSW5z
dGFuY2VDcmVhdGlvbiBjbGFzc0luc3RhbmNlQ3JlYXRpb24gPSAoQ2xhc3NJbnN0YW5jZUNyZWF0
aW9uKSBhc3NpZ25tZW50LmdldFJpZ2h0SGFuZFNpZGUoKTsKKwkJCVNpbXBsZVR5cGUgc2ltcGxl
VHlwZSA9IChTaW1wbGVUeXBlKSBjbGFzc0luc3RhbmNlQ3JlYXRpb24uZ2V0VHlwZSgpOworCQkJ
Ly9SZW1vdmUgYW4gdXNlIG9mIGFubm90YXRpb24KKwkJCXJld3JpdGUucmVtb3ZlKChNYXJrZXJB
bm5vdGF0aW9uKSBzaW1wbGVUeXBlLmFubm90YXRpb25zKCkuZ2V0KDEpLCBudWxsKTsKKwkJCU1h
cmtlckFubm90YXRpb24gbWFya2VyQW5ub3RhdGlvbj0gYXN0Lm5ld01hcmtlckFubm90YXRpb24o
KTsKKwkJCW1hcmtlckFubm90YXRpb24uc2V0VHlwZU5hbWUoYXN0Lm5ld1NpbXBsZU5hbWUoIkFu
bm90MiIpKTsKKwkJCS8vUmVwbGFjZSBhbiB1c2Ugb2YgYW5ub3RhdGlvbgorCQkJcmV3cml0ZS5y
ZXBsYWNlKChNYXJrZXJBbm5vdGF0aW9uKSBzaW1wbGVUeXBlLmFubm90YXRpb25zKCkuZ2V0KDAp
LCBtYXJrZXJBbm5vdGF0aW9uLCBudWxsKTsKKwkJfQorCQlTdHJpbmcgcHJldmlldz0gZXZhbHVh
dGVSZXdyaXRlKGN1LCByZXdyaXRlKTsKKwkJYnVmID0gbmV3IFN0cmluZ0J1ZmZlcigpOworCQli
dWYuYXBwZW5kKCJpbXBvcnQgamF2YS5sYW5nLmFubm90YXRpb24uRWxlbWVudFR5cGU7XG4iKTsK
KwkJYnVmLmFwcGVuZCgiIFxuIik7CisJCWJ1Zi5hcHBlbmQoInB1YmxpYyBjbGFzcyBYIHtcbiIp
OworCQlidWYuYXBwZW5kKCIJcHVibGljIGNsYXNzIEhlbHBlciB7XG4iKTsKKwkJYnVmLmFwcGVu
ZCgiCX0JXG4iKTsKKwkJYnVmLmFwcGVuZCgiCXB1YmxpYyB2b2lkIGZvbygpIHtcbiIpOworCQli
dWYuYXBwZW5kKCIJCUhlbHBlciBvYmogPSBuZXcgQEFubm90IEBBbm5vdDIgSGVscGVyKCk7XG4i
KTsKKwkJYnVmLmFwcGVuZCgiCQlvYmogPSBuZXcgQEFubm90MiBIZWxwZXIoKTtcbiIpOworCQli
dWYuYXBwZW5kKCIJfVxuIik7CisJCWJ1Zi5hcHBlbmQoIn1cbiIpOworCQlidWYuYXBwZW5kKCJc
biIpOworCQlidWYuYXBwZW5kKCJAamF2YS5sYW5nLmFubm90YXRpb24uVGFyZ2V0IChFbGVtZW50
VHlwZS5UWVBFX1VTRSlcbiIpOworCQlidWYuYXBwZW5kKCJAaW50ZXJmYWNlIEFubm90IHt9XG4i
KTsKKwkJYnVmLmFwcGVuZCgiXG4iKTsKKwkJYnVmLmFwcGVuZCgiQGphdmEubGFuZy5hbm5vdGF0
aW9uLlRhcmdldCAoRWxlbWVudFR5cGUuVFlQRV9VU0UpXG4iKTsKKwkJYnVmLmFwcGVuZCgiQGlu
dGVyZmFjZSBBbm5vdDEge31cbiIpOworCQlhc3NlcnRFcXVhbFN0cmluZyhwcmV2aWV3LCBidWYu
dG9TdHJpbmcoKSk7CisJfQorCisJcHVibGljIHZvaWQgdGVzdENvbnN0cnVjdG9yRGVjbGFyYXRp
b24oKSB0aHJvd3MgRXhjZXB0aW9uIHsKKwkJaWYgKHRoaXMuYXBpTGV2ZWwgPCBBU1QuSkxTOCkg
cmV0dXJuOworCQlJUGFja2FnZUZyYWdtZW50IHBhY2sxPSB0aGlzLnNvdXJjZUZvbGRlci5jcmVh
dGVQYWNrYWdlRnJhZ21lbnQoInRlc3QxIiwgZmFsc2UsIG51bGwpOworCQlTdHJpbmdCdWZmZXIg
YnVmPSBuZXcgU3RyaW5nQnVmZmVyKCk7CisJCWJ1Zi5hcHBlbmQoImltcG9ydCBqYXZhLmxhbmcu
YW5ub3RhdGlvbi5FbGVtZW50VHlwZTtcbiIpOworCQlidWYuYXBwZW5kKCJcbiIpOworCQlidWYu
YXBwZW5kKCJwdWJsaWMgY2xhc3MgWCB7XG4iKTsKKwkJYnVmLmFwcGVuZCgiCUBBbm5vdCBYICgp
IHtcbiIpOworCQlidWYuYXBwZW5kKCIJfVxuIik7CisJCWJ1Zi5hcHBlbmQoIglAQW5ub3QgQEFu
bm90MSBYIChpbnQgeCkge1xuIik7CisJCWJ1Zi5hcHBlbmQoIgl9XG4iKTsKKwkJYnVmLmFwcGVu
ZCgifVxuIik7CisJCWJ1Zi5hcHBlbmQoIlxuIik7CisJCWJ1Zi5hcHBlbmQoIkBqYXZhLmxhbmcu
YW5ub3RhdGlvbi5UYXJnZXQgKEVsZW1lbnRUeXBlLlRZUEVfVVNFKVxuIik7CisJCWJ1Zi5hcHBl
bmQoIkBpbnRlcmZhY2UgQW5ub3Qge31cbiIpOworCQlidWYuYXBwZW5kKCJcbiIpOworCQlidWYu
YXBwZW5kKCJAamF2YS5sYW5nLmFubm90YXRpb24uVGFyZ2V0IChFbGVtZW50VHlwZS5UWVBFX1VT
RSlcbiIpOworCQlidWYuYXBwZW5kKCJAaW50ZXJmYWNlIEFubm90MSB7fVxuIik7CisKKwkJSUNv
bXBpbGF0aW9uVW5pdCBjdT0gcGFjazEuY3JlYXRlQ29tcGlsYXRpb25Vbml0KCJYLmphdmEiLCBi
dWYudG9TdHJpbmcoKSwgZmFsc2UsIG51bGwpOworCQlDb21waWxhdGlvblVuaXQgYXN0Um9vdD0g
Y3JlYXRlQVNUKGN1KTsKKwkJQVNUUmV3cml0ZSByZXdyaXRlPSBBU1RSZXdyaXRlLmNyZWF0ZShh
c3RSb290LmdldEFTVCgpKTsKKwkJQVNUIGFzdD0gYXN0Um9vdC5nZXRBU1QoKTsKKwkJVHlwZURl
Y2xhcmF0aW9uIHR5cGU9IGZpbmRUeXBlRGVjbGFyYXRpb24oYXN0Um9vdCwgIlgiKTsKKwkJey8v
QWRkIHRoZSB1c2Ugb2YgYW5ub3RhdGlvbgorCQkJTWV0aG9kRGVjbGFyYXRpb24gbWV0aG9kRGVj
bGFyYXRpb249IChNZXRob2REZWNsYXJhdGlvbikgdHlwZS5ib2R5RGVjbGFyYXRpb25zKCkuZ2V0
KDApOworCQkJTWFya2VyQW5ub3RhdGlvbiBtYXJrZXJBbm5vdGF0aW9uPSBhc3QubmV3TWFya2Vy
QW5ub3RhdGlvbigpOworCQkJbWFya2VyQW5ub3RhdGlvbi5zZXRUeXBlTmFtZShhc3QubmV3U2lt
cGxlTmFtZSgiQW5ub3QyIikpOworCQkJcmV3cml0ZS5nZXRMaXN0UmV3cml0ZShtZXRob2REZWNs
YXJhdGlvbiwgTWV0aG9kRGVjbGFyYXRpb24uTU9ESUZJRVJTMl9QUk9QRVJUWSkuaW5zZXJ0TGFz
dChtYXJrZXJBbm5vdGF0aW9uLCBudWxsKTsKKwkJfQorCQl7CisJCQkvL1JlbW92ZSB0aGUgdXNl
IG9mIGFubm90YXRpb24KKwkJCU1ldGhvZERlY2xhcmF0aW9uIG1ldGhvZERlY2xhcmF0aW9uPSAo
TWV0aG9kRGVjbGFyYXRpb24pIHR5cGUuYm9keURlY2xhcmF0aW9ucygpLmdldCgxKTsKKwkJCXJl
d3JpdGUucmVtb3ZlKChNYXJrZXJBbm5vdGF0aW9uKSBtZXRob2REZWNsYXJhdGlvbi5tb2RpZmll
cnMoKS5nZXQoMSksIG51bGwpOworCQkJLy9SZXBsYWNlIHRoZSB1c2Ugb2YgYW5ub3RhdGlvbgor
CQkJTWFya2VyQW5ub3RhdGlvbiBtYXJrZXJBbm5vdGF0aW9uPSBhc3QubmV3TWFya2VyQW5ub3Rh
dGlvbigpOworCQkJbWFya2VyQW5ub3RhdGlvbi5zZXRUeXBlTmFtZShhc3QubmV3U2ltcGxlTmFt
ZSgiQW5ub3QyIikpOworCQkJcmV3cml0ZS5yZXBsYWNlKChNYXJrZXJBbm5vdGF0aW9uKSBtZXRo
b2REZWNsYXJhdGlvbi5tb2RpZmllcnMoKS5nZXQoMCksIG1hcmtlckFubm90YXRpb24sIG51bGwp
OworCQl9CisJCVN0cmluZyBwcmV2aWV3PSBldmFsdWF0ZVJld3JpdGUoY3UsIHJld3JpdGUpOwor
CQlidWYgPSBuZXcgU3RyaW5nQnVmZmVyKCk7CisJCWJ1Zi5hcHBlbmQoImltcG9ydCBqYXZhLmxh
bmcuYW5ub3RhdGlvbi5FbGVtZW50VHlwZTtcbiIpOworCQlidWYuYXBwZW5kKCJcbiIpOworCQli
dWYuYXBwZW5kKCJwdWJsaWMgY2xhc3MgWCB7XG4iKTsKKwkJYnVmLmFwcGVuZCgiCUBBbm5vdFxu
Iik7CisJCWJ1Zi5hcHBlbmQoIiAgICBAQW5ub3QyIFggKCkge1xuIik7CisJCWJ1Zi5hcHBlbmQo
Igl9XG4iKTsKKwkJYnVmLmFwcGVuZCgiCUBBbm5vdDIgWCAoaW50IHgpIHtcbiIpOworCQlidWYu
YXBwZW5kKCIJfVxuIik7CisJCWJ1Zi5hcHBlbmQoIn1cbiIpOworCQlidWYuYXBwZW5kKCJcbiIp
OworCQlidWYuYXBwZW5kKCJAamF2YS5sYW5nLmFubm90YXRpb24uVGFyZ2V0IChFbGVtZW50VHlw
ZS5UWVBFX1VTRSlcbiIpOworCQlidWYuYXBwZW5kKCJAaW50ZXJmYWNlIEFubm90IHt9XG4iKTsK
KwkJYnVmLmFwcGVuZCgiXG4iKTsKKwkJYnVmLmFwcGVuZCgiQGphdmEubGFuZy5hbm5vdGF0aW9u
LlRhcmdldCAoRWxlbWVudFR5cGUuVFlQRV9VU0UpXG4iKTsKKwkJYnVmLmFwcGVuZCgiQGludGVy
ZmFjZSBBbm5vdDEge31cbiIpOworCQlhc3NlcnRFcXVhbFN0cmluZyhwcmV2aWV3LCBidWYudG9T
dHJpbmcoKSk7CisJfQorCisJcHVibGljIHZvaWQgdGVzdFJld3JpdGVJbnNlcnRBUElBbm5vdGF0
aW9uKCkgdGhyb3dzIEV4Y2VwdGlvbiB7CisJCWlmICh0aGlzLmFwaUxldmVsIDwgQVNULkpMUzgp
IHJldHVybjsKKwkJSVBhY2thZ2VGcmFnbWVudCBwYWNrMT0gdGhpcy5zb3VyY2VGb2xkZXIuY3Jl
YXRlUGFja2FnZUZyYWdtZW50KCJ0ZXN0MSIsIGZhbHNlLCBudWxsKTsKKwkJU3RyaW5nQnVmZmVy
IGJ1Zj0gbmV3IFN0cmluZ0J1ZmZlcigpOworCisJCWJ1Zi5hcHBlbmQoImltcG9ydCBqYXZhLmxh
bmcuYW5ub3RhdGlvbi5FbGVtZW50VHlwZTtcbiIpOworCQlidWYuYXBwZW5kKCJcbiIpOworCQli
dWYuYXBwZW5kKCJwdWJsaWMgY2xhc3MgWCB7XG4iKTsKKwkJYnVmLmFwcGVuZCgiCXB1YmxpYyBj
bGFzcyBIZWxwZXIgPFQxLCBUMj4ge1xuIik7CisJCWJ1Zi5hcHBlbmQoIgl9XG4iKTsKKwkJYnVm
LmFwcGVuZCgiCXB1YmxpYyB2b2lkIGZvbygpIHtcbiIpOworCQlidWYuYXBwZW5kKCIJCUhlbHBl
cjxAQW5ub3QgQEFubm90MSBTdHJpbmc+IHg7XG4iKTsKKwkJYnVmLmFwcGVuZCgiCX1cbiIpOwor
CQlidWYuYXBwZW5kKCJ9XG4iKTsKKwkJYnVmLmFwcGVuZCgiXG4iKTsKKwkJYnVmLmFwcGVuZCgi
QGphdmEubGFuZy5hbm5vdGF0aW9uLlRhcmdldCAoRWxlbWVudFR5cGUuVFlQRV9VU0UpIFxuIik7
CisJCWJ1Zi5hcHBlbmQoIkBpbnRlcmZhY2UgQW5ub3Qge31cbiIpOworCQlidWYuYXBwZW5kKCJc
biIpOworCQlidWYuYXBwZW5kKCJAamF2YS5sYW5nLmFubm90YXRpb24uVGFyZ2V0IChFbGVtZW50
VHlwZS5UWVBFX1VTRSkgXG4iKTsKKwkJYnVmLmFwcGVuZCgiQGludGVyZmFjZSBBbm5vdDEge31c
biIpOworCisJCUlDb21waWxhdGlvblVuaXQgY3U9IHBhY2sxLmNyZWF0ZUNvbXBpbGF0aW9uVW5p
dCgiWC5qYXZhIiwgYnVmLnRvU3RyaW5nKCksIGZhbHNlLCBudWxsKTsKKwkJQ29tcGlsYXRpb25V
bml0IGFzdFJvb3Q9IGNyZWF0ZUFTVChjdSk7CisJCUFTVFJld3JpdGUgcmV3cml0ZT0gQVNUUmV3
cml0ZS5jcmVhdGUoYXN0Um9vdC5nZXRBU1QoKSk7CisJCUFTVCBhc3Q9IGFzdFJvb3QuZ2V0QVNU
KCk7CisJCVR5cGVEZWNsYXJhdGlvbiB0eXBlPSBmaW5kVHlwZURlY2xhcmF0aW9uKGFzdFJvb3Qs
ICJYIik7CisJCU1ldGhvZERlY2xhcmF0aW9uIG1ldGhvZERlY2xhcmF0aW9uPSBmaW5kTWV0aG9k
RGVjbGFyYXRpb24odHlwZSwgImZvbyIpOworCQlMaXN0IHN0YXRlbWVudHM9IG1ldGhvZERlY2xh
cmF0aW9uLmdldEJvZHkoKS5zdGF0ZW1lbnRzKCk7CisJCVZhcmlhYmxlRGVjbGFyYXRpb25TdGF0
ZW1lbnQgdmFyaWFibGVEZWNsYXJhdGlvblN0YXRlbWVudD0gKFZhcmlhYmxlRGVjbGFyYXRpb25T
dGF0ZW1lbnQpIHN0YXRlbWVudHMuZ2V0KDApOworCQlQYXJhbWV0ZXJpemVkVHlwZSBwYXJhbWV0
ZXJpemVkVHlwZT0gKFBhcmFtZXRlcml6ZWRUeXBlKSB2YXJpYWJsZURlY2xhcmF0aW9uU3RhdGVt
ZW50LmdldFR5cGUoKTsKKwkJeworCQkJU2ltcGxlVHlwZSBzaW1wbGVUeXBlPSAoU2ltcGxlVHlw
ZSkgcGFyYW1ldGVyaXplZFR5cGUudHlwZUFyZ3VtZW50cygpLmdldCgwKTsKKwkJCS8vSW5zZXJ0
IGZpcnN0CisJCQlNYXJrZXJBbm5vdGF0aW9uIG1hcmtlckFubm90YXRpb249IGFzdC5uZXdNYXJr
ZXJBbm5vdGF0aW9uKCk7CisJCQltYXJrZXJBbm5vdGF0aW9uLnNldFR5cGVOYW1lKGFzdC5uZXdT
aW1wbGVOYW1lKCJBbm5vdDIiKSk7CisJCQlyZXdyaXRlLmdldExpc3RSZXdyaXRlKHNpbXBsZVR5
cGUsIFNpbXBsZVR5cGUuQU5OT1RBVElPTlNfUFJPUEVSVFkpLmluc2VydEZpcnN0KG1hcmtlckFu
bm90YXRpb24sIG51bGwpOworCisJCQkvL0luc2VydEF0CisJCQltYXJrZXJBbm5vdGF0aW9uPSBh
c3QubmV3TWFya2VyQW5ub3RhdGlvbigpOworCQkJbWFya2VyQW5ub3RhdGlvbi5zZXRUeXBlTmFt
ZShhc3QubmV3U2ltcGxlTmFtZSgiQW5ub3QzIikpOworCQkJcmV3cml0ZS5nZXRMaXN0UmV3cml0
ZShzaW1wbGVUeXBlLCBTaW1wbGVUeXBlLkFOTk9UQVRJT05TX1BST1BFUlRZKS5pbnNlcnRBdCht
YXJrZXJBbm5vdGF0aW9uLCAxLCBudWxsKTsKKworCQkJLy9JbnNlcnQgYWZ0ZXIKKwkJCW1hcmtl
ckFubm90YXRpb249IGFzdC5uZXdNYXJrZXJBbm5vdGF0aW9uKCk7CisJCQltYXJrZXJBbm5vdGF0
aW9uLnNldFR5cGVOYW1lKGFzdC5uZXdTaW1wbGVOYW1lKCJBbm5vdDQiKSk7CisJCQlyZXdyaXRl
LmdldExpc3RSZXdyaXRlKHNpbXBsZVR5cGUsIFNpbXBsZVR5cGUuQU5OT1RBVElPTlNfUFJPUEVS
VFkpLmluc2VydEFmdGVyKG1hcmtlckFubm90YXRpb24sIChNYXJrZXJBbm5vdGF0aW9uKSBzaW1w
bGVUeXBlLmFubm90YXRpb25zKCkuZ2V0KDEpLCBudWxsKTsKKworCQkJLy9JbnNlcnQgYmVmb3Jl
CisJCQltYXJrZXJBbm5vdGF0aW9uPSBhc3QubmV3TWFya2VyQW5ub3RhdGlvbigpOworCQkJbWFy
a2VyQW5ub3RhdGlvbi5zZXRUeXBlTmFtZShhc3QubmV3U2ltcGxlTmFtZSgiQW5ub3Q1IikpOwor
CQkJcmV3cml0ZS5nZXRMaXN0UmV3cml0ZShzaW1wbGVUeXBlLCBTaW1wbGVUeXBlLkFOTk9UQVRJ
T05TX1BST1BFUlRZKS5pbnNlcnRCZWZvcmUobWFya2VyQW5ub3RhdGlvbiwgKE1hcmtlckFubm90
YXRpb24pIHNpbXBsZVR5cGUuYW5ub3RhdGlvbnMoKS5nZXQoMSksIG51bGwpOworCQl9CisJCVN0
cmluZyBwcmV2aWV3PSBldmFsdWF0ZVJld3JpdGUoY3UsIHJld3JpdGUpOworCQlidWYgPSBuZXcg
U3RyaW5nQnVmZmVyKCk7CisJCWJ1Zi5hcHBlbmQoImltcG9ydCBqYXZhLmxhbmcuYW5ub3RhdGlv
bi5FbGVtZW50VHlwZTtcbiIpOworCQlidWYuYXBwZW5kKCJcbiIpOworCQlidWYuYXBwZW5kKCJw
dWJsaWMgY2xhc3MgWCB7XG4iKTsKKwkJYnVmLmFwcGVuZCgiCXB1YmxpYyBjbGFzcyBIZWxwZXIg
PFQxLCBUMj4ge1xuIik7CisJCWJ1Zi5hcHBlbmQoIgl9XG4iKTsKKwkJYnVmLmFwcGVuZCgiCXB1
YmxpYyB2b2lkIGZvbygpIHtcbiIpOworCQlidWYuYXBwZW5kKCIJCUhlbHBlcjxAQW5ub3QyIEBB
bm5vdDMgQEFubm90IEBBbm5vdDUgQEFubm90MSBAQW5ub3Q0IFN0cmluZz4geDtcbiIpOworCQli
dWYuYXBwZW5kKCIJfVxuIik7CisJCWJ1Zi5hcHBlbmQoIn1cbiIpOworCQlidWYuYXBwZW5kKCJc
biIpOworCQlidWYuYXBwZW5kKCJAamF2YS5sYW5nLmFubm90YXRpb24uVGFyZ2V0IChFbGVtZW50
VHlwZS5UWVBFX1VTRSkgXG4iKTsKKwkJYnVmLmFwcGVuZCgiQGludGVyZmFjZSBBbm5vdCB7fVxu
Iik7CisJCWJ1Zi5hcHBlbmQoIlxuIik7CisJCWJ1Zi5hcHBlbmQoIkBqYXZhLmxhbmcuYW5ub3Rh
dGlvbi5UYXJnZXQgKEVsZW1lbnRUeXBlLlRZUEVfVVNFKSBcbiIpOworCQlidWYuYXBwZW5kKCJA
aW50ZXJmYWNlIEFubm90MSB7fVxuIik7CisJCWFzc2VydEVxdWFsU3RyaW5nKHByZXZpZXcsIGJ1
Zi50b1N0cmluZygpKTsKKwl9CisKKwlwdWJsaWMgdm9pZCBfdGVzdEVtcHR5TGlzdEluc2VydEFu
bm90YXRpb24oKSB0aHJvd3MgRXhjZXB0aW9uIHsKKwkJaWYgKHRoaXMuYXBpTGV2ZWwgPCBBU1Qu
SkxTOCkgcmV0dXJuOworCQlJUGFja2FnZUZyYWdtZW50IHBhY2sxPSB0aGlzLnNvdXJjZUZvbGRl
ci5jcmVhdGVQYWNrYWdlRnJhZ21lbnQoInRlc3QxIiwgZmFsc2UsIG51bGwpOworCQlTdHJpbmdC
dWZmZXIgYnVmPSBuZXcgU3RyaW5nQnVmZmVyKCk7CisJCWJ1Zi5hcHBlbmQoInBhY2thZ2UgdGVz
dDE7XG4iKTsKKwkJYnVmLmFwcGVuZCgicHVibGljIGNsYXNzIFgge1xuIik7CisJCWJ1Zi5hcHBl
bmQoIglTdHJpbmcgbXlPYmplY3QgPSBcIkZvb1wiO1xuIik7CisJCWJ1Zi5hcHBlbmQoIglwdWJs
aWMgdm9pZCBmb28oKSB7XG4iKTsKKwkJYnVmLmFwcGVuZCgiCQlTdHJpbmcgbXlTdHJpbmcgPSAo
U3RyaW5nKSBteU9iamVjdDtcbiIpOworCQlidWYuYXBwZW5kKCIJfVxuIik7CisJCWJ1Zi5hcHBl
bmQoIn1cbiIpOworCisJCUlDb21waWxhdGlvblVuaXQgY3U9IHBhY2sxLmNyZWF0ZUNvbXBpbGF0
aW9uVW5pdCgiWC5qYXZhIiwgYnVmLnRvU3RyaW5nKCksIGZhbHNlLCBudWxsKTsKKwkJQ29tcGls
YXRpb25Vbml0IGFzdFJvb3Q9IGNyZWF0ZUFTVChjdSk7CisJCUFTVFJld3JpdGUgcmV3cml0ZT0g
QVNUUmV3cml0ZS5jcmVhdGUoYXN0Um9vdC5nZXRBU1QoKSk7CisJCUFTVCBhc3Q9IGFzdFJvb3Qu
Z2V0QVNUKCk7CisJCVR5cGVEZWNsYXJhdGlvbiB0eXBlPSBmaW5kVHlwZURlY2xhcmF0aW9uKGFz
dFJvb3QsICJYIik7CisJCU1ldGhvZERlY2xhcmF0aW9uIG1ldGhvZERlY2xhcmF0aW9uPSBmaW5k
TWV0aG9kRGVjbGFyYXRpb24odHlwZSwgImZvbyIpOworCQlMaXN0IHN0YXRlbWVudHM9IG1ldGhv
ZERlY2xhcmF0aW9uLmdldEJvZHkoKS5zdGF0ZW1lbnRzKCk7CisJCXsvL0FkZCBhbiB1c2Ugb2Yg
YW5ub3RhdGlvbi4KKwkJCVZhcmlhYmxlRGVjbGFyYXRpb25TdGF0ZW1lbnQgIHZhcmlhYmxlRGVj
bGFyYXRpb25TdGF0ZW1lbnQ9IChWYXJpYWJsZURlY2xhcmF0aW9uU3RhdGVtZW50KSBzdGF0ZW1l
bnRzLmdldCgwKTsKKwkJCVZhcmlhYmxlRGVjbGFyYXRpb25GcmFnbWVudCB2YXJpYWJsZURlY2xh
cmF0aW9uRnJhZ21lbnQ9IChWYXJpYWJsZURlY2xhcmF0aW9uRnJhZ21lbnQpIHZhcmlhYmxlRGVj
bGFyYXRpb25TdGF0ZW1lbnQuZnJhZ21lbnRzKCkuZ2V0KDApOworCQkJQ2FzdEV4cHJlc3Npb24g
Y2FzdEV4cHJlc3Npb249IChDYXN0RXhwcmVzc2lvbikgdmFyaWFibGVEZWNsYXJhdGlvbkZyYWdt
ZW50LmdldEluaXRpYWxpemVyKCk7CisJCQlTaW1wbGVUeXBlIHNpbXBsZVR5cGU9IChTaW1wbGVU
eXBlKSBjYXN0RXhwcmVzc2lvbi5nZXRUeXBlKCk7CisJCQlNYXJrZXJBbm5vdGF0aW9uIG1hcmtl
ckFubm90YXRpb249IGFzdC5uZXdNYXJrZXJBbm5vdGF0aW9uKCk7CisJCQltYXJrZXJBbm5vdGF0
aW9uLnNldFR5cGVOYW1lKGFzdC5uZXdTaW1wbGVOYW1lKCJBbm5vdCIpKTsKKwkJCXJld3JpdGUu
Z2V0TGlzdFJld3JpdGUoc2ltcGxlVHlwZSwgU2ltcGxlVHlwZS5BTk5PVEFUSU9OU19QUk9QRVJU
WSkuaW5zZXJ0TGFzdChtYXJrZXJBbm5vdGF0aW9uLCBudWxsKTsKKwkJfQorCQlTdHJpbmcgcHJl
dmlldz0gZXZhbHVhdGVSZXdyaXRlKGN1LCByZXdyaXRlKTsKKwkJYnVmPSBuZXcgU3RyaW5nQnVm
ZmVyKCk7CisJCWJ1Zi5hcHBlbmQoInBhY2thZ2UgdGVzdDE7XG4iKTsKKwkJYnVmLmFwcGVuZCgi
cHVibGljIGNsYXNzIFgge1xuIik7CisJCWJ1Zi5hcHBlbmQoIglTdHJpbmcgbXlPYmplY3QgPSBc
IkZvb1wiO1xuIik7CisJCWJ1Zi5hcHBlbmQoIglwdWJsaWMgdm9pZCBmb28oKSB7XG4iKTsKKwkJ
YnVmLmFwcGVuZCgiCQlTdHJpbmcgbXlTdHJpbmcgPSAoQEFubm90IFN0cmluZykgbXlPYmplY3Q7
XG4iKTsvL0FjdHVhbDogU3RyaW5nIG15U3RyaW5nID0gKCBAQW5ub3RTdHJpbmcpIG15T2JqZWN0
OworCQlidWYuYXBwZW5kKCIJfVxuIik7CisJCWJ1Zi5hcHBlbmQoIn1cbiIpOworCQlhc3NlcnRF
cXVhbFN0cmluZyhwcmV2aWV3LCBidWYudG9TdHJpbmcoKSk7CisJfQorCit9Cg==
</data>
<flag name="review"
          id="56350"
          type_id="6"
          status="?"
          setter="shankhba"
    />
          </attachment>
      

    </bug>

</bugzilla>