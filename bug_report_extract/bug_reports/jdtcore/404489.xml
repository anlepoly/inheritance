<?xml version="1.0" encoding="UTF-8" standalone="yes" ?>
<!DOCTYPE bugzilla SYSTEM "https://bugs.eclipse.org/bugs/page.cgi?id=bugzilla.dtd">

<bugzilla version="4.4.7"
          urlbase="https://bugs.eclipse.org/bugs/"
          
          maintainer="webmaster@eclipse.org"
>

    <bug>
          <bug_id>404489</bug_id>
          
          <creation_ts>2013-03-27 15:45:00 -0400</creation_ts>
          <short_desc>[1.8][dom ast] Incorrect conversion of JSR308 TYPE_USE annotations on qualified name</short_desc>
          <delta_ts>2013-05-02 05:53:34 -0400</delta_ts>
          <reporter_accessible>1</reporter_accessible>
          <cclist_accessible>1</cclist_accessible>
          <classification_id>2</classification_id>
          <classification>Eclipse</classification>
          <product>JDT</product>
          <component>Core</component>
          <version>4.3</version>
          <rep_platform>All</rep_platform>
          <op_sys>All</op_sys>
          <bug_status>RESOLVED</bug_status>
          <resolution>FIXED</resolution>
          
          
          <bug_file_loc></bug_file_loc>
          <status_whiteboard></status_whiteboard>
          <keywords></keywords>
          <priority>P1</priority>
          <bug_severity>critical</bug_severity>
          <target_milestone>BETA J8</target_milestone>
          
          <blocked>391847</blocked>
    
    <blocked>406467</blocked>
    
    <blocked>406469</blocked>
    
    <blocked>407056</blocked>
          <everconfirmed>1</everconfirmed>
          <reporter name="Markus Keller">markus_keller</reporter>
          <assigned_to name="Manoj Palat Away Until May 11 2015">manpalat</assigned_to>
          <cc>daniel_megert</cc>
    
    <cc>jarthana</cc>
    
    <cc>manju656</cc>
    
    <cc>noopur_gupta</cc>
    
    <cc>srikanth_sankaran</cc>
          
          <votes>0</votes>

      

      

      <flag name="review"
          id="56585"
          type_id="1"
          status="+"
          setter="jarthana"
    />

          <comment_sort_order>oldest_to_newest</comment_sort_order>  
          <long_desc isprivate="0" >
    <commentid>2237410</commentid>
    <comment_count>0</comment_count>
    <who name="Markus Keller">markus_keller</who>
    <bug_when>2013-03-27 15:45:18 -0400</bug_when>
    <thetext>Example:

package jsr308.bug;
import java.lang.annotation.*;
public class AnnotatedQualifiedType {
	@Target(ElementType.TYPE_USE)
	@Retention(RetentionPolicy.RUNTIME)
	@Documented
	static @interface NonNull { }

	java.io.@NonNull IOException foo(
			java.io.@NonNull FileNotFoundException arg)
			throws java.io.@NonNull EOFException {
		try {
		} catch (java.io.@NonNull IOError e) {
		}
		return null;
	}
}

The &quot;java.io.@NonNull XyException&quot; are all represented like this in the AST:

SimpleType                         &quot;java.io.@NonNull XyException&quot;
+ annotations: MarkerAnnotation            &quot;@NonNull&quot;
+ name: QualifiedName              &quot;java.io.@NonNull XyException&quot;
        + qualifier: QualifiedName &quot;java.io&quot;
        + name: SimpleName                          &quot;XyException&quot;

This is incorrect. The first QualifiedName&apos;s source range cannot contain the &quot;@NonNull&quot;. In the current API, the legal representation would be:

QualifiedType                       &quot;java.io.@NonNull XyException&quot;
+ qualifier: SimpleType             &quot;java.io&quot;
             + annotations: &lt;empty&gt;
             + name: QualifiedName  &quot;java.io&quot;
+ annotations: MarkerAnnotation             &quot;@NonNull&quot;
+ name: SimpleName                                   &quot;XyException&quot;

Alternatively, the first qualifier could also be a QualifiedType containing a SimpleType and a SimpleName. Both of these representations have the problem that the &quot;qualifier&quot; property of a QualifiedType is a Type, but &quot;java.io&quot; is not a type.

I don&apos;t have a good solution right now.</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>2237428</commentid>
    <comment_count>1</comment_count>
    <who name="Markus Keller">markus_keller</who>
    <bug_when>2013-03-27 16:17:25 -0400</bug_when>
    <thetext>Maybe we have to step back and go the AnnotatedSimpleName/AnnotatedQualifiedName route as once discussed in 391847. In that case, SimpleType/QualifiedType would not be AnnotatableTypes any more.

Example:

QualifiedType                        &quot;java.util.@NonNull Map.@NonNull Entry&quot;
+ qualifier: SimpleType              &quot;java.util.@NonNull Map&quot;
             + name: AnnotatedQName  &quot;java.util.@NonNull Map&quot;
                     + qualifier: QN &quot;java.util&quot;
                     + annotations: MA         &quot;@NonNull&quot;
                     + name: SimpleName                 &quot;Map&quot;

+ name: AnnotatedSimpleName                                 &quot;@NonNull Entry&quot;
        + annotations: MarkerAnnotation                     &quot;@NonNull&quot;
        + identifier: String                                         &quot;Entry&quot;</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>2238548</commentid>
    <comment_count>2</comment_count>
    <who name="Markus Keller">markus_keller</who>
    <bug_when>2013-04-02 07:14:43 -0400</bug_when>
    <thetext>Srikanth: We should sort this out ASAP, since it blocks progress in JDT UI.

The Annotated*Name solution would also make the MethodDeclaration#thrownExceptions -&gt; thrownExceptionTypes
change obsolete.</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>2238567</commentid>
    <comment_count>3</comment_count>
    <who name="Srikanth Sankaran">srikanth_sankaran</who>
    <bug_when>2013-04-02 08:20:16 -0400</bug_when>
    <thetext>(In reply to comment #2)
&gt; Srikanth: We should sort this out ASAP, since it blocks progress in JDT UI.
&gt; 
&gt; The Annotated*Name solution would also make the
&gt; MethodDeclaration#thrownExceptions -&gt; thrownExceptionTypes
&gt; change obsolete.

Naturally, we are willing to co-operate, if you confirm this what you want 
from the client side - earlier there were some arguments made as to why this
complicates client code. So I assume in overall consideration, names being
annotatable is the lesser evil ?</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>2238846</commentid>
    <comment_count>4</comment_count>
    <who name="Markus Keller">markus_keller</who>
    <bug_when>2013-04-02 14:28:56 -0400</bug_when>
    <thetext>I realize comment 1 is exactly the opposite of what I once asked for in bug 391847. Back then, I still thought we could find a straightforward solution where TYPE_USE annotations could always be accessed through their corresponding Type node. Srikanth already mentioned this problem, but I didn&apos;t understand it back then.

I was probably confused by the &quot;@Annot java.util.List&quot; syntax (before bug 394356), where an annotated SimpleType wrapping a QualifiedName would have worked in the DOM AST. However, that notation has other problems, so I don&apos;t want to turn that wheel back.

Reverting bug 395886 would be one solution, but I&apos;m trying to find a better one.

Problem statement:

We only have trouble with a qualified name that carries annotations. An annotated simple name can just be a SimpleType wrapping a SimpleName, nicely having the annotation on the type, not on the name.

For qualified names, we would need a new node that is similar to QualifiedType, but that allows the qualifier to be a QualifiedName if it is a package.

Proposal:

- Add new class PackageQualifiedType extends AnnotatableType with properties:
  - qualifier: QualifiedName        //(QualifiedType has &quot;qualifier: Type&quot;)
  - annotations: List of Annotation
  - name: SimpleName

- In the ASTConverter, only create a PackageQualifiedType if necessary:
  1. to avoid breaking SimpleType&apos;s Javadoc comment &quot;If annotations are present,
        then the name must be a {@link SimpleName}.&quot;
  2. to avoid creating a QualifiedType whose qualifier is actually not a type

=&gt; This wouldn&apos;t change anything for Java source that doesn&apos;t use annotated qualified types.
- SimpleType(QualifiedName) would still be the &quot;default&quot; solution if the type is just a qualified name. Otherwise, resort to:
- QualifiedType(&lt;qualifier&gt;, {annotations}, SimpleName) if &lt;qualifier&gt; is a type, or to
- PackageQualifiedType(&lt;qualifier&gt;, {annotations}, SimpleName) if &lt;qualifier&gt; is a package.
If the qualifier could be both and there are no binding that would help decide, then choose a QualifiedType (for compatibility with earlier AST levels).

This proposal keeps the &quot;thrownExceptions -&gt; thrownExceptionTypes&quot; change. That&apos;s conceptually the right solution, since the exception type is really a type, not just a name.</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>2240720</commentid>
    <comment_count>5</comment_count>
    <who name="Srikanth Sankaran">srikanth_sankaran</who>
    <bug_when>2013-04-07 23:21:45 -0400</bug_when>
    <thetext>(In reply to comment #4)

&gt; Problem statement:

[...]

&gt; Proposal:

[...]

Manoj, please study the problem statement and proposal in detail and
let us know what you think. This needs to be worked on a priority basis
and please work on other items only when you are blocked waiting for
clarifications/reviews etc.</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>2240721</commentid>
    <comment_count>6</comment_count>
    <who name="Srikanth Sankaran">srikanth_sankaran</who>
    <bug_when>2013-04-07 23:22:49 -0400</bug_when>
    <thetext>Markus, while we are waiting for a solution to be cooked for this,
reviewing and closing bug 402231 would unblock the UI work for the
other JSR. TIA.</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>2240986</commentid>
    <comment_count>7</comment_count>
      <attachid>229447</attachid>
    <who name="Manoj Palat Away Until May 11 2015">manpalat</who>
    <bug_when>2013-04-08 10:34:08 -0400</bug_when>
    <thetext>Created attachment 229447
Proposed Patch - WIP

As per the comment 4, a PackageQualifiedType is created and converter modified accordingly. This is a Work-In-Progress patch, though this is good enough to be used for conversion and viewing at the ASTViewer. Will dot the &apos;i&apos;s and cross the &apos;t&apos;s later.

Todo:
  - cleanup/eyeball/re-review the patch.
  - write additional test cases if required.

Markus: Could you please do a quick and early review and let me know of any comments (particularly the functional ones)?</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>2241106</commentid>
    <comment_count>8</comment_count>
    <who name="Markus Keller">markus_keller</who>
    <bug_when>2013-04-08 13:48:41 -0400</bug_when>
    <thetext>The API looks good, except for two Javadoc typos:
- AST#newPackageQualifiedType(..): @param qualifier: remove word &quot;type&quot;
- PackageQualifiedType: &quot;Type node for a package-qualified type&quot;

For the example in comment 0, the AST looks correct.

But if you add ...

	class Inner {}
	jsr308.bug.@NonNull AnnotatedQualifiedType.@NonNull Inner fInner;

... at the end, then fInner&apos;s type has 2 problems:

1. the qualifier of the type is a QualifiedType, but should be a PackageQualifiedType
2. the qualifier of that QualifiedType is just &quot;jsr308&quot;. The token &quot;bug&quot; is missing in the AST


There are also test failures if you open the launch configuration, go to the &quot;Tracing&quot; tab, check &quot;org.eclipse.jdt.core&quot; on the left and &quot;debug&quot; and &quot;debug/dom/ast/throw&quot; on the right (bug 404986).
In the runtime workbench, I&apos;d recommend you enable the &quot;debug/dom/ast&quot; option, so that you see the errors in the log but don&apos;t get flooded with dialogs.

Code from first failing test (problem is that the first @Marker is missing in most source ranges of enclosing nodes):

public class X {
    class Y {
        class Z {
        }
    }
    Object o = (@Marker X. @Marker Y.@Marker Z) null;
    @java.lang.annotation.Target (java.lang.annotation.ElementType.TYPE_USE)
    @interface Marker {
    }
}</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>2241633</commentid>
    <comment_count>9</comment_count>
      <attachid>229520</attachid>
    <who name="Manoj Palat Away Until May 11 2015">manpalat</who>
    <bug_when>2013-04-09 12:37:06 -0400</bug_when>
    <thetext>Created attachment 229520
Proposed Patch - WIP

A work-in-progress patch 
 - review comments of Markus addressed.
 - testing done primarily using ASTViewer; hence test cases to be written (TODO)
 - Eyeballing/rechecking the patch - TODO</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>2244660</commentid>
    <comment_count>10</comment_count>
      <attachid>229791</attachid>
    <who name="Manoj Palat Away Until May 11 2015">manpalat</who>
    <bug_when>2013-04-17 05:10:42 -0400</bug_when>
    <thetext>Created attachment 229791
Proposed Patch</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>2244980</commentid>
    <comment_count>11</comment_count>
    <who name="Markus Keller">markus_keller</who>
    <bug_when>2013-04-17 13:41:16 -0400</bug_when>
    <thetext>(In reply to comment #10)

1.) I get exceptions when trying to create a JLS4 AST for comment 0. In that case, we need a MALFORMED node and some fallback that drops unsupported constructs.

java.lang.UnsupportedOperationException: Operation only supported in JLS8 and later AST
	at org.eclipse.jdt.core.dom.ASTNode.unsupportedIn2_3_4(ASTNode.java:1916)
	at org.eclipse.jdt.core.dom.PackageQualifiedType.&lt;init&gt;(PackageQualifiedType.java:104)
	at org.eclipse.jdt.core.dom.ASTConverter.convertType(ASTConverter.java:3661)
	at org.eclipse.jdt.core.dom.ASTConverter.convert(ASTConverter.java:893)
...

2.) When I turn the @NonNull into NormalAnnotations (append &quot;()&quot; or &quot;(x=1)&quot;) or SingleMemberAnnotations (append &quot;(1)&quot;), then the source ranges of these nodes are missing the arguments list.

I think the fix is to remove these lines 3300+2 from ASTConverter#annotateType(AnnotatableType, Annotation[]):
	int start = typeAnnotation.sourceStart;
	int end = typeAnnotation.sourceEnd;
	annotation.setSourceRange(start, end - start + 1);

Same problem in ASTConverter#annotateTypeParameter(..) at line 3333

3.) In ASTConverter, &quot;if (createPackageQualifiedType == true)&quot; is a bit verbose.</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>2245217</commentid>
    <comment_count>12</comment_count>
      <attachid>229842</attachid>
    <who name="Manoj Palat Away Until May 11 2015">manpalat</who>
    <bug_when>2013-04-18 02:35:40 -0400</bug_when>
    <thetext>Created attachment 229842
Proposed Patch

Markus: Thanks for quick turn-around-time for the review. 

- Now converts to a malformed QualifiedType instead of a PackageQT for ast levels less than 8. I found this conversion to be most suited for a malformed node. Please opine if you have better suggestions.

- On experimenting along similar lines, found that there is an issue with thrownExceptions conversion and have raised a bug 405934.</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>2245785</commentid>
    <comment_count>13</comment_count>
      <attachid>229889</attachid>
    <who name="Manoj Palat Away Until May 11 2015">manpalat</who>
    <bug_when>2013-04-19 01:25:49 -0400</bug_when>
    <thetext>Created attachment 229889
Proposed Patch

Same as the previous patch with just changes for conflict resolution with the latest changes and a change of tags to 3.9 BETA_JAVA8</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>2246434</commentid>
    <comment_count>14</comment_count>
      <attachid>229934</attachid>
    <who name="Manoj Palat Away Until May 11 2015">manpalat</who>
    <bug_when>2013-04-21 01:29:09 -0400</bug_when>
    <thetext>Created attachment 229934
Proposed Patch

Corrected an elusive source range issue and resolved a conflict with yesterday&apos;s checkin.</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>2246677</commentid>
    <comment_count>15</comment_count>
    <who name="Jay Arthanareeswaran">jarthana</who>
    <bug_when>2013-04-22 07:06:17 -0400</bug_when>
    <thetext>Patch looks good, few minor corrections needed:

1. ASTConverter15Test requires JLS disclaimer in copyright
2. Methods getQualifiedTypeWithSourceAndBinding and getSimpleTypeWithNameAndBinding are better named createQualifierType and createSimpleType respectively.
3. Similarly look for better names for setSourceAnnotationsAndBindings methods.</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>2247080</commentid>
    <comment_count>16</comment_count>
      <attachid>230000</attachid>
    <who name="Manoj Palat Away Until May 11 2015">manpalat</who>
    <bug_when>2013-04-22 23:04:37 -0400</bug_when>
    <thetext>Created attachment 230000
Proposed Patch

Reworked to incorporate the comments.</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>2247107</commentid>
    <comment_count>17</comment_count>
    <who name="Jay Arthanareeswaran">jarthana</who>
    <bug_when>2013-04-23 01:52:20 -0400</bug_when>
    <thetext>(In reply to comment #16)
&gt; Created attachment 230000 [details]
&gt; Proposed Patch
&gt; 
&gt; Reworked to incorporate the comments.

Thanks Manoj, I have released the patch at :

http://git.eclipse.org/c/jdt/eclipse.jdt.core.git/commit/?h=BETA_JAVA8&amp;id=d3d92e370789aaaed8a46c804d74e3cb2b4bb167

Stil, I am not entirely happy with the names for methods setSourceAnnotationsAndBindings. But being private methods, we can live with it.</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>2248031</commentid>
    <comment_count>18</comment_count>
    <who name="Markus Keller">markus_keller</who>
    <bug_when>2013-04-24 13:13:57 -0400</bug_when>
    <thetext>The AST looks good now.

Filed bug 406467 and bug 406469 for bindings and ASTRewrite. And I&apos;ve adjusted the explanation in QualifiedType and added a few @see tags: http://git.eclipse.org/c/jdt/eclipse.jdt.core.git/commit/?id=372783581a5723abe8e5c388f38ff5c205e01380</thetext>
  </long_desc>
      
          <attachment
              isobsolete="1"
              ispatch="1"
              isprivate="0"
          >
            <attachid>229447</attachid>
            <date>2013-04-08 10:34:00 -0400</date>
            <delta_ts>2013-04-09 12:37:06 -0400</delta_ts>
            <desc>Proposed Patch - WIP</desc>
            <filename>WIP-FOR-BUG-404489.patch</filename>
            <type>text/plain</type>
            <size>30501</size>
            <attacher name="Manoj Palat Away Until May 11 2015">manpalat</attacher>
            
              <data encoding="base64">ZGlmZiAtLWdpdCBhL29yZy5lY2xpcHNlLmpkdC5jb3JlLnRlc3RzLm1vZGVsL3NyYy9vcmcvZWNs
aXBzZS9qZHQvY29yZS90ZXN0cy9kb20vQVNUQ29udmVydGVyMThUZXN0LmphdmEgYi9vcmcuZWNs
aXBzZS5qZHQuY29yZS50ZXN0cy5tb2RlbC9zcmMvb3JnL2VjbGlwc2UvamR0L2NvcmUvdGVzdHMv
ZG9tL0FTVENvbnZlcnRlcjE4VGVzdC5qYXZhCmluZGV4IDE0MGI1NmIuLmYyYzczM2IgMTAwNjQ0
Ci0tLSBhL29yZy5lY2xpcHNlLmpkdC5jb3JlLnRlc3RzLm1vZGVsL3NyYy9vcmcvZWNsaXBzZS9q
ZHQvY29yZS90ZXN0cy9kb20vQVNUQ29udmVydGVyMThUZXN0LmphdmEKKysrIGIvb3JnLmVjbGlw
c2UuamR0LmNvcmUudGVzdHMubW9kZWwvc3JjL29yZy9lY2xpcHNlL2pkdC9jb3JlL3Rlc3RzL2Rv
bS9BU1RDb252ZXJ0ZXIxOFRlc3QuamF2YQpAQCAtMTQ5LDEwICsxNDksMTAgQEAKIAkJYXNzZXJ0
Tm90TnVsbChhc3NpZ25tZW50KTsKIAkJQ2FzdEV4cHJlc3Npb24gY2FzdEV4cHJlc3Npb24gPSAo
Q2FzdEV4cHJlc3Npb24pIGFzc2lnbm1lbnQuZ2V0UmlnaHRIYW5kU2lkZSgpOwogCQlhc3NlcnRO
b3ROdWxsKGNhc3RFeHByZXNzaW9uKTsKLQkJU2ltcGxlVHlwZSBzaW1wbGVUeXBlID0gKFNpbXBs
ZVR5cGUpIGNhc3RFeHByZXNzaW9uLmdldFR5cGUoKTsKLQkJYXNzZXJ0Tm90TnVsbChzaW1wbGVU
eXBlKTsKLQkJYXNzZXJ0RXF1YWxzKCJqYXZhLmxhbmcuQE1hcmtlciBTdHJpbmciLCBzaW1wbGVU
eXBlLnRvU3RyaW5nKCkpOwotCQlMaXN0IGFubm90YXRpb25zID0gc2ltcGxlVHlwZS5hbm5vdGF0
aW9ucygpOworCQlQYWNrYWdlUXVhbGlmaWVkVHlwZSBwYWNrYWdlUXVhbGlmaWVkVHlwZSA9IChQ
YWNrYWdlUXVhbGlmaWVkVHlwZSkgY2FzdEV4cHJlc3Npb24uZ2V0VHlwZSgpOworCQlhc3NlcnRO
b3ROdWxsKHBhY2thZ2VRdWFsaWZpZWRUeXBlKTsKKwkJYXNzZXJ0RXF1YWxzKCJqYXZhLmxhbmcu
QE1hcmtlciBTdHJpbmciLCBwYWNrYWdlUXVhbGlmaWVkVHlwZS50b1N0cmluZygpKTsKKwkJTGlz
dCBhbm5vdGF0aW9ucyA9IHBhY2thZ2VRdWFsaWZpZWRUeXBlLmFubm90YXRpb25zKCk7CiAJCWFz
c2VydFRydWUoYW5ub3RhdGlvbnMuc2l6ZSgpID09IDEpOwogCQlhc3NlcnRFcXVhbHMoIkBNYXJr
ZXIiLCBhbm5vdGF0aW9ucy5nZXQoMCkudG9TdHJpbmcoKSk7CiAKQEAgLTE2MCw3ICsxNjAsNyBA
QAogCQlWYXJpYWJsZURlY2xhcmF0aW9uU3RhdGVtZW50IHZhcmlhYmxlRGVjbGFyYXRpb25TdGF0
ZW1lbnQgPSAoVmFyaWFibGVEZWNsYXJhdGlvblN0YXRlbWVudCkgc3RhdGVtZW50cy5nZXQoc0Nv
dW50KyspOwogCQlUeXBlIHR5cGUgPSB2YXJpYWJsZURlY2xhcmF0aW9uU3RhdGVtZW50LmdldFR5
cGUoKTsKIAkJYXNzZXJ0VHJ1ZSh0eXBlLmlzU2ltcGxlVHlwZSgpKTsKLQkJc2ltcGxlVHlwZSA9
IChTaW1wbGVUeXBlKSB0eXBlOworCQlTaW1wbGVUeXBlIHNpbXBsZVR5cGUgPSAoU2ltcGxlVHlw
ZSkgdHlwZTsKIAkJYXNzZXJ0RXF1YWxzKCJPdXRlci5Jbm5lciIsIHNpbXBsZVR5cGUudG9TdHJp
bmcoKSk7CiAJCWFubm90YXRpb25zID0gc2ltcGxlVHlwZS5hbm5vdGF0aW9ucygpOwogCQlhc3Nl
cnRUcnVlKGFubm90YXRpb25zLnNpemUoKSA9PSAwKTsKQEAgLTE2OSwyMiArMTY5LDIyIEBACiAJ
CS8vIGFubm90YXRpb25zLgogCQl2YXJpYWJsZURlY2xhcmF0aW9uU3RhdGVtZW50ID0gKFZhcmlh
YmxlRGVjbGFyYXRpb25TdGF0ZW1lbnQpIHN0YXRlbWVudHMuZ2V0KHNDb3VudCsrKTsKIAkJdHlw
ZSA9IHZhcmlhYmxlRGVjbGFyYXRpb25TdGF0ZW1lbnQuZ2V0VHlwZSgpOwotCQlhc3NlcnRUcnVl
KHR5cGUuaXNTaW1wbGVUeXBlKCkpOwotCQlzaW1wbGVUeXBlID0gKFNpbXBsZVR5cGUpIHR5cGU7
Ci0JCWFzc2VydE5vdE51bGwoc2ltcGxlVHlwZSk7Ci0JCWFzc2VydEVxdWFscygiT3V0ZXIuQE1h
cmtlcjIgSW5uZXIiLCBzaW1wbGVUeXBlLnRvU3RyaW5nKCkpOwotCQlhbm5vdGF0aW9ucyA9IHNp
bXBsZVR5cGUuYW5ub3RhdGlvbnMoKTsKKwkJYXNzZXJ0VHJ1ZSh0eXBlLmlzUXVhbGlmaWVkVHlw
ZSgpKTsKKwkJUXVhbGlmaWVkVHlwZSBxdWFsaWZpZWRUeXBlID0gKFF1YWxpZmllZFR5cGUpIHR5
cGU7CisJCWFzc2VydE5vdE51bGwocXVhbGlmaWVkVHlwZSk7CisJCWFzc2VydEVxdWFscygiT3V0
ZXIuQE1hcmtlcjIgSW5uZXIiLCBxdWFsaWZpZWRUeXBlLnRvU3RyaW5nKCkpOworCQlhbm5vdGF0
aW9ucyA9IHF1YWxpZmllZFR5cGUuYW5ub3RhdGlvbnMoKTsKIAkJYXNzZXJ0VHJ1ZShhbm5vdGF0
aW9ucy5zaXplKCkgPT0gMSk7CiAJCWFzc2VydEVxdWFscygiQE1hcmtlcjIiLCBhbm5vdGF0aW9u
cy5nZXQoMCkudG9TdHJpbmcoKSk7CiAKIAkJLy8gY2FzZSA0IC0gTXVsdGlwbGUgbGV2ZWxzIHdp
dGggYW5ub3RhdGlvbnMgYXQgdGhlIGxhc3Qgb25seS4KIAkJdmFyaWFibGVEZWNsYXJhdGlvblN0
YXRlbWVudCA9IChWYXJpYWJsZURlY2xhcmF0aW9uU3RhdGVtZW50KSBzdGF0ZW1lbnRzLmdldChz
Q291bnQrKyk7CiAJCXR5cGUgPSB2YXJpYWJsZURlY2xhcmF0aW9uU3RhdGVtZW50LmdldFR5cGUo
KTsKLQkJYXNzZXJ0VHJ1ZSh0eXBlLmlzU2ltcGxlVHlwZSgpKTsKLQkJc2ltcGxlVHlwZSA9IChT
aW1wbGVUeXBlKSB0eXBlOwotCQlhc3NlcnROb3ROdWxsKHNpbXBsZVR5cGUpOwotCQlhc3NlcnRF
cXVhbHMoIk91dGVyLklubmVyLkBNYXJrZXIxIERlZXBlciIsIHNpbXBsZVR5cGUudG9TdHJpbmco
KSk7Ci0JCWFubm90YXRpb25zID0gc2ltcGxlVHlwZS5hbm5vdGF0aW9ucygpOworCQlhc3NlcnRU
cnVlKHR5cGUuaXNRdWFsaWZpZWRUeXBlKCkpOworCQlxdWFsaWZpZWRUeXBlID0gKFF1YWxpZmll
ZFR5cGUpIHR5cGU7CisJCWFzc2VydE5vdE51bGwocXVhbGlmaWVkVHlwZSk7CisJCWFzc2VydEVx
dWFscygiT3V0ZXIuSW5uZXIuQE1hcmtlcjEgRGVlcGVyIiwgcXVhbGlmaWVkVHlwZS50b1N0cmlu
ZygpKTsKKwkJYW5ub3RhdGlvbnMgPSBxdWFsaWZpZWRUeXBlLmFubm90YXRpb25zKCk7CiAJCWFz
c2VydFRydWUoYW5ub3RhdGlvbnMuc2l6ZSgpID09IDEpOwogCQlhc3NlcnRFcXVhbHMoIkBNYXJr
ZXIxIiwgYW5ub3RhdGlvbnMuZ2V0KDApLnRvU3RyaW5nKCkpOwogCkBAIC0xOTIsNyArMTkyLDcg
QEAKIAkJdmFyaWFibGVEZWNsYXJhdGlvblN0YXRlbWVudCA9IChWYXJpYWJsZURlY2xhcmF0aW9u
U3RhdGVtZW50KSBzdGF0ZW1lbnRzLmdldChzQ291bnQrKyk7CiAJCXR5cGUgPSB2YXJpYWJsZURl
Y2xhcmF0aW9uU3RhdGVtZW50LmdldFR5cGUoKTsKIAkJYXNzZXJ0VHJ1ZSh0eXBlLmlzUXVhbGlm
aWVkVHlwZSgpKTsKLQkJUXVhbGlmaWVkVHlwZSBxdWFsaWZpZWRUeXBlID0gKFF1YWxpZmllZFR5
cGUpIHR5cGU7CisJCXF1YWxpZmllZFR5cGUgPSAoUXVhbGlmaWVkVHlwZSkgdHlwZTsKIAkJYXNz
ZXJ0Tm90TnVsbChxdWFsaWZpZWRUeXBlKTsKIAkJYXNzZXJ0RXF1YWxzKCJPdXRlci5ATWFya2Vy
MSBJbm5lci5ATWFya2VyMiBEZWVwZXIiLCBxdWFsaWZpZWRUeXBlLnRvU3RyaW5nKCkpOwogCQlh
bm5vdGF0aW9ucyA9IHF1YWxpZmllZFR5cGUuYW5ub3RhdGlvbnMoKTsKQEAgLTIwMSwxMCArMjAx
LDEwIEBACiAJCVNpbXBsZU5hbWUgc2ltcGxlTmFtZSA9IHF1YWxpZmllZFR5cGUuZ2V0TmFtZSgp
OwogCQlhc3NlcnRFcXVhbHMoIkRlZXBlciIsIHNpbXBsZU5hbWUudG9TdHJpbmcoKSk7CiAJCVR5
cGUgcXVhbGlmaWVyVHlwZSA9IHF1YWxpZmllZFR5cGUuZ2V0UXVhbGlmaWVyKCk7Ci0JCWFzc2Vy
dFRydWUocXVhbGlmaWVyVHlwZS5pc1NpbXBsZVR5cGUoKSk7Ci0JCXNpbXBsZVR5cGUgPSAoU2lt
cGxlVHlwZSkgcXVhbGlmaWVyVHlwZTsKLQkJYXNzZXJ0RXF1YWxzKCJPdXRlci5ATWFya2VyMSBJ
bm5lciIsIHNpbXBsZVR5cGUudG9TdHJpbmcoKSk7Ci0JCWFubm90YXRpb25zID0gc2ltcGxlVHlw
ZS5hbm5vdGF0aW9ucygpOworCQlhc3NlcnRUcnVlKHF1YWxpZmllclR5cGUuaXNRdWFsaWZpZWRU
eXBlKCkpOworCQlxdWFsaWZpZWRUeXBlID0gKFF1YWxpZmllZFR5cGUpIHF1YWxpZmllclR5cGU7
CisJCWFzc2VydEVxdWFscygiT3V0ZXIuQE1hcmtlcjEgSW5uZXIiLCBxdWFsaWZpZWRUeXBlLnRv
U3RyaW5nKCkpOworCQlhbm5vdGF0aW9ucyA9IHF1YWxpZmllZFR5cGUuYW5ub3RhdGlvbnMoKTsK
IAkJYXNzZXJ0VHJ1ZShhbm5vdGF0aW9ucy5zaXplKCkgPT0gMSk7CiAJCWFzc2VydEVxdWFscygi
QE1hcmtlcjEiLCBhbm5vdGF0aW9ucy5nZXQoMCkudG9TdHJpbmcoKSk7CiAJfQpAQCAtMzQyLDEw
ICszNDIsMTAgQEAKIAkJdHlwZUFyZ3VtZW50cyA9IHBhcmFtZXRyaXplZFR5cGUudHlwZUFyZ3Vt
ZW50cygpOwogCQlhc3NlcnRFcXVhbHMoMSwgdHlwZUFyZ3VtZW50cy5zaXplKCkpOwogCQl0eXBl
ID0gKFR5cGUpIHR5cGVBcmd1bWVudHMuZ2V0KDApOwotCQlhc3NlcnRUcnVlKHR5cGUuaXNTaW1w
bGVUeXBlKCkpOwotCQlTaW1wbGVUeXBlIHNpbXBsZVR5cGUgPSAoU2ltcGxlVHlwZSkgdHlwZTsK
LQkJYXNzZXJ0RXF1YWxzKCJPdXRlci5ATWFya2VyMSBJbm5lciIsIHNpbXBsZVR5cGUudG9TdHJp
bmcoKSk7Ci0JCUxpc3QgYW5ub3RhdGlvbnMgPSBzaW1wbGVUeXBlLmFubm90YXRpb25zKCk7CisJ
CWFzc2VydFRydWUodHlwZS5pc1F1YWxpZmllZFR5cGUoKSk7CisJCVF1YWxpZmllZFR5cGUgcXVh
bGlmaWVkVHlwZSA9IChRdWFsaWZpZWRUeXBlKSB0eXBlOworCQlhc3NlcnRFcXVhbHMoIk91dGVy
LkBNYXJrZXIxIElubmVyIiwgcXVhbGlmaWVkVHlwZS50b1N0cmluZygpKTsKKwkJTGlzdCBhbm5v
dGF0aW9ucyA9IHF1YWxpZmllZFR5cGUuYW5ub3RhdGlvbnMoKTsKIAkJYXNzZXJ0VHJ1ZShhbm5v
dGF0aW9ucy5zaXplKCkgPT0gMSk7CiAJCUFubm90YXRpb24gYW5ub3RhdGlvbiA9IChBbm5vdGF0
aW9uKSBhbm5vdGF0aW9ucy5nZXQoMCk7CiAJCWFzc2VydEVxdWFscygiQE1hcmtlcjEiLCBhbm5v
dGF0aW9uLnRvU3RyaW5nKCkpOwpAQCAtMzU5LDEzICszNTksMTMgQEAKIAkJdHlwZSA9IChUeXBl
KSB0eXBlQXJndW1lbnRzLmdldCgwKTsKIAkJYXNzZXJ0VHJ1ZSh0eXBlLmlzUXVhbGlmaWVkVHlw
ZSgpKTsKIAkJYXNzZXJ0RXF1YWxzKCJATWFya2VyMSBPdXRlci5Jbm5lciIsIHR5cGUudG9TdHJp
bmcoKSk7Ci0JCVF1YWxpZmllZFR5cGUgcXVhbGlmaWVkVHlwZSA9IChRdWFsaWZpZWRUeXBlKSB0
eXBlOworCQlxdWFsaWZpZWRUeXBlID0gKFF1YWxpZmllZFR5cGUpIHR5cGU7CiAJCWFzc2VydEVx
dWFscygiSW5uZXIiLCBxdWFsaWZpZWRUeXBlLmdldE5hbWUoKS50b1N0cmluZygpKTsKIAkJYW5u
b3RhdGlvbnMgPSBxdWFsaWZpZWRUeXBlLmFubm90YXRpb25zKCk7CiAJCWFzc2VydFRydWUoYW5u
b3RhdGlvbnMuc2l6ZSgpID09IDApOwogCQlUeXBlIHF1YWxpZmllclR5cGUgPSBxdWFsaWZpZWRU
eXBlLmdldFF1YWxpZmllcigpOwogCQlhc3NlcnRUcnVlKHF1YWxpZmllclR5cGUuaXNTaW1wbGVU
eXBlKCkpOwotCQlzaW1wbGVUeXBlID0gKFNpbXBsZVR5cGUpIHF1YWxpZmllclR5cGU7CisJCVNp
bXBsZVR5cGUgc2ltcGxlVHlwZSA9IChTaW1wbGVUeXBlKSBxdWFsaWZpZXJUeXBlOwogCQlhc3Nl
cnRFcXVhbHMoIkBNYXJrZXIxIE91dGVyIiwgc2ltcGxlVHlwZS50b1N0cmluZygpKTsKIAkJYW5u
b3RhdGlvbnMgPSBzaW1wbGVUeXBlLmFubm90YXRpb25zKCk7CiAJCWFzc2VydFRydWUoYW5ub3Rh
dGlvbnMuc2l6ZSgpID09IDEpOwpkaWZmIC0tZ2l0IGEvb3JnLmVjbGlwc2UuamR0LmNvcmUudGVz
dHMubW9kZWwvc3JjL29yZy9lY2xpcHNlL2pkdC9jb3JlL3Rlc3RzL2RvbS9BU1RTdHJ1Y3R1cmFs
UHJvcGVydHlUZXN0LmphdmEgYi9vcmcuZWNsaXBzZS5qZHQuY29yZS50ZXN0cy5tb2RlbC9zcmMv
b3JnL2VjbGlwc2UvamR0L2NvcmUvdGVzdHMvZG9tL0FTVFN0cnVjdHVyYWxQcm9wZXJ0eVRlc3Qu
amF2YQppbmRleCBlM2MxY2IxLi40MzMzNjQ3IDEwMDY0NAotLS0gYS9vcmcuZWNsaXBzZS5qZHQu
Y29yZS50ZXN0cy5tb2RlbC9zcmMvb3JnL2VjbGlwc2UvamR0L2NvcmUvdGVzdHMvZG9tL0FTVFN0
cnVjdHVyYWxQcm9wZXJ0eVRlc3QuamF2YQorKysgYi9vcmcuZWNsaXBzZS5qZHQuY29yZS50ZXN0
cy5tb2RlbC9zcmMvb3JnL2VjbGlwc2UvamR0L2NvcmUvdGVzdHMvZG9tL0FTVFN0cnVjdHVyYWxQ
cm9wZXJ0eVRlc3QuamF2YQpAQCAtMzUwLDcgKzM1MCw3IEBACiAJCQkJLy8gb29wcyAtIGd1ZXNz
IHRoYXQncyBub3QgdmFsaWQKIAkJCX0KIAkJfQotCQlhc3NlcnRFcXVhbHMoIldyb25nIGxhc3Qg
a25vd24gdHlwZSIsIDg2LCBoaSk7IC8vIGxhc3Qga25vd24gb25lCisJCWFzc2VydEVxdWFscygi
V3JvbmcgbGFzdCBrbm93biB0eXBlIiwgODcsIGhpKTsgLy8gbGFzdCBrbm93biBvbmUKIAkJYXNz
ZXJ0RXF1YWxzKCJXcm9uZyBudW1iZXIgb2YgZGlzdGluY3QgdHlwZXMiLCAgaGksIGNsYXNzZXMu
c2l6ZSgpKTsgLy8gYWxsIGNsYXNzZXMgYXJlIGRpc3RpbmN0CiAJfQogfQpkaWZmIC0tZ2l0IGEv
b3JnLmVjbGlwc2UuamR0LmNvcmUvZG9tL29yZy9lY2xpcHNlL2pkdC9jb3JlL2RvbS9BU1QuamF2
YSBiL29yZy5lY2xpcHNlLmpkdC5jb3JlL2RvbS9vcmcvZWNsaXBzZS9qZHQvY29yZS9kb20vQVNU
LmphdmEKaW5kZXggODdiZjRlNS4uMDE2MTVkZCAxMDA2NDQKLS0tIGEvb3JnLmVjbGlwc2UuamR0
LmNvcmUvZG9tL29yZy9lY2xpcHNlL2pkdC9jb3JlL2RvbS9BU1QuamF2YQorKysgYi9vcmcuZWNs
aXBzZS5qZHQuY29yZS9kb20vb3JnL2VjbGlwc2UvamR0L2NvcmUvZG9tL0FTVC5qYXZhCkBAIC0x
OTY2LDYgKzE5NjYsMjkgQEAKIAl9CiAKIAkvKioKKwkgKiBDcmVhdGVzIGFuZCByZXR1cm5zIGEg
bmV3IHVucGFyZW50ZWQgcGFja2FnZSBxdWFsaWZpZWQgdHlwZSBub2RlIHdpdGgKKwkgKiB0aGUg
Z2l2ZW4gcXVhbGlmaWVyIGFuZCBuYW1lLgorCSAqCisJICogQHBhcmFtIHF1YWxpZmllciB0aGUg
cGFja2FnZSBxdWFsaWZpZXIgdHlwZSBub2RlCisJICogQHBhcmFtIG5hbWUgdGhlIHNpbXBsZSBu
YW1lIGJlaW5nIHF1YWxpZmllZAorCSAqIEByZXR1cm4gYSBuZXcgdW5wYXJlbnRlZCBxdWFsaWZp
ZWQgdHlwZSBub2RlCisJICogQGV4Y2VwdGlvbiBJbGxlZ2FsQXJndW1lbnRFeGNlcHRpb24gaWY6
CisJICogPHVsPgorCSAqIDxsaT50aGUgbm9kZSBiZWxvbmdzIHRvIGEgZGlmZmVyZW50IEFTVDwv
bGk+CisJICogPGxpPnRoZSBub2RlIGFscmVhZHkgaGFzIGEgcGFyZW50PC9saT4KKwkgKiA8L3Vs
PgorCSAqIEBleGNlcHRpb24gVW5zdXBwb3J0ZWRPcGVyYXRpb25FeGNlcHRpb24gaWYgdGhpcyBv
cGVyYXRpb24gaXMgdXNlZCBpbgorCSAqIGEgSkxTMiwgSkxTMyBhbmQgSkxTNCBBU1QKKwkgKiBA
c2luY2UgMy45CisJICovCisJcHVibGljIFBhY2thZ2VRdWFsaWZpZWRUeXBlIG5ld1BhY2thZ2VR
dWFsaWZpZWRUeXBlKE5hbWUgcXVhbGlmaWVyLCBTaW1wbGVOYW1lIG5hbWUpIHsKKwkJUGFja2Fn
ZVF1YWxpZmllZFR5cGUgcmVzdWx0ID0gbmV3IFBhY2thZ2VRdWFsaWZpZWRUeXBlKHRoaXMpOwor
CQlyZXN1bHQuc2V0UXVhbGlmaWVyKHF1YWxpZmllcik7CisJCXJlc3VsdC5zZXROYW1lKG5hbWUp
OworCQlyZXR1cm4gcmVzdWx0OworCX0KKworCS8qKgogCSAqIENyZWF0ZXMgYW5kIHJldHVybnMg
YSBuZXcgdW5wYXJlbnRlZCBwYXJhbWV0ZXJpemVkIHR5cGUgbm9kZSB3aXRoIHRoZQogCSAqIGdp
dmVuIHR5cGUgYW5kIGFuIGVtcHR5IGxpc3Qgb2YgdHlwZSBhcmd1bWVudHMuCiAJICoKZGlmZiAt
LWdpdCBhL29yZy5lY2xpcHNlLmpkdC5jb3JlL2RvbS9vcmcvZWNsaXBzZS9qZHQvY29yZS9kb20v
QVNUQ29udmVydGVyLmphdmEgYi9vcmcuZWNsaXBzZS5qZHQuY29yZS9kb20vb3JnL2VjbGlwc2Uv
amR0L2NvcmUvZG9tL0FTVENvbnZlcnRlci5qYXZhCmluZGV4IGRmNDM5ODcuLjViYWI5ZWUgMTAw
NjQ0Ci0tLSBhL29yZy5lY2xpcHNlLmpkdC5jb3JlL2RvbS9vcmcvZWNsaXBzZS9qZHQvY29yZS9k
b20vQVNUQ29udmVydGVyLmphdmEKKysrIGIvb3JnLmVjbGlwc2UuamR0LmNvcmUvZG9tL29yZy9l
Y2xpcHNlL2pkdC9jb3JlL2RvbS9BU1RDb252ZXJ0ZXIuamF2YQpAQCAtNTMsNiArNTMsNyBAQAog
aW1wb3J0IG9yZy5lY2xpcHNlLmpkdC5pbnRlcm5hbC5jb21waWxlci5hc3QuV2lsZGNhcmQ7CiBp
bXBvcnQgb3JnLmVjbGlwc2UuamR0LmludGVybmFsLmNvbXBpbGVyLmNsYXNzZm10LkNsYXNzRmls
ZUNvbnN0YW50czsKIGltcG9ydCBvcmcuZWNsaXBzZS5qZHQuaW50ZXJuYWwuY29tcGlsZXIuaW1w
bC5Db21waWxlck9wdGlvbnM7CitpbXBvcnQgb3JnLmVjbGlwc2UuamR0LmludGVybmFsLmNvbXBp
bGVyLmxvb2t1cC5CaW5hcnlUeXBlQmluZGluZzsKIGltcG9ydCBvcmcuZWNsaXBzZS5qZHQuaW50
ZXJuYWwuY29tcGlsZXIubG9va3VwLkJsb2NrU2NvcGU7CiBpbXBvcnQgb3JnLmVjbGlwc2UuamR0
LmludGVybmFsLmNvbXBpbGVyLmxvb2t1cC5FeHRyYUNvbXBpbGVyTW9kaWZpZXJzOwogaW1wb3J0
IG9yZy5lY2xpcHNlLmpkdC5pbnRlcm5hbC5jb21waWxlci5sb29rdXAuVHlwZUNvbnN0YW50czsK
QEAgLTM1MjMsMTMgKzM1MjQsNyBAQAogCQkJCQkJc2ltcGxlVHlwZS5zZXROYW1lKG5hbWUpOwog
CQkJCQkJaW50IHN0YXJ0ID0gKGludCkocG9zaXRpb25zWzBdID4+PiAzMik7CiAJCQkJCQlpbnQg
ZW5kID0gKGludClwb3NpdGlvbnNbZmlyc3RUeXBlSW5kZXhdOwotCQkJCQkJc2ltcGxlVHlwZS5z
ZXRTb3VyY2VSYW5nZShzdGFydCwgZW5kIC0gc3RhcnQgKyAxKTsKLQkJCQkJCWlmICh0eXBlQW5u
b3RhdGlvbnMgIT0gbnVsbCAmJiAoYW5ub3RhdGlvbnMgPSB0eXBlQW5ub3RhdGlvbnNbZmlyc3RU
eXBlSW5kZXhdKSAhPSBudWxsKSB7Ci0JCQkJCQkJYW5ub3RhdGVUeXBlKHNpbXBsZVR5cGUsIGFu
bm90YXRpb25zKTsKLQkJCQkJCX0KLQkJCQkJCWlmICh0aGlzLnJlc29sdmVCaW5kaW5ncykgewot
CQkJCQkJCXJlY29yZE5vZGVzKHNpbXBsZVR5cGUsIHR5cGVSZWZlcmVuY2UpOwotCQkJCQkJfQor
CQkJCQkJc2V0U291cmNlQW5ub3RhdGlvbnNBbmRCaW5kaW5ncyh0eXBlUmVmZXJlbmNlLCBwb3Np
dGlvbnMsIHR5cGVBbm5vdGF0aW9ucywgZmlyc3RUeXBlSW5kZXgsIDAsIGZpcnN0VHlwZUluZGV4
LCBzaW1wbGVUeXBlKTsKIAkJCQkJCVR5cGUgY3VycmVudFR5cGUgPSBzaW1wbGVUeXBlOwkJCQkJ
CQogCQkJCQkJaW50IGluZGV4T2ZFbmNsb3NpbmdUeXBlID0gMTsKIAkJCQkJCWlmICh0eXBlQXJn
dW1lbnRzICE9IG51bGwgJiYgKGFyZ3VtZW50cyA9IHR5cGVBcmd1bWVudHNbZmlyc3RUeXBlSW5k
ZXhdKSAhPSBudWxsKSB7CkBAIC0zNjA1LDcgKzM2MDAsNyBAQAogCQkJCW9yZy5lY2xpcHNlLmpk
dC5pbnRlcm5hbC5jb21waWxlci5hc3QuQW5ub3RhdGlvbiBbXVtdIHR5cGVBbm5vdGF0aW9ucyA9
IHR5cGVSZWZlcmVuY2UuYW5ub3RhdGlvbnM7CiAJCQkJY2hhciBbXVtdIHRva2VucyA9IHF1YWxp
ZmllZFR5cGVSZWZlcmVuY2UudG9rZW5zOwogCQkJCWludCBsZW50aCA9IHRva2Vucy5sZW5ndGg7
Ci0JCQkJaW50IGZpcnN0VHlwZUluZGV4ID0gbGVudGggLSAxOworCQkJCWludCBmaXJzdFR5cGVJ
bmRleCA9IGxlbnRoOwogCQkJCQogCQkJCWlmICh0eXBlQW5ub3RhdGlvbnMgIT0gbnVsbCkgewog
CQkJCQlmb3IgKGludCBpID0gMDsgaSA8IGxlbnRoOyArK2kpIHsKQEAgLTM2MTcsNTcgKzM2MTIs
MzQgQEAKIAkJCQl9ICAKIAkJCQlzb3VyY2VTdGFydCA9IChpbnQpKHBvc2l0aW9uc1swXT4+PjMy
KTsKIAkJCQlOYW1lIG5hbWUgPSBudWxsOwotCQkJCWlmIChmaXJzdFR5cGVJbmRleCA9PSAwKSB7
Ci0JCQkJCWZpbmFsIFNpbXBsZU5hbWUgc2ltcGxlTmFtZSA9IG5ldyBTaW1wbGVOYW1lKHRoaXMu
YXN0KTsKLQkJCQkJc2ltcGxlTmFtZS5pbnRlcm5hbFNldElkZW50aWZpZXIobmV3IFN0cmluZyh0
b2tlbnNbMF0pKTsKLQkJCQkJcmVjb3JkUGVuZGluZ05hbWVTY29wZVJlc29sdXRpb24oc2ltcGxl
TmFtZSk7Ci0JCQkJCWludCBzdGFydCA9IChpbnQpIChwb3NpdGlvbnNbMF0gPj4+IDMyKTsKLQkJ
CQkJaW50IGVuZCA9IChpbnQpIHBvc2l0aW9uc1swXTsKLQkJCQkJc2ltcGxlTmFtZS5zZXRTb3Vy
Y2VSYW5nZShzdGFydCwgZW5kKTsKLQkJCQkJc2ltcGxlTmFtZS5pbmRleCA9IDE7Ci0JCQkJCW5h
bWUgPSBzaW1wbGVOYW1lOwotCQkJCQlpZiAodGhpcy5yZXNvbHZlQmluZGluZ3MpIHsKLQkJCQkJ
CXJlY29yZE5vZGVzKHNpbXBsZU5hbWUsIHR5cGVSZWZlcmVuY2UpOwotCQkJCQl9CQkJCQkKKwkJ
CQlUeXBlIGN1cnJlbnRUeXBlID0gbnVsbDsKKwkJCQlpZiAoZmlyc3RUeXBlSW5kZXggPT0gbGVu
dGgpIHsvL0p1c3QgYSBRdWFsaWZpZWROYW1lCisJCQkJCW5hbWUgPSBzZXRRdWFsaWZpZWROYW1l
TmFtZUFuZFNvdXJjZVJhbmdlcyh0b2tlbnMsIHBvc2l0aW9ucywgbGVudGggLSAxLCB0eXBlUmVm
ZXJlbmNlKTsJCQkJCQorCQkJCQljdXJyZW50VHlwZSA9IGdldFNpbXBsZVR5cGVXaXRoTmFtZUFu
ZEJpbmRpbmcobmFtZSwgdHlwZVJlZmVyZW5jZSwgcG9zaXRpb25zLCAwLCBsZW50aCAtIDEpOwog
CQkJCX0gZWxzZSB7Ci0JCQkJCW5hbWUgPSBzZXRRdWFsaWZpZWROYW1lTmFtZUFuZFNvdXJjZVJh
bmdlcyh0b2tlbnMsIHBvc2l0aW9ucywgZmlyc3RUeXBlSW5kZXgsIHR5cGVSZWZlcmVuY2UpOwot
CQkJCX0KLQkJCQlTaW1wbGVUeXBlIHNpbXBsZVR5cGUgPSBuZXcgU2ltcGxlVHlwZSh0aGlzLmFz
dCk7Ci0JCQkJc2ltcGxlVHlwZS5zZXROYW1lKG5hbWUpOwotCQkJCWludCBzdGFydCA9IChpbnQp
KHBvc2l0aW9uc1swXSA+Pj4gMzIpOwotCQkJCWludCBlbmQgPSAoaW50KXBvc2l0aW9uc1tmaXJz
dFR5cGVJbmRleF07Ci0JCQkJc2ltcGxlVHlwZS5zZXRTb3VyY2VSYW5nZShzdGFydCwgZW5kIC0g
c3RhcnQgKyAxKTsKLQkJCQlpZiAodHlwZUFubm90YXRpb25zICE9IG51bGwgJiYgKGFubm90YXRp
b25zID0gdHlwZUFubm90YXRpb25zW2ZpcnN0VHlwZUluZGV4XSkgIT0gbnVsbCkgewotCQkJCQlh
bm5vdGF0ZVR5cGUoc2ltcGxlVHlwZSwgYW5ub3RhdGlvbnMpOwotCQkJCX0KLQkJCQlpZiAodGhp
cy5yZXNvbHZlQmluZGluZ3MpIHsKLQkJCQkJcmVjb3JkTm9kZXMoc2ltcGxlVHlwZSwgdHlwZVJl
ZmVyZW5jZSk7Ci0JCQkJfQotCQkJCVR5cGUgY3VycmVudFR5cGUgPSBzaW1wbGVUeXBlOwotCQkJ
CQotCQkJCWZvciAoaW50IGkgPSBmaXJzdFR5cGVJbmRleCArIDE7IGkgPCBsZW50aDsgKytpKSB7
Ci0JCQkJCVNpbXBsZU5hbWUgc2ltcGxlTmFtZSA9IG5ldyBTaW1wbGVOYW1lKHRoaXMuYXN0KTsK
LQkJCQkJc2ltcGxlTmFtZS5pbnRlcm5hbFNldElkZW50aWZpZXIobmV3IFN0cmluZyh0b2tlbnNb
aV0pKTsKLQkJCQkJc2ltcGxlTmFtZS5pbmRleCA9IGkgKyAxOwotCQkJCQlzdGFydCA9IChpbnQp
IChwb3NpdGlvbnNbaV0gPj4+IDMyKTsKLQkJCQkJZW5kID0gKGludCkgcG9zaXRpb25zW2ldOwot
CQkJCQlzaW1wbGVOYW1lLnNldFNvdXJjZVJhbmdlKHN0YXJ0LCBlbmQgLSBzdGFydCArMSk7Ci0J
CQkJCXJlY29yZFBlbmRpbmdOYW1lU2NvcGVSZXNvbHV0aW9uKHNpbXBsZU5hbWUpOwotCQkJCQlR
dWFsaWZpZWRUeXBlIHF1YWxpZmllZFR5cGUgPSBuZXcgUXVhbGlmaWVkVHlwZSh0aGlzLmFzdCk7
Ci0JCQkJCXF1YWxpZmllZFR5cGUuc2V0UXVhbGlmaWVyKGN1cnJlbnRUeXBlKTsKLQkJCQkJcXVh
bGlmaWVkVHlwZS5zZXROYW1lKHNpbXBsZU5hbWUpOwotCQkJCQlpZiAodHlwZUFubm90YXRpb25z
ICE9IG51bGwgJiYgKGFubm90YXRpb25zID0gdHlwZUFubm90YXRpb25zW2ldKSAhPSBudWxsKSB7
Ci0JCQkJCQlhbm5vdGF0ZVR5cGUocXVhbGlmaWVkVHlwZSwgYW5ub3RhdGlvbnMpOworCQkJCQlp
ZiAoZmlyc3RUeXBlSW5kZXggPD0gMSkgeworCQkJCQkJbmFtZSA9IGNyZWF0ZVNpbXBsZU5hbWUo
dHlwZVJlZmVyZW5jZSwgcG9zaXRpb25zLCB0b2tlbnMsIDAgKTsKKwkJCQkJCWZpcnN0VHlwZUlu
ZGV4ID0gMTsKKwkJCQkJfSBlbHNlIHsKKwkJCQkJCW5hbWUgPSBzZXRRdWFsaWZpZWROYW1lTmFt
ZUFuZFNvdXJjZVJhbmdlcyh0b2tlbnMsIHBvc2l0aW9ucywgZmlyc3RUeXBlSW5kZXggLSAxLCB0
eXBlUmVmZXJlbmNlKTsKIAkJCQkJfQotCQkJCQlpZiAodGhpcy5yZXNvbHZlQmluZGluZ3MpIHsK
LQkJCQkJCXJlY29yZE5vZGVzKHNpbXBsZU5hbWUsIHR5cGVSZWZlcmVuY2UpOwotCQkJCQkJcmVj
b3JkTm9kZXMocXVhbGlmaWVkVHlwZSwgdHlwZVJlZmVyZW5jZSk7CisKKwkJCQkJb3JnLmVjbGlw
c2UuamR0LmludGVybmFsLmNvbXBpbGVyLmxvb2t1cC5UeXBlQmluZGluZyB0eXBlQmluZGluZyA9
IHR5cGVSZWZlcmVuY2UucmVzb2x2ZWRUeXBlOworCQkJCQlCaW5hcnlUeXBlQmluZGluZyBiaW5h
cnlUeXBlQmluZGluZyA9IHR5cGVCaW5kaW5nIGluc3RhbmNlb2YgQmluYXJ5VHlwZUJpbmRpbmcg
PyAoQmluYXJ5VHlwZUJpbmRpbmcpIHR5cGVCaW5kaW5nIDogbnVsbDsKKwkJCQkJaWYgKGJpbmFy
eVR5cGVCaW5kaW5nICE9IG51bGwgJiYgYmluYXJ5VHlwZUJpbmRpbmcuZlBhY2thZ2UgIT0gbnVs
bCkgeworCQkJCQkJUGFja2FnZVF1YWxpZmllZFR5cGUgcGFja2FnZVF1YWxpZmllZFR5cGUgPSBu
ZXcgUGFja2FnZVF1YWxpZmllZFR5cGUodGhpcy5hc3QpOworCQkJCQkJcGFja2FnZVF1YWxpZmll
ZFR5cGUuc2V0UXVhbGlmaWVyKG5hbWUpOworCQkJCQkJcGFja2FnZVF1YWxpZmllZFR5cGUuc2V0
TmFtZShjcmVhdGVTaW1wbGVOYW1lKHR5cGVSZWZlcmVuY2UsIHBvc2l0aW9ucywgdG9rZW5zLCBm
aXJzdFR5cGVJbmRleCkpOworCQkJCQkJc2V0U291cmNlQW5ub3RhdGlvbnNBbmRCaW5kaW5ncyh0
eXBlUmVmZXJlbmNlLCBwb3NpdGlvbnMsIHR5cGVBbm5vdGF0aW9ucywgZmlyc3RUeXBlSW5kZXgs
IDAsIGZpcnN0VHlwZUluZGV4LCBwYWNrYWdlUXVhbGlmaWVkVHlwZSk7CisJCQkJCQljdXJyZW50
VHlwZSA9IHBhY2thZ2VRdWFsaWZpZWRUeXBlOwkJCQkJCQkJCQkJCQkJCQkJCisJCQkJCX0gZWxz
ZSB7CisJCQkJCQlTaW1wbGVUeXBlIHNpbXBsZVR5cGUgPSB0aGlzLmFzdC5uZXdTaW1wbGVUeXBl
KG5hbWUpOworCQkJCQkJc2V0U291cmNlQW5ub3RhdGlvbnNBbmRCaW5kaW5ncyh0eXBlUmVmZXJl
bmNlLCBwb3NpdGlvbnMsIHR5cGVBbm5vdGF0aW9ucywgMCwgMCwgMCwgc2ltcGxlVHlwZSk7CisJ
CQkJCQljdXJyZW50VHlwZSA9IGdldFF1YWxpZmllZFR5cGVXaXRoU291cmNlQW5kQmluZGluZyh0
eXBlUmVmZXJlbmNlLCBwb3NpdGlvbnMsICB0eXBlQW5ub3RhdGlvbnMsIHRva2VucywgZmlyc3RU
eXBlSW5kZXgsIHNpbXBsZVR5cGUpOwogCQkJCQl9Ci0JCQkJCXN0YXJ0ID0gY3VycmVudFR5cGUu
Z2V0U3RhcnRQb3NpdGlvbigpOwotCQkJCQllbmQgPSBzaW1wbGVOYW1lLmdldFN0YXJ0UG9zaXRp
b24oKSArIHNpbXBsZU5hbWUuZ2V0TGVuZ3RoKCkgLSAxOwotCQkJCQlxdWFsaWZpZWRUeXBlLnNl
dFNvdXJjZVJhbmdlKHN0YXJ0LCBlbmQgLSBzdGFydCArIDEpOwotCQkJCQljdXJyZW50VHlwZSA9
IHF1YWxpZmllZFR5cGU7Ci0JCQkJCXF1YWxpZmllZFR5cGUuaW5kZXggID0gMTsKKwkJCQkJZm9y
IChpbnQgaSA9IGZpcnN0VHlwZUluZGV4ICsgMTsgaSA8IGxlbnRoOyArK2kpIHsKKwkJCQkJCWN1
cnJlbnRUeXBlID0gZ2V0UXVhbGlmaWVkVHlwZVdpdGhTb3VyY2VBbmRCaW5kaW5nKHR5cGVSZWZl
cmVuY2UsIHBvc2l0aW9ucywgIHR5cGVBbm5vdGF0aW9ucywgdG9rZW5zLCBpLCBjdXJyZW50VHlw
ZSk7CisJCQkJCX0JCQkJCQogCQkJCX0KIAkJCQl0eXBlID0gY3VycmVudFR5cGU7CiAJCQl9IGVs
c2UgewpAQCAtMzc1Nyw2ICszNzI5LDY3IEBACiAJCXJldHVybiB0eXBlOwogCX0KIAorCXByaXZh
dGUgUXVhbGlmaWVkVHlwZSBnZXRRdWFsaWZpZWRUeXBlV2l0aFNvdXJjZUFuZEJpbmRpbmcoVHlw
ZVJlZmVyZW5jZSB0eXBlUmVmZXJlbmNlLCBsb25nW10gcG9zaXRpb25zLAorCQkJb3JnLmVjbGlw
c2UuamR0LmludGVybmFsLmNvbXBpbGVyLmFzdC5Bbm5vdGF0aW9uW11bXSB0eXBlQW5ub3RhdGlv
bnMsIGNoYXJbXVtdIHRva2VucywgaW50IGluZGV4LAorCQkJVHlwZSBxdWFsaWZpZXIpIHsKKwkJ
U2ltcGxlTmFtZSBzaW1wbGVOYW1lID0gY3JlYXRlU2ltcGxlTmFtZSh0eXBlUmVmZXJlbmNlLCBw
b3NpdGlvbnMsIHRva2VucywgaW5kZXgpOworCQlRdWFsaWZpZWRUeXBlIHF1YWxpZmllZFR5cGUg
PSBuZXcgUXVhbGlmaWVkVHlwZSh0aGlzLmFzdCk7CisJCXF1YWxpZmllZFR5cGUuc2V0UXVhbGlm
aWVyKHF1YWxpZmllcik7CisJCXF1YWxpZmllZFR5cGUuc2V0TmFtZShzaW1wbGVOYW1lKTsKKwkJ
aW50IHN0YXJ0ID0gcXVhbGlmaWVyLmdldFN0YXJ0UG9zaXRpb24oKTsKKwkJaW50IGVuZCA9IHNp
bXBsZU5hbWUuZ2V0U3RhcnRQb3NpdGlvbigpICsgc2ltcGxlTmFtZS5nZXRMZW5ndGgoKSAtIDE7
CisJCXNldFNvdXJjZUFubm90YXRpb25zQW5kQmluZGluZ3ModHlwZVJlZmVyZW5jZSwgdHlwZUFu
bm90YXRpb25zLCBpbmRleCwgc3RhcnQsIGVuZCwgcXVhbGlmaWVkVHlwZSk7CisJCXJldHVybiBx
dWFsaWZpZWRUeXBlOworCX0KKworCXByaXZhdGUgU2ltcGxlVHlwZSBnZXRTaW1wbGVUeXBlV2l0
aE5hbWVBbmRCaW5kaW5nKE5hbWUgbmFtZSwgVHlwZVJlZmVyZW5jZSB0eXBlUmVmZXJlbmNlLCBs
b25nW10gcG9zaXRpb25zLAorCQkJaW50IHN0YXJ0SW5kZXgsIGludCBlbmRJbmRleCkgeworCQlT
aW1wbGVUeXBlIHNpbXBsZVR5cGUgPSBuZXcgU2ltcGxlVHlwZSh0aGlzLmFzdCk7CisJCXNpbXBs
ZVR5cGUuc2V0TmFtZShuYW1lKTsKKwkJaW50IHN0YXJ0ID0gKGludCkocG9zaXRpb25zW3N0YXJ0
SW5kZXhdID4+PiAzMik7CisJCWludCBlbmQgPSAoaW50KXBvc2l0aW9uc1tlbmRJbmRleF07CisJ
CXNpbXBsZVR5cGUuc2V0U291cmNlUmFuZ2Uoc3RhcnQsIGVuZCAtIHN0YXJ0ICsgMSk7CisJCWlm
ICh0aGlzLnJlc29sdmVCaW5kaW5ncykgeworCQkJcmVjb3JkTm9kZXMoc2ltcGxlVHlwZSwgdHlw
ZVJlZmVyZW5jZSk7CisJCX0KKwkJcmV0dXJuIHNpbXBsZVR5cGU7CisJfQorCisJcHJpdmF0ZSB2
b2lkIHNldFNvdXJjZUFubm90YXRpb25zQW5kQmluZGluZ3MoVHlwZVJlZmVyZW5jZSB0eXBlUmVm
ZXJlbmNlLCAKKwkJCW9yZy5lY2xpcHNlLmpkdC5pbnRlcm5hbC5jb21waWxlci5hc3QuQW5ub3Rh
dGlvbltdW10gdHlwZUFubm90YXRpb25zLCBpbnQgaW5kZXgsIGludCBzdGFydCwgaW50IGVuZCwK
KwkJCUFubm90YXRhYmxlVHlwZSBhbm5vdGF0YWJsZVR5cGUpIHsKKwkJb3JnLmVjbGlwc2UuamR0
LmludGVybmFsLmNvbXBpbGVyLmFzdC5Bbm5vdGF0aW9uW10gYW5ub3RhdGlvbnM7CisJCWFubm90
YXRhYmxlVHlwZS5zZXRTb3VyY2VSYW5nZShzdGFydCwgZW5kIC0gc3RhcnQgKyAxKTsKKwkJaWYg
KHR5cGVBbm5vdGF0aW9ucyAhPSBudWxsICYmIChhbm5vdGF0aW9ucyA9IHR5cGVBbm5vdGF0aW9u
c1tpbmRleF0pICE9IG51bGwpIHsKKwkJCWFubm90YXRlVHlwZShhbm5vdGF0YWJsZVR5cGUsIGFu
bm90YXRpb25zKTsKKwkJfQorCQlpZiAodGhpcy5yZXNvbHZlQmluZGluZ3MpIHsKKwkJCXJlY29y
ZE5vZGVzKGFubm90YXRhYmxlVHlwZSwgdHlwZVJlZmVyZW5jZSk7CisJCX0KKwl9CisKKwlwcml2
YXRlIHZvaWQgc2V0U291cmNlQW5ub3RhdGlvbnNBbmRCaW5kaW5ncyhUeXBlUmVmZXJlbmNlIHR5
cGVSZWZlcmVuY2UsIGxvbmdbXSBwb3NpdGlvbnMsCisJCQlvcmcuZWNsaXBzZS5qZHQuaW50ZXJu
YWwuY29tcGlsZXIuYXN0LkFubm90YXRpb25bXVtdIHR5cGVBbm5vdGF0aW9ucywgaW50IGluZGV4
LCBpbnQgc3RhcnRJbmRleCwgaW50IGVuZEluZGV4LAorCQkJQW5ub3RhdGFibGVUeXBlIGFubm90
YXRhYmxlVHlwZSkgeworCQlpbnQgc3RhcnQgPSAoaW50KSAocG9zaXRpb25zW3N0YXJ0SW5kZXhd
ID4+PiAzMik7CisJCWludCBlbmQgPSAoaW50KSBwb3NpdGlvbnNbZW5kSW5kZXhdOworCQlzZXRT
b3VyY2VBbm5vdGF0aW9uc0FuZEJpbmRpbmdzKHR5cGVSZWZlcmVuY2UsIHR5cGVBbm5vdGF0aW9u
cywgaW5kZXgsIHN0YXJ0LCBlbmQsIGFubm90YXRhYmxlVHlwZSk7CisJfQorCisJcHJpdmF0ZSBT
aW1wbGVOYW1lIGNyZWF0ZVNpbXBsZU5hbWUoVHlwZVJlZmVyZW5jZSB0eXBlUmVmZXJlbmNlLCBs
b25nW10gcG9zaXRpb25zLCBjaGFyW11bXSB0b2tlbnMsIGludCBpbmRleCkgeworCQlmaW5hbCBT
aW1wbGVOYW1lIHNpbXBsZU5hbWUgPSBuZXcgU2ltcGxlTmFtZSh0aGlzLmFzdCk7CisJCXNpbXBs
ZU5hbWUuaW50ZXJuYWxTZXRJZGVudGlmaWVyKG5ldyBTdHJpbmcodG9rZW5zW2luZGV4XSkpOwor
CQlyZWNvcmRQZW5kaW5nTmFtZVNjb3BlUmVzb2x1dGlvbihzaW1wbGVOYW1lKTsKKwkJaW50IHN0
YXJ0ID0gKGludCkgKHBvc2l0aW9uc1tpbmRleF0gPj4+IDMyKTsKKwkJaW50IGVuZCA9IChpbnQp
IHBvc2l0aW9uc1tpbmRleF07CisJCXNpbXBsZU5hbWUuc2V0U291cmNlUmFuZ2Uoc3RhcnQsIGVu
ZCAtIHN0YXJ0ICsgMSk7CisJCXNpbXBsZU5hbWUuaW5kZXggPSBpbmRleCArIDE7CisJCWlmICh0
aGlzLnJlc29sdmVCaW5kaW5ncykgeworCQkJcmVjb3JkTm9kZXMoc2ltcGxlTmFtZSwgdHlwZVJl
ZmVyZW5jZSk7CisJCX0KKwkJcmV0dXJuIHNpbXBsZU5hbWU7CisJfQorCiAJcHJvdGVjdGVkIENv
bW1lbnQgY3JlYXRlQ29tbWVudChpbnRbXSBwb3NpdGlvbnMpIHsKIAkJLy8gQ3JlYXRlIGNvbW1l
bnQgbm9kZQogCQlDb21tZW50IGNvbW1lbnQgPSBudWxsOwpkaWZmIC0tZ2l0IGEvb3JnLmVjbGlw
c2UuamR0LmNvcmUvZG9tL29yZy9lY2xpcHNlL2pkdC9jb3JlL2RvbS9BU1RNYXRjaGVyLmphdmEg
Yi9vcmcuZWNsaXBzZS5qZHQuY29yZS9kb20vb3JnL2VjbGlwc2UvamR0L2NvcmUvZG9tL0FTVE1h
dGNoZXIuamF2YQppbmRleCBlYjEzZWM2Li4wZGZjOTkwIDEwMDY0NAotLS0gYS9vcmcuZWNsaXBz
ZS5qZHQuY29yZS9kb20vb3JnL2VjbGlwc2UvamR0L2NvcmUvZG9tL0FTVE1hdGNoZXIuamF2YQor
KysgYi9vcmcuZWNsaXBzZS5qZHQuY29yZS9kb20vb3JnL2VjbGlwc2UvamR0L2NvcmUvZG9tL0FT
VE1hdGNoZXIuamF2YQpAQCAtMTU2OSw2ICsxNTY5LDMxIEBACiAJICogQHJldHVybiA8Y29kZT50
cnVlPC9jb2RlPiBpZiB0aGUgc3VidHJlZSBtYXRjaGVzLCBvcgogCSAqICAgPGNvZGU+ZmFsc2U8
L2NvZGU+IGlmIHRoZXkgZG8gbm90IG1hdGNoIG9yIHRoZSBvdGhlciBvYmplY3QgaGFzIGEKIAkg
KiAgIGRpZmZlcmVudCBub2RlIHR5cGUgb3IgaXMgPGNvZGU+bnVsbDwvY29kZT4KKwkgKiBAc2lu
Y2UgMy45CisJICovCisJcHVibGljIGJvb2xlYW4gbWF0Y2goUGFja2FnZVF1YWxpZmllZFR5cGUg
bm9kZSwgT2JqZWN0IG90aGVyKSB7CisJCWlmICghKG90aGVyIGluc3RhbmNlb2YgUGFja2FnZVF1
YWxpZmllZFR5cGUpKSB7CisJCQlyZXR1cm4gZmFsc2U7CisJCX0KKwkJUGFja2FnZVF1YWxpZmll
ZFR5cGUgbyA9IChQYWNrYWdlUXVhbGlmaWVkVHlwZSkgb3RoZXI7CisJCXJldHVybiBzYWZlU3Vi
dHJlZU1hdGNoKG5vZGUuZ2V0UXVhbGlmaWVyKCksIG8uZ2V0UXVhbGlmaWVyKCkpCisJCQkJJiYg
c2FmZVN1YnRyZWVMaXN0TWF0Y2gobm9kZS5hbm5vdGF0aW9ucygpLCBvLmFubm90YXRpb25zKCkp
CisJCQkJJiYgc2FmZVN1YnRyZWVNYXRjaChub2RlLmdldE5hbWUoKSwgby5nZXROYW1lKCkpOwor
CX0KKworCS8qKgorCSAqIFJldHVybnMgd2hldGhlciB0aGUgZ2l2ZW4gbm9kZSBhbmQgdGhlIG90
aGVyIG9iamVjdCBtYXRjaC4KKwkgKiA8cD4KKwkgKiBUaGUgZGVmYXVsdCBpbXBsZW1lbnRhdGlv
biBwcm92aWRlZCBieSB0aGlzIGNsYXNzIHRlc3RzIHdoZXRoZXIgdGhlCisJICogb3RoZXIgb2Jq
ZWN0IGlzIGEgbm9kZSBvZiB0aGUgc2FtZSB0eXBlIHdpdGggc3RydWN0dXJhbGx5IGlzb21vcnBo
aWMKKwkgKiBjaGlsZCBzdWJ0cmVlcy4gU3ViY2xhc3NlcyBtYXkgb3ZlcnJpZGUgdGhpcyBtZXRo
b2QgYXMgbmVlZGVkLgorCSAqIDwvcD4KKwkgKgorCSAqIEBwYXJhbSBub2RlIHRoZSBub2RlCisJ
ICogQHBhcmFtIG90aGVyIHRoZSBvdGhlciBvYmplY3QsIG9yIDxjb2RlPm51bGw8L2NvZGU+CisJ
ICogQHJldHVybiA8Y29kZT50cnVlPC9jb2RlPiBpZiB0aGUgc3VidHJlZSBtYXRjaGVzLCBvcgor
CSAqICAgPGNvZGU+ZmFsc2U8L2NvZGU+IGlmIHRoZXkgZG8gbm90IG1hdGNoIG9yIHRoZSBvdGhl
ciBvYmplY3QgaGFzIGEKKwkgKiAgIGRpZmZlcmVudCBub2RlIHR5cGUgb3IgaXMgPGNvZGU+bnVs
bDwvY29kZT4KIAkgKiBAc2luY2UgMy4xCiAJICovCiAJcHVibGljIGJvb2xlYW4gbWF0Y2goUGFy
YW1ldGVyaXplZFR5cGUgbm9kZSwgT2JqZWN0IG90aGVyKSB7CmRpZmYgLS1naXQgYS9vcmcuZWNs
aXBzZS5qZHQuY29yZS9kb20vb3JnL2VjbGlwc2UvamR0L2NvcmUvZG9tL0FTVE5vZGUuamF2YSBi
L29yZy5lY2xpcHNlLmpkdC5jb3JlL2RvbS9vcmcvZWNsaXBzZS9qZHQvY29yZS9kb20vQVNUTm9k
ZS5qYXZhCmluZGV4IGY3ZGM5MGMuLmQ1YjIyNDMgMTAwNjQ0Ci0tLSBhL29yZy5lY2xpcHNlLmpk
dC5jb3JlL2RvbS9vcmcvZWNsaXBzZS9qZHQvY29yZS9kb20vQVNUTm9kZS5qYXZhCisrKyBiL29y
Zy5lY2xpcHNlLmpkdC5jb3JlL2RvbS9vcmcvZWNsaXBzZS9qZHQvY29yZS9kb20vQVNUTm9kZS5q
YXZhCkBAIC04NTEsNiArODUxLDE0IEBACiAJcHVibGljIHN0YXRpYyBmaW5hbCBpbnQgTEFNQkRB
X0VYUFJFU1NJT04gPSA4NjsKIAogCS8qKgorCSAqIE5vZGUgdHlwZSBjb25zdGFudCBpbmRpY2F0
aW5nIGEgbm9kZSBvZiB0eXBlCisJICogPGNvZGU+UXVhbGlmaWVkVHlwZTwvY29kZT4uCisJICog
QHNlZSBRdWFsaWZpZWRUeXBlCisJICogQHNpbmNlIDMuOQorCSAqLworCXB1YmxpYyBzdGF0aWMg
ZmluYWwgaW50IFBBQ0tBR0VfUVVBTElGSUVEX1RZUEUgPSA4NzsKKworCS8qKgogCSAqIFJldHVy
bnMgdGhlIG5vZGUgY2xhc3MgZm9yIHRoZSBjb3JyZXNwb25kaW5nIG5vZGUgdHlwZS4KIAkgKgog
CSAqIEBwYXJhbSBub2RlVHlwZSBBU1Qgbm9kZSB0eXBlCkBAIC05NjgsNiArOTc2LDggQEAKIAkJ
CQlyZXR1cm4gTnVtYmVyTGl0ZXJhbC5jbGFzczsKIAkJCWNhc2UgUEFDS0FHRV9ERUNMQVJBVElP
TiA6CiAJCQkJcmV0dXJuIFBhY2thZ2VEZWNsYXJhdGlvbi5jbGFzczsKKwkJCWNhc2UgUEFDS0FH
RV9RVUFMSUZJRURfVFlQRSA6CisJCQkJcmV0dXJuIFBhY2thZ2VRdWFsaWZpZWRUeXBlLmNsYXNz
OwogCQkJY2FzZSBQQVJBTUVURVJJWkVEX1RZUEUgOgogCQkJCXJldHVybiBQYXJhbWV0ZXJpemVk
VHlwZS5jbGFzczsKIAkJCWNhc2UgUEFSRU5USEVTSVpFRF9FWFBSRVNTSU9OIDoKZGlmZiAtLWdp
dCBhL29yZy5lY2xpcHNlLmpkdC5jb3JlL2RvbS9vcmcvZWNsaXBzZS9qZHQvY29yZS9kb20vQVNU
VmlzaXRvci5qYXZhIGIvb3JnLmVjbGlwc2UuamR0LmNvcmUvZG9tL29yZy9lY2xpcHNlL2pkdC9j
b3JlL2RvbS9BU1RWaXNpdG9yLmphdmEKaW5kZXggNDQyYzJkMi4uMTQ5OWYwYiAxMDA2NDQKLS0t
IGEvb3JnLmVjbGlwc2UuamR0LmNvcmUvZG9tL29yZy9lY2xpcHNlL2pkdC9jb3JlL2RvbS9BU1RW
aXNpdG9yLmphdmEKKysrIGIvb3JnLmVjbGlwc2UuamR0LmNvcmUvZG9tL29yZy9lY2xpcHNlL2pk
dC9jb3JlL2RvbS9BU1RWaXNpdG9yLmphdmEKQEAgLTEwNzIsNiArMTA3MiwyMyBAQAogCSAqIEBy
ZXR1cm4gPGNvZGU+dHJ1ZTwvY29kZT4gaWYgdGhlIGNoaWxkcmVuIG9mIHRoaXMgbm9kZSBzaG91
bGQgYmUKIAkgKiB2aXNpdGVkLCBhbmQgPGNvZGU+ZmFsc2U8L2NvZGU+IGlmIHRoZSBjaGlsZHJl
biBvZiB0aGlzIG5vZGUgc2hvdWxkCiAJICogYmUgc2tpcHBlZAorCSAqIEBzaW5jZSAzLjkKKwkg
Ki8KKwlwdWJsaWMgYm9vbGVhbiB2aXNpdChQYWNrYWdlUXVhbGlmaWVkVHlwZSBub2RlKSB7CisJ
CXJldHVybiB0cnVlOworCX0KKworCS8qKgorCSAqIFZpc2l0cyB0aGUgZ2l2ZW4gdHlwZS1zcGVj
aWZpYyBBU1Qgbm9kZS4KKwkgKiA8cD4KKwkgKiBUaGUgZGVmYXVsdCBpbXBsZW1lbnRhdGlvbiBk
b2VzIG5vdGhpbmcgYW5kIHJldHVybiB0cnVlLgorCSAqIFN1YmNsYXNzZXMgbWF5IHJlaW1wbGVt
ZW50LgorCSAqIDwvcD4KKwkgKgorCSAqIEBwYXJhbSBub2RlIHRoZSBub2RlIHRvIHZpc2l0CisJ
ICogQHJldHVybiA8Y29kZT50cnVlPC9jb2RlPiBpZiB0aGUgY2hpbGRyZW4gb2YgdGhpcyBub2Rl
IHNob3VsZCBiZQorCSAqIHZpc2l0ZWQsIGFuZCA8Y29kZT5mYWxzZTwvY29kZT4gaWYgdGhlIGNo
aWxkcmVuIG9mIHRoaXMgbm9kZSBzaG91bGQKKwkgKiBiZSBza2lwcGVkCiAJICogQHNpbmNlIDMu
MQogCSAqLwogCXB1YmxpYyBib29sZWFuIHZpc2l0KFBhcmFtZXRlcml6ZWRUeXBlIG5vZGUpIHsK
QEAgLTIyNzQsNiArMjI5MSwxOSBAQAogCSAqIDwvcD4KIAkgKgogCSAqIEBwYXJhbSBub2RlIHRo
ZSBub2RlIHRvIHZpc2l0CisJICogQHNpbmNlIDMuOQorCSAqLworCXB1YmxpYyB2b2lkIGVuZFZp
c2l0KFBhY2thZ2VRdWFsaWZpZWRUeXBlIG5vZGUpIHsKKwkJLy8gZGVmYXVsdCBpbXBsZW1lbnRh
dGlvbjogZG8gbm90aGluZworCX0KKworCS8qKgorCSAqIEVuZCBvZiB2aXNpdCB0aGUgZ2l2ZW4g
dHlwZS1zcGVjaWZpYyBBU1Qgbm9kZS4KKwkgKiA8cD4KKwkgKiBUaGUgZGVmYXVsdCBpbXBsZW1l
bnRhdGlvbiBkb2VzIG5vdGhpbmcuIFN1YmNsYXNzZXMgbWF5IHJlaW1wbGVtZW50LgorCSAqIDwv
cD4KKwkgKgorCSAqIEBwYXJhbSBub2RlIHRoZSBub2RlIHRvIHZpc2l0CiAJICogQHNpbmNlIDMu
MQogCSAqLwogCXB1YmxpYyB2b2lkIGVuZFZpc2l0KFBhcmFtZXRlcml6ZWRUeXBlIG5vZGUpIHsK
ZGlmZiAtLWdpdCBhL29yZy5lY2xpcHNlLmpkdC5jb3JlL2RvbS9vcmcvZWNsaXBzZS9qZHQvY29y
ZS9kb20vUGFja2FnZVF1YWxpZmllZFR5cGUuamF2YSBiL29yZy5lY2xpcHNlLmpkdC5jb3JlL2Rv
bS9vcmcvZWNsaXBzZS9qZHQvY29yZS9kb20vUGFja2FnZVF1YWxpZmllZFR5cGUuamF2YQpuZXcg
ZmlsZSBtb2RlIDEwMDY0NAppbmRleCAwMDAwMDAwLi43MDljOTJlCi0tLSAvZGV2L251bGwKKysr
IGIvb3JnLmVjbGlwc2UuamR0LmNvcmUvZG9tL29yZy9lY2xpcHNlL2pkdC9jb3JlL2RvbS9QYWNr
YWdlUXVhbGlmaWVkVHlwZS5qYXZhCkBAIC0wLDAgKzEsMjg2IEBACisvKioqKioqKioqKioqKioq
KioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioq
KioqKioqKgorICogQ29weXJpZ2h0IChjKSAyMDAzLCAyMDEzIElCTSBDb3Jwb3JhdGlvbiBhbmQg
b3RoZXJzLgorICogQWxsIHJpZ2h0cyByZXNlcnZlZC4gVGhpcyBwcm9ncmFtIGFuZCB0aGUgYWNj
b21wYW55aW5nIG1hdGVyaWFscworICogYXJlIG1hZGUgYXZhaWxhYmxlIHVuZGVyIHRoZSB0ZXJt
cyBvZiB0aGUgRWNsaXBzZSBQdWJsaWMgTGljZW5zZSB2MS4wCisgKiB3aGljaCBhY2NvbXBhbmll
cyB0aGlzIGRpc3RyaWJ1dGlvbiwgYW5kIGlzIGF2YWlsYWJsZSBhdAorICogaHR0cDovL3d3dy5l
Y2xpcHNlLm9yZy9sZWdhbC9lcGwtdjEwLmh0bWwKKyAqCisgKiBUaGlzIGlzIGFuIGltcGxlbWVu
dGF0aW9uIG9mIGFuIGVhcmx5LWRyYWZ0IHNwZWNpZmljYXRpb24gZGV2ZWxvcGVkIHVuZGVyIHRo
ZSBKYXZhCisgKiBDb21tdW5pdHkgUHJvY2VzcyAoSkNQKSBhbmQgaXMgbWFkZSBhdmFpbGFibGUg
Zm9yIHRlc3RpbmcgYW5kIGV2YWx1YXRpb24gcHVycG9zZXMKKyAqIG9ubHkuIFRoZSBjb2RlIGlz
IG5vdCBjb21wYXRpYmxlIHdpdGggYW55IHNwZWNpZmljYXRpb24gb2YgdGhlIEpDUC4KKyAqIAor
ICogQ29udHJpYnV0b3JzOgorICogICAgIElCTSBDb3Jwb3JhdGlvbiAtIGluaXRpYWwgQVBJIGFu
ZCBpbXBsZW1lbnRhdGlvbgorICoqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioq
KioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKiovCisKK3BhY2thZ2Ugb3Jn
LmVjbGlwc2UuamR0LmNvcmUuZG9tOworCitpbXBvcnQgamF2YS51dGlsLkFycmF5TGlzdDsKK2lt
cG9ydCBqYXZhLnV0aWwuTGlzdDsKKworLyoqCisgKiBUeXBlIG5vZGUgZm9yIGEgcXVhbGlmaWVk
IHBhY2FrZ2UgdHlwZSAoYWRkZWQgaW4gSkxTOCBBUEkpLgorICogCisgKiA8cHJlPgorICogUGFj
a2FnZVF1YWxpZmllZFR5cGU6CisgKiAgICBOYW1lIDxiPi48L2I+IHsgQW5ub3RhdGlvbiB9IFNp
bXBsZU5hbWUKKyAqIDwvcHJlPgorICoKKyAqIEBzaW5jZSAzLjkKKyAqIEBub2luc3RhbnRpYXRl
IFRoaXMgY2xhc3MgaXMgbm90IGludGVuZGVkIHRvIGJlIGluc3RhbnRpYXRlZCBieSBjbGllbnRz
LgorICovCitwdWJsaWMgY2xhc3MgUGFja2FnZVF1YWxpZmllZFR5cGUgZXh0ZW5kcyBBbm5vdGF0
YWJsZVR5cGUgeworCisJLyoqCisJICogVGhlICJxdWFsaWZpZXIiIHN0cnVjdHVyYWwgcHJvcGVy
dHkgb2YgdGhpcyBub2RlIHR5cGUgKGNoaWxkIHR5cGU6IHtAbGluayBOYW1lfSkuCisJICovCisJ
cHVibGljIHN0YXRpYyBmaW5hbCBDaGlsZFByb3BlcnR5RGVzY3JpcHRvciBRVUFMSUZJRVJfUFJP
UEVSVFkgPQorCQluZXcgQ2hpbGRQcm9wZXJ0eURlc2NyaXB0b3IoUGFja2FnZVF1YWxpZmllZFR5
cGUuY2xhc3MsICJxdWFsaWZpZXIiLCBOYW1lLmNsYXNzLCBNQU5EQVRPUlksIE5PX0NZQ0xFX1JJ
U0spOyAvLyROT04tTkxTLTEkCisKKwkvKioKKwkgKiBUaGUgImFubm90YXRpb25zIiBzdHJ1Y3R1
cmFsIHByb3BlcnR5IG9mIHRoaXMgbm9kZSB0eXBlIChlbGVtZW50IHR5cGU6IHtAbGluayBBbm5v
dGF0aW9ufSkuCisJICogQHNpbmNlIDMuOQorCSAqLworCXB1YmxpYyBzdGF0aWMgZmluYWwgQ2hp
bGRMaXN0UHJvcGVydHlEZXNjcmlwdG9yIEFOTk9UQVRJT05TX1BST1BFUlRZID0KKwkJCWludGVy
bmFsQW5ub3RhdGlvbnNQcm9wZXJ0eUZhY3RvcnkoUGFja2FnZVF1YWxpZmllZFR5cGUuY2xhc3Mp
OworCQorCS8qKgorCSAqIFRoZSAibmFtZSIgc3RydWN0dXJhbCBwcm9wZXJ0eSBvZiB0aGlzIG5v
ZGUgdHlwZSAoY2hpbGQgdHlwZToge0BsaW5rIFNpbXBsZU5hbWV9KS4KKwkgKi8KKwlwdWJsaWMg
c3RhdGljIGZpbmFsIENoaWxkUHJvcGVydHlEZXNjcmlwdG9yIE5BTUVfUFJPUEVSVFkgPQorCQlu
ZXcgQ2hpbGRQcm9wZXJ0eURlc2NyaXB0b3IoUGFja2FnZVF1YWxpZmllZFR5cGUuY2xhc3MsICJu
YW1lIiwgU2ltcGxlTmFtZS5jbGFzcywgTUFOREFUT1JZLCBOT19DWUNMRV9SSVNLKTsgLy8kTk9O
LU5MUy0xJAorCQorCS8qKgorCSAqIEEgbGlzdCBvZiBwcm9wZXJ0eSBkZXNjcmlwdG9ycyAoZWxl
bWVudCB0eXBlOgorCSAqIHtAbGluayBTdHJ1Y3R1cmFsUHJvcGVydHlEZXNjcmlwdG9yfSksCisJ
ICogb3IgbnVsbCBpZiB1bmluaXRpYWxpemVkLgorCSAqLworCXByaXZhdGUgc3RhdGljIGZpbmFs
IExpc3QgUFJPUEVSVFlfREVTQ1JJUFRPUlM7CisKKwlzdGF0aWMgeworCQlMaXN0IHByb3BlcnR5
TGlzdCA9IG5ldyBBcnJheUxpc3QoNCk7CisJCWNyZWF0ZVByb3BlcnR5TGlzdChQYWNrYWdlUXVh
bGlmaWVkVHlwZS5jbGFzcywgcHJvcGVydHlMaXN0KTsKKwkJYWRkUHJvcGVydHkoUVVBTElGSUVS
X1BST1BFUlRZLCBwcm9wZXJ0eUxpc3QpOworCQlhZGRQcm9wZXJ0eShBTk5PVEFUSU9OU19QUk9Q
RVJUWSwgcHJvcGVydHlMaXN0KTsKKwkJYWRkUHJvcGVydHkoTkFNRV9QUk9QRVJUWSwgcHJvcGVy
dHlMaXN0KTsKKwkJUFJPUEVSVFlfREVTQ1JJUFRPUlMgPSByZWFwUHJvcGVydHlMaXN0KHByb3Bl
cnR5TGlzdCk7CisJfQorCisJLyoqCisJICogUmV0dXJucyBhIGxpc3Qgb2Ygc3RydWN0dXJhbCBw
cm9wZXJ0eSBkZXNjcmlwdG9ycyBmb3IgdGhpcyBub2RlIHR5cGUuCisJICogQ2xpZW50cyBtdXN0
IG5vdCBtb2RpZnkgdGhlIHJlc3VsdC4KKwkgKgorCSAqIEBwYXJhbSBhcGlMZXZlbCB0aGUgQVBJ
IGxldmVsOyBvbmUgb2YgdGhlCisJICogPGNvZGU+QVNULkpMUyo8L2NvZGU+IGNvbnN0YW50cwor
CSAqIEByZXR1cm4gYSBsaXN0IG9mIHByb3BlcnR5IGRlc2NyaXB0b3JzIChlbGVtZW50IHR5cGU6
CisJICoge0BsaW5rIFN0cnVjdHVyYWxQcm9wZXJ0eURlc2NyaXB0b3J9KQorCSAqLworCXB1Ymxp
YyBzdGF0aWMgTGlzdCBwcm9wZXJ0eURlc2NyaXB0b3JzKGludCBhcGlMZXZlbCkgeworCQlyZXR1
cm4gUFJPUEVSVFlfREVTQ1JJUFRPUlM7CisJfQorCisJLyoqCisJICogVGhlIHF1YWxpZmllciBu
b2RlOyBsYXppbHkgaW5pdGlhbGl6ZWQ7IGRlZmF1bHRzIHRvIAorCSAqIGFuIHVuc3BlY2lmaWVk
LCBidXQgbGVnYWwsIHNpbXBsZSBuYW1lLgorCSAqLworCXByaXZhdGUgTmFtZSBxdWFsaWZpZXIg
PSBudWxsOworCisJLyoqCisJICogVGhlIG5hbWUgYmVpbmcgcXVhbGlmaWVkOyBsYXppbHkgaW5p
dGlhbGl6ZWQ7IGRlZmF1bHRzIHRvIGEgdW5zcGVjaWZpZWQsCisJICogbGVnYWwgSmF2YSBpZGVu
dGlmaWVyLgorCSAqLworCXByaXZhdGUgU2ltcGxlTmFtZSBuYW1lID0gbnVsbDsKKworCS8qKgor
CSAqIENyZWF0ZXMgYSBuZXcgdW5wYXJlbnRlZCBub2RlIGZvciBhIHBhY2thZ2UgcXVhbGlmaWVk
IHR5cGUgb3duZWQgYnkgdGhlCisJICogZ2l2ZW4gQVNULiBCeSBkZWZhdWx0LCBhbiB1bnNwZWNp
ZmllZCwgYnV0IGxlZ2FsLCBxdWFsaWZpZXIgYW5kIG5hbWUuCisJICogPHA+CisJICogTi5CLiBU
aGlzIGNvbnN0cnVjdG9yIGlzIHBhY2thZ2UtcHJpdmF0ZS4KKwkgKiA8L3A+CisJICoKKwkgKiBA
cGFyYW0gYXN0IHRoZSBBU1QgdGhhdCBpcyB0byBvd24gdGhpcyBub2RlCisJICovCisJUGFja2Fn
ZVF1YWxpZmllZFR5cGUoQVNUIGFzdCkgeworCQlzdXBlcihhc3QpOworCSAgICB1bnN1cHBvcnRl
ZEluMl8zXzQoKTsKKwl9CisKKwkvKiAob21pdCBqYXZhZG9jIGZvciB0aGlzIG1ldGhvZCkKKwkg
KiBNZXRob2QgZGVjbGFyZWQgb24gQW5ub3RhdGFibGVUeXBlLgorCSAqLworCUNoaWxkTGlzdFBy
b3BlcnR5RGVzY3JpcHRvciBpbnRlcm5hbEFubm90YXRpb25zUHJvcGVydHkoKSB7CisJCXJldHVy
biBBTk5PVEFUSU9OU19QUk9QRVJUWTsKKwl9CisKKwkvKiAob21pdCBqYXZhZG9jIGZvciB0aGlz
IG1ldGhvZCkKKwkgKiBNZXRob2QgZGVjbGFyZWQgb24gQVNUTm9kZS4KKwkgKi8KKwlMaXN0IGlu
dGVybmFsU3RydWN0dXJhbFByb3BlcnRpZXNGb3JUeXBlKGludCBhcGlMZXZlbCkgeworCQlyZXR1
cm4gcHJvcGVydHlEZXNjcmlwdG9ycyhhcGlMZXZlbCk7CisJfQorCisJLyogKG9taXQgamF2YWRv
YyBmb3IgdGhpcyBtZXRob2QpCisJICogTWV0aG9kIGRlY2xhcmVkIG9uIEFTVE5vZGUuCisJICov
CisJZmluYWwgTGlzdCBpbnRlcm5hbEdldENoaWxkTGlzdFByb3BlcnR5KENoaWxkTGlzdFByb3Bl
cnR5RGVzY3JpcHRvciBwcm9wZXJ0eSkgeworCQlpZiAocHJvcGVydHkgPT0gQU5OT1RBVElPTlNf
UFJPUEVSVFkpIHsKKwkJCXJldHVybiBhbm5vdGF0aW9ucygpOworCQl9CisJCS8vIGFsbG93IGRl
ZmF1bHQgaW1wbGVtZW50YXRpb24gdG8gZmxhZyB0aGUgZXJyb3IKKwkJcmV0dXJuIHN1cGVyLmlu
dGVybmFsR2V0Q2hpbGRMaXN0UHJvcGVydHkocHJvcGVydHkpOworCX0KKwkKKwkvKiAob21pdCBq
YXZhZG9jIGZvciB0aGlzIG1ldGhvZCkKKwkgKiBNZXRob2QgZGVjbGFyZWQgb24gQVNUTm9kZS4K
KwkgKi8KKwlmaW5hbCBBU1ROb2RlIGludGVybmFsR2V0U2V0Q2hpbGRQcm9wZXJ0eShDaGlsZFBy
b3BlcnR5RGVzY3JpcHRvciBwcm9wZXJ0eSwgYm9vbGVhbiBnZXQsIEFTVE5vZGUgY2hpbGQpIHsK
KwkJaWYgKHByb3BlcnR5ID09IFFVQUxJRklFUl9QUk9QRVJUWSkgeworCQkJaWYgKGdldCkgewor
CQkJCXJldHVybiBnZXRRdWFsaWZpZXIoKTsKKwkJCX0gZWxzZSB7CisJCQkJc2V0UXVhbGlmaWVy
KChOYW1lKSBjaGlsZCk7CisJCQkJcmV0dXJuIG51bGw7CisJCQl9CisJCX0KKwkJaWYgKHByb3Bl
cnR5ID09IE5BTUVfUFJPUEVSVFkpIHsKKwkJCWlmIChnZXQpIHsKKwkJCQlyZXR1cm4gZ2V0TmFt
ZSgpOworCQkJfSBlbHNlIHsKKwkJCQlzZXROYW1lKChTaW1wbGVOYW1lKSBjaGlsZCk7CisJCQkJ
cmV0dXJuIG51bGw7CisJCQl9CisJCX0KKwkJLy8gYWxsb3cgZGVmYXVsdCBpbXBsZW1lbnRhdGlv
biB0byBmbGFnIHRoZSBlcnJvcgorCQlyZXR1cm4gc3VwZXIuaW50ZXJuYWxHZXRTZXRDaGlsZFBy
b3BlcnR5KHByb3BlcnR5LCBnZXQsIGNoaWxkKTsKKwl9CisKKwlpbnQgZ2V0Tm9kZVR5cGUwKCkg
eworCQlyZXR1cm4gUEFDS0FHRV9RVUFMSUZJRURfVFlQRTsKKwl9CisKKwlib29sZWFuIHN1YnRy
ZWVNYXRjaDAoQVNUTWF0Y2hlciBtYXRjaGVyLCBPYmplY3Qgb3RoZXIpIHsKKwkJLy8gZGlzcGF0
Y2ggdG8gY29ycmVjdCBvdmVybG9hZGVkIG1hdGNoIG1ldGhvZAorCQlyZXR1cm4gbWF0Y2hlci5t
YXRjaCh0aGlzLCBvdGhlcik7CisJfQorCisJQVNUTm9kZSBjbG9uZTAoQVNUIHRhcmdldCkgewor
CQlQYWNrYWdlUXVhbGlmaWVkVHlwZSByZXN1bHQgPSBuZXcgUGFja2FnZVF1YWxpZmllZFR5cGUo
dGFyZ2V0KTsKKwkJcmVzdWx0LnNldFNvdXJjZVJhbmdlKGdldFN0YXJ0UG9zaXRpb24oKSwgZ2V0
TGVuZ3RoKCkpOworCQlyZXN1bHQuc2V0UXVhbGlmaWVyKChOYW1lKSAoKEFTVE5vZGUpIGdldFF1
YWxpZmllcigpKS5jbG9uZSh0YXJnZXQpKTsKKwkJcmVzdWx0LmFubm90YXRpb25zKCkuYWRkQWxs
KEFTVE5vZGUuY29weVN1YnRyZWVzKHRhcmdldCwgYW5ub3RhdGlvbnMoKSkpOworCQlyZXN1bHQu
c2V0TmFtZSgoU2ltcGxlTmFtZSkgKChBU1ROb2RlKSBnZXROYW1lKCkpLmNsb25lKHRhcmdldCkp
OworCQlyZXR1cm4gcmVzdWx0OworCX0KKworCS8qIChvbWl0IGphdmFkb2MgZm9yIHRoaXMgbWV0
aG9kKQorCSAqIE1ldGhvZCBkZWNsYXJlZCBvbiBBU1ROb2RlLgorCSAqLworCXZvaWQgYWNjZXB0
MChBU1RWaXNpdG9yIHZpc2l0b3IpIHsKKwkJYm9vbGVhbiB2aXNpdENoaWxkcmVuID0gdmlzaXRv
ci52aXNpdCh0aGlzKTsKKwkJaWYgKHZpc2l0Q2hpbGRyZW4pIHsKKwkJCS8vIHZpc2l0IGNoaWxk
cmVuIGluIG5vcm1hbCBsZWZ0IHRvIHJpZ2h0IHJlYWRpbmcgb3JkZXIKKwkJCWFjY2VwdENoaWxk
KHZpc2l0b3IsIGdldFF1YWxpZmllcigpKTsKKwkJCWFjY2VwdENoaWxkcmVuKHZpc2l0b3IsIHRo
aXMuYW5ub3RhdGlvbnMpOworCQkJYWNjZXB0Q2hpbGQodmlzaXRvciwgZ2V0TmFtZSgpKTsKKwkJ
fQorCQl2aXNpdG9yLmVuZFZpc2l0KHRoaXMpOworCX0KKworCS8qKgorCSAqIFJldHVybnMgdGhl
IHF1YWxpZmllciBvZiB0aGlzIHBhY2thZ2UgcXVhbGlmaWVkIHR5cGUuCisJICoKKwkgKiBAcmV0
dXJuIHRoZSBxdWFsaWZpZXIgb2YgdGhpcyBwYWNrYWdlIHF1YWxpZmllZCB0eXBlCisJICovCisJ
cHVibGljIE5hbWUgZ2V0UXVhbGlmaWVyKCkgeworCQlpZiAodGhpcy5xdWFsaWZpZXIgPT0gbnVs
bCkgeworCQkJLy8gbGF6eSBpbml0IG11c3QgYmUgdGhyZWFkLXNhZmUgZm9yIHJlYWRlcnMKKwkJ
CXN5bmNocm9uaXplZCAodGhpcykgeworCQkJCWlmICh0aGlzLnF1YWxpZmllciA9PSBudWxsKSB7
CisJCQkJCXByZUxhenlJbml0KCk7CisJCQkJCXRoaXMucXVhbGlmaWVyID0gbmV3IFNpbXBsZU5h
bWUodGhpcy5hc3QpOworCQkJCQlwb3N0TGF6eUluaXQodGhpcy5xdWFsaWZpZXIsIFFVQUxJRklF
Ul9QUk9QRVJUWSk7CisJCQkJfQorCQkJfQorCQl9CisJCXJldHVybiB0aGlzLnF1YWxpZmllcjsK
Kwl9CisKKwkvKioKKwkgKiBTZXRzIHRoZSBxdWFsaWZpZXIgb2YgdGhpcyBwYWNrYWdlIHF1YWxp
ZmllZCB0eXBlIHRvIHRoZSBnaXZlbiBuYW1lLgorCSAqCisJICogQHBhcmFtIG5hbWUgdGhlIG5l
dyBxdWFsaWZpZXIgb2YgdGhpcyBxdWFsaWZpZWQgdHlwZQorCSAqIEBleGNlcHRpb24gSWxsZWdh
bEFyZ3VtZW50RXhjZXB0aW9uIGlmOgorCSAqIDx1bD4KKwkgKiA8bGk+dGhlIG5vZGUgYmVsb25n
cyB0byBhIGRpZmZlcmVudCBBU1Q8L2xpPgorCSAqIDxsaT50aGUgbm9kZSBhbHJlYWR5IGhhcyBh
IHBhcmVudDwvbGk+CisJICogPC91bD4KKwkgKi8KKwlwdWJsaWMgdm9pZCBzZXRRdWFsaWZpZXIo
TmFtZSBuYW1lKSB7CisJCWlmIChuYW1lID09IG51bGwpIHsKKwkJCXRocm93IG5ldyBJbGxlZ2Fs
QXJndW1lbnRFeGNlcHRpb24oKTsKKwkJfQorCQlBU1ROb2RlIG9sZENoaWxkID0gdGhpcy5xdWFs
aWZpZXI7CisJCXByZVJlcGxhY2VDaGlsZChvbGRDaGlsZCwgbmFtZSwgUVVBTElGSUVSX1BST1BF
UlRZKTsKKwkJdGhpcy5xdWFsaWZpZXIgPSBuYW1lOworCQlwb3N0UmVwbGFjZUNoaWxkKG9sZENo
aWxkLCBuYW1lLCBRVUFMSUZJRVJfUFJPUEVSVFkpOworCX0KKworCS8qKgorCSAqIFJldHVybnMg
dGhlIG5hbWUgcGFydCBvZiB0aGlzIHF1YWxpZmllZCB0eXBlLgorCSAqCisJICogQHJldHVybiB0
aGUgbmFtZSBiZWluZyBxdWFsaWZpZWQKKwkgKi8KKwlwdWJsaWMgU2ltcGxlTmFtZSBnZXROYW1l
KCkgeworCQlpZiAodGhpcy5uYW1lID09IG51bGwpIHsKKwkJCS8vIGxhenkgaW5pdCBtdXN0IGJl
IHRocmVhZC1zYWZlIGZvciByZWFkZXJzCisJCQlzeW5jaHJvbml6ZWQgKHRoaXMpIHsKKwkJCQlp
ZiAodGhpcy5uYW1lID09IG51bGwpIHsKKwkJCQkJcHJlTGF6eUluaXQoKTsKKwkJCQkJdGhpcy5u
YW1lID0gbmV3IFNpbXBsZU5hbWUodGhpcy5hc3QpOworCQkJCQlwb3N0TGF6eUluaXQodGhpcy5u
YW1lLCBOQU1FX1BST1BFUlRZKTsKKwkJCQl9CisJCQl9CisJCX0KKwkJcmV0dXJuIHRoaXMubmFt
ZTsKKwl9CisKKwkvKioKKwkgKiBTZXRzIHRoZSBuYW1lIHBhcnQgb2YgdGhpcyBwYWNrYWdlIHF1
YWxpZmllZCB0eXBlIHRvIHRoZSBnaXZlbiBzaW1wbGUgbmFtZS4KKwkgKgorCSAqIEBwYXJhbSBu
YW1lIHRoZSBpZGVudGlmaWVyIG9mIHRoaXMgcXVhbGlmaWVkIG5hbWUKKwkgKiBAZXhjZXB0aW9u
IElsbGVnYWxBcmd1bWVudEV4Y2VwdGlvbiBpZjoKKwkgKiA8dWw+CisJICogPGxpPnRoZSBub2Rl
IGJlbG9uZ3MgdG8gYSBkaWZmZXJlbnQgQVNUPC9saT4KKwkgKiA8bGk+dGhlIG5vZGUgYWxyZWFk
eSBoYXMgYSBwYXJlbnQ8L2xpPgorCSAqIDwvdWw+CisJICovCisJcHVibGljIHZvaWQgc2V0TmFt
ZShTaW1wbGVOYW1lIG5hbWUpIHsKKwkJaWYgKG5hbWUgPT0gbnVsbCkgeworCQkJdGhyb3cgbmV3
IElsbGVnYWxBcmd1bWVudEV4Y2VwdGlvbigpOworCQl9CisJCUFTVE5vZGUgb2xkQ2hpbGQgPSB0
aGlzLm5hbWU7CisJCXByZVJlcGxhY2VDaGlsZChvbGRDaGlsZCwgbmFtZSwgTkFNRV9QUk9QRVJU
WSk7CisJCXRoaXMubmFtZSA9IG5hbWU7CisJCXBvc3RSZXBsYWNlQ2hpbGQob2xkQ2hpbGQsIG5h
bWUsIE5BTUVfUFJPUEVSVFkpOworCX0KKworCS8qIChvbWl0IGphdmFkb2MgZm9yIHRoaXMgbWV0
aG9kKQorCSAqIE1ldGhvZCBkZWNsYXJlZCBvbiBBU1ROb2RlLgorCSAqLworCWludCBtZW1TaXpl
KCkgeworCQkvLyB0cmVhdCBDb2RlIGFzIGZyZWUKKwkJcmV0dXJuIEJBU0VfTk9ERV9TSVpFICsg
MiAqIDQ7CisJfQorCisJLyogKG9taXQgamF2YWRvYyBmb3IgdGhpcyBtZXRob2QpCisJICogTWV0
aG9kIGRlY2xhcmVkIG9uIEFTVE5vZGUuCisJICovCisJaW50IHRyZWVTaXplKCkgeworCQlyZXR1
cm4KKwkJCW1lbVNpemUoKQorCQkJKyAodGhpcy5xdWFsaWZpZXIgPT0gbnVsbCA/IDAgOiBnZXRR
dWFsaWZpZXIoKS50cmVlU2l6ZSgpKQorCQkJKyAodGhpcy5hbm5vdGF0aW9ucyA9PSBudWxsID8g
MCA6IHRoaXMuYW5ub3RhdGlvbnMubGlzdFNpemUoKSkKKwkJCSsgKHRoaXMubmFtZSA9PSBudWxs
ID8gMCA6IGdldE5hbWUoKS50cmVlU2l6ZSgpKTsKKwl9CisKK30KZGlmZiAtLWdpdCBhL29yZy5l
Y2xpcHNlLmpkdC5jb3JlL2RvbS9vcmcvZWNsaXBzZS9qZHQvaW50ZXJuYWwvY29yZS9kb20vTmFp
dmVBU1RGbGF0dGVuZXIuamF2YSBiL29yZy5lY2xpcHNlLmpkdC5jb3JlL2RvbS9vcmcvZWNsaXBz
ZS9qZHQvaW50ZXJuYWwvY29yZS9kb20vTmFpdmVBU1RGbGF0dGVuZXIuamF2YQppbmRleCA3ODgx
YzcyLi42MWM3MzIzIDEwMDY0NAotLS0gYS9vcmcuZWNsaXBzZS5qZHQuY29yZS9kb20vb3JnL2Vj
bGlwc2UvamR0L2ludGVybmFsL2NvcmUvZG9tL05haXZlQVNURmxhdHRlbmVyLmphdmEKKysrIGIv
b3JnLmVjbGlwc2UuamR0LmNvcmUvZG9tL29yZy9lY2xpcHNlL2pkdC9pbnRlcm5hbC9jb3JlL2Rv
bS9OYWl2ZUFTVEZsYXR0ZW5lci5qYXZhCkBAIC0xMTczLDYgKzExNzMsMTggQEAKIAl9CiAKIAkv
KgorCSAqIEBzZWUgQVNUVmlzaXRvciN2aXNpdChQYWNrYWdlUXVhbGlmaWVkVHlwZSkKKwkgKiBA
c2luY2UgMy45CisJICovCisJcHVibGljIGJvb2xlYW4gdmlzaXQoUGFja2FnZVF1YWxpZmllZFR5
cGUgbm9kZSkgeworCQlub2RlLmdldFF1YWxpZmllcigpLmFjY2VwdCh0aGlzKTsKKwkJdGhpcy5i
dWZmZXIuYXBwZW5kKCcuJyk7CisJCXZpc2l0VHlwZUFubm90YXRpb25zKG5vZGUpOworCQlub2Rl
LmdldE5hbWUoKS5hY2NlcHQodGhpcyk7CisJCXJldHVybiBmYWxzZTsKKwl9CisKKwkvKgogCSAq
IEBzZWUgQVNUVmlzaXRvciN2aXNpdChQYXJhbWV0ZXJpemVkVHlwZSkKIAkgKiBAc2luY2UgMy4x
CiAJICov
</data>

          </attachment>
          <attachment
              isobsolete="1"
              ispatch="1"
              isprivate="0"
          >
            <attachid>229520</attachid>
            <date>2013-04-09 12:37:00 -0400</date>
            <delta_ts>2013-04-17 05:10:42 -0400</delta_ts>
            <desc>Proposed Patch - WIP</desc>
            <filename>Fix-for-Bug-404489-18dom-ast-Incorrect-conversion-of.patch</filename>
            <type>text/plain</type>
            <size>44857</size>
            <attacher name="Manoj Palat Away Until May 11 2015">manpalat</attacher>
            
              <data encoding="base64">ZGlmZiAtLWdpdCBhL29yZy5lY2xpcHNlLmpkdC5jb3JlLnRlc3RzLm1vZGVsL3NyYy9vcmcvZWNs
aXBzZS9qZHQvY29yZS90ZXN0cy9kb20vQVNUQ29udmVydGVyMThUZXN0LmphdmEgYi9vcmcuZWNs
aXBzZS5qZHQuY29yZS50ZXN0cy5tb2RlbC9zcmMvb3JnL2VjbGlwc2UvamR0L2NvcmUvdGVzdHMv
ZG9tL0FTVENvbnZlcnRlcjE4VGVzdC5qYXZhCmluZGV4IDE0MGI1NmIuLmYyYzczM2IgMTAwNjQ0
Ci0tLSBhL29yZy5lY2xpcHNlLmpkdC5jb3JlLnRlc3RzLm1vZGVsL3NyYy9vcmcvZWNsaXBzZS9q
ZHQvY29yZS90ZXN0cy9kb20vQVNUQ29udmVydGVyMThUZXN0LmphdmEKKysrIGIvb3JnLmVjbGlw
c2UuamR0LmNvcmUudGVzdHMubW9kZWwvc3JjL29yZy9lY2xpcHNlL2pkdC9jb3JlL3Rlc3RzL2Rv
bS9BU1RDb252ZXJ0ZXIxOFRlc3QuamF2YQpAQCAtMTQ5LDEwICsxNDksMTAgQEAKIAkJYXNzZXJ0
Tm90TnVsbChhc3NpZ25tZW50KTsKIAkJQ2FzdEV4cHJlc3Npb24gY2FzdEV4cHJlc3Npb24gPSAo
Q2FzdEV4cHJlc3Npb24pIGFzc2lnbm1lbnQuZ2V0UmlnaHRIYW5kU2lkZSgpOwogCQlhc3NlcnRO
b3ROdWxsKGNhc3RFeHByZXNzaW9uKTsKLQkJU2ltcGxlVHlwZSBzaW1wbGVUeXBlID0gKFNpbXBs
ZVR5cGUpIGNhc3RFeHByZXNzaW9uLmdldFR5cGUoKTsKLQkJYXNzZXJ0Tm90TnVsbChzaW1wbGVU
eXBlKTsKLQkJYXNzZXJ0RXF1YWxzKCJqYXZhLmxhbmcuQE1hcmtlciBTdHJpbmciLCBzaW1wbGVU
eXBlLnRvU3RyaW5nKCkpOwotCQlMaXN0IGFubm90YXRpb25zID0gc2ltcGxlVHlwZS5hbm5vdGF0
aW9ucygpOworCQlQYWNrYWdlUXVhbGlmaWVkVHlwZSBwYWNrYWdlUXVhbGlmaWVkVHlwZSA9IChQ
YWNrYWdlUXVhbGlmaWVkVHlwZSkgY2FzdEV4cHJlc3Npb24uZ2V0VHlwZSgpOworCQlhc3NlcnRO
b3ROdWxsKHBhY2thZ2VRdWFsaWZpZWRUeXBlKTsKKwkJYXNzZXJ0RXF1YWxzKCJqYXZhLmxhbmcu
QE1hcmtlciBTdHJpbmciLCBwYWNrYWdlUXVhbGlmaWVkVHlwZS50b1N0cmluZygpKTsKKwkJTGlz
dCBhbm5vdGF0aW9ucyA9IHBhY2thZ2VRdWFsaWZpZWRUeXBlLmFubm90YXRpb25zKCk7CiAJCWFz
c2VydFRydWUoYW5ub3RhdGlvbnMuc2l6ZSgpID09IDEpOwogCQlhc3NlcnRFcXVhbHMoIkBNYXJr
ZXIiLCBhbm5vdGF0aW9ucy5nZXQoMCkudG9TdHJpbmcoKSk7CiAKQEAgLTE2MCw3ICsxNjAsNyBA
QAogCQlWYXJpYWJsZURlY2xhcmF0aW9uU3RhdGVtZW50IHZhcmlhYmxlRGVjbGFyYXRpb25TdGF0
ZW1lbnQgPSAoVmFyaWFibGVEZWNsYXJhdGlvblN0YXRlbWVudCkgc3RhdGVtZW50cy5nZXQoc0Nv
dW50KyspOwogCQlUeXBlIHR5cGUgPSB2YXJpYWJsZURlY2xhcmF0aW9uU3RhdGVtZW50LmdldFR5
cGUoKTsKIAkJYXNzZXJ0VHJ1ZSh0eXBlLmlzU2ltcGxlVHlwZSgpKTsKLQkJc2ltcGxlVHlwZSA9
IChTaW1wbGVUeXBlKSB0eXBlOworCQlTaW1wbGVUeXBlIHNpbXBsZVR5cGUgPSAoU2ltcGxlVHlw
ZSkgdHlwZTsKIAkJYXNzZXJ0RXF1YWxzKCJPdXRlci5Jbm5lciIsIHNpbXBsZVR5cGUudG9TdHJp
bmcoKSk7CiAJCWFubm90YXRpb25zID0gc2ltcGxlVHlwZS5hbm5vdGF0aW9ucygpOwogCQlhc3Nl
cnRUcnVlKGFubm90YXRpb25zLnNpemUoKSA9PSAwKTsKQEAgLTE2OSwyMiArMTY5LDIyIEBACiAJ
CS8vIGFubm90YXRpb25zLgogCQl2YXJpYWJsZURlY2xhcmF0aW9uU3RhdGVtZW50ID0gKFZhcmlh
YmxlRGVjbGFyYXRpb25TdGF0ZW1lbnQpIHN0YXRlbWVudHMuZ2V0KHNDb3VudCsrKTsKIAkJdHlw
ZSA9IHZhcmlhYmxlRGVjbGFyYXRpb25TdGF0ZW1lbnQuZ2V0VHlwZSgpOwotCQlhc3NlcnRUcnVl
KHR5cGUuaXNTaW1wbGVUeXBlKCkpOwotCQlzaW1wbGVUeXBlID0gKFNpbXBsZVR5cGUpIHR5cGU7
Ci0JCWFzc2VydE5vdE51bGwoc2ltcGxlVHlwZSk7Ci0JCWFzc2VydEVxdWFscygiT3V0ZXIuQE1h
cmtlcjIgSW5uZXIiLCBzaW1wbGVUeXBlLnRvU3RyaW5nKCkpOwotCQlhbm5vdGF0aW9ucyA9IHNp
bXBsZVR5cGUuYW5ub3RhdGlvbnMoKTsKKwkJYXNzZXJ0VHJ1ZSh0eXBlLmlzUXVhbGlmaWVkVHlw
ZSgpKTsKKwkJUXVhbGlmaWVkVHlwZSBxdWFsaWZpZWRUeXBlID0gKFF1YWxpZmllZFR5cGUpIHR5
cGU7CisJCWFzc2VydE5vdE51bGwocXVhbGlmaWVkVHlwZSk7CisJCWFzc2VydEVxdWFscygiT3V0
ZXIuQE1hcmtlcjIgSW5uZXIiLCBxdWFsaWZpZWRUeXBlLnRvU3RyaW5nKCkpOworCQlhbm5vdGF0
aW9ucyA9IHF1YWxpZmllZFR5cGUuYW5ub3RhdGlvbnMoKTsKIAkJYXNzZXJ0VHJ1ZShhbm5vdGF0
aW9ucy5zaXplKCkgPT0gMSk7CiAJCWFzc2VydEVxdWFscygiQE1hcmtlcjIiLCBhbm5vdGF0aW9u
cy5nZXQoMCkudG9TdHJpbmcoKSk7CiAKIAkJLy8gY2FzZSA0IC0gTXVsdGlwbGUgbGV2ZWxzIHdp
dGggYW5ub3RhdGlvbnMgYXQgdGhlIGxhc3Qgb25seS4KIAkJdmFyaWFibGVEZWNsYXJhdGlvblN0
YXRlbWVudCA9IChWYXJpYWJsZURlY2xhcmF0aW9uU3RhdGVtZW50KSBzdGF0ZW1lbnRzLmdldChz
Q291bnQrKyk7CiAJCXR5cGUgPSB2YXJpYWJsZURlY2xhcmF0aW9uU3RhdGVtZW50LmdldFR5cGUo
KTsKLQkJYXNzZXJ0VHJ1ZSh0eXBlLmlzU2ltcGxlVHlwZSgpKTsKLQkJc2ltcGxlVHlwZSA9IChT
aW1wbGVUeXBlKSB0eXBlOwotCQlhc3NlcnROb3ROdWxsKHNpbXBsZVR5cGUpOwotCQlhc3NlcnRF
cXVhbHMoIk91dGVyLklubmVyLkBNYXJrZXIxIERlZXBlciIsIHNpbXBsZVR5cGUudG9TdHJpbmco
KSk7Ci0JCWFubm90YXRpb25zID0gc2ltcGxlVHlwZS5hbm5vdGF0aW9ucygpOworCQlhc3NlcnRU
cnVlKHR5cGUuaXNRdWFsaWZpZWRUeXBlKCkpOworCQlxdWFsaWZpZWRUeXBlID0gKFF1YWxpZmll
ZFR5cGUpIHR5cGU7CisJCWFzc2VydE5vdE51bGwocXVhbGlmaWVkVHlwZSk7CisJCWFzc2VydEVx
dWFscygiT3V0ZXIuSW5uZXIuQE1hcmtlcjEgRGVlcGVyIiwgcXVhbGlmaWVkVHlwZS50b1N0cmlu
ZygpKTsKKwkJYW5ub3RhdGlvbnMgPSBxdWFsaWZpZWRUeXBlLmFubm90YXRpb25zKCk7CiAJCWFz
c2VydFRydWUoYW5ub3RhdGlvbnMuc2l6ZSgpID09IDEpOwogCQlhc3NlcnRFcXVhbHMoIkBNYXJr
ZXIxIiwgYW5ub3RhdGlvbnMuZ2V0KDApLnRvU3RyaW5nKCkpOwogCkBAIC0xOTIsNyArMTkyLDcg
QEAKIAkJdmFyaWFibGVEZWNsYXJhdGlvblN0YXRlbWVudCA9IChWYXJpYWJsZURlY2xhcmF0aW9u
U3RhdGVtZW50KSBzdGF0ZW1lbnRzLmdldChzQ291bnQrKyk7CiAJCXR5cGUgPSB2YXJpYWJsZURl
Y2xhcmF0aW9uU3RhdGVtZW50LmdldFR5cGUoKTsKIAkJYXNzZXJ0VHJ1ZSh0eXBlLmlzUXVhbGlm
aWVkVHlwZSgpKTsKLQkJUXVhbGlmaWVkVHlwZSBxdWFsaWZpZWRUeXBlID0gKFF1YWxpZmllZFR5
cGUpIHR5cGU7CisJCXF1YWxpZmllZFR5cGUgPSAoUXVhbGlmaWVkVHlwZSkgdHlwZTsKIAkJYXNz
ZXJ0Tm90TnVsbChxdWFsaWZpZWRUeXBlKTsKIAkJYXNzZXJ0RXF1YWxzKCJPdXRlci5ATWFya2Vy
MSBJbm5lci5ATWFya2VyMiBEZWVwZXIiLCBxdWFsaWZpZWRUeXBlLnRvU3RyaW5nKCkpOwogCQlh
bm5vdGF0aW9ucyA9IHF1YWxpZmllZFR5cGUuYW5ub3RhdGlvbnMoKTsKQEAgLTIwMSwxMCArMjAx
LDEwIEBACiAJCVNpbXBsZU5hbWUgc2ltcGxlTmFtZSA9IHF1YWxpZmllZFR5cGUuZ2V0TmFtZSgp
OwogCQlhc3NlcnRFcXVhbHMoIkRlZXBlciIsIHNpbXBsZU5hbWUudG9TdHJpbmcoKSk7CiAJCVR5
cGUgcXVhbGlmaWVyVHlwZSA9IHF1YWxpZmllZFR5cGUuZ2V0UXVhbGlmaWVyKCk7Ci0JCWFzc2Vy
dFRydWUocXVhbGlmaWVyVHlwZS5pc1NpbXBsZVR5cGUoKSk7Ci0JCXNpbXBsZVR5cGUgPSAoU2lt
cGxlVHlwZSkgcXVhbGlmaWVyVHlwZTsKLQkJYXNzZXJ0RXF1YWxzKCJPdXRlci5ATWFya2VyMSBJ
bm5lciIsIHNpbXBsZVR5cGUudG9TdHJpbmcoKSk7Ci0JCWFubm90YXRpb25zID0gc2ltcGxlVHlw
ZS5hbm5vdGF0aW9ucygpOworCQlhc3NlcnRUcnVlKHF1YWxpZmllclR5cGUuaXNRdWFsaWZpZWRU
eXBlKCkpOworCQlxdWFsaWZpZWRUeXBlID0gKFF1YWxpZmllZFR5cGUpIHF1YWxpZmllclR5cGU7
CisJCWFzc2VydEVxdWFscygiT3V0ZXIuQE1hcmtlcjEgSW5uZXIiLCBxdWFsaWZpZWRUeXBlLnRv
U3RyaW5nKCkpOworCQlhbm5vdGF0aW9ucyA9IHF1YWxpZmllZFR5cGUuYW5ub3RhdGlvbnMoKTsK
IAkJYXNzZXJ0VHJ1ZShhbm5vdGF0aW9ucy5zaXplKCkgPT0gMSk7CiAJCWFzc2VydEVxdWFscygi
QE1hcmtlcjEiLCBhbm5vdGF0aW9ucy5nZXQoMCkudG9TdHJpbmcoKSk7CiAJfQpAQCAtMzQyLDEw
ICszNDIsMTAgQEAKIAkJdHlwZUFyZ3VtZW50cyA9IHBhcmFtZXRyaXplZFR5cGUudHlwZUFyZ3Vt
ZW50cygpOwogCQlhc3NlcnRFcXVhbHMoMSwgdHlwZUFyZ3VtZW50cy5zaXplKCkpOwogCQl0eXBl
ID0gKFR5cGUpIHR5cGVBcmd1bWVudHMuZ2V0KDApOwotCQlhc3NlcnRUcnVlKHR5cGUuaXNTaW1w
bGVUeXBlKCkpOwotCQlTaW1wbGVUeXBlIHNpbXBsZVR5cGUgPSAoU2ltcGxlVHlwZSkgdHlwZTsK
LQkJYXNzZXJ0RXF1YWxzKCJPdXRlci5ATWFya2VyMSBJbm5lciIsIHNpbXBsZVR5cGUudG9TdHJp
bmcoKSk7Ci0JCUxpc3QgYW5ub3RhdGlvbnMgPSBzaW1wbGVUeXBlLmFubm90YXRpb25zKCk7CisJ
CWFzc2VydFRydWUodHlwZS5pc1F1YWxpZmllZFR5cGUoKSk7CisJCVF1YWxpZmllZFR5cGUgcXVh
bGlmaWVkVHlwZSA9IChRdWFsaWZpZWRUeXBlKSB0eXBlOworCQlhc3NlcnRFcXVhbHMoIk91dGVy
LkBNYXJrZXIxIElubmVyIiwgcXVhbGlmaWVkVHlwZS50b1N0cmluZygpKTsKKwkJTGlzdCBhbm5v
dGF0aW9ucyA9IHF1YWxpZmllZFR5cGUuYW5ub3RhdGlvbnMoKTsKIAkJYXNzZXJ0VHJ1ZShhbm5v
dGF0aW9ucy5zaXplKCkgPT0gMSk7CiAJCUFubm90YXRpb24gYW5ub3RhdGlvbiA9IChBbm5vdGF0
aW9uKSBhbm5vdGF0aW9ucy5nZXQoMCk7CiAJCWFzc2VydEVxdWFscygiQE1hcmtlcjEiLCBhbm5v
dGF0aW9uLnRvU3RyaW5nKCkpOwpAQCAtMzU5LDEzICszNTksMTMgQEAKIAkJdHlwZSA9IChUeXBl
KSB0eXBlQXJndW1lbnRzLmdldCgwKTsKIAkJYXNzZXJ0VHJ1ZSh0eXBlLmlzUXVhbGlmaWVkVHlw
ZSgpKTsKIAkJYXNzZXJ0RXF1YWxzKCJATWFya2VyMSBPdXRlci5Jbm5lciIsIHR5cGUudG9TdHJp
bmcoKSk7Ci0JCVF1YWxpZmllZFR5cGUgcXVhbGlmaWVkVHlwZSA9IChRdWFsaWZpZWRUeXBlKSB0
eXBlOworCQlxdWFsaWZpZWRUeXBlID0gKFF1YWxpZmllZFR5cGUpIHR5cGU7CiAJCWFzc2VydEVx
dWFscygiSW5uZXIiLCBxdWFsaWZpZWRUeXBlLmdldE5hbWUoKS50b1N0cmluZygpKTsKIAkJYW5u
b3RhdGlvbnMgPSBxdWFsaWZpZWRUeXBlLmFubm90YXRpb25zKCk7CiAJCWFzc2VydFRydWUoYW5u
b3RhdGlvbnMuc2l6ZSgpID09IDApOwogCQlUeXBlIHF1YWxpZmllclR5cGUgPSBxdWFsaWZpZWRU
eXBlLmdldFF1YWxpZmllcigpOwogCQlhc3NlcnRUcnVlKHF1YWxpZmllclR5cGUuaXNTaW1wbGVU
eXBlKCkpOwotCQlzaW1wbGVUeXBlID0gKFNpbXBsZVR5cGUpIHF1YWxpZmllclR5cGU7CisJCVNp
bXBsZVR5cGUgc2ltcGxlVHlwZSA9IChTaW1wbGVUeXBlKSBxdWFsaWZpZXJUeXBlOwogCQlhc3Nl
cnRFcXVhbHMoIkBNYXJrZXIxIE91dGVyIiwgc2ltcGxlVHlwZS50b1N0cmluZygpKTsKIAkJYW5u
b3RhdGlvbnMgPSBzaW1wbGVUeXBlLmFubm90YXRpb25zKCk7CiAJCWFzc2VydFRydWUoYW5ub3Rh
dGlvbnMuc2l6ZSgpID09IDEpOwpkaWZmIC0tZ2l0IGEvb3JnLmVjbGlwc2UuamR0LmNvcmUudGVz
dHMubW9kZWwvc3JjL29yZy9lY2xpcHNlL2pkdC9jb3JlL3Rlc3RzL2RvbS9BU1RTdHJ1Y3R1cmFs
UHJvcGVydHlUZXN0LmphdmEgYi9vcmcuZWNsaXBzZS5qZHQuY29yZS50ZXN0cy5tb2RlbC9zcmMv
b3JnL2VjbGlwc2UvamR0L2NvcmUvdGVzdHMvZG9tL0FTVFN0cnVjdHVyYWxQcm9wZXJ0eVRlc3Qu
amF2YQppbmRleCBlM2MxY2IxLi40MzMzNjQ3IDEwMDY0NAotLS0gYS9vcmcuZWNsaXBzZS5qZHQu
Y29yZS50ZXN0cy5tb2RlbC9zcmMvb3JnL2VjbGlwc2UvamR0L2NvcmUvdGVzdHMvZG9tL0FTVFN0
cnVjdHVyYWxQcm9wZXJ0eVRlc3QuamF2YQorKysgYi9vcmcuZWNsaXBzZS5qZHQuY29yZS50ZXN0
cy5tb2RlbC9zcmMvb3JnL2VjbGlwc2UvamR0L2NvcmUvdGVzdHMvZG9tL0FTVFN0cnVjdHVyYWxQ
cm9wZXJ0eVRlc3QuamF2YQpAQCAtMzUwLDcgKzM1MCw3IEBACiAJCQkJLy8gb29wcyAtIGd1ZXNz
IHRoYXQncyBub3QgdmFsaWQKIAkJCX0KIAkJfQotCQlhc3NlcnRFcXVhbHMoIldyb25nIGxhc3Qg
a25vd24gdHlwZSIsIDg2LCBoaSk7IC8vIGxhc3Qga25vd24gb25lCisJCWFzc2VydEVxdWFscygi
V3JvbmcgbGFzdCBrbm93biB0eXBlIiwgODcsIGhpKTsgLy8gbGFzdCBrbm93biBvbmUKIAkJYXNz
ZXJ0RXF1YWxzKCJXcm9uZyBudW1iZXIgb2YgZGlzdGluY3QgdHlwZXMiLCAgaGksIGNsYXNzZXMu
c2l6ZSgpKTsgLy8gYWxsIGNsYXNzZXMgYXJlIGRpc3RpbmN0CiAJfQogfQpkaWZmIC0tZ2l0IGEv
b3JnLmVjbGlwc2UuamR0LmNvcmUudGVzdHMubW9kZWwvc3JjL29yZy9lY2xpcHNlL2pkdC9jb3Jl
L3Rlc3RzL3Jld3JpdGUvZGVzY3JpYmluZy9BU1RSZXdyaXRpbmdMYW1iZGFFeHByZXNzaW9uVGVz
dC5qYXZhIGIvb3JnLmVjbGlwc2UuamR0LmNvcmUudGVzdHMubW9kZWwvc3JjL29yZy9lY2xpcHNl
L2pkdC9jb3JlL3Rlc3RzL3Jld3JpdGUvZGVzY3JpYmluZy9BU1RSZXdyaXRpbmdMYW1iZGFFeHBy
ZXNzaW9uVGVzdC5qYXZhCm5ldyBmaWxlIG1vZGUgMTAwNjQ0CmluZGV4IDAwMDAwMDAuLmUwYWM0
NmIKLS0tIC9kZXYvbnVsbAorKysgYi9vcmcuZWNsaXBzZS5qZHQuY29yZS50ZXN0cy5tb2RlbC9z
cmMvb3JnL2VjbGlwc2UvamR0L2NvcmUvdGVzdHMvcmV3cml0ZS9kZXNjcmliaW5nL0FTVFJld3Jp
dGluZ0xhbWJkYUV4cHJlc3Npb25UZXN0LmphdmEKQEAgLTAsMCArMSwyODkgQEAKKy8qKioqKioq
KioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioq
KioqKioqKioqKioqKioqCisgKiBDb3B5cmlnaHQgKGMpIDIwMTMgSUJNIENvcnBvcmF0aW9uIGFu
ZCBvdGhlcnMuCisgKiBBbGwgcmlnaHRzIHJlc2VydmVkLiBUaGlzIHByb2dyYW0gYW5kIHRoZSBh
Y2NvbXBhbnlpbmcgbWF0ZXJpYWxzCisgKiBhcmUgbWFkZSBhdmFpbGFibGUgdW5kZXIgdGhlIHRl
cm1zIG9mIHRoZSBFY2xpcHNlIFB1YmxpYyBMaWNlbnNlIHYxLjAKKyAqIHdoaWNoIGFjY29tcGFu
aWVzIHRoaXMgZGlzdHJpYnV0aW9uLCBhbmQgaXMgYXZhaWxhYmxlIGF0CisgKiBodHRwOi8vd3d3
LmVjbGlwc2Uub3JnL2xlZ2FsL2VwbC12MTAuaHRtbAorICoKKyAqIFRoaXMgaXMgYW4gaW1wbGVt
ZW50YXRpb24gb2YgYW4gZWFybHktZHJhZnQgc3BlY2lmaWNhdGlvbiBkZXZlbG9wZWQgdW5kZXIg
dGhlIEphdmEKKyAqIENvbW11bml0eSBQcm9jZXNzIChKQ1ApIGFuZCBpcyBtYWRlIGF2YWlsYWJs
ZSBmb3IgdGVzdGluZyBhbmQgZXZhbHVhdGlvbiBwdXJwb3NlcworICogb25seS4gVGhlIGNvZGUg
aXMgbm90IGNvbXBhdGlibGUgd2l0aCBhbnkgc3BlY2lmaWNhdGlvbiBvZiB0aGUgSkNQLgorICoK
KyAqIENvbnRyaWJ1dG9yczoKKyAqICAgICBJQk0gQ29ycG9yYXRpb24gLSBpbml0aWFsIEFQSSBh
bmQgaW1wbGVtZW50YXRpb24KKyAqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioq
KioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqLworcGFja2FnZSBvcmcu
ZWNsaXBzZS5qZHQuY29yZS50ZXN0cy5yZXdyaXRlLmRlc2NyaWJpbmc7CisKK2ltcG9ydCBqYXZh
LnV0aWwuTGlzdDsKKworaW1wb3J0IGp1bml0LmZyYW1ld29yay5UZXN0OworCitpbXBvcnQgb3Jn
LmVjbGlwc2UuamR0LmNvcmUuSUNvbXBpbGF0aW9uVW5pdDsKK2ltcG9ydCBvcmcuZWNsaXBzZS5q
ZHQuY29yZS5JUGFja2FnZUZyYWdtZW50OworaW1wb3J0IG9yZy5lY2xpcHNlLmpkdC5jb3JlLmRv
bS4qOworaW1wb3J0IG9yZy5lY2xpcHNlLmpkdC5jb3JlLmRvbS5yZXdyaXRlLkFTVFJld3JpdGU7
CisKK3B1YmxpYyBjbGFzcyBBU1RSZXdyaXRpbmdMYW1iZGFFeHByZXNzaW9uVGVzdCBleHRlbmRz
IEFTVFJld3JpdGluZ1Rlc3QgeworCisJcHVibGljIEFTVFJld3JpdGluZ0xhbWJkYUV4cHJlc3Np
b25UZXN0KFN0cmluZyBuYW1lKSB7CisJCXN1cGVyKG5hbWUpOworCX0KKworCXB1YmxpYyBBU1RS
ZXdyaXRpbmdMYW1iZGFFeHByZXNzaW9uVGVzdChTdHJpbmcgbmFtZSwgaW50IGFwaUxldmVsKSB7
CisJCXN1cGVyKG5hbWUsIGFwaUxldmVsKTsKKwl9CisKKwlwdWJsaWMgc3RhdGljIFRlc3Qgc3Vp
dGUoKSB7CisJCXJldHVybiBjcmVhdGVTdWl0ZShBU1RSZXdyaXRpbmdMYW1iZGFFeHByZXNzaW9u
VGVzdC5jbGFzcyk7CisJfQorCisJcHVibGljIHZvaWQgdGVzdExhbWJkYUV4cHJlc3Npb25zX3Np
bmNlXzgoKSB0aHJvd3MgRXhjZXB0aW9uIHsKKwkJSVBhY2thZ2VGcmFnbWVudCBwYWNrMT0gdGhp
cy5zb3VyY2VGb2xkZXIuY3JlYXRlUGFja2FnZUZyYWdtZW50KCJ0ZXN0MSIsIGZhbHNlLCBudWxs
KTsKKwkJU3RyaW5nQnVmZmVyIGJ1Zj0gbmV3IFN0cmluZ0J1ZmZlcigpOworCQlidWYuYXBwZW5k
KCJwYWNrYWdlIHRlc3QxO1xuIik7CisJCWJ1Zi5hcHBlbmQoImludGVyZmFjZSBJIHtcbiIpOwor
CQlidWYuYXBwZW5kKCIJaW50IGZvbyhpbnQgeCk7XG4iKTsKKwkJYnVmLmFwcGVuZCgifVxuIik7
CisJCWJ1Zi5hcHBlbmQoImludGVyZmFjZSBKIHtcbiIpOworCQlidWYuYXBwZW5kKCIJaW50IGZv
bygpO1xuIik7CisJCWJ1Zi5hcHBlbmQoIn1cbiIpOworCQlidWYuYXBwZW5kKCJwdWJsaWMgY2xh
c3MgWCB7XG4iKTsKKwkJYnVmLmFwcGVuZCgiIEkgaSA9ICB2bGFtYmRhIC0+IHtyZXR1cm4gMjAw
O307XG4iKTsKKwkJYnVmLmFwcGVuZCgiIEogaiA9ICAoKSAtPiAxNzI5O1xuIik7CisJCWJ1Zi5h
cHBlbmQoIn1cbiIpOworCQlJQ29tcGlsYXRpb25Vbml0IGN1PSBwYWNrMS5jcmVhdGVDb21waWxh
dGlvblVuaXQoIlguamF2YSIsIGJ1Zi50b1N0cmluZygpLCBmYWxzZSwgbnVsbCk7CisKKwkJQ29t
cGlsYXRpb25Vbml0IGFzdFJvb3Q9IGNyZWF0ZUFTVChjdSk7CisJCUFTVFJld3JpdGUgcmV3cml0
ZT0gQVNUUmV3cml0ZS5jcmVhdGUoYXN0Um9vdC5nZXRBU1QoKSk7CisJCUFTVCBhc3Q9IGFzdFJv
b3QuZ2V0QVNUKCk7CisKKwkJVHlwZURlY2xhcmF0aW9uIHR5cGVkZWNsYXJhdGlvbj0gZmluZFR5
cGVEZWNsYXJhdGlvbihhc3RSb290LCAiSSIpOworCisJCXsgLy8gY2hhbmdlIHJldHVybiB0eXBl
CisJCQlNZXRob2REZWNsYXJhdGlvbiBtZXRob2REZWNsPSBmaW5kTWV0aG9kRGVjbGFyYXRpb24o
dHlwZWRlY2xhcmF0aW9uLCAiZm9vIik7CisJCQlhc3NlcnRUcnVlKCJudWxsIHJldHVybiB0eXBl
OiBmb28iLCBtZXRob2REZWNsLmdldFJldHVyblR5cGUyKCkgIT0gbnVsbCk7CisKKwkJCVR5cGUg
cmV0dXJuVHlwZT0gbWV0aG9kRGVjbC5nZXRSZXR1cm5UeXBlMigpOworCQkJVHlwZSBuZXdSZXR1
cm5UeXBlPSBhc3RSb290LmdldEFTVCgpLm5ld1ByaW1pdGl2ZVR5cGUoUHJpbWl0aXZlVHlwZS5G
TE9BVCk7CisJCQlyZXdyaXRlLnJlcGxhY2UocmV0dXJuVHlwZSwgbmV3UmV0dXJuVHlwZSwgbnVs
bCk7CisJCX0KKwkJeyAvLyBhZGQgYSBwYXJhbWV0ZXIgdG8gdGhlIHNpbmdsZXRvbiBmdW5jdGlv
biBpbiB0aGUgaW50ZXJmYWNlLgorCQkJTWV0aG9kRGVjbGFyYXRpb24gbWV0aG9kRGVjbD0gZmlu
ZE1ldGhvZERlY2xhcmF0aW9uKHR5cGVkZWNsYXJhdGlvbiwgImZvbyIpOworCQkJTGlzdCBwYXJh
bWV0ZXJzPSBtZXRob2REZWNsLnBhcmFtZXRlcnMoKTsKKwkJCWFzc2VydFRydWUoIm11c3QgYmUg
MSBwYXJhbWV0ZXIiLCBwYXJhbWV0ZXJzLnNpemUoKSA9PSAxKTsKKworCQkJU2luZ2xlVmFyaWFi
bGVEZWNsYXJhdGlvbiBkZWNsPSBhc3QubmV3U2luZ2xlVmFyaWFibGVEZWNsYXJhdGlvbigpOwor
CQkJZGVjbC5zZXRUeXBlKGFzdC5uZXdQcmltaXRpdmVUeXBlKFByaW1pdGl2ZVR5cGUuSU5UKSk7
CisJCQlkZWNsLnNldE5hbWUoYXN0Lm5ld1NpbXBsZU5hbWUoInkiKSk7CisJCQlyZXdyaXRlLmdl
dExpc3RSZXdyaXRlKG1ldGhvZERlY2wsIE1ldGhvZERlY2xhcmF0aW9uLlBBUkFNRVRFUlNfUFJP
UEVSVFkpLmluc2VydExhc3QoZGVjbCwgbnVsbCk7CisJCX0KKworCQl7IC8vIGluc2VydCBhIHBh
cmFtZXRlcgorCQkJdHlwZWRlY2xhcmF0aW9uPSBmaW5kVHlwZURlY2xhcmF0aW9uKGFzdFJvb3Qs
ICJKIik7CisJCQlNZXRob2REZWNsYXJhdGlvbiBtZXRob2REZWNsID0gZmluZE1ldGhvZERlY2xh
cmF0aW9uKHR5cGVkZWNsYXJhdGlvbiwgImZvbyIpOworCQkJTGlzdCBwYXJhbWV0ZXJzID0gbWV0
aG9kRGVjbC5wYXJhbWV0ZXJzKCk7CisJCQlhc3NlcnRUcnVlKCJtdXN0IGJlIDAgcGFyYW1ldGVy
cyIsIHBhcmFtZXRlcnMuc2l6ZSgpID09IDApOworCisJCQlTaW5nbGVWYXJpYWJsZURlY2xhcmF0
aW9uIG5ld1BhcmFtPSBhc3QubmV3U2luZ2xlVmFyaWFibGVEZWNsYXJhdGlvbigpOworCQkJbmV3
UGFyYW0uc2V0TmFtZShhc3QubmV3U2ltcGxlTmFtZSgieCIpKTsKKwkJCW5ld1BhcmFtLnNldFR5
cGUoYXN0Lm5ld1ByaW1pdGl2ZVR5cGUoUHJpbWl0aXZlVHlwZS5JTlQpKTsKKwkJCXJld3JpdGUu
Z2V0TGlzdFJld3JpdGUobWV0aG9kRGVjbCwgTWV0aG9kRGVjbGFyYXRpb24uUEFSQU1FVEVSU19Q
Uk9QRVJUWSkuaW5zZXJ0Rmlyc3QobmV3UGFyYW0sIG51bGwpOworCQl9CisKKwkJdHlwZWRlY2xh
cmF0aW9uPSBmaW5kVHlwZURlY2xhcmF0aW9uKGFzdFJvb3QsICJYIik7CisJCUZpZWxkRGVjbGFy
YXRpb24gZmllbGREZWNsYXJhdGlvbiA9IChGaWVsZERlY2xhcmF0aW9uKSB0eXBlZGVjbGFyYXRp
b24uYm9keURlY2xhcmF0aW9ucygpLmdldCgwKTsKKwkJVmFyaWFibGVEZWNsYXJhdGlvbkZyYWdt
ZW50IGZyYWdtZW50ID0gKFZhcmlhYmxlRGVjbGFyYXRpb25GcmFnbWVudClmaWVsZERlY2xhcmF0
aW9uLmZyYWdtZW50cygpLmdldCgwKTsKKwkJRXhwcmVzc2lvbiBleHByZXNzaW9uID0gZnJhZ21l
bnQuZ2V0SW5pdGlhbGl6ZXIoKTsKKwkJYXNzZXJ0VHJ1ZShleHByZXNzaW9uIGluc3RhbmNlb2Yg
TGFtYmRhRXhwcmVzc2lvbik7CisJCUxhbWJkYUV4cHJlc3Npb24gbGFtYmRhRXhwcmVzc2lvbiA9
IChMYW1iZGFFeHByZXNzaW9uKWV4cHJlc3Npb247CisJCQorCQl7Ly8gYWRkIGEgcGFyYW1ldGVy
IHRvIHRoZSBsYW1iZGEgZXhwcmVzc2lvbgorCQkJTGlzdCBwYXJhbWV0ZXJzPSBsYW1iZGFFeHBy
ZXNzaW9uLnBhcmFtZXRlcnMoKTsKKwkJCWFzc2VydFRydWUoIm11c3QgYmUgMSBwYXJhbWV0ZXIi
LCBwYXJhbWV0ZXJzLnNpemUoKSA9PSAxKTsKKwkJCUFTVE5vZGUgZmlyc3RQYXJhbT0gKEFTVE5v
ZGUpIHBhcmFtZXRlcnMuZ2V0KDApOworCQkJVmFyaWFibGVEZWNsYXJhdGlvbkZyYWdtZW50IG5l
d1BhcmFtPSBhc3QubmV3VmFyaWFibGVEZWNsYXJhdGlvbkZyYWdtZW50KCk7CisJCQluZXdQYXJh
bS5zZXROYW1lKGFzdC5uZXdTaW1wbGVOYW1lKCJ3bGFtYmRhIikpOworCQkJcmV3cml0ZS5nZXRM
aXN0UmV3cml0ZShsYW1iZGFFeHByZXNzaW9uLCBMYW1iZGFFeHByZXNzaW9uLlBBUkFNRVRFUlNf
UFJPUEVSVFkpLmluc2VydEFmdGVyKG5ld1BhcmFtLCBmaXJzdFBhcmFtLCBudWxsKTsJCQorCQl9
CisJCQorCQl7Ly8gcmVwbGFjZSB0aGUgYmxvY2sgYm9keSB3aXRoIGEgZmxvYXQgbGl0ZXJhbCBl
eHByZXNzaW9uIGJvZHkuCisJCQlBU1ROb2RlIGJvZHkgPSBsYW1iZGFFeHByZXNzaW9uLmdldEJv
ZHkoKTsKKwkJCUFTVE5vZGUgbmV3Qm9keSA9IGFzdC5uZXdOdW1iZXJMaXRlcmFsKCIzLjE0Iik7
CisJCQlyZXdyaXRlLnJlcGxhY2UoYm9keSwgbmV3Qm9keSwgbnVsbCk7CisJCX0KKworCQlmaWVs
ZERlY2xhcmF0aW9uID0gKEZpZWxkRGVjbGFyYXRpb24pIHR5cGVkZWNsYXJhdGlvbi5ib2R5RGVj
bGFyYXRpb25zKCkuZ2V0KDEpOworCQlmcmFnbWVudCA9IChWYXJpYWJsZURlY2xhcmF0aW9uRnJh
Z21lbnQpZmllbGREZWNsYXJhdGlvbi5mcmFnbWVudHMoKS5nZXQoMCk7CisJCWV4cHJlc3Npb24g
PSBmcmFnbWVudC5nZXRJbml0aWFsaXplcigpOworCQlhc3NlcnRUcnVlKGV4cHJlc3Npb24gaW5z
dGFuY2VvZiBMYW1iZGFFeHByZXNzaW9uKTsKKwkJbGFtYmRhRXhwcmVzc2lvbiA9IChMYW1iZGFF
eHByZXNzaW9uKWV4cHJlc3Npb247CisJCQorCQl7Ly8gYWRkIGEgcGFyYW1ldGVyIHRvIHRoZSBs
YW1iZGEgZXhwcmVzc2lvbiAtIGJvcmRlciBjYXNlIC0gZW1wdHkgbGlzdCBpbml0aWFsbHkKKwkJ
CUxpc3QgcGFyYW1ldGVycz0gbGFtYmRhRXhwcmVzc2lvbi5wYXJhbWV0ZXJzKCk7CisJCQlhc3Nl
cnRUcnVlKCJtdXN0IGJlIDAgcGFyYW1ldGVyIiwgcGFyYW1ldGVycy5zaXplKCkgPT0gMCk7CisJ
CQlWYXJpYWJsZURlY2xhcmF0aW9uRnJhZ21lbnQgbmV3UGFyYW09IGFzdC5uZXdWYXJpYWJsZURl
Y2xhcmF0aW9uRnJhZ21lbnQoKTsKKwkJCW5ld1BhcmFtLnNldE5hbWUoYXN0Lm5ld1NpbXBsZU5h
bWUoInZsYW1iZGEiKSk7CisJCQlyZXdyaXRlLmdldExpc3RSZXdyaXRlKGxhbWJkYUV4cHJlc3Np
b24sIExhbWJkYUV4cHJlc3Npb24uUEFSQU1FVEVSU19QUk9QRVJUWSkuaW5zZXJ0Rmlyc3QobmV3
UGFyYW0sIG51bGwpOwkJCisJCX0KKwkJU3RyaW5nIHByZXZpZXc9IGV2YWx1YXRlUmV3cml0ZShj
dSwgcmV3cml0ZSk7CisKKwkJYnVmPSBuZXcgU3RyaW5nQnVmZmVyKCk7CisJCWJ1Zi5hcHBlbmQo
InBhY2thZ2UgdGVzdDE7XG4iKTsKKwkJYnVmLmFwcGVuZCgiaW50ZXJmYWNlIEkge1xuIik7CisJ
CWJ1Zi5hcHBlbmQoIglmbG9hdCBmb28oaW50IHgsIGludCB5KTtcbiIpOworCQlidWYuYXBwZW5k
KCJ9XG4iKTsKKwkJYnVmLmFwcGVuZCgiaW50ZXJmYWNlIEoge1xuIik7CisJCWJ1Zi5hcHBlbmQo
IglpbnQgZm9vKGludCB4KTtcbiIpOworCQlidWYuYXBwZW5kKCJ9XG4iKTsKKwkJYnVmLmFwcGVu
ZCgicHVibGljIGNsYXNzIFgge1xuIik7CisJCWJ1Zi5hcHBlbmQoIiBJIGkgPSAgKHZsYW1iZGEs
IHdsYW1iZGEpIC0+IDMuMTQ7XG4iKTsKKwkJYnVmLmFwcGVuZCgiIEogaiA9ICAodmxhbWJkYSkg
LT4gMTcyOTtcbiIpOworCQlidWYuYXBwZW5kKCJ9XG4iKTsKKwkJYXNzZXJ0RXF1YWxTdHJpbmco
cHJldmlldywgYnVmLnRvU3RyaW5nKCkpOworCX0KKwkKKwlwdWJsaWMgdm9pZCB0ZXN0TGFtYmRh
RXhwcmVzc2lvbnNfUGFyZW50aGVzZXNfc2luY2VfOCgpIHRocm93cyBFeGNlcHRpb24geworCQlJ
UGFja2FnZUZyYWdtZW50IHBhY2sxPSB0aGlzLnNvdXJjZUZvbGRlci5jcmVhdGVQYWNrYWdlRnJh
Z21lbnQoInRlc3QxIiwgZmFsc2UsIG51bGwpOworCQlTdHJpbmdCdWZmZXIgYnVmPSBuZXcgU3Ry
aW5nQnVmZmVyKCk7CisJCWJ1Zi5hcHBlbmQoInBhY2thZ2UgdGVzdDE7XG4iKTsKKwkJYnVmLmFw
cGVuZCgiaW50ZXJmYWNlIEkge1xuIik7CisJCWJ1Zi5hcHBlbmQoIglpbnQgZm9vKGludCB4KTtc
biIpOworCQlidWYuYXBwZW5kKCJ9XG4iKTsKKwkJYnVmLmFwcGVuZCgiaW50ZXJmYWNlIEoge1xu
Iik7CisJCWJ1Zi5hcHBlbmQoIglpbnQgZm9vKCk7XG4iKTsKKwkJYnVmLmFwcGVuZCgifVxuIik7
CisJCWJ1Zi5hcHBlbmQoImludGVyZmFjZSBLIHtcbiIpOworCQlidWYuYXBwZW5kKCIJaW50IGZv
byhpbnQgeCwgaW50IHkpO1xuIik7CisJCWJ1Zi5hcHBlbmQoIn1cbiIpOworCQlidWYuYXBwZW5k
KCJpbnRlcmZhY2UgTCB7XG4iKTsKKwkJYnVmLmFwcGVuZCgiCWludCBmb28oaW50IHgpO1xuIik7
CisJCWJ1Zi5hcHBlbmQoIn1cbiIpOworCQlidWYuYXBwZW5kKCJwdWJsaWMgY2xhc3MgWCB7XG4i
KTsKKwkJYnVmLmFwcGVuZCgiIEkgaSA9ICB2bGFtYmRhIC0+IDIyMTIxODg3O1xuIik7CisJCWJ1
Zi5hcHBlbmQoIiBJIGlkYXNoID0gICh2bGFtYmRhKSAtPiAxNzI5O1xuIik7CisJCWJ1Zi5hcHBl
bmQoIiBKIGogPSAgKCkgLT4gMjYwNDE5MjA7XG4iKTsKKwkJYnVmLmFwcGVuZCgiIEsgayA9ICAo
eCwgeSkgLT4gMTcyOTtcbiIpOworCQlidWYuYXBwZW5kKCIgSyBrZGFzaCA9ICAoaW50IHgsIGlu
dCB5KSAtPiAxNzI5O1xuIik7CisJCWJ1Zi5hcHBlbmQoIiBMIGwgPSAgdmxhbWJkYSAtPiAxNzI5
O1xuIik7CisJCWJ1Zi5hcHBlbmQoIn1cbiIpOworCQlJQ29tcGlsYXRpb25Vbml0IGN1PSBwYWNr
MS5jcmVhdGVDb21waWxhdGlvblVuaXQoIlguamF2YSIsIGJ1Zi50b1N0cmluZygpLCBmYWxzZSwg
bnVsbCk7CisKKwkJQ29tcGlsYXRpb25Vbml0IGFzdFJvb3Q9IGNyZWF0ZUFTVChjdSk7CisJCUFT
VFJld3JpdGUgcmV3cml0ZT0gQVNUUmV3cml0ZS5jcmVhdGUoYXN0Um9vdC5nZXRBU1QoKSk7CisJ
CUFTVCBhc3Q9IGFzdFJvb3QuZ2V0QVNUKCk7CisKKwkJeyAvLyByZW1vdmUgYSBwYXJhbWV0ZXIK
KwkJCVR5cGVEZWNsYXJhdGlvbiB0eXBlZGVjbGFyYXRpb249IGZpbmRUeXBlRGVjbGFyYXRpb24o
YXN0Um9vdCwgIkwiKTsKKwkJCU1ldGhvZERlY2xhcmF0aW9uIG1ldGhvZERlY2wgPSBmaW5kTWV0
aG9kRGVjbGFyYXRpb24odHlwZWRlY2xhcmF0aW9uLCAiZm9vIik7CisJCQlMaXN0IHBhcmFtZXRl
cnMgPSBtZXRob2REZWNsLnBhcmFtZXRlcnMoKTsKKwkJCWFzc2VydFRydWUoIm11c3QgYmUgMSBw
YXJhbWV0ZXIiLCBwYXJhbWV0ZXJzLnNpemUoKSA9PSAxKTsKKwkJCUFTVE5vZGUgcGFyYW0gPSAo
QVNUTm9kZSkgcGFyYW1ldGVycy5nZXQoMCk7CisJCQlyZXdyaXRlLmdldExpc3RSZXdyaXRlKG1l
dGhvZERlY2wsIE1ldGhvZERlY2xhcmF0aW9uLlBBUkFNRVRFUlNfUFJPUEVSVFkpLnJlbW92ZShw
YXJhbSwgbnVsbCk7CisJCX0KKworCQlpbnQgZkNvdW50ID0gMDsKKworCQlUeXBlRGVjbGFyYXRp
b24gdHlwZWRlY2xhcmF0aW9uPSBmaW5kVHlwZURlY2xhcmF0aW9uKGFzdFJvb3QsICJYIik7CisJ
CUZpZWxkRGVjbGFyYXRpb24gZmllbGREZWNsYXJhdGlvbiA9IChGaWVsZERlY2xhcmF0aW9uKSB0
eXBlZGVjbGFyYXRpb24uYm9keURlY2xhcmF0aW9ucygpLmdldChmQ291bnQrKyk7CisJCVZhcmlh
YmxlRGVjbGFyYXRpb25GcmFnbWVudCBmcmFnbWVudCA9IChWYXJpYWJsZURlY2xhcmF0aW9uRnJh
Z21lbnQpZmllbGREZWNsYXJhdGlvbi5mcmFnbWVudHMoKS5nZXQoMCk7CisJCUxhbWJkYUV4cHJl
c3Npb24gbGFtYmRhRXhwcmVzc2lvbiA9IChMYW1iZGFFeHByZXNzaW9uKWZyYWdtZW50LmdldElu
aXRpYWxpemVyKCk7CisJCQorCQl7Ly8gc2V0IHBhcmVudGhlc2VzCisJCQlhc3NlcnRUcnVlKCJs
YW1iZGEgZXhwcmVzc2lvbiBoYXMgcGFyYW50aGVzZXMiLCBsYW1iZGFFeHByZXNzaW9uLmhhc1Bh
cmVudGhlc2VzKCkgPT0gZmFsc2UpOworCQkJcmV3cml0ZS5zZXQobGFtYmRhRXhwcmVzc2lvbiwg
TGFtYmRhRXhwcmVzc2lvbi5QQVJFTlRIRVNFU19QUk9QRVJUWSwgQm9vbGVhbi5UUlVFLCBudWxs
KTsKKwkJfQorCQkKKwkJZmllbGREZWNsYXJhdGlvbiA9IChGaWVsZERlY2xhcmF0aW9uKSB0eXBl
ZGVjbGFyYXRpb24uYm9keURlY2xhcmF0aW9ucygpLmdldChmQ291bnQrKyk7CisJCWZyYWdtZW50
ID0gKFZhcmlhYmxlRGVjbGFyYXRpb25GcmFnbWVudClmaWVsZERlY2xhcmF0aW9uLmZyYWdtZW50
cygpLmdldCgwKTsKKwkJbGFtYmRhRXhwcmVzc2lvbiA9IChMYW1iZGFFeHByZXNzaW9uKWZyYWdt
ZW50LmdldEluaXRpYWxpemVyKCk7CisJCQorCQl7Ly8gcmVzZXQgcGFyZW50aGVzZXMgLSBhIGxl
Z2FsIG9wZXJhdGlvbiBoZXJlLgorCQkJYXNzZXJ0VHJ1ZSgibGFtYmRhIGV4cHJlc3Npb24gaGFz
IHBhcmFudGhlc2VzIiwgbGFtYmRhRXhwcmVzc2lvbi5oYXNQYXJlbnRoZXNlcygpID09IHRydWUp
OworCQkJcmV3cml0ZS5zZXQobGFtYmRhRXhwcmVzc2lvbiwgTGFtYmRhRXhwcmVzc2lvbi5QQVJF
TlRIRVNFU19QUk9QRVJUWSwgQm9vbGVhbi5GQUxTRSwgbnVsbCk7CisJCX0KKwkJCisJCWZpZWxk
RGVjbGFyYXRpb24gPSAoRmllbGREZWNsYXJhdGlvbikgdHlwZWRlY2xhcmF0aW9uLmJvZHlEZWNs
YXJhdGlvbnMoKS5nZXQoZkNvdW50KyspOworCQlmcmFnbWVudCA9IChWYXJpYWJsZURlY2xhcmF0
aW9uRnJhZ21lbnQpZmllbGREZWNsYXJhdGlvbi5mcmFnbWVudHMoKS5nZXQoMCk7CisJCWxhbWJk
YUV4cHJlc3Npb24gPSAoTGFtYmRhRXhwcmVzc2lvbilmcmFnbWVudC5nZXRJbml0aWFsaXplcigp
OworCisJCXsvLyByZXNldCBwYXJlbnRoZXNlcyAtIGFuIGlsbGVnYWwgb3BlcmF0aW9uIGhlcmUu
CisJCQlhc3NlcnRUcnVlKCJsYW1iZGEgZXhwcmVzc2lvbiBkb2VzIG5vdCBoYXZlIHBhcmFudGhl
c2VzIiwgbGFtYmRhRXhwcmVzc2lvbi5oYXNQYXJlbnRoZXNlcygpID09IHRydWUpOworCQkJcmV3
cml0ZS5zZXQobGFtYmRhRXhwcmVzc2lvbiwgTGFtYmRhRXhwcmVzc2lvbi5QQVJFTlRIRVNFU19Q
Uk9QRVJUWSwgQm9vbGVhbi5GQUxTRSwgbnVsbCk7CisJCX0KKworCQlmaWVsZERlY2xhcmF0aW9u
ID0gKEZpZWxkRGVjbGFyYXRpb24pIHR5cGVkZWNsYXJhdGlvbi5ib2R5RGVjbGFyYXRpb25zKCku
Z2V0KGZDb3VudCsrKTsKKwkJZnJhZ21lbnQgPSAoVmFyaWFibGVEZWNsYXJhdGlvbkZyYWdtZW50
KWZpZWxkRGVjbGFyYXRpb24uZnJhZ21lbnRzKCkuZ2V0KDApOworCQlsYW1iZGFFeHByZXNzaW9u
ID0gKExhbWJkYUV4cHJlc3Npb24pZnJhZ21lbnQuZ2V0SW5pdGlhbGl6ZXIoKTsKKworCQl7Ly8g
cmVzZXQgcGFyZW50aGVzZXMgLSBhbiBpbGxlZ2FsIG9wZXJhdGlvbiBoZXJlLgorCQkJYXNzZXJ0
VHJ1ZSgibGFtYmRhIGV4cHJlc3Npb24gZG9lcyBub3QgaGF2ZSBwYXJhbnRoZXNlcyIsIGxhbWJk
YUV4cHJlc3Npb24uaGFzUGFyZW50aGVzZXMoKSA9PSB0cnVlKTsKKwkJCXJld3JpdGUuc2V0KGxh
bWJkYUV4cHJlc3Npb24sIExhbWJkYUV4cHJlc3Npb24uUEFSRU5USEVTRVNfUFJPUEVSVFksIEJv
b2xlYW4uRkFMU0UsIG51bGwpOworCQl9CisJCQorCQl7Ly8gY2hhbmdlIGFsbCB0aGUgcGFyYW1l
dGVyIHRvIFNWRCBpZSBhZGQgdHlwZSBpbmZvIHRvIHRoZSBwYXJhbWV0ZXJzLgorCQkJTGlzdCBw
YXJhbWV0ZXJzID0gbGFtYmRhRXhwcmVzc2lvbi5wYXJhbWV0ZXJzKCk7CisJCQlWYXJpYWJsZURl
Y2xhcmF0aW9uIHBhcmFtID0gKFZhcmlhYmxlRGVjbGFyYXRpb24pcGFyYW1ldGVycy5nZXQoMCk7
CisJCQlTaW5nbGVWYXJpYWJsZURlY2xhcmF0aW9uIG5ld1BhcmFtPSBhc3QubmV3U2luZ2xlVmFy
aWFibGVEZWNsYXJhdGlvbigpOworCQkJbmV3UGFyYW0uc2V0TmFtZShhc3QubmV3U2ltcGxlTmFt
ZShuZXcgU3RyaW5nKHBhcmFtLnRvU3RyaW5nKCkpKSk7CisJCQluZXdQYXJhbS5zZXRUeXBlKGFz
dC5uZXdQcmltaXRpdmVUeXBlKFByaW1pdGl2ZVR5cGUuSU5UKSk7CisJCQlyZXdyaXRlLmdldExp
c3RSZXdyaXRlKGxhbWJkYUV4cHJlc3Npb24sIExhbWJkYUV4cHJlc3Npb24uUEFSQU1FVEVSU19Q
Uk9QRVJUWSkucmVwbGFjZShwYXJhbSwgbmV3UGFyYW0sIG51bGwpOworCQkJCisJCQlwYXJhbSA9
IChWYXJpYWJsZURlY2xhcmF0aW9uKXBhcmFtZXRlcnMuZ2V0KDEpOworCQkJbmV3UGFyYW09IGFz
dC5uZXdTaW5nbGVWYXJpYWJsZURlY2xhcmF0aW9uKCk7CisJCQluZXdQYXJhbS5zZXROYW1lKGFz
dC5uZXdTaW1wbGVOYW1lKG5ldyBTdHJpbmcocGFyYW0udG9TdHJpbmcoKSkpKTsKKwkJCW5ld1Bh
cmFtLnNldFR5cGUoYXN0Lm5ld1ByaW1pdGl2ZVR5cGUoUHJpbWl0aXZlVHlwZS5JTlQpKTsKKwkJ
CXJld3JpdGUuZ2V0TGlzdFJld3JpdGUobGFtYmRhRXhwcmVzc2lvbiwgTGFtYmRhRXhwcmVzc2lv
bi5QQVJBTUVURVJTX1BST1BFUlRZKS5yZXBsYWNlKHBhcmFtLCBuZXdQYXJhbSwgbnVsbCk7CisJ
CX0KKworCQl7Ly8gUmVtb3ZlIHR5cGUgaW5mbyBmcm9tIHRoZSBwYXJhbWV0ZXJzLgorCisJCQlm
aWVsZERlY2xhcmF0aW9uID0gKEZpZWxkRGVjbGFyYXRpb24pIHR5cGVkZWNsYXJhdGlvbi5ib2R5
RGVjbGFyYXRpb25zKCkuZ2V0KGZDb3VudCsrKTsKKwkJCWZyYWdtZW50ID0gKFZhcmlhYmxlRGVj
bGFyYXRpb25GcmFnbWVudClmaWVsZERlY2xhcmF0aW9uLmZyYWdtZW50cygpLmdldCgwKTsKKwkJ
CWxhbWJkYUV4cHJlc3Npb24gPSAoTGFtYmRhRXhwcmVzc2lvbilmcmFnbWVudC5nZXRJbml0aWFs
aXplcigpOworCQkJTGlzdCBwYXJhbWV0ZXJzID0gbGFtYmRhRXhwcmVzc2lvbi5wYXJhbWV0ZXJz
KCk7CisKKwkJCWZvciAoaW50IGkgPSAwOyBpIDwgcGFyYW1ldGVycy5zaXplKCk7ICsraSkgewor
CQkJCVNpbmdsZVZhcmlhYmxlRGVjbGFyYXRpb24gcGFyYW0gPSAoU2luZ2xlVmFyaWFibGVEZWNs
YXJhdGlvbilwYXJhbWV0ZXJzLmdldChpKTsKKwkJCQlWYXJpYWJsZURlY2xhcmF0aW9uRnJhZ21l
bnQgbmV3UGFyYW09IGFzdC5uZXdWYXJpYWJsZURlY2xhcmF0aW9uRnJhZ21lbnQoKTsKKwkJCQlu
ZXdQYXJhbS5zZXROYW1lKGFzdC5uZXdTaW1wbGVOYW1lKG5ldyBTdHJpbmcocGFyYW0uZ2V0TmFt
ZSgpLnRvU3RyaW5nKCkpKSk7CisJCQkJcmV3cml0ZS5nZXRMaXN0UmV3cml0ZShsYW1iZGFFeHBy
ZXNzaW9uLCBMYW1iZGFFeHByZXNzaW9uLlBBUkFNRVRFUlNfUFJPUEVSVFkpLnJlcGxhY2UocGFy
YW0sIG5ld1BhcmFtLCBudWxsKTsJCQkJCisJCQl9CisJCX0KKworCQlmaWVsZERlY2xhcmF0aW9u
ID0gKEZpZWxkRGVjbGFyYXRpb24pIHR5cGVkZWNsYXJhdGlvbi5ib2R5RGVjbGFyYXRpb25zKCku
Z2V0KGZDb3VudCsrKTsKKwkJZnJhZ21lbnQgPSAoVmFyaWFibGVEZWNsYXJhdGlvbkZyYWdtZW50
KWZpZWxkRGVjbGFyYXRpb24uZnJhZ21lbnRzKCkuZ2V0KDApOworCQlsYW1iZGFFeHByZXNzaW9u
ID0gKExhbWJkYUV4cHJlc3Npb24pZnJhZ21lbnQuZ2V0SW5pdGlhbGl6ZXIoKTsKKwkKKwkJey8v
IHJlbW92ZSB0aGUgb25seSBwYXJhbWV0ZXIgYW5kIHRoZSByZXdyaXRlciBzaG91bGQgYXV0b21h
dGljYWxseSBhZGQgdGhlIHBhcmVudGhlc2VzCisJCQlMaXN0IHBhcmFtZXRlcnMgPSBsYW1iZGFF
eHByZXNzaW9uLnBhcmFtZXRlcnMoKTsKKwkJCUFTVE5vZGUgcGFyYW0gPSAoQVNUTm9kZSlwYXJh
bWV0ZXJzLmdldCgwKTsKKwkJCXJld3JpdGUuZ2V0TGlzdFJld3JpdGUobGFtYmRhRXhwcmVzc2lv
biwgTGFtYmRhRXhwcmVzc2lvbi5QQVJBTUVURVJTX1BST1BFUlRZKS5yZW1vdmUocGFyYW0sICBu
dWxsKTsKKwkJfQorCisJCVN0cmluZyBwcmV2aWV3PSBldmFsdWF0ZVJld3JpdGUoY3UsIHJld3Jp
dGUpOworCisJCWJ1Zj0gbmV3IFN0cmluZ0J1ZmZlcigpOworCQlidWYuYXBwZW5kKCJwYWNrYWdl
IHRlc3QxO1xuIik7CisJCWJ1Zi5hcHBlbmQoImludGVyZmFjZSBJIHtcbiIpOworCQlidWYuYXBw
ZW5kKCIJaW50IGZvbyhpbnQgeCk7XG4iKTsKKwkJYnVmLmFwcGVuZCgifVxuIik7CisJCWJ1Zi5h
cHBlbmQoImludGVyZmFjZSBKIHtcbiIpOworCQlidWYuYXBwZW5kKCIJaW50IGZvbygpO1xuIik7
CisJCWJ1Zi5hcHBlbmQoIn1cbiIpOworCQlidWYuYXBwZW5kKCJpbnRlcmZhY2UgSyB7XG4iKTsK
KwkJYnVmLmFwcGVuZCgiCWludCBmb28oaW50IHgsIGludCB5KTtcbiIpOworCQlidWYuYXBwZW5k
KCJ9XG4iKTsKKwkJYnVmLmFwcGVuZCgiaW50ZXJmYWNlIEwge1xuIik7CisJCWJ1Zi5hcHBlbmQo
IglpbnQgZm9vKCk7XG4iKTsKKwkJYnVmLmFwcGVuZCgifVxuIik7CisJCWJ1Zi5hcHBlbmQoInB1
YmxpYyBjbGFzcyBYIHtcbiIpOworCQlidWYuYXBwZW5kKCIgSSBpID0gICh2bGFtYmRhKSAtPiAy
MjEyMTg4NztcbiIpOworCQlidWYuYXBwZW5kKCIgSSBpZGFzaCA9ICB2bGFtYmRhIC0+IDE3Mjk7
XG4iKTsKKwkJYnVmLmFwcGVuZCgiIEogaiA9ICAoKSAtPiAyNjA0MTkyMDtcbiIpOworCQlidWYu
YXBwZW5kKCIgSyBrID0gIChpbnQgeCwgaW50IHkpIC0+IDE3Mjk7XG4iKTsKKwkJYnVmLmFwcGVu
ZCgiIEsga2Rhc2ggPSAgKHgsIHkpIC0+IDE3Mjk7XG4iKTsKKwkJYnVmLmFwcGVuZCgiIEwgbCA9
ICAoKSAtPiAxNzI5O1xuIik7CisJCWJ1Zi5hcHBlbmQoIn1cbiIpOworCQlhc3NlcnRFcXVhbFN0
cmluZyhwcmV2aWV3LCBidWYudG9TdHJpbmcoKSk7CisJfQorfQpcIE5vIG5ld2xpbmUgYXQgZW5k
IG9mIGZpbGUKZGlmZiAtLWdpdCBhL29yZy5lY2xpcHNlLmpkdC5jb3JlL2RvbS9vcmcvZWNsaXBz
ZS9qZHQvY29yZS9kb20vQVNULmphdmEgYi9vcmcuZWNsaXBzZS5qZHQuY29yZS9kb20vb3JnL2Vj
bGlwc2UvamR0L2NvcmUvZG9tL0FTVC5qYXZhCmluZGV4IDg3YmY0ZTUuLjAxNjE1ZGQgMTAwNjQ0
Ci0tLSBhL29yZy5lY2xpcHNlLmpkdC5jb3JlL2RvbS9vcmcvZWNsaXBzZS9qZHQvY29yZS9kb20v
QVNULmphdmEKKysrIGIvb3JnLmVjbGlwc2UuamR0LmNvcmUvZG9tL29yZy9lY2xpcHNlL2pkdC9j
b3JlL2RvbS9BU1QuamF2YQpAQCAtMTk2Niw2ICsxOTY2LDI5IEBACiAJfQogCiAJLyoqCisJICog
Q3JlYXRlcyBhbmQgcmV0dXJucyBhIG5ldyB1bnBhcmVudGVkIHBhY2thZ2UgcXVhbGlmaWVkIHR5
cGUgbm9kZSB3aXRoCisJICogdGhlIGdpdmVuIHF1YWxpZmllciBhbmQgbmFtZS4KKwkgKgorCSAq
IEBwYXJhbSBxdWFsaWZpZXIgdGhlIHBhY2thZ2UgcXVhbGlmaWVyIHR5cGUgbm9kZQorCSAqIEBw
YXJhbSBuYW1lIHRoZSBzaW1wbGUgbmFtZSBiZWluZyBxdWFsaWZpZWQKKwkgKiBAcmV0dXJuIGEg
bmV3IHVucGFyZW50ZWQgcXVhbGlmaWVkIHR5cGUgbm9kZQorCSAqIEBleGNlcHRpb24gSWxsZWdh
bEFyZ3VtZW50RXhjZXB0aW9uIGlmOgorCSAqIDx1bD4KKwkgKiA8bGk+dGhlIG5vZGUgYmVsb25n
cyB0byBhIGRpZmZlcmVudCBBU1Q8L2xpPgorCSAqIDxsaT50aGUgbm9kZSBhbHJlYWR5IGhhcyBh
IHBhcmVudDwvbGk+CisJICogPC91bD4KKwkgKiBAZXhjZXB0aW9uIFVuc3VwcG9ydGVkT3BlcmF0
aW9uRXhjZXB0aW9uIGlmIHRoaXMgb3BlcmF0aW9uIGlzIHVzZWQgaW4KKwkgKiBhIEpMUzIsIEpM
UzMgYW5kIEpMUzQgQVNUCisJICogQHNpbmNlIDMuOQorCSAqLworCXB1YmxpYyBQYWNrYWdlUXVh
bGlmaWVkVHlwZSBuZXdQYWNrYWdlUXVhbGlmaWVkVHlwZShOYW1lIHF1YWxpZmllciwgU2ltcGxl
TmFtZSBuYW1lKSB7CisJCVBhY2thZ2VRdWFsaWZpZWRUeXBlIHJlc3VsdCA9IG5ldyBQYWNrYWdl
UXVhbGlmaWVkVHlwZSh0aGlzKTsKKwkJcmVzdWx0LnNldFF1YWxpZmllcihxdWFsaWZpZXIpOwor
CQlyZXN1bHQuc2V0TmFtZShuYW1lKTsKKwkJcmV0dXJuIHJlc3VsdDsKKwl9CisKKwkvKioKIAkg
KiBDcmVhdGVzIGFuZCByZXR1cm5zIGEgbmV3IHVucGFyZW50ZWQgcGFyYW1ldGVyaXplZCB0eXBl
IG5vZGUgd2l0aCB0aGUKIAkgKiBnaXZlbiB0eXBlIGFuZCBhbiBlbXB0eSBsaXN0IG9mIHR5cGUg
YXJndW1lbnRzLgogCSAqCmRpZmYgLS1naXQgYS9vcmcuZWNsaXBzZS5qZHQuY29yZS9kb20vb3Jn
L2VjbGlwc2UvamR0L2NvcmUvZG9tL0FTVENvbnZlcnRlci5qYXZhIGIvb3JnLmVjbGlwc2UuamR0
LmNvcmUvZG9tL29yZy9lY2xpcHNlL2pkdC9jb3JlL2RvbS9BU1RDb252ZXJ0ZXIuamF2YQppbmRl
eCBiNzkwNjIyLi5iNjI2OTNmIDEwMDY0NAotLS0gYS9vcmcuZWNsaXBzZS5qZHQuY29yZS9kb20v
b3JnL2VjbGlwc2UvamR0L2NvcmUvZG9tL0FTVENvbnZlcnRlci5qYXZhCisrKyBiL29yZy5lY2xp
cHNlLmpkdC5jb3JlL2RvbS9vcmcvZWNsaXBzZS9qZHQvY29yZS9kb20vQVNUQ29udmVydGVyLmph
dmEKQEAgLTE3LDYgKzE3LDcgQEAKIAogcGFja2FnZSBvcmcuZWNsaXBzZS5qZHQuY29yZS5kb207
CiAKK2ltcG9ydCBqYXZhLnV0aWwuQXJyYXlzOwogaW1wb3J0IGphdmEudXRpbC5IYXNoU2V0Owog
aW1wb3J0IGphdmEudXRpbC5JdGVyYXRvcjsKIGltcG9ydCBqYXZhLnV0aWwuTGlzdDsKQEAgLTU1
LDYgKzU2LDggQEAKIGltcG9ydCBvcmcuZWNsaXBzZS5qZHQuaW50ZXJuYWwuY29tcGlsZXIuaW1w
bC5Db21waWxlck9wdGlvbnM7CiBpbXBvcnQgb3JnLmVjbGlwc2UuamR0LmludGVybmFsLmNvbXBp
bGVyLmxvb2t1cC5CbG9ja1Njb3BlOwogaW1wb3J0IG9yZy5lY2xpcHNlLmpkdC5pbnRlcm5hbC5j
b21waWxlci5sb29rdXAuRXh0cmFDb21waWxlck1vZGlmaWVyczsKK2ltcG9ydCBvcmcuZWNsaXBz
ZS5qZHQuaW50ZXJuYWwuY29tcGlsZXIubG9va3VwLlBhY2thZ2VCaW5kaW5nOworaW1wb3J0IG9y
Zy5lY2xpcHNlLmpkdC5pbnRlcm5hbC5jb21waWxlci5sb29rdXAuUmVmZXJlbmNlQmluZGluZzsK
IGltcG9ydCBvcmcuZWNsaXBzZS5qZHQuaW50ZXJuYWwuY29tcGlsZXIubG9va3VwLlR5cGVDb25z
dGFudHM7CiBpbXBvcnQgb3JnLmVjbGlwc2UuamR0LmludGVybmFsLmNvbXBpbGVyLnBhcnNlci5S
ZWNvdmVyeVNjYW5uZXI7CiBpbXBvcnQgb3JnLmVjbGlwc2UuamR0LmludGVybmFsLmNvbXBpbGVy
LnBhcnNlci5TY2FubmVyOwpAQCAtMzU0NCwxMyArMzU0Nyw3IEBACiAJCQkJCQlzaW1wbGVUeXBl
LnNldE5hbWUobmFtZSk7CiAJCQkJCQlpbnQgc3RhcnQgPSAoaW50KShwb3NpdGlvbnNbMF0gPj4+
IDMyKTsKIAkJCQkJCWludCBlbmQgPSAoaW50KXBvc2l0aW9uc1tmaXJzdFR5cGVJbmRleF07Ci0J
CQkJCQlzaW1wbGVUeXBlLnNldFNvdXJjZVJhbmdlKHN0YXJ0LCBlbmQgLSBzdGFydCArIDEpOwot
CQkJCQkJaWYgKHR5cGVBbm5vdGF0aW9ucyAhPSBudWxsICYmIChhbm5vdGF0aW9ucyA9IHR5cGVB
bm5vdGF0aW9uc1tmaXJzdFR5cGVJbmRleF0pICE9IG51bGwpIHsKLQkJCQkJCQlhbm5vdGF0ZVR5
cGUoc2ltcGxlVHlwZSwgYW5ub3RhdGlvbnMpOwotCQkJCQkJfQotCQkJCQkJaWYgKHRoaXMucmVz
b2x2ZUJpbmRpbmdzKSB7Ci0JCQkJCQkJcmVjb3JkTm9kZXMoc2ltcGxlVHlwZSwgdHlwZVJlZmVy
ZW5jZSk7Ci0JCQkJCQl9CisJCQkJCQlzZXRTb3VyY2VBbm5vdGF0aW9uc0FuZEJpbmRpbmdzKHR5
cGVSZWZlcmVuY2UsIHBvc2l0aW9ucywgdHlwZUFubm90YXRpb25zLCBmaXJzdFR5cGVJbmRleCwg
MCwgZmlyc3RUeXBlSW5kZXgsIHNpbXBsZVR5cGUpOwogCQkJCQkJVHlwZSBjdXJyZW50VHlwZSA9
IHNpbXBsZVR5cGU7CQkJCQkJCiAJCQkJCQlpbnQgaW5kZXhPZkVuY2xvc2luZ1R5cGUgPSAxOwog
CQkJCQkJaWYgKHR5cGVBcmd1bWVudHMgIT0gbnVsbCAmJiAoYXJndW1lbnRzID0gdHlwZUFyZ3Vt
ZW50c1tmaXJzdFR5cGVJbmRleF0pICE9IG51bGwpIHsKQEAgLTM2MjYsNyArMzYyMyw3IEBACiAJ
CQkJb3JnLmVjbGlwc2UuamR0LmludGVybmFsLmNvbXBpbGVyLmFzdC5Bbm5vdGF0aW9uIFtdW10g
dHlwZUFubm90YXRpb25zID0gdHlwZVJlZmVyZW5jZS5hbm5vdGF0aW9uczsKIAkJCQljaGFyIFtd
W10gdG9rZW5zID0gcXVhbGlmaWVkVHlwZVJlZmVyZW5jZS50b2tlbnM7CiAJCQkJaW50IGxlbnRo
ID0gdG9rZW5zLmxlbmd0aDsKLQkJCQlpbnQgZmlyc3RUeXBlSW5kZXggPSBsZW50aCAtIDE7CisJ
CQkJaW50IGZpcnN0VHlwZUluZGV4ID0gbGVudGg7CiAJCQkJCiAJCQkJaWYgKHR5cGVBbm5vdGF0
aW9ucyAhPSBudWxsKSB7CiAJCQkJCWZvciAoaW50IGkgPSAwOyBpIDwgbGVudGg7ICsraSkgewpA
QCAtMzYzOCw1NyArMzYzNSw0MiBAQAogCQkJCX0gIAogCQkJCXNvdXJjZVN0YXJ0ID0gKGludCko
cG9zaXRpb25zWzBdPj4+MzIpOwogCQkJCU5hbWUgbmFtZSA9IG51bGw7Ci0JCQkJaWYgKGZpcnN0
VHlwZUluZGV4ID09IDApIHsKLQkJCQkJZmluYWwgU2ltcGxlTmFtZSBzaW1wbGVOYW1lID0gbmV3
IFNpbXBsZU5hbWUodGhpcy5hc3QpOwotCQkJCQlzaW1wbGVOYW1lLmludGVybmFsU2V0SWRlbnRp
ZmllcihuZXcgU3RyaW5nKHRva2Vuc1swXSkpOwotCQkJCQlyZWNvcmRQZW5kaW5nTmFtZVNjb3Bl
UmVzb2x1dGlvbihzaW1wbGVOYW1lKTsKLQkJCQkJaW50IHN0YXJ0ID0gKGludCkgKHBvc2l0aW9u
c1swXSA+Pj4gMzIpOwotCQkJCQlpbnQgZW5kID0gKGludCkgcG9zaXRpb25zWzBdOwotCQkJCQlz
aW1wbGVOYW1lLnNldFNvdXJjZVJhbmdlKHN0YXJ0LCBlbmQpOwotCQkJCQlzaW1wbGVOYW1lLmlu
ZGV4ID0gMTsKLQkJCQkJbmFtZSA9IHNpbXBsZU5hbWU7Ci0JCQkJCWlmICh0aGlzLnJlc29sdmVC
aW5kaW5ncykgewotCQkJCQkJcmVjb3JkTm9kZXMoc2ltcGxlTmFtZSwgdHlwZVJlZmVyZW5jZSk7
Ci0JCQkJCX0JCQkJCQorCQkJCVR5cGUgY3VycmVudFR5cGUgPSBudWxsOworCQkJCWlmIChmaXJz
dFR5cGVJbmRleCA9PSBsZW50aCkgey8vSnVzdCBhIFF1YWxpZmllZE5hbWUKKwkJCQkJbmFtZSA9
IHNldFF1YWxpZmllZE5hbWVOYW1lQW5kU291cmNlUmFuZ2VzKHRva2VucywgcG9zaXRpb25zLCBs
ZW50aCAtIDEsIHR5cGVSZWZlcmVuY2UpOworCQkJCQljdXJyZW50VHlwZSA9IGdldFNpbXBsZVR5
cGVXaXRoTmFtZUFuZEJpbmRpbmcobmFtZSwgdHlwZVJlZmVyZW5jZSwgcG9zaXRpb25zLCAwLCBs
ZW50aCAtIDEpOwogCQkJCX0gZWxzZSB7Ci0JCQkJCW5hbWUgPSBzZXRRdWFsaWZpZWROYW1lTmFt
ZUFuZFNvdXJjZVJhbmdlcyh0b2tlbnMsIHBvc2l0aW9ucywgZmlyc3RUeXBlSW5kZXgsIHR5cGVS
ZWZlcmVuY2UpOwotCQkJCX0KLQkJCQlTaW1wbGVUeXBlIHNpbXBsZVR5cGUgPSBuZXcgU2ltcGxl
VHlwZSh0aGlzLmFzdCk7Ci0JCQkJc2ltcGxlVHlwZS5zZXROYW1lKG5hbWUpOwotCQkJCWludCBz
dGFydCA9IChpbnQpKHBvc2l0aW9uc1swXSA+Pj4gMzIpOwotCQkJCWludCBlbmQgPSAoaW50KXBv
c2l0aW9uc1tmaXJzdFR5cGVJbmRleF07Ci0JCQkJc2ltcGxlVHlwZS5zZXRTb3VyY2VSYW5nZShz
dGFydCwgZW5kIC0gc3RhcnQgKyAxKTsKLQkJCQlpZiAodHlwZUFubm90YXRpb25zICE9IG51bGwg
JiYgKGFubm90YXRpb25zID0gdHlwZUFubm90YXRpb25zW2ZpcnN0VHlwZUluZGV4XSkgIT0gbnVs
bCkgewotCQkJCQlhbm5vdGF0ZVR5cGUoc2ltcGxlVHlwZSwgYW5ub3RhdGlvbnMpOwotCQkJCX0K
LQkJCQlpZiAodGhpcy5yZXNvbHZlQmluZGluZ3MpIHsKLQkJCQkJcmVjb3JkTm9kZXMoc2ltcGxl
VHlwZSwgdHlwZVJlZmVyZW5jZSk7Ci0JCQkJfQotCQkJCVR5cGUgY3VycmVudFR5cGUgPSBzaW1w
bGVUeXBlOwotCQkJCQotCQkJCWZvciAoaW50IGkgPSBmaXJzdFR5cGVJbmRleCArIDE7IGkgPCBs
ZW50aDsgKytpKSB7Ci0JCQkJCVNpbXBsZU5hbWUgc2ltcGxlTmFtZSA9IG5ldyBTaW1wbGVOYW1l
KHRoaXMuYXN0KTsKLQkJCQkJc2ltcGxlTmFtZS5pbnRlcm5hbFNldElkZW50aWZpZXIobmV3IFN0
cmluZyh0b2tlbnNbaV0pKTsKLQkJCQkJc2ltcGxlTmFtZS5pbmRleCA9IGkgKyAxOwotCQkJCQlz
dGFydCA9IChpbnQpIChwb3NpdGlvbnNbaV0gPj4+IDMyKTsKLQkJCQkJZW5kID0gKGludCkgcG9z
aXRpb25zW2ldOwotCQkJCQlzaW1wbGVOYW1lLnNldFNvdXJjZVJhbmdlKHN0YXJ0LCBlbmQgLSBz
dGFydCArMSk7Ci0JCQkJCXJlY29yZFBlbmRpbmdOYW1lU2NvcGVSZXNvbHV0aW9uKHNpbXBsZU5h
bWUpOwotCQkJCQlRdWFsaWZpZWRUeXBlIHF1YWxpZmllZFR5cGUgPSBuZXcgUXVhbGlmaWVkVHlw
ZSh0aGlzLmFzdCk7Ci0JCQkJCXF1YWxpZmllZFR5cGUuc2V0UXVhbGlmaWVyKGN1cnJlbnRUeXBl
KTsKLQkJCQkJcXVhbGlmaWVkVHlwZS5zZXROYW1lKHNpbXBsZU5hbWUpOwotCQkJCQlpZiAodHlw
ZUFubm90YXRpb25zICE9IG51bGwgJiYgKGFubm90YXRpb25zID0gdHlwZUFubm90YXRpb25zW2ld
KSAhPSBudWxsKSB7Ci0JCQkJCQlhbm5vdGF0ZVR5cGUocXVhbGlmaWVkVHlwZSwgYW5ub3RhdGlv
bnMpOworCQkJCQlpZiAoZmlyc3RUeXBlSW5kZXggPD0gMSkgeworCQkJCQkJbmFtZSA9IGNyZWF0
ZVNpbXBsZU5hbWUodHlwZVJlZmVyZW5jZSwgcG9zaXRpb25zLCB0b2tlbnMsIDAgKTsKKwkJCQkJ
CWZpcnN0VHlwZUluZGV4ID0gMTsKKwkJCQkJfSBlbHNlIHsKKwkJCQkJCW5hbWUgPSBzZXRRdWFs
aWZpZWROYW1lTmFtZUFuZFNvdXJjZVJhbmdlcyh0b2tlbnMsIHBvc2l0aW9ucywgZmlyc3RUeXBl
SW5kZXggLSAxLCB0eXBlUmVmZXJlbmNlKTsKKwkJCQkJfQkJCQkJCQorCisJCQkJCW9yZy5lY2xp
cHNlLmpkdC5pbnRlcm5hbC5jb21waWxlci5sb29rdXAuVHlwZUJpbmRpbmcgdHlwZUJpbmRpbmcg
PSB0eXBlUmVmZXJlbmNlLnJlc29sdmVkVHlwZTsKKwkJCQkJYm9vbGVhbiBjcmVhdGVQYWNrYWdl
UXVhbGlmaWVkVHlwZSA9IGZhbHNlOworCQkJCQlpZiAodHlwZUJpbmRpbmcgaW5zdGFuY2VvZiBS
ZWZlcmVuY2VCaW5kaW5nKSB7CisJCQkJCQlSZWZlcmVuY2VCaW5kaW5nIHJlZmVyZW5jZUJpbmRp
bmcgPSAoUmVmZXJlbmNlQmluZGluZyl0eXBlQmluZGluZzsJCQkKKwkJCQkJCVBhY2thZ2VCaW5k
aW5nIHBhY2thZ2VCaW5kaW5nID0gcmVmZXJlbmNlQmluZGluZy5nZXRQYWNrYWdlKCk7CisJCQkJ
CQlpZiAocGFja2FnZUJpbmRpbmcgIT0gbnVsbCAmJiBBcnJheXMuZXF1YWxzKG5hbWUudG9TdHJp
bmcoKS50b0NoYXJBcnJheSgpLCBwYWNrYWdlQmluZGluZy5yZWFkYWJsZU5hbWUoKSkpIHsKKwkJ
CQkJCQljcmVhdGVQYWNrYWdlUXVhbGlmaWVkVHlwZSA9IHRydWU7CisJCQkJCQl9CiAJCQkJCX0K
LQkJCQkJaWYgKHRoaXMucmVzb2x2ZUJpbmRpbmdzKSB7Ci0JCQkJCQlyZWNvcmROb2RlcyhzaW1w
bGVOYW1lLCB0eXBlUmVmZXJlbmNlKTsKLQkJCQkJCXJlY29yZE5vZGVzKHF1YWxpZmllZFR5cGUs
IHR5cGVSZWZlcmVuY2UpOworCQkJCQkKKwkJCQkJaWYgKGNyZWF0ZVBhY2thZ2VRdWFsaWZpZWRU
eXBlID09IHRydWUpIHsKKwkJCQkJCVBhY2thZ2VRdWFsaWZpZWRUeXBlIHBhY2thZ2VRdWFsaWZp
ZWRUeXBlID0gbmV3IFBhY2thZ2VRdWFsaWZpZWRUeXBlKHRoaXMuYXN0KTsKKwkJCQkJCXBhY2th
Z2VRdWFsaWZpZWRUeXBlLnNldFF1YWxpZmllcihuYW1lKTsKKwkJCQkJCXBhY2thZ2VRdWFsaWZp
ZWRUeXBlLnNldE5hbWUoY3JlYXRlU2ltcGxlTmFtZSh0eXBlUmVmZXJlbmNlLCBwb3NpdGlvbnMs
IHRva2VucywgZmlyc3RUeXBlSW5kZXgpKTsKKwkJCQkJCXNldFNvdXJjZUFubm90YXRpb25zQW5k
QmluZGluZ3ModHlwZVJlZmVyZW5jZSwgcG9zaXRpb25zLCB0eXBlQW5ub3RhdGlvbnMsIGZpcnN0
VHlwZUluZGV4LCAwLCBmaXJzdFR5cGVJbmRleCwgcGFja2FnZVF1YWxpZmllZFR5cGUpOworCQkJ
CQkJY3VycmVudFR5cGUgPSBwYWNrYWdlUXVhbGlmaWVkVHlwZTsJCQkJCQkJCQkJCQkJCQkJCQor
CQkJCQl9IGVsc2UgeworCQkJCQkJU2ltcGxlVHlwZSBzaW1wbGVUeXBlID0gdGhpcy5hc3QubmV3
U2ltcGxlVHlwZShuYW1lKTsJCisJCQkJCQlzZXRTb3VyY2VBbm5vdGF0aW9uc0FuZEJpbmRpbmdz
KHR5cGVSZWZlcmVuY2UsIHBvc2l0aW9ucywgdHlwZUFubm90YXRpb25zLCAwLCAwLCAwLCBzaW1w
bGVUeXBlKTsKKwkJCQkJCWN1cnJlbnRUeXBlID0gZ2V0UXVhbGlmaWVkVHlwZVdpdGhTb3VyY2VB
bmRCaW5kaW5nKHR5cGVSZWZlcmVuY2UsIHBvc2l0aW9ucywgIHR5cGVBbm5vdGF0aW9ucywgdG9r
ZW5zLCBmaXJzdFR5cGVJbmRleCwgc2ltcGxlVHlwZSk7CiAJCQkJCX0KLQkJCQkJc3RhcnQgPSBj
dXJyZW50VHlwZS5nZXRTdGFydFBvc2l0aW9uKCk7Ci0JCQkJCWVuZCA9IHNpbXBsZU5hbWUuZ2V0
U3RhcnRQb3NpdGlvbigpICsgc2ltcGxlTmFtZS5nZXRMZW5ndGgoKSAtIDE7Ci0JCQkJCXF1YWxp
ZmllZFR5cGUuc2V0U291cmNlUmFuZ2Uoc3RhcnQsIGVuZCAtIHN0YXJ0ICsgMSk7Ci0JCQkJCWN1
cnJlbnRUeXBlID0gcXVhbGlmaWVkVHlwZTsKLQkJCQkJcXVhbGlmaWVkVHlwZS5pbmRleCAgPSAx
OworCQkJCQlmb3IgKGludCBpID0gZmlyc3RUeXBlSW5kZXggKyAxOyBpIDwgbGVudGg7ICsraSkg
eworCQkJCQkJY3VycmVudFR5cGUgPSBnZXRRdWFsaWZpZWRUeXBlV2l0aFNvdXJjZUFuZEJpbmRp
bmcodHlwZVJlZmVyZW5jZSwgcG9zaXRpb25zLCAgdHlwZUFubm90YXRpb25zLCB0b2tlbnMsIGks
IGN1cnJlbnRUeXBlKTsKKwkJCQkJfQkJCQkJCiAJCQkJfQogCQkJCXR5cGUgPSBjdXJyZW50VHlw
ZTsKIAkJCX0gZWxzZSB7CkBAIC0zNzc4LDYgKzM3NjAsNzMgQEAKIAkJcmV0dXJuIHR5cGU7CiAJ
fQogCisJcHJpdmF0ZSBRdWFsaWZpZWRUeXBlIGdldFF1YWxpZmllZFR5cGVXaXRoU291cmNlQW5k
QmluZGluZyhUeXBlUmVmZXJlbmNlIHR5cGVSZWZlcmVuY2UsIGxvbmdbXSBwb3NpdGlvbnMsCisJ
CQlvcmcuZWNsaXBzZS5qZHQuaW50ZXJuYWwuY29tcGlsZXIuYXN0LkFubm90YXRpb25bXVtdIHR5
cGVBbm5vdGF0aW9ucywgY2hhcltdW10gdG9rZW5zLCBpbnQgaW5kZXgsCisJCQlUeXBlIHF1YWxp
ZmllcikgeworCQlTaW1wbGVOYW1lIHNpbXBsZU5hbWUgPSBjcmVhdGVTaW1wbGVOYW1lKHR5cGVS
ZWZlcmVuY2UsIHBvc2l0aW9ucywgdG9rZW5zLCBpbmRleCk7CisJCVF1YWxpZmllZFR5cGUgcXVh
bGlmaWVkVHlwZSA9IG5ldyBRdWFsaWZpZWRUeXBlKHRoaXMuYXN0KTsKKwkJcXVhbGlmaWVkVHlw
ZS5zZXRRdWFsaWZpZXIocXVhbGlmaWVyKTsKKwkJcXVhbGlmaWVkVHlwZS5zZXROYW1lKHNpbXBs
ZU5hbWUpOworCQlpbnQgc3RhcnQgPSBxdWFsaWZpZXIuZ2V0U3RhcnRQb3NpdGlvbigpOworCQlp
bnQgZW5kID0gc2ltcGxlTmFtZS5nZXRTdGFydFBvc2l0aW9uKCkgKyBzaW1wbGVOYW1lLmdldExl
bmd0aCgpIC0gMTsKKwkJc2V0U291cmNlQW5ub3RhdGlvbnNBbmRCaW5kaW5ncyh0eXBlUmVmZXJl
bmNlLCB0eXBlQW5ub3RhdGlvbnMsIGluZGV4LCBzdGFydCwgZW5kLCBxdWFsaWZpZWRUeXBlKTsK
KwkJcmV0dXJuIHF1YWxpZmllZFR5cGU7CisJfQorCisJcHJpdmF0ZSBTaW1wbGVUeXBlIGdldFNp
bXBsZVR5cGVXaXRoTmFtZUFuZEJpbmRpbmcoTmFtZSBuYW1lLCBUeXBlUmVmZXJlbmNlIHR5cGVS
ZWZlcmVuY2UsIGxvbmdbXSBwb3NpdGlvbnMsCisJCQlpbnQgc3RhcnRJbmRleCwgaW50IGVuZElu
ZGV4KSB7CisJCVNpbXBsZVR5cGUgc2ltcGxlVHlwZSA9IG5ldyBTaW1wbGVUeXBlKHRoaXMuYXN0
KTsKKwkJc2ltcGxlVHlwZS5zZXROYW1lKG5hbWUpOworCQlpbnQgc3RhcnQgPSAoaW50KShwb3Np
dGlvbnNbc3RhcnRJbmRleF0gPj4+IDMyKTsKKwkJaW50IGVuZCA9IChpbnQpcG9zaXRpb25zW2Vu
ZEluZGV4XTsKKwkJc2ltcGxlVHlwZS5zZXRTb3VyY2VSYW5nZShzdGFydCwgZW5kIC0gc3RhcnQg
KyAxKTsKKwkJaWYgKHRoaXMucmVzb2x2ZUJpbmRpbmdzKSB7CisJCQlyZWNvcmROb2RlcyhzaW1w
bGVUeXBlLCB0eXBlUmVmZXJlbmNlKTsKKwkJfQorCQlyZXR1cm4gc2ltcGxlVHlwZTsKKwl9CisK
Kwlwcml2YXRlIHZvaWQgc2V0U291cmNlQW5ub3RhdGlvbnNBbmRCaW5kaW5ncyhUeXBlUmVmZXJl
bmNlIHR5cGVSZWZlcmVuY2UsIAorCQkJb3JnLmVjbGlwc2UuamR0LmludGVybmFsLmNvbXBpbGVy
LmFzdC5Bbm5vdGF0aW9uW11bXSB0eXBlQW5ub3RhdGlvbnMsIGludCBpbmRleCwgaW50IHN0YXJ0
LCBpbnQgZW5kLAorCQkJQW5ub3RhdGFibGVUeXBlIGFubm90YXRhYmxlVHlwZSkgeworCQlvcmcu
ZWNsaXBzZS5qZHQuaW50ZXJuYWwuY29tcGlsZXIuYXN0LkFubm90YXRpb25bXSBhbm5vdGF0aW9u
czsKKwkJaW50IGFubm90YXRpb25zU3RhcnQgPSBzdGFydDsKKwkJaW50IGxlbmd0aCA9IGVuZCAt
IHN0YXJ0ICsgMTsKKwkJaWYgKHR5cGVBbm5vdGF0aW9ucyAhPSBudWxsICYmIChhbm5vdGF0aW9u
cyA9IHR5cGVBbm5vdGF0aW9uc1tpbmRleF0pICE9IG51bGwpIHsKKwkJCWFubm90YXRlVHlwZShh
bm5vdGF0YWJsZVR5cGUsIGFubm90YXRpb25zKTsKKwkJCWlmIChhbm5vdGF0aW9uc1swXSAhPSBu
dWxsICYmIChhbm5vdGF0aW9uc1N0YXJ0ID0gYW5ub3RhdGlvbnNbMF0uc291cmNlU3RhcnQpIDwg
c3RhcnQpIHsKKwkJCQlsZW5ndGggKz0gYW5ub3RhdGlvbnNTdGFydCA+IDAgPyBzdGFydCAtIGFu
bm90YXRpb25zU3RhcnQgOiAwOworCQkJCXN0YXJ0ID0gYW5ub3RhdGlvbnNTdGFydDsKKwkJCX0K
KwkJfQorCQlhbm5vdGF0YWJsZVR5cGUuc2V0U291cmNlUmFuZ2Uoc3RhcnQsIGxlbmd0aCk7CisJ
CWlmICh0aGlzLnJlc29sdmVCaW5kaW5ncykgeworCQkJcmVjb3JkTm9kZXMoYW5ub3RhdGFibGVU
eXBlLCB0eXBlUmVmZXJlbmNlKTsKKwkJfQorCX0KKworCXByaXZhdGUgdm9pZCBzZXRTb3VyY2VB
bm5vdGF0aW9uc0FuZEJpbmRpbmdzKFR5cGVSZWZlcmVuY2UgdHlwZVJlZmVyZW5jZSwgbG9uZ1td
IHBvc2l0aW9ucywKKwkJCW9yZy5lY2xpcHNlLmpkdC5pbnRlcm5hbC5jb21waWxlci5hc3QuQW5u
b3RhdGlvbltdW10gdHlwZUFubm90YXRpb25zLCBpbnQgaW5kZXgsIGludCBzdGFydEluZGV4LCBp
bnQgZW5kSW5kZXgsCisJCQlBbm5vdGF0YWJsZVR5cGUgYW5ub3RhdGFibGVUeXBlKSB7CisJCWlu
dCBzdGFydCA9IChpbnQpIChwb3NpdGlvbnNbc3RhcnRJbmRleF0gPj4+IDMyKTsKKwkJaW50IGVu
ZCA9IChpbnQpIHBvc2l0aW9uc1tlbmRJbmRleF07CisJCXNldFNvdXJjZUFubm90YXRpb25zQW5k
QmluZGluZ3ModHlwZVJlZmVyZW5jZSwgdHlwZUFubm90YXRpb25zLCBpbmRleCwgc3RhcnQsIGVu
ZCwgYW5ub3RhdGFibGVUeXBlKTsKKwl9CisKKwlwcml2YXRlIFNpbXBsZU5hbWUgY3JlYXRlU2lt
cGxlTmFtZShUeXBlUmVmZXJlbmNlIHR5cGVSZWZlcmVuY2UsIGxvbmdbXSBwb3NpdGlvbnMsIGNo
YXJbXVtdIHRva2VucywgaW50IGluZGV4KSB7CisJCWZpbmFsIFNpbXBsZU5hbWUgc2ltcGxlTmFt
ZSA9IG5ldyBTaW1wbGVOYW1lKHRoaXMuYXN0KTsKKwkJc2ltcGxlTmFtZS5pbnRlcm5hbFNldElk
ZW50aWZpZXIobmV3IFN0cmluZyh0b2tlbnNbaW5kZXhdKSk7CisJCXJlY29yZFBlbmRpbmdOYW1l
U2NvcGVSZXNvbHV0aW9uKHNpbXBsZU5hbWUpOworCQlpbnQgc3RhcnQgPSAoaW50KSAocG9zaXRp
b25zW2luZGV4XSA+Pj4gMzIpOworCQlpbnQgZW5kID0gKGludCkgcG9zaXRpb25zW2luZGV4XTsK
KwkJc2ltcGxlTmFtZS5zZXRTb3VyY2VSYW5nZShzdGFydCwgZW5kIC0gc3RhcnQgKyAxKTsKKwkJ
c2ltcGxlTmFtZS5pbmRleCA9IGluZGV4ICsgMTsKKwkJaWYgKHRoaXMucmVzb2x2ZUJpbmRpbmdz
KSB7CisJCQlyZWNvcmROb2RlcyhzaW1wbGVOYW1lLCB0eXBlUmVmZXJlbmNlKTsKKwkJfQorCQly
ZXR1cm4gc2ltcGxlTmFtZTsKKwl9CisKIAlwcm90ZWN0ZWQgQ29tbWVudCBjcmVhdGVDb21tZW50
KGludFtdIHBvc2l0aW9ucykgewogCQkvLyBDcmVhdGUgY29tbWVudCBub2RlCiAJCUNvbW1lbnQg
Y29tbWVudCA9IG51bGw7CmRpZmYgLS1naXQgYS9vcmcuZWNsaXBzZS5qZHQuY29yZS9kb20vb3Jn
L2VjbGlwc2UvamR0L2NvcmUvZG9tL0FTVE1hdGNoZXIuamF2YSBiL29yZy5lY2xpcHNlLmpkdC5j
b3JlL2RvbS9vcmcvZWNsaXBzZS9qZHQvY29yZS9kb20vQVNUTWF0Y2hlci5qYXZhCmluZGV4IGVi
MTNlYzYuLjBkZmM5OTAgMTAwNjQ0Ci0tLSBhL29yZy5lY2xpcHNlLmpkdC5jb3JlL2RvbS9vcmcv
ZWNsaXBzZS9qZHQvY29yZS9kb20vQVNUTWF0Y2hlci5qYXZhCisrKyBiL29yZy5lY2xpcHNlLmpk
dC5jb3JlL2RvbS9vcmcvZWNsaXBzZS9qZHQvY29yZS9kb20vQVNUTWF0Y2hlci5qYXZhCkBAIC0x
NTY5LDYgKzE1NjksMzEgQEAKIAkgKiBAcmV0dXJuIDxjb2RlPnRydWU8L2NvZGU+IGlmIHRoZSBz
dWJ0cmVlIG1hdGNoZXMsIG9yCiAJICogICA8Y29kZT5mYWxzZTwvY29kZT4gaWYgdGhleSBkbyBu
b3QgbWF0Y2ggb3IgdGhlIG90aGVyIG9iamVjdCBoYXMgYQogCSAqICAgZGlmZmVyZW50IG5vZGUg
dHlwZSBvciBpcyA8Y29kZT5udWxsPC9jb2RlPgorCSAqIEBzaW5jZSAzLjkKKwkgKi8KKwlwdWJs
aWMgYm9vbGVhbiBtYXRjaChQYWNrYWdlUXVhbGlmaWVkVHlwZSBub2RlLCBPYmplY3Qgb3RoZXIp
IHsKKwkJaWYgKCEob3RoZXIgaW5zdGFuY2VvZiBQYWNrYWdlUXVhbGlmaWVkVHlwZSkpIHsKKwkJ
CXJldHVybiBmYWxzZTsKKwkJfQorCQlQYWNrYWdlUXVhbGlmaWVkVHlwZSBvID0gKFBhY2thZ2VR
dWFsaWZpZWRUeXBlKSBvdGhlcjsKKwkJcmV0dXJuIHNhZmVTdWJ0cmVlTWF0Y2gobm9kZS5nZXRR
dWFsaWZpZXIoKSwgby5nZXRRdWFsaWZpZXIoKSkKKwkJCQkmJiBzYWZlU3VidHJlZUxpc3RNYXRj
aChub2RlLmFubm90YXRpb25zKCksIG8uYW5ub3RhdGlvbnMoKSkKKwkJCQkmJiBzYWZlU3VidHJl
ZU1hdGNoKG5vZGUuZ2V0TmFtZSgpLCBvLmdldE5hbWUoKSk7CisJfQorCisJLyoqCisJICogUmV0
dXJucyB3aGV0aGVyIHRoZSBnaXZlbiBub2RlIGFuZCB0aGUgb3RoZXIgb2JqZWN0IG1hdGNoLgor
CSAqIDxwPgorCSAqIFRoZSBkZWZhdWx0IGltcGxlbWVudGF0aW9uIHByb3ZpZGVkIGJ5IHRoaXMg
Y2xhc3MgdGVzdHMgd2hldGhlciB0aGUKKwkgKiBvdGhlciBvYmplY3QgaXMgYSBub2RlIG9mIHRo
ZSBzYW1lIHR5cGUgd2l0aCBzdHJ1Y3R1cmFsbHkgaXNvbW9ycGhpYworCSAqIGNoaWxkIHN1YnRy
ZWVzLiBTdWJjbGFzc2VzIG1heSBvdmVycmlkZSB0aGlzIG1ldGhvZCBhcyBuZWVkZWQuCisJICog
PC9wPgorCSAqCisJICogQHBhcmFtIG5vZGUgdGhlIG5vZGUKKwkgKiBAcGFyYW0gb3RoZXIgdGhl
IG90aGVyIG9iamVjdCwgb3IgPGNvZGU+bnVsbDwvY29kZT4KKwkgKiBAcmV0dXJuIDxjb2RlPnRy
dWU8L2NvZGU+IGlmIHRoZSBzdWJ0cmVlIG1hdGNoZXMsIG9yCisJICogICA8Y29kZT5mYWxzZTwv
Y29kZT4gaWYgdGhleSBkbyBub3QgbWF0Y2ggb3IgdGhlIG90aGVyIG9iamVjdCBoYXMgYQorCSAq
ICAgZGlmZmVyZW50IG5vZGUgdHlwZSBvciBpcyA8Y29kZT5udWxsPC9jb2RlPgogCSAqIEBzaW5j
ZSAzLjEKIAkgKi8KIAlwdWJsaWMgYm9vbGVhbiBtYXRjaChQYXJhbWV0ZXJpemVkVHlwZSBub2Rl
LCBPYmplY3Qgb3RoZXIpIHsKZGlmZiAtLWdpdCBhL29yZy5lY2xpcHNlLmpkdC5jb3JlL2RvbS9v
cmcvZWNsaXBzZS9qZHQvY29yZS9kb20vQVNUTm9kZS5qYXZhIGIvb3JnLmVjbGlwc2UuamR0LmNv
cmUvZG9tL29yZy9lY2xpcHNlL2pkdC9jb3JlL2RvbS9BU1ROb2RlLmphdmEKaW5kZXggZjdkYzkw
Yy4uZDViMjI0MyAxMDA2NDQKLS0tIGEvb3JnLmVjbGlwc2UuamR0LmNvcmUvZG9tL29yZy9lY2xp
cHNlL2pkdC9jb3JlL2RvbS9BU1ROb2RlLmphdmEKKysrIGIvb3JnLmVjbGlwc2UuamR0LmNvcmUv
ZG9tL29yZy9lY2xpcHNlL2pkdC9jb3JlL2RvbS9BU1ROb2RlLmphdmEKQEAgLTg1MSw2ICs4NTEs
MTQgQEAKIAlwdWJsaWMgc3RhdGljIGZpbmFsIGludCBMQU1CREFfRVhQUkVTU0lPTiA9IDg2Owog
CiAJLyoqCisJICogTm9kZSB0eXBlIGNvbnN0YW50IGluZGljYXRpbmcgYSBub2RlIG9mIHR5cGUK
KwkgKiA8Y29kZT5RdWFsaWZpZWRUeXBlPC9jb2RlPi4KKwkgKiBAc2VlIFF1YWxpZmllZFR5cGUK
KwkgKiBAc2luY2UgMy45CisJICovCisJcHVibGljIHN0YXRpYyBmaW5hbCBpbnQgUEFDS0FHRV9R
VUFMSUZJRURfVFlQRSA9IDg3OworCisJLyoqCiAJICogUmV0dXJucyB0aGUgbm9kZSBjbGFzcyBm
b3IgdGhlIGNvcnJlc3BvbmRpbmcgbm9kZSB0eXBlLgogCSAqCiAJICogQHBhcmFtIG5vZGVUeXBl
IEFTVCBub2RlIHR5cGUKQEAgLTk2OCw2ICs5NzYsOCBAQAogCQkJCXJldHVybiBOdW1iZXJMaXRl
cmFsLmNsYXNzOwogCQkJY2FzZSBQQUNLQUdFX0RFQ0xBUkFUSU9OIDoKIAkJCQlyZXR1cm4gUGFj
a2FnZURlY2xhcmF0aW9uLmNsYXNzOworCQkJY2FzZSBQQUNLQUdFX1FVQUxJRklFRF9UWVBFIDoK
KwkJCQlyZXR1cm4gUGFja2FnZVF1YWxpZmllZFR5cGUuY2xhc3M7CiAJCQljYXNlIFBBUkFNRVRF
UklaRURfVFlQRSA6CiAJCQkJcmV0dXJuIFBhcmFtZXRlcml6ZWRUeXBlLmNsYXNzOwogCQkJY2Fz
ZSBQQVJFTlRIRVNJWkVEX0VYUFJFU1NJT04gOgpkaWZmIC0tZ2l0IGEvb3JnLmVjbGlwc2UuamR0
LmNvcmUvZG9tL29yZy9lY2xpcHNlL2pkdC9jb3JlL2RvbS9BU1RWaXNpdG9yLmphdmEgYi9vcmcu
ZWNsaXBzZS5qZHQuY29yZS9kb20vb3JnL2VjbGlwc2UvamR0L2NvcmUvZG9tL0FTVFZpc2l0b3Iu
amF2YQppbmRleCA0NDJjMmQyLi4xNDk5ZjBiIDEwMDY0NAotLS0gYS9vcmcuZWNsaXBzZS5qZHQu
Y29yZS9kb20vb3JnL2VjbGlwc2UvamR0L2NvcmUvZG9tL0FTVFZpc2l0b3IuamF2YQorKysgYi9v
cmcuZWNsaXBzZS5qZHQuY29yZS9kb20vb3JnL2VjbGlwc2UvamR0L2NvcmUvZG9tL0FTVFZpc2l0
b3IuamF2YQpAQCAtMTA3Miw2ICsxMDcyLDIzIEBACiAJICogQHJldHVybiA8Y29kZT50cnVlPC9j
b2RlPiBpZiB0aGUgY2hpbGRyZW4gb2YgdGhpcyBub2RlIHNob3VsZCBiZQogCSAqIHZpc2l0ZWQs
IGFuZCA8Y29kZT5mYWxzZTwvY29kZT4gaWYgdGhlIGNoaWxkcmVuIG9mIHRoaXMgbm9kZSBzaG91
bGQKIAkgKiBiZSBza2lwcGVkCisJICogQHNpbmNlIDMuOQorCSAqLworCXB1YmxpYyBib29sZWFu
IHZpc2l0KFBhY2thZ2VRdWFsaWZpZWRUeXBlIG5vZGUpIHsKKwkJcmV0dXJuIHRydWU7CisJfQor
CisJLyoqCisJICogVmlzaXRzIHRoZSBnaXZlbiB0eXBlLXNwZWNpZmljIEFTVCBub2RlLgorCSAq
IDxwPgorCSAqIFRoZSBkZWZhdWx0IGltcGxlbWVudGF0aW9uIGRvZXMgbm90aGluZyBhbmQgcmV0
dXJuIHRydWUuCisJICogU3ViY2xhc3NlcyBtYXkgcmVpbXBsZW1lbnQuCisJICogPC9wPgorCSAq
CisJICogQHBhcmFtIG5vZGUgdGhlIG5vZGUgdG8gdmlzaXQKKwkgKiBAcmV0dXJuIDxjb2RlPnRy
dWU8L2NvZGU+IGlmIHRoZSBjaGlsZHJlbiBvZiB0aGlzIG5vZGUgc2hvdWxkIGJlCisJICogdmlz
aXRlZCwgYW5kIDxjb2RlPmZhbHNlPC9jb2RlPiBpZiB0aGUgY2hpbGRyZW4gb2YgdGhpcyBub2Rl
IHNob3VsZAorCSAqIGJlIHNraXBwZWQKIAkgKiBAc2luY2UgMy4xCiAJICovCiAJcHVibGljIGJv
b2xlYW4gdmlzaXQoUGFyYW1ldGVyaXplZFR5cGUgbm9kZSkgewpAQCAtMjI3NCw2ICsyMjkxLDE5
IEBACiAJICogPC9wPgogCSAqCiAJICogQHBhcmFtIG5vZGUgdGhlIG5vZGUgdG8gdmlzaXQKKwkg
KiBAc2luY2UgMy45CisJICovCisJcHVibGljIHZvaWQgZW5kVmlzaXQoUGFja2FnZVF1YWxpZmll
ZFR5cGUgbm9kZSkgeworCQkvLyBkZWZhdWx0IGltcGxlbWVudGF0aW9uOiBkbyBub3RoaW5nCisJ
fQorCisJLyoqCisJICogRW5kIG9mIHZpc2l0IHRoZSBnaXZlbiB0eXBlLXNwZWNpZmljIEFTVCBu
b2RlLgorCSAqIDxwPgorCSAqIFRoZSBkZWZhdWx0IGltcGxlbWVudGF0aW9uIGRvZXMgbm90aGlu
Zy4gU3ViY2xhc3NlcyBtYXkgcmVpbXBsZW1lbnQuCisJICogPC9wPgorCSAqCisJICogQHBhcmFt
IG5vZGUgdGhlIG5vZGUgdG8gdmlzaXQKIAkgKiBAc2luY2UgMy4xCiAJICovCiAJcHVibGljIHZv
aWQgZW5kVmlzaXQoUGFyYW1ldGVyaXplZFR5cGUgbm9kZSkgewpkaWZmIC0tZ2l0IGEvb3JnLmVj
bGlwc2UuamR0LmNvcmUvZG9tL29yZy9lY2xpcHNlL2pkdC9jb3JlL2RvbS9QYWNrYWdlUXVhbGlm
aWVkVHlwZS5qYXZhIGIvb3JnLmVjbGlwc2UuamR0LmNvcmUvZG9tL29yZy9lY2xpcHNlL2pkdC9j
b3JlL2RvbS9QYWNrYWdlUXVhbGlmaWVkVHlwZS5qYXZhCm5ldyBmaWxlIG1vZGUgMTAwNjQ0Cmlu
ZGV4IDAwMDAwMDAuLjliZGRkOWMKLS0tIC9kZXYvbnVsbAorKysgYi9vcmcuZWNsaXBzZS5qZHQu
Y29yZS9kb20vb3JnL2VjbGlwc2UvamR0L2NvcmUvZG9tL1BhY2thZ2VRdWFsaWZpZWRUeXBlLmph
dmEKQEAgLTAsMCArMSwyODYgQEAKKy8qKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioq
KioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqCisgKiBDb3B5cmln
aHQgKGMpIDIwMDMsIDIwMTMgSUJNIENvcnBvcmF0aW9uIGFuZCBvdGhlcnMuCisgKiBBbGwgcmln
aHRzIHJlc2VydmVkLiBUaGlzIHByb2dyYW0gYW5kIHRoZSBhY2NvbXBhbnlpbmcgbWF0ZXJpYWxz
CisgKiBhcmUgbWFkZSBhdmFpbGFibGUgdW5kZXIgdGhlIHRlcm1zIG9mIHRoZSBFY2xpcHNlIFB1
YmxpYyBMaWNlbnNlIHYxLjAKKyAqIHdoaWNoIGFjY29tcGFuaWVzIHRoaXMgZGlzdHJpYnV0aW9u
LCBhbmQgaXMgYXZhaWxhYmxlIGF0CisgKiBodHRwOi8vd3d3LmVjbGlwc2Uub3JnL2xlZ2FsL2Vw
bC12MTAuaHRtbAorICoKKyAqIFRoaXMgaXMgYW4gaW1wbGVtZW50YXRpb24gb2YgYW4gZWFybHkt
ZHJhZnQgc3BlY2lmaWNhdGlvbiBkZXZlbG9wZWQgdW5kZXIgdGhlIEphdmEKKyAqIENvbW11bml0
eSBQcm9jZXNzIChKQ1ApIGFuZCBpcyBtYWRlIGF2YWlsYWJsZSBmb3IgdGVzdGluZyBhbmQgZXZh
bHVhdGlvbiBwdXJwb3NlcworICogb25seS4gVGhlIGNvZGUgaXMgbm90IGNvbXBhdGlibGUgd2l0
aCBhbnkgc3BlY2lmaWNhdGlvbiBvZiB0aGUgSkNQLgorICogCisgKiBDb250cmlidXRvcnM6Cisg
KiAgICAgSUJNIENvcnBvcmF0aW9uIC0gaW5pdGlhbCBBUEkgYW5kIGltcGxlbWVudGF0aW9uCisg
KioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioq
KioqKioqKioqKioqKioqKioqKioqKi8KKworcGFja2FnZSBvcmcuZWNsaXBzZS5qZHQuY29yZS5k
b207CisKK2ltcG9ydCBqYXZhLnV0aWwuQXJyYXlMaXN0OworaW1wb3J0IGphdmEudXRpbC5MaXN0
OworCisvKioKKyAqIE5vZGUgZm9yIGEgcGFja2FnZSBxdWFsaWZpZWQgdHlwZSAoYWRkZWQgaW4g
SkxTOCBBUEkpLgorICogCisgKiA8cHJlPgorICogUGFja2FnZVF1YWxpZmllZFR5cGU6CisgKiAg
ICBOYW1lIDxiPi48L2I+IHsgQW5ub3RhdGlvbiB9IFNpbXBsZU5hbWUKKyAqIDwvcHJlPgorICoK
KyAqIEBzaW5jZSAzLjkKKyAqIEBub2luc3RhbnRpYXRlIFRoaXMgY2xhc3MgaXMgbm90IGludGVu
ZGVkIHRvIGJlIGluc3RhbnRpYXRlZCBieSBjbGllbnRzLgorICovCitwdWJsaWMgY2xhc3MgUGFj
a2FnZVF1YWxpZmllZFR5cGUgZXh0ZW5kcyBBbm5vdGF0YWJsZVR5cGUgeworCisJLyoqCisJICog
VGhlICJxdWFsaWZpZXIiIHN0cnVjdHVyYWwgcHJvcGVydHkgb2YgdGhpcyBub2RlIHR5cGUgKGNo
aWxkIHR5cGU6IHtAbGluayBOYW1lfSkuCisJICovCisJcHVibGljIHN0YXRpYyBmaW5hbCBDaGls
ZFByb3BlcnR5RGVzY3JpcHRvciBRVUFMSUZJRVJfUFJPUEVSVFkgPQorCQluZXcgQ2hpbGRQcm9w
ZXJ0eURlc2NyaXB0b3IoUGFja2FnZVF1YWxpZmllZFR5cGUuY2xhc3MsICJxdWFsaWZpZXIiLCBO
YW1lLmNsYXNzLCBNQU5EQVRPUlksIE5PX0NZQ0xFX1JJU0spOyAvLyROT04tTkxTLTEkCisKKwkv
KioKKwkgKiBUaGUgImFubm90YXRpb25zIiBzdHJ1Y3R1cmFsIHByb3BlcnR5IG9mIHRoaXMgbm9k
ZSB0eXBlIChlbGVtZW50IHR5cGU6IHtAbGluayBBbm5vdGF0aW9ufSkuCisJICogQHNpbmNlIDMu
OQorCSAqLworCXB1YmxpYyBzdGF0aWMgZmluYWwgQ2hpbGRMaXN0UHJvcGVydHlEZXNjcmlwdG9y
IEFOTk9UQVRJT05TX1BST1BFUlRZID0KKwkJCWludGVybmFsQW5ub3RhdGlvbnNQcm9wZXJ0eUZh
Y3RvcnkoUGFja2FnZVF1YWxpZmllZFR5cGUuY2xhc3MpOworCQorCS8qKgorCSAqIFRoZSAibmFt
ZSIgc3RydWN0dXJhbCBwcm9wZXJ0eSBvZiB0aGlzIG5vZGUgdHlwZSAoY2hpbGQgdHlwZToge0Bs
aW5rIFNpbXBsZU5hbWV9KS4KKwkgKi8KKwlwdWJsaWMgc3RhdGljIGZpbmFsIENoaWxkUHJvcGVy
dHlEZXNjcmlwdG9yIE5BTUVfUFJPUEVSVFkgPQorCQluZXcgQ2hpbGRQcm9wZXJ0eURlc2NyaXB0
b3IoUGFja2FnZVF1YWxpZmllZFR5cGUuY2xhc3MsICJuYW1lIiwgU2ltcGxlTmFtZS5jbGFzcywg
TUFOREFUT1JZLCBOT19DWUNMRV9SSVNLKTsgLy8kTk9OLU5MUy0xJAorCQorCS8qKgorCSAqIEEg
bGlzdCBvZiBwcm9wZXJ0eSBkZXNjcmlwdG9ycyAoZWxlbWVudCB0eXBlOgorCSAqIHtAbGluayBT
dHJ1Y3R1cmFsUHJvcGVydHlEZXNjcmlwdG9yfSksCisJICogb3IgbnVsbCBpZiB1bmluaXRpYWxp
emVkLgorCSAqLworCXByaXZhdGUgc3RhdGljIGZpbmFsIExpc3QgUFJPUEVSVFlfREVTQ1JJUFRP
UlM7CisKKwlzdGF0aWMgeworCQlMaXN0IHByb3BlcnR5TGlzdCA9IG5ldyBBcnJheUxpc3QoNCk7
CisJCWNyZWF0ZVByb3BlcnR5TGlzdChQYWNrYWdlUXVhbGlmaWVkVHlwZS5jbGFzcywgcHJvcGVy
dHlMaXN0KTsKKwkJYWRkUHJvcGVydHkoUVVBTElGSUVSX1BST1BFUlRZLCBwcm9wZXJ0eUxpc3Qp
OworCQlhZGRQcm9wZXJ0eShBTk5PVEFUSU9OU19QUk9QRVJUWSwgcHJvcGVydHlMaXN0KTsKKwkJ
YWRkUHJvcGVydHkoTkFNRV9QUk9QRVJUWSwgcHJvcGVydHlMaXN0KTsKKwkJUFJPUEVSVFlfREVT
Q1JJUFRPUlMgPSByZWFwUHJvcGVydHlMaXN0KHByb3BlcnR5TGlzdCk7CisJfQorCisJLyoqCisJ
ICogUmV0dXJucyBhIGxpc3Qgb2Ygc3RydWN0dXJhbCBwcm9wZXJ0eSBkZXNjcmlwdG9ycyBmb3Ig
dGhpcyBub2RlIHR5cGUuCisJICogQ2xpZW50cyBtdXN0IG5vdCBtb2RpZnkgdGhlIHJlc3VsdC4K
KwkgKgorCSAqIEBwYXJhbSBhcGlMZXZlbCB0aGUgQVBJIGxldmVsOyBvbmUgb2YgdGhlCisJICog
PGNvZGU+QVNULkpMUyo8L2NvZGU+IGNvbnN0YW50cworCSAqIEByZXR1cm4gYSBsaXN0IG9mIHBy
b3BlcnR5IGRlc2NyaXB0b3JzIChlbGVtZW50IHR5cGU6CisJICoge0BsaW5rIFN0cnVjdHVyYWxQ
cm9wZXJ0eURlc2NyaXB0b3J9KQorCSAqLworCXB1YmxpYyBzdGF0aWMgTGlzdCBwcm9wZXJ0eURl
c2NyaXB0b3JzKGludCBhcGlMZXZlbCkgeworCQlyZXR1cm4gUFJPUEVSVFlfREVTQ1JJUFRPUlM7
CisJfQorCisJLyoqCisJICogVGhlIHF1YWxpZmllciBub2RlOyBsYXppbHkgaW5pdGlhbGl6ZWQ7
IGRlZmF1bHRzIHRvIAorCSAqIGFuIHVuc3BlY2lmaWVkLCBidXQgbGVnYWwsIHNpbXBsZSBuYW1l
LgorCSAqLworCXByaXZhdGUgTmFtZSBxdWFsaWZpZXIgPSBudWxsOworCisJLyoqCisJICogVGhl
IG5hbWUgYmVpbmcgcXVhbGlmaWVkOyBsYXppbHkgaW5pdGlhbGl6ZWQ7IGRlZmF1bHRzIHRvIGEg
dW5zcGVjaWZpZWQsCisJICogbGVnYWwgSmF2YSBpZGVudGlmaWVyLgorCSAqLworCXByaXZhdGUg
U2ltcGxlTmFtZSBuYW1lID0gbnVsbDsKKworCS8qKgorCSAqIENyZWF0ZXMgYSBuZXcgdW5wYXJl
bnRlZCBub2RlIGZvciBhIHBhY2thZ2UgcXVhbGlmaWVkIHR5cGUgb3duZWQgYnkgdGhlCisJICog
Z2l2ZW4gQVNULiBCeSBkZWZhdWx0LCBhbiB1bnNwZWNpZmllZCwgYnV0IGxlZ2FsLCBxdWFsaWZp
ZXIgYW5kIG5hbWUuCisJICogPHA+CisJICogTi5CLiBUaGlzIGNvbnN0cnVjdG9yIGlzIHBhY2th
Z2UtcHJpdmF0ZS4KKwkgKiA8L3A+CisJICoKKwkgKiBAcGFyYW0gYXN0IHRoZSBBU1QgdGhhdCBp
cyB0byBvd24gdGhpcyBub2RlCisJICovCisJUGFja2FnZVF1YWxpZmllZFR5cGUoQVNUIGFzdCkg
eworCQlzdXBlcihhc3QpOworCSAgICB1bnN1cHBvcnRlZEluMl8zXzQoKTsKKwl9CisKKwkvKiAo
b21pdCBqYXZhZG9jIGZvciB0aGlzIG1ldGhvZCkKKwkgKiBNZXRob2QgZGVjbGFyZWQgb24gQW5u
b3RhdGFibGVUeXBlLgorCSAqLworCUNoaWxkTGlzdFByb3BlcnR5RGVzY3JpcHRvciBpbnRlcm5h
bEFubm90YXRpb25zUHJvcGVydHkoKSB7CisJCXJldHVybiBBTk5PVEFUSU9OU19QUk9QRVJUWTsK
Kwl9CisKKwkvKiAob21pdCBqYXZhZG9jIGZvciB0aGlzIG1ldGhvZCkKKwkgKiBNZXRob2QgZGVj
bGFyZWQgb24gQVNUTm9kZS4KKwkgKi8KKwlMaXN0IGludGVybmFsU3RydWN0dXJhbFByb3BlcnRp
ZXNGb3JUeXBlKGludCBhcGlMZXZlbCkgeworCQlyZXR1cm4gcHJvcGVydHlEZXNjcmlwdG9ycyhh
cGlMZXZlbCk7CisJfQorCisJLyogKG9taXQgamF2YWRvYyBmb3IgdGhpcyBtZXRob2QpCisJICog
TWV0aG9kIGRlY2xhcmVkIG9uIEFTVE5vZGUuCisJICovCisJZmluYWwgTGlzdCBpbnRlcm5hbEdl
dENoaWxkTGlzdFByb3BlcnR5KENoaWxkTGlzdFByb3BlcnR5RGVzY3JpcHRvciBwcm9wZXJ0eSkg
eworCQlpZiAocHJvcGVydHkgPT0gQU5OT1RBVElPTlNfUFJPUEVSVFkpIHsKKwkJCXJldHVybiBh
bm5vdGF0aW9ucygpOworCQl9CisJCS8vIGFsbG93IGRlZmF1bHQgaW1wbGVtZW50YXRpb24gdG8g
ZmxhZyB0aGUgZXJyb3IKKwkJcmV0dXJuIHN1cGVyLmludGVybmFsR2V0Q2hpbGRMaXN0UHJvcGVy
dHkocHJvcGVydHkpOworCX0KKwkKKwkvKiAob21pdCBqYXZhZG9jIGZvciB0aGlzIG1ldGhvZCkK
KwkgKiBNZXRob2QgZGVjbGFyZWQgb24gQVNUTm9kZS4KKwkgKi8KKwlmaW5hbCBBU1ROb2RlIGlu
dGVybmFsR2V0U2V0Q2hpbGRQcm9wZXJ0eShDaGlsZFByb3BlcnR5RGVzY3JpcHRvciBwcm9wZXJ0
eSwgYm9vbGVhbiBnZXQsIEFTVE5vZGUgY2hpbGQpIHsKKwkJaWYgKHByb3BlcnR5ID09IFFVQUxJ
RklFUl9QUk9QRVJUWSkgeworCQkJaWYgKGdldCkgeworCQkJCXJldHVybiBnZXRRdWFsaWZpZXIo
KTsKKwkJCX0gZWxzZSB7CisJCQkJc2V0UXVhbGlmaWVyKChOYW1lKSBjaGlsZCk7CisJCQkJcmV0
dXJuIG51bGw7CisJCQl9CisJCX0KKwkJaWYgKHByb3BlcnR5ID09IE5BTUVfUFJPUEVSVFkpIHsK
KwkJCWlmIChnZXQpIHsKKwkJCQlyZXR1cm4gZ2V0TmFtZSgpOworCQkJfSBlbHNlIHsKKwkJCQlz
ZXROYW1lKChTaW1wbGVOYW1lKSBjaGlsZCk7CisJCQkJcmV0dXJuIG51bGw7CisJCQl9CisJCX0K
KwkJLy8gYWxsb3cgZGVmYXVsdCBpbXBsZW1lbnRhdGlvbiB0byBmbGFnIHRoZSBlcnJvcgorCQly
ZXR1cm4gc3VwZXIuaW50ZXJuYWxHZXRTZXRDaGlsZFByb3BlcnR5KHByb3BlcnR5LCBnZXQsIGNo
aWxkKTsKKwl9CisKKwlpbnQgZ2V0Tm9kZVR5cGUwKCkgeworCQlyZXR1cm4gUEFDS0FHRV9RVUFM
SUZJRURfVFlQRTsKKwl9CisKKwlib29sZWFuIHN1YnRyZWVNYXRjaDAoQVNUTWF0Y2hlciBtYXRj
aGVyLCBPYmplY3Qgb3RoZXIpIHsKKwkJLy8gZGlzcGF0Y2ggdG8gY29ycmVjdCBvdmVybG9hZGVk
IG1hdGNoIG1ldGhvZAorCQlyZXR1cm4gbWF0Y2hlci5tYXRjaCh0aGlzLCBvdGhlcik7CisJfQor
CisJQVNUTm9kZSBjbG9uZTAoQVNUIHRhcmdldCkgeworCQlQYWNrYWdlUXVhbGlmaWVkVHlwZSBy
ZXN1bHQgPSBuZXcgUGFja2FnZVF1YWxpZmllZFR5cGUodGFyZ2V0KTsKKwkJcmVzdWx0LnNldFNv
dXJjZVJhbmdlKGdldFN0YXJ0UG9zaXRpb24oKSwgZ2V0TGVuZ3RoKCkpOworCQlyZXN1bHQuc2V0
UXVhbGlmaWVyKChOYW1lKSAoKEFTVE5vZGUpIGdldFF1YWxpZmllcigpKS5jbG9uZSh0YXJnZXQp
KTsKKwkJcmVzdWx0LmFubm90YXRpb25zKCkuYWRkQWxsKEFTVE5vZGUuY29weVN1YnRyZWVzKHRh
cmdldCwgYW5ub3RhdGlvbnMoKSkpOworCQlyZXN1bHQuc2V0TmFtZSgoU2ltcGxlTmFtZSkgKChB
U1ROb2RlKSBnZXROYW1lKCkpLmNsb25lKHRhcmdldCkpOworCQlyZXR1cm4gcmVzdWx0OworCX0K
KworCS8qIChvbWl0IGphdmFkb2MgZm9yIHRoaXMgbWV0aG9kKQorCSAqIE1ldGhvZCBkZWNsYXJl
ZCBvbiBBU1ROb2RlLgorCSAqLworCXZvaWQgYWNjZXB0MChBU1RWaXNpdG9yIHZpc2l0b3IpIHsK
KwkJYm9vbGVhbiB2aXNpdENoaWxkcmVuID0gdmlzaXRvci52aXNpdCh0aGlzKTsKKwkJaWYgKHZp
c2l0Q2hpbGRyZW4pIHsKKwkJCS8vIHZpc2l0IGNoaWxkcmVuIGluIG5vcm1hbCBsZWZ0IHRvIHJp
Z2h0IHJlYWRpbmcgb3JkZXIKKwkJCWFjY2VwdENoaWxkKHZpc2l0b3IsIGdldFF1YWxpZmllcigp
KTsKKwkJCWFjY2VwdENoaWxkcmVuKHZpc2l0b3IsIHRoaXMuYW5ub3RhdGlvbnMpOworCQkJYWNj
ZXB0Q2hpbGQodmlzaXRvciwgZ2V0TmFtZSgpKTsKKwkJfQorCQl2aXNpdG9yLmVuZFZpc2l0KHRo
aXMpOworCX0KKworCS8qKgorCSAqIFJldHVybnMgdGhlIHF1YWxpZmllciBvZiB0aGlzIHBhY2th
Z2UgcXVhbGlmaWVkIHR5cGUuCisJICoKKwkgKiBAcmV0dXJuIHRoZSBxdWFsaWZpZXIgb2YgdGhp
cyBwYWNrYWdlIHF1YWxpZmllZCB0eXBlCisJICovCisJcHVibGljIE5hbWUgZ2V0UXVhbGlmaWVy
KCkgeworCQlpZiAodGhpcy5xdWFsaWZpZXIgPT0gbnVsbCkgeworCQkJLy8gbGF6eSBpbml0IG11
c3QgYmUgdGhyZWFkLXNhZmUgZm9yIHJlYWRlcnMKKwkJCXN5bmNocm9uaXplZCAodGhpcykgewor
CQkJCWlmICh0aGlzLnF1YWxpZmllciA9PSBudWxsKSB7CisJCQkJCXByZUxhenlJbml0KCk7CisJ
CQkJCXRoaXMucXVhbGlmaWVyID0gbmV3IFNpbXBsZU5hbWUodGhpcy5hc3QpOworCQkJCQlwb3N0
TGF6eUluaXQodGhpcy5xdWFsaWZpZXIsIFFVQUxJRklFUl9QUk9QRVJUWSk7CisJCQkJfQorCQkJ
fQorCQl9CisJCXJldHVybiB0aGlzLnF1YWxpZmllcjsKKwl9CisKKwkvKioKKwkgKiBTZXRzIHRo
ZSBxdWFsaWZpZXIgb2YgdGhpcyBwYWNrYWdlIHF1YWxpZmllZCB0eXBlIHRvIHRoZSBnaXZlbiBu
YW1lLgorCSAqCisJICogQHBhcmFtIG5hbWUgdGhlIG5ldyBxdWFsaWZpZXIgb2YgdGhpcyBwYWNr
YWdlIHF1YWxpZmllZCB0eXBlCisJICogQGV4Y2VwdGlvbiBJbGxlZ2FsQXJndW1lbnRFeGNlcHRp
b24gaWY6CisJICogPHVsPgorCSAqIDxsaT50aGUgbm9kZSBiZWxvbmdzIHRvIGEgZGlmZmVyZW50
IEFTVDwvbGk+CisJICogPGxpPnRoZSBub2RlIGFscmVhZHkgaGFzIGEgcGFyZW50PC9saT4KKwkg
KiA8L3VsPgorCSAqLworCXB1YmxpYyB2b2lkIHNldFF1YWxpZmllcihOYW1lIG5hbWUpIHsKKwkJ
aWYgKG5hbWUgPT0gbnVsbCkgeworCQkJdGhyb3cgbmV3IElsbGVnYWxBcmd1bWVudEV4Y2VwdGlv
bigpOworCQl9CisJCUFTVE5vZGUgb2xkQ2hpbGQgPSB0aGlzLnF1YWxpZmllcjsKKwkJcHJlUmVw
bGFjZUNoaWxkKG9sZENoaWxkLCBuYW1lLCBRVUFMSUZJRVJfUFJPUEVSVFkpOworCQl0aGlzLnF1
YWxpZmllciA9IG5hbWU7CisJCXBvc3RSZXBsYWNlQ2hpbGQob2xkQ2hpbGQsIG5hbWUsIFFVQUxJ
RklFUl9QUk9QRVJUWSk7CisJfQorCisJLyoqCisJICogUmV0dXJucyB0aGUgbmFtZSBwYXJ0IG9m
IHRoaXMgcGFja2FnZSBxdWFsaWZpZWQgdHlwZS4KKwkgKgorCSAqIEByZXR1cm4gdGhlIG5hbWUg
YmVpbmcgcXVhbGlmaWVkCisJICovCisJcHVibGljIFNpbXBsZU5hbWUgZ2V0TmFtZSgpIHsKKwkJ
aWYgKHRoaXMubmFtZSA9PSBudWxsKSB7CisJCQkvLyBsYXp5IGluaXQgbXVzdCBiZSB0aHJlYWQt
c2FmZSBmb3IgcmVhZGVycworCQkJc3luY2hyb25pemVkICh0aGlzKSB7CisJCQkJaWYgKHRoaXMu
bmFtZSA9PSBudWxsKSB7CisJCQkJCXByZUxhenlJbml0KCk7CisJCQkJCXRoaXMubmFtZSA9IG5l
dyBTaW1wbGVOYW1lKHRoaXMuYXN0KTsKKwkJCQkJcG9zdExhenlJbml0KHRoaXMubmFtZSwgTkFN
RV9QUk9QRVJUWSk7CisJCQkJfQorCQkJfQorCQl9CisJCXJldHVybiB0aGlzLm5hbWU7CisJfQor
CisJLyoqCisJICogU2V0cyB0aGUgbmFtZSBwYXJ0IG9mIHRoaXMgcGFja2FnZSBxdWFsaWZpZWQg
dHlwZSB0byB0aGUgZ2l2ZW4gc2ltcGxlIG5hbWUuCisJICoKKwkgKiBAcGFyYW0gbmFtZSB0aGUg
aWRlbnRpZmllciBvZiB0aGlzIHF1YWxpZmllZCBuYW1lCisJICogQGV4Y2VwdGlvbiBJbGxlZ2Fs
QXJndW1lbnRFeGNlcHRpb24gaWY6CisJICogPHVsPgorCSAqIDxsaT50aGUgbm9kZSBiZWxvbmdz
IHRvIGEgZGlmZmVyZW50IEFTVDwvbGk+CisJICogPGxpPnRoZSBub2RlIGFscmVhZHkgaGFzIGEg
cGFyZW50PC9saT4KKwkgKiA8L3VsPgorCSAqLworCXB1YmxpYyB2b2lkIHNldE5hbWUoU2ltcGxl
TmFtZSBuYW1lKSB7CisJCWlmIChuYW1lID09IG51bGwpIHsKKwkJCXRocm93IG5ldyBJbGxlZ2Fs
QXJndW1lbnRFeGNlcHRpb24oKTsKKwkJfQorCQlBU1ROb2RlIG9sZENoaWxkID0gdGhpcy5uYW1l
OworCQlwcmVSZXBsYWNlQ2hpbGQob2xkQ2hpbGQsIG5hbWUsIE5BTUVfUFJPUEVSVFkpOworCQl0
aGlzLm5hbWUgPSBuYW1lOworCQlwb3N0UmVwbGFjZUNoaWxkKG9sZENoaWxkLCBuYW1lLCBOQU1F
X1BST1BFUlRZKTsKKwl9CisKKwkvKiAob21pdCBqYXZhZG9jIGZvciB0aGlzIG1ldGhvZCkKKwkg
KiBNZXRob2QgZGVjbGFyZWQgb24gQVNUTm9kZS4KKwkgKi8KKwlpbnQgbWVtU2l6ZSgpIHsKKwkJ
Ly8gdHJlYXQgQ29kZSBhcyBmcmVlCisJCXJldHVybiBCQVNFX05PREVfU0laRSArIDIgKiA0Owor
CX0KKworCS8qIChvbWl0IGphdmFkb2MgZm9yIHRoaXMgbWV0aG9kKQorCSAqIE1ldGhvZCBkZWNs
YXJlZCBvbiBBU1ROb2RlLgorCSAqLworCWludCB0cmVlU2l6ZSgpIHsKKwkJcmV0dXJuCisJCQlt
ZW1TaXplKCkKKwkJCSsgKHRoaXMucXVhbGlmaWVyID09IG51bGwgPyAwIDogZ2V0UXVhbGlmaWVy
KCkudHJlZVNpemUoKSkKKwkJCSsgKHRoaXMuYW5ub3RhdGlvbnMgPT0gbnVsbCA/IDAgOiB0aGlz
LmFubm90YXRpb25zLmxpc3RTaXplKCkpCisJCQkrICh0aGlzLm5hbWUgPT0gbnVsbCA/IDAgOiBn
ZXROYW1lKCkudHJlZVNpemUoKSk7CisJfQorCit9CmRpZmYgLS1naXQgYS9vcmcuZWNsaXBzZS5q
ZHQuY29yZS9kb20vb3JnL2VjbGlwc2UvamR0L2ludGVybmFsL2NvcmUvZG9tL05haXZlQVNURmxh
dHRlbmVyLmphdmEgYi9vcmcuZWNsaXBzZS5qZHQuY29yZS9kb20vb3JnL2VjbGlwc2UvamR0L2lu
dGVybmFsL2NvcmUvZG9tL05haXZlQVNURmxhdHRlbmVyLmphdmEKaW5kZXggNzg4MWM3Mi4uNjFj
NzMyMyAxMDA2NDQKLS0tIGEvb3JnLmVjbGlwc2UuamR0LmNvcmUvZG9tL29yZy9lY2xpcHNlL2pk
dC9pbnRlcm5hbC9jb3JlL2RvbS9OYWl2ZUFTVEZsYXR0ZW5lci5qYXZhCisrKyBiL29yZy5lY2xp
cHNlLmpkdC5jb3JlL2RvbS9vcmcvZWNsaXBzZS9qZHQvaW50ZXJuYWwvY29yZS9kb20vTmFpdmVB
U1RGbGF0dGVuZXIuamF2YQpAQCAtMTE3Myw2ICsxMTczLDE4IEBACiAJfQogCiAJLyoKKwkgKiBA
c2VlIEFTVFZpc2l0b3IjdmlzaXQoUGFja2FnZVF1YWxpZmllZFR5cGUpCisJICogQHNpbmNlIDMu
OQorCSAqLworCXB1YmxpYyBib29sZWFuIHZpc2l0KFBhY2thZ2VRdWFsaWZpZWRUeXBlIG5vZGUp
IHsKKwkJbm9kZS5nZXRRdWFsaWZpZXIoKS5hY2NlcHQodGhpcyk7CisJCXRoaXMuYnVmZmVyLmFw
cGVuZCgnLicpOworCQl2aXNpdFR5cGVBbm5vdGF0aW9ucyhub2RlKTsKKwkJbm9kZS5nZXROYW1l
KCkuYWNjZXB0KHRoaXMpOworCQlyZXR1cm4gZmFsc2U7CisJfQorCisJLyoKIAkgKiBAc2VlIEFT
VFZpc2l0b3IjdmlzaXQoUGFyYW1ldGVyaXplZFR5cGUpCiAJICogQHNpbmNlIDMuMQogCSAqLw==
</data>

          </attachment>
          <attachment
              isobsolete="1"
              ispatch="1"
              isprivate="0"
          >
            <attachid>229791</attachid>
            <date>2013-04-17 05:10:00 -0400</date>
            <delta_ts>2013-04-18 02:35:40 -0400</delta_ts>
            <desc>Proposed Patch</desc>
            <filename>Fix-for-Bug-404489--18dom-ast-Incorrect-conversion-o.patch</filename>
            <type>text/plain</type>
            <size>54082</size>
            <attacher name="Manoj Palat Away Until May 11 2015">manpalat</attacher>
            
              <data encoding="base64">ZGlmZiAtLWdpdCBhL29yZy5lY2xpcHNlLmpkdC5jb3JlLnRlc3RzLm1vZGVsL3NyYy9vcmcvZWNs
aXBzZS9qZHQvY29yZS90ZXN0cy9kb20vQVNUQ29udmVydGVyMThUZXN0LmphdmEgYi9vcmcuZWNs
aXBzZS5qZHQuY29yZS50ZXN0cy5tb2RlbC9zcmMvb3JnL2VjbGlwc2UvamR0L2NvcmUvdGVzdHMv
ZG9tL0FTVENvbnZlcnRlcjE4VGVzdC5qYXZhCmluZGV4IGY3NjhhZTMuLjM3N2MxZGUgMTAwNjQ0
Ci0tLSBhL29yZy5lY2xpcHNlLmpkdC5jb3JlLnRlc3RzLm1vZGVsL3NyYy9vcmcvZWNsaXBzZS9q
ZHQvY29yZS90ZXN0cy9kb20vQVNUQ29udmVydGVyMThUZXN0LmphdmEKKysrIGIvb3JnLmVjbGlw
c2UuamR0LmNvcmUudGVzdHMubW9kZWwvc3JjL29yZy9lY2xpcHNlL2pkdC9jb3JlL3Rlc3RzL2Rv
bS9BU1RDb252ZXJ0ZXIxOFRlc3QuamF2YQpAQCAtMTQ5LDEwICsxNDksMTAgQEAKIAkJYXNzZXJ0
Tm90TnVsbChhc3NpZ25tZW50KTsKIAkJQ2FzdEV4cHJlc3Npb24gY2FzdEV4cHJlc3Npb24gPSAo
Q2FzdEV4cHJlc3Npb24pIGFzc2lnbm1lbnQuZ2V0UmlnaHRIYW5kU2lkZSgpOwogCQlhc3NlcnRO
b3ROdWxsKGNhc3RFeHByZXNzaW9uKTsKLQkJU2ltcGxlVHlwZSBzaW1wbGVUeXBlID0gKFNpbXBs
ZVR5cGUpIGNhc3RFeHByZXNzaW9uLmdldFR5cGUoKTsKLQkJYXNzZXJ0Tm90TnVsbChzaW1wbGVU
eXBlKTsKLQkJYXNzZXJ0RXF1YWxzKCJqYXZhLmxhbmcuQE1hcmtlciBTdHJpbmciLCBzaW1wbGVU
eXBlLnRvU3RyaW5nKCkpOwotCQlMaXN0IGFubm90YXRpb25zID0gc2ltcGxlVHlwZS5hbm5vdGF0
aW9ucygpOworCQlQYWNrYWdlUXVhbGlmaWVkVHlwZSBwYWNrYWdlUXVhbGlmaWVkVHlwZSA9IChQ
YWNrYWdlUXVhbGlmaWVkVHlwZSkgY2FzdEV4cHJlc3Npb24uZ2V0VHlwZSgpOworCQlhc3NlcnRO
b3ROdWxsKHBhY2thZ2VRdWFsaWZpZWRUeXBlKTsKKwkJYXNzZXJ0RXF1YWxzKCJqYXZhLmxhbmcu
QE1hcmtlciBTdHJpbmciLCBwYWNrYWdlUXVhbGlmaWVkVHlwZS50b1N0cmluZygpKTsKKwkJTGlz
dCBhbm5vdGF0aW9ucyA9IHBhY2thZ2VRdWFsaWZpZWRUeXBlLmFubm90YXRpb25zKCk7CiAJCWFz
c2VydFRydWUoYW5ub3RhdGlvbnMuc2l6ZSgpID09IDEpOwogCQlhc3NlcnRFcXVhbHMoIkBNYXJr
ZXIiLCBhbm5vdGF0aW9ucy5nZXQoMCkudG9TdHJpbmcoKSk7CiAKQEAgLTE2MCw3ICsxNjAsNyBA
QAogCQlWYXJpYWJsZURlY2xhcmF0aW9uU3RhdGVtZW50IHZhcmlhYmxlRGVjbGFyYXRpb25TdGF0
ZW1lbnQgPSAoVmFyaWFibGVEZWNsYXJhdGlvblN0YXRlbWVudCkgc3RhdGVtZW50cy5nZXQoc0Nv
dW50KyspOwogCQlUeXBlIHR5cGUgPSB2YXJpYWJsZURlY2xhcmF0aW9uU3RhdGVtZW50LmdldFR5
cGUoKTsKIAkJYXNzZXJ0VHJ1ZSh0eXBlLmlzU2ltcGxlVHlwZSgpKTsKLQkJc2ltcGxlVHlwZSA9
IChTaW1wbGVUeXBlKSB0eXBlOworCQlTaW1wbGVUeXBlIHNpbXBsZVR5cGUgPSAoU2ltcGxlVHlw
ZSkgdHlwZTsKIAkJYXNzZXJ0RXF1YWxzKCJPdXRlci5Jbm5lciIsIHNpbXBsZVR5cGUudG9TdHJp
bmcoKSk7CiAJCWFubm90YXRpb25zID0gc2ltcGxlVHlwZS5hbm5vdGF0aW9ucygpOwogCQlhc3Nl
cnRUcnVlKGFubm90YXRpb25zLnNpemUoKSA9PSAwKTsKQEAgLTE2OSwyMiArMTY5LDIyIEBACiAJ
CS8vIGFubm90YXRpb25zLgogCQl2YXJpYWJsZURlY2xhcmF0aW9uU3RhdGVtZW50ID0gKFZhcmlh
YmxlRGVjbGFyYXRpb25TdGF0ZW1lbnQpIHN0YXRlbWVudHMuZ2V0KHNDb3VudCsrKTsKIAkJdHlw
ZSA9IHZhcmlhYmxlRGVjbGFyYXRpb25TdGF0ZW1lbnQuZ2V0VHlwZSgpOwotCQlhc3NlcnRUcnVl
KHR5cGUuaXNTaW1wbGVUeXBlKCkpOwotCQlzaW1wbGVUeXBlID0gKFNpbXBsZVR5cGUpIHR5cGU7
Ci0JCWFzc2VydE5vdE51bGwoc2ltcGxlVHlwZSk7Ci0JCWFzc2VydEVxdWFscygiT3V0ZXIuQE1h
cmtlcjIgSW5uZXIiLCBzaW1wbGVUeXBlLnRvU3RyaW5nKCkpOwotCQlhbm5vdGF0aW9ucyA9IHNp
bXBsZVR5cGUuYW5ub3RhdGlvbnMoKTsKKwkJYXNzZXJ0VHJ1ZSh0eXBlLmlzUXVhbGlmaWVkVHlw
ZSgpKTsKKwkJUXVhbGlmaWVkVHlwZSBxdWFsaWZpZWRUeXBlID0gKFF1YWxpZmllZFR5cGUpIHR5
cGU7CisJCWFzc2VydE5vdE51bGwocXVhbGlmaWVkVHlwZSk7CisJCWFzc2VydEVxdWFscygiT3V0
ZXIuQE1hcmtlcjIgSW5uZXIiLCBxdWFsaWZpZWRUeXBlLnRvU3RyaW5nKCkpOworCQlhbm5vdGF0
aW9ucyA9IHF1YWxpZmllZFR5cGUuYW5ub3RhdGlvbnMoKTsKIAkJYXNzZXJ0VHJ1ZShhbm5vdGF0
aW9ucy5zaXplKCkgPT0gMSk7CiAJCWFzc2VydEVxdWFscygiQE1hcmtlcjIiLCBhbm5vdGF0aW9u
cy5nZXQoMCkudG9TdHJpbmcoKSk7CiAKIAkJLy8gY2FzZSA0IC0gTXVsdGlwbGUgbGV2ZWxzIHdp
dGggYW5ub3RhdGlvbnMgYXQgdGhlIGxhc3Qgb25seS4KIAkJdmFyaWFibGVEZWNsYXJhdGlvblN0
YXRlbWVudCA9IChWYXJpYWJsZURlY2xhcmF0aW9uU3RhdGVtZW50KSBzdGF0ZW1lbnRzLmdldChz
Q291bnQrKyk7CiAJCXR5cGUgPSB2YXJpYWJsZURlY2xhcmF0aW9uU3RhdGVtZW50LmdldFR5cGUo
KTsKLQkJYXNzZXJ0VHJ1ZSh0eXBlLmlzU2ltcGxlVHlwZSgpKTsKLQkJc2ltcGxlVHlwZSA9IChT
aW1wbGVUeXBlKSB0eXBlOwotCQlhc3NlcnROb3ROdWxsKHNpbXBsZVR5cGUpOwotCQlhc3NlcnRF
cXVhbHMoIk91dGVyLklubmVyLkBNYXJrZXIxIERlZXBlciIsIHNpbXBsZVR5cGUudG9TdHJpbmco
KSk7Ci0JCWFubm90YXRpb25zID0gc2ltcGxlVHlwZS5hbm5vdGF0aW9ucygpOworCQlhc3NlcnRU
cnVlKHR5cGUuaXNRdWFsaWZpZWRUeXBlKCkpOworCQlxdWFsaWZpZWRUeXBlID0gKFF1YWxpZmll
ZFR5cGUpIHR5cGU7CisJCWFzc2VydE5vdE51bGwocXVhbGlmaWVkVHlwZSk7CisJCWFzc2VydEVx
dWFscygiT3V0ZXIuSW5uZXIuQE1hcmtlcjEgRGVlcGVyIiwgcXVhbGlmaWVkVHlwZS50b1N0cmlu
ZygpKTsKKwkJYW5ub3RhdGlvbnMgPSBxdWFsaWZpZWRUeXBlLmFubm90YXRpb25zKCk7CiAJCWFz
c2VydFRydWUoYW5ub3RhdGlvbnMuc2l6ZSgpID09IDEpOwogCQlhc3NlcnRFcXVhbHMoIkBNYXJr
ZXIxIiwgYW5ub3RhdGlvbnMuZ2V0KDApLnRvU3RyaW5nKCkpOwogCkBAIC0xOTIsNyArMTkyLDcg
QEAKIAkJdmFyaWFibGVEZWNsYXJhdGlvblN0YXRlbWVudCA9IChWYXJpYWJsZURlY2xhcmF0aW9u
U3RhdGVtZW50KSBzdGF0ZW1lbnRzLmdldChzQ291bnQrKyk7CiAJCXR5cGUgPSB2YXJpYWJsZURl
Y2xhcmF0aW9uU3RhdGVtZW50LmdldFR5cGUoKTsKIAkJYXNzZXJ0VHJ1ZSh0eXBlLmlzUXVhbGlm
aWVkVHlwZSgpKTsKLQkJUXVhbGlmaWVkVHlwZSBxdWFsaWZpZWRUeXBlID0gKFF1YWxpZmllZFR5
cGUpIHR5cGU7CisJCXF1YWxpZmllZFR5cGUgPSAoUXVhbGlmaWVkVHlwZSkgdHlwZTsKIAkJYXNz
ZXJ0Tm90TnVsbChxdWFsaWZpZWRUeXBlKTsKIAkJYXNzZXJ0RXF1YWxzKCJPdXRlci5ATWFya2Vy
MSBJbm5lci5ATWFya2VyMiBEZWVwZXIiLCBxdWFsaWZpZWRUeXBlLnRvU3RyaW5nKCkpOwogCQlh
bm5vdGF0aW9ucyA9IHF1YWxpZmllZFR5cGUuYW5ub3RhdGlvbnMoKTsKQEAgLTIwMSwxMCArMjAx
LDEwIEBACiAJCVNpbXBsZU5hbWUgc2ltcGxlTmFtZSA9IHF1YWxpZmllZFR5cGUuZ2V0TmFtZSgp
OwogCQlhc3NlcnRFcXVhbHMoIkRlZXBlciIsIHNpbXBsZU5hbWUudG9TdHJpbmcoKSk7CiAJCVR5
cGUgcXVhbGlmaWVyVHlwZSA9IHF1YWxpZmllZFR5cGUuZ2V0UXVhbGlmaWVyKCk7Ci0JCWFzc2Vy
dFRydWUocXVhbGlmaWVyVHlwZS5pc1NpbXBsZVR5cGUoKSk7Ci0JCXNpbXBsZVR5cGUgPSAoU2lt
cGxlVHlwZSkgcXVhbGlmaWVyVHlwZTsKLQkJYXNzZXJ0RXF1YWxzKCJPdXRlci5ATWFya2VyMSBJ
bm5lciIsIHNpbXBsZVR5cGUudG9TdHJpbmcoKSk7Ci0JCWFubm90YXRpb25zID0gc2ltcGxlVHlw
ZS5hbm5vdGF0aW9ucygpOworCQlhc3NlcnRUcnVlKHF1YWxpZmllclR5cGUuaXNRdWFsaWZpZWRU
eXBlKCkpOworCQlxdWFsaWZpZWRUeXBlID0gKFF1YWxpZmllZFR5cGUpIHF1YWxpZmllclR5cGU7
CisJCWFzc2VydEVxdWFscygiT3V0ZXIuQE1hcmtlcjEgSW5uZXIiLCBxdWFsaWZpZWRUeXBlLnRv
U3RyaW5nKCkpOworCQlhbm5vdGF0aW9ucyA9IHF1YWxpZmllZFR5cGUuYW5ub3RhdGlvbnMoKTsK
IAkJYXNzZXJ0VHJ1ZShhbm5vdGF0aW9ucy5zaXplKCkgPT0gMSk7CiAJCWFzc2VydEVxdWFscygi
QE1hcmtlcjEiLCBhbm5vdGF0aW9ucy5nZXQoMCkudG9TdHJpbmcoKSk7CiAJfQpAQCAtMzQyLDEw
ICszNDIsMTAgQEAKIAkJdHlwZUFyZ3VtZW50cyA9IHBhcmFtZXRyaXplZFR5cGUudHlwZUFyZ3Vt
ZW50cygpOwogCQlhc3NlcnRFcXVhbHMoMSwgdHlwZUFyZ3VtZW50cy5zaXplKCkpOwogCQl0eXBl
ID0gKFR5cGUpIHR5cGVBcmd1bWVudHMuZ2V0KDApOwotCQlhc3NlcnRUcnVlKHR5cGUuaXNTaW1w
bGVUeXBlKCkpOwotCQlTaW1wbGVUeXBlIHNpbXBsZVR5cGUgPSAoU2ltcGxlVHlwZSkgdHlwZTsK
LQkJYXNzZXJ0RXF1YWxzKCJPdXRlci5ATWFya2VyMSBJbm5lciIsIHNpbXBsZVR5cGUudG9TdHJp
bmcoKSk7Ci0JCUxpc3QgYW5ub3RhdGlvbnMgPSBzaW1wbGVUeXBlLmFubm90YXRpb25zKCk7CisJ
CWFzc2VydFRydWUodHlwZS5pc1F1YWxpZmllZFR5cGUoKSk7CisJCVF1YWxpZmllZFR5cGUgcXVh
bGlmaWVkVHlwZSA9IChRdWFsaWZpZWRUeXBlKSB0eXBlOworCQlhc3NlcnRFcXVhbHMoIk91dGVy
LkBNYXJrZXIxIElubmVyIiwgcXVhbGlmaWVkVHlwZS50b1N0cmluZygpKTsKKwkJTGlzdCBhbm5v
dGF0aW9ucyA9IHF1YWxpZmllZFR5cGUuYW5ub3RhdGlvbnMoKTsKIAkJYXNzZXJ0VHJ1ZShhbm5v
dGF0aW9ucy5zaXplKCkgPT0gMSk7CiAJCUFubm90YXRpb24gYW5ub3RhdGlvbiA9IChBbm5vdGF0
aW9uKSBhbm5vdGF0aW9ucy5nZXQoMCk7CiAJCWFzc2VydEVxdWFscygiQE1hcmtlcjEiLCBhbm5v
dGF0aW9uLnRvU3RyaW5nKCkpOwpAQCAtMzU5LDEzICszNTksMTMgQEAKIAkJdHlwZSA9IChUeXBl
KSB0eXBlQXJndW1lbnRzLmdldCgwKTsKIAkJYXNzZXJ0VHJ1ZSh0eXBlLmlzUXVhbGlmaWVkVHlw
ZSgpKTsKIAkJYXNzZXJ0RXF1YWxzKCJATWFya2VyMSBPdXRlci5Jbm5lciIsIHR5cGUudG9TdHJp
bmcoKSk7Ci0JCVF1YWxpZmllZFR5cGUgcXVhbGlmaWVkVHlwZSA9IChRdWFsaWZpZWRUeXBlKSB0
eXBlOworCQlxdWFsaWZpZWRUeXBlID0gKFF1YWxpZmllZFR5cGUpIHR5cGU7CiAJCWFzc2VydEVx
dWFscygiSW5uZXIiLCBxdWFsaWZpZWRUeXBlLmdldE5hbWUoKS50b1N0cmluZygpKTsKIAkJYW5u
b3RhdGlvbnMgPSBxdWFsaWZpZWRUeXBlLmFubm90YXRpb25zKCk7CiAJCWFzc2VydFRydWUoYW5u
b3RhdGlvbnMuc2l6ZSgpID09IDApOwogCQlUeXBlIHF1YWxpZmllclR5cGUgPSBxdWFsaWZpZWRU
eXBlLmdldFF1YWxpZmllcigpOwogCQlhc3NlcnRUcnVlKHF1YWxpZmllclR5cGUuaXNTaW1wbGVU
eXBlKCkpOwotCQlzaW1wbGVUeXBlID0gKFNpbXBsZVR5cGUpIHF1YWxpZmllclR5cGU7CisJCVNp
bXBsZVR5cGUgc2ltcGxlVHlwZSA9IChTaW1wbGVUeXBlKSBxdWFsaWZpZXJUeXBlOwogCQlhc3Nl
cnRFcXVhbHMoIkBNYXJrZXIxIE91dGVyIiwgc2ltcGxlVHlwZS50b1N0cmluZygpKTsKIAkJYW5u
b3RhdGlvbnMgPSBzaW1wbGVUeXBlLmFubm90YXRpb25zKCk7CiAJCWFzc2VydFRydWUoYW5ub3Rh
dGlvbnMuc2l6ZSgpID09IDEpOwpAQCAtMTkzNSw0ICsxOTM1LDMxNiBAQAogCQltZXRob2QgPSAo
TWV0aG9kRGVjbGFyYXRpb24pIHR5cGUuYm9keURlY2xhcmF0aW9ucygpLmdldCgzKTsKIAkJYXNz
ZXJ0RXF1YWxzKCJNZXRob2Qgc2hvdWxkIGJlIG1hbGZvcm1lZCIsIEFTVE5vZGUuTUFMRk9STUVE
LCAobWV0aG9kLmdldEZsYWdzKCkgJiBBU1ROb2RlLk1BTEZPUk1FRCkpOwogCX0KKworCS8vIGh0
dHBzOi8vYnVncy5lY2xpcHNlLm9yZy9idWdzL3Nob3dfYnVnLmNnaT9pZD00MDQ0ODkKKwlwdWJs
aWMgdm9pZCB0ZXN0QnVnNDA0NDg5YSgpIHRocm93cyBKYXZhTW9kZWxFeGNlcHRpb24geworCQlT
dHJpbmcgY29udGVudHMgPQorCQkicGFja2FnZSB0ZXN0NDA0NDg5LmJ1ZztcbiIgKworCQkicHVi
bGljIGNsYXNzIFggeyBcbiIgKworCQkiCWNsYXNzIFkgeyBcbiIgKworCQkiCQljbGFzcyBaIHtc
biIgKworCQkiCQkJcHVibGljIFooQEEgWC5AQiBZIFkudGhpcyl7fVxuIiArCisJCSIJCQl9XG4i
ICsKKwkJIiAgCQl9XG4iICsKKwkJIiAgCQlPYmplY3Qgbz0oQEEgWC5AQiBZLkBNYXJrZXIgIFop
bnVsbDtcbiIgKworCQkiCX1cbiIgKworCQkiQGphdmEubGFuZy5hbm5vdGF0aW9uLlRhcmdldChq
YXZhLmxhbmcuYW5ub3RhdGlvbi5FbGVtZW50VHlwZS5UWVBFX1VTRSkgQGludGVyZmFjZSBNYXJr
ZXIge30gXG4iICsKKwkJIkBqYXZhLmxhbmcuYW5ub3RhdGlvbi5UYXJnZXQoamF2YS5sYW5nLmFu
bm90YXRpb24uRWxlbWVudFR5cGUuVFlQRV9VU0UpIEBpbnRlcmZhY2UgQSB7fSBcbiIgKworCQki
QGphdmEubGFuZy5hbm5vdGF0aW9uLlRhcmdldChqYXZhLmxhbmcuYW5ub3RhdGlvbi5FbGVtZW50
VHlwZS5UWVBFX1VTRSkgQGludGVyZmFjZSBCIHt9IFxuIjsKKwkJdGhpcy53b3JraW5nQ29weSA9
IGdldFdvcmtpbmdDb3B5KCIvQ29udmVydGVyMTgvc3JjL3Rlc3Q0MDQ0ODkvYnVnL1guamF2YSIs
IHRydWUvKiByZXNvbHZlICovKTsKKwkJQVNUTm9kZSBub2RlID0gYnVpbGRBU1QoY29udGVudHMs
IHRoaXMud29ya2luZ0NvcHkpOworCQlhc3NlcnRFcXVhbHMoIk5vdCBhIGNvbXBpbGF0aW9uIHVu
aXQiLCBBU1ROb2RlLkNPTVBJTEFUSU9OX1VOSVQsIG5vZGUuZ2V0Tm9kZVR5cGUoKSk7CisJCUNv
bXBpbGF0aW9uVW5pdCB1bml0ID0gKENvbXBpbGF0aW9uVW5pdCkgbm9kZTsKKwkJVHlwZURlY2xh
cmF0aW9uIHR5cGUgPSAgKFR5cGVEZWNsYXJhdGlvbikgdW5pdC50eXBlcygpLmdldCgwKTsKKwkJ
bm9kZSA9IChBU1ROb2RlKSB0eXBlLmJvZHlEZWNsYXJhdGlvbnMoKS5nZXQoMCk7CisJCWFzc2Vy
dEVxdWFscygiTm90IGEgVHlwZSBEZWNsYXJhdGlvbiIsIEFTVE5vZGUuVFlQRV9ERUNMQVJBVElP
Tiwgbm9kZS5nZXROb2RlVHlwZSgpKTsKKwkJbm9kZSA9IChBU1ROb2RlKSAoKFR5cGVEZWNsYXJh
dGlvbilub2RlKS5ib2R5RGVjbGFyYXRpb25zKCkuZ2V0KDApOworCQlhc3NlcnRFcXVhbHMoIk5v
dCBhIFR5cGUgRGVjbGFyYXRpb24iLCBBU1ROb2RlLlRZUEVfREVDTEFSQVRJT04sIG5vZGUuZ2V0
Tm9kZVR5cGUoKSk7CisJCW5vZGUgPSAoQVNUTm9kZSkgKChUeXBlRGVjbGFyYXRpb24pbm9kZSku
Ym9keURlY2xhcmF0aW9ucygpLmdldCgwKTsJCQorCQlhc3NlcnRFcXVhbHMoIk5vdCBhIG1ldGhv
ZCBEZWNsYXJhdGlvbiIsIEFTVE5vZGUuTUVUSE9EX0RFQ0xBUkFUSU9OLCBub2RlLmdldE5vZGVU
eXBlKCkpOworCQlNZXRob2REZWNsYXJhdGlvbiBtZXRob2QgPSAoTWV0aG9kRGVjbGFyYXRpb24p
IG5vZGU7CisJCWFzc2VydEVxdWFscygiTWV0aG9kIHNob3VsZCBub3QgYmUgbWFsZm9ybWVkIiwg
MCwgKG1ldGhvZC5nZXRGbGFncygpICYgQVNUTm9kZS5NQUxGT1JNRUQpKTsKKwkJQW5ub3RhdGFi
bGVUeXBlIGFubm90YXRhYmxlVHlwZSA9IG1ldGhvZC5nZXRSZWNlaXZlclR5cGUoKTsKKwkJYXNz
ZXJ0VHJ1ZShhbm5vdGF0YWJsZVR5cGUuaXNRdWFsaWZpZWRUeXBlKCkpOworCQlRdWFsaWZpZWRU
eXBlIHF1YWxpZmllZFR5cGUgPSAoUXVhbGlmaWVkVHlwZSkgYW5ub3RhdGFibGVUeXBlOworCQlh
c3NlcnRFcXVhbHMoIndyb25nIHF1YWxpZmllZCB0eXBlIiwgIkBBIFguQEIgWSIsIHF1YWxpZmll
ZFR5cGUudG9TdHJpbmcoKSk7CisJCUlUeXBlQmluZGluZyBiaW5kaW5nID0gcXVhbGlmaWVkVHlw
ZS5yZXNvbHZlQmluZGluZygpOworCQlhc3NlcnROb3ROdWxsKCJObyBiaW5kaW5nIiwgYmluZGlu
Zyk7CisJCWFzc2VydEVxdWFscygiV3JvbmcgcXVhbGlmaWVkIG5hbWUiLCAidGVzdDQwNDQ4OS5i
dWcuWC5ZIiwgYmluZGluZy5nZXRRdWFsaWZpZWROYW1lKCkpOworCQlMaXN0IGFubm90YXRpb25z
ID0gcXVhbGlmaWVkVHlwZS5hbm5vdGF0aW9ucygpOworCQlhc3NlcnRUcnVlKGFubm90YXRpb25z
LnNpemUoKSA9PSAxKTsKKwkJTWFya2VyQW5ub3RhdGlvbiBtYXJrZXIJPSAoTWFya2VyQW5ub3Rh
dGlvbikgYW5ub3RhdGlvbnMuZ2V0KDApOworCQlhc3NlcnRFcXVhbHMoIndyb25nIGFubm90YXRp
b24gbmFtZSIsICJAQiIsIG1hcmtlci50b1N0cmluZygpKTsKKwkJYmluZGluZyA9IG1hcmtlci5y
ZXNvbHZlVHlwZUJpbmRpbmcoKTsKKwkJYXNzZXJ0Tm90TnVsbCgiTm8gYmluZGluZyIsIGJpbmRp
bmcpOworCQlhc3NlcnRFcXVhbHMoIldyb25nIHF1YWxpZmllZCBuYW1lIiwgInRlc3Q0MDQ0ODku
YnVnLkIiLCBiaW5kaW5nLmdldFF1YWxpZmllZE5hbWUoKSk7CisJCUlBbm5vdGF0aW9uQmluZGlu
ZyBhbm5vdGF0aW9uQmluZGluZyA9IG1hcmtlci5yZXNvbHZlQW5ub3RhdGlvbkJpbmRpbmcoKTsK
KwkJYXNzZXJ0Tm90TnVsbChhbm5vdGF0aW9uQmluZGluZyk7CisJCWFzc2VydEVxdWFscygid3Jv
bmcgYW5ub3RhdGlvbiBiaW5kaW5nIiwgIkIiLCBhbm5vdGF0aW9uQmluZGluZy5nZXROYW1lKCkp
OworCQlOYW1lIG5hbWUgPSBtYXJrZXIuZ2V0VHlwZU5hbWUoKTsKKwkJYXNzZXJ0VHJ1ZShuYW1l
LmlzU2ltcGxlTmFtZSgpKTsKKwkJU2ltcGxlTmFtZSBzaW1wbGVOYW1lID0gKFNpbXBsZU5hbWUp
IG5hbWU7CisJCWFzc2VydEVxdWFscygid3JvbmcgdHlwZSBuYW1lIiwgIkIiLCBzaW1wbGVOYW1l
LnRvU3RyaW5nKCkpOworCQlhc3NlcnRFcXVhbHMoIndyb25nIHNpbXBsZSBuYW1lIiwgIkIiLHNp
bXBsZU5hbWUuZ2V0SWRlbnRpZmllcigpKTsKKwkJYmluZGluZyA9IHNpbXBsZU5hbWUucmVzb2x2
ZVR5cGVCaW5kaW5nKCk7CisJCWFzc2VydE5vdE51bGwoIk5vIGJpbmRpbmciLCBiaW5kaW5nKTsK
KwkJYXNzZXJ0RXF1YWxzKCJXcm9uZyBxdWFsaWZpZWQgbmFtZSIsICJ0ZXN0NDA0NDg5LmJ1Zy5C
IiwgYmluZGluZy5nZXRRdWFsaWZpZWROYW1lKCkpOworCQlhc3NlcnRUcnVlKHF1YWxpZmllZFR5
cGUuZ2V0UXVhbGlmaWVyKCkuaXNTaW1wbGVUeXBlKCkpOworCQlTaW1wbGVUeXBlIHNpbXBsZVR5
cGUgPSAoU2ltcGxlVHlwZSkgcXVhbGlmaWVkVHlwZS5nZXRRdWFsaWZpZXIoKTsKKwkJYXNzZXJ0
RXF1YWxzKCJpbmNvcnJlY3QgdHlwZSIsICJAQSBYIiwgc2ltcGxlVHlwZS50b1N0cmluZygpKTsK
KwkJYmluZGluZyA9IHNpbXBsZVR5cGUucmVzb2x2ZUJpbmRpbmcoKTsKKwkJYXNzZXJ0Tm90TnVs
bCgiTm8gYmluZGluZyIsIGJpbmRpbmcpOworCQlhc3NlcnRFcXVhbHMoIldyb25nIHF1YWxpZmll
ZCBuYW1lIiwgInRlc3Q0MDQ0ODkuYnVnLlguWSIsIGJpbmRpbmcuZ2V0UXVhbGlmaWVkTmFtZSgp
KTsKKwl9CisKKwkvLyBodHRwczovL2J1Z3MuZWNsaXBzZS5vcmcvYnVncy9zaG93X2J1Zy5jZ2k/
aWQ9NDA0NDg5CisJcHVibGljIHZvaWQgdGVzdEJ1ZzQwNDQ4OWIoKSB0aHJvd3MgSmF2YU1vZGVs
RXhjZXB0aW9uIHsKKwkJSUNvbXBpbGF0aW9uVW5pdCBzb3VyY2VVbml0ID0gZ2V0Q29tcGlsYXRp
b25Vbml0KCJDb252ZXJ0ZXIxOCIgLCAic3JjIiwgInRlc3Q0MDQ0ODkuYnVnIiwgIlguamF2YSIp
OyAvLyROT04tTkxTLTEkIC8vJE5PTi1OTFMtMiQgLy8kTk9OLU5MUy0zJCAvLyROT04tTkxTLTQk
CisJCUFTVE5vZGUgcmVzdWx0ID0gcnVuQ29udmVyc2lvbih0aGlzLmFzdC5hcGlMZXZlbCgpLCBz
b3VyY2VVbml0LCB0cnVlKTsKKwkJY2hhcltdIHNvdXJjZSA9IHNvdXJjZVVuaXQuZ2V0U291cmNl
KCkudG9DaGFyQXJyYXkoKTsKKwkJYXNzZXJ0VHJ1ZSgiTm90IGEgY29tcGlsYXRpb24gdW5pdCIs
IHJlc3VsdC5nZXROb2RlVHlwZSgpID09IEFTVE5vZGUuQ09NUElMQVRJT05fVU5JVCk7CisJCUNv
bXBpbGF0aW9uVW5pdCBjb21waWxhdGlvblVuaXQgPSAoQ29tcGlsYXRpb25Vbml0KSByZXN1bHQ7
CisJCWFzc2VydFByb2JsZW1zU2l6ZShjb21waWxhdGlvblVuaXQsIDApOworCQlBU1ROb2RlIG5v
ZGUgPSBnZXRBU1ROb2RlKGNvbXBpbGF0aW9uVW5pdCwgMCwgMCwgMCk7CisJCVR5cGVEZWNsYXJh
dGlvbiB0eXBlRGVjbGFyYXRpb24gPSAgKFR5cGVEZWNsYXJhdGlvbikgY29tcGlsYXRpb25Vbml0
LnR5cGVzKCkuZ2V0KDApOworCisJCW5vZGUgPSAoQVNUTm9kZSkgdHlwZURlY2xhcmF0aW9uLmJv
ZHlEZWNsYXJhdGlvbnMoKS5nZXQoMik7CisJCWFzc2VydEVxdWFscygiTm90IGEgbWV0aG9kIGRl
Y2xhcmF0aW9uIiwgQVNUTm9kZS5NRVRIT0RfREVDTEFSQVRJT04sIG5vZGUuZ2V0Tm9kZVR5cGUo
KSk7CQkKKwkJTWV0aG9kRGVjbGFyYXRpb24gbWV0aG9kRGVjbCA9IChNZXRob2REZWNsYXJhdGlv
bikgbm9kZTsKKwkJVHlwZSB0eXBlID0gbWV0aG9kRGVjbC5nZXRSZXR1cm5UeXBlMigpOworCQlh
c3NlcnRUcnVlKHR5cGUuaXNQYWNrYWdlUXVhbGlmaWVkVHlwZSgpKTsKKwkJUGFja2FnZVF1YWxp
ZmllZFR5cGUgcGFja2FnZVF1YWxpZmllZFR5cGUgPSAoUGFja2FnZVF1YWxpZmllZFR5cGUpIHR5
cGU7CisJCWNoZWNrU291cmNlUmFuZ2UocGFja2FnZVF1YWxpZmllZFR5cGUsICJ0ZXN0NDA0NDg5
LmJ1Zy5ATm9uTnVsbCBJT0V4Y2VwdGlvbiIsIHNvdXJjZSk7CisJCUlUeXBlQmluZGluZyB0eXBl
QmluZGluZyA9IHBhY2thZ2VRdWFsaWZpZWRUeXBlLnJlc29sdmVCaW5kaW5nKCk7CisJCWFzc2Vy
dE5vdE51bGwoIm51bGwgYmluZGluZyIsIHR5cGVCaW5kaW5nKTsKKwkJYXNzZXJ0RXF1YWxzKCJu
b3QgYSB2YWxpZCBiaW5kaW5nIiwgInRlc3Q0MDQ0ODkuYnVnLklPRXhjZXB0aW9uIiwgdHlwZUJp
bmRpbmcuZ2V0UXVhbGlmaWVkTmFtZSgpKTsKKwkJCisJCS8vIHF1YWxpZmllciBvZiB0aGUgcGFj
a2FnZSBxdWFsaWZpZWQgdHlwZQorCQlOYW1lIG5hbWUgPSBwYWNrYWdlUXVhbGlmaWVkVHlwZS5n
ZXRRdWFsaWZpZXIoKTsKKwkJYXNzZXJ0VHJ1ZShuYW1lLmlzUXVhbGlmaWVkTmFtZSgpKTsKKwkJ
UXVhbGlmaWVkTmFtZSBxdWFsaWZpZWROYW1lID0gKFF1YWxpZmllZE5hbWUpIG5hbWU7CisJCWNo
ZWNrU291cmNlUmFuZ2UocXVhbGlmaWVkTmFtZSwgInRlc3Q0MDQ0ODkuYnVnIiwgc291cmNlKTsK
KwkJdHlwZUJpbmRpbmcgPSBxdWFsaWZpZWROYW1lLnJlc29sdmVUeXBlQmluZGluZygpOworCQlh
c3NlcnROdWxsKHR5cGVCaW5kaW5nKTsKKwkJSUJpbmRpbmcgYmluZGluZyA9IHF1YWxpZmllZE5h
bWUucmVzb2x2ZUJpbmRpbmcoKTsKKwkJYXNzZXJ0VHJ1ZSgibm90IGEgcGFja2FnZSBiaW5kaW5n
IiwgYmluZGluZy5nZXRLaW5kKCkgPT0gSUJpbmRpbmcuUEFDS0FHRSk7CisJCWFzc2VydEVxdWFs
cygid3JvbmcgcGFja2FnZSBiaW5kaW5nIiwgInBhY2thZ2UgdGVzdDQwNDQ4OS5idWciLCBiaW5k
aW5nLnRvU3RyaW5nKCkpOworCQluYW1lID0gcXVhbGlmaWVkTmFtZS5nZXRRdWFsaWZpZXIoKTsK
KwkJYXNzZXJ0VHJ1ZSgid3JvbmcgbmFtZSB0eXBlIiwgbmFtZS5pc1NpbXBsZU5hbWUoKSk7CisJ
CVNpbXBsZU5hbWUgc2ltcGxlTmFtZSA9IChTaW1wbGVOYW1lKSBuYW1lOworCQljaGVja1NvdXJj
ZVJhbmdlKHNpbXBsZU5hbWUsICJ0ZXN0NDA0NDg5Iiwgc291cmNlKTsKKwkJdHlwZUJpbmRpbmcg
PSBzaW1wbGVOYW1lLnJlc29sdmVUeXBlQmluZGluZygpOworCQlhc3NlcnROdWxsKHR5cGVCaW5k
aW5nKTsKKwkJYmluZGluZyA9IHNpbXBsZU5hbWUucmVzb2x2ZUJpbmRpbmcoKTsKKwkJYXNzZXJ0
VHJ1ZSgibm90IGEgcGFja2FnZSBiaW5kaW5nIiwgYmluZGluZy5nZXRLaW5kKCkgPT0gSUJpbmRp
bmcuUEFDS0FHRSk7CisJCWFzc2VydEVxdWFscygid3JvbmcgcGFja2FnZSBiaW5kaW5nIiwgInBh
Y2thZ2UgdGVzdDQwNDQ4OSIsIGJpbmRpbmcudG9TdHJpbmcoKSk7CisJCXNpbXBsZU5hbWUgPSBx
dWFsaWZpZWROYW1lLmdldE5hbWUoKTsKKwkJY2hlY2tTb3VyY2VSYW5nZShzaW1wbGVOYW1lLCAi
YnVnIiwgc291cmNlKTsKKwkJdHlwZUJpbmRpbmcgPSBzaW1wbGVOYW1lLnJlc29sdmVUeXBlQmlu
ZGluZygpOworCQlhc3NlcnROdWxsKHR5cGVCaW5kaW5nKTsKKwkJYmluZGluZyA9IHNpbXBsZU5h
bWUucmVzb2x2ZUJpbmRpbmcoKTsKKwkJYXNzZXJ0VHJ1ZSgibm90IGEgcGFja2FnZSBiaW5kaW5n
IiwgYmluZGluZy5nZXRLaW5kKCkgPT0gSUJpbmRpbmcuUEFDS0FHRSk7CisJCWFzc2VydEVxdWFs
cygid3JvbmcgcGFja2FnZSBiaW5kaW5nIiwgInBhY2thZ2UgdGVzdDQwNDQ4OS5idWciLCBiaW5k
aW5nLnRvU3RyaW5nKCkpOworCQkKKwkJLy8gYW5ub3RhdGlvbnMgb2YgcGFja2FnZSBxdWFsaWZp
ZWQgdHlwZQorCQlMaXN0IGFubm90YXRpb25zID0gcGFja2FnZVF1YWxpZmllZFR5cGUuYW5ub3Rh
dGlvbnMoKTsKKwkJYXNzZXJ0VHJ1ZShhbm5vdGF0aW9ucy5zaXplKCkgPT0gMSk7CisJCUFubm90
YXRpb24gYW5ub3RhdGlvbiA9IChBbm5vdGF0aW9uKSBhbm5vdGF0aW9ucy5nZXQoMCk7CisJCXR5
cGVCaW5kaW5nID0gYW5ub3RhdGlvbi5yZXNvbHZlVHlwZUJpbmRpbmcoKTsKKwkJYXNzZXJ0Tm90
TnVsbCgibnVsbCBiaW5kaW5nIiwgdHlwZUJpbmRpbmcpOworCQlhc3NlcnRFcXVhbHMoIm5vdCBh
IHZhbGlkIGJpbmRpbmciLCAidGVzdDQwNDQ4OS5idWcuWC5Ob25OdWxsIiwgdHlwZUJpbmRpbmcu
Z2V0UXVhbGlmaWVkTmFtZSgpKTsKKwkJSUFubm90YXRpb25CaW5kaW5nIGFubm90YXRpb25CaW5k
aW5nID0gYW5ub3RhdGlvbi5yZXNvbHZlQW5ub3RhdGlvbkJpbmRpbmcoKTsKKwkJYXNzZXJ0RXF1
YWxzKCJub3QgYSB2YWxpZCBhbm5vdGF0aW9uIGJpbmRpbmciLCAiQE5vbk51bGwoKSIsIGFubm90
YXRpb25CaW5kaW5nLnRvU3RyaW5nKCkpOworCQluYW1lID0gYW5ub3RhdGlvbi5nZXRUeXBlTmFt
ZSgpOworCQlhc3NlcnRUcnVlKG5hbWUuaXNTaW1wbGVOYW1lKCkpOworCQlzaW1wbGVOYW1lID0g
KFNpbXBsZU5hbWUpIG5hbWU7CisJCXR5cGVCaW5kaW5nID0gc2ltcGxlTmFtZS5yZXNvbHZlVHlw
ZUJpbmRpbmcoKTsKKwkJY2hlY2tTb3VyY2VSYW5nZShzaW1wbGVOYW1lLCAiTm9uTnVsbCIsIHNv
dXJjZSk7CisJCWFzc2VydE5vdE51bGwodHlwZUJpbmRpbmcpOworCQkKKwkJLy8gbmFtZSBvZiB0
aGUgcGFja2FnZSBxdWFsaWZpZWQgdHlwZQorCQlzaW1wbGVOYW1lID0gcGFja2FnZVF1YWxpZmll
ZFR5cGUuZ2V0TmFtZSgpOworCQljaGVja1NvdXJjZVJhbmdlKHNpbXBsZU5hbWUsICJJT0V4Y2Vw
dGlvbiIsIHNvdXJjZSk7CisJCXR5cGVCaW5kaW5nID0gc2ltcGxlTmFtZS5yZXNvbHZlVHlwZUJp
bmRpbmcoKTsKKwkJYXNzZXJ0Tm90TnVsbCh0eXBlQmluZGluZyk7CisJCQorCQkvLyBwYXJhbWV0
ZXIKKwkJU2luZ2xlVmFyaWFibGVEZWNsYXJhdGlvbiBwYXJhbSA9IChTaW5nbGVWYXJpYWJsZURl
Y2xhcmF0aW9uKSBtZXRob2REZWNsLnBhcmFtZXRlcnMoKS5nZXQoMCk7CisJCXR5cGUgPSBwYXJh
bS5nZXRUeXBlKCk7CisJCWFzc2VydFRydWUodHlwZS5pc1BhY2thZ2VRdWFsaWZpZWRUeXBlKCkp
OworCQlwYWNrYWdlUXVhbGlmaWVkVHlwZSA9IChQYWNrYWdlUXVhbGlmaWVkVHlwZSkgdHlwZTsK
KwkJY2hlY2tTb3VyY2VSYW5nZShwYWNrYWdlUXVhbGlmaWVkVHlwZSwgInRlc3Q0MDQ0ODkuYnVn
LkBOb25OdWxsIEZpbGVOb3RGb3VuZEV4Y2VwdGlvbiIsIHNvdXJjZSk7CisJCXR5cGVCaW5kaW5n
ID0gcGFja2FnZVF1YWxpZmllZFR5cGUucmVzb2x2ZUJpbmRpbmcoKTsKKwkJYXNzZXJ0Tm90TnVs
bCgibnVsbCBiaW5kaW5nIiwgdHlwZUJpbmRpbmcpOworCQlhc3NlcnRFcXVhbHMoIm5vdCBhIHZh
bGlkIGJpbmRpbmciLCAidGVzdDQwNDQ4OS5idWcuRmlsZU5vdEZvdW5kRXhjZXB0aW9uIiwgdHlw
ZUJpbmRpbmcuZ2V0UXVhbGlmaWVkTmFtZSgpKTsKKwkJCisJCS8vIHF1YWxpZmllciBvZiB0aGUg
cGFja2FnZSBxdWFsaWZpZWQgdHlwZQorCQluYW1lID0gcGFja2FnZVF1YWxpZmllZFR5cGUuZ2V0
UXVhbGlmaWVyKCk7CisJCWFzc2VydFRydWUobmFtZS5pc1F1YWxpZmllZE5hbWUoKSk7CisJCXF1
YWxpZmllZE5hbWUgPSAoUXVhbGlmaWVkTmFtZSkgbmFtZTsKKwkJY2hlY2tTb3VyY2VSYW5nZShx
dWFsaWZpZWROYW1lLCAidGVzdDQwNDQ4OS5idWciLCBzb3VyY2UpOworCQl0eXBlQmluZGluZyA9
IHF1YWxpZmllZE5hbWUucmVzb2x2ZVR5cGVCaW5kaW5nKCk7CisJCWFzc2VydE51bGwodHlwZUJp
bmRpbmcpOworCQliaW5kaW5nID0gcXVhbGlmaWVkTmFtZS5yZXNvbHZlQmluZGluZygpOworCQlh
c3NlcnRUcnVlKCJub3QgYSBwYWNrYWdlIGJpbmRpbmciLCBiaW5kaW5nLmdldEtpbmQoKSA9PSBJ
QmluZGluZy5QQUNLQUdFKTsKKwkJYXNzZXJ0RXF1YWxzKCJ3cm9uZyBwYWNrYWdlIGJpbmRpbmci
LCAicGFja2FnZSB0ZXN0NDA0NDg5LmJ1ZyIsIGJpbmRpbmcudG9TdHJpbmcoKSk7CisJCW5hbWUg
PSBxdWFsaWZpZWROYW1lLmdldFF1YWxpZmllcigpOworCQlhc3NlcnRUcnVlKCJ3cm9uZyBuYW1l
IHR5cGUiLCBuYW1lLmlzU2ltcGxlTmFtZSgpKTsKKwkJc2ltcGxlTmFtZSA9IChTaW1wbGVOYW1l
KSBuYW1lOworCQljaGVja1NvdXJjZVJhbmdlKHNpbXBsZU5hbWUsICJ0ZXN0NDA0NDg5Iiwgc291
cmNlKTsKKwkJdHlwZUJpbmRpbmcgPSBzaW1wbGVOYW1lLnJlc29sdmVUeXBlQmluZGluZygpOwor
CQlhc3NlcnROdWxsKHR5cGVCaW5kaW5nKTsKKwkJYmluZGluZyA9IHNpbXBsZU5hbWUucmVzb2x2
ZUJpbmRpbmcoKTsKKwkJYXNzZXJ0VHJ1ZSgibm90IGEgcGFja2FnZSBiaW5kaW5nIiwgYmluZGlu
Zy5nZXRLaW5kKCkgPT0gSUJpbmRpbmcuUEFDS0FHRSk7CisJCWFzc2VydEVxdWFscygid3Jvbmcg
cGFja2FnZSBiaW5kaW5nIiwgInBhY2thZ2UgdGVzdDQwNDQ4OSIsIGJpbmRpbmcudG9TdHJpbmco
KSk7CisJCXNpbXBsZU5hbWUgPSBxdWFsaWZpZWROYW1lLmdldE5hbWUoKTsKKwkJY2hlY2tTb3Vy
Y2VSYW5nZShzaW1wbGVOYW1lLCAiYnVnIiwgc291cmNlKTsKKwkJdHlwZUJpbmRpbmcgPSBzaW1w
bGVOYW1lLnJlc29sdmVUeXBlQmluZGluZygpOworCQlhc3NlcnROdWxsKHR5cGVCaW5kaW5nKTsK
KwkJYmluZGluZyA9IHNpbXBsZU5hbWUucmVzb2x2ZUJpbmRpbmcoKTsKKwkJYXNzZXJ0VHJ1ZSgi
bm90IGEgcGFja2FnZSBiaW5kaW5nIiwgYmluZGluZy5nZXRLaW5kKCkgPT0gSUJpbmRpbmcuUEFD
S0FHRSk7CisJCWFzc2VydEVxdWFscygid3JvbmcgcGFja2FnZSBiaW5kaW5nIiwgInBhY2thZ2Ug
dGVzdDQwNDQ4OS5idWciLCBiaW5kaW5nLnRvU3RyaW5nKCkpOworCQkKKwkJLy8gYW5ub3RhdGlv
bnMgb2YgcGFja2FnZSBxdWFsaWZpZWQgdHlwZQorCQlhbm5vdGF0aW9ucyA9IHBhY2thZ2VRdWFs
aWZpZWRUeXBlLmFubm90YXRpb25zKCk7CisJCWFzc2VydFRydWUoYW5ub3RhdGlvbnMuc2l6ZSgp
ID09IDEpOworCQlhbm5vdGF0aW9uID0gKEFubm90YXRpb24pIGFubm90YXRpb25zLmdldCgwKTsK
KwkJdHlwZUJpbmRpbmcgPSBhbm5vdGF0aW9uLnJlc29sdmVUeXBlQmluZGluZygpOworCQlhc3Nl
cnROb3ROdWxsKCJudWxsIGJpbmRpbmciLCB0eXBlQmluZGluZyk7CisJCWFzc2VydEVxdWFscygi
bm90IGEgdmFsaWQgYmluZGluZyIsICJ0ZXN0NDA0NDg5LmJ1Zy5YLk5vbk51bGwiLCB0eXBlQmlu
ZGluZy5nZXRRdWFsaWZpZWROYW1lKCkpOworCQlhbm5vdGF0aW9uQmluZGluZyA9IGFubm90YXRp
b24ucmVzb2x2ZUFubm90YXRpb25CaW5kaW5nKCk7CisJCWFzc2VydEVxdWFscygibm90IGEgdmFs
aWQgYW5ub3RhdGlvbiBiaW5kaW5nIiwgIkBOb25OdWxsKCkiLCBhbm5vdGF0aW9uQmluZGluZy50
b1N0cmluZygpKTsKKwkJbmFtZSA9IGFubm90YXRpb24uZ2V0VHlwZU5hbWUoKTsKKwkJYXNzZXJ0
VHJ1ZShuYW1lLmlzU2ltcGxlTmFtZSgpKTsKKwkJc2ltcGxlTmFtZSA9IChTaW1wbGVOYW1lKSBu
YW1lOworCQl0eXBlQmluZGluZyA9IHNpbXBsZU5hbWUucmVzb2x2ZVR5cGVCaW5kaW5nKCk7CisJ
CWNoZWNrU291cmNlUmFuZ2Uoc2ltcGxlTmFtZSwgIk5vbk51bGwiLCBzb3VyY2UpOworCQlhc3Nl
cnROb3ROdWxsKHR5cGVCaW5kaW5nKTsKKwkJCisJCS8vIG5hbWUgb2YgdGhlIHBhY2thZ2UgcXVh
bGlmaWVkIHR5cGUKKwkJc2ltcGxlTmFtZSA9IHBhY2thZ2VRdWFsaWZpZWRUeXBlLmdldE5hbWUo
KTsKKwkJY2hlY2tTb3VyY2VSYW5nZShzaW1wbGVOYW1lLCAiRmlsZU5vdEZvdW5kRXhjZXB0aW9u
Iiwgc291cmNlKTsKKwkJdHlwZUJpbmRpbmcgPSBzaW1wbGVOYW1lLnJlc29sdmVUeXBlQmluZGlu
ZygpOworCQlhc3NlcnROb3ROdWxsKHR5cGVCaW5kaW5nKTsKKwkJCisJCS8vIHRocm93cworCQl0
eXBlID0gKFR5cGUpIG1ldGhvZERlY2wudGhyb3duRXhjZXB0aW9uVHlwZXMoKS5nZXQoMCk7CisJ
CWFzc2VydFRydWUodHlwZS5pc1BhY2thZ2VRdWFsaWZpZWRUeXBlKCkpOworCQlwYWNrYWdlUXVh
bGlmaWVkVHlwZSA9IChQYWNrYWdlUXVhbGlmaWVkVHlwZSkgdHlwZTsKKwkJY2hlY2tTb3VyY2VS
YW5nZShwYWNrYWdlUXVhbGlmaWVkVHlwZSwgInRlc3Q0MDQ0ODkuYnVnLkBOb25OdWxsIEVPRkV4
Y2VwdGlvbiIsIHNvdXJjZSk7CisJCXR5cGVCaW5kaW5nID0gcGFja2FnZVF1YWxpZmllZFR5cGUu
cmVzb2x2ZUJpbmRpbmcoKTsKKwkJYXNzZXJ0Tm90TnVsbCgibnVsbCBiaW5kaW5nIiwgdHlwZUJp
bmRpbmcpOworCQlhc3NlcnRFcXVhbHMoIm5vdCBhIHZhbGlkIGJpbmRpbmciLCAidGVzdDQwNDQ4
OS5idWcuRU9GRXhjZXB0aW9uIiwgdHlwZUJpbmRpbmcuZ2V0UXVhbGlmaWVkTmFtZSgpKTsKKwkJ
CisJCS8vIHF1YWxpZmllciBvZiB0aGUgcGFja2FnZSBxdWFsaWZpZWQgdHlwZQorCQluYW1lID0g
cGFja2FnZVF1YWxpZmllZFR5cGUuZ2V0UXVhbGlmaWVyKCk7CisJCWFzc2VydFRydWUobmFtZS5p
c1F1YWxpZmllZE5hbWUoKSk7CisJCXF1YWxpZmllZE5hbWUgPSAoUXVhbGlmaWVkTmFtZSkgbmFt
ZTsKKwkJY2hlY2tTb3VyY2VSYW5nZShxdWFsaWZpZWROYW1lLCAidGVzdDQwNDQ4OS5idWciLCBz
b3VyY2UpOworCQl0eXBlQmluZGluZyA9IHF1YWxpZmllZE5hbWUucmVzb2x2ZVR5cGVCaW5kaW5n
KCk7CisJCWFzc2VydE51bGwodHlwZUJpbmRpbmcpOworCQliaW5kaW5nID0gcXVhbGlmaWVkTmFt
ZS5yZXNvbHZlQmluZGluZygpOworCQlhc3NlcnRUcnVlKCJub3QgYSBwYWNrYWdlIGJpbmRpbmci
LCBiaW5kaW5nLmdldEtpbmQoKSA9PSBJQmluZGluZy5QQUNLQUdFKTsKKwkJYXNzZXJ0RXF1YWxz
KCJ3cm9uZyBwYWNrYWdlIGJpbmRpbmciLCAicGFja2FnZSB0ZXN0NDA0NDg5LmJ1ZyIsIGJpbmRp
bmcudG9TdHJpbmcoKSk7CisJCW5hbWUgPSBxdWFsaWZpZWROYW1lLmdldFF1YWxpZmllcigpOwor
CQlhc3NlcnRUcnVlKCJ3cm9uZyBuYW1lIHR5cGUiLCBuYW1lLmlzU2ltcGxlTmFtZSgpKTsKKwkJ
c2ltcGxlTmFtZSA9IChTaW1wbGVOYW1lKSBuYW1lOworCQljaGVja1NvdXJjZVJhbmdlKHNpbXBs
ZU5hbWUsICJ0ZXN0NDA0NDg5Iiwgc291cmNlKTsKKwkJdHlwZUJpbmRpbmcgPSBzaW1wbGVOYW1l
LnJlc29sdmVUeXBlQmluZGluZygpOworCQlhc3NlcnROdWxsKHR5cGVCaW5kaW5nKTsKKwkJYmlu
ZGluZyA9IHNpbXBsZU5hbWUucmVzb2x2ZUJpbmRpbmcoKTsKKwkJYXNzZXJ0VHJ1ZSgibm90IGEg
cGFja2FnZSBiaW5kaW5nIiwgYmluZGluZy5nZXRLaW5kKCkgPT0gSUJpbmRpbmcuUEFDS0FHRSk7
CisJCWFzc2VydEVxdWFscygid3JvbmcgcGFja2FnZSBiaW5kaW5nIiwgInBhY2thZ2UgdGVzdDQw
NDQ4OSIsIGJpbmRpbmcudG9TdHJpbmcoKSk7CisJCXNpbXBsZU5hbWUgPSBxdWFsaWZpZWROYW1l
LmdldE5hbWUoKTsKKwkJY2hlY2tTb3VyY2VSYW5nZShzaW1wbGVOYW1lLCAiYnVnIiwgc291cmNl
KTsKKwkJdHlwZUJpbmRpbmcgPSBzaW1wbGVOYW1lLnJlc29sdmVUeXBlQmluZGluZygpOworCQlh
c3NlcnROdWxsKHR5cGVCaW5kaW5nKTsKKwkJYmluZGluZyA9IHNpbXBsZU5hbWUucmVzb2x2ZUJp
bmRpbmcoKTsKKwkJYXNzZXJ0VHJ1ZSgibm90IGEgcGFja2FnZSBiaW5kaW5nIiwgYmluZGluZy5n
ZXRLaW5kKCkgPT0gSUJpbmRpbmcuUEFDS0FHRSk7CisJCWFzc2VydEVxdWFscygid3JvbmcgcGFj
a2FnZSBiaW5kaW5nIiwgInBhY2thZ2UgdGVzdDQwNDQ4OS5idWciLCBiaW5kaW5nLnRvU3RyaW5n
KCkpOworCQkKKwkJLy8gYW5ub3RhdGlvbnMgb2YgcGFja2FnZSBxdWFsaWZpZWQgdHlwZQorCQlh
bm5vdGF0aW9ucyA9IHBhY2thZ2VRdWFsaWZpZWRUeXBlLmFubm90YXRpb25zKCk7CisJCWFzc2Vy
dFRydWUoYW5ub3RhdGlvbnMuc2l6ZSgpID09IDEpOworCQlhbm5vdGF0aW9uID0gKEFubm90YXRp
b24pIGFubm90YXRpb25zLmdldCgwKTsKKwkJdHlwZUJpbmRpbmcgPSBhbm5vdGF0aW9uLnJlc29s
dmVUeXBlQmluZGluZygpOworCQlhc3NlcnROb3ROdWxsKCJudWxsIGJpbmRpbmciLCB0eXBlQmlu
ZGluZyk7CisJCWFzc2VydEVxdWFscygibm90IGEgdmFsaWQgYmluZGluZyIsICJ0ZXN0NDA0NDg5
LmJ1Zy5YLk5vbk51bGwiLCB0eXBlQmluZGluZy5nZXRRdWFsaWZpZWROYW1lKCkpOworCQlhbm5v
dGF0aW9uQmluZGluZyA9IGFubm90YXRpb24ucmVzb2x2ZUFubm90YXRpb25CaW5kaW5nKCk7CisJ
CWFzc2VydEVxdWFscygibm90IGEgdmFsaWQgYW5ub3RhdGlvbiBiaW5kaW5nIiwgIkBOb25OdWxs
KCkiLCBhbm5vdGF0aW9uQmluZGluZy50b1N0cmluZygpKTsKKwkJbmFtZSA9IGFubm90YXRpb24u
Z2V0VHlwZU5hbWUoKTsKKwkJYXNzZXJ0VHJ1ZShuYW1lLmlzU2ltcGxlTmFtZSgpKTsKKwkJc2lt
cGxlTmFtZSA9IChTaW1wbGVOYW1lKSBuYW1lOworCQl0eXBlQmluZGluZyA9IHNpbXBsZU5hbWUu
cmVzb2x2ZVR5cGVCaW5kaW5nKCk7CisJCWNoZWNrU291cmNlUmFuZ2Uoc2ltcGxlTmFtZSwgIk5v
bk51bGwiLCBzb3VyY2UpOworCQlhc3NlcnROb3ROdWxsKHR5cGVCaW5kaW5nKTsKKwkJCisJCS8v
IG5hbWUgb2YgdGhlIHBhY2thZ2UgcXVhbGlmaWVkIHR5cGUKKwkJc2ltcGxlTmFtZSA9IHBhY2th
Z2VRdWFsaWZpZWRUeXBlLmdldE5hbWUoKTsKKwkJY2hlY2tTb3VyY2VSYW5nZShzaW1wbGVOYW1l
LCAiRU9GRXhjZXB0aW9uIiwgc291cmNlKTsKKwkJdHlwZUJpbmRpbmcgPSBzaW1wbGVOYW1lLnJl
c29sdmVUeXBlQmluZGluZygpOworCQlhc3NlcnROb3ROdWxsKHR5cGVCaW5kaW5nKTsKKworCQlu
b2RlID0gKEFTVE5vZGUpIHR5cGVEZWNsYXJhdGlvbi5ib2R5RGVjbGFyYXRpb25zKCkuZ2V0KDMp
OworCQlhc3NlcnRFcXVhbHMoIk5vdCBhIGZpZWxkIGRlY2xhcmF0aW9uIiwgQVNUTm9kZS5GSUVM
RF9ERUNMQVJBVElPTiwgbm9kZS5nZXROb2RlVHlwZSgpKTsJCQorCQlGaWVsZERlY2xhcmF0aW9u
IGZpZWxkID0gKEZpZWxkRGVjbGFyYXRpb24pIG5vZGU7CisJCXR5cGUgPSBmaWVsZC5nZXRUeXBl
KCk7CisJCWFzc2VydFRydWUodHlwZS5pc1F1YWxpZmllZFR5cGUoKSk7CisJCVF1YWxpZmllZFR5
cGUgcXVhbGlmaWVkVHlwZSA9IChRdWFsaWZpZWRUeXBlKSB0eXBlOworCQlwYWNrYWdlUXVhbGlm
aWVkVHlwZSA9IChQYWNrYWdlUXVhbGlmaWVkVHlwZSlxdWFsaWZpZWRUeXBlLmdldFF1YWxpZmll
cigpOworCQljaGVja1NvdXJjZVJhbmdlKHBhY2thZ2VRdWFsaWZpZWRUeXBlLCAidGVzdDQwNDQ4
OS5idWcuQE5vbk51bGwgWCIsIHNvdXJjZSk7CisJCXR5cGVCaW5kaW5nID0gcGFja2FnZVF1YWxp
ZmllZFR5cGUucmVzb2x2ZUJpbmRpbmcoKTsKKwkJYXNzZXJ0Tm90TnVsbCgibnVsbCBiaW5kaW5n
IiwgdHlwZUJpbmRpbmcpOworCQlhc3NlcnRFcXVhbHMoIm5vdCBhIHZhbGlkIGJpbmRpbmciLCAi
dGVzdDQwNDQ4OS5idWcuWC5Jbm5lciIsIHR5cGVCaW5kaW5nLmdldFF1YWxpZmllZE5hbWUoKSk7
CisJCQorCQkvLyBxdWFsaWZpZXIgb2YgdGhlIHBhY2thZ2UgcXVhbGlmaWVkIHR5cGUKKwkJbmFt
ZSA9IHBhY2thZ2VRdWFsaWZpZWRUeXBlLmdldFF1YWxpZmllcigpOworCQlhc3NlcnRUcnVlKG5h
bWUuaXNRdWFsaWZpZWROYW1lKCkpOworCQlxdWFsaWZpZWROYW1lID0gKFF1YWxpZmllZE5hbWUp
IG5hbWU7CisJCWNoZWNrU291cmNlUmFuZ2UocXVhbGlmaWVkTmFtZSwgInRlc3Q0MDQ0ODkuYnVn
Iiwgc291cmNlKTsKKwkJdHlwZUJpbmRpbmcgPSBxdWFsaWZpZWROYW1lLnJlc29sdmVUeXBlQmlu
ZGluZygpOworCQlhc3NlcnROdWxsKHR5cGVCaW5kaW5nKTsKKwkJYmluZGluZyA9IHF1YWxpZmll
ZE5hbWUucmVzb2x2ZUJpbmRpbmcoKTsKKwkJYXNzZXJ0VHJ1ZSgibm90IGEgcGFja2FnZSBiaW5k
aW5nIiwgYmluZGluZy5nZXRLaW5kKCkgPT0gSUJpbmRpbmcuUEFDS0FHRSk7CisJCWFzc2VydEVx
dWFscygid3JvbmcgcGFja2FnZSBiaW5kaW5nIiwgInBhY2thZ2UgdGVzdDQwNDQ4OS5idWciLCBi
aW5kaW5nLnRvU3RyaW5nKCkpOworCQluYW1lID0gcXVhbGlmaWVkTmFtZS5nZXRRdWFsaWZpZXIo
KTsKKwkJYXNzZXJ0VHJ1ZSgid3JvbmcgbmFtZSB0eXBlIiwgbmFtZS5pc1NpbXBsZU5hbWUoKSk7
CisJCXNpbXBsZU5hbWUgPSAoU2ltcGxlTmFtZSkgbmFtZTsKKwkJY2hlY2tTb3VyY2VSYW5nZShz
aW1wbGVOYW1lLCAidGVzdDQwNDQ4OSIsIHNvdXJjZSk7CisJCXR5cGVCaW5kaW5nID0gc2ltcGxl
TmFtZS5yZXNvbHZlVHlwZUJpbmRpbmcoKTsKKwkJYXNzZXJ0TnVsbCh0eXBlQmluZGluZyk7CisJ
CWJpbmRpbmcgPSBzaW1wbGVOYW1lLnJlc29sdmVCaW5kaW5nKCk7CisJCWFzc2VydFRydWUoIm5v
dCBhIHBhY2thZ2UgYmluZGluZyIsIGJpbmRpbmcuZ2V0S2luZCgpID09IElCaW5kaW5nLlBBQ0tB
R0UpOworCQlhc3NlcnRFcXVhbHMoIndyb25nIHBhY2thZ2UgYmluZGluZyIsICJwYWNrYWdlIHRl
c3Q0MDQ0ODkiLCBiaW5kaW5nLnRvU3RyaW5nKCkpOworCQlzaW1wbGVOYW1lID0gcXVhbGlmaWVk
TmFtZS5nZXROYW1lKCk7CisJCWNoZWNrU291cmNlUmFuZ2Uoc2ltcGxlTmFtZSwgImJ1ZyIsIHNv
dXJjZSk7CisJCXR5cGVCaW5kaW5nID0gc2ltcGxlTmFtZS5yZXNvbHZlVHlwZUJpbmRpbmcoKTsK
KwkJYXNzZXJ0TnVsbCh0eXBlQmluZGluZyk7CisJCWJpbmRpbmcgPSBzaW1wbGVOYW1lLnJlc29s
dmVCaW5kaW5nKCk7CisJCWFzc2VydFRydWUoIm5vdCBhIHBhY2thZ2UgYmluZGluZyIsIGJpbmRp
bmcuZ2V0S2luZCgpID09IElCaW5kaW5nLlBBQ0tBR0UpOworCQlhc3NlcnRFcXVhbHMoIndyb25n
IHBhY2thZ2UgYmluZGluZyIsICJwYWNrYWdlIHRlc3Q0MDQ0ODkuYnVnIiwgYmluZGluZy50b1N0
cmluZygpKTsKKwkJCisJCS8vIGFubm90YXRpb25zIG9mIHBhY2thZ2UgcXVhbGlmaWVkIHR5cGUK
KwkJYW5ub3RhdGlvbnMgPSBwYWNrYWdlUXVhbGlmaWVkVHlwZS5hbm5vdGF0aW9ucygpOworCQlh
c3NlcnRUcnVlKGFubm90YXRpb25zLnNpemUoKSA9PSAxKTsKKwkJYW5ub3RhdGlvbiA9IChBbm5v
dGF0aW9uKSBhbm5vdGF0aW9ucy5nZXQoMCk7CisJCXR5cGVCaW5kaW5nID0gYW5ub3RhdGlvbi5y
ZXNvbHZlVHlwZUJpbmRpbmcoKTsKKwkJYXNzZXJ0Tm90TnVsbCgibnVsbCBiaW5kaW5nIiwgdHlw
ZUJpbmRpbmcpOworCQlhc3NlcnRFcXVhbHMoIm5vdCBhIHZhbGlkIGJpbmRpbmciLCAidGVzdDQw
NDQ4OS5idWcuWC5Ob25OdWxsIiwgdHlwZUJpbmRpbmcuZ2V0UXVhbGlmaWVkTmFtZSgpKTsKKwkJ
YW5ub3RhdGlvbkJpbmRpbmcgPSBhbm5vdGF0aW9uLnJlc29sdmVBbm5vdGF0aW9uQmluZGluZygp
OworCQlhc3NlcnRFcXVhbHMoIm5vdCBhIHZhbGlkIGFubm90YXRpb24gYmluZGluZyIsICJATm9u
TnVsbCgpIiwgYW5ub3RhdGlvbkJpbmRpbmcudG9TdHJpbmcoKSk7CisJCW5hbWUgPSBhbm5vdGF0
aW9uLmdldFR5cGVOYW1lKCk7CisJCWFzc2VydFRydWUobmFtZS5pc1NpbXBsZU5hbWUoKSk7CisJ
CXNpbXBsZU5hbWUgPSAoU2ltcGxlTmFtZSkgbmFtZTsKKwkJdHlwZUJpbmRpbmcgPSBzaW1wbGVO
YW1lLnJlc29sdmVUeXBlQmluZGluZygpOworCQljaGVja1NvdXJjZVJhbmdlKHNpbXBsZU5hbWUs
ICJOb25OdWxsIiwgc291cmNlKTsKKwkJYXNzZXJ0Tm90TnVsbCh0eXBlQmluZGluZyk7CisJCQor
CQkvLyBuYW1lIG9mIHRoZSBwYWNrYWdlIHF1YWxpZmllZCB0eXBlCisJCXNpbXBsZU5hbWUgPSBw
YWNrYWdlUXVhbGlmaWVkVHlwZS5nZXROYW1lKCk7CisJCWNoZWNrU291cmNlUmFuZ2Uoc2ltcGxl
TmFtZSwgIlgiLCBzb3VyY2UpOworCQl0eXBlQmluZGluZyA9IHNpbXBsZU5hbWUucmVzb2x2ZVR5
cGVCaW5kaW5nKCk7CisJCWFzc2VydE5vdE51bGwodHlwZUJpbmRpbmcpOworCQkKKwl9CiB9CmRp
ZmYgLS1naXQgYS9vcmcuZWNsaXBzZS5qZHQuY29yZS50ZXN0cy5tb2RlbC9zcmMvb3JnL2VjbGlw
c2UvamR0L2NvcmUvdGVzdHMvZG9tL0FTVE1hdGNoZXJUZXN0LmphdmEgYi9vcmcuZWNsaXBzZS5q
ZHQuY29yZS50ZXN0cy5tb2RlbC9zcmMvb3JnL2VjbGlwc2UvamR0L2NvcmUvdGVzdHMvZG9tL0FT
VE1hdGNoZXJUZXN0LmphdmEKaW5kZXggZWIwNTlhYS4uNmFjYmJlOSAxMDA2NDQKLS0tIGEvb3Jn
LmVjbGlwc2UuamR0LmNvcmUudGVzdHMubW9kZWwvc3JjL29yZy9lY2xpcHNlL2pkdC9jb3JlL3Rl
c3RzL2RvbS9BU1RNYXRjaGVyVGVzdC5qYXZhCisrKyBiL29yZy5lY2xpcHNlLmpkdC5jb3JlLnRl
c3RzLm1vZGVsL3NyYy9vcmcvZWNsaXBzZS9qZHQvY29yZS90ZXN0cy9kb20vQVNUTWF0Y2hlclRl
c3QuamF2YQpAQCAtNDUzLDYgKzQ1Myw5IEBACiAJCXB1YmxpYyBib29sZWFuIG1hdGNoKFBhY2th
Z2VEZWNsYXJhdGlvbiBub2RlLCBPYmplY3Qgb3RoZXIpIHsKIAkJCXJldHVybiBzdGFuZGFyZEJv
ZHkobm9kZSwgb3RoZXIsIHRoaXMuc3VwZXJNYXRjaCA/IHN1cGVyLm1hdGNoKG5vZGUsIG90aGVy
KSA6IGZhbHNlKTsKIAkJfQorCQlwdWJsaWMgYm9vbGVhbiBtYXRjaChQYWNrYWdlUXVhbGlmaWVk
VHlwZSBub2RlLCBPYmplY3Qgb3RoZXIpIHsKKwkJCXJldHVybiBzdGFuZGFyZEJvZHkobm9kZSwg
b3RoZXIsIHRoaXMuc3VwZXJNYXRjaCA/IHN1cGVyLm1hdGNoKG5vZGUsIG90aGVyKSA6IGZhbHNl
KTsKKwkJfQogCQlwdWJsaWMgYm9vbGVhbiBtYXRjaChQYXJhbWV0ZXJpemVkVHlwZSBub2RlLCBP
YmplY3Qgb3RoZXIpIHsKIAkJCXJldHVybiBzdGFuZGFyZEJvZHkobm9kZSwgb3RoZXIsIHRoaXMu
c3VwZXJNYXRjaCA/IHN1cGVyLm1hdGNoKG5vZGUsIG90aGVyKSA6IGZhbHNlKTsKIAkJfQpAQCAt
NzA1LDYgKzcwOCwxNSBAQAogCX0KIAogCS8qKiBAZGVwcmVjYXRlZCB1c2luZyBkZXByZWNhdGVk
IGNvZGUgKi8KKwlwdWJsaWMgdm9pZCB0ZXN0UGFja2FnZVF1YWxpZmllZFR5cGUoKSB7CisJCWlm
ICh0aGlzLmFzdC5hcGlMZXZlbCgpIDwgQVNULkpMUzgpIHsKKwkJCXJldHVybjsKKwkJfQorCQlU
eXBlIHgxID0gdGhpcy5hc3QubmV3UGFja2FnZVF1YWxpZmllZFR5cGUodGhpcy5hc3QubmV3UXVh
bGlmaWVkTmFtZSh0aGlzLk4yLCB0aGlzLk4zKSwgdGhpcy5OMSk7CisJCWJhc2ljTWF0Y2goeDEp
OworCX0KKworCS8qKiBAZGVwcmVjYXRlZCB1c2luZyBkZXByZWNhdGVkIGNvZGUgKi8KIAlwdWJs
aWMgdm9pZCB0ZXN0UGFyYW1ldGVyaXplZFR5cGUoKSB7CiAJCWlmICh0aGlzLmFzdC5hcGlMZXZl
bCgpID09IEFTVC5KTFMyKSB7CiAJCQlyZXR1cm47CmRpZmYgLS1naXQgYS9vcmcuZWNsaXBzZS5q
ZHQuY29yZS50ZXN0cy5tb2RlbC9zcmMvb3JnL2VjbGlwc2UvamR0L2NvcmUvdGVzdHMvZG9tL0FT
VFN0cnVjdHVyYWxQcm9wZXJ0eVRlc3QuamF2YSBiL29yZy5lY2xpcHNlLmpkdC5jb3JlLnRlc3Rz
Lm1vZGVsL3NyYy9vcmcvZWNsaXBzZS9qZHQvY29yZS90ZXN0cy9kb20vQVNUU3RydWN0dXJhbFBy
b3BlcnR5VGVzdC5qYXZhCmluZGV4IGUzYzFjYjEuLjQzMzM2NDcgMTAwNjQ0Ci0tLSBhL29yZy5l
Y2xpcHNlLmpkdC5jb3JlLnRlc3RzLm1vZGVsL3NyYy9vcmcvZWNsaXBzZS9qZHQvY29yZS90ZXN0
cy9kb20vQVNUU3RydWN0dXJhbFByb3BlcnR5VGVzdC5qYXZhCisrKyBiL29yZy5lY2xpcHNlLmpk
dC5jb3JlLnRlc3RzLm1vZGVsL3NyYy9vcmcvZWNsaXBzZS9qZHQvY29yZS90ZXN0cy9kb20vQVNU
U3RydWN0dXJhbFByb3BlcnR5VGVzdC5qYXZhCkBAIC0zNTAsNyArMzUwLDcgQEAKIAkJCQkvLyBv
b3BzIC0gZ3Vlc3MgdGhhdCdzIG5vdCB2YWxpZAogCQkJfQogCQl9Ci0JCWFzc2VydEVxdWFscygi
V3JvbmcgbGFzdCBrbm93biB0eXBlIiwgODYsIGhpKTsgLy8gbGFzdCBrbm93biBvbmUKKwkJYXNz
ZXJ0RXF1YWxzKCJXcm9uZyBsYXN0IGtub3duIHR5cGUiLCA4NywgaGkpOyAvLyBsYXN0IGtub3du
IG9uZQogCQlhc3NlcnRFcXVhbHMoIldyb25nIG51bWJlciBvZiBkaXN0aW5jdCB0eXBlcyIsICBo
aSwgY2xhc3Nlcy5zaXplKCkpOyAvLyBhbGwgY2xhc3NlcyBhcmUgZGlzdGluY3QKIAl9CiB9CmRp
ZmYgLS1naXQgYS9vcmcuZWNsaXBzZS5qZHQuY29yZS50ZXN0cy5tb2RlbC9zcmMvb3JnL2VjbGlw
c2UvamR0L2NvcmUvdGVzdHMvZG9tL0FTVFZpc2l0b3JUZXN0LmphdmEgYi9vcmcuZWNsaXBzZS5q
ZHQuY29yZS50ZXN0cy5tb2RlbC9zcmMvb3JnL2VjbGlwc2UvamR0L2NvcmUvdGVzdHMvZG9tL0FT
VFZpc2l0b3JUZXN0LmphdmEKaW5kZXggMDA3MmVkOC4uZmYwZGIzYSAxMDA2NDQKLS0tIGEvb3Jn
LmVjbGlwc2UuamR0LmNvcmUudGVzdHMubW9kZWwvc3JjL29yZy9lY2xpcHNlL2pkdC9jb3JlL3Rl
c3RzL2RvbS9BU1RWaXNpdG9yVGVzdC5qYXZhCisrKyBiL29yZy5lY2xpcHNlLmpkdC5jb3JlLnRl
c3RzLm1vZGVsL3NyYy9vcmcvZWNsaXBzZS9qZHQvY29yZS90ZXN0cy9kb20vQVNUVmlzaXRvclRl
c3QuamF2YQpAQCAtMzgzLDYgKzM4MywxMyBAQAogCQkJQVNUVmlzaXRvclRlc3QudGhpcy5iLmFw
cGVuZChub2RlLmdldFByaW1pdGl2ZVR5cGVDb2RlKCkudG9TdHJpbmcoKSk7CiAJCQlBU1RWaXNp
dG9yVGVzdC50aGlzLmIuYXBwZW5kKCJ0UCkiKTsgLy8kTk9OLU5MUy0xJAogCQl9CisJCXB1Ymxp
YyBib29sZWFuIHZpc2l0KFBhY2thZ2VRdWFsaWZpZWRUeXBlIG5vZGUpIHsKKwkJCUFTVFZpc2l0
b3JUZXN0LnRoaXMuYi5hcHBlbmQoIih0UFEiKTsgLy8kTk9OLU5MUy0xJAorCQkJcmV0dXJuIGlz
VmlzaXRpbmdDaGlsZHJlbigpOworCQl9CisJCXB1YmxpYyB2b2lkIGVuZFZpc2l0KFBhY2thZ2VR
dWFsaWZpZWRUeXBlIG5vZGUpIHsKKwkJCUFTVFZpc2l0b3JUZXN0LnRoaXMuYi5hcHBlbmQoInRQ
USkiKTsgLy8kTk9OLU5MUy0xJAorCQl9CiAJCXB1YmxpYyBib29sZWFuIHZpc2l0KFBhcmFtZXRl
cml6ZWRUeXBlIG5vZGUpIHsKIAkJCUFTVFZpc2l0b3JUZXN0LnRoaXMuYi5hcHBlbmQoIih0TSIp
OyAvLyROT04tTkxTLTEkCiAJCQlyZXR1cm4gaXNWaXNpdGluZ0NoaWxkcmVuKCk7CkBAIC0xMTIy
LDYgKzExMjksMjAgQEAKIAl9CiAKIAkvKiogQGRlcHJlY2F0ZWQgdXNpbmcgZGVwcmVjYXRlZCBj
b2RlICovCisJcHVibGljIHZvaWQgdGVzdFBhY2thZ2VRdWFsaWZpZWRUeXBlKCkgeworCQlpZiAo
dGhpcy5hc3QuYXBpTGV2ZWwoKSA8IEFTVC5KTFM4KSB7CisJCQlyZXR1cm47CisJCX0KKwkJUXVh
bGlmaWVkTmFtZSBxID0gdGhpcy5hc3QubmV3UXVhbGlmaWVkTmFtZSh0aGlzLk4yLCB0aGlzLk4z
KTsKKwkJUGFja2FnZVF1YWxpZmllZFR5cGUgeDEgPSB0aGlzLmFzdC5uZXdQYWNrYWdlUXVhbGlm
aWVkVHlwZShxLCB0aGlzLk4xKTsKKwkJVGVzdFZpc2l0b3IgdjEgPSBuZXcgVGVzdFZpc2l0b3Io
KTsKKwkJdGhpcy5iLnNldExlbmd0aCgwKTsKKwkJeDEuYWNjZXB0KHYxKTsKKwkJU3RyaW5nIHJl
c3VsdCA9IHRoaXMuYi50b1N0cmluZygpOworCQlhc3NlcnRUcnVlKHJlc3VsdC5lcXVhbHMoIlso
dFBRIisiWyhuUSIrdGhpcy5OMlMrdGhpcy5OM1MrIm5RKV0iK3RoaXMuTjFTKyJ0UFEpXSIpKTsg
Ly8kTk9OLU5MUy0xJCAvLyROT04tTkxTLTIkCisJfQorCisJLyoqIEBkZXByZWNhdGVkIHVzaW5n
IGRlcHJlY2F0ZWQgY29kZSAqLwogCXB1YmxpYyB2b2lkIHRlc3RQYXJhbWV0ZXJpemVkVHlwZSgp
IHsKIAkJaWYgKHRoaXMuYXN0LmFwaUxldmVsKCkgPT0gQVNULkpMUzIpIHsKIAkJCXJldHVybjsK
ZGlmZiAtLWdpdCBhL29yZy5lY2xpcHNlLmpkdC5jb3JlLnRlc3RzLm1vZGVsL3dvcmtzcGFjZS9D
b252ZXJ0ZXIxOC9zcmMvdGVzdDQwNDQ4OS9idWcvWC5qYXZhIGIvb3JnLmVjbGlwc2UuamR0LmNv
cmUudGVzdHMubW9kZWwvd29ya3NwYWNlL0NvbnZlcnRlcjE4L3NyYy90ZXN0NDA0NDg5L2J1Zy9Y
LmphdmEKbmV3IGZpbGUgbW9kZSAxMDA2NDQKaW5kZXggMDAwMDAwMC4uNGNmNTQyYQotLS0gL2Rl
di9udWxsCisrKyBiL29yZy5lY2xpcHNlLmpkdC5jb3JlLnRlc3RzLm1vZGVsL3dvcmtzcGFjZS9D
b252ZXJ0ZXIxOC9zcmMvdGVzdDQwNDQ4OS9idWcvWC5qYXZhCkBAIC0wLDAgKzEsMzcgQEAKK3Bh
Y2thZ2UgdGVzdDQwNDQ4OS5idWc7CitpbXBvcnQgamF2YS5sYW5nLmFubm90YXRpb24uKjsKK3B1
YmxpYyBjbGFzcyBYIHsKKwlAVGFyZ2V0KEVsZW1lbnRUeXBlLlRZUEVfVVNFKQorCUBSZXRlbnRp
b24oUmV0ZW50aW9uUG9saWN5LlJVTlRJTUUpCisJQERvY3VtZW50ZWQKKwlzdGF0aWMgQGludGVy
ZmFjZSBOb25OdWxsIHsgfQorCWNsYXNzIElubmVyIHt9CisJCisJLyoqCisgCSogQHBhcmFtIGFy
ZyAgCisgCSovCisJdGVzdDQwNDQ4OS5idWcuQE5vbk51bGwgSU9FeGNlcHRpb24gZm9vKAorCQkJ
dGVzdDQwNDQ4OS5idWcuQE5vbk51bGwgRmlsZU5vdEZvdW5kRXhjZXB0aW9uIGFyZykKKwkJdGhy
b3dzIHRlc3Q0MDQ0ODkuYnVnLkBOb25OdWxsIEVPRkV4Y2VwdGlvbiB7CisJCXRyeSB7CisJCQl0
ZXN0NDA0NDg5LmJ1Zy5ATm9uTnVsbCBJT0Vycm9yIGUgPSBuZXcgdGVzdDQwNDQ4OS5idWcuSU9F
cnJvcigpOworCQkJdGhyb3cgZTsKKwkJfSBjYXRjaCAodGVzdDQwNDQ4OS5idWcuQE5vbk51bGwg
SU9FcnJvciBlKSB7CisJCX0KKwkJcmV0dXJuIG51bGw7CisJfSAKKwl0ZXN0NDA0NDg5LmJ1Zy5A
Tm9uTnVsbCBYLkBOb25OdWxsIElubmVyIGZJbm5lcjsKK30gCitAamF2YS5sYW5nLmFubm90YXRp
b24uVGFyZ2V0KGphdmEubGFuZy5hbm5vdGF0aW9uLkVsZW1lbnRUeXBlLlRZUEVfVVNFKSBAaW50
ZXJmYWNlIE1hcmtlciB7fSAKK0BqYXZhLmxhbmcuYW5ub3RhdGlvbi5UYXJnZXQoamF2YS5sYW5n
LmFubm90YXRpb24uRWxlbWVudFR5cGUuVFlQRV9VU0UpIEBpbnRlcmZhY2UgQSB7fSAKK0BqYXZh
LmxhbmcuYW5ub3RhdGlvbi5UYXJnZXQoamF2YS5sYW5nLmFubm90YXRpb24uRWxlbWVudFR5cGUu
VFlQRV9VU0UpIEBpbnRlcmZhY2UgQiB7fSAKKworY2xhc3MgT3V0ZXIgeworCXB1YmxpYyBjbGFz
cyBJbm5lciB7CisJCXB1YmxpYyBjbGFzcyBEZWVwZXIge30KKwl9Cit9CitjbGFzcyBJT0V4Y2Vw
dGlvbiBleHRlbmRzIEV4Y2VwdGlvbiB7cHJpdmF0ZSBzdGF0aWMgZmluYWwgbG9uZyBzZXJpYWxW
ZXJzaW9uVUlEPTEwMDAxTDt9CitjbGFzcyBGaWxlTm90Rm91bmRFeGNlcHRpb24gZXh0ZW5kcyBF
eGNlcHRpb257cHJpdmF0ZSBzdGF0aWMgZmluYWwgbG9uZyBzZXJpYWxWZXJzaW9uVUlEPTEwMDAy
TDt9CitjbGFzcyBFT0ZFeGNlcHRpb24gZXh0ZW5kcyBFeGNlcHRpb257cHJpdmF0ZSBzdGF0aWMg
ZmluYWwgbG9uZyBzZXJpYWxWZXJzaW9uVUlEPTEwMDAzTDt9CitjbGFzcyBJT0Vycm9yIGV4dGVu
ZHMgRXhjZXB0aW9ue3ByaXZhdGUgc3RhdGljIGZpbmFsIGxvbmcgc2VyaWFsVmVyc2lvblVJRD0x
MDAwNEw7fQpcIE5vIG5ld2xpbmUgYXQgZW5kIG9mIGZpbGUKZGlmZiAtLWdpdCBhL29yZy5lY2xp
cHNlLmpkdC5jb3JlL2RvbS9vcmcvZWNsaXBzZS9qZHQvY29yZS9kb20vQVNULmphdmEgYi9vcmcu
ZWNsaXBzZS5qZHQuY29yZS9kb20vb3JnL2VjbGlwc2UvamR0L2NvcmUvZG9tL0FTVC5qYXZhCmlu
ZGV4IDRkODg5NjMuLmUzOTI5NTYgMTAwNjQ0Ci0tLSBhL29yZy5lY2xpcHNlLmpkdC5jb3JlL2Rv
bS9vcmcvZWNsaXBzZS9qZHQvY29yZS9kb20vQVNULmphdmEKKysrIGIvb3JnLmVjbGlwc2UuamR0
LmNvcmUvZG9tL29yZy9lY2xpcHNlL2pkdC9jb3JlL2RvbS9BU1QuamF2YQpAQCAtMTk2Niw2ICsx
OTY2LDI5IEBACiAJfQogCiAJLyoqCisJICogQ3JlYXRlcyBhbmQgcmV0dXJucyBhIG5ldyB1bnBh
cmVudGVkIHBhY2thZ2UgcXVhbGlmaWVkIHR5cGUgbm9kZSB3aXRoCisJICogdGhlIGdpdmVuIHF1
YWxpZmllciBhbmQgbmFtZS4KKwkgKgorCSAqIEBwYXJhbSBxdWFsaWZpZXIgdGhlIHBhY2thZ2Ug
cXVhbGlmaWVyIHR5cGUgbm9kZQorCSAqIEBwYXJhbSBuYW1lIHRoZSBzaW1wbGUgbmFtZSBiZWlu
ZyBxdWFsaWZpZWQKKwkgKiBAcmV0dXJuIGEgbmV3IHVucGFyZW50ZWQgcXVhbGlmaWVkIHR5cGUg
bm9kZQorCSAqIEBleGNlcHRpb24gSWxsZWdhbEFyZ3VtZW50RXhjZXB0aW9uIGlmOgorCSAqIDx1
bD4KKwkgKiA8bGk+dGhlIG5vZGUgYmVsb25ncyB0byBhIGRpZmZlcmVudCBBU1Q8L2xpPgorCSAq
IDxsaT50aGUgbm9kZSBhbHJlYWR5IGhhcyBhIHBhcmVudDwvbGk+CisJICogPC91bD4KKwkgKiBA
ZXhjZXB0aW9uIFVuc3VwcG9ydGVkT3BlcmF0aW9uRXhjZXB0aW9uIGlmIHRoaXMgb3BlcmF0aW9u
IGlzIHVzZWQgaW4KKwkgKiBhIEpMUzIsIEpMUzMgYW5kIEpMUzQgQVNUCisJICogQHNpbmNlIDMu
OQorCSAqLworCXB1YmxpYyBQYWNrYWdlUXVhbGlmaWVkVHlwZSBuZXdQYWNrYWdlUXVhbGlmaWVk
VHlwZShOYW1lIHF1YWxpZmllciwgU2ltcGxlTmFtZSBuYW1lKSB7CisJCVBhY2thZ2VRdWFsaWZp
ZWRUeXBlIHJlc3VsdCA9IG5ldyBQYWNrYWdlUXVhbGlmaWVkVHlwZSh0aGlzKTsKKwkJcmVzdWx0
LnNldFF1YWxpZmllcihxdWFsaWZpZXIpOworCQlyZXN1bHQuc2V0TmFtZShuYW1lKTsKKwkJcmV0
dXJuIHJlc3VsdDsKKwl9CisKKwkvKioKIAkgKiBDcmVhdGVzIGFuZCByZXR1cm5zIGEgbmV3IHVu
cGFyZW50ZWQgcGFyYW1ldGVyaXplZCB0eXBlIG5vZGUgd2l0aCB0aGUKIAkgKiBnaXZlbiB0eXBl
IGFuZCBhbiBlbXB0eSBsaXN0IG9mIHR5cGUgYXJndW1lbnRzLgogCSAqCmRpZmYgLS1naXQgYS9v
cmcuZWNsaXBzZS5qZHQuY29yZS9kb20vb3JnL2VjbGlwc2UvamR0L2NvcmUvZG9tL0FTVENvbnZl
cnRlci5qYXZhIGIvb3JnLmVjbGlwc2UuamR0LmNvcmUvZG9tL29yZy9lY2xpcHNlL2pkdC9jb3Jl
L2RvbS9BU1RDb252ZXJ0ZXIuamF2YQppbmRleCBiNzkwNjIyLi5iNjI2OTNmIDEwMDY0NAotLS0g
YS9vcmcuZWNsaXBzZS5qZHQuY29yZS9kb20vb3JnL2VjbGlwc2UvamR0L2NvcmUvZG9tL0FTVENv
bnZlcnRlci5qYXZhCisrKyBiL29yZy5lY2xpcHNlLmpkdC5jb3JlL2RvbS9vcmcvZWNsaXBzZS9q
ZHQvY29yZS9kb20vQVNUQ29udmVydGVyLmphdmEKQEAgLTE3LDYgKzE3LDcgQEAKIAogcGFja2Fn
ZSBvcmcuZWNsaXBzZS5qZHQuY29yZS5kb207CiAKK2ltcG9ydCBqYXZhLnV0aWwuQXJyYXlzOwog
aW1wb3J0IGphdmEudXRpbC5IYXNoU2V0OwogaW1wb3J0IGphdmEudXRpbC5JdGVyYXRvcjsKIGlt
cG9ydCBqYXZhLnV0aWwuTGlzdDsKQEAgLTU1LDYgKzU2LDggQEAKIGltcG9ydCBvcmcuZWNsaXBz
ZS5qZHQuaW50ZXJuYWwuY29tcGlsZXIuaW1wbC5Db21waWxlck9wdGlvbnM7CiBpbXBvcnQgb3Jn
LmVjbGlwc2UuamR0LmludGVybmFsLmNvbXBpbGVyLmxvb2t1cC5CbG9ja1Njb3BlOwogaW1wb3J0
IG9yZy5lY2xpcHNlLmpkdC5pbnRlcm5hbC5jb21waWxlci5sb29rdXAuRXh0cmFDb21waWxlck1v
ZGlmaWVyczsKK2ltcG9ydCBvcmcuZWNsaXBzZS5qZHQuaW50ZXJuYWwuY29tcGlsZXIubG9va3Vw
LlBhY2thZ2VCaW5kaW5nOworaW1wb3J0IG9yZy5lY2xpcHNlLmpkdC5pbnRlcm5hbC5jb21waWxl
ci5sb29rdXAuUmVmZXJlbmNlQmluZGluZzsKIGltcG9ydCBvcmcuZWNsaXBzZS5qZHQuaW50ZXJu
YWwuY29tcGlsZXIubG9va3VwLlR5cGVDb25zdGFudHM7CiBpbXBvcnQgb3JnLmVjbGlwc2UuamR0
LmludGVybmFsLmNvbXBpbGVyLnBhcnNlci5SZWNvdmVyeVNjYW5uZXI7CiBpbXBvcnQgb3JnLmVj
bGlwc2UuamR0LmludGVybmFsLmNvbXBpbGVyLnBhcnNlci5TY2FubmVyOwpAQCAtMzU0NCwxMyAr
MzU0Nyw3IEBACiAJCQkJCQlzaW1wbGVUeXBlLnNldE5hbWUobmFtZSk7CiAJCQkJCQlpbnQgc3Rh
cnQgPSAoaW50KShwb3NpdGlvbnNbMF0gPj4+IDMyKTsKIAkJCQkJCWludCBlbmQgPSAoaW50KXBv
c2l0aW9uc1tmaXJzdFR5cGVJbmRleF07Ci0JCQkJCQlzaW1wbGVUeXBlLnNldFNvdXJjZVJhbmdl
KHN0YXJ0LCBlbmQgLSBzdGFydCArIDEpOwotCQkJCQkJaWYgKHR5cGVBbm5vdGF0aW9ucyAhPSBu
dWxsICYmIChhbm5vdGF0aW9ucyA9IHR5cGVBbm5vdGF0aW9uc1tmaXJzdFR5cGVJbmRleF0pICE9
IG51bGwpIHsKLQkJCQkJCQlhbm5vdGF0ZVR5cGUoc2ltcGxlVHlwZSwgYW5ub3RhdGlvbnMpOwot
CQkJCQkJfQotCQkJCQkJaWYgKHRoaXMucmVzb2x2ZUJpbmRpbmdzKSB7Ci0JCQkJCQkJcmVjb3Jk
Tm9kZXMoc2ltcGxlVHlwZSwgdHlwZVJlZmVyZW5jZSk7Ci0JCQkJCQl9CisJCQkJCQlzZXRTb3Vy
Y2VBbm5vdGF0aW9uc0FuZEJpbmRpbmdzKHR5cGVSZWZlcmVuY2UsIHBvc2l0aW9ucywgdHlwZUFu
bm90YXRpb25zLCBmaXJzdFR5cGVJbmRleCwgMCwgZmlyc3RUeXBlSW5kZXgsIHNpbXBsZVR5cGUp
OwogCQkJCQkJVHlwZSBjdXJyZW50VHlwZSA9IHNpbXBsZVR5cGU7CQkJCQkJCiAJCQkJCQlpbnQg
aW5kZXhPZkVuY2xvc2luZ1R5cGUgPSAxOwogCQkJCQkJaWYgKHR5cGVBcmd1bWVudHMgIT0gbnVs
bCAmJiAoYXJndW1lbnRzID0gdHlwZUFyZ3VtZW50c1tmaXJzdFR5cGVJbmRleF0pICE9IG51bGwp
IHsKQEAgLTM2MjYsNyArMzYyMyw3IEBACiAJCQkJb3JnLmVjbGlwc2UuamR0LmludGVybmFsLmNv
bXBpbGVyLmFzdC5Bbm5vdGF0aW9uIFtdW10gdHlwZUFubm90YXRpb25zID0gdHlwZVJlZmVyZW5j
ZS5hbm5vdGF0aW9uczsKIAkJCQljaGFyIFtdW10gdG9rZW5zID0gcXVhbGlmaWVkVHlwZVJlZmVy
ZW5jZS50b2tlbnM7CiAJCQkJaW50IGxlbnRoID0gdG9rZW5zLmxlbmd0aDsKLQkJCQlpbnQgZmly
c3RUeXBlSW5kZXggPSBsZW50aCAtIDE7CisJCQkJaW50IGZpcnN0VHlwZUluZGV4ID0gbGVudGg7
CiAJCQkJCiAJCQkJaWYgKHR5cGVBbm5vdGF0aW9ucyAhPSBudWxsKSB7CiAJCQkJCWZvciAoaW50
IGkgPSAwOyBpIDwgbGVudGg7ICsraSkgewpAQCAtMzYzOCw1NyArMzYzNSw0MiBAQAogCQkJCX0g
IAogCQkJCXNvdXJjZVN0YXJ0ID0gKGludCkocG9zaXRpb25zWzBdPj4+MzIpOwogCQkJCU5hbWUg
bmFtZSA9IG51bGw7Ci0JCQkJaWYgKGZpcnN0VHlwZUluZGV4ID09IDApIHsKLQkJCQkJZmluYWwg
U2ltcGxlTmFtZSBzaW1wbGVOYW1lID0gbmV3IFNpbXBsZU5hbWUodGhpcy5hc3QpOwotCQkJCQlz
aW1wbGVOYW1lLmludGVybmFsU2V0SWRlbnRpZmllcihuZXcgU3RyaW5nKHRva2Vuc1swXSkpOwot
CQkJCQlyZWNvcmRQZW5kaW5nTmFtZVNjb3BlUmVzb2x1dGlvbihzaW1wbGVOYW1lKTsKLQkJCQkJ
aW50IHN0YXJ0ID0gKGludCkgKHBvc2l0aW9uc1swXSA+Pj4gMzIpOwotCQkJCQlpbnQgZW5kID0g
KGludCkgcG9zaXRpb25zWzBdOwotCQkJCQlzaW1wbGVOYW1lLnNldFNvdXJjZVJhbmdlKHN0YXJ0
LCBlbmQpOwotCQkJCQlzaW1wbGVOYW1lLmluZGV4ID0gMTsKLQkJCQkJbmFtZSA9IHNpbXBsZU5h
bWU7Ci0JCQkJCWlmICh0aGlzLnJlc29sdmVCaW5kaW5ncykgewotCQkJCQkJcmVjb3JkTm9kZXMo
c2ltcGxlTmFtZSwgdHlwZVJlZmVyZW5jZSk7Ci0JCQkJCX0JCQkJCQorCQkJCVR5cGUgY3VycmVu
dFR5cGUgPSBudWxsOworCQkJCWlmIChmaXJzdFR5cGVJbmRleCA9PSBsZW50aCkgey8vSnVzdCBh
IFF1YWxpZmllZE5hbWUKKwkJCQkJbmFtZSA9IHNldFF1YWxpZmllZE5hbWVOYW1lQW5kU291cmNl
UmFuZ2VzKHRva2VucywgcG9zaXRpb25zLCBsZW50aCAtIDEsIHR5cGVSZWZlcmVuY2UpOworCQkJ
CQljdXJyZW50VHlwZSA9IGdldFNpbXBsZVR5cGVXaXRoTmFtZUFuZEJpbmRpbmcobmFtZSwgdHlw
ZVJlZmVyZW5jZSwgcG9zaXRpb25zLCAwLCBsZW50aCAtIDEpOwogCQkJCX0gZWxzZSB7Ci0JCQkJ
CW5hbWUgPSBzZXRRdWFsaWZpZWROYW1lTmFtZUFuZFNvdXJjZVJhbmdlcyh0b2tlbnMsIHBvc2l0
aW9ucywgZmlyc3RUeXBlSW5kZXgsIHR5cGVSZWZlcmVuY2UpOwotCQkJCX0KLQkJCQlTaW1wbGVU
eXBlIHNpbXBsZVR5cGUgPSBuZXcgU2ltcGxlVHlwZSh0aGlzLmFzdCk7Ci0JCQkJc2ltcGxlVHlw
ZS5zZXROYW1lKG5hbWUpOwotCQkJCWludCBzdGFydCA9IChpbnQpKHBvc2l0aW9uc1swXSA+Pj4g
MzIpOwotCQkJCWludCBlbmQgPSAoaW50KXBvc2l0aW9uc1tmaXJzdFR5cGVJbmRleF07Ci0JCQkJ
c2ltcGxlVHlwZS5zZXRTb3VyY2VSYW5nZShzdGFydCwgZW5kIC0gc3RhcnQgKyAxKTsKLQkJCQlp
ZiAodHlwZUFubm90YXRpb25zICE9IG51bGwgJiYgKGFubm90YXRpb25zID0gdHlwZUFubm90YXRp
b25zW2ZpcnN0VHlwZUluZGV4XSkgIT0gbnVsbCkgewotCQkJCQlhbm5vdGF0ZVR5cGUoc2ltcGxl
VHlwZSwgYW5ub3RhdGlvbnMpOwotCQkJCX0KLQkJCQlpZiAodGhpcy5yZXNvbHZlQmluZGluZ3Mp
IHsKLQkJCQkJcmVjb3JkTm9kZXMoc2ltcGxlVHlwZSwgdHlwZVJlZmVyZW5jZSk7Ci0JCQkJfQot
CQkJCVR5cGUgY3VycmVudFR5cGUgPSBzaW1wbGVUeXBlOwotCQkJCQotCQkJCWZvciAoaW50IGkg
PSBmaXJzdFR5cGVJbmRleCArIDE7IGkgPCBsZW50aDsgKytpKSB7Ci0JCQkJCVNpbXBsZU5hbWUg
c2ltcGxlTmFtZSA9IG5ldyBTaW1wbGVOYW1lKHRoaXMuYXN0KTsKLQkJCQkJc2ltcGxlTmFtZS5p
bnRlcm5hbFNldElkZW50aWZpZXIobmV3IFN0cmluZyh0b2tlbnNbaV0pKTsKLQkJCQkJc2ltcGxl
TmFtZS5pbmRleCA9IGkgKyAxOwotCQkJCQlzdGFydCA9IChpbnQpIChwb3NpdGlvbnNbaV0gPj4+
IDMyKTsKLQkJCQkJZW5kID0gKGludCkgcG9zaXRpb25zW2ldOwotCQkJCQlzaW1wbGVOYW1lLnNl
dFNvdXJjZVJhbmdlKHN0YXJ0LCBlbmQgLSBzdGFydCArMSk7Ci0JCQkJCXJlY29yZFBlbmRpbmdO
YW1lU2NvcGVSZXNvbHV0aW9uKHNpbXBsZU5hbWUpOwotCQkJCQlRdWFsaWZpZWRUeXBlIHF1YWxp
ZmllZFR5cGUgPSBuZXcgUXVhbGlmaWVkVHlwZSh0aGlzLmFzdCk7Ci0JCQkJCXF1YWxpZmllZFR5
cGUuc2V0UXVhbGlmaWVyKGN1cnJlbnRUeXBlKTsKLQkJCQkJcXVhbGlmaWVkVHlwZS5zZXROYW1l
KHNpbXBsZU5hbWUpOwotCQkJCQlpZiAodHlwZUFubm90YXRpb25zICE9IG51bGwgJiYgKGFubm90
YXRpb25zID0gdHlwZUFubm90YXRpb25zW2ldKSAhPSBudWxsKSB7Ci0JCQkJCQlhbm5vdGF0ZVR5
cGUocXVhbGlmaWVkVHlwZSwgYW5ub3RhdGlvbnMpOworCQkJCQlpZiAoZmlyc3RUeXBlSW5kZXgg
PD0gMSkgeworCQkJCQkJbmFtZSA9IGNyZWF0ZVNpbXBsZU5hbWUodHlwZVJlZmVyZW5jZSwgcG9z
aXRpb25zLCB0b2tlbnMsIDAgKTsKKwkJCQkJCWZpcnN0VHlwZUluZGV4ID0gMTsKKwkJCQkJfSBl
bHNlIHsKKwkJCQkJCW5hbWUgPSBzZXRRdWFsaWZpZWROYW1lTmFtZUFuZFNvdXJjZVJhbmdlcyh0
b2tlbnMsIHBvc2l0aW9ucywgZmlyc3RUeXBlSW5kZXggLSAxLCB0eXBlUmVmZXJlbmNlKTsKKwkJ
CQkJfQkJCQkJCQorCisJCQkJCW9yZy5lY2xpcHNlLmpkdC5pbnRlcm5hbC5jb21waWxlci5sb29r
dXAuVHlwZUJpbmRpbmcgdHlwZUJpbmRpbmcgPSB0eXBlUmVmZXJlbmNlLnJlc29sdmVkVHlwZTsK
KwkJCQkJYm9vbGVhbiBjcmVhdGVQYWNrYWdlUXVhbGlmaWVkVHlwZSA9IGZhbHNlOworCQkJCQlp
ZiAodHlwZUJpbmRpbmcgaW5zdGFuY2VvZiBSZWZlcmVuY2VCaW5kaW5nKSB7CisJCQkJCQlSZWZl
cmVuY2VCaW5kaW5nIHJlZmVyZW5jZUJpbmRpbmcgPSAoUmVmZXJlbmNlQmluZGluZyl0eXBlQmlu
ZGluZzsJCQkKKwkJCQkJCVBhY2thZ2VCaW5kaW5nIHBhY2thZ2VCaW5kaW5nID0gcmVmZXJlbmNl
QmluZGluZy5nZXRQYWNrYWdlKCk7CisJCQkJCQlpZiAocGFja2FnZUJpbmRpbmcgIT0gbnVsbCAm
JiBBcnJheXMuZXF1YWxzKG5hbWUudG9TdHJpbmcoKS50b0NoYXJBcnJheSgpLCBwYWNrYWdlQmlu
ZGluZy5yZWFkYWJsZU5hbWUoKSkpIHsKKwkJCQkJCQljcmVhdGVQYWNrYWdlUXVhbGlmaWVkVHlw
ZSA9IHRydWU7CisJCQkJCQl9CiAJCQkJCX0KLQkJCQkJaWYgKHRoaXMucmVzb2x2ZUJpbmRpbmdz
KSB7Ci0JCQkJCQlyZWNvcmROb2RlcyhzaW1wbGVOYW1lLCB0eXBlUmVmZXJlbmNlKTsKLQkJCQkJ
CXJlY29yZE5vZGVzKHF1YWxpZmllZFR5cGUsIHR5cGVSZWZlcmVuY2UpOworCQkJCQkKKwkJCQkJ
aWYgKGNyZWF0ZVBhY2thZ2VRdWFsaWZpZWRUeXBlID09IHRydWUpIHsKKwkJCQkJCVBhY2thZ2VR
dWFsaWZpZWRUeXBlIHBhY2thZ2VRdWFsaWZpZWRUeXBlID0gbmV3IFBhY2thZ2VRdWFsaWZpZWRU
eXBlKHRoaXMuYXN0KTsKKwkJCQkJCXBhY2thZ2VRdWFsaWZpZWRUeXBlLnNldFF1YWxpZmllcihu
YW1lKTsKKwkJCQkJCXBhY2thZ2VRdWFsaWZpZWRUeXBlLnNldE5hbWUoY3JlYXRlU2ltcGxlTmFt
ZSh0eXBlUmVmZXJlbmNlLCBwb3NpdGlvbnMsIHRva2VucywgZmlyc3RUeXBlSW5kZXgpKTsKKwkJ
CQkJCXNldFNvdXJjZUFubm90YXRpb25zQW5kQmluZGluZ3ModHlwZVJlZmVyZW5jZSwgcG9zaXRp
b25zLCB0eXBlQW5ub3RhdGlvbnMsIGZpcnN0VHlwZUluZGV4LCAwLCBmaXJzdFR5cGVJbmRleCwg
cGFja2FnZVF1YWxpZmllZFR5cGUpOworCQkJCQkJY3VycmVudFR5cGUgPSBwYWNrYWdlUXVhbGlm
aWVkVHlwZTsJCQkJCQkJCQkJCQkJCQkJCQorCQkJCQl9IGVsc2UgeworCQkJCQkJU2ltcGxlVHlw
ZSBzaW1wbGVUeXBlID0gdGhpcy5hc3QubmV3U2ltcGxlVHlwZShuYW1lKTsJCisJCQkJCQlzZXRT
b3VyY2VBbm5vdGF0aW9uc0FuZEJpbmRpbmdzKHR5cGVSZWZlcmVuY2UsIHBvc2l0aW9ucywgdHlw
ZUFubm90YXRpb25zLCAwLCAwLCAwLCBzaW1wbGVUeXBlKTsKKwkJCQkJCWN1cnJlbnRUeXBlID0g
Z2V0UXVhbGlmaWVkVHlwZVdpdGhTb3VyY2VBbmRCaW5kaW5nKHR5cGVSZWZlcmVuY2UsIHBvc2l0
aW9ucywgIHR5cGVBbm5vdGF0aW9ucywgdG9rZW5zLCBmaXJzdFR5cGVJbmRleCwgc2ltcGxlVHlw
ZSk7CiAJCQkJCX0KLQkJCQkJc3RhcnQgPSBjdXJyZW50VHlwZS5nZXRTdGFydFBvc2l0aW9uKCk7
Ci0JCQkJCWVuZCA9IHNpbXBsZU5hbWUuZ2V0U3RhcnRQb3NpdGlvbigpICsgc2ltcGxlTmFtZS5n
ZXRMZW5ndGgoKSAtIDE7Ci0JCQkJCXF1YWxpZmllZFR5cGUuc2V0U291cmNlUmFuZ2Uoc3RhcnQs
IGVuZCAtIHN0YXJ0ICsgMSk7Ci0JCQkJCWN1cnJlbnRUeXBlID0gcXVhbGlmaWVkVHlwZTsKLQkJ
CQkJcXVhbGlmaWVkVHlwZS5pbmRleCAgPSAxOworCQkJCQlmb3IgKGludCBpID0gZmlyc3RUeXBl
SW5kZXggKyAxOyBpIDwgbGVudGg7ICsraSkgeworCQkJCQkJY3VycmVudFR5cGUgPSBnZXRRdWFs
aWZpZWRUeXBlV2l0aFNvdXJjZUFuZEJpbmRpbmcodHlwZVJlZmVyZW5jZSwgcG9zaXRpb25zLCAg
dHlwZUFubm90YXRpb25zLCB0b2tlbnMsIGksIGN1cnJlbnRUeXBlKTsKKwkJCQkJfQkJCQkJCiAJ
CQkJfQogCQkJCXR5cGUgPSBjdXJyZW50VHlwZTsKIAkJCX0gZWxzZSB7CkBAIC0zNzc4LDYgKzM3
NjAsNzMgQEAKIAkJcmV0dXJuIHR5cGU7CiAJfQogCisJcHJpdmF0ZSBRdWFsaWZpZWRUeXBlIGdl
dFF1YWxpZmllZFR5cGVXaXRoU291cmNlQW5kQmluZGluZyhUeXBlUmVmZXJlbmNlIHR5cGVSZWZl
cmVuY2UsIGxvbmdbXSBwb3NpdGlvbnMsCisJCQlvcmcuZWNsaXBzZS5qZHQuaW50ZXJuYWwuY29t
cGlsZXIuYXN0LkFubm90YXRpb25bXVtdIHR5cGVBbm5vdGF0aW9ucywgY2hhcltdW10gdG9rZW5z
LCBpbnQgaW5kZXgsCisJCQlUeXBlIHF1YWxpZmllcikgeworCQlTaW1wbGVOYW1lIHNpbXBsZU5h
bWUgPSBjcmVhdGVTaW1wbGVOYW1lKHR5cGVSZWZlcmVuY2UsIHBvc2l0aW9ucywgdG9rZW5zLCBp
bmRleCk7CisJCVF1YWxpZmllZFR5cGUgcXVhbGlmaWVkVHlwZSA9IG5ldyBRdWFsaWZpZWRUeXBl
KHRoaXMuYXN0KTsKKwkJcXVhbGlmaWVkVHlwZS5zZXRRdWFsaWZpZXIocXVhbGlmaWVyKTsKKwkJ
cXVhbGlmaWVkVHlwZS5zZXROYW1lKHNpbXBsZU5hbWUpOworCQlpbnQgc3RhcnQgPSBxdWFsaWZp
ZXIuZ2V0U3RhcnRQb3NpdGlvbigpOworCQlpbnQgZW5kID0gc2ltcGxlTmFtZS5nZXRTdGFydFBv
c2l0aW9uKCkgKyBzaW1wbGVOYW1lLmdldExlbmd0aCgpIC0gMTsKKwkJc2V0U291cmNlQW5ub3Rh
dGlvbnNBbmRCaW5kaW5ncyh0eXBlUmVmZXJlbmNlLCB0eXBlQW5ub3RhdGlvbnMsIGluZGV4LCBz
dGFydCwgZW5kLCBxdWFsaWZpZWRUeXBlKTsKKwkJcmV0dXJuIHF1YWxpZmllZFR5cGU7CisJfQor
CisJcHJpdmF0ZSBTaW1wbGVUeXBlIGdldFNpbXBsZVR5cGVXaXRoTmFtZUFuZEJpbmRpbmcoTmFt
ZSBuYW1lLCBUeXBlUmVmZXJlbmNlIHR5cGVSZWZlcmVuY2UsIGxvbmdbXSBwb3NpdGlvbnMsCisJ
CQlpbnQgc3RhcnRJbmRleCwgaW50IGVuZEluZGV4KSB7CisJCVNpbXBsZVR5cGUgc2ltcGxlVHlw
ZSA9IG5ldyBTaW1wbGVUeXBlKHRoaXMuYXN0KTsKKwkJc2ltcGxlVHlwZS5zZXROYW1lKG5hbWUp
OworCQlpbnQgc3RhcnQgPSAoaW50KShwb3NpdGlvbnNbc3RhcnRJbmRleF0gPj4+IDMyKTsKKwkJ
aW50IGVuZCA9IChpbnQpcG9zaXRpb25zW2VuZEluZGV4XTsKKwkJc2ltcGxlVHlwZS5zZXRTb3Vy
Y2VSYW5nZShzdGFydCwgZW5kIC0gc3RhcnQgKyAxKTsKKwkJaWYgKHRoaXMucmVzb2x2ZUJpbmRp
bmdzKSB7CisJCQlyZWNvcmROb2RlcyhzaW1wbGVUeXBlLCB0eXBlUmVmZXJlbmNlKTsKKwkJfQor
CQlyZXR1cm4gc2ltcGxlVHlwZTsKKwl9CisKKwlwcml2YXRlIHZvaWQgc2V0U291cmNlQW5ub3Rh
dGlvbnNBbmRCaW5kaW5ncyhUeXBlUmVmZXJlbmNlIHR5cGVSZWZlcmVuY2UsIAorCQkJb3JnLmVj
bGlwc2UuamR0LmludGVybmFsLmNvbXBpbGVyLmFzdC5Bbm5vdGF0aW9uW11bXSB0eXBlQW5ub3Rh
dGlvbnMsIGludCBpbmRleCwgaW50IHN0YXJ0LCBpbnQgZW5kLAorCQkJQW5ub3RhdGFibGVUeXBl
IGFubm90YXRhYmxlVHlwZSkgeworCQlvcmcuZWNsaXBzZS5qZHQuaW50ZXJuYWwuY29tcGlsZXIu
YXN0LkFubm90YXRpb25bXSBhbm5vdGF0aW9uczsKKwkJaW50IGFubm90YXRpb25zU3RhcnQgPSBz
dGFydDsKKwkJaW50IGxlbmd0aCA9IGVuZCAtIHN0YXJ0ICsgMTsKKwkJaWYgKHR5cGVBbm5vdGF0
aW9ucyAhPSBudWxsICYmIChhbm5vdGF0aW9ucyA9IHR5cGVBbm5vdGF0aW9uc1tpbmRleF0pICE9
IG51bGwpIHsKKwkJCWFubm90YXRlVHlwZShhbm5vdGF0YWJsZVR5cGUsIGFubm90YXRpb25zKTsK
KwkJCWlmIChhbm5vdGF0aW9uc1swXSAhPSBudWxsICYmIChhbm5vdGF0aW9uc1N0YXJ0ID0gYW5u
b3RhdGlvbnNbMF0uc291cmNlU3RhcnQpIDwgc3RhcnQpIHsKKwkJCQlsZW5ndGggKz0gYW5ub3Rh
dGlvbnNTdGFydCA+IDAgPyBzdGFydCAtIGFubm90YXRpb25zU3RhcnQgOiAwOworCQkJCXN0YXJ0
ID0gYW5ub3RhdGlvbnNTdGFydDsKKwkJCX0KKwkJfQorCQlhbm5vdGF0YWJsZVR5cGUuc2V0U291
cmNlUmFuZ2Uoc3RhcnQsIGxlbmd0aCk7CisJCWlmICh0aGlzLnJlc29sdmVCaW5kaW5ncykgewor
CQkJcmVjb3JkTm9kZXMoYW5ub3RhdGFibGVUeXBlLCB0eXBlUmVmZXJlbmNlKTsKKwkJfQorCX0K
KworCXByaXZhdGUgdm9pZCBzZXRTb3VyY2VBbm5vdGF0aW9uc0FuZEJpbmRpbmdzKFR5cGVSZWZl
cmVuY2UgdHlwZVJlZmVyZW5jZSwgbG9uZ1tdIHBvc2l0aW9ucywKKwkJCW9yZy5lY2xpcHNlLmpk
dC5pbnRlcm5hbC5jb21waWxlci5hc3QuQW5ub3RhdGlvbltdW10gdHlwZUFubm90YXRpb25zLCBp
bnQgaW5kZXgsIGludCBzdGFydEluZGV4LCBpbnQgZW5kSW5kZXgsCisJCQlBbm5vdGF0YWJsZVR5
cGUgYW5ub3RhdGFibGVUeXBlKSB7CisJCWludCBzdGFydCA9IChpbnQpIChwb3NpdGlvbnNbc3Rh
cnRJbmRleF0gPj4+IDMyKTsKKwkJaW50IGVuZCA9IChpbnQpIHBvc2l0aW9uc1tlbmRJbmRleF07
CisJCXNldFNvdXJjZUFubm90YXRpb25zQW5kQmluZGluZ3ModHlwZVJlZmVyZW5jZSwgdHlwZUFu
bm90YXRpb25zLCBpbmRleCwgc3RhcnQsIGVuZCwgYW5ub3RhdGFibGVUeXBlKTsKKwl9CisKKwlw
cml2YXRlIFNpbXBsZU5hbWUgY3JlYXRlU2ltcGxlTmFtZShUeXBlUmVmZXJlbmNlIHR5cGVSZWZl
cmVuY2UsIGxvbmdbXSBwb3NpdGlvbnMsIGNoYXJbXVtdIHRva2VucywgaW50IGluZGV4KSB7CisJ
CWZpbmFsIFNpbXBsZU5hbWUgc2ltcGxlTmFtZSA9IG5ldyBTaW1wbGVOYW1lKHRoaXMuYXN0KTsK
KwkJc2ltcGxlTmFtZS5pbnRlcm5hbFNldElkZW50aWZpZXIobmV3IFN0cmluZyh0b2tlbnNbaW5k
ZXhdKSk7CisJCXJlY29yZFBlbmRpbmdOYW1lU2NvcGVSZXNvbHV0aW9uKHNpbXBsZU5hbWUpOwor
CQlpbnQgc3RhcnQgPSAoaW50KSAocG9zaXRpb25zW2luZGV4XSA+Pj4gMzIpOworCQlpbnQgZW5k
ID0gKGludCkgcG9zaXRpb25zW2luZGV4XTsKKwkJc2ltcGxlTmFtZS5zZXRTb3VyY2VSYW5nZShz
dGFydCwgZW5kIC0gc3RhcnQgKyAxKTsKKwkJc2ltcGxlTmFtZS5pbmRleCA9IGluZGV4ICsgMTsK
KwkJaWYgKHRoaXMucmVzb2x2ZUJpbmRpbmdzKSB7CisJCQlyZWNvcmROb2RlcyhzaW1wbGVOYW1l
LCB0eXBlUmVmZXJlbmNlKTsKKwkJfQorCQlyZXR1cm4gc2ltcGxlTmFtZTsKKwl9CisKIAlwcm90
ZWN0ZWQgQ29tbWVudCBjcmVhdGVDb21tZW50KGludFtdIHBvc2l0aW9ucykgewogCQkvLyBDcmVh
dGUgY29tbWVudCBub2RlCiAJCUNvbW1lbnQgY29tbWVudCA9IG51bGw7CmRpZmYgLS1naXQgYS9v
cmcuZWNsaXBzZS5qZHQuY29yZS9kb20vb3JnL2VjbGlwc2UvamR0L2NvcmUvZG9tL0FTVE1hdGNo
ZXIuamF2YSBiL29yZy5lY2xpcHNlLmpkdC5jb3JlL2RvbS9vcmcvZWNsaXBzZS9qZHQvY29yZS9k
b20vQVNUTWF0Y2hlci5qYXZhCmluZGV4IGViMTNlYzYuLjBkZmM5OTAgMTAwNjQ0Ci0tLSBhL29y
Zy5lY2xpcHNlLmpkdC5jb3JlL2RvbS9vcmcvZWNsaXBzZS9qZHQvY29yZS9kb20vQVNUTWF0Y2hl
ci5qYXZhCisrKyBiL29yZy5lY2xpcHNlLmpkdC5jb3JlL2RvbS9vcmcvZWNsaXBzZS9qZHQvY29y
ZS9kb20vQVNUTWF0Y2hlci5qYXZhCkBAIC0xNTY5LDYgKzE1NjksMzEgQEAKIAkgKiBAcmV0dXJu
IDxjb2RlPnRydWU8L2NvZGU+IGlmIHRoZSBzdWJ0cmVlIG1hdGNoZXMsIG9yCiAJICogICA8Y29k
ZT5mYWxzZTwvY29kZT4gaWYgdGhleSBkbyBub3QgbWF0Y2ggb3IgdGhlIG90aGVyIG9iamVjdCBo
YXMgYQogCSAqICAgZGlmZmVyZW50IG5vZGUgdHlwZSBvciBpcyA8Y29kZT5udWxsPC9jb2RlPgor
CSAqIEBzaW5jZSAzLjkKKwkgKi8KKwlwdWJsaWMgYm9vbGVhbiBtYXRjaChQYWNrYWdlUXVhbGlm
aWVkVHlwZSBub2RlLCBPYmplY3Qgb3RoZXIpIHsKKwkJaWYgKCEob3RoZXIgaW5zdGFuY2VvZiBQ
YWNrYWdlUXVhbGlmaWVkVHlwZSkpIHsKKwkJCXJldHVybiBmYWxzZTsKKwkJfQorCQlQYWNrYWdl
UXVhbGlmaWVkVHlwZSBvID0gKFBhY2thZ2VRdWFsaWZpZWRUeXBlKSBvdGhlcjsKKwkJcmV0dXJu
IHNhZmVTdWJ0cmVlTWF0Y2gobm9kZS5nZXRRdWFsaWZpZXIoKSwgby5nZXRRdWFsaWZpZXIoKSkK
KwkJCQkmJiBzYWZlU3VidHJlZUxpc3RNYXRjaChub2RlLmFubm90YXRpb25zKCksIG8uYW5ub3Rh
dGlvbnMoKSkKKwkJCQkmJiBzYWZlU3VidHJlZU1hdGNoKG5vZGUuZ2V0TmFtZSgpLCBvLmdldE5h
bWUoKSk7CisJfQorCisJLyoqCisJICogUmV0dXJucyB3aGV0aGVyIHRoZSBnaXZlbiBub2RlIGFu
ZCB0aGUgb3RoZXIgb2JqZWN0IG1hdGNoLgorCSAqIDxwPgorCSAqIFRoZSBkZWZhdWx0IGltcGxl
bWVudGF0aW9uIHByb3ZpZGVkIGJ5IHRoaXMgY2xhc3MgdGVzdHMgd2hldGhlciB0aGUKKwkgKiBv
dGhlciBvYmplY3QgaXMgYSBub2RlIG9mIHRoZSBzYW1lIHR5cGUgd2l0aCBzdHJ1Y3R1cmFsbHkg
aXNvbW9ycGhpYworCSAqIGNoaWxkIHN1YnRyZWVzLiBTdWJjbGFzc2VzIG1heSBvdmVycmlkZSB0
aGlzIG1ldGhvZCBhcyBuZWVkZWQuCisJICogPC9wPgorCSAqCisJICogQHBhcmFtIG5vZGUgdGhl
IG5vZGUKKwkgKiBAcGFyYW0gb3RoZXIgdGhlIG90aGVyIG9iamVjdCwgb3IgPGNvZGU+bnVsbDwv
Y29kZT4KKwkgKiBAcmV0dXJuIDxjb2RlPnRydWU8L2NvZGU+IGlmIHRoZSBzdWJ0cmVlIG1hdGNo
ZXMsIG9yCisJICogICA8Y29kZT5mYWxzZTwvY29kZT4gaWYgdGhleSBkbyBub3QgbWF0Y2ggb3Ig
dGhlIG90aGVyIG9iamVjdCBoYXMgYQorCSAqICAgZGlmZmVyZW50IG5vZGUgdHlwZSBvciBpcyA8
Y29kZT5udWxsPC9jb2RlPgogCSAqIEBzaW5jZSAzLjEKIAkgKi8KIAlwdWJsaWMgYm9vbGVhbiBt
YXRjaChQYXJhbWV0ZXJpemVkVHlwZSBub2RlLCBPYmplY3Qgb3RoZXIpIHsKZGlmZiAtLWdpdCBh
L29yZy5lY2xpcHNlLmpkdC5jb3JlL2RvbS9vcmcvZWNsaXBzZS9qZHQvY29yZS9kb20vQVNUTm9k
ZS5qYXZhIGIvb3JnLmVjbGlwc2UuamR0LmNvcmUvZG9tL29yZy9lY2xpcHNlL2pkdC9jb3JlL2Rv
bS9BU1ROb2RlLmphdmEKaW5kZXggZjdkYzkwYy4uZDViMjI0MyAxMDA2NDQKLS0tIGEvb3JnLmVj
bGlwc2UuamR0LmNvcmUvZG9tL29yZy9lY2xpcHNlL2pkdC9jb3JlL2RvbS9BU1ROb2RlLmphdmEK
KysrIGIvb3JnLmVjbGlwc2UuamR0LmNvcmUvZG9tL29yZy9lY2xpcHNlL2pkdC9jb3JlL2RvbS9B
U1ROb2RlLmphdmEKQEAgLTg1MSw2ICs4NTEsMTQgQEAKIAlwdWJsaWMgc3RhdGljIGZpbmFsIGlu
dCBMQU1CREFfRVhQUkVTU0lPTiA9IDg2OwogCiAJLyoqCisJICogTm9kZSB0eXBlIGNvbnN0YW50
IGluZGljYXRpbmcgYSBub2RlIG9mIHR5cGUKKwkgKiA8Y29kZT5RdWFsaWZpZWRUeXBlPC9jb2Rl
Pi4KKwkgKiBAc2VlIFF1YWxpZmllZFR5cGUKKwkgKiBAc2luY2UgMy45CisJICovCisJcHVibGlj
IHN0YXRpYyBmaW5hbCBpbnQgUEFDS0FHRV9RVUFMSUZJRURfVFlQRSA9IDg3OworCisJLyoqCiAJ
ICogUmV0dXJucyB0aGUgbm9kZSBjbGFzcyBmb3IgdGhlIGNvcnJlc3BvbmRpbmcgbm9kZSB0eXBl
LgogCSAqCiAJICogQHBhcmFtIG5vZGVUeXBlIEFTVCBub2RlIHR5cGUKQEAgLTk2OCw2ICs5NzYs
OCBAQAogCQkJCXJldHVybiBOdW1iZXJMaXRlcmFsLmNsYXNzOwogCQkJY2FzZSBQQUNLQUdFX0RF
Q0xBUkFUSU9OIDoKIAkJCQlyZXR1cm4gUGFja2FnZURlY2xhcmF0aW9uLmNsYXNzOworCQkJY2Fz
ZSBQQUNLQUdFX1FVQUxJRklFRF9UWVBFIDoKKwkJCQlyZXR1cm4gUGFja2FnZVF1YWxpZmllZFR5
cGUuY2xhc3M7CiAJCQljYXNlIFBBUkFNRVRFUklaRURfVFlQRSA6CiAJCQkJcmV0dXJuIFBhcmFt
ZXRlcml6ZWRUeXBlLmNsYXNzOwogCQkJY2FzZSBQQVJFTlRIRVNJWkVEX0VYUFJFU1NJT04gOgpk
aWZmIC0tZ2l0IGEvb3JnLmVjbGlwc2UuamR0LmNvcmUvZG9tL29yZy9lY2xpcHNlL2pkdC9jb3Jl
L2RvbS9BU1RWaXNpdG9yLmphdmEgYi9vcmcuZWNsaXBzZS5qZHQuY29yZS9kb20vb3JnL2VjbGlw
c2UvamR0L2NvcmUvZG9tL0FTVFZpc2l0b3IuamF2YQppbmRleCA0NDJjMmQyLi4xNDk5ZjBiIDEw
MDY0NAotLS0gYS9vcmcuZWNsaXBzZS5qZHQuY29yZS9kb20vb3JnL2VjbGlwc2UvamR0L2NvcmUv
ZG9tL0FTVFZpc2l0b3IuamF2YQorKysgYi9vcmcuZWNsaXBzZS5qZHQuY29yZS9kb20vb3JnL2Vj
bGlwc2UvamR0L2NvcmUvZG9tL0FTVFZpc2l0b3IuamF2YQpAQCAtMTA3Miw2ICsxMDcyLDIzIEBA
CiAJICogQHJldHVybiA8Y29kZT50cnVlPC9jb2RlPiBpZiB0aGUgY2hpbGRyZW4gb2YgdGhpcyBu
b2RlIHNob3VsZCBiZQogCSAqIHZpc2l0ZWQsIGFuZCA8Y29kZT5mYWxzZTwvY29kZT4gaWYgdGhl
IGNoaWxkcmVuIG9mIHRoaXMgbm9kZSBzaG91bGQKIAkgKiBiZSBza2lwcGVkCisJICogQHNpbmNl
IDMuOQorCSAqLworCXB1YmxpYyBib29sZWFuIHZpc2l0KFBhY2thZ2VRdWFsaWZpZWRUeXBlIG5v
ZGUpIHsKKwkJcmV0dXJuIHRydWU7CisJfQorCisJLyoqCisJICogVmlzaXRzIHRoZSBnaXZlbiB0
eXBlLXNwZWNpZmljIEFTVCBub2RlLgorCSAqIDxwPgorCSAqIFRoZSBkZWZhdWx0IGltcGxlbWVu
dGF0aW9uIGRvZXMgbm90aGluZyBhbmQgcmV0dXJuIHRydWUuCisJICogU3ViY2xhc3NlcyBtYXkg
cmVpbXBsZW1lbnQuCisJICogPC9wPgorCSAqCisJICogQHBhcmFtIG5vZGUgdGhlIG5vZGUgdG8g
dmlzaXQKKwkgKiBAcmV0dXJuIDxjb2RlPnRydWU8L2NvZGU+IGlmIHRoZSBjaGlsZHJlbiBvZiB0
aGlzIG5vZGUgc2hvdWxkIGJlCisJICogdmlzaXRlZCwgYW5kIDxjb2RlPmZhbHNlPC9jb2RlPiBp
ZiB0aGUgY2hpbGRyZW4gb2YgdGhpcyBub2RlIHNob3VsZAorCSAqIGJlIHNraXBwZWQKIAkgKiBA
c2luY2UgMy4xCiAJICovCiAJcHVibGljIGJvb2xlYW4gdmlzaXQoUGFyYW1ldGVyaXplZFR5cGUg
bm9kZSkgewpAQCAtMjI3NCw2ICsyMjkxLDE5IEBACiAJICogPC9wPgogCSAqCiAJICogQHBhcmFt
IG5vZGUgdGhlIG5vZGUgdG8gdmlzaXQKKwkgKiBAc2luY2UgMy45CisJICovCisJcHVibGljIHZv
aWQgZW5kVmlzaXQoUGFja2FnZVF1YWxpZmllZFR5cGUgbm9kZSkgeworCQkvLyBkZWZhdWx0IGlt
cGxlbWVudGF0aW9uOiBkbyBub3RoaW5nCisJfQorCisJLyoqCisJICogRW5kIG9mIHZpc2l0IHRo
ZSBnaXZlbiB0eXBlLXNwZWNpZmljIEFTVCBub2RlLgorCSAqIDxwPgorCSAqIFRoZSBkZWZhdWx0
IGltcGxlbWVudGF0aW9uIGRvZXMgbm90aGluZy4gU3ViY2xhc3NlcyBtYXkgcmVpbXBsZW1lbnQu
CisJICogPC9wPgorCSAqCisJICogQHBhcmFtIG5vZGUgdGhlIG5vZGUgdG8gdmlzaXQKIAkgKiBA
c2luY2UgMy4xCiAJICovCiAJcHVibGljIHZvaWQgZW5kVmlzaXQoUGFyYW1ldGVyaXplZFR5cGUg
bm9kZSkgewpkaWZmIC0tZ2l0IGEvb3JnLmVjbGlwc2UuamR0LmNvcmUvZG9tL29yZy9lY2xpcHNl
L2pkdC9jb3JlL2RvbS9EZWZhdWx0QVNUVmlzaXRvci5qYXZhIGIvb3JnLmVjbGlwc2UuamR0LmNv
cmUvZG9tL29yZy9lY2xpcHNlL2pkdC9jb3JlL2RvbS9EZWZhdWx0QVNUVmlzaXRvci5qYXZhCmlu
ZGV4IDg3MDliODYuLjQ4N2NhMTggMTAwNjQ0Ci0tLSBhL29yZy5lY2xpcHNlLmpkdC5jb3JlL2Rv
bS9vcmcvZWNsaXBzZS9qZHQvY29yZS9kb20vRGVmYXVsdEFTVFZpc2l0b3IuamF2YQorKysgYi9v
cmcuZWNsaXBzZS5qZHQuY29yZS9kb20vb3JnL2VjbGlwc2UvamR0L2NvcmUvZG9tL0RlZmF1bHRB
U1RWaXNpdG9yLmphdmEKQEAgLTE4Miw2ICsxODIsOSBAQAogCXB1YmxpYyB2b2lkIGVuZFZpc2l0
KFBhY2thZ2VEZWNsYXJhdGlvbiBub2RlKSB7CiAJCWVuZFZpc2l0Tm9kZShub2RlKTsKIAl9CisJ
cHVibGljIHZvaWQgZW5kVmlzaXQoUGFja2FnZVF1YWxpZmllZFR5cGUgbm9kZSkgeworCQllbmRW
aXNpdE5vZGUobm9kZSk7CisJfQogCXB1YmxpYyB2b2lkIGVuZFZpc2l0KFBhcmFtZXRlcml6ZWRU
eXBlIG5vZGUpIHsKIAkJZW5kVmlzaXROb2RlKG5vZGUpOwogCX0KQEAgLTQ0OCw2ICs0NTEsOSBA
QAogCXB1YmxpYyBib29sZWFuIHZpc2l0KFBhY2thZ2VEZWNsYXJhdGlvbiBub2RlKSB7CiAJCXJl
dHVybiB2aXNpdE5vZGUobm9kZSk7CiAJfQorCXB1YmxpYyBib29sZWFuIHZpc2l0KFBhY2thZ2VR
dWFsaWZpZWRUeXBlIG5vZGUpIHsKKwkJcmV0dXJuIHZpc2l0Tm9kZShub2RlKTsKKwl9CiAJcHVi
bGljIGJvb2xlYW4gdmlzaXQoUGFyYW1ldGVyaXplZFR5cGUgbm9kZSkgewogCQlyZXR1cm4gdmlz
aXROb2RlKG5vZGUpOwogCX0KZGlmZiAtLWdpdCBhL29yZy5lY2xpcHNlLmpkdC5jb3JlL2RvbS9v
cmcvZWNsaXBzZS9qZHQvY29yZS9kb20vUGFja2FnZVF1YWxpZmllZFR5cGUuamF2YSBiL29yZy5l
Y2xpcHNlLmpkdC5jb3JlL2RvbS9vcmcvZWNsaXBzZS9qZHQvY29yZS9kb20vUGFja2FnZVF1YWxp
ZmllZFR5cGUuamF2YQpuZXcgZmlsZSBtb2RlIDEwMDY0NAppbmRleCAwMDAwMDAwLi45YmFmNTFm
Ci0tLSAvZGV2L251bGwKKysrIGIvb3JnLmVjbGlwc2UuamR0LmNvcmUvZG9tL29yZy9lY2xpcHNl
L2pkdC9jb3JlL2RvbS9QYWNrYWdlUXVhbGlmaWVkVHlwZS5qYXZhCkBAIC0wLDAgKzEsMjg1IEBA
CisvKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioq
KioqKioqKioqKioqKioqKioqKioqKioqKgorICogQ29weXJpZ2h0IChjKSAyMDAzLCAyMDEzIElC
TSBDb3Jwb3JhdGlvbiBhbmQgb3RoZXJzLgorICogQWxsIHJpZ2h0cyByZXNlcnZlZC4gVGhpcyBw
cm9ncmFtIGFuZCB0aGUgYWNjb21wYW55aW5nIG1hdGVyaWFscworICogYXJlIG1hZGUgYXZhaWxh
YmxlIHVuZGVyIHRoZSB0ZXJtcyBvZiB0aGUgRWNsaXBzZSBQdWJsaWMgTGljZW5zZSB2MS4wCisg
KiB3aGljaCBhY2NvbXBhbmllcyB0aGlzIGRpc3RyaWJ1dGlvbiwgYW5kIGlzIGF2YWlsYWJsZSBh
dAorICogaHR0cDovL3d3dy5lY2xpcHNlLm9yZy9sZWdhbC9lcGwtdjEwLmh0bWwKKyAqCisgKiBU
aGlzIGlzIGFuIGltcGxlbWVudGF0aW9uIG9mIGFuIGVhcmx5LWRyYWZ0IHNwZWNpZmljYXRpb24g
ZGV2ZWxvcGVkIHVuZGVyIHRoZSBKYXZhCisgKiBDb21tdW5pdHkgUHJvY2VzcyAoSkNQKSBhbmQg
aXMgbWFkZSBhdmFpbGFibGUgZm9yIHRlc3RpbmcgYW5kIGV2YWx1YXRpb24gcHVycG9zZXMKKyAq
IG9ubHkuIFRoZSBjb2RlIGlzIG5vdCBjb21wYXRpYmxlIHdpdGggYW55IHNwZWNpZmljYXRpb24g
b2YgdGhlIEpDUC4KKyAqIAorICogQ29udHJpYnV0b3JzOgorICogICAgIElCTSBDb3Jwb3JhdGlv
biAtIGluaXRpYWwgQVBJIGFuZCBpbXBsZW1lbnRhdGlvbgorICoqKioqKioqKioqKioqKioqKioq
KioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioq
KiovCisKK3BhY2thZ2Ugb3JnLmVjbGlwc2UuamR0LmNvcmUuZG9tOworCitpbXBvcnQgamF2YS51
dGlsLkFycmF5TGlzdDsKK2ltcG9ydCBqYXZhLnV0aWwuTGlzdDsKKworLyoqCisgKiBOb2RlIGZv
ciBhIHBhY2thZ2UgcXVhbGlmaWVkIHR5cGUgKGFkZGVkIGluIEpMUzggQVBJKS4KKyAqIAorICog
PHByZT4KKyAqIFBhY2thZ2VRdWFsaWZpZWRUeXBlOgorICogICAgTmFtZSA8Yj4uPC9iPiB7IEFu
bm90YXRpb24gfSBTaW1wbGVOYW1lCisgKiA8L3ByZT4KKyAqCisgKiBAc2luY2UgMy45CisgKiBA
bm9pbnN0YW50aWF0ZSBUaGlzIGNsYXNzIGlzIG5vdCBpbnRlbmRlZCB0byBiZSBpbnN0YW50aWF0
ZWQgYnkgY2xpZW50cy4KKyAqLworcHVibGljIGNsYXNzIFBhY2thZ2VRdWFsaWZpZWRUeXBlIGV4
dGVuZHMgQW5ub3RhdGFibGVUeXBlIHsKKworCS8qKgorCSAqIFRoZSAicXVhbGlmaWVyIiBzdHJ1
Y3R1cmFsIHByb3BlcnR5IG9mIHRoaXMgbm9kZSB0eXBlIChjaGlsZCB0eXBlOiB7QGxpbmsgTmFt
ZX0pLgorCSAqLworCXB1YmxpYyBzdGF0aWMgZmluYWwgQ2hpbGRQcm9wZXJ0eURlc2NyaXB0b3Ig
UVVBTElGSUVSX1BST1BFUlRZID0KKwkJbmV3IENoaWxkUHJvcGVydHlEZXNjcmlwdG9yKFBhY2th
Z2VRdWFsaWZpZWRUeXBlLmNsYXNzLCAicXVhbGlmaWVyIiwgTmFtZS5jbGFzcywgTUFOREFUT1JZ
LCBOT19DWUNMRV9SSVNLKTsgLy8kTk9OLU5MUy0xJAorCisJLyoqCisJICogVGhlICJhbm5vdGF0
aW9ucyIgc3RydWN0dXJhbCBwcm9wZXJ0eSBvZiB0aGlzIG5vZGUgdHlwZSAoZWxlbWVudCB0eXBl
OiB7QGxpbmsgQW5ub3RhdGlvbn0pLgorCSAqLworCXB1YmxpYyBzdGF0aWMgZmluYWwgQ2hpbGRM
aXN0UHJvcGVydHlEZXNjcmlwdG9yIEFOTk9UQVRJT05TX1BST1BFUlRZID0KKwkJCWludGVybmFs
QW5ub3RhdGlvbnNQcm9wZXJ0eUZhY3RvcnkoUGFja2FnZVF1YWxpZmllZFR5cGUuY2xhc3MpOwor
CQorCS8qKgorCSAqIFRoZSAibmFtZSIgc3RydWN0dXJhbCBwcm9wZXJ0eSBvZiB0aGlzIG5vZGUg
dHlwZSAoY2hpbGQgdHlwZToge0BsaW5rIFNpbXBsZU5hbWV9KS4KKwkgKi8KKwlwdWJsaWMgc3Rh
dGljIGZpbmFsIENoaWxkUHJvcGVydHlEZXNjcmlwdG9yIE5BTUVfUFJPUEVSVFkgPQorCQluZXcg
Q2hpbGRQcm9wZXJ0eURlc2NyaXB0b3IoUGFja2FnZVF1YWxpZmllZFR5cGUuY2xhc3MsICJuYW1l
IiwgU2ltcGxlTmFtZS5jbGFzcywgTUFOREFUT1JZLCBOT19DWUNMRV9SSVNLKTsgLy8kTk9OLU5M
Uy0xJAorCQorCS8qKgorCSAqIEEgbGlzdCBvZiBwcm9wZXJ0eSBkZXNjcmlwdG9ycyAoZWxlbWVu
dCB0eXBlOgorCSAqIHtAbGluayBTdHJ1Y3R1cmFsUHJvcGVydHlEZXNjcmlwdG9yfSksCisJICog
b3IgbnVsbCBpZiB1bmluaXRpYWxpemVkLgorCSAqLworCXByaXZhdGUgc3RhdGljIGZpbmFsIExp
c3QgUFJPUEVSVFlfREVTQ1JJUFRPUlM7CisKKwlzdGF0aWMgeworCQlMaXN0IHByb3BlcnR5TGlz
dCA9IG5ldyBBcnJheUxpc3QoNCk7CisJCWNyZWF0ZVByb3BlcnR5TGlzdChQYWNrYWdlUXVhbGlm
aWVkVHlwZS5jbGFzcywgcHJvcGVydHlMaXN0KTsKKwkJYWRkUHJvcGVydHkoUVVBTElGSUVSX1BS
T1BFUlRZLCBwcm9wZXJ0eUxpc3QpOworCQlhZGRQcm9wZXJ0eShBTk5PVEFUSU9OU19QUk9QRVJU
WSwgcHJvcGVydHlMaXN0KTsKKwkJYWRkUHJvcGVydHkoTkFNRV9QUk9QRVJUWSwgcHJvcGVydHlM
aXN0KTsKKwkJUFJPUEVSVFlfREVTQ1JJUFRPUlMgPSByZWFwUHJvcGVydHlMaXN0KHByb3BlcnR5
TGlzdCk7CisJfQorCisJLyoqCisJICogUmV0dXJucyBhIGxpc3Qgb2Ygc3RydWN0dXJhbCBwcm9w
ZXJ0eSBkZXNjcmlwdG9ycyBmb3IgdGhpcyBub2RlIHR5cGUuCisJICogQ2xpZW50cyBtdXN0IG5v
dCBtb2RpZnkgdGhlIHJlc3VsdC4KKwkgKgorCSAqIEBwYXJhbSBhcGlMZXZlbCB0aGUgQVBJIGxl
dmVsOyBvbmUgb2YgdGhlCisJICogPGNvZGU+QVNULkpMUyo8L2NvZGU+IGNvbnN0YW50cworCSAq
IEByZXR1cm4gYSBsaXN0IG9mIHByb3BlcnR5IGRlc2NyaXB0b3JzIChlbGVtZW50IHR5cGU6CisJ
ICoge0BsaW5rIFN0cnVjdHVyYWxQcm9wZXJ0eURlc2NyaXB0b3J9KQorCSAqLworCXB1YmxpYyBz
dGF0aWMgTGlzdCBwcm9wZXJ0eURlc2NyaXB0b3JzKGludCBhcGlMZXZlbCkgeworCQlyZXR1cm4g
UFJPUEVSVFlfREVTQ1JJUFRPUlM7CisJfQorCisJLyoqCisJICogVGhlIHF1YWxpZmllciBub2Rl
OyBsYXppbHkgaW5pdGlhbGl6ZWQ7IGRlZmF1bHRzIHRvIAorCSAqIGFuIHVuc3BlY2lmaWVkLCBi
dXQgbGVnYWwsIHNpbXBsZSBuYW1lLgorCSAqLworCXByaXZhdGUgTmFtZSBxdWFsaWZpZXIgPSBu
dWxsOworCisJLyoqCisJICogVGhlIG5hbWUgYmVpbmcgcXVhbGlmaWVkOyBsYXppbHkgaW5pdGlh
bGl6ZWQ7IGRlZmF1bHRzIHRvIGEgdW5zcGVjaWZpZWQsCisJICogbGVnYWwgSmF2YSBpZGVudGlm
aWVyLgorCSAqLworCXByaXZhdGUgU2ltcGxlTmFtZSBuYW1lID0gbnVsbDsKKworCS8qKgorCSAq
IENyZWF0ZXMgYSBuZXcgdW5wYXJlbnRlZCBub2RlIGZvciBhIHBhY2thZ2UgcXVhbGlmaWVkIHR5
cGUgb3duZWQgYnkgdGhlCisJICogZ2l2ZW4gQVNULiBCeSBkZWZhdWx0LCBhbiB1bnNwZWNpZmll
ZCwgYnV0IGxlZ2FsLCBxdWFsaWZpZXIgYW5kIG5hbWUuCisJICogPHA+CisJICogTi5CLiBUaGlz
IGNvbnN0cnVjdG9yIGlzIHBhY2thZ2UtcHJpdmF0ZS4KKwkgKiA8L3A+CisJICoKKwkgKiBAcGFy
YW0gYXN0IHRoZSBBU1QgdGhhdCBpcyB0byBvd24gdGhpcyBub2RlCisJICovCisJUGFja2FnZVF1
YWxpZmllZFR5cGUoQVNUIGFzdCkgeworCQlzdXBlcihhc3QpOworCSAgICB1bnN1cHBvcnRlZElu
Ml8zXzQoKTsKKwl9CisKKwkvKiAob21pdCBqYXZhZG9jIGZvciB0aGlzIG1ldGhvZCkKKwkgKiBN
ZXRob2QgZGVjbGFyZWQgb24gQW5ub3RhdGFibGVUeXBlLgorCSAqLworCUNoaWxkTGlzdFByb3Bl
cnR5RGVzY3JpcHRvciBpbnRlcm5hbEFubm90YXRpb25zUHJvcGVydHkoKSB7CisJCXJldHVybiBB
Tk5PVEFUSU9OU19QUk9QRVJUWTsKKwl9CisKKwkvKiAob21pdCBqYXZhZG9jIGZvciB0aGlzIG1l
dGhvZCkKKwkgKiBNZXRob2QgZGVjbGFyZWQgb24gQVNUTm9kZS4KKwkgKi8KKwlMaXN0IGludGVy
bmFsU3RydWN0dXJhbFByb3BlcnRpZXNGb3JUeXBlKGludCBhcGlMZXZlbCkgeworCQlyZXR1cm4g
cHJvcGVydHlEZXNjcmlwdG9ycyhhcGlMZXZlbCk7CisJfQorCisJLyogKG9taXQgamF2YWRvYyBm
b3IgdGhpcyBtZXRob2QpCisJICogTWV0aG9kIGRlY2xhcmVkIG9uIEFTVE5vZGUuCisJICovCisJ
ZmluYWwgTGlzdCBpbnRlcm5hbEdldENoaWxkTGlzdFByb3BlcnR5KENoaWxkTGlzdFByb3BlcnR5
RGVzY3JpcHRvciBwcm9wZXJ0eSkgeworCQlpZiAocHJvcGVydHkgPT0gQU5OT1RBVElPTlNfUFJP
UEVSVFkpIHsKKwkJCXJldHVybiBhbm5vdGF0aW9ucygpOworCQl9CisJCS8vIGFsbG93IGRlZmF1
bHQgaW1wbGVtZW50YXRpb24gdG8gZmxhZyB0aGUgZXJyb3IKKwkJcmV0dXJuIHN1cGVyLmludGVy
bmFsR2V0Q2hpbGRMaXN0UHJvcGVydHkocHJvcGVydHkpOworCX0KKwkKKwkvKiAob21pdCBqYXZh
ZG9jIGZvciB0aGlzIG1ldGhvZCkKKwkgKiBNZXRob2QgZGVjbGFyZWQgb24gQVNUTm9kZS4KKwkg
Ki8KKwlmaW5hbCBBU1ROb2RlIGludGVybmFsR2V0U2V0Q2hpbGRQcm9wZXJ0eShDaGlsZFByb3Bl
cnR5RGVzY3JpcHRvciBwcm9wZXJ0eSwgYm9vbGVhbiBnZXQsIEFTVE5vZGUgY2hpbGQpIHsKKwkJ
aWYgKHByb3BlcnR5ID09IFFVQUxJRklFUl9QUk9QRVJUWSkgeworCQkJaWYgKGdldCkgeworCQkJ
CXJldHVybiBnZXRRdWFsaWZpZXIoKTsKKwkJCX0gZWxzZSB7CisJCQkJc2V0UXVhbGlmaWVyKChO
YW1lKSBjaGlsZCk7CisJCQkJcmV0dXJuIG51bGw7CisJCQl9CisJCX0KKwkJaWYgKHByb3BlcnR5
ID09IE5BTUVfUFJPUEVSVFkpIHsKKwkJCWlmIChnZXQpIHsKKwkJCQlyZXR1cm4gZ2V0TmFtZSgp
OworCQkJfSBlbHNlIHsKKwkJCQlzZXROYW1lKChTaW1wbGVOYW1lKSBjaGlsZCk7CisJCQkJcmV0
dXJuIG51bGw7CisJCQl9CisJCX0KKwkJLy8gYWxsb3cgZGVmYXVsdCBpbXBsZW1lbnRhdGlvbiB0
byBmbGFnIHRoZSBlcnJvcgorCQlyZXR1cm4gc3VwZXIuaW50ZXJuYWxHZXRTZXRDaGlsZFByb3Bl
cnR5KHByb3BlcnR5LCBnZXQsIGNoaWxkKTsKKwl9CisKKwlpbnQgZ2V0Tm9kZVR5cGUwKCkgewor
CQlyZXR1cm4gUEFDS0FHRV9RVUFMSUZJRURfVFlQRTsKKwl9CisKKwlib29sZWFuIHN1YnRyZWVN
YXRjaDAoQVNUTWF0Y2hlciBtYXRjaGVyLCBPYmplY3Qgb3RoZXIpIHsKKwkJLy8gZGlzcGF0Y2gg
dG8gY29ycmVjdCBvdmVybG9hZGVkIG1hdGNoIG1ldGhvZAorCQlyZXR1cm4gbWF0Y2hlci5tYXRj
aCh0aGlzLCBvdGhlcik7CisJfQorCisJQVNUTm9kZSBjbG9uZTAoQVNUIHRhcmdldCkgeworCQlQ
YWNrYWdlUXVhbGlmaWVkVHlwZSByZXN1bHQgPSBuZXcgUGFja2FnZVF1YWxpZmllZFR5cGUodGFy
Z2V0KTsKKwkJcmVzdWx0LnNldFNvdXJjZVJhbmdlKGdldFN0YXJ0UG9zaXRpb24oKSwgZ2V0TGVu
Z3RoKCkpOworCQlyZXN1bHQuc2V0UXVhbGlmaWVyKChOYW1lKSAoKEFTVE5vZGUpIGdldFF1YWxp
ZmllcigpKS5jbG9uZSh0YXJnZXQpKTsKKwkJcmVzdWx0LmFubm90YXRpb25zKCkuYWRkQWxsKEFT
VE5vZGUuY29weVN1YnRyZWVzKHRhcmdldCwgYW5ub3RhdGlvbnMoKSkpOworCQlyZXN1bHQuc2V0
TmFtZSgoU2ltcGxlTmFtZSkgKChBU1ROb2RlKSBnZXROYW1lKCkpLmNsb25lKHRhcmdldCkpOwor
CQlyZXR1cm4gcmVzdWx0OworCX0KKworCS8qIChvbWl0IGphdmFkb2MgZm9yIHRoaXMgbWV0aG9k
KQorCSAqIE1ldGhvZCBkZWNsYXJlZCBvbiBBU1ROb2RlLgorCSAqLworCXZvaWQgYWNjZXB0MChB
U1RWaXNpdG9yIHZpc2l0b3IpIHsKKwkJYm9vbGVhbiB2aXNpdENoaWxkcmVuID0gdmlzaXRvci52
aXNpdCh0aGlzKTsKKwkJaWYgKHZpc2l0Q2hpbGRyZW4pIHsKKwkJCS8vIHZpc2l0IGNoaWxkcmVu
IGluIG5vcm1hbCBsZWZ0IHRvIHJpZ2h0IHJlYWRpbmcgb3JkZXIKKwkJCWFjY2VwdENoaWxkKHZp
c2l0b3IsIGdldFF1YWxpZmllcigpKTsKKwkJCWFjY2VwdENoaWxkcmVuKHZpc2l0b3IsIHRoaXMu
YW5ub3RhdGlvbnMpOworCQkJYWNjZXB0Q2hpbGQodmlzaXRvciwgZ2V0TmFtZSgpKTsKKwkJfQor
CQl2aXNpdG9yLmVuZFZpc2l0KHRoaXMpOworCX0KKworCS8qKgorCSAqIFJldHVybnMgdGhlIHF1
YWxpZmllciBvZiB0aGlzIHBhY2thZ2UgcXVhbGlmaWVkIHR5cGUuCisJICoKKwkgKiBAcmV0dXJu
IHRoZSBxdWFsaWZpZXIgb2YgdGhpcyBwYWNrYWdlIHF1YWxpZmllZCB0eXBlCisJICovCisJcHVi
bGljIE5hbWUgZ2V0UXVhbGlmaWVyKCkgeworCQlpZiAodGhpcy5xdWFsaWZpZXIgPT0gbnVsbCkg
eworCQkJLy8gbGF6eSBpbml0IG11c3QgYmUgdGhyZWFkLXNhZmUgZm9yIHJlYWRlcnMKKwkJCXN5
bmNocm9uaXplZCAodGhpcykgeworCQkJCWlmICh0aGlzLnF1YWxpZmllciA9PSBudWxsKSB7CisJ
CQkJCXByZUxhenlJbml0KCk7CisJCQkJCXRoaXMucXVhbGlmaWVyID0gbmV3IFNpbXBsZU5hbWUo
dGhpcy5hc3QpOworCQkJCQlwb3N0TGF6eUluaXQodGhpcy5xdWFsaWZpZXIsIFFVQUxJRklFUl9Q
Uk9QRVJUWSk7CisJCQkJfQorCQkJfQorCQl9CisJCXJldHVybiB0aGlzLnF1YWxpZmllcjsKKwl9
CisKKwkvKioKKwkgKiBTZXRzIHRoZSBxdWFsaWZpZXIgb2YgdGhpcyBwYWNrYWdlIHF1YWxpZmll
ZCB0eXBlIHRvIHRoZSBnaXZlbiBuYW1lLgorCSAqCisJICogQHBhcmFtIG5hbWUgdGhlIG5ldyBx
dWFsaWZpZXIgb2YgdGhpcyBwYWNrYWdlIHF1YWxpZmllZCB0eXBlCisJICogQGV4Y2VwdGlvbiBJ
bGxlZ2FsQXJndW1lbnRFeGNlcHRpb24gaWY6CisJICogPHVsPgorCSAqIDxsaT50aGUgbm9kZSBi
ZWxvbmdzIHRvIGEgZGlmZmVyZW50IEFTVDwvbGk+CisJICogPGxpPnRoZSBub2RlIGFscmVhZHkg
aGFzIGEgcGFyZW50PC9saT4KKwkgKiA8L3VsPgorCSAqLworCXB1YmxpYyB2b2lkIHNldFF1YWxp
ZmllcihOYW1lIG5hbWUpIHsKKwkJaWYgKG5hbWUgPT0gbnVsbCkgeworCQkJdGhyb3cgbmV3IEls
bGVnYWxBcmd1bWVudEV4Y2VwdGlvbigpOworCQl9CisJCUFTVE5vZGUgb2xkQ2hpbGQgPSB0aGlz
LnF1YWxpZmllcjsKKwkJcHJlUmVwbGFjZUNoaWxkKG9sZENoaWxkLCBuYW1lLCBRVUFMSUZJRVJf
UFJPUEVSVFkpOworCQl0aGlzLnF1YWxpZmllciA9IG5hbWU7CisJCXBvc3RSZXBsYWNlQ2hpbGQo
b2xkQ2hpbGQsIG5hbWUsIFFVQUxJRklFUl9QUk9QRVJUWSk7CisJfQorCisJLyoqCisJICogUmV0
dXJucyB0aGUgbmFtZSBwYXJ0IG9mIHRoaXMgcGFja2FnZSBxdWFsaWZpZWQgdHlwZS4KKwkgKgor
CSAqIEByZXR1cm4gdGhlIG5hbWUgYmVpbmcgcXVhbGlmaWVkCisJICovCisJcHVibGljIFNpbXBs
ZU5hbWUgZ2V0TmFtZSgpIHsKKwkJaWYgKHRoaXMubmFtZSA9PSBudWxsKSB7CisJCQkvLyBsYXp5
IGluaXQgbXVzdCBiZSB0aHJlYWQtc2FmZSBmb3IgcmVhZGVycworCQkJc3luY2hyb25pemVkICh0
aGlzKSB7CisJCQkJaWYgKHRoaXMubmFtZSA9PSBudWxsKSB7CisJCQkJCXByZUxhenlJbml0KCk7
CisJCQkJCXRoaXMubmFtZSA9IG5ldyBTaW1wbGVOYW1lKHRoaXMuYXN0KTsKKwkJCQkJcG9zdExh
enlJbml0KHRoaXMubmFtZSwgTkFNRV9QUk9QRVJUWSk7CisJCQkJfQorCQkJfQorCQl9CisJCXJl
dHVybiB0aGlzLm5hbWU7CisJfQorCisJLyoqCisJICogU2V0cyB0aGUgbmFtZSBwYXJ0IG9mIHRo
aXMgcGFja2FnZSBxdWFsaWZpZWQgdHlwZSB0byB0aGUgZ2l2ZW4gc2ltcGxlIG5hbWUuCisJICoK
KwkgKiBAcGFyYW0gbmFtZSB0aGUgaWRlbnRpZmllciBvZiB0aGlzIHF1YWxpZmllZCBuYW1lCisJ
ICogQGV4Y2VwdGlvbiBJbGxlZ2FsQXJndW1lbnRFeGNlcHRpb24gaWY6CisJICogPHVsPgorCSAq
IDxsaT50aGUgbm9kZSBiZWxvbmdzIHRvIGEgZGlmZmVyZW50IEFTVDwvbGk+CisJICogPGxpPnRo
ZSBub2RlIGFscmVhZHkgaGFzIGEgcGFyZW50PC9saT4KKwkgKiA8L3VsPgorCSAqLworCXB1Ymxp
YyB2b2lkIHNldE5hbWUoU2ltcGxlTmFtZSBuYW1lKSB7CisJCWlmIChuYW1lID09IG51bGwpIHsK
KwkJCXRocm93IG5ldyBJbGxlZ2FsQXJndW1lbnRFeGNlcHRpb24oKTsKKwkJfQorCQlBU1ROb2Rl
IG9sZENoaWxkID0gdGhpcy5uYW1lOworCQlwcmVSZXBsYWNlQ2hpbGQob2xkQ2hpbGQsIG5hbWUs
IE5BTUVfUFJPUEVSVFkpOworCQl0aGlzLm5hbWUgPSBuYW1lOworCQlwb3N0UmVwbGFjZUNoaWxk
KG9sZENoaWxkLCBuYW1lLCBOQU1FX1BST1BFUlRZKTsKKwl9CisKKwkvKiAob21pdCBqYXZhZG9j
IGZvciB0aGlzIG1ldGhvZCkKKwkgKiBNZXRob2QgZGVjbGFyZWQgb24gQVNUTm9kZS4KKwkgKi8K
KwlpbnQgbWVtU2l6ZSgpIHsKKwkJLy8gdHJlYXQgQ29kZSBhcyBmcmVlCisJCXJldHVybiBCQVNF
X05PREVfU0laRSArIDIgKiA0OworCX0KKworCS8qIChvbWl0IGphdmFkb2MgZm9yIHRoaXMgbWV0
aG9kKQorCSAqIE1ldGhvZCBkZWNsYXJlZCBvbiBBU1ROb2RlLgorCSAqLworCWludCB0cmVlU2l6
ZSgpIHsKKwkJcmV0dXJuCisJCQltZW1TaXplKCkKKwkJCSsgKHRoaXMucXVhbGlmaWVyID09IG51
bGwgPyAwIDogZ2V0UXVhbGlmaWVyKCkudHJlZVNpemUoKSkKKwkJCSsgKHRoaXMuYW5ub3RhdGlv
bnMgPT0gbnVsbCA/IDAgOiB0aGlzLmFubm90YXRpb25zLmxpc3RTaXplKCkpCisJCQkrICh0aGlz
Lm5hbWUgPT0gbnVsbCA/IDAgOiBnZXROYW1lKCkudHJlZVNpemUoKSk7CisJfQorCit9CmRpZmYg
LS1naXQgYS9vcmcuZWNsaXBzZS5qZHQuY29yZS9kb20vb3JnL2VjbGlwc2UvamR0L2NvcmUvZG9t
L1R5cGUuamF2YSBiL29yZy5lY2xpcHNlLmpkdC5jb3JlL2RvbS9vcmcvZWNsaXBzZS9qZHQvY29y
ZS9kb20vVHlwZS5qYXZhCmluZGV4IGI3MjQxMTUuLmI1MTRmMWQgMTAwNjQ0Ci0tLSBhL29yZy5l
Y2xpcHNlLmpkdC5jb3JlL2RvbS9vcmcvZWNsaXBzZS9qZHQvY29yZS9kb20vVHlwZS5qYXZhCisr
KyBiL29yZy5lY2xpcHNlLmpkdC5jb3JlL2RvbS9vcmcvZWNsaXBzZS9qZHQvY29yZS9kb20vVHlw
ZS5qYXZhCkBAIC0xMTIsNiArMTEyLDE4IEBACiAJfQogCiAJLyoqCisJICogUmV0dXJucyB3aGV0
aGVyIHRoaXMgdHlwZSBpcyBhIHBhY2thZ2UgcXVhbGlmaWVkIHR5cGUKKwkgKiAoe0BsaW5rIFBh
Y2thZ2VRdWFsaWZpZWRUeXBlfSkuCisJICoKKwkgKiBAcmV0dXJuIDxjb2RlPnRydWU8L2NvZGU+
IGlmIHRoaXMgaXMgYSBwYWNrYWdlIHF1YWxpZmllZCB0eXBlLCBhbmQKKwkgKiAgICA8Y29kZT5m
YWxzZTwvY29kZT4gb3RoZXJ3aXNlCisJICogQHNpbmNlIDMuOQorCSAqLworCXB1YmxpYyBmaW5h
bCBib29sZWFuIGlzUGFja2FnZVF1YWxpZmllZFR5cGUoKSB7CisJCXJldHVybiAodGhpcyBpbnN0
YW5jZW9mIFBhY2thZ2VRdWFsaWZpZWRUeXBlKTsKKwl9CisKKwkvKioKIAkgKiBSZXR1cm5zIHdo
ZXRoZXIgdGhpcyB0eXBlIGlzIGEgcGFyYW1ldGVyaXplZCB0eXBlCiAJICogKHtAbGluayBQYXJh
bWV0ZXJpemVkVHlwZX0pLgogCSAqCmRpZmYgLS1naXQgYS9vcmcuZWNsaXBzZS5qZHQuY29yZS9k
b20vb3JnL2VjbGlwc2UvamR0L2ludGVybmFsL2NvcmUvZG9tL05haXZlQVNURmxhdHRlbmVyLmph
dmEgYi9vcmcuZWNsaXBzZS5qZHQuY29yZS9kb20vb3JnL2VjbGlwc2UvamR0L2ludGVybmFsL2Nv
cmUvZG9tL05haXZlQVNURmxhdHRlbmVyLmphdmEKaW5kZXggODA1OGE0YS4uMDZmM2VmMiAxMDA2
NDQKLS0tIGEvb3JnLmVjbGlwc2UuamR0LmNvcmUvZG9tL29yZy9lY2xpcHNlL2pkdC9pbnRlcm5h
bC9jb3JlL2RvbS9OYWl2ZUFTVEZsYXR0ZW5lci5qYXZhCisrKyBiL29yZy5lY2xpcHNlLmpkdC5j
b3JlL2RvbS9vcmcvZWNsaXBzZS9qZHQvaW50ZXJuYWwvY29yZS9kb20vTmFpdmVBU1RGbGF0dGVu
ZXIuamF2YQpAQCAtMTE4Nyw2ICsxMTg3LDE4IEBACiAJfQogCiAJLyoKKwkgKiBAc2VlIEFTVFZp
c2l0b3IjdmlzaXQoUGFja2FnZVF1YWxpZmllZFR5cGUpCisJICogQHNpbmNlIDMuOQorCSAqLwor
CXB1YmxpYyBib29sZWFuIHZpc2l0KFBhY2thZ2VRdWFsaWZpZWRUeXBlIG5vZGUpIHsKKwkJbm9k
ZS5nZXRRdWFsaWZpZXIoKS5hY2NlcHQodGhpcyk7CisJCXRoaXMuYnVmZmVyLmFwcGVuZCgnLicp
OworCQl2aXNpdFR5cGVBbm5vdGF0aW9ucyhub2RlKTsKKwkJbm9kZS5nZXROYW1lKCkuYWNjZXB0
KHRoaXMpOworCQlyZXR1cm4gZmFsc2U7CisJfQorCisJLyoKIAkgKiBAc2VlIEFTVFZpc2l0b3Ij
dmlzaXQoUGFyYW1ldGVyaXplZFR5cGUpCiAJICogQHNpbmNlIDMuMQogCSAqLw==
</data>

          </attachment>
          <attachment
              isobsolete="1"
              ispatch="1"
              isprivate="0"
          >
            <attachid>229842</attachid>
            <date>2013-04-18 02:35:00 -0400</date>
            <delta_ts>2013-04-19 01:25:49 -0400</delta_ts>
            <desc>Proposed Patch</desc>
            <filename>Fix-for-Bug-404489--18dom-ast-Incorrect-conversion-o.patch</filename>
            <type>text/plain</type>
            <size>58849</size>
            <attacher name="Manoj Palat Away Until May 11 2015">manpalat</attacher>
            
              <data encoding="base64">ZGlmZiAtLWdpdCBhL29yZy5lY2xpcHNlLmpkdC5jb3JlLnRlc3RzLm1vZGVsL3NyYy9vcmcvZWNs
aXBzZS9qZHQvY29yZS90ZXN0cy9kb20vQVNUQ29udmVydGVyMTVUZXN0LmphdmEgYi9vcmcuZWNs
aXBzZS5qZHQuY29yZS50ZXN0cy5tb2RlbC9zcmMvb3JnL2VjbGlwc2UvamR0L2NvcmUvdGVzdHMv
ZG9tL0FTVENvbnZlcnRlcjE1VGVzdC5qYXZhCmluZGV4IDljMjhjNTkuLjdlMDIxMzggMTAwNjQ0
Ci0tLSBhL29yZy5lY2xpcHNlLmpkdC5jb3JlLnRlc3RzLm1vZGVsL3NyYy9vcmcvZWNsaXBzZS9q
ZHQvY29yZS90ZXN0cy9kb20vQVNUQ29udmVydGVyMTVUZXN0LmphdmEKKysrIGIvb3JnLmVjbGlw
c2UuamR0LmNvcmUudGVzdHMubW9kZWwvc3JjL29yZy9lY2xpcHNlL2pkdC9jb3JlL3Rlc3RzL2Rv
bS9BU1RDb252ZXJ0ZXIxNVRlc3QuamF2YQpAQCAtMTE1MjcsNCArMTE1MjcsMzYgQEAKIAkJCWRl
bGV0ZVByb2plY3QoanApOwogCQl9CiAJfQorCisJLy8gaHR0cHM6Ly9idWdzLmVjbGlwc2Uub3Jn
L2J1Z3Mvc2hvd19idWcuY2dpP2lkPTQwNDQ4OQorCXB1YmxpYyB2b2lkIHRlc3RCdWc0MDQ0ODko
KSB0aHJvd3MgSmF2YU1vZGVsRXhjZXB0aW9uIHsKKwkJSUNvbXBpbGF0aW9uVW5pdCBzb3VyY2VV
bml0ID0gZ2V0Q29tcGlsYXRpb25Vbml0KCJDb252ZXJ0ZXIxOCIgLCAic3JjIiwgInRlc3Q0MDQ0
ODkuYnVnIiwgIlguamF2YSIpOyAvLyROT04tTkxTLTEkIC8vJE5PTi1OTFMtMiQgLy8kTk9OLU5M
Uy0zJCAvLyROT04tTkxTLTQkCisJCUFTVE5vZGUgcmVzdWx0ID0gcnVuQ29udmVyc2lvbih0aGlz
LmFzdC5hcGlMZXZlbCgpLCBzb3VyY2VVbml0LCB0cnVlKTsKKwkJYXNzZXJ0VHJ1ZSgiTm90IGEg
Y29tcGlsYXRpb24gdW5pdCIsIHJlc3VsdC5nZXROb2RlVHlwZSgpID09IEFTVE5vZGUuQ09NUElM
QVRJT05fVU5JVCk7CisJCUNvbXBpbGF0aW9uVW5pdCBjb21waWxhdGlvblVuaXQgPSAoQ29tcGls
YXRpb25Vbml0KSByZXN1bHQ7CisJCWFzc2VydFByb2JsZW1zU2l6ZShjb21waWxhdGlvblVuaXQs
IDApOworCQlBU1ROb2RlIG5vZGUgPSBnZXRBU1ROb2RlKGNvbXBpbGF0aW9uVW5pdCwgMCwgMCwg
MCk7CisJCVR5cGVEZWNsYXJhdGlvbiB0eXBlRGVjbGFyYXRpb24gPSAgKFR5cGVEZWNsYXJhdGlv
bikgY29tcGlsYXRpb25Vbml0LnR5cGVzKCkuZ2V0KDApOworCisJCW5vZGUgPSAoQVNUTm9kZSkg
dHlwZURlY2xhcmF0aW9uLmJvZHlEZWNsYXJhdGlvbnMoKS5nZXQoMik7CisJCWFzc2VydEVxdWFs
cygiTm90IGEgbWV0aG9kIGRlY2xhcmF0aW9uIiwgQVNUTm9kZS5NRVRIT0RfREVDTEFSQVRJT04s
IG5vZGUuZ2V0Tm9kZVR5cGUoKSk7CQkKKwkJTWV0aG9kRGVjbGFyYXRpb24gbWV0aG9kRGVjbCA9
IChNZXRob2REZWNsYXJhdGlvbikgbm9kZTsKKwkJVHlwZSB0eXBlID0gbWV0aG9kRGVjbC5nZXRS
ZXR1cm5UeXBlMigpOworCQlhc3NlcnRUcnVlKHR5cGUuaXNRdWFsaWZpZWRUeXBlKCkpOworCQlh
c3NlcnRUcnVlKGlzTWFsZm9ybWVkKHR5cGUpKTsKKworCQkvLyBwYXJhbWV0ZXIKKwkJU2luZ2xl
VmFyaWFibGVEZWNsYXJhdGlvbiBwYXJhbSA9IChTaW5nbGVWYXJpYWJsZURlY2xhcmF0aW9uKSBt
ZXRob2REZWNsLnBhcmFtZXRlcnMoKS5nZXQoMCk7CisJCXR5cGUgPSBwYXJhbS5nZXRUeXBlKCk7
CisJCWFzc2VydFRydWUodHlwZS5pc1F1YWxpZmllZFR5cGUoKSk7CisJCWFzc2VydFRydWUoaXNN
YWxmb3JtZWQodHlwZSkpOworCQkKKwkJbm9kZSA9IChBU1ROb2RlKSB0eXBlRGVjbGFyYXRpb24u
Ym9keURlY2xhcmF0aW9ucygpLmdldCgzKTsKKwkJYXNzZXJ0RXF1YWxzKCJOb3QgYSBmaWVsZCBk
ZWNsYXJhdGlvbiIsIEFTVE5vZGUuRklFTERfREVDTEFSQVRJT04sIG5vZGUuZ2V0Tm9kZVR5cGUo
KSk7CQkKKwkJRmllbGREZWNsYXJhdGlvbiBmaWVsZCA9IChGaWVsZERlY2xhcmF0aW9uKSBub2Rl
OworCQl0eXBlID0gZmllbGQuZ2V0VHlwZSgpOworCQlhc3NlcnRUcnVlKHR5cGUuaXNRdWFsaWZp
ZWRUeXBlKCkpOworCQlhc3NlcnRUcnVlKHR5cGUuaXNRdWFsaWZpZWRUeXBlKCkpOworCQlhc3Nl
cnRUcnVlKGlzTWFsZm9ybWVkKHR5cGUpKTsKKwl9CiB9ClwgTm8gbmV3bGluZSBhdCBlbmQgb2Yg
ZmlsZQpkaWZmIC0tZ2l0IGEvb3JnLmVjbGlwc2UuamR0LmNvcmUudGVzdHMubW9kZWwvc3JjL29y
Zy9lY2xpcHNlL2pkdC9jb3JlL3Rlc3RzL2RvbS9BU1RDb252ZXJ0ZXIxOFRlc3QuamF2YSBiL29y
Zy5lY2xpcHNlLmpkdC5jb3JlLnRlc3RzLm1vZGVsL3NyYy9vcmcvZWNsaXBzZS9qZHQvY29yZS90
ZXN0cy9kb20vQVNUQ29udmVydGVyMThUZXN0LmphdmEKaW5kZXggZjc2OGFlMy4uMzc3YzFkZSAx
MDA2NDQKLS0tIGEvb3JnLmVjbGlwc2UuamR0LmNvcmUudGVzdHMubW9kZWwvc3JjL29yZy9lY2xp
cHNlL2pkdC9jb3JlL3Rlc3RzL2RvbS9BU1RDb252ZXJ0ZXIxOFRlc3QuamF2YQorKysgYi9vcmcu
ZWNsaXBzZS5qZHQuY29yZS50ZXN0cy5tb2RlbC9zcmMvb3JnL2VjbGlwc2UvamR0L2NvcmUvdGVz
dHMvZG9tL0FTVENvbnZlcnRlcjE4VGVzdC5qYXZhCkBAIC0xNDksMTAgKzE0OSwxMCBAQAogCQlh
c3NlcnROb3ROdWxsKGFzc2lnbm1lbnQpOwogCQlDYXN0RXhwcmVzc2lvbiBjYXN0RXhwcmVzc2lv
biA9IChDYXN0RXhwcmVzc2lvbikgYXNzaWdubWVudC5nZXRSaWdodEhhbmRTaWRlKCk7CiAJCWFz
c2VydE5vdE51bGwoY2FzdEV4cHJlc3Npb24pOwotCQlTaW1wbGVUeXBlIHNpbXBsZVR5cGUgPSAo
U2ltcGxlVHlwZSkgY2FzdEV4cHJlc3Npb24uZ2V0VHlwZSgpOwotCQlhc3NlcnROb3ROdWxsKHNp
bXBsZVR5cGUpOwotCQlhc3NlcnRFcXVhbHMoImphdmEubGFuZy5ATWFya2VyIFN0cmluZyIsIHNp
bXBsZVR5cGUudG9TdHJpbmcoKSk7Ci0JCUxpc3QgYW5ub3RhdGlvbnMgPSBzaW1wbGVUeXBlLmFu
bm90YXRpb25zKCk7CisJCVBhY2thZ2VRdWFsaWZpZWRUeXBlIHBhY2thZ2VRdWFsaWZpZWRUeXBl
ID0gKFBhY2thZ2VRdWFsaWZpZWRUeXBlKSBjYXN0RXhwcmVzc2lvbi5nZXRUeXBlKCk7CisJCWFz
c2VydE5vdE51bGwocGFja2FnZVF1YWxpZmllZFR5cGUpOworCQlhc3NlcnRFcXVhbHMoImphdmEu
bGFuZy5ATWFya2VyIFN0cmluZyIsIHBhY2thZ2VRdWFsaWZpZWRUeXBlLnRvU3RyaW5nKCkpOwor
CQlMaXN0IGFubm90YXRpb25zID0gcGFja2FnZVF1YWxpZmllZFR5cGUuYW5ub3RhdGlvbnMoKTsK
IAkJYXNzZXJ0VHJ1ZShhbm5vdGF0aW9ucy5zaXplKCkgPT0gMSk7CiAJCWFzc2VydEVxdWFscygi
QE1hcmtlciIsIGFubm90YXRpb25zLmdldCgwKS50b1N0cmluZygpKTsKIApAQCAtMTYwLDcgKzE2
MCw3IEBACiAJCVZhcmlhYmxlRGVjbGFyYXRpb25TdGF0ZW1lbnQgdmFyaWFibGVEZWNsYXJhdGlv
blN0YXRlbWVudCA9IChWYXJpYWJsZURlY2xhcmF0aW9uU3RhdGVtZW50KSBzdGF0ZW1lbnRzLmdl
dChzQ291bnQrKyk7CiAJCVR5cGUgdHlwZSA9IHZhcmlhYmxlRGVjbGFyYXRpb25TdGF0ZW1lbnQu
Z2V0VHlwZSgpOwogCQlhc3NlcnRUcnVlKHR5cGUuaXNTaW1wbGVUeXBlKCkpOwotCQlzaW1wbGVU
eXBlID0gKFNpbXBsZVR5cGUpIHR5cGU7CisJCVNpbXBsZVR5cGUgc2ltcGxlVHlwZSA9IChTaW1w
bGVUeXBlKSB0eXBlOwogCQlhc3NlcnRFcXVhbHMoIk91dGVyLklubmVyIiwgc2ltcGxlVHlwZS50
b1N0cmluZygpKTsKIAkJYW5ub3RhdGlvbnMgPSBzaW1wbGVUeXBlLmFubm90YXRpb25zKCk7CiAJ
CWFzc2VydFRydWUoYW5ub3RhdGlvbnMuc2l6ZSgpID09IDApOwpAQCAtMTY5LDIyICsxNjksMjIg
QEAKIAkJLy8gYW5ub3RhdGlvbnMuCiAJCXZhcmlhYmxlRGVjbGFyYXRpb25TdGF0ZW1lbnQgPSAo
VmFyaWFibGVEZWNsYXJhdGlvblN0YXRlbWVudCkgc3RhdGVtZW50cy5nZXQoc0NvdW50KyspOwog
CQl0eXBlID0gdmFyaWFibGVEZWNsYXJhdGlvblN0YXRlbWVudC5nZXRUeXBlKCk7Ci0JCWFzc2Vy
dFRydWUodHlwZS5pc1NpbXBsZVR5cGUoKSk7Ci0JCXNpbXBsZVR5cGUgPSAoU2ltcGxlVHlwZSkg
dHlwZTsKLQkJYXNzZXJ0Tm90TnVsbChzaW1wbGVUeXBlKTsKLQkJYXNzZXJ0RXF1YWxzKCJPdXRl
ci5ATWFya2VyMiBJbm5lciIsIHNpbXBsZVR5cGUudG9TdHJpbmcoKSk7Ci0JCWFubm90YXRpb25z
ID0gc2ltcGxlVHlwZS5hbm5vdGF0aW9ucygpOworCQlhc3NlcnRUcnVlKHR5cGUuaXNRdWFsaWZp
ZWRUeXBlKCkpOworCQlRdWFsaWZpZWRUeXBlIHF1YWxpZmllZFR5cGUgPSAoUXVhbGlmaWVkVHlw
ZSkgdHlwZTsKKwkJYXNzZXJ0Tm90TnVsbChxdWFsaWZpZWRUeXBlKTsKKwkJYXNzZXJ0RXF1YWxz
KCJPdXRlci5ATWFya2VyMiBJbm5lciIsIHF1YWxpZmllZFR5cGUudG9TdHJpbmcoKSk7CisJCWFu
bm90YXRpb25zID0gcXVhbGlmaWVkVHlwZS5hbm5vdGF0aW9ucygpOwogCQlhc3NlcnRUcnVlKGFu
bm90YXRpb25zLnNpemUoKSA9PSAxKTsKIAkJYXNzZXJ0RXF1YWxzKCJATWFya2VyMiIsIGFubm90
YXRpb25zLmdldCgwKS50b1N0cmluZygpKTsKIAogCQkvLyBjYXNlIDQgLSBNdWx0aXBsZSBsZXZl
bHMgd2l0aCBhbm5vdGF0aW9ucyBhdCB0aGUgbGFzdCBvbmx5LgogCQl2YXJpYWJsZURlY2xhcmF0
aW9uU3RhdGVtZW50ID0gKFZhcmlhYmxlRGVjbGFyYXRpb25TdGF0ZW1lbnQpIHN0YXRlbWVudHMu
Z2V0KHNDb3VudCsrKTsKIAkJdHlwZSA9IHZhcmlhYmxlRGVjbGFyYXRpb25TdGF0ZW1lbnQuZ2V0
VHlwZSgpOwotCQlhc3NlcnRUcnVlKHR5cGUuaXNTaW1wbGVUeXBlKCkpOwotCQlzaW1wbGVUeXBl
ID0gKFNpbXBsZVR5cGUpIHR5cGU7Ci0JCWFzc2VydE5vdE51bGwoc2ltcGxlVHlwZSk7Ci0JCWFz
c2VydEVxdWFscygiT3V0ZXIuSW5uZXIuQE1hcmtlcjEgRGVlcGVyIiwgc2ltcGxlVHlwZS50b1N0
cmluZygpKTsKLQkJYW5ub3RhdGlvbnMgPSBzaW1wbGVUeXBlLmFubm90YXRpb25zKCk7CisJCWFz
c2VydFRydWUodHlwZS5pc1F1YWxpZmllZFR5cGUoKSk7CisJCXF1YWxpZmllZFR5cGUgPSAoUXVh
bGlmaWVkVHlwZSkgdHlwZTsKKwkJYXNzZXJ0Tm90TnVsbChxdWFsaWZpZWRUeXBlKTsKKwkJYXNz
ZXJ0RXF1YWxzKCJPdXRlci5Jbm5lci5ATWFya2VyMSBEZWVwZXIiLCBxdWFsaWZpZWRUeXBlLnRv
U3RyaW5nKCkpOworCQlhbm5vdGF0aW9ucyA9IHF1YWxpZmllZFR5cGUuYW5ub3RhdGlvbnMoKTsK
IAkJYXNzZXJ0VHJ1ZShhbm5vdGF0aW9ucy5zaXplKCkgPT0gMSk7CiAJCWFzc2VydEVxdWFscygi
QE1hcmtlcjEiLCBhbm5vdGF0aW9ucy5nZXQoMCkudG9TdHJpbmcoKSk7CiAKQEAgLTE5Miw3ICsx
OTIsNyBAQAogCQl2YXJpYWJsZURlY2xhcmF0aW9uU3RhdGVtZW50ID0gKFZhcmlhYmxlRGVjbGFy
YXRpb25TdGF0ZW1lbnQpIHN0YXRlbWVudHMuZ2V0KHNDb3VudCsrKTsKIAkJdHlwZSA9IHZhcmlh
YmxlRGVjbGFyYXRpb25TdGF0ZW1lbnQuZ2V0VHlwZSgpOwogCQlhc3NlcnRUcnVlKHR5cGUuaXNR
dWFsaWZpZWRUeXBlKCkpOwotCQlRdWFsaWZpZWRUeXBlIHF1YWxpZmllZFR5cGUgPSAoUXVhbGlm
aWVkVHlwZSkgdHlwZTsKKwkJcXVhbGlmaWVkVHlwZSA9IChRdWFsaWZpZWRUeXBlKSB0eXBlOwog
CQlhc3NlcnROb3ROdWxsKHF1YWxpZmllZFR5cGUpOwogCQlhc3NlcnRFcXVhbHMoIk91dGVyLkBN
YXJrZXIxIElubmVyLkBNYXJrZXIyIERlZXBlciIsIHF1YWxpZmllZFR5cGUudG9TdHJpbmcoKSk7
CiAJCWFubm90YXRpb25zID0gcXVhbGlmaWVkVHlwZS5hbm5vdGF0aW9ucygpOwpAQCAtMjAxLDEw
ICsyMDEsMTAgQEAKIAkJU2ltcGxlTmFtZSBzaW1wbGVOYW1lID0gcXVhbGlmaWVkVHlwZS5nZXRO
YW1lKCk7CiAJCWFzc2VydEVxdWFscygiRGVlcGVyIiwgc2ltcGxlTmFtZS50b1N0cmluZygpKTsK
IAkJVHlwZSBxdWFsaWZpZXJUeXBlID0gcXVhbGlmaWVkVHlwZS5nZXRRdWFsaWZpZXIoKTsKLQkJ
YXNzZXJ0VHJ1ZShxdWFsaWZpZXJUeXBlLmlzU2ltcGxlVHlwZSgpKTsKLQkJc2ltcGxlVHlwZSA9
IChTaW1wbGVUeXBlKSBxdWFsaWZpZXJUeXBlOwotCQlhc3NlcnRFcXVhbHMoIk91dGVyLkBNYXJr
ZXIxIElubmVyIiwgc2ltcGxlVHlwZS50b1N0cmluZygpKTsKLQkJYW5ub3RhdGlvbnMgPSBzaW1w
bGVUeXBlLmFubm90YXRpb25zKCk7CisJCWFzc2VydFRydWUocXVhbGlmaWVyVHlwZS5pc1F1YWxp
ZmllZFR5cGUoKSk7CisJCXF1YWxpZmllZFR5cGUgPSAoUXVhbGlmaWVkVHlwZSkgcXVhbGlmaWVy
VHlwZTsKKwkJYXNzZXJ0RXF1YWxzKCJPdXRlci5ATWFya2VyMSBJbm5lciIsIHF1YWxpZmllZFR5
cGUudG9TdHJpbmcoKSk7CisJCWFubm90YXRpb25zID0gcXVhbGlmaWVkVHlwZS5hbm5vdGF0aW9u
cygpOwogCQlhc3NlcnRUcnVlKGFubm90YXRpb25zLnNpemUoKSA9PSAxKTsKIAkJYXNzZXJ0RXF1
YWxzKCJATWFya2VyMSIsIGFubm90YXRpb25zLmdldCgwKS50b1N0cmluZygpKTsKIAl9CkBAIC0z
NDIsMTAgKzM0MiwxMCBAQAogCQl0eXBlQXJndW1lbnRzID0gcGFyYW1ldHJpemVkVHlwZS50eXBl
QXJndW1lbnRzKCk7CiAJCWFzc2VydEVxdWFscygxLCB0eXBlQXJndW1lbnRzLnNpemUoKSk7CiAJ
CXR5cGUgPSAoVHlwZSkgdHlwZUFyZ3VtZW50cy5nZXQoMCk7Ci0JCWFzc2VydFRydWUodHlwZS5p
c1NpbXBsZVR5cGUoKSk7Ci0JCVNpbXBsZVR5cGUgc2ltcGxlVHlwZSA9IChTaW1wbGVUeXBlKSB0
eXBlOwotCQlhc3NlcnRFcXVhbHMoIk91dGVyLkBNYXJrZXIxIElubmVyIiwgc2ltcGxlVHlwZS50
b1N0cmluZygpKTsKLQkJTGlzdCBhbm5vdGF0aW9ucyA9IHNpbXBsZVR5cGUuYW5ub3RhdGlvbnMo
KTsKKwkJYXNzZXJ0VHJ1ZSh0eXBlLmlzUXVhbGlmaWVkVHlwZSgpKTsKKwkJUXVhbGlmaWVkVHlw
ZSBxdWFsaWZpZWRUeXBlID0gKFF1YWxpZmllZFR5cGUpIHR5cGU7CisJCWFzc2VydEVxdWFscygi
T3V0ZXIuQE1hcmtlcjEgSW5uZXIiLCBxdWFsaWZpZWRUeXBlLnRvU3RyaW5nKCkpOworCQlMaXN0
IGFubm90YXRpb25zID0gcXVhbGlmaWVkVHlwZS5hbm5vdGF0aW9ucygpOwogCQlhc3NlcnRUcnVl
KGFubm90YXRpb25zLnNpemUoKSA9PSAxKTsKIAkJQW5ub3RhdGlvbiBhbm5vdGF0aW9uID0gKEFu
bm90YXRpb24pIGFubm90YXRpb25zLmdldCgwKTsKIAkJYXNzZXJ0RXF1YWxzKCJATWFya2VyMSIs
IGFubm90YXRpb24udG9TdHJpbmcoKSk7CkBAIC0zNTksMTMgKzM1OSwxMyBAQAogCQl0eXBlID0g
KFR5cGUpIHR5cGVBcmd1bWVudHMuZ2V0KDApOwogCQlhc3NlcnRUcnVlKHR5cGUuaXNRdWFsaWZp
ZWRUeXBlKCkpOwogCQlhc3NlcnRFcXVhbHMoIkBNYXJrZXIxIE91dGVyLklubmVyIiwgdHlwZS50
b1N0cmluZygpKTsKLQkJUXVhbGlmaWVkVHlwZSBxdWFsaWZpZWRUeXBlID0gKFF1YWxpZmllZFR5
cGUpIHR5cGU7CisJCXF1YWxpZmllZFR5cGUgPSAoUXVhbGlmaWVkVHlwZSkgdHlwZTsKIAkJYXNz
ZXJ0RXF1YWxzKCJJbm5lciIsIHF1YWxpZmllZFR5cGUuZ2V0TmFtZSgpLnRvU3RyaW5nKCkpOwog
CQlhbm5vdGF0aW9ucyA9IHF1YWxpZmllZFR5cGUuYW5ub3RhdGlvbnMoKTsKIAkJYXNzZXJ0VHJ1
ZShhbm5vdGF0aW9ucy5zaXplKCkgPT0gMCk7CiAJCVR5cGUgcXVhbGlmaWVyVHlwZSA9IHF1YWxp
ZmllZFR5cGUuZ2V0UXVhbGlmaWVyKCk7CiAJCWFzc2VydFRydWUocXVhbGlmaWVyVHlwZS5pc1Np
bXBsZVR5cGUoKSk7Ci0JCXNpbXBsZVR5cGUgPSAoU2ltcGxlVHlwZSkgcXVhbGlmaWVyVHlwZTsK
KwkJU2ltcGxlVHlwZSBzaW1wbGVUeXBlID0gKFNpbXBsZVR5cGUpIHF1YWxpZmllclR5cGU7CiAJ
CWFzc2VydEVxdWFscygiQE1hcmtlcjEgT3V0ZXIiLCBzaW1wbGVUeXBlLnRvU3RyaW5nKCkpOwog
CQlhbm5vdGF0aW9ucyA9IHNpbXBsZVR5cGUuYW5ub3RhdGlvbnMoKTsKIAkJYXNzZXJ0VHJ1ZShh
bm5vdGF0aW9ucy5zaXplKCkgPT0gMSk7CkBAIC0xOTM1LDQgKzE5MzUsMzE2IEBACiAJCW1ldGhv
ZCA9IChNZXRob2REZWNsYXJhdGlvbikgdHlwZS5ib2R5RGVjbGFyYXRpb25zKCkuZ2V0KDMpOwog
CQlhc3NlcnRFcXVhbHMoIk1ldGhvZCBzaG91bGQgYmUgbWFsZm9ybWVkIiwgQVNUTm9kZS5NQUxG
T1JNRUQsIChtZXRob2QuZ2V0RmxhZ3MoKSAmIEFTVE5vZGUuTUFMRk9STUVEKSk7CiAJfQorCisJ
Ly8gaHR0cHM6Ly9idWdzLmVjbGlwc2Uub3JnL2J1Z3Mvc2hvd19idWcuY2dpP2lkPTQwNDQ4OQor
CXB1YmxpYyB2b2lkIHRlc3RCdWc0MDQ0ODlhKCkgdGhyb3dzIEphdmFNb2RlbEV4Y2VwdGlvbiB7
CisJCVN0cmluZyBjb250ZW50cyA9CisJCSJwYWNrYWdlIHRlc3Q0MDQ0ODkuYnVnO1xuIiArCisJ
CSJwdWJsaWMgY2xhc3MgWCB7IFxuIiArCisJCSIJY2xhc3MgWSB7IFxuIiArCisJCSIJCWNsYXNz
IFoge1xuIiArCisJCSIJCQlwdWJsaWMgWihAQSBYLkBCIFkgWS50aGlzKXt9XG4iICsKKwkJIgkJ
CX1cbiIgKworCQkiICAJCX1cbiIgKworCQkiICAJCU9iamVjdCBvPShAQSBYLkBCIFkuQE1hcmtl
ciAgWiludWxsO1xuIiArCisJCSIJfVxuIiArCisJCSJAamF2YS5sYW5nLmFubm90YXRpb24uVGFy
Z2V0KGphdmEubGFuZy5hbm5vdGF0aW9uLkVsZW1lbnRUeXBlLlRZUEVfVVNFKSBAaW50ZXJmYWNl
IE1hcmtlciB7fSBcbiIgKworCQkiQGphdmEubGFuZy5hbm5vdGF0aW9uLlRhcmdldChqYXZhLmxh
bmcuYW5ub3RhdGlvbi5FbGVtZW50VHlwZS5UWVBFX1VTRSkgQGludGVyZmFjZSBBIHt9IFxuIiAr
CisJCSJAamF2YS5sYW5nLmFubm90YXRpb24uVGFyZ2V0KGphdmEubGFuZy5hbm5vdGF0aW9uLkVs
ZW1lbnRUeXBlLlRZUEVfVVNFKSBAaW50ZXJmYWNlIEIge30gXG4iOworCQl0aGlzLndvcmtpbmdD
b3B5ID0gZ2V0V29ya2luZ0NvcHkoIi9Db252ZXJ0ZXIxOC9zcmMvdGVzdDQwNDQ4OS9idWcvWC5q
YXZhIiwgdHJ1ZS8qIHJlc29sdmUgKi8pOworCQlBU1ROb2RlIG5vZGUgPSBidWlsZEFTVChjb250
ZW50cywgdGhpcy53b3JraW5nQ29weSk7CisJCWFzc2VydEVxdWFscygiTm90IGEgY29tcGlsYXRp
b24gdW5pdCIsIEFTVE5vZGUuQ09NUElMQVRJT05fVU5JVCwgbm9kZS5nZXROb2RlVHlwZSgpKTsK
KwkJQ29tcGlsYXRpb25Vbml0IHVuaXQgPSAoQ29tcGlsYXRpb25Vbml0KSBub2RlOworCQlUeXBl
RGVjbGFyYXRpb24gdHlwZSA9ICAoVHlwZURlY2xhcmF0aW9uKSB1bml0LnR5cGVzKCkuZ2V0KDAp
OworCQlub2RlID0gKEFTVE5vZGUpIHR5cGUuYm9keURlY2xhcmF0aW9ucygpLmdldCgwKTsKKwkJ
YXNzZXJ0RXF1YWxzKCJOb3QgYSBUeXBlIERlY2xhcmF0aW9uIiwgQVNUTm9kZS5UWVBFX0RFQ0xB
UkFUSU9OLCBub2RlLmdldE5vZGVUeXBlKCkpOworCQlub2RlID0gKEFTVE5vZGUpICgoVHlwZURl
Y2xhcmF0aW9uKW5vZGUpLmJvZHlEZWNsYXJhdGlvbnMoKS5nZXQoMCk7CisJCWFzc2VydEVxdWFs
cygiTm90IGEgVHlwZSBEZWNsYXJhdGlvbiIsIEFTVE5vZGUuVFlQRV9ERUNMQVJBVElPTiwgbm9k
ZS5nZXROb2RlVHlwZSgpKTsKKwkJbm9kZSA9IChBU1ROb2RlKSAoKFR5cGVEZWNsYXJhdGlvbilu
b2RlKS5ib2R5RGVjbGFyYXRpb25zKCkuZ2V0KDApOwkJCisJCWFzc2VydEVxdWFscygiTm90IGEg
bWV0aG9kIERlY2xhcmF0aW9uIiwgQVNUTm9kZS5NRVRIT0RfREVDTEFSQVRJT04sIG5vZGUuZ2V0
Tm9kZVR5cGUoKSk7CisJCU1ldGhvZERlY2xhcmF0aW9uIG1ldGhvZCA9IChNZXRob2REZWNsYXJh
dGlvbikgbm9kZTsKKwkJYXNzZXJ0RXF1YWxzKCJNZXRob2Qgc2hvdWxkIG5vdCBiZSBtYWxmb3Jt
ZWQiLCAwLCAobWV0aG9kLmdldEZsYWdzKCkgJiBBU1ROb2RlLk1BTEZPUk1FRCkpOworCQlBbm5v
dGF0YWJsZVR5cGUgYW5ub3RhdGFibGVUeXBlID0gbWV0aG9kLmdldFJlY2VpdmVyVHlwZSgpOwor
CQlhc3NlcnRUcnVlKGFubm90YXRhYmxlVHlwZS5pc1F1YWxpZmllZFR5cGUoKSk7CisJCVF1YWxp
ZmllZFR5cGUgcXVhbGlmaWVkVHlwZSA9IChRdWFsaWZpZWRUeXBlKSBhbm5vdGF0YWJsZVR5cGU7
CisJCWFzc2VydEVxdWFscygid3JvbmcgcXVhbGlmaWVkIHR5cGUiLCAiQEEgWC5AQiBZIiwgcXVh
bGlmaWVkVHlwZS50b1N0cmluZygpKTsKKwkJSVR5cGVCaW5kaW5nIGJpbmRpbmcgPSBxdWFsaWZp
ZWRUeXBlLnJlc29sdmVCaW5kaW5nKCk7CisJCWFzc2VydE5vdE51bGwoIk5vIGJpbmRpbmciLCBi
aW5kaW5nKTsKKwkJYXNzZXJ0RXF1YWxzKCJXcm9uZyBxdWFsaWZpZWQgbmFtZSIsICJ0ZXN0NDA0
NDg5LmJ1Zy5YLlkiLCBiaW5kaW5nLmdldFF1YWxpZmllZE5hbWUoKSk7CisJCUxpc3QgYW5ub3Rh
dGlvbnMgPSBxdWFsaWZpZWRUeXBlLmFubm90YXRpb25zKCk7CisJCWFzc2VydFRydWUoYW5ub3Rh
dGlvbnMuc2l6ZSgpID09IDEpOworCQlNYXJrZXJBbm5vdGF0aW9uIG1hcmtlcgk9IChNYXJrZXJB
bm5vdGF0aW9uKSBhbm5vdGF0aW9ucy5nZXQoMCk7CisJCWFzc2VydEVxdWFscygid3JvbmcgYW5u
b3RhdGlvbiBuYW1lIiwgIkBCIiwgbWFya2VyLnRvU3RyaW5nKCkpOworCQliaW5kaW5nID0gbWFy
a2VyLnJlc29sdmVUeXBlQmluZGluZygpOworCQlhc3NlcnROb3ROdWxsKCJObyBiaW5kaW5nIiwg
YmluZGluZyk7CisJCWFzc2VydEVxdWFscygiV3JvbmcgcXVhbGlmaWVkIG5hbWUiLCAidGVzdDQw
NDQ4OS5idWcuQiIsIGJpbmRpbmcuZ2V0UXVhbGlmaWVkTmFtZSgpKTsKKwkJSUFubm90YXRpb25C
aW5kaW5nIGFubm90YXRpb25CaW5kaW5nID0gbWFya2VyLnJlc29sdmVBbm5vdGF0aW9uQmluZGlu
ZygpOworCQlhc3NlcnROb3ROdWxsKGFubm90YXRpb25CaW5kaW5nKTsKKwkJYXNzZXJ0RXF1YWxz
KCJ3cm9uZyBhbm5vdGF0aW9uIGJpbmRpbmciLCAiQiIsIGFubm90YXRpb25CaW5kaW5nLmdldE5h
bWUoKSk7CisJCU5hbWUgbmFtZSA9IG1hcmtlci5nZXRUeXBlTmFtZSgpOworCQlhc3NlcnRUcnVl
KG5hbWUuaXNTaW1wbGVOYW1lKCkpOworCQlTaW1wbGVOYW1lIHNpbXBsZU5hbWUgPSAoU2ltcGxl
TmFtZSkgbmFtZTsKKwkJYXNzZXJ0RXF1YWxzKCJ3cm9uZyB0eXBlIG5hbWUiLCAiQiIsIHNpbXBs
ZU5hbWUudG9TdHJpbmcoKSk7CisJCWFzc2VydEVxdWFscygid3Jvbmcgc2ltcGxlIG5hbWUiLCAi
QiIsc2ltcGxlTmFtZS5nZXRJZGVudGlmaWVyKCkpOworCQliaW5kaW5nID0gc2ltcGxlTmFtZS5y
ZXNvbHZlVHlwZUJpbmRpbmcoKTsKKwkJYXNzZXJ0Tm90TnVsbCgiTm8gYmluZGluZyIsIGJpbmRp
bmcpOworCQlhc3NlcnRFcXVhbHMoIldyb25nIHF1YWxpZmllZCBuYW1lIiwgInRlc3Q0MDQ0ODku
YnVnLkIiLCBiaW5kaW5nLmdldFF1YWxpZmllZE5hbWUoKSk7CisJCWFzc2VydFRydWUocXVhbGlm
aWVkVHlwZS5nZXRRdWFsaWZpZXIoKS5pc1NpbXBsZVR5cGUoKSk7CisJCVNpbXBsZVR5cGUgc2lt
cGxlVHlwZSA9IChTaW1wbGVUeXBlKSBxdWFsaWZpZWRUeXBlLmdldFF1YWxpZmllcigpOworCQlh
c3NlcnRFcXVhbHMoImluY29ycmVjdCB0eXBlIiwgIkBBIFgiLCBzaW1wbGVUeXBlLnRvU3RyaW5n
KCkpOworCQliaW5kaW5nID0gc2ltcGxlVHlwZS5yZXNvbHZlQmluZGluZygpOworCQlhc3NlcnRO
b3ROdWxsKCJObyBiaW5kaW5nIiwgYmluZGluZyk7CisJCWFzc2VydEVxdWFscygiV3JvbmcgcXVh
bGlmaWVkIG5hbWUiLCAidGVzdDQwNDQ4OS5idWcuWC5ZIiwgYmluZGluZy5nZXRRdWFsaWZpZWRO
YW1lKCkpOworCX0KKworCS8vIGh0dHBzOi8vYnVncy5lY2xpcHNlLm9yZy9idWdzL3Nob3dfYnVn
LmNnaT9pZD00MDQ0ODkKKwlwdWJsaWMgdm9pZCB0ZXN0QnVnNDA0NDg5YigpIHRocm93cyBKYXZh
TW9kZWxFeGNlcHRpb24geworCQlJQ29tcGlsYXRpb25Vbml0IHNvdXJjZVVuaXQgPSBnZXRDb21w
aWxhdGlvblVuaXQoIkNvbnZlcnRlcjE4IiAsICJzcmMiLCAidGVzdDQwNDQ4OS5idWciLCAiWC5q
YXZhIik7IC8vJE5PTi1OTFMtMSQgLy8kTk9OLU5MUy0yJCAvLyROT04tTkxTLTMkIC8vJE5PTi1O
TFMtNCQKKwkJQVNUTm9kZSByZXN1bHQgPSBydW5Db252ZXJzaW9uKHRoaXMuYXN0LmFwaUxldmVs
KCksIHNvdXJjZVVuaXQsIHRydWUpOworCQljaGFyW10gc291cmNlID0gc291cmNlVW5pdC5nZXRT
b3VyY2UoKS50b0NoYXJBcnJheSgpOworCQlhc3NlcnRUcnVlKCJOb3QgYSBjb21waWxhdGlvbiB1
bml0IiwgcmVzdWx0LmdldE5vZGVUeXBlKCkgPT0gQVNUTm9kZS5DT01QSUxBVElPTl9VTklUKTsK
KwkJQ29tcGlsYXRpb25Vbml0IGNvbXBpbGF0aW9uVW5pdCA9IChDb21waWxhdGlvblVuaXQpIHJl
c3VsdDsKKwkJYXNzZXJ0UHJvYmxlbXNTaXplKGNvbXBpbGF0aW9uVW5pdCwgMCk7CisJCUFTVE5v
ZGUgbm9kZSA9IGdldEFTVE5vZGUoY29tcGlsYXRpb25Vbml0LCAwLCAwLCAwKTsKKwkJVHlwZURl
Y2xhcmF0aW9uIHR5cGVEZWNsYXJhdGlvbiA9ICAoVHlwZURlY2xhcmF0aW9uKSBjb21waWxhdGlv
blVuaXQudHlwZXMoKS5nZXQoMCk7CisKKwkJbm9kZSA9IChBU1ROb2RlKSB0eXBlRGVjbGFyYXRp
b24uYm9keURlY2xhcmF0aW9ucygpLmdldCgyKTsKKwkJYXNzZXJ0RXF1YWxzKCJOb3QgYSBtZXRo
b2QgZGVjbGFyYXRpb24iLCBBU1ROb2RlLk1FVEhPRF9ERUNMQVJBVElPTiwgbm9kZS5nZXROb2Rl
VHlwZSgpKTsJCQorCQlNZXRob2REZWNsYXJhdGlvbiBtZXRob2REZWNsID0gKE1ldGhvZERlY2xh
cmF0aW9uKSBub2RlOworCQlUeXBlIHR5cGUgPSBtZXRob2REZWNsLmdldFJldHVyblR5cGUyKCk7
CisJCWFzc2VydFRydWUodHlwZS5pc1BhY2thZ2VRdWFsaWZpZWRUeXBlKCkpOworCQlQYWNrYWdl
UXVhbGlmaWVkVHlwZSBwYWNrYWdlUXVhbGlmaWVkVHlwZSA9IChQYWNrYWdlUXVhbGlmaWVkVHlw
ZSkgdHlwZTsKKwkJY2hlY2tTb3VyY2VSYW5nZShwYWNrYWdlUXVhbGlmaWVkVHlwZSwgInRlc3Q0
MDQ0ODkuYnVnLkBOb25OdWxsIElPRXhjZXB0aW9uIiwgc291cmNlKTsKKwkJSVR5cGVCaW5kaW5n
IHR5cGVCaW5kaW5nID0gcGFja2FnZVF1YWxpZmllZFR5cGUucmVzb2x2ZUJpbmRpbmcoKTsKKwkJ
YXNzZXJ0Tm90TnVsbCgibnVsbCBiaW5kaW5nIiwgdHlwZUJpbmRpbmcpOworCQlhc3NlcnRFcXVh
bHMoIm5vdCBhIHZhbGlkIGJpbmRpbmciLCAidGVzdDQwNDQ4OS5idWcuSU9FeGNlcHRpb24iLCB0
eXBlQmluZGluZy5nZXRRdWFsaWZpZWROYW1lKCkpOworCQkKKwkJLy8gcXVhbGlmaWVyIG9mIHRo
ZSBwYWNrYWdlIHF1YWxpZmllZCB0eXBlCisJCU5hbWUgbmFtZSA9IHBhY2thZ2VRdWFsaWZpZWRU
eXBlLmdldFF1YWxpZmllcigpOworCQlhc3NlcnRUcnVlKG5hbWUuaXNRdWFsaWZpZWROYW1lKCkp
OworCQlRdWFsaWZpZWROYW1lIHF1YWxpZmllZE5hbWUgPSAoUXVhbGlmaWVkTmFtZSkgbmFtZTsK
KwkJY2hlY2tTb3VyY2VSYW5nZShxdWFsaWZpZWROYW1lLCAidGVzdDQwNDQ4OS5idWciLCBzb3Vy
Y2UpOworCQl0eXBlQmluZGluZyA9IHF1YWxpZmllZE5hbWUucmVzb2x2ZVR5cGVCaW5kaW5nKCk7
CisJCWFzc2VydE51bGwodHlwZUJpbmRpbmcpOworCQlJQmluZGluZyBiaW5kaW5nID0gcXVhbGlm
aWVkTmFtZS5yZXNvbHZlQmluZGluZygpOworCQlhc3NlcnRUcnVlKCJub3QgYSBwYWNrYWdlIGJp
bmRpbmciLCBiaW5kaW5nLmdldEtpbmQoKSA9PSBJQmluZGluZy5QQUNLQUdFKTsKKwkJYXNzZXJ0
RXF1YWxzKCJ3cm9uZyBwYWNrYWdlIGJpbmRpbmciLCAicGFja2FnZSB0ZXN0NDA0NDg5LmJ1ZyIs
IGJpbmRpbmcudG9TdHJpbmcoKSk7CisJCW5hbWUgPSBxdWFsaWZpZWROYW1lLmdldFF1YWxpZmll
cigpOworCQlhc3NlcnRUcnVlKCJ3cm9uZyBuYW1lIHR5cGUiLCBuYW1lLmlzU2ltcGxlTmFtZSgp
KTsKKwkJU2ltcGxlTmFtZSBzaW1wbGVOYW1lID0gKFNpbXBsZU5hbWUpIG5hbWU7CisJCWNoZWNr
U291cmNlUmFuZ2Uoc2ltcGxlTmFtZSwgInRlc3Q0MDQ0ODkiLCBzb3VyY2UpOworCQl0eXBlQmlu
ZGluZyA9IHNpbXBsZU5hbWUucmVzb2x2ZVR5cGVCaW5kaW5nKCk7CisJCWFzc2VydE51bGwodHlw
ZUJpbmRpbmcpOworCQliaW5kaW5nID0gc2ltcGxlTmFtZS5yZXNvbHZlQmluZGluZygpOworCQlh
c3NlcnRUcnVlKCJub3QgYSBwYWNrYWdlIGJpbmRpbmciLCBiaW5kaW5nLmdldEtpbmQoKSA9PSBJ
QmluZGluZy5QQUNLQUdFKTsKKwkJYXNzZXJ0RXF1YWxzKCJ3cm9uZyBwYWNrYWdlIGJpbmRpbmci
LCAicGFja2FnZSB0ZXN0NDA0NDg5IiwgYmluZGluZy50b1N0cmluZygpKTsKKwkJc2ltcGxlTmFt
ZSA9IHF1YWxpZmllZE5hbWUuZ2V0TmFtZSgpOworCQljaGVja1NvdXJjZVJhbmdlKHNpbXBsZU5h
bWUsICJidWciLCBzb3VyY2UpOworCQl0eXBlQmluZGluZyA9IHNpbXBsZU5hbWUucmVzb2x2ZVR5
cGVCaW5kaW5nKCk7CisJCWFzc2VydE51bGwodHlwZUJpbmRpbmcpOworCQliaW5kaW5nID0gc2lt
cGxlTmFtZS5yZXNvbHZlQmluZGluZygpOworCQlhc3NlcnRUcnVlKCJub3QgYSBwYWNrYWdlIGJp
bmRpbmciLCBiaW5kaW5nLmdldEtpbmQoKSA9PSBJQmluZGluZy5QQUNLQUdFKTsKKwkJYXNzZXJ0
RXF1YWxzKCJ3cm9uZyBwYWNrYWdlIGJpbmRpbmciLCAicGFja2FnZSB0ZXN0NDA0NDg5LmJ1ZyIs
IGJpbmRpbmcudG9TdHJpbmcoKSk7CisJCQorCQkvLyBhbm5vdGF0aW9ucyBvZiBwYWNrYWdlIHF1
YWxpZmllZCB0eXBlCisJCUxpc3QgYW5ub3RhdGlvbnMgPSBwYWNrYWdlUXVhbGlmaWVkVHlwZS5h
bm5vdGF0aW9ucygpOworCQlhc3NlcnRUcnVlKGFubm90YXRpb25zLnNpemUoKSA9PSAxKTsKKwkJ
QW5ub3RhdGlvbiBhbm5vdGF0aW9uID0gKEFubm90YXRpb24pIGFubm90YXRpb25zLmdldCgwKTsK
KwkJdHlwZUJpbmRpbmcgPSBhbm5vdGF0aW9uLnJlc29sdmVUeXBlQmluZGluZygpOworCQlhc3Nl
cnROb3ROdWxsKCJudWxsIGJpbmRpbmciLCB0eXBlQmluZGluZyk7CisJCWFzc2VydEVxdWFscygi
bm90IGEgdmFsaWQgYmluZGluZyIsICJ0ZXN0NDA0NDg5LmJ1Zy5YLk5vbk51bGwiLCB0eXBlQmlu
ZGluZy5nZXRRdWFsaWZpZWROYW1lKCkpOworCQlJQW5ub3RhdGlvbkJpbmRpbmcgYW5ub3RhdGlv
bkJpbmRpbmcgPSBhbm5vdGF0aW9uLnJlc29sdmVBbm5vdGF0aW9uQmluZGluZygpOworCQlhc3Nl
cnRFcXVhbHMoIm5vdCBhIHZhbGlkIGFubm90YXRpb24gYmluZGluZyIsICJATm9uTnVsbCgpIiwg
YW5ub3RhdGlvbkJpbmRpbmcudG9TdHJpbmcoKSk7CisJCW5hbWUgPSBhbm5vdGF0aW9uLmdldFR5
cGVOYW1lKCk7CisJCWFzc2VydFRydWUobmFtZS5pc1NpbXBsZU5hbWUoKSk7CisJCXNpbXBsZU5h
bWUgPSAoU2ltcGxlTmFtZSkgbmFtZTsKKwkJdHlwZUJpbmRpbmcgPSBzaW1wbGVOYW1lLnJlc29s
dmVUeXBlQmluZGluZygpOworCQljaGVja1NvdXJjZVJhbmdlKHNpbXBsZU5hbWUsICJOb25OdWxs
Iiwgc291cmNlKTsKKwkJYXNzZXJ0Tm90TnVsbCh0eXBlQmluZGluZyk7CisJCQorCQkvLyBuYW1l
IG9mIHRoZSBwYWNrYWdlIHF1YWxpZmllZCB0eXBlCisJCXNpbXBsZU5hbWUgPSBwYWNrYWdlUXVh
bGlmaWVkVHlwZS5nZXROYW1lKCk7CisJCWNoZWNrU291cmNlUmFuZ2Uoc2ltcGxlTmFtZSwgIklP
RXhjZXB0aW9uIiwgc291cmNlKTsKKwkJdHlwZUJpbmRpbmcgPSBzaW1wbGVOYW1lLnJlc29sdmVU
eXBlQmluZGluZygpOworCQlhc3NlcnROb3ROdWxsKHR5cGVCaW5kaW5nKTsKKwkJCisJCS8vIHBh
cmFtZXRlcgorCQlTaW5nbGVWYXJpYWJsZURlY2xhcmF0aW9uIHBhcmFtID0gKFNpbmdsZVZhcmlh
YmxlRGVjbGFyYXRpb24pIG1ldGhvZERlY2wucGFyYW1ldGVycygpLmdldCgwKTsKKwkJdHlwZSA9
IHBhcmFtLmdldFR5cGUoKTsKKwkJYXNzZXJ0VHJ1ZSh0eXBlLmlzUGFja2FnZVF1YWxpZmllZFR5
cGUoKSk7CisJCXBhY2thZ2VRdWFsaWZpZWRUeXBlID0gKFBhY2thZ2VRdWFsaWZpZWRUeXBlKSB0
eXBlOworCQljaGVja1NvdXJjZVJhbmdlKHBhY2thZ2VRdWFsaWZpZWRUeXBlLCAidGVzdDQwNDQ4
OS5idWcuQE5vbk51bGwgRmlsZU5vdEZvdW5kRXhjZXB0aW9uIiwgc291cmNlKTsKKwkJdHlwZUJp
bmRpbmcgPSBwYWNrYWdlUXVhbGlmaWVkVHlwZS5yZXNvbHZlQmluZGluZygpOworCQlhc3NlcnRO
b3ROdWxsKCJudWxsIGJpbmRpbmciLCB0eXBlQmluZGluZyk7CisJCWFzc2VydEVxdWFscygibm90
IGEgdmFsaWQgYmluZGluZyIsICJ0ZXN0NDA0NDg5LmJ1Zy5GaWxlTm90Rm91bmRFeGNlcHRpb24i
LCB0eXBlQmluZGluZy5nZXRRdWFsaWZpZWROYW1lKCkpOworCQkKKwkJLy8gcXVhbGlmaWVyIG9m
IHRoZSBwYWNrYWdlIHF1YWxpZmllZCB0eXBlCisJCW5hbWUgPSBwYWNrYWdlUXVhbGlmaWVkVHlw
ZS5nZXRRdWFsaWZpZXIoKTsKKwkJYXNzZXJ0VHJ1ZShuYW1lLmlzUXVhbGlmaWVkTmFtZSgpKTsK
KwkJcXVhbGlmaWVkTmFtZSA9IChRdWFsaWZpZWROYW1lKSBuYW1lOworCQljaGVja1NvdXJjZVJh
bmdlKHF1YWxpZmllZE5hbWUsICJ0ZXN0NDA0NDg5LmJ1ZyIsIHNvdXJjZSk7CisJCXR5cGVCaW5k
aW5nID0gcXVhbGlmaWVkTmFtZS5yZXNvbHZlVHlwZUJpbmRpbmcoKTsKKwkJYXNzZXJ0TnVsbCh0
eXBlQmluZGluZyk7CisJCWJpbmRpbmcgPSBxdWFsaWZpZWROYW1lLnJlc29sdmVCaW5kaW5nKCk7
CisJCWFzc2VydFRydWUoIm5vdCBhIHBhY2thZ2UgYmluZGluZyIsIGJpbmRpbmcuZ2V0S2luZCgp
ID09IElCaW5kaW5nLlBBQ0tBR0UpOworCQlhc3NlcnRFcXVhbHMoIndyb25nIHBhY2thZ2UgYmlu
ZGluZyIsICJwYWNrYWdlIHRlc3Q0MDQ0ODkuYnVnIiwgYmluZGluZy50b1N0cmluZygpKTsKKwkJ
bmFtZSA9IHF1YWxpZmllZE5hbWUuZ2V0UXVhbGlmaWVyKCk7CisJCWFzc2VydFRydWUoIndyb25n
IG5hbWUgdHlwZSIsIG5hbWUuaXNTaW1wbGVOYW1lKCkpOworCQlzaW1wbGVOYW1lID0gKFNpbXBs
ZU5hbWUpIG5hbWU7CisJCWNoZWNrU291cmNlUmFuZ2Uoc2ltcGxlTmFtZSwgInRlc3Q0MDQ0ODki
LCBzb3VyY2UpOworCQl0eXBlQmluZGluZyA9IHNpbXBsZU5hbWUucmVzb2x2ZVR5cGVCaW5kaW5n
KCk7CisJCWFzc2VydE51bGwodHlwZUJpbmRpbmcpOworCQliaW5kaW5nID0gc2ltcGxlTmFtZS5y
ZXNvbHZlQmluZGluZygpOworCQlhc3NlcnRUcnVlKCJub3QgYSBwYWNrYWdlIGJpbmRpbmciLCBi
aW5kaW5nLmdldEtpbmQoKSA9PSBJQmluZGluZy5QQUNLQUdFKTsKKwkJYXNzZXJ0RXF1YWxzKCJ3
cm9uZyBwYWNrYWdlIGJpbmRpbmciLCAicGFja2FnZSB0ZXN0NDA0NDg5IiwgYmluZGluZy50b1N0
cmluZygpKTsKKwkJc2ltcGxlTmFtZSA9IHF1YWxpZmllZE5hbWUuZ2V0TmFtZSgpOworCQljaGVj
a1NvdXJjZVJhbmdlKHNpbXBsZU5hbWUsICJidWciLCBzb3VyY2UpOworCQl0eXBlQmluZGluZyA9
IHNpbXBsZU5hbWUucmVzb2x2ZVR5cGVCaW5kaW5nKCk7CisJCWFzc2VydE51bGwodHlwZUJpbmRp
bmcpOworCQliaW5kaW5nID0gc2ltcGxlTmFtZS5yZXNvbHZlQmluZGluZygpOworCQlhc3NlcnRU
cnVlKCJub3QgYSBwYWNrYWdlIGJpbmRpbmciLCBiaW5kaW5nLmdldEtpbmQoKSA9PSBJQmluZGlu
Zy5QQUNLQUdFKTsKKwkJYXNzZXJ0RXF1YWxzKCJ3cm9uZyBwYWNrYWdlIGJpbmRpbmciLCAicGFj
a2FnZSB0ZXN0NDA0NDg5LmJ1ZyIsIGJpbmRpbmcudG9TdHJpbmcoKSk7CisJCQorCQkvLyBhbm5v
dGF0aW9ucyBvZiBwYWNrYWdlIHF1YWxpZmllZCB0eXBlCisJCWFubm90YXRpb25zID0gcGFja2Fn
ZVF1YWxpZmllZFR5cGUuYW5ub3RhdGlvbnMoKTsKKwkJYXNzZXJ0VHJ1ZShhbm5vdGF0aW9ucy5z
aXplKCkgPT0gMSk7CisJCWFubm90YXRpb24gPSAoQW5ub3RhdGlvbikgYW5ub3RhdGlvbnMuZ2V0
KDApOworCQl0eXBlQmluZGluZyA9IGFubm90YXRpb24ucmVzb2x2ZVR5cGVCaW5kaW5nKCk7CisJ
CWFzc2VydE5vdE51bGwoIm51bGwgYmluZGluZyIsIHR5cGVCaW5kaW5nKTsKKwkJYXNzZXJ0RXF1
YWxzKCJub3QgYSB2YWxpZCBiaW5kaW5nIiwgInRlc3Q0MDQ0ODkuYnVnLlguTm9uTnVsbCIsIHR5
cGVCaW5kaW5nLmdldFF1YWxpZmllZE5hbWUoKSk7CisJCWFubm90YXRpb25CaW5kaW5nID0gYW5u
b3RhdGlvbi5yZXNvbHZlQW5ub3RhdGlvbkJpbmRpbmcoKTsKKwkJYXNzZXJ0RXF1YWxzKCJub3Qg
YSB2YWxpZCBhbm5vdGF0aW9uIGJpbmRpbmciLCAiQE5vbk51bGwoKSIsIGFubm90YXRpb25CaW5k
aW5nLnRvU3RyaW5nKCkpOworCQluYW1lID0gYW5ub3RhdGlvbi5nZXRUeXBlTmFtZSgpOworCQlh
c3NlcnRUcnVlKG5hbWUuaXNTaW1wbGVOYW1lKCkpOworCQlzaW1wbGVOYW1lID0gKFNpbXBsZU5h
bWUpIG5hbWU7CisJCXR5cGVCaW5kaW5nID0gc2ltcGxlTmFtZS5yZXNvbHZlVHlwZUJpbmRpbmco
KTsKKwkJY2hlY2tTb3VyY2VSYW5nZShzaW1wbGVOYW1lLCAiTm9uTnVsbCIsIHNvdXJjZSk7CisJ
CWFzc2VydE5vdE51bGwodHlwZUJpbmRpbmcpOworCQkKKwkJLy8gbmFtZSBvZiB0aGUgcGFja2Fn
ZSBxdWFsaWZpZWQgdHlwZQorCQlzaW1wbGVOYW1lID0gcGFja2FnZVF1YWxpZmllZFR5cGUuZ2V0
TmFtZSgpOworCQljaGVja1NvdXJjZVJhbmdlKHNpbXBsZU5hbWUsICJGaWxlTm90Rm91bmRFeGNl
cHRpb24iLCBzb3VyY2UpOworCQl0eXBlQmluZGluZyA9IHNpbXBsZU5hbWUucmVzb2x2ZVR5cGVC
aW5kaW5nKCk7CisJCWFzc2VydE5vdE51bGwodHlwZUJpbmRpbmcpOworCQkKKwkJLy8gdGhyb3dz
CisJCXR5cGUgPSAoVHlwZSkgbWV0aG9kRGVjbC50aHJvd25FeGNlcHRpb25UeXBlcygpLmdldCgw
KTsKKwkJYXNzZXJ0VHJ1ZSh0eXBlLmlzUGFja2FnZVF1YWxpZmllZFR5cGUoKSk7CisJCXBhY2th
Z2VRdWFsaWZpZWRUeXBlID0gKFBhY2thZ2VRdWFsaWZpZWRUeXBlKSB0eXBlOworCQljaGVja1Nv
dXJjZVJhbmdlKHBhY2thZ2VRdWFsaWZpZWRUeXBlLCAidGVzdDQwNDQ4OS5idWcuQE5vbk51bGwg
RU9GRXhjZXB0aW9uIiwgc291cmNlKTsKKwkJdHlwZUJpbmRpbmcgPSBwYWNrYWdlUXVhbGlmaWVk
VHlwZS5yZXNvbHZlQmluZGluZygpOworCQlhc3NlcnROb3ROdWxsKCJudWxsIGJpbmRpbmciLCB0
eXBlQmluZGluZyk7CisJCWFzc2VydEVxdWFscygibm90IGEgdmFsaWQgYmluZGluZyIsICJ0ZXN0
NDA0NDg5LmJ1Zy5FT0ZFeGNlcHRpb24iLCB0eXBlQmluZGluZy5nZXRRdWFsaWZpZWROYW1lKCkp
OworCQkKKwkJLy8gcXVhbGlmaWVyIG9mIHRoZSBwYWNrYWdlIHF1YWxpZmllZCB0eXBlCisJCW5h
bWUgPSBwYWNrYWdlUXVhbGlmaWVkVHlwZS5nZXRRdWFsaWZpZXIoKTsKKwkJYXNzZXJ0VHJ1ZShu
YW1lLmlzUXVhbGlmaWVkTmFtZSgpKTsKKwkJcXVhbGlmaWVkTmFtZSA9IChRdWFsaWZpZWROYW1l
KSBuYW1lOworCQljaGVja1NvdXJjZVJhbmdlKHF1YWxpZmllZE5hbWUsICJ0ZXN0NDA0NDg5LmJ1
ZyIsIHNvdXJjZSk7CisJCXR5cGVCaW5kaW5nID0gcXVhbGlmaWVkTmFtZS5yZXNvbHZlVHlwZUJp
bmRpbmcoKTsKKwkJYXNzZXJ0TnVsbCh0eXBlQmluZGluZyk7CisJCWJpbmRpbmcgPSBxdWFsaWZp
ZWROYW1lLnJlc29sdmVCaW5kaW5nKCk7CisJCWFzc2VydFRydWUoIm5vdCBhIHBhY2thZ2UgYmlu
ZGluZyIsIGJpbmRpbmcuZ2V0S2luZCgpID09IElCaW5kaW5nLlBBQ0tBR0UpOworCQlhc3NlcnRF
cXVhbHMoIndyb25nIHBhY2thZ2UgYmluZGluZyIsICJwYWNrYWdlIHRlc3Q0MDQ0ODkuYnVnIiwg
YmluZGluZy50b1N0cmluZygpKTsKKwkJbmFtZSA9IHF1YWxpZmllZE5hbWUuZ2V0UXVhbGlmaWVy
KCk7CisJCWFzc2VydFRydWUoIndyb25nIG5hbWUgdHlwZSIsIG5hbWUuaXNTaW1wbGVOYW1lKCkp
OworCQlzaW1wbGVOYW1lID0gKFNpbXBsZU5hbWUpIG5hbWU7CisJCWNoZWNrU291cmNlUmFuZ2Uo
c2ltcGxlTmFtZSwgInRlc3Q0MDQ0ODkiLCBzb3VyY2UpOworCQl0eXBlQmluZGluZyA9IHNpbXBs
ZU5hbWUucmVzb2x2ZVR5cGVCaW5kaW5nKCk7CisJCWFzc2VydE51bGwodHlwZUJpbmRpbmcpOwor
CQliaW5kaW5nID0gc2ltcGxlTmFtZS5yZXNvbHZlQmluZGluZygpOworCQlhc3NlcnRUcnVlKCJu
b3QgYSBwYWNrYWdlIGJpbmRpbmciLCBiaW5kaW5nLmdldEtpbmQoKSA9PSBJQmluZGluZy5QQUNL
QUdFKTsKKwkJYXNzZXJ0RXF1YWxzKCJ3cm9uZyBwYWNrYWdlIGJpbmRpbmciLCAicGFja2FnZSB0
ZXN0NDA0NDg5IiwgYmluZGluZy50b1N0cmluZygpKTsKKwkJc2ltcGxlTmFtZSA9IHF1YWxpZmll
ZE5hbWUuZ2V0TmFtZSgpOworCQljaGVja1NvdXJjZVJhbmdlKHNpbXBsZU5hbWUsICJidWciLCBz
b3VyY2UpOworCQl0eXBlQmluZGluZyA9IHNpbXBsZU5hbWUucmVzb2x2ZVR5cGVCaW5kaW5nKCk7
CisJCWFzc2VydE51bGwodHlwZUJpbmRpbmcpOworCQliaW5kaW5nID0gc2ltcGxlTmFtZS5yZXNv
bHZlQmluZGluZygpOworCQlhc3NlcnRUcnVlKCJub3QgYSBwYWNrYWdlIGJpbmRpbmciLCBiaW5k
aW5nLmdldEtpbmQoKSA9PSBJQmluZGluZy5QQUNLQUdFKTsKKwkJYXNzZXJ0RXF1YWxzKCJ3cm9u
ZyBwYWNrYWdlIGJpbmRpbmciLCAicGFja2FnZSB0ZXN0NDA0NDg5LmJ1ZyIsIGJpbmRpbmcudG9T
dHJpbmcoKSk7CisJCQorCQkvLyBhbm5vdGF0aW9ucyBvZiBwYWNrYWdlIHF1YWxpZmllZCB0eXBl
CisJCWFubm90YXRpb25zID0gcGFja2FnZVF1YWxpZmllZFR5cGUuYW5ub3RhdGlvbnMoKTsKKwkJ
YXNzZXJ0VHJ1ZShhbm5vdGF0aW9ucy5zaXplKCkgPT0gMSk7CisJCWFubm90YXRpb24gPSAoQW5u
b3RhdGlvbikgYW5ub3RhdGlvbnMuZ2V0KDApOworCQl0eXBlQmluZGluZyA9IGFubm90YXRpb24u
cmVzb2x2ZVR5cGVCaW5kaW5nKCk7CisJCWFzc2VydE5vdE51bGwoIm51bGwgYmluZGluZyIsIHR5
cGVCaW5kaW5nKTsKKwkJYXNzZXJ0RXF1YWxzKCJub3QgYSB2YWxpZCBiaW5kaW5nIiwgInRlc3Q0
MDQ0ODkuYnVnLlguTm9uTnVsbCIsIHR5cGVCaW5kaW5nLmdldFF1YWxpZmllZE5hbWUoKSk7CisJ
CWFubm90YXRpb25CaW5kaW5nID0gYW5ub3RhdGlvbi5yZXNvbHZlQW5ub3RhdGlvbkJpbmRpbmco
KTsKKwkJYXNzZXJ0RXF1YWxzKCJub3QgYSB2YWxpZCBhbm5vdGF0aW9uIGJpbmRpbmciLCAiQE5v
bk51bGwoKSIsIGFubm90YXRpb25CaW5kaW5nLnRvU3RyaW5nKCkpOworCQluYW1lID0gYW5ub3Rh
dGlvbi5nZXRUeXBlTmFtZSgpOworCQlhc3NlcnRUcnVlKG5hbWUuaXNTaW1wbGVOYW1lKCkpOwor
CQlzaW1wbGVOYW1lID0gKFNpbXBsZU5hbWUpIG5hbWU7CisJCXR5cGVCaW5kaW5nID0gc2ltcGxl
TmFtZS5yZXNvbHZlVHlwZUJpbmRpbmcoKTsKKwkJY2hlY2tTb3VyY2VSYW5nZShzaW1wbGVOYW1l
LCAiTm9uTnVsbCIsIHNvdXJjZSk7CisJCWFzc2VydE5vdE51bGwodHlwZUJpbmRpbmcpOworCQkK
KwkJLy8gbmFtZSBvZiB0aGUgcGFja2FnZSBxdWFsaWZpZWQgdHlwZQorCQlzaW1wbGVOYW1lID0g
cGFja2FnZVF1YWxpZmllZFR5cGUuZ2V0TmFtZSgpOworCQljaGVja1NvdXJjZVJhbmdlKHNpbXBs
ZU5hbWUsICJFT0ZFeGNlcHRpb24iLCBzb3VyY2UpOworCQl0eXBlQmluZGluZyA9IHNpbXBsZU5h
bWUucmVzb2x2ZVR5cGVCaW5kaW5nKCk7CisJCWFzc2VydE5vdE51bGwodHlwZUJpbmRpbmcpOwor
CisJCW5vZGUgPSAoQVNUTm9kZSkgdHlwZURlY2xhcmF0aW9uLmJvZHlEZWNsYXJhdGlvbnMoKS5n
ZXQoMyk7CisJCWFzc2VydEVxdWFscygiTm90IGEgZmllbGQgZGVjbGFyYXRpb24iLCBBU1ROb2Rl
LkZJRUxEX0RFQ0xBUkFUSU9OLCBub2RlLmdldE5vZGVUeXBlKCkpOwkJCisJCUZpZWxkRGVjbGFy
YXRpb24gZmllbGQgPSAoRmllbGREZWNsYXJhdGlvbikgbm9kZTsKKwkJdHlwZSA9IGZpZWxkLmdl
dFR5cGUoKTsKKwkJYXNzZXJ0VHJ1ZSh0eXBlLmlzUXVhbGlmaWVkVHlwZSgpKTsKKwkJUXVhbGlm
aWVkVHlwZSBxdWFsaWZpZWRUeXBlID0gKFF1YWxpZmllZFR5cGUpIHR5cGU7CisJCXBhY2thZ2VR
dWFsaWZpZWRUeXBlID0gKFBhY2thZ2VRdWFsaWZpZWRUeXBlKXF1YWxpZmllZFR5cGUuZ2V0UXVh
bGlmaWVyKCk7CisJCWNoZWNrU291cmNlUmFuZ2UocGFja2FnZVF1YWxpZmllZFR5cGUsICJ0ZXN0
NDA0NDg5LmJ1Zy5ATm9uTnVsbCBYIiwgc291cmNlKTsKKwkJdHlwZUJpbmRpbmcgPSBwYWNrYWdl
UXVhbGlmaWVkVHlwZS5yZXNvbHZlQmluZGluZygpOworCQlhc3NlcnROb3ROdWxsKCJudWxsIGJp
bmRpbmciLCB0eXBlQmluZGluZyk7CisJCWFzc2VydEVxdWFscygibm90IGEgdmFsaWQgYmluZGlu
ZyIsICJ0ZXN0NDA0NDg5LmJ1Zy5YLklubmVyIiwgdHlwZUJpbmRpbmcuZ2V0UXVhbGlmaWVkTmFt
ZSgpKTsKKwkJCisJCS8vIHF1YWxpZmllciBvZiB0aGUgcGFja2FnZSBxdWFsaWZpZWQgdHlwZQor
CQluYW1lID0gcGFja2FnZVF1YWxpZmllZFR5cGUuZ2V0UXVhbGlmaWVyKCk7CisJCWFzc2VydFRy
dWUobmFtZS5pc1F1YWxpZmllZE5hbWUoKSk7CisJCXF1YWxpZmllZE5hbWUgPSAoUXVhbGlmaWVk
TmFtZSkgbmFtZTsKKwkJY2hlY2tTb3VyY2VSYW5nZShxdWFsaWZpZWROYW1lLCAidGVzdDQwNDQ4
OS5idWciLCBzb3VyY2UpOworCQl0eXBlQmluZGluZyA9IHF1YWxpZmllZE5hbWUucmVzb2x2ZVR5
cGVCaW5kaW5nKCk7CisJCWFzc2VydE51bGwodHlwZUJpbmRpbmcpOworCQliaW5kaW5nID0gcXVh
bGlmaWVkTmFtZS5yZXNvbHZlQmluZGluZygpOworCQlhc3NlcnRUcnVlKCJub3QgYSBwYWNrYWdl
IGJpbmRpbmciLCBiaW5kaW5nLmdldEtpbmQoKSA9PSBJQmluZGluZy5QQUNLQUdFKTsKKwkJYXNz
ZXJ0RXF1YWxzKCJ3cm9uZyBwYWNrYWdlIGJpbmRpbmciLCAicGFja2FnZSB0ZXN0NDA0NDg5LmJ1
ZyIsIGJpbmRpbmcudG9TdHJpbmcoKSk7CisJCW5hbWUgPSBxdWFsaWZpZWROYW1lLmdldFF1YWxp
ZmllcigpOworCQlhc3NlcnRUcnVlKCJ3cm9uZyBuYW1lIHR5cGUiLCBuYW1lLmlzU2ltcGxlTmFt
ZSgpKTsKKwkJc2ltcGxlTmFtZSA9IChTaW1wbGVOYW1lKSBuYW1lOworCQljaGVja1NvdXJjZVJh
bmdlKHNpbXBsZU5hbWUsICJ0ZXN0NDA0NDg5Iiwgc291cmNlKTsKKwkJdHlwZUJpbmRpbmcgPSBz
aW1wbGVOYW1lLnJlc29sdmVUeXBlQmluZGluZygpOworCQlhc3NlcnROdWxsKHR5cGVCaW5kaW5n
KTsKKwkJYmluZGluZyA9IHNpbXBsZU5hbWUucmVzb2x2ZUJpbmRpbmcoKTsKKwkJYXNzZXJ0VHJ1
ZSgibm90IGEgcGFja2FnZSBiaW5kaW5nIiwgYmluZGluZy5nZXRLaW5kKCkgPT0gSUJpbmRpbmcu
UEFDS0FHRSk7CisJCWFzc2VydEVxdWFscygid3JvbmcgcGFja2FnZSBiaW5kaW5nIiwgInBhY2th
Z2UgdGVzdDQwNDQ4OSIsIGJpbmRpbmcudG9TdHJpbmcoKSk7CisJCXNpbXBsZU5hbWUgPSBxdWFs
aWZpZWROYW1lLmdldE5hbWUoKTsKKwkJY2hlY2tTb3VyY2VSYW5nZShzaW1wbGVOYW1lLCAiYnVn
Iiwgc291cmNlKTsKKwkJdHlwZUJpbmRpbmcgPSBzaW1wbGVOYW1lLnJlc29sdmVUeXBlQmluZGlu
ZygpOworCQlhc3NlcnROdWxsKHR5cGVCaW5kaW5nKTsKKwkJYmluZGluZyA9IHNpbXBsZU5hbWUu
cmVzb2x2ZUJpbmRpbmcoKTsKKwkJYXNzZXJ0VHJ1ZSgibm90IGEgcGFja2FnZSBiaW5kaW5nIiwg
YmluZGluZy5nZXRLaW5kKCkgPT0gSUJpbmRpbmcuUEFDS0FHRSk7CisJCWFzc2VydEVxdWFscygi
d3JvbmcgcGFja2FnZSBiaW5kaW5nIiwgInBhY2thZ2UgdGVzdDQwNDQ4OS5idWciLCBiaW5kaW5n
LnRvU3RyaW5nKCkpOworCQkKKwkJLy8gYW5ub3RhdGlvbnMgb2YgcGFja2FnZSBxdWFsaWZpZWQg
dHlwZQorCQlhbm5vdGF0aW9ucyA9IHBhY2thZ2VRdWFsaWZpZWRUeXBlLmFubm90YXRpb25zKCk7
CisJCWFzc2VydFRydWUoYW5ub3RhdGlvbnMuc2l6ZSgpID09IDEpOworCQlhbm5vdGF0aW9uID0g
KEFubm90YXRpb24pIGFubm90YXRpb25zLmdldCgwKTsKKwkJdHlwZUJpbmRpbmcgPSBhbm5vdGF0
aW9uLnJlc29sdmVUeXBlQmluZGluZygpOworCQlhc3NlcnROb3ROdWxsKCJudWxsIGJpbmRpbmci
LCB0eXBlQmluZGluZyk7CisJCWFzc2VydEVxdWFscygibm90IGEgdmFsaWQgYmluZGluZyIsICJ0
ZXN0NDA0NDg5LmJ1Zy5YLk5vbk51bGwiLCB0eXBlQmluZGluZy5nZXRRdWFsaWZpZWROYW1lKCkp
OworCQlhbm5vdGF0aW9uQmluZGluZyA9IGFubm90YXRpb24ucmVzb2x2ZUFubm90YXRpb25CaW5k
aW5nKCk7CisJCWFzc2VydEVxdWFscygibm90IGEgdmFsaWQgYW5ub3RhdGlvbiBiaW5kaW5nIiwg
IkBOb25OdWxsKCkiLCBhbm5vdGF0aW9uQmluZGluZy50b1N0cmluZygpKTsKKwkJbmFtZSA9IGFu
bm90YXRpb24uZ2V0VHlwZU5hbWUoKTsKKwkJYXNzZXJ0VHJ1ZShuYW1lLmlzU2ltcGxlTmFtZSgp
KTsKKwkJc2ltcGxlTmFtZSA9IChTaW1wbGVOYW1lKSBuYW1lOworCQl0eXBlQmluZGluZyA9IHNp
bXBsZU5hbWUucmVzb2x2ZVR5cGVCaW5kaW5nKCk7CisJCWNoZWNrU291cmNlUmFuZ2Uoc2ltcGxl
TmFtZSwgIk5vbk51bGwiLCBzb3VyY2UpOworCQlhc3NlcnROb3ROdWxsKHR5cGVCaW5kaW5nKTsK
KwkJCisJCS8vIG5hbWUgb2YgdGhlIHBhY2thZ2UgcXVhbGlmaWVkIHR5cGUKKwkJc2ltcGxlTmFt
ZSA9IHBhY2thZ2VRdWFsaWZpZWRUeXBlLmdldE5hbWUoKTsKKwkJY2hlY2tTb3VyY2VSYW5nZShz
aW1wbGVOYW1lLCAiWCIsIHNvdXJjZSk7CisJCXR5cGVCaW5kaW5nID0gc2ltcGxlTmFtZS5yZXNv
bHZlVHlwZUJpbmRpbmcoKTsKKwkJYXNzZXJ0Tm90TnVsbCh0eXBlQmluZGluZyk7CisJCQorCX0K
IH0KZGlmZiAtLWdpdCBhL29yZy5lY2xpcHNlLmpkdC5jb3JlLnRlc3RzLm1vZGVsL3NyYy9vcmcv
ZWNsaXBzZS9qZHQvY29yZS90ZXN0cy9kb20vQVNUTWF0Y2hlclRlc3QuamF2YSBiL29yZy5lY2xp
cHNlLmpkdC5jb3JlLnRlc3RzLm1vZGVsL3NyYy9vcmcvZWNsaXBzZS9qZHQvY29yZS90ZXN0cy9k
b20vQVNUTWF0Y2hlclRlc3QuamF2YQppbmRleCBlYjA1OWFhLi42YWNiYmU5IDEwMDY0NAotLS0g
YS9vcmcuZWNsaXBzZS5qZHQuY29yZS50ZXN0cy5tb2RlbC9zcmMvb3JnL2VjbGlwc2UvamR0L2Nv
cmUvdGVzdHMvZG9tL0FTVE1hdGNoZXJUZXN0LmphdmEKKysrIGIvb3JnLmVjbGlwc2UuamR0LmNv
cmUudGVzdHMubW9kZWwvc3JjL29yZy9lY2xpcHNlL2pkdC9jb3JlL3Rlc3RzL2RvbS9BU1RNYXRj
aGVyVGVzdC5qYXZhCkBAIC00NTMsNiArNDUzLDkgQEAKIAkJcHVibGljIGJvb2xlYW4gbWF0Y2go
UGFja2FnZURlY2xhcmF0aW9uIG5vZGUsIE9iamVjdCBvdGhlcikgewogCQkJcmV0dXJuIHN0YW5k
YXJkQm9keShub2RlLCBvdGhlciwgdGhpcy5zdXBlck1hdGNoID8gc3VwZXIubWF0Y2gobm9kZSwg
b3RoZXIpIDogZmFsc2UpOwogCQl9CisJCXB1YmxpYyBib29sZWFuIG1hdGNoKFBhY2thZ2VRdWFs
aWZpZWRUeXBlIG5vZGUsIE9iamVjdCBvdGhlcikgeworCQkJcmV0dXJuIHN0YW5kYXJkQm9keShu
b2RlLCBvdGhlciwgdGhpcy5zdXBlck1hdGNoID8gc3VwZXIubWF0Y2gobm9kZSwgb3RoZXIpIDog
ZmFsc2UpOworCQl9CiAJCXB1YmxpYyBib29sZWFuIG1hdGNoKFBhcmFtZXRlcml6ZWRUeXBlIG5v
ZGUsIE9iamVjdCBvdGhlcikgewogCQkJcmV0dXJuIHN0YW5kYXJkQm9keShub2RlLCBvdGhlciwg
dGhpcy5zdXBlck1hdGNoID8gc3VwZXIubWF0Y2gobm9kZSwgb3RoZXIpIDogZmFsc2UpOwogCQl9
CkBAIC03MDUsNiArNzA4LDE1IEBACiAJfQogCiAJLyoqIEBkZXByZWNhdGVkIHVzaW5nIGRlcHJl
Y2F0ZWQgY29kZSAqLworCXB1YmxpYyB2b2lkIHRlc3RQYWNrYWdlUXVhbGlmaWVkVHlwZSgpIHsK
KwkJaWYgKHRoaXMuYXN0LmFwaUxldmVsKCkgPCBBU1QuSkxTOCkgeworCQkJcmV0dXJuOworCQl9
CisJCVR5cGUgeDEgPSB0aGlzLmFzdC5uZXdQYWNrYWdlUXVhbGlmaWVkVHlwZSh0aGlzLmFzdC5u
ZXdRdWFsaWZpZWROYW1lKHRoaXMuTjIsIHRoaXMuTjMpLCB0aGlzLk4xKTsKKwkJYmFzaWNNYXRj
aCh4MSk7CisJfQorCisJLyoqIEBkZXByZWNhdGVkIHVzaW5nIGRlcHJlY2F0ZWQgY29kZSAqLwog
CXB1YmxpYyB2b2lkIHRlc3RQYXJhbWV0ZXJpemVkVHlwZSgpIHsKIAkJaWYgKHRoaXMuYXN0LmFw
aUxldmVsKCkgPT0gQVNULkpMUzIpIHsKIAkJCXJldHVybjsKZGlmZiAtLWdpdCBhL29yZy5lY2xp
cHNlLmpkdC5jb3JlLnRlc3RzLm1vZGVsL3NyYy9vcmcvZWNsaXBzZS9qZHQvY29yZS90ZXN0cy9k
b20vQVNUU3RydWN0dXJhbFByb3BlcnR5VGVzdC5qYXZhIGIvb3JnLmVjbGlwc2UuamR0LmNvcmUu
dGVzdHMubW9kZWwvc3JjL29yZy9lY2xpcHNlL2pkdC9jb3JlL3Rlc3RzL2RvbS9BU1RTdHJ1Y3R1
cmFsUHJvcGVydHlUZXN0LmphdmEKaW5kZXggZTNjMWNiMS4uNDMzMzY0NyAxMDA2NDQKLS0tIGEv
b3JnLmVjbGlwc2UuamR0LmNvcmUudGVzdHMubW9kZWwvc3JjL29yZy9lY2xpcHNlL2pkdC9jb3Jl
L3Rlc3RzL2RvbS9BU1RTdHJ1Y3R1cmFsUHJvcGVydHlUZXN0LmphdmEKKysrIGIvb3JnLmVjbGlw
c2UuamR0LmNvcmUudGVzdHMubW9kZWwvc3JjL29yZy9lY2xpcHNlL2pkdC9jb3JlL3Rlc3RzL2Rv
bS9BU1RTdHJ1Y3R1cmFsUHJvcGVydHlUZXN0LmphdmEKQEAgLTM1MCw3ICszNTAsNyBAQAogCQkJ
CS8vIG9vcHMgLSBndWVzcyB0aGF0J3Mgbm90IHZhbGlkCiAJCQl9CiAJCX0KLQkJYXNzZXJ0RXF1
YWxzKCJXcm9uZyBsYXN0IGtub3duIHR5cGUiLCA4NiwgaGkpOyAvLyBsYXN0IGtub3duIG9uZQor
CQlhc3NlcnRFcXVhbHMoIldyb25nIGxhc3Qga25vd24gdHlwZSIsIDg3LCBoaSk7IC8vIGxhc3Qg
a25vd24gb25lCiAJCWFzc2VydEVxdWFscygiV3JvbmcgbnVtYmVyIG9mIGRpc3RpbmN0IHR5cGVz
IiwgIGhpLCBjbGFzc2VzLnNpemUoKSk7IC8vIGFsbCBjbGFzc2VzIGFyZSBkaXN0aW5jdAogCX0K
IH0KZGlmZiAtLWdpdCBhL29yZy5lY2xpcHNlLmpkdC5jb3JlLnRlc3RzLm1vZGVsL3NyYy9vcmcv
ZWNsaXBzZS9qZHQvY29yZS90ZXN0cy9kb20vQVNUVmlzaXRvclRlc3QuamF2YSBiL29yZy5lY2xp
cHNlLmpkdC5jb3JlLnRlc3RzLm1vZGVsL3NyYy9vcmcvZWNsaXBzZS9qZHQvY29yZS90ZXN0cy9k
b20vQVNUVmlzaXRvclRlc3QuamF2YQppbmRleCAwMDcyZWQ4Li5mZjBkYjNhIDEwMDY0NAotLS0g
YS9vcmcuZWNsaXBzZS5qZHQuY29yZS50ZXN0cy5tb2RlbC9zcmMvb3JnL2VjbGlwc2UvamR0L2Nv
cmUvdGVzdHMvZG9tL0FTVFZpc2l0b3JUZXN0LmphdmEKKysrIGIvb3JnLmVjbGlwc2UuamR0LmNv
cmUudGVzdHMubW9kZWwvc3JjL29yZy9lY2xpcHNlL2pkdC9jb3JlL3Rlc3RzL2RvbS9BU1RWaXNp
dG9yVGVzdC5qYXZhCkBAIC0zODMsNiArMzgzLDEzIEBACiAJCQlBU1RWaXNpdG9yVGVzdC50aGlz
LmIuYXBwZW5kKG5vZGUuZ2V0UHJpbWl0aXZlVHlwZUNvZGUoKS50b1N0cmluZygpKTsKIAkJCUFT
VFZpc2l0b3JUZXN0LnRoaXMuYi5hcHBlbmQoInRQKSIpOyAvLyROT04tTkxTLTEkCiAJCX0KKwkJ
cHVibGljIGJvb2xlYW4gdmlzaXQoUGFja2FnZVF1YWxpZmllZFR5cGUgbm9kZSkgeworCQkJQVNU
VmlzaXRvclRlc3QudGhpcy5iLmFwcGVuZCgiKHRQUSIpOyAvLyROT04tTkxTLTEkCisJCQlyZXR1
cm4gaXNWaXNpdGluZ0NoaWxkcmVuKCk7CisJCX0KKwkJcHVibGljIHZvaWQgZW5kVmlzaXQoUGFj
a2FnZVF1YWxpZmllZFR5cGUgbm9kZSkgeworCQkJQVNUVmlzaXRvclRlc3QudGhpcy5iLmFwcGVu
ZCgidFBRKSIpOyAvLyROT04tTkxTLTEkCisJCX0KIAkJcHVibGljIGJvb2xlYW4gdmlzaXQoUGFy
YW1ldGVyaXplZFR5cGUgbm9kZSkgewogCQkJQVNUVmlzaXRvclRlc3QudGhpcy5iLmFwcGVuZCgi
KHRNIik7IC8vJE5PTi1OTFMtMSQKIAkJCXJldHVybiBpc1Zpc2l0aW5nQ2hpbGRyZW4oKTsKQEAg
LTExMjIsNiArMTEyOSwyMCBAQAogCX0KIAogCS8qKiBAZGVwcmVjYXRlZCB1c2luZyBkZXByZWNh
dGVkIGNvZGUgKi8KKwlwdWJsaWMgdm9pZCB0ZXN0UGFja2FnZVF1YWxpZmllZFR5cGUoKSB7CisJ
CWlmICh0aGlzLmFzdC5hcGlMZXZlbCgpIDwgQVNULkpMUzgpIHsKKwkJCXJldHVybjsKKwkJfQor
CQlRdWFsaWZpZWROYW1lIHEgPSB0aGlzLmFzdC5uZXdRdWFsaWZpZWROYW1lKHRoaXMuTjIsIHRo
aXMuTjMpOworCQlQYWNrYWdlUXVhbGlmaWVkVHlwZSB4MSA9IHRoaXMuYXN0Lm5ld1BhY2thZ2VR
dWFsaWZpZWRUeXBlKHEsIHRoaXMuTjEpOworCQlUZXN0VmlzaXRvciB2MSA9IG5ldyBUZXN0Vmlz
aXRvcigpOworCQl0aGlzLmIuc2V0TGVuZ3RoKDApOworCQl4MS5hY2NlcHQodjEpOworCQlTdHJp
bmcgcmVzdWx0ID0gdGhpcy5iLnRvU3RyaW5nKCk7CisJCWFzc2VydFRydWUocmVzdWx0LmVxdWFs
cygiWyh0UFEiKyJbKG5RIit0aGlzLk4yUyt0aGlzLk4zUysiblEpXSIrdGhpcy5OMVMrInRQUSld
IikpOyAvLyROT04tTkxTLTEkIC8vJE5PTi1OTFMtMiQKKwl9CisKKwkvKiogQGRlcHJlY2F0ZWQg
dXNpbmcgZGVwcmVjYXRlZCBjb2RlICovCiAJcHVibGljIHZvaWQgdGVzdFBhcmFtZXRlcml6ZWRU
eXBlKCkgewogCQlpZiAodGhpcy5hc3QuYXBpTGV2ZWwoKSA9PSBBU1QuSkxTMikgewogCQkJcmV0
dXJuOwpkaWZmIC0tZ2l0IGEvb3JnLmVjbGlwc2UuamR0LmNvcmUudGVzdHMubW9kZWwvd29ya3Nw
YWNlL0NvbnZlcnRlcjE1L3NyYy90ZXN0NDA0NDg5L2J1Zy9YLmphdmEgYi9vcmcuZWNsaXBzZS5q
ZHQuY29yZS50ZXN0cy5tb2RlbC93b3Jrc3BhY2UvQ29udmVydGVyMTUvc3JjL3Rlc3Q0MDQ0ODkv
YnVnL1guamF2YQpuZXcgZmlsZSBtb2RlIDEwMDY0NAppbmRleCAwMDAwMDAwLi40Y2Y1NDJhCi0t
LSAvZGV2L251bGwKKysrIGIvb3JnLmVjbGlwc2UuamR0LmNvcmUudGVzdHMubW9kZWwvd29ya3Nw
YWNlL0NvbnZlcnRlcjE1L3NyYy90ZXN0NDA0NDg5L2J1Zy9YLmphdmEKQEAgLTAsMCArMSwzNyBA
QAorcGFja2FnZSB0ZXN0NDA0NDg5LmJ1ZzsKK2ltcG9ydCBqYXZhLmxhbmcuYW5ub3RhdGlvbi4q
OworcHVibGljIGNsYXNzIFggeworCUBUYXJnZXQoRWxlbWVudFR5cGUuVFlQRV9VU0UpCisJQFJl
dGVudGlvbihSZXRlbnRpb25Qb2xpY3kuUlVOVElNRSkKKwlARG9jdW1lbnRlZAorCXN0YXRpYyBA
aW50ZXJmYWNlIE5vbk51bGwgeyB9CisJY2xhc3MgSW5uZXIge30KKwkKKwkvKioKKyAJKiBAcGFy
YW0gYXJnICAKKyAJKi8KKwl0ZXN0NDA0NDg5LmJ1Zy5ATm9uTnVsbCBJT0V4Y2VwdGlvbiBmb28o
CisJCQl0ZXN0NDA0NDg5LmJ1Zy5ATm9uTnVsbCBGaWxlTm90Rm91bmRFeGNlcHRpb24gYXJnKQor
CQl0aHJvd3MgdGVzdDQwNDQ4OS5idWcuQE5vbk51bGwgRU9GRXhjZXB0aW9uIHsKKwkJdHJ5IHsK
KwkJCXRlc3Q0MDQ0ODkuYnVnLkBOb25OdWxsIElPRXJyb3IgZSA9IG5ldyB0ZXN0NDA0NDg5LmJ1
Zy5JT0Vycm9yKCk7CisJCQl0aHJvdyBlOworCQl9IGNhdGNoICh0ZXN0NDA0NDg5LmJ1Zy5ATm9u
TnVsbCBJT0Vycm9yIGUpIHsKKwkJfQorCQlyZXR1cm4gbnVsbDsKKwl9IAorCXRlc3Q0MDQ0ODku
YnVnLkBOb25OdWxsIFguQE5vbk51bGwgSW5uZXIgZklubmVyOworfSAKK0BqYXZhLmxhbmcuYW5u
b3RhdGlvbi5UYXJnZXQoamF2YS5sYW5nLmFubm90YXRpb24uRWxlbWVudFR5cGUuVFlQRV9VU0Up
IEBpbnRlcmZhY2UgTWFya2VyIHt9IAorQGphdmEubGFuZy5hbm5vdGF0aW9uLlRhcmdldChqYXZh
LmxhbmcuYW5ub3RhdGlvbi5FbGVtZW50VHlwZS5UWVBFX1VTRSkgQGludGVyZmFjZSBBIHt9IAor
QGphdmEubGFuZy5hbm5vdGF0aW9uLlRhcmdldChqYXZhLmxhbmcuYW5ub3RhdGlvbi5FbGVtZW50
VHlwZS5UWVBFX1VTRSkgQGludGVyZmFjZSBCIHt9IAorCitjbGFzcyBPdXRlciB7CisJcHVibGlj
IGNsYXNzIElubmVyIHsKKwkJcHVibGljIGNsYXNzIERlZXBlciB7fQorCX0KK30KK2NsYXNzIElP
RXhjZXB0aW9uIGV4dGVuZHMgRXhjZXB0aW9uIHtwcml2YXRlIHN0YXRpYyBmaW5hbCBsb25nIHNl
cmlhbFZlcnNpb25VSUQ9MTAwMDFMO30KK2NsYXNzIEZpbGVOb3RGb3VuZEV4Y2VwdGlvbiBleHRl
bmRzIEV4Y2VwdGlvbntwcml2YXRlIHN0YXRpYyBmaW5hbCBsb25nIHNlcmlhbFZlcnNpb25VSUQ9
MTAwMDJMO30KK2NsYXNzIEVPRkV4Y2VwdGlvbiBleHRlbmRzIEV4Y2VwdGlvbntwcml2YXRlIHN0
YXRpYyBmaW5hbCBsb25nIHNlcmlhbFZlcnNpb25VSUQ9MTAwMDNMO30KK2NsYXNzIElPRXJyb3Ig
ZXh0ZW5kcyBFeGNlcHRpb257cHJpdmF0ZSBzdGF0aWMgZmluYWwgbG9uZyBzZXJpYWxWZXJzaW9u
VUlEPTEwMDA0TDt9ClwgTm8gbmV3bGluZSBhdCBlbmQgb2YgZmlsZQpkaWZmIC0tZ2l0IGEvb3Jn
LmVjbGlwc2UuamR0LmNvcmUudGVzdHMubW9kZWwvd29ya3NwYWNlL0NvbnZlcnRlcjE4L3NyYy90
ZXN0NDA0NDg5L2J1Zy9YLmphdmEgYi9vcmcuZWNsaXBzZS5qZHQuY29yZS50ZXN0cy5tb2RlbC93
b3Jrc3BhY2UvQ29udmVydGVyMTgvc3JjL3Rlc3Q0MDQ0ODkvYnVnL1guamF2YQpuZXcgZmlsZSBt
b2RlIDEwMDY0NAppbmRleCAwMDAwMDAwLi40Y2Y1NDJhCi0tLSAvZGV2L251bGwKKysrIGIvb3Jn
LmVjbGlwc2UuamR0LmNvcmUudGVzdHMubW9kZWwvd29ya3NwYWNlL0NvbnZlcnRlcjE4L3NyYy90
ZXN0NDA0NDg5L2J1Zy9YLmphdmEKQEAgLTAsMCArMSwzNyBAQAorcGFja2FnZSB0ZXN0NDA0NDg5
LmJ1ZzsKK2ltcG9ydCBqYXZhLmxhbmcuYW5ub3RhdGlvbi4qOworcHVibGljIGNsYXNzIFggewor
CUBUYXJnZXQoRWxlbWVudFR5cGUuVFlQRV9VU0UpCisJQFJldGVudGlvbihSZXRlbnRpb25Qb2xp
Y3kuUlVOVElNRSkKKwlARG9jdW1lbnRlZAorCXN0YXRpYyBAaW50ZXJmYWNlIE5vbk51bGwgeyB9
CisJY2xhc3MgSW5uZXIge30KKwkKKwkvKioKKyAJKiBAcGFyYW0gYXJnICAKKyAJKi8KKwl0ZXN0
NDA0NDg5LmJ1Zy5ATm9uTnVsbCBJT0V4Y2VwdGlvbiBmb28oCisJCQl0ZXN0NDA0NDg5LmJ1Zy5A
Tm9uTnVsbCBGaWxlTm90Rm91bmRFeGNlcHRpb24gYXJnKQorCQl0aHJvd3MgdGVzdDQwNDQ4OS5i
dWcuQE5vbk51bGwgRU9GRXhjZXB0aW9uIHsKKwkJdHJ5IHsKKwkJCXRlc3Q0MDQ0ODkuYnVnLkBO
b25OdWxsIElPRXJyb3IgZSA9IG5ldyB0ZXN0NDA0NDg5LmJ1Zy5JT0Vycm9yKCk7CisJCQl0aHJv
dyBlOworCQl9IGNhdGNoICh0ZXN0NDA0NDg5LmJ1Zy5ATm9uTnVsbCBJT0Vycm9yIGUpIHsKKwkJ
fQorCQlyZXR1cm4gbnVsbDsKKwl9IAorCXRlc3Q0MDQ0ODkuYnVnLkBOb25OdWxsIFguQE5vbk51
bGwgSW5uZXIgZklubmVyOworfSAKK0BqYXZhLmxhbmcuYW5ub3RhdGlvbi5UYXJnZXQoamF2YS5s
YW5nLmFubm90YXRpb24uRWxlbWVudFR5cGUuVFlQRV9VU0UpIEBpbnRlcmZhY2UgTWFya2VyIHt9
IAorQGphdmEubGFuZy5hbm5vdGF0aW9uLlRhcmdldChqYXZhLmxhbmcuYW5ub3RhdGlvbi5FbGVt
ZW50VHlwZS5UWVBFX1VTRSkgQGludGVyZmFjZSBBIHt9IAorQGphdmEubGFuZy5hbm5vdGF0aW9u
LlRhcmdldChqYXZhLmxhbmcuYW5ub3RhdGlvbi5FbGVtZW50VHlwZS5UWVBFX1VTRSkgQGludGVy
ZmFjZSBCIHt9IAorCitjbGFzcyBPdXRlciB7CisJcHVibGljIGNsYXNzIElubmVyIHsKKwkJcHVi
bGljIGNsYXNzIERlZXBlciB7fQorCX0KK30KK2NsYXNzIElPRXhjZXB0aW9uIGV4dGVuZHMgRXhj
ZXB0aW9uIHtwcml2YXRlIHN0YXRpYyBmaW5hbCBsb25nIHNlcmlhbFZlcnNpb25VSUQ9MTAwMDFM
O30KK2NsYXNzIEZpbGVOb3RGb3VuZEV4Y2VwdGlvbiBleHRlbmRzIEV4Y2VwdGlvbntwcml2YXRl
IHN0YXRpYyBmaW5hbCBsb25nIHNlcmlhbFZlcnNpb25VSUQ9MTAwMDJMO30KK2NsYXNzIEVPRkV4
Y2VwdGlvbiBleHRlbmRzIEV4Y2VwdGlvbntwcml2YXRlIHN0YXRpYyBmaW5hbCBsb25nIHNlcmlh
bFZlcnNpb25VSUQ9MTAwMDNMO30KK2NsYXNzIElPRXJyb3IgZXh0ZW5kcyBFeGNlcHRpb257cHJp
dmF0ZSBzdGF0aWMgZmluYWwgbG9uZyBzZXJpYWxWZXJzaW9uVUlEPTEwMDA0TDt9ClwgTm8gbmV3
bGluZSBhdCBlbmQgb2YgZmlsZQpkaWZmIC0tZ2l0IGEvb3JnLmVjbGlwc2UuamR0LmNvcmUvZG9t
L29yZy9lY2xpcHNlL2pkdC9jb3JlL2RvbS9BU1QuamF2YSBiL29yZy5lY2xpcHNlLmpkdC5jb3Jl
L2RvbS9vcmcvZWNsaXBzZS9qZHQvY29yZS9kb20vQVNULmphdmEKaW5kZXggNGQ4ODk2My4uZTM5
Mjk1NiAxMDA2NDQKLS0tIGEvb3JnLmVjbGlwc2UuamR0LmNvcmUvZG9tL29yZy9lY2xpcHNlL2pk
dC9jb3JlL2RvbS9BU1QuamF2YQorKysgYi9vcmcuZWNsaXBzZS5qZHQuY29yZS9kb20vb3JnL2Vj
bGlwc2UvamR0L2NvcmUvZG9tL0FTVC5qYXZhCkBAIC0xOTY2LDYgKzE5NjYsMjkgQEAKIAl9CiAK
IAkvKioKKwkgKiBDcmVhdGVzIGFuZCByZXR1cm5zIGEgbmV3IHVucGFyZW50ZWQgcGFja2FnZSBx
dWFsaWZpZWQgdHlwZSBub2RlIHdpdGgKKwkgKiB0aGUgZ2l2ZW4gcXVhbGlmaWVyIGFuZCBuYW1l
LgorCSAqCisJICogQHBhcmFtIHF1YWxpZmllciB0aGUgcGFja2FnZSBxdWFsaWZpZXIgdHlwZSBu
b2RlCisJICogQHBhcmFtIG5hbWUgdGhlIHNpbXBsZSBuYW1lIGJlaW5nIHF1YWxpZmllZAorCSAq
IEByZXR1cm4gYSBuZXcgdW5wYXJlbnRlZCBxdWFsaWZpZWQgdHlwZSBub2RlCisJICogQGV4Y2Vw
dGlvbiBJbGxlZ2FsQXJndW1lbnRFeGNlcHRpb24gaWY6CisJICogPHVsPgorCSAqIDxsaT50aGUg
bm9kZSBiZWxvbmdzIHRvIGEgZGlmZmVyZW50IEFTVDwvbGk+CisJICogPGxpPnRoZSBub2RlIGFs
cmVhZHkgaGFzIGEgcGFyZW50PC9saT4KKwkgKiA8L3VsPgorCSAqIEBleGNlcHRpb24gVW5zdXBw
b3J0ZWRPcGVyYXRpb25FeGNlcHRpb24gaWYgdGhpcyBvcGVyYXRpb24gaXMgdXNlZCBpbgorCSAq
IGEgSkxTMiwgSkxTMyBhbmQgSkxTNCBBU1QKKwkgKiBAc2luY2UgMy45CisJICovCisJcHVibGlj
IFBhY2thZ2VRdWFsaWZpZWRUeXBlIG5ld1BhY2thZ2VRdWFsaWZpZWRUeXBlKE5hbWUgcXVhbGlm
aWVyLCBTaW1wbGVOYW1lIG5hbWUpIHsKKwkJUGFja2FnZVF1YWxpZmllZFR5cGUgcmVzdWx0ID0g
bmV3IFBhY2thZ2VRdWFsaWZpZWRUeXBlKHRoaXMpOworCQlyZXN1bHQuc2V0UXVhbGlmaWVyKHF1
YWxpZmllcik7CisJCXJlc3VsdC5zZXROYW1lKG5hbWUpOworCQlyZXR1cm4gcmVzdWx0OworCX0K
KworCS8qKgogCSAqIENyZWF0ZXMgYW5kIHJldHVybnMgYSBuZXcgdW5wYXJlbnRlZCBwYXJhbWV0
ZXJpemVkIHR5cGUgbm9kZSB3aXRoIHRoZQogCSAqIGdpdmVuIHR5cGUgYW5kIGFuIGVtcHR5IGxp
c3Qgb2YgdHlwZSBhcmd1bWVudHMuCiAJICoKZGlmZiAtLWdpdCBhL29yZy5lY2xpcHNlLmpkdC5j
b3JlL2RvbS9vcmcvZWNsaXBzZS9qZHQvY29yZS9kb20vQVNUQ29udmVydGVyLmphdmEgYi9vcmcu
ZWNsaXBzZS5qZHQuY29yZS9kb20vb3JnL2VjbGlwc2UvamR0L2NvcmUvZG9tL0FTVENvbnZlcnRl
ci5qYXZhCmluZGV4IGI3OTA2MjIuLjhjNDE1ZjYgMTAwNjQ0Ci0tLSBhL29yZy5lY2xpcHNlLmpk
dC5jb3JlL2RvbS9vcmcvZWNsaXBzZS9qZHQvY29yZS9kb20vQVNUQ29udmVydGVyLmphdmEKKysr
IGIvb3JnLmVjbGlwc2UuamR0LmNvcmUvZG9tL29yZy9lY2xpcHNlL2pkdC9jb3JlL2RvbS9BU1RD
b252ZXJ0ZXIuamF2YQpAQCAtMTcsNiArMTcsNyBAQAogCiBwYWNrYWdlIG9yZy5lY2xpcHNlLmpk
dC5jb3JlLmRvbTsKIAoraW1wb3J0IGphdmEudXRpbC5BcnJheXM7CiBpbXBvcnQgamF2YS51dGls
Lkhhc2hTZXQ7CiBpbXBvcnQgamF2YS51dGlsLkl0ZXJhdG9yOwogaW1wb3J0IGphdmEudXRpbC5M
aXN0OwpAQCAtNTUsNiArNTYsOCBAQAogaW1wb3J0IG9yZy5lY2xpcHNlLmpkdC5pbnRlcm5hbC5j
b21waWxlci5pbXBsLkNvbXBpbGVyT3B0aW9uczsKIGltcG9ydCBvcmcuZWNsaXBzZS5qZHQuaW50
ZXJuYWwuY29tcGlsZXIubG9va3VwLkJsb2NrU2NvcGU7CiBpbXBvcnQgb3JnLmVjbGlwc2UuamR0
LmludGVybmFsLmNvbXBpbGVyLmxvb2t1cC5FeHRyYUNvbXBpbGVyTW9kaWZpZXJzOworaW1wb3J0
IG9yZy5lY2xpcHNlLmpkdC5pbnRlcm5hbC5jb21waWxlci5sb29rdXAuUGFja2FnZUJpbmRpbmc7
CitpbXBvcnQgb3JnLmVjbGlwc2UuamR0LmludGVybmFsLmNvbXBpbGVyLmxvb2t1cC5SZWZlcmVu
Y2VCaW5kaW5nOwogaW1wb3J0IG9yZy5lY2xpcHNlLmpkdC5pbnRlcm5hbC5jb21waWxlci5sb29r
dXAuVHlwZUNvbnN0YW50czsKIGltcG9ydCBvcmcuZWNsaXBzZS5qZHQuaW50ZXJuYWwuY29tcGls
ZXIucGFyc2VyLlJlY292ZXJ5U2Nhbm5lcjsKIGltcG9ydCBvcmcuZWNsaXBzZS5qZHQuaW50ZXJu
YWwuY29tcGlsZXIucGFyc2VyLlNjYW5uZXI7CkBAIC0zMjk0LDkgKzMyOTcsNiBAQAogCQkJCQlv
cmcuZWNsaXBzZS5qZHQuaW50ZXJuYWwuY29tcGlsZXIuYXN0LkFubm90YXRpb24gdHlwZUFubm90
YXRpb24gPSBhbm5vdGF0aW9uc1tpXTsKIAkJCQkJaWYgKHR5cGVBbm5vdGF0aW9uICE9IG51bGwp
IHsKIAkJCQkJCUFubm90YXRpb24gYW5ub3RhdGlvbiA9IGNvbnZlcnQodHlwZUFubm90YXRpb24p
OwotCQkJCQkJaW50IHN0YXJ0ID0gdHlwZUFubm90YXRpb24uc291cmNlU3RhcnQ7Ci0JCQkJCQlp
bnQgZW5kID0gdHlwZUFubm90YXRpb24uc291cmNlRW5kOwotCQkJCQkJYW5ub3RhdGlvbi5zZXRT
b3VyY2VSYW5nZShzdGFydCwgZW5kIC0gc3RhcnQgKyAxKTsKIAkJCQkJCXR5cGUuYW5ub3RhdGlv
bnMoKS5hZGQoYW5ub3RhdGlvbik7CiAJCQkJCX0KIAkJCQl9CkBAIC0zMzI3LDkgKzMzMjcsNiBA
QAogCQkJCQlvcmcuZWNsaXBzZS5qZHQuaW50ZXJuYWwuY29tcGlsZXIuYXN0LkFubm90YXRpb24g
dHlwZUFubm90YXRpb24gPSBhbm5vdGF0aW9uc1tpXTsKIAkJCQkJaWYgKHR5cGVBbm5vdGF0aW9u
ICE9IG51bGwpIHsKIAkJCQkJCUFubm90YXRpb24gYW5ub3RhdGlvbiA9IGNvbnZlcnQodHlwZUFu
bm90YXRpb24pOwotCQkJCQkJaW50IHN0YXJ0ID0gdHlwZUFubm90YXRpb24uc291cmNlU3RhcnQ7
Ci0JCQkJCQlpbnQgZW5kID0gdHlwZUFubm90YXRpb24uc291cmNlRW5kOwotCQkJCQkJYW5ub3Rh
dGlvbi5zZXRTb3VyY2VSYW5nZShzdGFydCwgZW5kIC0gc3RhcnQgKyAxKTsKIAkJCQkJCXR5cGVQ
YXJhbWV0ZXIuYW5ub3RhdGlvbnMoKS5hZGQoYW5ub3RhdGlvbik7CiAJCQkJCX0KIAkJCQl9CkBA
IC0zNTQ0LDEzICszNTQxLDcgQEAKIAkJCQkJCXNpbXBsZVR5cGUuc2V0TmFtZShuYW1lKTsKIAkJ
CQkJCWludCBzdGFydCA9IChpbnQpKHBvc2l0aW9uc1swXSA+Pj4gMzIpOwogCQkJCQkJaW50IGVu
ZCA9IChpbnQpcG9zaXRpb25zW2ZpcnN0VHlwZUluZGV4XTsKLQkJCQkJCXNpbXBsZVR5cGUuc2V0
U291cmNlUmFuZ2Uoc3RhcnQsIGVuZCAtIHN0YXJ0ICsgMSk7Ci0JCQkJCQlpZiAodHlwZUFubm90
YXRpb25zICE9IG51bGwgJiYgKGFubm90YXRpb25zID0gdHlwZUFubm90YXRpb25zW2ZpcnN0VHlw
ZUluZGV4XSkgIT0gbnVsbCkgewotCQkJCQkJCWFubm90YXRlVHlwZShzaW1wbGVUeXBlLCBhbm5v
dGF0aW9ucyk7Ci0JCQkJCQl9Ci0JCQkJCQlpZiAodGhpcy5yZXNvbHZlQmluZGluZ3MpIHsKLQkJ
CQkJCQlyZWNvcmROb2RlcyhzaW1wbGVUeXBlLCB0eXBlUmVmZXJlbmNlKTsKLQkJCQkJCX0KKwkJ
CQkJCXNldFNvdXJjZUFubm90YXRpb25zQW5kQmluZGluZ3ModHlwZVJlZmVyZW5jZSwgcG9zaXRp
b25zLCB0eXBlQW5ub3RhdGlvbnMsIGZpcnN0VHlwZUluZGV4LCAwLCBmaXJzdFR5cGVJbmRleCwg
c2ltcGxlVHlwZSk7CiAJCQkJCQlUeXBlIGN1cnJlbnRUeXBlID0gc2ltcGxlVHlwZTsJCQkJCQkK
IAkJCQkJCWludCBpbmRleE9mRW5jbG9zaW5nVHlwZSA9IDE7CiAJCQkJCQlpZiAodHlwZUFyZ3Vt
ZW50cyAhPSBudWxsICYmIChhcmd1bWVudHMgPSB0eXBlQXJndW1lbnRzW2ZpcnN0VHlwZUluZGV4
XSkgIT0gbnVsbCkgewpAQCAtMzYyNiw3ICszNjE3LDcgQEAKIAkJCQlvcmcuZWNsaXBzZS5qZHQu
aW50ZXJuYWwuY29tcGlsZXIuYXN0LkFubm90YXRpb24gW11bXSB0eXBlQW5ub3RhdGlvbnMgPSB0
eXBlUmVmZXJlbmNlLmFubm90YXRpb25zOwogCQkJCWNoYXIgW11bXSB0b2tlbnMgPSBxdWFsaWZp
ZWRUeXBlUmVmZXJlbmNlLnRva2VuczsKIAkJCQlpbnQgbGVudGggPSB0b2tlbnMubGVuZ3RoOwot
CQkJCWludCBmaXJzdFR5cGVJbmRleCA9IGxlbnRoIC0gMTsKKwkJCQlpbnQgZmlyc3RUeXBlSW5k
ZXggPSBsZW50aDsKIAkJCQkKIAkJCQlpZiAodHlwZUFubm90YXRpb25zICE9IG51bGwpIHsKIAkJ
CQkJZm9yIChpbnQgaSA9IDA7IGkgPCBsZW50aDsgKytpKSB7CkBAIC0zNjM4LDU3ICszNjI5LDQ0
IEBACiAJCQkJfSAgCiAJCQkJc291cmNlU3RhcnQgPSAoaW50KShwb3NpdGlvbnNbMF0+Pj4zMik7
CiAJCQkJTmFtZSBuYW1lID0gbnVsbDsKLQkJCQlpZiAoZmlyc3RUeXBlSW5kZXggPT0gMCkgewot
CQkJCQlmaW5hbCBTaW1wbGVOYW1lIHNpbXBsZU5hbWUgPSBuZXcgU2ltcGxlTmFtZSh0aGlzLmFz
dCk7Ci0JCQkJCXNpbXBsZU5hbWUuaW50ZXJuYWxTZXRJZGVudGlmaWVyKG5ldyBTdHJpbmcodG9r
ZW5zWzBdKSk7Ci0JCQkJCXJlY29yZFBlbmRpbmdOYW1lU2NvcGVSZXNvbHV0aW9uKHNpbXBsZU5h
bWUpOwotCQkJCQlpbnQgc3RhcnQgPSAoaW50KSAocG9zaXRpb25zWzBdID4+PiAzMik7Ci0JCQkJ
CWludCBlbmQgPSAoaW50KSBwb3NpdGlvbnNbMF07Ci0JCQkJCXNpbXBsZU5hbWUuc2V0U291cmNl
UmFuZ2Uoc3RhcnQsIGVuZCk7Ci0JCQkJCXNpbXBsZU5hbWUuaW5kZXggPSAxOwotCQkJCQluYW1l
ID0gc2ltcGxlTmFtZTsKLQkJCQkJaWYgKHRoaXMucmVzb2x2ZUJpbmRpbmdzKSB7Ci0JCQkJCQly
ZWNvcmROb2RlcyhzaW1wbGVOYW1lLCB0eXBlUmVmZXJlbmNlKTsKLQkJCQkJfQkJCQkJCisJCQkJ
VHlwZSBjdXJyZW50VHlwZSA9IG51bGw7CisJCQkJaWYgKGZpcnN0VHlwZUluZGV4ID09IGxlbnRo
KSB7Ly9KdXN0IGEgUXVhbGlmaWVkTmFtZQorCQkJCQluYW1lID0gc2V0UXVhbGlmaWVkTmFtZU5h
bWVBbmRTb3VyY2VSYW5nZXModG9rZW5zLCBwb3NpdGlvbnMsIGxlbnRoIC0gMSwgdHlwZVJlZmVy
ZW5jZSk7CisJCQkJCWN1cnJlbnRUeXBlID0gZ2V0U2ltcGxlVHlwZVdpdGhOYW1lQW5kQmluZGlu
ZyhuYW1lLCB0eXBlUmVmZXJlbmNlLCBwb3NpdGlvbnMsIDAsIGxlbnRoIC0gMSk7CiAJCQkJfSBl
bHNlIHsKLQkJCQkJbmFtZSA9IHNldFF1YWxpZmllZE5hbWVOYW1lQW5kU291cmNlUmFuZ2VzKHRv
a2VucywgcG9zaXRpb25zLCBmaXJzdFR5cGVJbmRleCwgdHlwZVJlZmVyZW5jZSk7Ci0JCQkJfQot
CQkJCVNpbXBsZVR5cGUgc2ltcGxlVHlwZSA9IG5ldyBTaW1wbGVUeXBlKHRoaXMuYXN0KTsKLQkJ
CQlzaW1wbGVUeXBlLnNldE5hbWUobmFtZSk7Ci0JCQkJaW50IHN0YXJ0ID0gKGludCkocG9zaXRp
b25zWzBdID4+PiAzMik7Ci0JCQkJaW50IGVuZCA9IChpbnQpcG9zaXRpb25zW2ZpcnN0VHlwZUlu
ZGV4XTsKLQkJCQlzaW1wbGVUeXBlLnNldFNvdXJjZVJhbmdlKHN0YXJ0LCBlbmQgLSBzdGFydCAr
IDEpOwotCQkJCWlmICh0eXBlQW5ub3RhdGlvbnMgIT0gbnVsbCAmJiAoYW5ub3RhdGlvbnMgPSB0
eXBlQW5ub3RhdGlvbnNbZmlyc3RUeXBlSW5kZXhdKSAhPSBudWxsKSB7Ci0JCQkJCWFubm90YXRl
VHlwZShzaW1wbGVUeXBlLCBhbm5vdGF0aW9ucyk7Ci0JCQkJfQotCQkJCWlmICh0aGlzLnJlc29s
dmVCaW5kaW5ncykgewotCQkJCQlyZWNvcmROb2RlcyhzaW1wbGVUeXBlLCB0eXBlUmVmZXJlbmNl
KTsKLQkJCQl9Ci0JCQkJVHlwZSBjdXJyZW50VHlwZSA9IHNpbXBsZVR5cGU7Ci0JCQkJCi0JCQkJ
Zm9yIChpbnQgaSA9IGZpcnN0VHlwZUluZGV4ICsgMTsgaSA8IGxlbnRoOyArK2kpIHsKLQkJCQkJ
U2ltcGxlTmFtZSBzaW1wbGVOYW1lID0gbmV3IFNpbXBsZU5hbWUodGhpcy5hc3QpOwotCQkJCQlz
aW1wbGVOYW1lLmludGVybmFsU2V0SWRlbnRpZmllcihuZXcgU3RyaW5nKHRva2Vuc1tpXSkpOwot
CQkJCQlzaW1wbGVOYW1lLmluZGV4ID0gaSArIDE7Ci0JCQkJCXN0YXJ0ID0gKGludCkgKHBvc2l0
aW9uc1tpXSA+Pj4gMzIpOwotCQkJCQllbmQgPSAoaW50KSBwb3NpdGlvbnNbaV07Ci0JCQkJCXNp
bXBsZU5hbWUuc2V0U291cmNlUmFuZ2Uoc3RhcnQsIGVuZCAtIHN0YXJ0ICsxKTsKLQkJCQkJcmVj
b3JkUGVuZGluZ05hbWVTY29wZVJlc29sdXRpb24oc2ltcGxlTmFtZSk7Ci0JCQkJCVF1YWxpZmll
ZFR5cGUgcXVhbGlmaWVkVHlwZSA9IG5ldyBRdWFsaWZpZWRUeXBlKHRoaXMuYXN0KTsKLQkJCQkJ
cXVhbGlmaWVkVHlwZS5zZXRRdWFsaWZpZXIoY3VycmVudFR5cGUpOwotCQkJCQlxdWFsaWZpZWRU
eXBlLnNldE5hbWUoc2ltcGxlTmFtZSk7Ci0JCQkJCWlmICh0eXBlQW5ub3RhdGlvbnMgIT0gbnVs
bCAmJiAoYW5ub3RhdGlvbnMgPSB0eXBlQW5ub3RhdGlvbnNbaV0pICE9IG51bGwpIHsKLQkJCQkJ
CWFubm90YXRlVHlwZShxdWFsaWZpZWRUeXBlLCBhbm5vdGF0aW9ucyk7CisJCQkJCWlmIChmaXJz
dFR5cGVJbmRleCA8PSAxKSB7CisJCQkJCQluYW1lID0gY3JlYXRlU2ltcGxlTmFtZSh0eXBlUmVm
ZXJlbmNlLCBwb3NpdGlvbnMsIHRva2VucywgMCApOworCQkJCQkJZmlyc3RUeXBlSW5kZXggPSAx
OworCQkJCQl9IGVsc2UgeworCQkJCQkJbmFtZSA9IHNldFF1YWxpZmllZE5hbWVOYW1lQW5kU291
cmNlUmFuZ2VzKHRva2VucywgcG9zaXRpb25zLCBmaXJzdFR5cGVJbmRleCAtIDEsIHR5cGVSZWZl
cmVuY2UpOworCQkJCQl9CQkJCQkJCisKKwkJCQkJb3JnLmVjbGlwc2UuamR0LmludGVybmFsLmNv
bXBpbGVyLmxvb2t1cC5UeXBlQmluZGluZyB0eXBlQmluZGluZyA9IHR5cGVSZWZlcmVuY2UucmVz
b2x2ZWRUeXBlOworCQkJCQlib29sZWFuIGNyZWF0ZVBhY2thZ2VRdWFsaWZpZWRUeXBlID0gZmFs
c2U7CisJCQkJCWlmICh0eXBlQmluZGluZyBpbnN0YW5jZW9mIFJlZmVyZW5jZUJpbmRpbmcpIHsK
KwkJCQkJCVJlZmVyZW5jZUJpbmRpbmcgcmVmZXJlbmNlQmluZGluZyA9IChSZWZlcmVuY2VCaW5k
aW5nKXR5cGVCaW5kaW5nOwkJCQorCQkJCQkJUGFja2FnZUJpbmRpbmcgcGFja2FnZUJpbmRpbmcg
PSByZWZlcmVuY2VCaW5kaW5nLmdldFBhY2thZ2UoKTsKKwkJCQkJCWlmIChwYWNrYWdlQmluZGlu
ZyAhPSBudWxsICYmIEFycmF5cy5lcXVhbHMobmFtZS50b1N0cmluZygpLnRvQ2hhckFycmF5KCks
IHBhY2thZ2VCaW5kaW5nLnJlYWRhYmxlTmFtZSgpKSkgeworCQkJCQkJCWNyZWF0ZVBhY2thZ2VR
dWFsaWZpZWRUeXBlID0gdHJ1ZTsKKwkJCQkJCX0KIAkJCQkJfQotCQkJCQlpZiAodGhpcy5yZXNv
bHZlQmluZGluZ3MpIHsKLQkJCQkJCXJlY29yZE5vZGVzKHNpbXBsZU5hbWUsIHR5cGVSZWZlcmVu
Y2UpOwotCQkJCQkJcmVjb3JkTm9kZXMocXVhbGlmaWVkVHlwZSwgdHlwZVJlZmVyZW5jZSk7CisJ
CQkJCQorCQkJCQlpZiAoY3JlYXRlUGFja2FnZVF1YWxpZmllZFR5cGUgJiYgdGhpcy5hc3QuYXBp
TGV2ZWwgPj0gQVNULkpMUzgpIHsKKwkJCQkJCVBhY2thZ2VRdWFsaWZpZWRUeXBlIHBhY2thZ2VR
dWFsaWZpZWRUeXBlID0gbmV3IFBhY2thZ2VRdWFsaWZpZWRUeXBlKHRoaXMuYXN0KTsKKwkJCQkJ
CXBhY2thZ2VRdWFsaWZpZWRUeXBlLnNldFF1YWxpZmllcihuYW1lKTsKKwkJCQkJCXBhY2thZ2VR
dWFsaWZpZWRUeXBlLnNldE5hbWUoY3JlYXRlU2ltcGxlTmFtZSh0eXBlUmVmZXJlbmNlLCBwb3Np
dGlvbnMsIHRva2VucywgZmlyc3RUeXBlSW5kZXgpKTsKKwkJCQkJCXNldFNvdXJjZUFubm90YXRp
b25zQW5kQmluZGluZ3ModHlwZVJlZmVyZW5jZSwgcG9zaXRpb25zLCB0eXBlQW5ub3RhdGlvbnMs
IGZpcnN0VHlwZUluZGV4LCAwLCBmaXJzdFR5cGVJbmRleCwgcGFja2FnZVF1YWxpZmllZFR5cGUp
OworCQkJCQkJY3VycmVudFR5cGUgPSBwYWNrYWdlUXVhbGlmaWVkVHlwZTsJCQkJCQkJCQkJCQkJ
CQkJCQorCQkJCQl9IGVsc2UgeworCQkJCQkJU2ltcGxlVHlwZSBzaW1wbGVUeXBlID0gdGhpcy5h
c3QubmV3U2ltcGxlVHlwZShuYW1lKTsJCisJCQkJCQlzZXRTb3VyY2VBbm5vdGF0aW9uc0FuZEJp
bmRpbmdzKHR5cGVSZWZlcmVuY2UsIHBvc2l0aW9ucywgdHlwZUFubm90YXRpb25zLCAwLCAwLCAw
LCBzaW1wbGVUeXBlKTsKKwkJCQkJCWN1cnJlbnRUeXBlID0gZ2V0UXVhbGlmaWVkVHlwZVdpdGhT
b3VyY2VBbmRCaW5kaW5nKHR5cGVSZWZlcmVuY2UsIHBvc2l0aW9ucywgIHR5cGVBbm5vdGF0aW9u
cywgdG9rZW5zLCBmaXJzdFR5cGVJbmRleCwgc2ltcGxlVHlwZSk7CisJCQkJCQlpZiAoY3JlYXRl
UGFja2FnZVF1YWxpZmllZFR5cGUpIAorCQkJCQkJCWN1cnJlbnRUeXBlLnNldEZsYWdzKGN1cnJl
bnRUeXBlLmdldEZsYWdzKCkgfCBBU1ROb2RlLk1BTEZPUk1FRCk7CiAJCQkJCX0KLQkJCQkJc3Rh
cnQgPSBjdXJyZW50VHlwZS5nZXRTdGFydFBvc2l0aW9uKCk7Ci0JCQkJCWVuZCA9IHNpbXBsZU5h
bWUuZ2V0U3RhcnRQb3NpdGlvbigpICsgc2ltcGxlTmFtZS5nZXRMZW5ndGgoKSAtIDE7Ci0JCQkJ
CXF1YWxpZmllZFR5cGUuc2V0U291cmNlUmFuZ2Uoc3RhcnQsIGVuZCAtIHN0YXJ0ICsgMSk7Ci0J
CQkJCWN1cnJlbnRUeXBlID0gcXVhbGlmaWVkVHlwZTsKLQkJCQkJcXVhbGlmaWVkVHlwZS5pbmRl
eCAgPSAxOworCQkJCQlmb3IgKGludCBpID0gZmlyc3RUeXBlSW5kZXggKyAxOyBpIDwgbGVudGg7
ICsraSkgeworCQkJCQkJY3VycmVudFR5cGUgPSBnZXRRdWFsaWZpZWRUeXBlV2l0aFNvdXJjZUFu
ZEJpbmRpbmcodHlwZVJlZmVyZW5jZSwgcG9zaXRpb25zLCAgdHlwZUFubm90YXRpb25zLCB0b2tl
bnMsIGksIGN1cnJlbnRUeXBlKTsKKwkJCQkJfQkJCQkJCiAJCQkJfQogCQkJCXR5cGUgPSBjdXJy
ZW50VHlwZTsKIAkJCX0gZWxzZSB7CkBAIC0zNzc4LDYgKzM3NTYsNzMgQEAKIAkJcmV0dXJuIHR5
cGU7CiAJfQogCisJcHJpdmF0ZSBRdWFsaWZpZWRUeXBlIGdldFF1YWxpZmllZFR5cGVXaXRoU291
cmNlQW5kQmluZGluZyhUeXBlUmVmZXJlbmNlIHR5cGVSZWZlcmVuY2UsIGxvbmdbXSBwb3NpdGlv
bnMsCisJCQlvcmcuZWNsaXBzZS5qZHQuaW50ZXJuYWwuY29tcGlsZXIuYXN0LkFubm90YXRpb25b
XVtdIHR5cGVBbm5vdGF0aW9ucywgY2hhcltdW10gdG9rZW5zLCBpbnQgaW5kZXgsCisJCQlUeXBl
IHF1YWxpZmllcikgeworCQlTaW1wbGVOYW1lIHNpbXBsZU5hbWUgPSBjcmVhdGVTaW1wbGVOYW1l
KHR5cGVSZWZlcmVuY2UsIHBvc2l0aW9ucywgdG9rZW5zLCBpbmRleCk7CisJCVF1YWxpZmllZFR5
cGUgcXVhbGlmaWVkVHlwZSA9IG5ldyBRdWFsaWZpZWRUeXBlKHRoaXMuYXN0KTsKKwkJcXVhbGlm
aWVkVHlwZS5zZXRRdWFsaWZpZXIocXVhbGlmaWVyKTsKKwkJcXVhbGlmaWVkVHlwZS5zZXROYW1l
KHNpbXBsZU5hbWUpOworCQlpbnQgc3RhcnQgPSBxdWFsaWZpZXIuZ2V0U3RhcnRQb3NpdGlvbigp
OworCQlpbnQgZW5kID0gc2ltcGxlTmFtZS5nZXRTdGFydFBvc2l0aW9uKCkgKyBzaW1wbGVOYW1l
LmdldExlbmd0aCgpIC0gMTsKKwkJc2V0U291cmNlQW5ub3RhdGlvbnNBbmRCaW5kaW5ncyh0eXBl
UmVmZXJlbmNlLCB0eXBlQW5ub3RhdGlvbnMsIGluZGV4LCBzdGFydCwgZW5kLCBxdWFsaWZpZWRU
eXBlKTsKKwkJcmV0dXJuIHF1YWxpZmllZFR5cGU7CisJfQorCisJcHJpdmF0ZSBTaW1wbGVUeXBl
IGdldFNpbXBsZVR5cGVXaXRoTmFtZUFuZEJpbmRpbmcoTmFtZSBuYW1lLCBUeXBlUmVmZXJlbmNl
IHR5cGVSZWZlcmVuY2UsIGxvbmdbXSBwb3NpdGlvbnMsCisJCQlpbnQgc3RhcnRJbmRleCwgaW50
IGVuZEluZGV4KSB7CisJCVNpbXBsZVR5cGUgc2ltcGxlVHlwZSA9IG5ldyBTaW1wbGVUeXBlKHRo
aXMuYXN0KTsKKwkJc2ltcGxlVHlwZS5zZXROYW1lKG5hbWUpOworCQlpbnQgc3RhcnQgPSAoaW50
KShwb3NpdGlvbnNbc3RhcnRJbmRleF0gPj4+IDMyKTsKKwkJaW50IGVuZCA9IChpbnQpcG9zaXRp
b25zW2VuZEluZGV4XTsKKwkJc2ltcGxlVHlwZS5zZXRTb3VyY2VSYW5nZShzdGFydCwgZW5kIC0g
c3RhcnQgKyAxKTsKKwkJaWYgKHRoaXMucmVzb2x2ZUJpbmRpbmdzKSB7CisJCQlyZWNvcmROb2Rl
cyhzaW1wbGVUeXBlLCB0eXBlUmVmZXJlbmNlKTsKKwkJfQorCQlyZXR1cm4gc2ltcGxlVHlwZTsK
Kwl9CisKKwlwcml2YXRlIHZvaWQgc2V0U291cmNlQW5ub3RhdGlvbnNBbmRCaW5kaW5ncyhUeXBl
UmVmZXJlbmNlIHR5cGVSZWZlcmVuY2UsIAorCQkJb3JnLmVjbGlwc2UuamR0LmludGVybmFsLmNv
bXBpbGVyLmFzdC5Bbm5vdGF0aW9uW11bXSB0eXBlQW5ub3RhdGlvbnMsIGludCBpbmRleCwgaW50
IHN0YXJ0LCBpbnQgZW5kLAorCQkJQW5ub3RhdGFibGVUeXBlIGFubm90YXRhYmxlVHlwZSkgewor
CQlvcmcuZWNsaXBzZS5qZHQuaW50ZXJuYWwuY29tcGlsZXIuYXN0LkFubm90YXRpb25bXSBhbm5v
dGF0aW9uczsKKwkJaW50IGFubm90YXRpb25zU3RhcnQgPSBzdGFydDsKKwkJaW50IGxlbmd0aCA9
IGVuZCAtIHN0YXJ0ICsgMTsKKwkJaWYgKHR5cGVBbm5vdGF0aW9ucyAhPSBudWxsICYmIChhbm5v
dGF0aW9ucyA9IHR5cGVBbm5vdGF0aW9uc1tpbmRleF0pICE9IG51bGwpIHsKKwkJCWFubm90YXRl
VHlwZShhbm5vdGF0YWJsZVR5cGUsIGFubm90YXRpb25zKTsKKwkJCWlmIChhbm5vdGF0aW9uc1sw
XSAhPSBudWxsICYmIChhbm5vdGF0aW9uc1N0YXJ0ID0gYW5ub3RhdGlvbnNbMF0uc291cmNlU3Rh
cnQpIDwgc3RhcnQpIHsKKwkJCQlsZW5ndGggKz0gYW5ub3RhdGlvbnNTdGFydCA+IDAgPyBzdGFy
dCAtIGFubm90YXRpb25zU3RhcnQgOiAwOworCQkJCXN0YXJ0ID0gYW5ub3RhdGlvbnNTdGFydDsK
KwkJCX0KKwkJfQorCQlhbm5vdGF0YWJsZVR5cGUuc2V0U291cmNlUmFuZ2Uoc3RhcnQsIGxlbmd0
aCk7CisJCWlmICh0aGlzLnJlc29sdmVCaW5kaW5ncykgeworCQkJcmVjb3JkTm9kZXMoYW5ub3Rh
dGFibGVUeXBlLCB0eXBlUmVmZXJlbmNlKTsKKwkJfQorCX0KKworCXByaXZhdGUgdm9pZCBzZXRT
b3VyY2VBbm5vdGF0aW9uc0FuZEJpbmRpbmdzKFR5cGVSZWZlcmVuY2UgdHlwZVJlZmVyZW5jZSwg
bG9uZ1tdIHBvc2l0aW9ucywKKwkJCW9yZy5lY2xpcHNlLmpkdC5pbnRlcm5hbC5jb21waWxlci5h
c3QuQW5ub3RhdGlvbltdW10gdHlwZUFubm90YXRpb25zLCBpbnQgaW5kZXgsIGludCBzdGFydElu
ZGV4LCBpbnQgZW5kSW5kZXgsCisJCQlBbm5vdGF0YWJsZVR5cGUgYW5ub3RhdGFibGVUeXBlKSB7
CisJCWludCBzdGFydCA9IChpbnQpIChwb3NpdGlvbnNbc3RhcnRJbmRleF0gPj4+IDMyKTsKKwkJ
aW50IGVuZCA9IChpbnQpIHBvc2l0aW9uc1tlbmRJbmRleF07CisJCXNldFNvdXJjZUFubm90YXRp
b25zQW5kQmluZGluZ3ModHlwZVJlZmVyZW5jZSwgdHlwZUFubm90YXRpb25zLCBpbmRleCwgc3Rh
cnQsIGVuZCwgYW5ub3RhdGFibGVUeXBlKTsKKwl9CisKKwlwcml2YXRlIFNpbXBsZU5hbWUgY3Jl
YXRlU2ltcGxlTmFtZShUeXBlUmVmZXJlbmNlIHR5cGVSZWZlcmVuY2UsIGxvbmdbXSBwb3NpdGlv
bnMsIGNoYXJbXVtdIHRva2VucywgaW50IGluZGV4KSB7CisJCWZpbmFsIFNpbXBsZU5hbWUgc2lt
cGxlTmFtZSA9IG5ldyBTaW1wbGVOYW1lKHRoaXMuYXN0KTsKKwkJc2ltcGxlTmFtZS5pbnRlcm5h
bFNldElkZW50aWZpZXIobmV3IFN0cmluZyh0b2tlbnNbaW5kZXhdKSk7CisJCXJlY29yZFBlbmRp
bmdOYW1lU2NvcGVSZXNvbHV0aW9uKHNpbXBsZU5hbWUpOworCQlpbnQgc3RhcnQgPSAoaW50KSAo
cG9zaXRpb25zW2luZGV4XSA+Pj4gMzIpOworCQlpbnQgZW5kID0gKGludCkgcG9zaXRpb25zW2lu
ZGV4XTsKKwkJc2ltcGxlTmFtZS5zZXRTb3VyY2VSYW5nZShzdGFydCwgZW5kIC0gc3RhcnQgKyAx
KTsKKwkJc2ltcGxlTmFtZS5pbmRleCA9IGluZGV4ICsgMTsKKwkJaWYgKHRoaXMucmVzb2x2ZUJp
bmRpbmdzKSB7CisJCQlyZWNvcmROb2RlcyhzaW1wbGVOYW1lLCB0eXBlUmVmZXJlbmNlKTsKKwkJ
fQorCQlyZXR1cm4gc2ltcGxlTmFtZTsKKwl9CisKIAlwcm90ZWN0ZWQgQ29tbWVudCBjcmVhdGVD
b21tZW50KGludFtdIHBvc2l0aW9ucykgewogCQkvLyBDcmVhdGUgY29tbWVudCBub2RlCiAJCUNv
bW1lbnQgY29tbWVudCA9IG51bGw7CmRpZmYgLS1naXQgYS9vcmcuZWNsaXBzZS5qZHQuY29yZS9k
b20vb3JnL2VjbGlwc2UvamR0L2NvcmUvZG9tL0FTVE1hdGNoZXIuamF2YSBiL29yZy5lY2xpcHNl
LmpkdC5jb3JlL2RvbS9vcmcvZWNsaXBzZS9qZHQvY29yZS9kb20vQVNUTWF0Y2hlci5qYXZhCmlu
ZGV4IGViMTNlYzYuLjBkZmM5OTAgMTAwNjQ0Ci0tLSBhL29yZy5lY2xpcHNlLmpkdC5jb3JlL2Rv
bS9vcmcvZWNsaXBzZS9qZHQvY29yZS9kb20vQVNUTWF0Y2hlci5qYXZhCisrKyBiL29yZy5lY2xp
cHNlLmpkdC5jb3JlL2RvbS9vcmcvZWNsaXBzZS9qZHQvY29yZS9kb20vQVNUTWF0Y2hlci5qYXZh
CkBAIC0xNTY5LDYgKzE1NjksMzEgQEAKIAkgKiBAcmV0dXJuIDxjb2RlPnRydWU8L2NvZGU+IGlm
IHRoZSBzdWJ0cmVlIG1hdGNoZXMsIG9yCiAJICogICA8Y29kZT5mYWxzZTwvY29kZT4gaWYgdGhl
eSBkbyBub3QgbWF0Y2ggb3IgdGhlIG90aGVyIG9iamVjdCBoYXMgYQogCSAqICAgZGlmZmVyZW50
IG5vZGUgdHlwZSBvciBpcyA8Y29kZT5udWxsPC9jb2RlPgorCSAqIEBzaW5jZSAzLjkKKwkgKi8K
KwlwdWJsaWMgYm9vbGVhbiBtYXRjaChQYWNrYWdlUXVhbGlmaWVkVHlwZSBub2RlLCBPYmplY3Qg
b3RoZXIpIHsKKwkJaWYgKCEob3RoZXIgaW5zdGFuY2VvZiBQYWNrYWdlUXVhbGlmaWVkVHlwZSkp
IHsKKwkJCXJldHVybiBmYWxzZTsKKwkJfQorCQlQYWNrYWdlUXVhbGlmaWVkVHlwZSBvID0gKFBh
Y2thZ2VRdWFsaWZpZWRUeXBlKSBvdGhlcjsKKwkJcmV0dXJuIHNhZmVTdWJ0cmVlTWF0Y2gobm9k
ZS5nZXRRdWFsaWZpZXIoKSwgby5nZXRRdWFsaWZpZXIoKSkKKwkJCQkmJiBzYWZlU3VidHJlZUxp
c3RNYXRjaChub2RlLmFubm90YXRpb25zKCksIG8uYW5ub3RhdGlvbnMoKSkKKwkJCQkmJiBzYWZl
U3VidHJlZU1hdGNoKG5vZGUuZ2V0TmFtZSgpLCBvLmdldE5hbWUoKSk7CisJfQorCisJLyoqCisJ
ICogUmV0dXJucyB3aGV0aGVyIHRoZSBnaXZlbiBub2RlIGFuZCB0aGUgb3RoZXIgb2JqZWN0IG1h
dGNoLgorCSAqIDxwPgorCSAqIFRoZSBkZWZhdWx0IGltcGxlbWVudGF0aW9uIHByb3ZpZGVkIGJ5
IHRoaXMgY2xhc3MgdGVzdHMgd2hldGhlciB0aGUKKwkgKiBvdGhlciBvYmplY3QgaXMgYSBub2Rl
IG9mIHRoZSBzYW1lIHR5cGUgd2l0aCBzdHJ1Y3R1cmFsbHkgaXNvbW9ycGhpYworCSAqIGNoaWxk
IHN1YnRyZWVzLiBTdWJjbGFzc2VzIG1heSBvdmVycmlkZSB0aGlzIG1ldGhvZCBhcyBuZWVkZWQu
CisJICogPC9wPgorCSAqCisJICogQHBhcmFtIG5vZGUgdGhlIG5vZGUKKwkgKiBAcGFyYW0gb3Ro
ZXIgdGhlIG90aGVyIG9iamVjdCwgb3IgPGNvZGU+bnVsbDwvY29kZT4KKwkgKiBAcmV0dXJuIDxj
b2RlPnRydWU8L2NvZGU+IGlmIHRoZSBzdWJ0cmVlIG1hdGNoZXMsIG9yCisJICogICA8Y29kZT5m
YWxzZTwvY29kZT4gaWYgdGhleSBkbyBub3QgbWF0Y2ggb3IgdGhlIG90aGVyIG9iamVjdCBoYXMg
YQorCSAqICAgZGlmZmVyZW50IG5vZGUgdHlwZSBvciBpcyA8Y29kZT5udWxsPC9jb2RlPgogCSAq
IEBzaW5jZSAzLjEKIAkgKi8KIAlwdWJsaWMgYm9vbGVhbiBtYXRjaChQYXJhbWV0ZXJpemVkVHlw
ZSBub2RlLCBPYmplY3Qgb3RoZXIpIHsKZGlmZiAtLWdpdCBhL29yZy5lY2xpcHNlLmpkdC5jb3Jl
L2RvbS9vcmcvZWNsaXBzZS9qZHQvY29yZS9kb20vQVNUTm9kZS5qYXZhIGIvb3JnLmVjbGlwc2Uu
amR0LmNvcmUvZG9tL29yZy9lY2xpcHNlL2pkdC9jb3JlL2RvbS9BU1ROb2RlLmphdmEKaW5kZXgg
ZjdkYzkwYy4uZDViMjI0MyAxMDA2NDQKLS0tIGEvb3JnLmVjbGlwc2UuamR0LmNvcmUvZG9tL29y
Zy9lY2xpcHNlL2pkdC9jb3JlL2RvbS9BU1ROb2RlLmphdmEKKysrIGIvb3JnLmVjbGlwc2UuamR0
LmNvcmUvZG9tL29yZy9lY2xpcHNlL2pkdC9jb3JlL2RvbS9BU1ROb2RlLmphdmEKQEAgLTg1MSw2
ICs4NTEsMTQgQEAKIAlwdWJsaWMgc3RhdGljIGZpbmFsIGludCBMQU1CREFfRVhQUkVTU0lPTiA9
IDg2OwogCiAJLyoqCisJICogTm9kZSB0eXBlIGNvbnN0YW50IGluZGljYXRpbmcgYSBub2RlIG9m
IHR5cGUKKwkgKiA8Y29kZT5RdWFsaWZpZWRUeXBlPC9jb2RlPi4KKwkgKiBAc2VlIFF1YWxpZmll
ZFR5cGUKKwkgKiBAc2luY2UgMy45CisJICovCisJcHVibGljIHN0YXRpYyBmaW5hbCBpbnQgUEFD
S0FHRV9RVUFMSUZJRURfVFlQRSA9IDg3OworCisJLyoqCiAJICogUmV0dXJucyB0aGUgbm9kZSBj
bGFzcyBmb3IgdGhlIGNvcnJlc3BvbmRpbmcgbm9kZSB0eXBlLgogCSAqCiAJICogQHBhcmFtIG5v
ZGVUeXBlIEFTVCBub2RlIHR5cGUKQEAgLTk2OCw2ICs5NzYsOCBAQAogCQkJCXJldHVybiBOdW1i
ZXJMaXRlcmFsLmNsYXNzOwogCQkJY2FzZSBQQUNLQUdFX0RFQ0xBUkFUSU9OIDoKIAkJCQlyZXR1
cm4gUGFja2FnZURlY2xhcmF0aW9uLmNsYXNzOworCQkJY2FzZSBQQUNLQUdFX1FVQUxJRklFRF9U
WVBFIDoKKwkJCQlyZXR1cm4gUGFja2FnZVF1YWxpZmllZFR5cGUuY2xhc3M7CiAJCQljYXNlIFBB
UkFNRVRFUklaRURfVFlQRSA6CiAJCQkJcmV0dXJuIFBhcmFtZXRlcml6ZWRUeXBlLmNsYXNzOwog
CQkJY2FzZSBQQVJFTlRIRVNJWkVEX0VYUFJFU1NJT04gOgpkaWZmIC0tZ2l0IGEvb3JnLmVjbGlw
c2UuamR0LmNvcmUvZG9tL29yZy9lY2xpcHNlL2pkdC9jb3JlL2RvbS9BU1RWaXNpdG9yLmphdmEg
Yi9vcmcuZWNsaXBzZS5qZHQuY29yZS9kb20vb3JnL2VjbGlwc2UvamR0L2NvcmUvZG9tL0FTVFZp
c2l0b3IuamF2YQppbmRleCA0NDJjMmQyLi4xNDk5ZjBiIDEwMDY0NAotLS0gYS9vcmcuZWNsaXBz
ZS5qZHQuY29yZS9kb20vb3JnL2VjbGlwc2UvamR0L2NvcmUvZG9tL0FTVFZpc2l0b3IuamF2YQor
KysgYi9vcmcuZWNsaXBzZS5qZHQuY29yZS9kb20vb3JnL2VjbGlwc2UvamR0L2NvcmUvZG9tL0FT
VFZpc2l0b3IuamF2YQpAQCAtMTA3Miw2ICsxMDcyLDIzIEBACiAJICogQHJldHVybiA8Y29kZT50
cnVlPC9jb2RlPiBpZiB0aGUgY2hpbGRyZW4gb2YgdGhpcyBub2RlIHNob3VsZCBiZQogCSAqIHZp
c2l0ZWQsIGFuZCA8Y29kZT5mYWxzZTwvY29kZT4gaWYgdGhlIGNoaWxkcmVuIG9mIHRoaXMgbm9k
ZSBzaG91bGQKIAkgKiBiZSBza2lwcGVkCisJICogQHNpbmNlIDMuOQorCSAqLworCXB1YmxpYyBi
b29sZWFuIHZpc2l0KFBhY2thZ2VRdWFsaWZpZWRUeXBlIG5vZGUpIHsKKwkJcmV0dXJuIHRydWU7
CisJfQorCisJLyoqCisJICogVmlzaXRzIHRoZSBnaXZlbiB0eXBlLXNwZWNpZmljIEFTVCBub2Rl
LgorCSAqIDxwPgorCSAqIFRoZSBkZWZhdWx0IGltcGxlbWVudGF0aW9uIGRvZXMgbm90aGluZyBh
bmQgcmV0dXJuIHRydWUuCisJICogU3ViY2xhc3NlcyBtYXkgcmVpbXBsZW1lbnQuCisJICogPC9w
PgorCSAqCisJICogQHBhcmFtIG5vZGUgdGhlIG5vZGUgdG8gdmlzaXQKKwkgKiBAcmV0dXJuIDxj
b2RlPnRydWU8L2NvZGU+IGlmIHRoZSBjaGlsZHJlbiBvZiB0aGlzIG5vZGUgc2hvdWxkIGJlCisJ
ICogdmlzaXRlZCwgYW5kIDxjb2RlPmZhbHNlPC9jb2RlPiBpZiB0aGUgY2hpbGRyZW4gb2YgdGhp
cyBub2RlIHNob3VsZAorCSAqIGJlIHNraXBwZWQKIAkgKiBAc2luY2UgMy4xCiAJICovCiAJcHVi
bGljIGJvb2xlYW4gdmlzaXQoUGFyYW1ldGVyaXplZFR5cGUgbm9kZSkgewpAQCAtMjI3NCw2ICsy
MjkxLDE5IEBACiAJICogPC9wPgogCSAqCiAJICogQHBhcmFtIG5vZGUgdGhlIG5vZGUgdG8gdmlz
aXQKKwkgKiBAc2luY2UgMy45CisJICovCisJcHVibGljIHZvaWQgZW5kVmlzaXQoUGFja2FnZVF1
YWxpZmllZFR5cGUgbm9kZSkgeworCQkvLyBkZWZhdWx0IGltcGxlbWVudGF0aW9uOiBkbyBub3Ro
aW5nCisJfQorCisJLyoqCisJICogRW5kIG9mIHZpc2l0IHRoZSBnaXZlbiB0eXBlLXNwZWNpZmlj
IEFTVCBub2RlLgorCSAqIDxwPgorCSAqIFRoZSBkZWZhdWx0IGltcGxlbWVudGF0aW9uIGRvZXMg
bm90aGluZy4gU3ViY2xhc3NlcyBtYXkgcmVpbXBsZW1lbnQuCisJICogPC9wPgorCSAqCisJICog
QHBhcmFtIG5vZGUgdGhlIG5vZGUgdG8gdmlzaXQKIAkgKiBAc2luY2UgMy4xCiAJICovCiAJcHVi
bGljIHZvaWQgZW5kVmlzaXQoUGFyYW1ldGVyaXplZFR5cGUgbm9kZSkgewpkaWZmIC0tZ2l0IGEv
b3JnLmVjbGlwc2UuamR0LmNvcmUvZG9tL29yZy9lY2xpcHNlL2pkdC9jb3JlL2RvbS9EZWZhdWx0
QVNUVmlzaXRvci5qYXZhIGIvb3JnLmVjbGlwc2UuamR0LmNvcmUvZG9tL29yZy9lY2xpcHNlL2pk
dC9jb3JlL2RvbS9EZWZhdWx0QVNUVmlzaXRvci5qYXZhCmluZGV4IDg3MDliODYuLjQ4N2NhMTgg
MTAwNjQ0Ci0tLSBhL29yZy5lY2xpcHNlLmpkdC5jb3JlL2RvbS9vcmcvZWNsaXBzZS9qZHQvY29y
ZS9kb20vRGVmYXVsdEFTVFZpc2l0b3IuamF2YQorKysgYi9vcmcuZWNsaXBzZS5qZHQuY29yZS9k
b20vb3JnL2VjbGlwc2UvamR0L2NvcmUvZG9tL0RlZmF1bHRBU1RWaXNpdG9yLmphdmEKQEAgLTE4
Miw2ICsxODIsOSBAQAogCXB1YmxpYyB2b2lkIGVuZFZpc2l0KFBhY2thZ2VEZWNsYXJhdGlvbiBu
b2RlKSB7CiAJCWVuZFZpc2l0Tm9kZShub2RlKTsKIAl9CisJcHVibGljIHZvaWQgZW5kVmlzaXQo
UGFja2FnZVF1YWxpZmllZFR5cGUgbm9kZSkgeworCQllbmRWaXNpdE5vZGUobm9kZSk7CisJfQog
CXB1YmxpYyB2b2lkIGVuZFZpc2l0KFBhcmFtZXRlcml6ZWRUeXBlIG5vZGUpIHsKIAkJZW5kVmlz
aXROb2RlKG5vZGUpOwogCX0KQEAgLTQ0OCw2ICs0NTEsOSBAQAogCXB1YmxpYyBib29sZWFuIHZp
c2l0KFBhY2thZ2VEZWNsYXJhdGlvbiBub2RlKSB7CiAJCXJldHVybiB2aXNpdE5vZGUobm9kZSk7
CiAJfQorCXB1YmxpYyBib29sZWFuIHZpc2l0KFBhY2thZ2VRdWFsaWZpZWRUeXBlIG5vZGUpIHsK
KwkJcmV0dXJuIHZpc2l0Tm9kZShub2RlKTsKKwl9CiAJcHVibGljIGJvb2xlYW4gdmlzaXQoUGFy
YW1ldGVyaXplZFR5cGUgbm9kZSkgewogCQlyZXR1cm4gdmlzaXROb2RlKG5vZGUpOwogCX0KZGlm
ZiAtLWdpdCBhL29yZy5lY2xpcHNlLmpkdC5jb3JlL2RvbS9vcmcvZWNsaXBzZS9qZHQvY29yZS9k
b20vUGFja2FnZVF1YWxpZmllZFR5cGUuamF2YSBiL29yZy5lY2xpcHNlLmpkdC5jb3JlL2RvbS9v
cmcvZWNsaXBzZS9qZHQvY29yZS9kb20vUGFja2FnZVF1YWxpZmllZFR5cGUuamF2YQpuZXcgZmls
ZSBtb2RlIDEwMDY0NAppbmRleCAwMDAwMDAwLi45YmFmNTFmCi0tLSAvZGV2L251bGwKKysrIGIv
b3JnLmVjbGlwc2UuamR0LmNvcmUvZG9tL29yZy9lY2xpcHNlL2pkdC9jb3JlL2RvbS9QYWNrYWdl
UXVhbGlmaWVkVHlwZS5qYXZhCkBAIC0wLDAgKzEsMjg1IEBACisvKioqKioqKioqKioqKioqKioq
KioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioq
KioqKgorICogQ29weXJpZ2h0IChjKSAyMDAzLCAyMDEzIElCTSBDb3Jwb3JhdGlvbiBhbmQgb3Ro
ZXJzLgorICogQWxsIHJpZ2h0cyByZXNlcnZlZC4gVGhpcyBwcm9ncmFtIGFuZCB0aGUgYWNjb21w
YW55aW5nIG1hdGVyaWFscworICogYXJlIG1hZGUgYXZhaWxhYmxlIHVuZGVyIHRoZSB0ZXJtcyBv
ZiB0aGUgRWNsaXBzZSBQdWJsaWMgTGljZW5zZSB2MS4wCisgKiB3aGljaCBhY2NvbXBhbmllcyB0
aGlzIGRpc3RyaWJ1dGlvbiwgYW5kIGlzIGF2YWlsYWJsZSBhdAorICogaHR0cDovL3d3dy5lY2xp
cHNlLm9yZy9sZWdhbC9lcGwtdjEwLmh0bWwKKyAqCisgKiBUaGlzIGlzIGFuIGltcGxlbWVudGF0
aW9uIG9mIGFuIGVhcmx5LWRyYWZ0IHNwZWNpZmljYXRpb24gZGV2ZWxvcGVkIHVuZGVyIHRoZSBK
YXZhCisgKiBDb21tdW5pdHkgUHJvY2VzcyAoSkNQKSBhbmQgaXMgbWFkZSBhdmFpbGFibGUgZm9y
IHRlc3RpbmcgYW5kIGV2YWx1YXRpb24gcHVycG9zZXMKKyAqIG9ubHkuIFRoZSBjb2RlIGlzIG5v
dCBjb21wYXRpYmxlIHdpdGggYW55IHNwZWNpZmljYXRpb24gb2YgdGhlIEpDUC4KKyAqIAorICog
Q29udHJpYnV0b3JzOgorICogICAgIElCTSBDb3Jwb3JhdGlvbiAtIGluaXRpYWwgQVBJIGFuZCBp
bXBsZW1lbnRhdGlvbgorICoqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioq
KioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKiovCisKK3BhY2thZ2Ugb3JnLmVj
bGlwc2UuamR0LmNvcmUuZG9tOworCitpbXBvcnQgamF2YS51dGlsLkFycmF5TGlzdDsKK2ltcG9y
dCBqYXZhLnV0aWwuTGlzdDsKKworLyoqCisgKiBOb2RlIGZvciBhIHBhY2thZ2UgcXVhbGlmaWVk
IHR5cGUgKGFkZGVkIGluIEpMUzggQVBJKS4KKyAqIAorICogPHByZT4KKyAqIFBhY2thZ2VRdWFs
aWZpZWRUeXBlOgorICogICAgTmFtZSA8Yj4uPC9iPiB7IEFubm90YXRpb24gfSBTaW1wbGVOYW1l
CisgKiA8L3ByZT4KKyAqCisgKiBAc2luY2UgMy45CisgKiBAbm9pbnN0YW50aWF0ZSBUaGlzIGNs
YXNzIGlzIG5vdCBpbnRlbmRlZCB0byBiZSBpbnN0YW50aWF0ZWQgYnkgY2xpZW50cy4KKyAqLwor
cHVibGljIGNsYXNzIFBhY2thZ2VRdWFsaWZpZWRUeXBlIGV4dGVuZHMgQW5ub3RhdGFibGVUeXBl
IHsKKworCS8qKgorCSAqIFRoZSAicXVhbGlmaWVyIiBzdHJ1Y3R1cmFsIHByb3BlcnR5IG9mIHRo
aXMgbm9kZSB0eXBlIChjaGlsZCB0eXBlOiB7QGxpbmsgTmFtZX0pLgorCSAqLworCXB1YmxpYyBz
dGF0aWMgZmluYWwgQ2hpbGRQcm9wZXJ0eURlc2NyaXB0b3IgUVVBTElGSUVSX1BST1BFUlRZID0K
KwkJbmV3IENoaWxkUHJvcGVydHlEZXNjcmlwdG9yKFBhY2thZ2VRdWFsaWZpZWRUeXBlLmNsYXNz
LCAicXVhbGlmaWVyIiwgTmFtZS5jbGFzcywgTUFOREFUT1JZLCBOT19DWUNMRV9SSVNLKTsgLy8k
Tk9OLU5MUy0xJAorCisJLyoqCisJICogVGhlICJhbm5vdGF0aW9ucyIgc3RydWN0dXJhbCBwcm9w
ZXJ0eSBvZiB0aGlzIG5vZGUgdHlwZSAoZWxlbWVudCB0eXBlOiB7QGxpbmsgQW5ub3RhdGlvbn0p
LgorCSAqLworCXB1YmxpYyBzdGF0aWMgZmluYWwgQ2hpbGRMaXN0UHJvcGVydHlEZXNjcmlwdG9y
IEFOTk9UQVRJT05TX1BST1BFUlRZID0KKwkJCWludGVybmFsQW5ub3RhdGlvbnNQcm9wZXJ0eUZh
Y3RvcnkoUGFja2FnZVF1YWxpZmllZFR5cGUuY2xhc3MpOworCQorCS8qKgorCSAqIFRoZSAibmFt
ZSIgc3RydWN0dXJhbCBwcm9wZXJ0eSBvZiB0aGlzIG5vZGUgdHlwZSAoY2hpbGQgdHlwZToge0Bs
aW5rIFNpbXBsZU5hbWV9KS4KKwkgKi8KKwlwdWJsaWMgc3RhdGljIGZpbmFsIENoaWxkUHJvcGVy
dHlEZXNjcmlwdG9yIE5BTUVfUFJPUEVSVFkgPQorCQluZXcgQ2hpbGRQcm9wZXJ0eURlc2NyaXB0
b3IoUGFja2FnZVF1YWxpZmllZFR5cGUuY2xhc3MsICJuYW1lIiwgU2ltcGxlTmFtZS5jbGFzcywg
TUFOREFUT1JZLCBOT19DWUNMRV9SSVNLKTsgLy8kTk9OLU5MUy0xJAorCQorCS8qKgorCSAqIEEg
bGlzdCBvZiBwcm9wZXJ0eSBkZXNjcmlwdG9ycyAoZWxlbWVudCB0eXBlOgorCSAqIHtAbGluayBT
dHJ1Y3R1cmFsUHJvcGVydHlEZXNjcmlwdG9yfSksCisJICogb3IgbnVsbCBpZiB1bmluaXRpYWxp
emVkLgorCSAqLworCXByaXZhdGUgc3RhdGljIGZpbmFsIExpc3QgUFJPUEVSVFlfREVTQ1JJUFRP
UlM7CisKKwlzdGF0aWMgeworCQlMaXN0IHByb3BlcnR5TGlzdCA9IG5ldyBBcnJheUxpc3QoNCk7
CisJCWNyZWF0ZVByb3BlcnR5TGlzdChQYWNrYWdlUXVhbGlmaWVkVHlwZS5jbGFzcywgcHJvcGVy
dHlMaXN0KTsKKwkJYWRkUHJvcGVydHkoUVVBTElGSUVSX1BST1BFUlRZLCBwcm9wZXJ0eUxpc3Qp
OworCQlhZGRQcm9wZXJ0eShBTk5PVEFUSU9OU19QUk9QRVJUWSwgcHJvcGVydHlMaXN0KTsKKwkJ
YWRkUHJvcGVydHkoTkFNRV9QUk9QRVJUWSwgcHJvcGVydHlMaXN0KTsKKwkJUFJPUEVSVFlfREVT
Q1JJUFRPUlMgPSByZWFwUHJvcGVydHlMaXN0KHByb3BlcnR5TGlzdCk7CisJfQorCisJLyoqCisJ
ICogUmV0dXJucyBhIGxpc3Qgb2Ygc3RydWN0dXJhbCBwcm9wZXJ0eSBkZXNjcmlwdG9ycyBmb3Ig
dGhpcyBub2RlIHR5cGUuCisJICogQ2xpZW50cyBtdXN0IG5vdCBtb2RpZnkgdGhlIHJlc3VsdC4K
KwkgKgorCSAqIEBwYXJhbSBhcGlMZXZlbCB0aGUgQVBJIGxldmVsOyBvbmUgb2YgdGhlCisJICog
PGNvZGU+QVNULkpMUyo8L2NvZGU+IGNvbnN0YW50cworCSAqIEByZXR1cm4gYSBsaXN0IG9mIHBy
b3BlcnR5IGRlc2NyaXB0b3JzIChlbGVtZW50IHR5cGU6CisJICoge0BsaW5rIFN0cnVjdHVyYWxQ
cm9wZXJ0eURlc2NyaXB0b3J9KQorCSAqLworCXB1YmxpYyBzdGF0aWMgTGlzdCBwcm9wZXJ0eURl
c2NyaXB0b3JzKGludCBhcGlMZXZlbCkgeworCQlyZXR1cm4gUFJPUEVSVFlfREVTQ1JJUFRPUlM7
CisJfQorCisJLyoqCisJICogVGhlIHF1YWxpZmllciBub2RlOyBsYXppbHkgaW5pdGlhbGl6ZWQ7
IGRlZmF1bHRzIHRvIAorCSAqIGFuIHVuc3BlY2lmaWVkLCBidXQgbGVnYWwsIHNpbXBsZSBuYW1l
LgorCSAqLworCXByaXZhdGUgTmFtZSBxdWFsaWZpZXIgPSBudWxsOworCisJLyoqCisJICogVGhl
IG5hbWUgYmVpbmcgcXVhbGlmaWVkOyBsYXppbHkgaW5pdGlhbGl6ZWQ7IGRlZmF1bHRzIHRvIGEg
dW5zcGVjaWZpZWQsCisJICogbGVnYWwgSmF2YSBpZGVudGlmaWVyLgorCSAqLworCXByaXZhdGUg
U2ltcGxlTmFtZSBuYW1lID0gbnVsbDsKKworCS8qKgorCSAqIENyZWF0ZXMgYSBuZXcgdW5wYXJl
bnRlZCBub2RlIGZvciBhIHBhY2thZ2UgcXVhbGlmaWVkIHR5cGUgb3duZWQgYnkgdGhlCisJICog
Z2l2ZW4gQVNULiBCeSBkZWZhdWx0LCBhbiB1bnNwZWNpZmllZCwgYnV0IGxlZ2FsLCBxdWFsaWZp
ZXIgYW5kIG5hbWUuCisJICogPHA+CisJICogTi5CLiBUaGlzIGNvbnN0cnVjdG9yIGlzIHBhY2th
Z2UtcHJpdmF0ZS4KKwkgKiA8L3A+CisJICoKKwkgKiBAcGFyYW0gYXN0IHRoZSBBU1QgdGhhdCBp
cyB0byBvd24gdGhpcyBub2RlCisJICovCisJUGFja2FnZVF1YWxpZmllZFR5cGUoQVNUIGFzdCkg
eworCQlzdXBlcihhc3QpOworCSAgICB1bnN1cHBvcnRlZEluMl8zXzQoKTsKKwl9CisKKwkvKiAo
b21pdCBqYXZhZG9jIGZvciB0aGlzIG1ldGhvZCkKKwkgKiBNZXRob2QgZGVjbGFyZWQgb24gQW5u
b3RhdGFibGVUeXBlLgorCSAqLworCUNoaWxkTGlzdFByb3BlcnR5RGVzY3JpcHRvciBpbnRlcm5h
bEFubm90YXRpb25zUHJvcGVydHkoKSB7CisJCXJldHVybiBBTk5PVEFUSU9OU19QUk9QRVJUWTsK
Kwl9CisKKwkvKiAob21pdCBqYXZhZG9jIGZvciB0aGlzIG1ldGhvZCkKKwkgKiBNZXRob2QgZGVj
bGFyZWQgb24gQVNUTm9kZS4KKwkgKi8KKwlMaXN0IGludGVybmFsU3RydWN0dXJhbFByb3BlcnRp
ZXNGb3JUeXBlKGludCBhcGlMZXZlbCkgeworCQlyZXR1cm4gcHJvcGVydHlEZXNjcmlwdG9ycyhh
cGlMZXZlbCk7CisJfQorCisJLyogKG9taXQgamF2YWRvYyBmb3IgdGhpcyBtZXRob2QpCisJICog
TWV0aG9kIGRlY2xhcmVkIG9uIEFTVE5vZGUuCisJICovCisJZmluYWwgTGlzdCBpbnRlcm5hbEdl
dENoaWxkTGlzdFByb3BlcnR5KENoaWxkTGlzdFByb3BlcnR5RGVzY3JpcHRvciBwcm9wZXJ0eSkg
eworCQlpZiAocHJvcGVydHkgPT0gQU5OT1RBVElPTlNfUFJPUEVSVFkpIHsKKwkJCXJldHVybiBh
bm5vdGF0aW9ucygpOworCQl9CisJCS8vIGFsbG93IGRlZmF1bHQgaW1wbGVtZW50YXRpb24gdG8g
ZmxhZyB0aGUgZXJyb3IKKwkJcmV0dXJuIHN1cGVyLmludGVybmFsR2V0Q2hpbGRMaXN0UHJvcGVy
dHkocHJvcGVydHkpOworCX0KKwkKKwkvKiAob21pdCBqYXZhZG9jIGZvciB0aGlzIG1ldGhvZCkK
KwkgKiBNZXRob2QgZGVjbGFyZWQgb24gQVNUTm9kZS4KKwkgKi8KKwlmaW5hbCBBU1ROb2RlIGlu
dGVybmFsR2V0U2V0Q2hpbGRQcm9wZXJ0eShDaGlsZFByb3BlcnR5RGVzY3JpcHRvciBwcm9wZXJ0
eSwgYm9vbGVhbiBnZXQsIEFTVE5vZGUgY2hpbGQpIHsKKwkJaWYgKHByb3BlcnR5ID09IFFVQUxJ
RklFUl9QUk9QRVJUWSkgeworCQkJaWYgKGdldCkgeworCQkJCXJldHVybiBnZXRRdWFsaWZpZXIo
KTsKKwkJCX0gZWxzZSB7CisJCQkJc2V0UXVhbGlmaWVyKChOYW1lKSBjaGlsZCk7CisJCQkJcmV0
dXJuIG51bGw7CisJCQl9CisJCX0KKwkJaWYgKHByb3BlcnR5ID09IE5BTUVfUFJPUEVSVFkpIHsK
KwkJCWlmIChnZXQpIHsKKwkJCQlyZXR1cm4gZ2V0TmFtZSgpOworCQkJfSBlbHNlIHsKKwkJCQlz
ZXROYW1lKChTaW1wbGVOYW1lKSBjaGlsZCk7CisJCQkJcmV0dXJuIG51bGw7CisJCQl9CisJCX0K
KwkJLy8gYWxsb3cgZGVmYXVsdCBpbXBsZW1lbnRhdGlvbiB0byBmbGFnIHRoZSBlcnJvcgorCQly
ZXR1cm4gc3VwZXIuaW50ZXJuYWxHZXRTZXRDaGlsZFByb3BlcnR5KHByb3BlcnR5LCBnZXQsIGNo
aWxkKTsKKwl9CisKKwlpbnQgZ2V0Tm9kZVR5cGUwKCkgeworCQlyZXR1cm4gUEFDS0FHRV9RVUFM
SUZJRURfVFlQRTsKKwl9CisKKwlib29sZWFuIHN1YnRyZWVNYXRjaDAoQVNUTWF0Y2hlciBtYXRj
aGVyLCBPYmplY3Qgb3RoZXIpIHsKKwkJLy8gZGlzcGF0Y2ggdG8gY29ycmVjdCBvdmVybG9hZGVk
IG1hdGNoIG1ldGhvZAorCQlyZXR1cm4gbWF0Y2hlci5tYXRjaCh0aGlzLCBvdGhlcik7CisJfQor
CisJQVNUTm9kZSBjbG9uZTAoQVNUIHRhcmdldCkgeworCQlQYWNrYWdlUXVhbGlmaWVkVHlwZSBy
ZXN1bHQgPSBuZXcgUGFja2FnZVF1YWxpZmllZFR5cGUodGFyZ2V0KTsKKwkJcmVzdWx0LnNldFNv
dXJjZVJhbmdlKGdldFN0YXJ0UG9zaXRpb24oKSwgZ2V0TGVuZ3RoKCkpOworCQlyZXN1bHQuc2V0
UXVhbGlmaWVyKChOYW1lKSAoKEFTVE5vZGUpIGdldFF1YWxpZmllcigpKS5jbG9uZSh0YXJnZXQp
KTsKKwkJcmVzdWx0LmFubm90YXRpb25zKCkuYWRkQWxsKEFTVE5vZGUuY29weVN1YnRyZWVzKHRh
cmdldCwgYW5ub3RhdGlvbnMoKSkpOworCQlyZXN1bHQuc2V0TmFtZSgoU2ltcGxlTmFtZSkgKChB
U1ROb2RlKSBnZXROYW1lKCkpLmNsb25lKHRhcmdldCkpOworCQlyZXR1cm4gcmVzdWx0OworCX0K
KworCS8qIChvbWl0IGphdmFkb2MgZm9yIHRoaXMgbWV0aG9kKQorCSAqIE1ldGhvZCBkZWNsYXJl
ZCBvbiBBU1ROb2RlLgorCSAqLworCXZvaWQgYWNjZXB0MChBU1RWaXNpdG9yIHZpc2l0b3IpIHsK
KwkJYm9vbGVhbiB2aXNpdENoaWxkcmVuID0gdmlzaXRvci52aXNpdCh0aGlzKTsKKwkJaWYgKHZp
c2l0Q2hpbGRyZW4pIHsKKwkJCS8vIHZpc2l0IGNoaWxkcmVuIGluIG5vcm1hbCBsZWZ0IHRvIHJp
Z2h0IHJlYWRpbmcgb3JkZXIKKwkJCWFjY2VwdENoaWxkKHZpc2l0b3IsIGdldFF1YWxpZmllcigp
KTsKKwkJCWFjY2VwdENoaWxkcmVuKHZpc2l0b3IsIHRoaXMuYW5ub3RhdGlvbnMpOworCQkJYWNj
ZXB0Q2hpbGQodmlzaXRvciwgZ2V0TmFtZSgpKTsKKwkJfQorCQl2aXNpdG9yLmVuZFZpc2l0KHRo
aXMpOworCX0KKworCS8qKgorCSAqIFJldHVybnMgdGhlIHF1YWxpZmllciBvZiB0aGlzIHBhY2th
Z2UgcXVhbGlmaWVkIHR5cGUuCisJICoKKwkgKiBAcmV0dXJuIHRoZSBxdWFsaWZpZXIgb2YgdGhp
cyBwYWNrYWdlIHF1YWxpZmllZCB0eXBlCisJICovCisJcHVibGljIE5hbWUgZ2V0UXVhbGlmaWVy
KCkgeworCQlpZiAodGhpcy5xdWFsaWZpZXIgPT0gbnVsbCkgeworCQkJLy8gbGF6eSBpbml0IG11
c3QgYmUgdGhyZWFkLXNhZmUgZm9yIHJlYWRlcnMKKwkJCXN5bmNocm9uaXplZCAodGhpcykgewor
CQkJCWlmICh0aGlzLnF1YWxpZmllciA9PSBudWxsKSB7CisJCQkJCXByZUxhenlJbml0KCk7CisJ
CQkJCXRoaXMucXVhbGlmaWVyID0gbmV3IFNpbXBsZU5hbWUodGhpcy5hc3QpOworCQkJCQlwb3N0
TGF6eUluaXQodGhpcy5xdWFsaWZpZXIsIFFVQUxJRklFUl9QUk9QRVJUWSk7CisJCQkJfQorCQkJ
fQorCQl9CisJCXJldHVybiB0aGlzLnF1YWxpZmllcjsKKwl9CisKKwkvKioKKwkgKiBTZXRzIHRo
ZSBxdWFsaWZpZXIgb2YgdGhpcyBwYWNrYWdlIHF1YWxpZmllZCB0eXBlIHRvIHRoZSBnaXZlbiBu
YW1lLgorCSAqCisJICogQHBhcmFtIG5hbWUgdGhlIG5ldyBxdWFsaWZpZXIgb2YgdGhpcyBwYWNr
YWdlIHF1YWxpZmllZCB0eXBlCisJICogQGV4Y2VwdGlvbiBJbGxlZ2FsQXJndW1lbnRFeGNlcHRp
b24gaWY6CisJICogPHVsPgorCSAqIDxsaT50aGUgbm9kZSBiZWxvbmdzIHRvIGEgZGlmZmVyZW50
IEFTVDwvbGk+CisJICogPGxpPnRoZSBub2RlIGFscmVhZHkgaGFzIGEgcGFyZW50PC9saT4KKwkg
KiA8L3VsPgorCSAqLworCXB1YmxpYyB2b2lkIHNldFF1YWxpZmllcihOYW1lIG5hbWUpIHsKKwkJ
aWYgKG5hbWUgPT0gbnVsbCkgeworCQkJdGhyb3cgbmV3IElsbGVnYWxBcmd1bWVudEV4Y2VwdGlv
bigpOworCQl9CisJCUFTVE5vZGUgb2xkQ2hpbGQgPSB0aGlzLnF1YWxpZmllcjsKKwkJcHJlUmVw
bGFjZUNoaWxkKG9sZENoaWxkLCBuYW1lLCBRVUFMSUZJRVJfUFJPUEVSVFkpOworCQl0aGlzLnF1
YWxpZmllciA9IG5hbWU7CisJCXBvc3RSZXBsYWNlQ2hpbGQob2xkQ2hpbGQsIG5hbWUsIFFVQUxJ
RklFUl9QUk9QRVJUWSk7CisJfQorCisJLyoqCisJICogUmV0dXJucyB0aGUgbmFtZSBwYXJ0IG9m
IHRoaXMgcGFja2FnZSBxdWFsaWZpZWQgdHlwZS4KKwkgKgorCSAqIEByZXR1cm4gdGhlIG5hbWUg
YmVpbmcgcXVhbGlmaWVkCisJICovCisJcHVibGljIFNpbXBsZU5hbWUgZ2V0TmFtZSgpIHsKKwkJ
aWYgKHRoaXMubmFtZSA9PSBudWxsKSB7CisJCQkvLyBsYXp5IGluaXQgbXVzdCBiZSB0aHJlYWQt
c2FmZSBmb3IgcmVhZGVycworCQkJc3luY2hyb25pemVkICh0aGlzKSB7CisJCQkJaWYgKHRoaXMu
bmFtZSA9PSBudWxsKSB7CisJCQkJCXByZUxhenlJbml0KCk7CisJCQkJCXRoaXMubmFtZSA9IG5l
dyBTaW1wbGVOYW1lKHRoaXMuYXN0KTsKKwkJCQkJcG9zdExhenlJbml0KHRoaXMubmFtZSwgTkFN
RV9QUk9QRVJUWSk7CisJCQkJfQorCQkJfQorCQl9CisJCXJldHVybiB0aGlzLm5hbWU7CisJfQor
CisJLyoqCisJICogU2V0cyB0aGUgbmFtZSBwYXJ0IG9mIHRoaXMgcGFja2FnZSBxdWFsaWZpZWQg
dHlwZSB0byB0aGUgZ2l2ZW4gc2ltcGxlIG5hbWUuCisJICoKKwkgKiBAcGFyYW0gbmFtZSB0aGUg
aWRlbnRpZmllciBvZiB0aGlzIHF1YWxpZmllZCBuYW1lCisJICogQGV4Y2VwdGlvbiBJbGxlZ2Fs
QXJndW1lbnRFeGNlcHRpb24gaWY6CisJICogPHVsPgorCSAqIDxsaT50aGUgbm9kZSBiZWxvbmdz
IHRvIGEgZGlmZmVyZW50IEFTVDwvbGk+CisJICogPGxpPnRoZSBub2RlIGFscmVhZHkgaGFzIGEg
cGFyZW50PC9saT4KKwkgKiA8L3VsPgorCSAqLworCXB1YmxpYyB2b2lkIHNldE5hbWUoU2ltcGxl
TmFtZSBuYW1lKSB7CisJCWlmIChuYW1lID09IG51bGwpIHsKKwkJCXRocm93IG5ldyBJbGxlZ2Fs
QXJndW1lbnRFeGNlcHRpb24oKTsKKwkJfQorCQlBU1ROb2RlIG9sZENoaWxkID0gdGhpcy5uYW1l
OworCQlwcmVSZXBsYWNlQ2hpbGQob2xkQ2hpbGQsIG5hbWUsIE5BTUVfUFJPUEVSVFkpOworCQl0
aGlzLm5hbWUgPSBuYW1lOworCQlwb3N0UmVwbGFjZUNoaWxkKG9sZENoaWxkLCBuYW1lLCBOQU1F
X1BST1BFUlRZKTsKKwl9CisKKwkvKiAob21pdCBqYXZhZG9jIGZvciB0aGlzIG1ldGhvZCkKKwkg
KiBNZXRob2QgZGVjbGFyZWQgb24gQVNUTm9kZS4KKwkgKi8KKwlpbnQgbWVtU2l6ZSgpIHsKKwkJ
Ly8gdHJlYXQgQ29kZSBhcyBmcmVlCisJCXJldHVybiBCQVNFX05PREVfU0laRSArIDIgKiA0Owor
CX0KKworCS8qIChvbWl0IGphdmFkb2MgZm9yIHRoaXMgbWV0aG9kKQorCSAqIE1ldGhvZCBkZWNs
YXJlZCBvbiBBU1ROb2RlLgorCSAqLworCWludCB0cmVlU2l6ZSgpIHsKKwkJcmV0dXJuCisJCQlt
ZW1TaXplKCkKKwkJCSsgKHRoaXMucXVhbGlmaWVyID09IG51bGwgPyAwIDogZ2V0UXVhbGlmaWVy
KCkudHJlZVNpemUoKSkKKwkJCSsgKHRoaXMuYW5ub3RhdGlvbnMgPT0gbnVsbCA/IDAgOiB0aGlz
LmFubm90YXRpb25zLmxpc3RTaXplKCkpCisJCQkrICh0aGlzLm5hbWUgPT0gbnVsbCA/IDAgOiBn
ZXROYW1lKCkudHJlZVNpemUoKSk7CisJfQorCit9CmRpZmYgLS1naXQgYS9vcmcuZWNsaXBzZS5q
ZHQuY29yZS9kb20vb3JnL2VjbGlwc2UvamR0L2NvcmUvZG9tL1R5cGUuamF2YSBiL29yZy5lY2xp
cHNlLmpkdC5jb3JlL2RvbS9vcmcvZWNsaXBzZS9qZHQvY29yZS9kb20vVHlwZS5qYXZhCmluZGV4
IGI3MjQxMTUuLmI1MTRmMWQgMTAwNjQ0Ci0tLSBhL29yZy5lY2xpcHNlLmpkdC5jb3JlL2RvbS9v
cmcvZWNsaXBzZS9qZHQvY29yZS9kb20vVHlwZS5qYXZhCisrKyBiL29yZy5lY2xpcHNlLmpkdC5j
b3JlL2RvbS9vcmcvZWNsaXBzZS9qZHQvY29yZS9kb20vVHlwZS5qYXZhCkBAIC0xMTIsNiArMTEy
LDE4IEBACiAJfQogCiAJLyoqCisJICogUmV0dXJucyB3aGV0aGVyIHRoaXMgdHlwZSBpcyBhIHBh
Y2thZ2UgcXVhbGlmaWVkIHR5cGUKKwkgKiAoe0BsaW5rIFBhY2thZ2VRdWFsaWZpZWRUeXBlfSku
CisJICoKKwkgKiBAcmV0dXJuIDxjb2RlPnRydWU8L2NvZGU+IGlmIHRoaXMgaXMgYSBwYWNrYWdl
IHF1YWxpZmllZCB0eXBlLCBhbmQKKwkgKiAgICA8Y29kZT5mYWxzZTwvY29kZT4gb3RoZXJ3aXNl
CisJICogQHNpbmNlIDMuOQorCSAqLworCXB1YmxpYyBmaW5hbCBib29sZWFuIGlzUGFja2FnZVF1
YWxpZmllZFR5cGUoKSB7CisJCXJldHVybiAodGhpcyBpbnN0YW5jZW9mIFBhY2thZ2VRdWFsaWZp
ZWRUeXBlKTsKKwl9CisKKwkvKioKIAkgKiBSZXR1cm5zIHdoZXRoZXIgdGhpcyB0eXBlIGlzIGEg
cGFyYW1ldGVyaXplZCB0eXBlCiAJICogKHtAbGluayBQYXJhbWV0ZXJpemVkVHlwZX0pLgogCSAq
CmRpZmYgLS1naXQgYS9vcmcuZWNsaXBzZS5qZHQuY29yZS9kb20vb3JnL2VjbGlwc2UvamR0L2lu
dGVybmFsL2NvcmUvZG9tL05haXZlQVNURmxhdHRlbmVyLmphdmEgYi9vcmcuZWNsaXBzZS5qZHQu
Y29yZS9kb20vb3JnL2VjbGlwc2UvamR0L2ludGVybmFsL2NvcmUvZG9tL05haXZlQVNURmxhdHRl
bmVyLmphdmEKaW5kZXggODA1OGE0YS4uMDZmM2VmMiAxMDA2NDQKLS0tIGEvb3JnLmVjbGlwc2Uu
amR0LmNvcmUvZG9tL29yZy9lY2xpcHNlL2pkdC9pbnRlcm5hbC9jb3JlL2RvbS9OYWl2ZUFTVEZs
YXR0ZW5lci5qYXZhCisrKyBiL29yZy5lY2xpcHNlLmpkdC5jb3JlL2RvbS9vcmcvZWNsaXBzZS9q
ZHQvaW50ZXJuYWwvY29yZS9kb20vTmFpdmVBU1RGbGF0dGVuZXIuamF2YQpAQCAtMTE4Nyw2ICsx
MTg3LDE4IEBACiAJfQogCiAJLyoKKwkgKiBAc2VlIEFTVFZpc2l0b3IjdmlzaXQoUGFja2FnZVF1
YWxpZmllZFR5cGUpCisJICogQHNpbmNlIDMuOQorCSAqLworCXB1YmxpYyBib29sZWFuIHZpc2l0
KFBhY2thZ2VRdWFsaWZpZWRUeXBlIG5vZGUpIHsKKwkJbm9kZS5nZXRRdWFsaWZpZXIoKS5hY2Nl
cHQodGhpcyk7CisJCXRoaXMuYnVmZmVyLmFwcGVuZCgnLicpOworCQl2aXNpdFR5cGVBbm5vdGF0
aW9ucyhub2RlKTsKKwkJbm9kZS5nZXROYW1lKCkuYWNjZXB0KHRoaXMpOworCQlyZXR1cm4gZmFs
c2U7CisJfQorCisJLyoKIAkgKiBAc2VlIEFTVFZpc2l0b3IjdmlzaXQoUGFyYW1ldGVyaXplZFR5
cGUpCiAJICogQHNpbmNlIDMuMQogCSAqLw==
</data>

          </attachment>
          <attachment
              isobsolete="1"
              ispatch="1"
              isprivate="0"
          >
            <attachid>229889</attachid>
            <date>2013-04-19 01:25:00 -0400</date>
            <delta_ts>2013-04-21 01:29:09 -0400</delta_ts>
            <desc>Proposed Patch</desc>
            <filename>Fix-for-Bug-404489---18dom-ast-Incorrect-conversion-.patch</filename>
            <type>text/plain</type>
            <size>59117</size>
            <attacher name="Manoj Palat Away Until May 11 2015">manpalat</attacher>
            
              <data encoding="base64">ZGlmZiAtLWdpdCBhL29yZy5lY2xpcHNlLmpkdC5jb3JlLnRlc3RzLm1vZGVsL3NyYy9vcmcvZWNs
aXBzZS9qZHQvY29yZS90ZXN0cy9kb20vQVNUQ29udmVydGVyMTVUZXN0LmphdmEgYi9vcmcuZWNs
aXBzZS5qZHQuY29yZS50ZXN0cy5tb2RlbC9zcmMvb3JnL2VjbGlwc2UvamR0L2NvcmUvdGVzdHMv
ZG9tL0FTVENvbnZlcnRlcjE1VGVzdC5qYXZhCmluZGV4IDljMjhjNTkuLjdlMDIxMzggMTAwNjQ0
Ci0tLSBhL29yZy5lY2xpcHNlLmpkdC5jb3JlLnRlc3RzLm1vZGVsL3NyYy9vcmcvZWNsaXBzZS9q
ZHQvY29yZS90ZXN0cy9kb20vQVNUQ29udmVydGVyMTVUZXN0LmphdmEKKysrIGIvb3JnLmVjbGlw
c2UuamR0LmNvcmUudGVzdHMubW9kZWwvc3JjL29yZy9lY2xpcHNlL2pkdC9jb3JlL3Rlc3RzL2Rv
bS9BU1RDb252ZXJ0ZXIxNVRlc3QuamF2YQpAQCAtMTE1MjcsNCArMTE1MjcsMzYgQEAKIAkJCWRl
bGV0ZVByb2plY3QoanApOwogCQl9CiAJfQorCisJLy8gaHR0cHM6Ly9idWdzLmVjbGlwc2Uub3Jn
L2J1Z3Mvc2hvd19idWcuY2dpP2lkPTQwNDQ4OQorCXB1YmxpYyB2b2lkIHRlc3RCdWc0MDQ0ODko
KSB0aHJvd3MgSmF2YU1vZGVsRXhjZXB0aW9uIHsKKwkJSUNvbXBpbGF0aW9uVW5pdCBzb3VyY2VV
bml0ID0gZ2V0Q29tcGlsYXRpb25Vbml0KCJDb252ZXJ0ZXIxOCIgLCAic3JjIiwgInRlc3Q0MDQ0
ODkuYnVnIiwgIlguamF2YSIpOyAvLyROT04tTkxTLTEkIC8vJE5PTi1OTFMtMiQgLy8kTk9OLU5M
Uy0zJCAvLyROT04tTkxTLTQkCisJCUFTVE5vZGUgcmVzdWx0ID0gcnVuQ29udmVyc2lvbih0aGlz
LmFzdC5hcGlMZXZlbCgpLCBzb3VyY2VVbml0LCB0cnVlKTsKKwkJYXNzZXJ0VHJ1ZSgiTm90IGEg
Y29tcGlsYXRpb24gdW5pdCIsIHJlc3VsdC5nZXROb2RlVHlwZSgpID09IEFTVE5vZGUuQ09NUElM
QVRJT05fVU5JVCk7CisJCUNvbXBpbGF0aW9uVW5pdCBjb21waWxhdGlvblVuaXQgPSAoQ29tcGls
YXRpb25Vbml0KSByZXN1bHQ7CisJCWFzc2VydFByb2JsZW1zU2l6ZShjb21waWxhdGlvblVuaXQs
IDApOworCQlBU1ROb2RlIG5vZGUgPSBnZXRBU1ROb2RlKGNvbXBpbGF0aW9uVW5pdCwgMCwgMCwg
MCk7CisJCVR5cGVEZWNsYXJhdGlvbiB0eXBlRGVjbGFyYXRpb24gPSAgKFR5cGVEZWNsYXJhdGlv
bikgY29tcGlsYXRpb25Vbml0LnR5cGVzKCkuZ2V0KDApOworCisJCW5vZGUgPSAoQVNUTm9kZSkg
dHlwZURlY2xhcmF0aW9uLmJvZHlEZWNsYXJhdGlvbnMoKS5nZXQoMik7CisJCWFzc2VydEVxdWFs
cygiTm90IGEgbWV0aG9kIGRlY2xhcmF0aW9uIiwgQVNUTm9kZS5NRVRIT0RfREVDTEFSQVRJT04s
IG5vZGUuZ2V0Tm9kZVR5cGUoKSk7CQkKKwkJTWV0aG9kRGVjbGFyYXRpb24gbWV0aG9kRGVjbCA9
IChNZXRob2REZWNsYXJhdGlvbikgbm9kZTsKKwkJVHlwZSB0eXBlID0gbWV0aG9kRGVjbC5nZXRS
ZXR1cm5UeXBlMigpOworCQlhc3NlcnRUcnVlKHR5cGUuaXNRdWFsaWZpZWRUeXBlKCkpOworCQlh
c3NlcnRUcnVlKGlzTWFsZm9ybWVkKHR5cGUpKTsKKworCQkvLyBwYXJhbWV0ZXIKKwkJU2luZ2xl
VmFyaWFibGVEZWNsYXJhdGlvbiBwYXJhbSA9IChTaW5nbGVWYXJpYWJsZURlY2xhcmF0aW9uKSBt
ZXRob2REZWNsLnBhcmFtZXRlcnMoKS5nZXQoMCk7CisJCXR5cGUgPSBwYXJhbS5nZXRUeXBlKCk7
CisJCWFzc2VydFRydWUodHlwZS5pc1F1YWxpZmllZFR5cGUoKSk7CisJCWFzc2VydFRydWUoaXNN
YWxmb3JtZWQodHlwZSkpOworCQkKKwkJbm9kZSA9IChBU1ROb2RlKSB0eXBlRGVjbGFyYXRpb24u
Ym9keURlY2xhcmF0aW9ucygpLmdldCgzKTsKKwkJYXNzZXJ0RXF1YWxzKCJOb3QgYSBmaWVsZCBk
ZWNsYXJhdGlvbiIsIEFTVE5vZGUuRklFTERfREVDTEFSQVRJT04sIG5vZGUuZ2V0Tm9kZVR5cGUo
KSk7CQkKKwkJRmllbGREZWNsYXJhdGlvbiBmaWVsZCA9IChGaWVsZERlY2xhcmF0aW9uKSBub2Rl
OworCQl0eXBlID0gZmllbGQuZ2V0VHlwZSgpOworCQlhc3NlcnRUcnVlKHR5cGUuaXNRdWFsaWZp
ZWRUeXBlKCkpOworCQlhc3NlcnRUcnVlKHR5cGUuaXNRdWFsaWZpZWRUeXBlKCkpOworCQlhc3Nl
cnRUcnVlKGlzTWFsZm9ybWVkKHR5cGUpKTsKKwl9CiB9ClwgTm8gbmV3bGluZSBhdCBlbmQgb2Yg
ZmlsZQpkaWZmIC0tZ2l0IGEvb3JnLmVjbGlwc2UuamR0LmNvcmUudGVzdHMubW9kZWwvc3JjL29y
Zy9lY2xpcHNlL2pkdC9jb3JlL3Rlc3RzL2RvbS9BU1RDb252ZXJ0ZXIxOFRlc3QuamF2YSBiL29y
Zy5lY2xpcHNlLmpkdC5jb3JlLnRlc3RzLm1vZGVsL3NyYy9vcmcvZWNsaXBzZS9qZHQvY29yZS90
ZXN0cy9kb20vQVNUQ29udmVydGVyMThUZXN0LmphdmEKaW5kZXggOWMxY2NhOC4uMGUwODEzMyAx
MDA2NDQKLS0tIGEvb3JnLmVjbGlwc2UuamR0LmNvcmUudGVzdHMubW9kZWwvc3JjL29yZy9lY2xp
cHNlL2pkdC9jb3JlL3Rlc3RzL2RvbS9BU1RDb252ZXJ0ZXIxOFRlc3QuamF2YQorKysgYi9vcmcu
ZWNsaXBzZS5qZHQuY29yZS50ZXN0cy5tb2RlbC9zcmMvb3JnL2VjbGlwc2UvamR0L2NvcmUvdGVz
dHMvZG9tL0FTVENvbnZlcnRlcjE4VGVzdC5qYXZhCkBAIC0xNDksMTAgKzE0OSwxMCBAQAogCQlh
c3NlcnROb3ROdWxsKGFzc2lnbm1lbnQpOwogCQlDYXN0RXhwcmVzc2lvbiBjYXN0RXhwcmVzc2lv
biA9IChDYXN0RXhwcmVzc2lvbikgYXNzaWdubWVudC5nZXRSaWdodEhhbmRTaWRlKCk7CiAJCWFz
c2VydE5vdE51bGwoY2FzdEV4cHJlc3Npb24pOwotCQlTaW1wbGVUeXBlIHNpbXBsZVR5cGUgPSAo
U2ltcGxlVHlwZSkgY2FzdEV4cHJlc3Npb24uZ2V0VHlwZSgpOwotCQlhc3NlcnROb3ROdWxsKHNp
bXBsZVR5cGUpOwotCQlhc3NlcnRFcXVhbHMoImphdmEubGFuZy5ATWFya2VyIFN0cmluZyIsIHNp
bXBsZVR5cGUudG9TdHJpbmcoKSk7Ci0JCUxpc3QgYW5ub3RhdGlvbnMgPSBzaW1wbGVUeXBlLmFu
bm90YXRpb25zKCk7CisJCVBhY2thZ2VRdWFsaWZpZWRUeXBlIHBhY2thZ2VRdWFsaWZpZWRUeXBl
ID0gKFBhY2thZ2VRdWFsaWZpZWRUeXBlKSBjYXN0RXhwcmVzc2lvbi5nZXRUeXBlKCk7CisJCWFz
c2VydE5vdE51bGwocGFja2FnZVF1YWxpZmllZFR5cGUpOworCQlhc3NlcnRFcXVhbHMoImphdmEu
bGFuZy5ATWFya2VyIFN0cmluZyIsIHBhY2thZ2VRdWFsaWZpZWRUeXBlLnRvU3RyaW5nKCkpOwor
CQlMaXN0IGFubm90YXRpb25zID0gcGFja2FnZVF1YWxpZmllZFR5cGUuYW5ub3RhdGlvbnMoKTsK
IAkJYXNzZXJ0VHJ1ZShhbm5vdGF0aW9ucy5zaXplKCkgPT0gMSk7CiAJCWFzc2VydEVxdWFscygi
QE1hcmtlciIsIGFubm90YXRpb25zLmdldCgwKS50b1N0cmluZygpKTsKIApAQCAtMTYwLDcgKzE2
MCw3IEBACiAJCVZhcmlhYmxlRGVjbGFyYXRpb25TdGF0ZW1lbnQgdmFyaWFibGVEZWNsYXJhdGlv
blN0YXRlbWVudCA9IChWYXJpYWJsZURlY2xhcmF0aW9uU3RhdGVtZW50KSBzdGF0ZW1lbnRzLmdl
dChzQ291bnQrKyk7CiAJCVR5cGUgdHlwZSA9IHZhcmlhYmxlRGVjbGFyYXRpb25TdGF0ZW1lbnQu
Z2V0VHlwZSgpOwogCQlhc3NlcnRUcnVlKHR5cGUuaXNTaW1wbGVUeXBlKCkpOwotCQlzaW1wbGVU
eXBlID0gKFNpbXBsZVR5cGUpIHR5cGU7CisJCVNpbXBsZVR5cGUgc2ltcGxlVHlwZSA9IChTaW1w
bGVUeXBlKSB0eXBlOwogCQlhc3NlcnRFcXVhbHMoIk91dGVyLklubmVyIiwgc2ltcGxlVHlwZS50
b1N0cmluZygpKTsKIAkJYW5ub3RhdGlvbnMgPSBzaW1wbGVUeXBlLmFubm90YXRpb25zKCk7CiAJ
CWFzc2VydFRydWUoYW5ub3RhdGlvbnMuc2l6ZSgpID09IDApOwpAQCAtMTY5LDIyICsxNjksMjIg
QEAKIAkJLy8gYW5ub3RhdGlvbnMuCiAJCXZhcmlhYmxlRGVjbGFyYXRpb25TdGF0ZW1lbnQgPSAo
VmFyaWFibGVEZWNsYXJhdGlvblN0YXRlbWVudCkgc3RhdGVtZW50cy5nZXQoc0NvdW50KyspOwog
CQl0eXBlID0gdmFyaWFibGVEZWNsYXJhdGlvblN0YXRlbWVudC5nZXRUeXBlKCk7Ci0JCWFzc2Vy
dFRydWUodHlwZS5pc1NpbXBsZVR5cGUoKSk7Ci0JCXNpbXBsZVR5cGUgPSAoU2ltcGxlVHlwZSkg
dHlwZTsKLQkJYXNzZXJ0Tm90TnVsbChzaW1wbGVUeXBlKTsKLQkJYXNzZXJ0RXF1YWxzKCJPdXRl
ci5ATWFya2VyMiBJbm5lciIsIHNpbXBsZVR5cGUudG9TdHJpbmcoKSk7Ci0JCWFubm90YXRpb25z
ID0gc2ltcGxlVHlwZS5hbm5vdGF0aW9ucygpOworCQlhc3NlcnRUcnVlKHR5cGUuaXNRdWFsaWZp
ZWRUeXBlKCkpOworCQlRdWFsaWZpZWRUeXBlIHF1YWxpZmllZFR5cGUgPSAoUXVhbGlmaWVkVHlw
ZSkgdHlwZTsKKwkJYXNzZXJ0Tm90TnVsbChxdWFsaWZpZWRUeXBlKTsKKwkJYXNzZXJ0RXF1YWxz
KCJPdXRlci5ATWFya2VyMiBJbm5lciIsIHF1YWxpZmllZFR5cGUudG9TdHJpbmcoKSk7CisJCWFu
bm90YXRpb25zID0gcXVhbGlmaWVkVHlwZS5hbm5vdGF0aW9ucygpOwogCQlhc3NlcnRUcnVlKGFu
bm90YXRpb25zLnNpemUoKSA9PSAxKTsKIAkJYXNzZXJ0RXF1YWxzKCJATWFya2VyMiIsIGFubm90
YXRpb25zLmdldCgwKS50b1N0cmluZygpKTsKIAogCQkvLyBjYXNlIDQgLSBNdWx0aXBsZSBsZXZl
bHMgd2l0aCBhbm5vdGF0aW9ucyBhdCB0aGUgbGFzdCBvbmx5LgogCQl2YXJpYWJsZURlY2xhcmF0
aW9uU3RhdGVtZW50ID0gKFZhcmlhYmxlRGVjbGFyYXRpb25TdGF0ZW1lbnQpIHN0YXRlbWVudHMu
Z2V0KHNDb3VudCsrKTsKIAkJdHlwZSA9IHZhcmlhYmxlRGVjbGFyYXRpb25TdGF0ZW1lbnQuZ2V0
VHlwZSgpOwotCQlhc3NlcnRUcnVlKHR5cGUuaXNTaW1wbGVUeXBlKCkpOwotCQlzaW1wbGVUeXBl
ID0gKFNpbXBsZVR5cGUpIHR5cGU7Ci0JCWFzc2VydE5vdE51bGwoc2ltcGxlVHlwZSk7Ci0JCWFz
c2VydEVxdWFscygiT3V0ZXIuSW5uZXIuQE1hcmtlcjEgRGVlcGVyIiwgc2ltcGxlVHlwZS50b1N0
cmluZygpKTsKLQkJYW5ub3RhdGlvbnMgPSBzaW1wbGVUeXBlLmFubm90YXRpb25zKCk7CisJCWFz
c2VydFRydWUodHlwZS5pc1F1YWxpZmllZFR5cGUoKSk7CisJCXF1YWxpZmllZFR5cGUgPSAoUXVh
bGlmaWVkVHlwZSkgdHlwZTsKKwkJYXNzZXJ0Tm90TnVsbChxdWFsaWZpZWRUeXBlKTsKKwkJYXNz
ZXJ0RXF1YWxzKCJPdXRlci5Jbm5lci5ATWFya2VyMSBEZWVwZXIiLCBxdWFsaWZpZWRUeXBlLnRv
U3RyaW5nKCkpOworCQlhbm5vdGF0aW9ucyA9IHF1YWxpZmllZFR5cGUuYW5ub3RhdGlvbnMoKTsK
IAkJYXNzZXJ0VHJ1ZShhbm5vdGF0aW9ucy5zaXplKCkgPT0gMSk7CiAJCWFzc2VydEVxdWFscygi
QE1hcmtlcjEiLCBhbm5vdGF0aW9ucy5nZXQoMCkudG9TdHJpbmcoKSk7CiAKQEAgLTE5Miw3ICsx
OTIsNyBAQAogCQl2YXJpYWJsZURlY2xhcmF0aW9uU3RhdGVtZW50ID0gKFZhcmlhYmxlRGVjbGFy
YXRpb25TdGF0ZW1lbnQpIHN0YXRlbWVudHMuZ2V0KHNDb3VudCsrKTsKIAkJdHlwZSA9IHZhcmlh
YmxlRGVjbGFyYXRpb25TdGF0ZW1lbnQuZ2V0VHlwZSgpOwogCQlhc3NlcnRUcnVlKHR5cGUuaXNR
dWFsaWZpZWRUeXBlKCkpOwotCQlRdWFsaWZpZWRUeXBlIHF1YWxpZmllZFR5cGUgPSAoUXVhbGlm
aWVkVHlwZSkgdHlwZTsKKwkJcXVhbGlmaWVkVHlwZSA9IChRdWFsaWZpZWRUeXBlKSB0eXBlOwog
CQlhc3NlcnROb3ROdWxsKHF1YWxpZmllZFR5cGUpOwogCQlhc3NlcnRFcXVhbHMoIk91dGVyLkBN
YXJrZXIxIElubmVyLkBNYXJrZXIyIERlZXBlciIsIHF1YWxpZmllZFR5cGUudG9TdHJpbmcoKSk7
CiAJCWFubm90YXRpb25zID0gcXVhbGlmaWVkVHlwZS5hbm5vdGF0aW9ucygpOwpAQCAtMjAxLDEw
ICsyMDEsMTAgQEAKIAkJU2ltcGxlTmFtZSBzaW1wbGVOYW1lID0gcXVhbGlmaWVkVHlwZS5nZXRO
YW1lKCk7CiAJCWFzc2VydEVxdWFscygiRGVlcGVyIiwgc2ltcGxlTmFtZS50b1N0cmluZygpKTsK
IAkJVHlwZSBxdWFsaWZpZXJUeXBlID0gcXVhbGlmaWVkVHlwZS5nZXRRdWFsaWZpZXIoKTsKLQkJ
YXNzZXJ0VHJ1ZShxdWFsaWZpZXJUeXBlLmlzU2ltcGxlVHlwZSgpKTsKLQkJc2ltcGxlVHlwZSA9
IChTaW1wbGVUeXBlKSBxdWFsaWZpZXJUeXBlOwotCQlhc3NlcnRFcXVhbHMoIk91dGVyLkBNYXJr
ZXIxIElubmVyIiwgc2ltcGxlVHlwZS50b1N0cmluZygpKTsKLQkJYW5ub3RhdGlvbnMgPSBzaW1w
bGVUeXBlLmFubm90YXRpb25zKCk7CisJCWFzc2VydFRydWUocXVhbGlmaWVyVHlwZS5pc1F1YWxp
ZmllZFR5cGUoKSk7CisJCXF1YWxpZmllZFR5cGUgPSAoUXVhbGlmaWVkVHlwZSkgcXVhbGlmaWVy
VHlwZTsKKwkJYXNzZXJ0RXF1YWxzKCJPdXRlci5ATWFya2VyMSBJbm5lciIsIHF1YWxpZmllZFR5
cGUudG9TdHJpbmcoKSk7CisJCWFubm90YXRpb25zID0gcXVhbGlmaWVkVHlwZS5hbm5vdGF0aW9u
cygpOwogCQlhc3NlcnRUcnVlKGFubm90YXRpb25zLnNpemUoKSA9PSAxKTsKIAkJYXNzZXJ0RXF1
YWxzKCJATWFya2VyMSIsIGFubm90YXRpb25zLmdldCgwKS50b1N0cmluZygpKTsKIAl9CkBAIC0z
NDIsMTAgKzM0MiwxMCBAQAogCQl0eXBlQXJndW1lbnRzID0gcGFyYW1ldHJpemVkVHlwZS50eXBl
QXJndW1lbnRzKCk7CiAJCWFzc2VydEVxdWFscygxLCB0eXBlQXJndW1lbnRzLnNpemUoKSk7CiAJ
CXR5cGUgPSAoVHlwZSkgdHlwZUFyZ3VtZW50cy5nZXQoMCk7Ci0JCWFzc2VydFRydWUodHlwZS5p
c1NpbXBsZVR5cGUoKSk7Ci0JCVNpbXBsZVR5cGUgc2ltcGxlVHlwZSA9IChTaW1wbGVUeXBlKSB0
eXBlOwotCQlhc3NlcnRFcXVhbHMoIk91dGVyLkBNYXJrZXIxIElubmVyIiwgc2ltcGxlVHlwZS50
b1N0cmluZygpKTsKLQkJTGlzdCBhbm5vdGF0aW9ucyA9IHNpbXBsZVR5cGUuYW5ub3RhdGlvbnMo
KTsKKwkJYXNzZXJ0VHJ1ZSh0eXBlLmlzUXVhbGlmaWVkVHlwZSgpKTsKKwkJUXVhbGlmaWVkVHlw
ZSBxdWFsaWZpZWRUeXBlID0gKFF1YWxpZmllZFR5cGUpIHR5cGU7CisJCWFzc2VydEVxdWFscygi
T3V0ZXIuQE1hcmtlcjEgSW5uZXIiLCBxdWFsaWZpZWRUeXBlLnRvU3RyaW5nKCkpOworCQlMaXN0
IGFubm90YXRpb25zID0gcXVhbGlmaWVkVHlwZS5hbm5vdGF0aW9ucygpOwogCQlhc3NlcnRUcnVl
KGFubm90YXRpb25zLnNpemUoKSA9PSAxKTsKIAkJQW5ub3RhdGlvbiBhbm5vdGF0aW9uID0gKEFu
bm90YXRpb24pIGFubm90YXRpb25zLmdldCgwKTsKIAkJYXNzZXJ0RXF1YWxzKCJATWFya2VyMSIs
IGFubm90YXRpb24udG9TdHJpbmcoKSk7CkBAIC0zNTksMTMgKzM1OSwxMyBAQAogCQl0eXBlID0g
KFR5cGUpIHR5cGVBcmd1bWVudHMuZ2V0KDApOwogCQlhc3NlcnRUcnVlKHR5cGUuaXNRdWFsaWZp
ZWRUeXBlKCkpOwogCQlhc3NlcnRFcXVhbHMoIkBNYXJrZXIxIE91dGVyLklubmVyIiwgdHlwZS50
b1N0cmluZygpKTsKLQkJUXVhbGlmaWVkVHlwZSBxdWFsaWZpZWRUeXBlID0gKFF1YWxpZmllZFR5
cGUpIHR5cGU7CisJCXF1YWxpZmllZFR5cGUgPSAoUXVhbGlmaWVkVHlwZSkgdHlwZTsKIAkJYXNz
ZXJ0RXF1YWxzKCJJbm5lciIsIHF1YWxpZmllZFR5cGUuZ2V0TmFtZSgpLnRvU3RyaW5nKCkpOwog
CQlhbm5vdGF0aW9ucyA9IHF1YWxpZmllZFR5cGUuYW5ub3RhdGlvbnMoKTsKIAkJYXNzZXJ0VHJ1
ZShhbm5vdGF0aW9ucy5zaXplKCkgPT0gMCk7CiAJCVR5cGUgcXVhbGlmaWVyVHlwZSA9IHF1YWxp
ZmllZFR5cGUuZ2V0UXVhbGlmaWVyKCk7CiAJCWFzc2VydFRydWUocXVhbGlmaWVyVHlwZS5pc1Np
bXBsZVR5cGUoKSk7Ci0JCXNpbXBsZVR5cGUgPSAoU2ltcGxlVHlwZSkgcXVhbGlmaWVyVHlwZTsK
KwkJU2ltcGxlVHlwZSBzaW1wbGVUeXBlID0gKFNpbXBsZVR5cGUpIHF1YWxpZmllclR5cGU7CiAJ
CWFzc2VydEVxdWFscygiQE1hcmtlcjEgT3V0ZXIiLCBzaW1wbGVUeXBlLnRvU3RyaW5nKCkpOwog
CQlhbm5vdGF0aW9ucyA9IHNpbXBsZVR5cGUuYW5ub3RhdGlvbnMoKTsKIAkJYXNzZXJ0VHJ1ZShh
bm5vdGF0aW9ucy5zaXplKCkgPT0gMSk7CkBAIC0xOTM1LDYgKzE5MzUsMzE4IEBACiAJCW1ldGhv
ZCA9IChNZXRob2REZWNsYXJhdGlvbikgdHlwZS5ib2R5RGVjbGFyYXRpb25zKCkuZ2V0KDMpOwog
CQlhc3NlcnRFcXVhbHMoIk1ldGhvZCBzaG91bGQgYmUgbWFsZm9ybWVkIiwgQVNUTm9kZS5NQUxG
T1JNRUQsIChtZXRob2QuZ2V0RmxhZ3MoKSAmIEFTVE5vZGUuTUFMRk9STUVEKSk7CiAJfQorCisJ
Ly8gaHR0cHM6Ly9idWdzLmVjbGlwc2Uub3JnL2J1Z3Mvc2hvd19idWcuY2dpP2lkPTQwNDQ4OQor
CXB1YmxpYyB2b2lkIHRlc3RCdWc0MDQ0ODlhKCkgdGhyb3dzIEphdmFNb2RlbEV4Y2VwdGlvbiB7
CisJCVN0cmluZyBjb250ZW50cyA9CisJCSJwYWNrYWdlIHRlc3Q0MDQ0ODkuYnVnO1xuIiArCisJ
CSJwdWJsaWMgY2xhc3MgWCB7IFxuIiArCisJCSIJY2xhc3MgWSB7IFxuIiArCisJCSIJCWNsYXNz
IFoge1xuIiArCisJCSIJCQlwdWJsaWMgWihAQSBYLkBCIFkgWS50aGlzKXt9XG4iICsKKwkJIgkJ
CX1cbiIgKworCQkiICAJCX1cbiIgKworCQkiICAJCU9iamVjdCBvPShAQSBYLkBCIFkuQE1hcmtl
ciAgWiludWxsO1xuIiArCisJCSIJfVxuIiArCisJCSJAamF2YS5sYW5nLmFubm90YXRpb24uVGFy
Z2V0KGphdmEubGFuZy5hbm5vdGF0aW9uLkVsZW1lbnRUeXBlLlRZUEVfVVNFKSBAaW50ZXJmYWNl
IE1hcmtlciB7fSBcbiIgKworCQkiQGphdmEubGFuZy5hbm5vdGF0aW9uLlRhcmdldChqYXZhLmxh
bmcuYW5ub3RhdGlvbi5FbGVtZW50VHlwZS5UWVBFX1VTRSkgQGludGVyZmFjZSBBIHt9IFxuIiAr
CisJCSJAamF2YS5sYW5nLmFubm90YXRpb24uVGFyZ2V0KGphdmEubGFuZy5hbm5vdGF0aW9uLkVs
ZW1lbnRUeXBlLlRZUEVfVVNFKSBAaW50ZXJmYWNlIEIge30gXG4iOworCQl0aGlzLndvcmtpbmdD
b3B5ID0gZ2V0V29ya2luZ0NvcHkoIi9Db252ZXJ0ZXIxOC9zcmMvdGVzdDQwNDQ4OS9idWcvWC5q
YXZhIiwgdHJ1ZS8qIHJlc29sdmUgKi8pOworCQlBU1ROb2RlIG5vZGUgPSBidWlsZEFTVChjb250
ZW50cywgdGhpcy53b3JraW5nQ29weSk7CisJCWFzc2VydEVxdWFscygiTm90IGEgY29tcGlsYXRp
b24gdW5pdCIsIEFTVE5vZGUuQ09NUElMQVRJT05fVU5JVCwgbm9kZS5nZXROb2RlVHlwZSgpKTsK
KwkJQ29tcGlsYXRpb25Vbml0IHVuaXQgPSAoQ29tcGlsYXRpb25Vbml0KSBub2RlOworCQlUeXBl
RGVjbGFyYXRpb24gdHlwZSA9ICAoVHlwZURlY2xhcmF0aW9uKSB1bml0LnR5cGVzKCkuZ2V0KDAp
OworCQlub2RlID0gKEFTVE5vZGUpIHR5cGUuYm9keURlY2xhcmF0aW9ucygpLmdldCgwKTsKKwkJ
YXNzZXJ0RXF1YWxzKCJOb3QgYSBUeXBlIERlY2xhcmF0aW9uIiwgQVNUTm9kZS5UWVBFX0RFQ0xB
UkFUSU9OLCBub2RlLmdldE5vZGVUeXBlKCkpOworCQlub2RlID0gKEFTVE5vZGUpICgoVHlwZURl
Y2xhcmF0aW9uKW5vZGUpLmJvZHlEZWNsYXJhdGlvbnMoKS5nZXQoMCk7CisJCWFzc2VydEVxdWFs
cygiTm90IGEgVHlwZSBEZWNsYXJhdGlvbiIsIEFTVE5vZGUuVFlQRV9ERUNMQVJBVElPTiwgbm9k
ZS5nZXROb2RlVHlwZSgpKTsKKwkJbm9kZSA9IChBU1ROb2RlKSAoKFR5cGVEZWNsYXJhdGlvbilu
b2RlKS5ib2R5RGVjbGFyYXRpb25zKCkuZ2V0KDApOwkJCisJCWFzc2VydEVxdWFscygiTm90IGEg
bWV0aG9kIERlY2xhcmF0aW9uIiwgQVNUTm9kZS5NRVRIT0RfREVDTEFSQVRJT04sIG5vZGUuZ2V0
Tm9kZVR5cGUoKSk7CisJCU1ldGhvZERlY2xhcmF0aW9uIG1ldGhvZCA9IChNZXRob2REZWNsYXJh
dGlvbikgbm9kZTsKKwkJYXNzZXJ0RXF1YWxzKCJNZXRob2Qgc2hvdWxkIG5vdCBiZSBtYWxmb3Jt
ZWQiLCAwLCAobWV0aG9kLmdldEZsYWdzKCkgJiBBU1ROb2RlLk1BTEZPUk1FRCkpOworCQlBbm5v
dGF0YWJsZVR5cGUgYW5ub3RhdGFibGVUeXBlID0gbWV0aG9kLmdldFJlY2VpdmVyVHlwZSgpOwor
CQlhc3NlcnRUcnVlKGFubm90YXRhYmxlVHlwZS5pc1F1YWxpZmllZFR5cGUoKSk7CisJCVF1YWxp
ZmllZFR5cGUgcXVhbGlmaWVkVHlwZSA9IChRdWFsaWZpZWRUeXBlKSBhbm5vdGF0YWJsZVR5cGU7
CisJCWFzc2VydEVxdWFscygid3JvbmcgcXVhbGlmaWVkIHR5cGUiLCAiQEEgWC5AQiBZIiwgcXVh
bGlmaWVkVHlwZS50b1N0cmluZygpKTsKKwkJSVR5cGVCaW5kaW5nIGJpbmRpbmcgPSBxdWFsaWZp
ZWRUeXBlLnJlc29sdmVCaW5kaW5nKCk7CisJCWFzc2VydE5vdE51bGwoIk5vIGJpbmRpbmciLCBi
aW5kaW5nKTsKKwkJYXNzZXJ0RXF1YWxzKCJXcm9uZyBxdWFsaWZpZWQgbmFtZSIsICJ0ZXN0NDA0
NDg5LmJ1Zy5YLlkiLCBiaW5kaW5nLmdldFF1YWxpZmllZE5hbWUoKSk7CisJCUxpc3QgYW5ub3Rh
dGlvbnMgPSBxdWFsaWZpZWRUeXBlLmFubm90YXRpb25zKCk7CisJCWFzc2VydFRydWUoYW5ub3Rh
dGlvbnMuc2l6ZSgpID09IDEpOworCQlNYXJrZXJBbm5vdGF0aW9uIG1hcmtlcgk9IChNYXJrZXJB
bm5vdGF0aW9uKSBhbm5vdGF0aW9ucy5nZXQoMCk7CisJCWFzc2VydEVxdWFscygid3JvbmcgYW5u
b3RhdGlvbiBuYW1lIiwgIkBCIiwgbWFya2VyLnRvU3RyaW5nKCkpOworCQliaW5kaW5nID0gbWFy
a2VyLnJlc29sdmVUeXBlQmluZGluZygpOworCQlhc3NlcnROb3ROdWxsKCJObyBiaW5kaW5nIiwg
YmluZGluZyk7CisJCWFzc2VydEVxdWFscygiV3JvbmcgcXVhbGlmaWVkIG5hbWUiLCAidGVzdDQw
NDQ4OS5idWcuQiIsIGJpbmRpbmcuZ2V0UXVhbGlmaWVkTmFtZSgpKTsKKwkJSUFubm90YXRpb25C
aW5kaW5nIGFubm90YXRpb25CaW5kaW5nID0gbWFya2VyLnJlc29sdmVBbm5vdGF0aW9uQmluZGlu
ZygpOworCQlhc3NlcnROb3ROdWxsKGFubm90YXRpb25CaW5kaW5nKTsKKwkJYXNzZXJ0RXF1YWxz
KCJ3cm9uZyBhbm5vdGF0aW9uIGJpbmRpbmciLCAiQiIsIGFubm90YXRpb25CaW5kaW5nLmdldE5h
bWUoKSk7CisJCU5hbWUgbmFtZSA9IG1hcmtlci5nZXRUeXBlTmFtZSgpOworCQlhc3NlcnRUcnVl
KG5hbWUuaXNTaW1wbGVOYW1lKCkpOworCQlTaW1wbGVOYW1lIHNpbXBsZU5hbWUgPSAoU2ltcGxl
TmFtZSkgbmFtZTsKKwkJYXNzZXJ0RXF1YWxzKCJ3cm9uZyB0eXBlIG5hbWUiLCAiQiIsIHNpbXBs
ZU5hbWUudG9TdHJpbmcoKSk7CisJCWFzc2VydEVxdWFscygid3Jvbmcgc2ltcGxlIG5hbWUiLCAi
QiIsc2ltcGxlTmFtZS5nZXRJZGVudGlmaWVyKCkpOworCQliaW5kaW5nID0gc2ltcGxlTmFtZS5y
ZXNvbHZlVHlwZUJpbmRpbmcoKTsKKwkJYXNzZXJ0Tm90TnVsbCgiTm8gYmluZGluZyIsIGJpbmRp
bmcpOworCQlhc3NlcnRFcXVhbHMoIldyb25nIHF1YWxpZmllZCBuYW1lIiwgInRlc3Q0MDQ0ODku
YnVnLkIiLCBiaW5kaW5nLmdldFF1YWxpZmllZE5hbWUoKSk7CisJCWFzc2VydFRydWUocXVhbGlm
aWVkVHlwZS5nZXRRdWFsaWZpZXIoKS5pc1NpbXBsZVR5cGUoKSk7CisJCVNpbXBsZVR5cGUgc2lt
cGxlVHlwZSA9IChTaW1wbGVUeXBlKSBxdWFsaWZpZWRUeXBlLmdldFF1YWxpZmllcigpOworCQlh
c3NlcnRFcXVhbHMoImluY29ycmVjdCB0eXBlIiwgIkBBIFgiLCBzaW1wbGVUeXBlLnRvU3RyaW5n
KCkpOworCQliaW5kaW5nID0gc2ltcGxlVHlwZS5yZXNvbHZlQmluZGluZygpOworCQlhc3NlcnRO
b3ROdWxsKCJObyBiaW5kaW5nIiwgYmluZGluZyk7CisJCWFzc2VydEVxdWFscygiV3JvbmcgcXVh
bGlmaWVkIG5hbWUiLCAidGVzdDQwNDQ4OS5idWcuWC5ZIiwgYmluZGluZy5nZXRRdWFsaWZpZWRO
YW1lKCkpOworCX0KKworCS8vIGh0dHBzOi8vYnVncy5lY2xpcHNlLm9yZy9idWdzL3Nob3dfYnVn
LmNnaT9pZD00MDQ0ODkKKwlwdWJsaWMgdm9pZCB0ZXN0QnVnNDA0NDg5YigpIHRocm93cyBKYXZh
TW9kZWxFeGNlcHRpb24geworCQlJQ29tcGlsYXRpb25Vbml0IHNvdXJjZVVuaXQgPSBnZXRDb21w
aWxhdGlvblVuaXQoIkNvbnZlcnRlcjE4IiAsICJzcmMiLCAidGVzdDQwNDQ4OS5idWciLCAiWC5q
YXZhIik7IC8vJE5PTi1OTFMtMSQgLy8kTk9OLU5MUy0yJCAvLyROT04tTkxTLTMkIC8vJE5PTi1O
TFMtNCQKKwkJQVNUTm9kZSByZXN1bHQgPSBydW5Db252ZXJzaW9uKHRoaXMuYXN0LmFwaUxldmVs
KCksIHNvdXJjZVVuaXQsIHRydWUpOworCQljaGFyW10gc291cmNlID0gc291cmNlVW5pdC5nZXRT
b3VyY2UoKS50b0NoYXJBcnJheSgpOworCQlhc3NlcnRUcnVlKCJOb3QgYSBjb21waWxhdGlvbiB1
bml0IiwgcmVzdWx0LmdldE5vZGVUeXBlKCkgPT0gQVNUTm9kZS5DT01QSUxBVElPTl9VTklUKTsK
KwkJQ29tcGlsYXRpb25Vbml0IGNvbXBpbGF0aW9uVW5pdCA9IChDb21waWxhdGlvblVuaXQpIHJl
c3VsdDsKKwkJYXNzZXJ0UHJvYmxlbXNTaXplKGNvbXBpbGF0aW9uVW5pdCwgMCk7CisJCUFTVE5v
ZGUgbm9kZSA9IGdldEFTVE5vZGUoY29tcGlsYXRpb25Vbml0LCAwLCAwLCAwKTsKKwkJVHlwZURl
Y2xhcmF0aW9uIHR5cGVEZWNsYXJhdGlvbiA9ICAoVHlwZURlY2xhcmF0aW9uKSBjb21waWxhdGlv
blVuaXQudHlwZXMoKS5nZXQoMCk7CisKKwkJbm9kZSA9IChBU1ROb2RlKSB0eXBlRGVjbGFyYXRp
b24uYm9keURlY2xhcmF0aW9ucygpLmdldCgyKTsKKwkJYXNzZXJ0RXF1YWxzKCJOb3QgYSBtZXRo
b2QgZGVjbGFyYXRpb24iLCBBU1ROb2RlLk1FVEhPRF9ERUNMQVJBVElPTiwgbm9kZS5nZXROb2Rl
VHlwZSgpKTsJCQorCQlNZXRob2REZWNsYXJhdGlvbiBtZXRob2REZWNsID0gKE1ldGhvZERlY2xh
cmF0aW9uKSBub2RlOworCQlUeXBlIHR5cGUgPSBtZXRob2REZWNsLmdldFJldHVyblR5cGUyKCk7
CisJCWFzc2VydFRydWUodHlwZS5pc1BhY2thZ2VRdWFsaWZpZWRUeXBlKCkpOworCQlQYWNrYWdl
UXVhbGlmaWVkVHlwZSBwYWNrYWdlUXVhbGlmaWVkVHlwZSA9IChQYWNrYWdlUXVhbGlmaWVkVHlw
ZSkgdHlwZTsKKwkJY2hlY2tTb3VyY2VSYW5nZShwYWNrYWdlUXVhbGlmaWVkVHlwZSwgInRlc3Q0
MDQ0ODkuYnVnLkBOb25OdWxsIElPRXhjZXB0aW9uIiwgc291cmNlKTsKKwkJSVR5cGVCaW5kaW5n
IHR5cGVCaW5kaW5nID0gcGFja2FnZVF1YWxpZmllZFR5cGUucmVzb2x2ZUJpbmRpbmcoKTsKKwkJ
YXNzZXJ0Tm90TnVsbCgibnVsbCBiaW5kaW5nIiwgdHlwZUJpbmRpbmcpOworCQlhc3NlcnRFcXVh
bHMoIm5vdCBhIHZhbGlkIGJpbmRpbmciLCAidGVzdDQwNDQ4OS5idWcuSU9FeGNlcHRpb24iLCB0
eXBlQmluZGluZy5nZXRRdWFsaWZpZWROYW1lKCkpOworCQkKKwkJLy8gcXVhbGlmaWVyIG9mIHRo
ZSBwYWNrYWdlIHF1YWxpZmllZCB0eXBlCisJCU5hbWUgbmFtZSA9IHBhY2thZ2VRdWFsaWZpZWRU
eXBlLmdldFF1YWxpZmllcigpOworCQlhc3NlcnRUcnVlKG5hbWUuaXNRdWFsaWZpZWROYW1lKCkp
OworCQlRdWFsaWZpZWROYW1lIHF1YWxpZmllZE5hbWUgPSAoUXVhbGlmaWVkTmFtZSkgbmFtZTsK
KwkJY2hlY2tTb3VyY2VSYW5nZShxdWFsaWZpZWROYW1lLCAidGVzdDQwNDQ4OS5idWciLCBzb3Vy
Y2UpOworCQl0eXBlQmluZGluZyA9IHF1YWxpZmllZE5hbWUucmVzb2x2ZVR5cGVCaW5kaW5nKCk7
CisJCWFzc2VydE51bGwodHlwZUJpbmRpbmcpOworCQlJQmluZGluZyBiaW5kaW5nID0gcXVhbGlm
aWVkTmFtZS5yZXNvbHZlQmluZGluZygpOworCQlhc3NlcnRUcnVlKCJub3QgYSBwYWNrYWdlIGJp
bmRpbmciLCBiaW5kaW5nLmdldEtpbmQoKSA9PSBJQmluZGluZy5QQUNLQUdFKTsKKwkJYXNzZXJ0
RXF1YWxzKCJ3cm9uZyBwYWNrYWdlIGJpbmRpbmciLCAicGFja2FnZSB0ZXN0NDA0NDg5LmJ1ZyIs
IGJpbmRpbmcudG9TdHJpbmcoKSk7CisJCW5hbWUgPSBxdWFsaWZpZWROYW1lLmdldFF1YWxpZmll
cigpOworCQlhc3NlcnRUcnVlKCJ3cm9uZyBuYW1lIHR5cGUiLCBuYW1lLmlzU2ltcGxlTmFtZSgp
KTsKKwkJU2ltcGxlTmFtZSBzaW1wbGVOYW1lID0gKFNpbXBsZU5hbWUpIG5hbWU7CisJCWNoZWNr
U291cmNlUmFuZ2Uoc2ltcGxlTmFtZSwgInRlc3Q0MDQ0ODkiLCBzb3VyY2UpOworCQl0eXBlQmlu
ZGluZyA9IHNpbXBsZU5hbWUucmVzb2x2ZVR5cGVCaW5kaW5nKCk7CisJCWFzc2VydE51bGwodHlw
ZUJpbmRpbmcpOworCQliaW5kaW5nID0gc2ltcGxlTmFtZS5yZXNvbHZlQmluZGluZygpOworCQlh
c3NlcnRUcnVlKCJub3QgYSBwYWNrYWdlIGJpbmRpbmciLCBiaW5kaW5nLmdldEtpbmQoKSA9PSBJ
QmluZGluZy5QQUNLQUdFKTsKKwkJYXNzZXJ0RXF1YWxzKCJ3cm9uZyBwYWNrYWdlIGJpbmRpbmci
LCAicGFja2FnZSB0ZXN0NDA0NDg5IiwgYmluZGluZy50b1N0cmluZygpKTsKKwkJc2ltcGxlTmFt
ZSA9IHF1YWxpZmllZE5hbWUuZ2V0TmFtZSgpOworCQljaGVja1NvdXJjZVJhbmdlKHNpbXBsZU5h
bWUsICJidWciLCBzb3VyY2UpOworCQl0eXBlQmluZGluZyA9IHNpbXBsZU5hbWUucmVzb2x2ZVR5
cGVCaW5kaW5nKCk7CisJCWFzc2VydE51bGwodHlwZUJpbmRpbmcpOworCQliaW5kaW5nID0gc2lt
cGxlTmFtZS5yZXNvbHZlQmluZGluZygpOworCQlhc3NlcnRUcnVlKCJub3QgYSBwYWNrYWdlIGJp
bmRpbmciLCBiaW5kaW5nLmdldEtpbmQoKSA9PSBJQmluZGluZy5QQUNLQUdFKTsKKwkJYXNzZXJ0
RXF1YWxzKCJ3cm9uZyBwYWNrYWdlIGJpbmRpbmciLCAicGFja2FnZSB0ZXN0NDA0NDg5LmJ1ZyIs
IGJpbmRpbmcudG9TdHJpbmcoKSk7CisJCQorCQkvLyBhbm5vdGF0aW9ucyBvZiBwYWNrYWdlIHF1
YWxpZmllZCB0eXBlCisJCUxpc3QgYW5ub3RhdGlvbnMgPSBwYWNrYWdlUXVhbGlmaWVkVHlwZS5h
bm5vdGF0aW9ucygpOworCQlhc3NlcnRUcnVlKGFubm90YXRpb25zLnNpemUoKSA9PSAxKTsKKwkJ
QW5ub3RhdGlvbiBhbm5vdGF0aW9uID0gKEFubm90YXRpb24pIGFubm90YXRpb25zLmdldCgwKTsK
KwkJdHlwZUJpbmRpbmcgPSBhbm5vdGF0aW9uLnJlc29sdmVUeXBlQmluZGluZygpOworCQlhc3Nl
cnROb3ROdWxsKCJudWxsIGJpbmRpbmciLCB0eXBlQmluZGluZyk7CisJCWFzc2VydEVxdWFscygi
bm90IGEgdmFsaWQgYmluZGluZyIsICJ0ZXN0NDA0NDg5LmJ1Zy5YLk5vbk51bGwiLCB0eXBlQmlu
ZGluZy5nZXRRdWFsaWZpZWROYW1lKCkpOworCQlJQW5ub3RhdGlvbkJpbmRpbmcgYW5ub3RhdGlv
bkJpbmRpbmcgPSBhbm5vdGF0aW9uLnJlc29sdmVBbm5vdGF0aW9uQmluZGluZygpOworCQlhc3Nl
cnRFcXVhbHMoIm5vdCBhIHZhbGlkIGFubm90YXRpb24gYmluZGluZyIsICJATm9uTnVsbCgpIiwg
YW5ub3RhdGlvbkJpbmRpbmcudG9TdHJpbmcoKSk7CisJCW5hbWUgPSBhbm5vdGF0aW9uLmdldFR5
cGVOYW1lKCk7CisJCWFzc2VydFRydWUobmFtZS5pc1NpbXBsZU5hbWUoKSk7CisJCXNpbXBsZU5h
bWUgPSAoU2ltcGxlTmFtZSkgbmFtZTsKKwkJdHlwZUJpbmRpbmcgPSBzaW1wbGVOYW1lLnJlc29s
dmVUeXBlQmluZGluZygpOworCQljaGVja1NvdXJjZVJhbmdlKHNpbXBsZU5hbWUsICJOb25OdWxs
Iiwgc291cmNlKTsKKwkJYXNzZXJ0Tm90TnVsbCh0eXBlQmluZGluZyk7CisJCQorCQkvLyBuYW1l
IG9mIHRoZSBwYWNrYWdlIHF1YWxpZmllZCB0eXBlCisJCXNpbXBsZU5hbWUgPSBwYWNrYWdlUXVh
bGlmaWVkVHlwZS5nZXROYW1lKCk7CisJCWNoZWNrU291cmNlUmFuZ2Uoc2ltcGxlTmFtZSwgIklP
RXhjZXB0aW9uIiwgc291cmNlKTsKKwkJdHlwZUJpbmRpbmcgPSBzaW1wbGVOYW1lLnJlc29sdmVU
eXBlQmluZGluZygpOworCQlhc3NlcnROb3ROdWxsKHR5cGVCaW5kaW5nKTsKKwkJCisJCS8vIHBh
cmFtZXRlcgorCQlTaW5nbGVWYXJpYWJsZURlY2xhcmF0aW9uIHBhcmFtID0gKFNpbmdsZVZhcmlh
YmxlRGVjbGFyYXRpb24pIG1ldGhvZERlY2wucGFyYW1ldGVycygpLmdldCgwKTsKKwkJdHlwZSA9
IHBhcmFtLmdldFR5cGUoKTsKKwkJYXNzZXJ0VHJ1ZSh0eXBlLmlzUGFja2FnZVF1YWxpZmllZFR5
cGUoKSk7CisJCXBhY2thZ2VRdWFsaWZpZWRUeXBlID0gKFBhY2thZ2VRdWFsaWZpZWRUeXBlKSB0
eXBlOworCQljaGVja1NvdXJjZVJhbmdlKHBhY2thZ2VRdWFsaWZpZWRUeXBlLCAidGVzdDQwNDQ4
OS5idWcuQE5vbk51bGwgRmlsZU5vdEZvdW5kRXhjZXB0aW9uIiwgc291cmNlKTsKKwkJdHlwZUJp
bmRpbmcgPSBwYWNrYWdlUXVhbGlmaWVkVHlwZS5yZXNvbHZlQmluZGluZygpOworCQlhc3NlcnRO
b3ROdWxsKCJudWxsIGJpbmRpbmciLCB0eXBlQmluZGluZyk7CisJCWFzc2VydEVxdWFscygibm90
IGEgdmFsaWQgYmluZGluZyIsICJ0ZXN0NDA0NDg5LmJ1Zy5GaWxlTm90Rm91bmRFeGNlcHRpb24i
LCB0eXBlQmluZGluZy5nZXRRdWFsaWZpZWROYW1lKCkpOworCQkKKwkJLy8gcXVhbGlmaWVyIG9m
IHRoZSBwYWNrYWdlIHF1YWxpZmllZCB0eXBlCisJCW5hbWUgPSBwYWNrYWdlUXVhbGlmaWVkVHlw
ZS5nZXRRdWFsaWZpZXIoKTsKKwkJYXNzZXJ0VHJ1ZShuYW1lLmlzUXVhbGlmaWVkTmFtZSgpKTsK
KwkJcXVhbGlmaWVkTmFtZSA9IChRdWFsaWZpZWROYW1lKSBuYW1lOworCQljaGVja1NvdXJjZVJh
bmdlKHF1YWxpZmllZE5hbWUsICJ0ZXN0NDA0NDg5LmJ1ZyIsIHNvdXJjZSk7CisJCXR5cGVCaW5k
aW5nID0gcXVhbGlmaWVkTmFtZS5yZXNvbHZlVHlwZUJpbmRpbmcoKTsKKwkJYXNzZXJ0TnVsbCh0
eXBlQmluZGluZyk7CisJCWJpbmRpbmcgPSBxdWFsaWZpZWROYW1lLnJlc29sdmVCaW5kaW5nKCk7
CisJCWFzc2VydFRydWUoIm5vdCBhIHBhY2thZ2UgYmluZGluZyIsIGJpbmRpbmcuZ2V0S2luZCgp
ID09IElCaW5kaW5nLlBBQ0tBR0UpOworCQlhc3NlcnRFcXVhbHMoIndyb25nIHBhY2thZ2UgYmlu
ZGluZyIsICJwYWNrYWdlIHRlc3Q0MDQ0ODkuYnVnIiwgYmluZGluZy50b1N0cmluZygpKTsKKwkJ
bmFtZSA9IHF1YWxpZmllZE5hbWUuZ2V0UXVhbGlmaWVyKCk7CisJCWFzc2VydFRydWUoIndyb25n
IG5hbWUgdHlwZSIsIG5hbWUuaXNTaW1wbGVOYW1lKCkpOworCQlzaW1wbGVOYW1lID0gKFNpbXBs
ZU5hbWUpIG5hbWU7CisJCWNoZWNrU291cmNlUmFuZ2Uoc2ltcGxlTmFtZSwgInRlc3Q0MDQ0ODki
LCBzb3VyY2UpOworCQl0eXBlQmluZGluZyA9IHNpbXBsZU5hbWUucmVzb2x2ZVR5cGVCaW5kaW5n
KCk7CisJCWFzc2VydE51bGwodHlwZUJpbmRpbmcpOworCQliaW5kaW5nID0gc2ltcGxlTmFtZS5y
ZXNvbHZlQmluZGluZygpOworCQlhc3NlcnRUcnVlKCJub3QgYSBwYWNrYWdlIGJpbmRpbmciLCBi
aW5kaW5nLmdldEtpbmQoKSA9PSBJQmluZGluZy5QQUNLQUdFKTsKKwkJYXNzZXJ0RXF1YWxzKCJ3
cm9uZyBwYWNrYWdlIGJpbmRpbmciLCAicGFja2FnZSB0ZXN0NDA0NDg5IiwgYmluZGluZy50b1N0
cmluZygpKTsKKwkJc2ltcGxlTmFtZSA9IHF1YWxpZmllZE5hbWUuZ2V0TmFtZSgpOworCQljaGVj
a1NvdXJjZVJhbmdlKHNpbXBsZU5hbWUsICJidWciLCBzb3VyY2UpOworCQl0eXBlQmluZGluZyA9
IHNpbXBsZU5hbWUucmVzb2x2ZVR5cGVCaW5kaW5nKCk7CisJCWFzc2VydE51bGwodHlwZUJpbmRp
bmcpOworCQliaW5kaW5nID0gc2ltcGxlTmFtZS5yZXNvbHZlQmluZGluZygpOworCQlhc3NlcnRU
cnVlKCJub3QgYSBwYWNrYWdlIGJpbmRpbmciLCBiaW5kaW5nLmdldEtpbmQoKSA9PSBJQmluZGlu
Zy5QQUNLQUdFKTsKKwkJYXNzZXJ0RXF1YWxzKCJ3cm9uZyBwYWNrYWdlIGJpbmRpbmciLCAicGFj
a2FnZSB0ZXN0NDA0NDg5LmJ1ZyIsIGJpbmRpbmcudG9TdHJpbmcoKSk7CisJCQorCQkvLyBhbm5v
dGF0aW9ucyBvZiBwYWNrYWdlIHF1YWxpZmllZCB0eXBlCisJCWFubm90YXRpb25zID0gcGFja2Fn
ZVF1YWxpZmllZFR5cGUuYW5ub3RhdGlvbnMoKTsKKwkJYXNzZXJ0VHJ1ZShhbm5vdGF0aW9ucy5z
aXplKCkgPT0gMSk7CisJCWFubm90YXRpb24gPSAoQW5ub3RhdGlvbikgYW5ub3RhdGlvbnMuZ2V0
KDApOworCQl0eXBlQmluZGluZyA9IGFubm90YXRpb24ucmVzb2x2ZVR5cGVCaW5kaW5nKCk7CisJ
CWFzc2VydE5vdE51bGwoIm51bGwgYmluZGluZyIsIHR5cGVCaW5kaW5nKTsKKwkJYXNzZXJ0RXF1
YWxzKCJub3QgYSB2YWxpZCBiaW5kaW5nIiwgInRlc3Q0MDQ0ODkuYnVnLlguTm9uTnVsbCIsIHR5
cGVCaW5kaW5nLmdldFF1YWxpZmllZE5hbWUoKSk7CisJCWFubm90YXRpb25CaW5kaW5nID0gYW5u
b3RhdGlvbi5yZXNvbHZlQW5ub3RhdGlvbkJpbmRpbmcoKTsKKwkJYXNzZXJ0RXF1YWxzKCJub3Qg
YSB2YWxpZCBhbm5vdGF0aW9uIGJpbmRpbmciLCAiQE5vbk51bGwoKSIsIGFubm90YXRpb25CaW5k
aW5nLnRvU3RyaW5nKCkpOworCQluYW1lID0gYW5ub3RhdGlvbi5nZXRUeXBlTmFtZSgpOworCQlh
c3NlcnRUcnVlKG5hbWUuaXNTaW1wbGVOYW1lKCkpOworCQlzaW1wbGVOYW1lID0gKFNpbXBsZU5h
bWUpIG5hbWU7CisJCXR5cGVCaW5kaW5nID0gc2ltcGxlTmFtZS5yZXNvbHZlVHlwZUJpbmRpbmco
KTsKKwkJY2hlY2tTb3VyY2VSYW5nZShzaW1wbGVOYW1lLCAiTm9uTnVsbCIsIHNvdXJjZSk7CisJ
CWFzc2VydE5vdE51bGwodHlwZUJpbmRpbmcpOworCQkKKwkJLy8gbmFtZSBvZiB0aGUgcGFja2Fn
ZSBxdWFsaWZpZWQgdHlwZQorCQlzaW1wbGVOYW1lID0gcGFja2FnZVF1YWxpZmllZFR5cGUuZ2V0
TmFtZSgpOworCQljaGVja1NvdXJjZVJhbmdlKHNpbXBsZU5hbWUsICJGaWxlTm90Rm91bmRFeGNl
cHRpb24iLCBzb3VyY2UpOworCQl0eXBlQmluZGluZyA9IHNpbXBsZU5hbWUucmVzb2x2ZVR5cGVC
aW5kaW5nKCk7CisJCWFzc2VydE5vdE51bGwodHlwZUJpbmRpbmcpOworCQkKKwkJLy8gdGhyb3dz
CisJCXR5cGUgPSAoVHlwZSkgbWV0aG9kRGVjbC50aHJvd25FeGNlcHRpb25UeXBlcygpLmdldCgw
KTsKKwkJYXNzZXJ0VHJ1ZSh0eXBlLmlzUGFja2FnZVF1YWxpZmllZFR5cGUoKSk7CisJCXBhY2th
Z2VRdWFsaWZpZWRUeXBlID0gKFBhY2thZ2VRdWFsaWZpZWRUeXBlKSB0eXBlOworCQljaGVja1Nv
dXJjZVJhbmdlKHBhY2thZ2VRdWFsaWZpZWRUeXBlLCAidGVzdDQwNDQ4OS5idWcuQE5vbk51bGwg
RU9GRXhjZXB0aW9uIiwgc291cmNlKTsKKwkJdHlwZUJpbmRpbmcgPSBwYWNrYWdlUXVhbGlmaWVk
VHlwZS5yZXNvbHZlQmluZGluZygpOworCQlhc3NlcnROb3ROdWxsKCJudWxsIGJpbmRpbmciLCB0
eXBlQmluZGluZyk7CisJCWFzc2VydEVxdWFscygibm90IGEgdmFsaWQgYmluZGluZyIsICJ0ZXN0
NDA0NDg5LmJ1Zy5FT0ZFeGNlcHRpb24iLCB0eXBlQmluZGluZy5nZXRRdWFsaWZpZWROYW1lKCkp
OworCQkKKwkJLy8gcXVhbGlmaWVyIG9mIHRoZSBwYWNrYWdlIHF1YWxpZmllZCB0eXBlCisJCW5h
bWUgPSBwYWNrYWdlUXVhbGlmaWVkVHlwZS5nZXRRdWFsaWZpZXIoKTsKKwkJYXNzZXJ0VHJ1ZShu
YW1lLmlzUXVhbGlmaWVkTmFtZSgpKTsKKwkJcXVhbGlmaWVkTmFtZSA9IChRdWFsaWZpZWROYW1l
KSBuYW1lOworCQljaGVja1NvdXJjZVJhbmdlKHF1YWxpZmllZE5hbWUsICJ0ZXN0NDA0NDg5LmJ1
ZyIsIHNvdXJjZSk7CisJCXR5cGVCaW5kaW5nID0gcXVhbGlmaWVkTmFtZS5yZXNvbHZlVHlwZUJp
bmRpbmcoKTsKKwkJYXNzZXJ0TnVsbCh0eXBlQmluZGluZyk7CisJCWJpbmRpbmcgPSBxdWFsaWZp
ZWROYW1lLnJlc29sdmVCaW5kaW5nKCk7CisJCWFzc2VydFRydWUoIm5vdCBhIHBhY2thZ2UgYmlu
ZGluZyIsIGJpbmRpbmcuZ2V0S2luZCgpID09IElCaW5kaW5nLlBBQ0tBR0UpOworCQlhc3NlcnRF
cXVhbHMoIndyb25nIHBhY2thZ2UgYmluZGluZyIsICJwYWNrYWdlIHRlc3Q0MDQ0ODkuYnVnIiwg
YmluZGluZy50b1N0cmluZygpKTsKKwkJbmFtZSA9IHF1YWxpZmllZE5hbWUuZ2V0UXVhbGlmaWVy
KCk7CisJCWFzc2VydFRydWUoIndyb25nIG5hbWUgdHlwZSIsIG5hbWUuaXNTaW1wbGVOYW1lKCkp
OworCQlzaW1wbGVOYW1lID0gKFNpbXBsZU5hbWUpIG5hbWU7CisJCWNoZWNrU291cmNlUmFuZ2Uo
c2ltcGxlTmFtZSwgInRlc3Q0MDQ0ODkiLCBzb3VyY2UpOworCQl0eXBlQmluZGluZyA9IHNpbXBs
ZU5hbWUucmVzb2x2ZVR5cGVCaW5kaW5nKCk7CisJCWFzc2VydE51bGwodHlwZUJpbmRpbmcpOwor
CQliaW5kaW5nID0gc2ltcGxlTmFtZS5yZXNvbHZlQmluZGluZygpOworCQlhc3NlcnRUcnVlKCJu
b3QgYSBwYWNrYWdlIGJpbmRpbmciLCBiaW5kaW5nLmdldEtpbmQoKSA9PSBJQmluZGluZy5QQUNL
QUdFKTsKKwkJYXNzZXJ0RXF1YWxzKCJ3cm9uZyBwYWNrYWdlIGJpbmRpbmciLCAicGFja2FnZSB0
ZXN0NDA0NDg5IiwgYmluZGluZy50b1N0cmluZygpKTsKKwkJc2ltcGxlTmFtZSA9IHF1YWxpZmll
ZE5hbWUuZ2V0TmFtZSgpOworCQljaGVja1NvdXJjZVJhbmdlKHNpbXBsZU5hbWUsICJidWciLCBz
b3VyY2UpOworCQl0eXBlQmluZGluZyA9IHNpbXBsZU5hbWUucmVzb2x2ZVR5cGVCaW5kaW5nKCk7
CisJCWFzc2VydE51bGwodHlwZUJpbmRpbmcpOworCQliaW5kaW5nID0gc2ltcGxlTmFtZS5yZXNv
bHZlQmluZGluZygpOworCQlhc3NlcnRUcnVlKCJub3QgYSBwYWNrYWdlIGJpbmRpbmciLCBiaW5k
aW5nLmdldEtpbmQoKSA9PSBJQmluZGluZy5QQUNLQUdFKTsKKwkJYXNzZXJ0RXF1YWxzKCJ3cm9u
ZyBwYWNrYWdlIGJpbmRpbmciLCAicGFja2FnZSB0ZXN0NDA0NDg5LmJ1ZyIsIGJpbmRpbmcudG9T
dHJpbmcoKSk7CisJCQorCQkvLyBhbm5vdGF0aW9ucyBvZiBwYWNrYWdlIHF1YWxpZmllZCB0eXBl
CisJCWFubm90YXRpb25zID0gcGFja2FnZVF1YWxpZmllZFR5cGUuYW5ub3RhdGlvbnMoKTsKKwkJ
YXNzZXJ0VHJ1ZShhbm5vdGF0aW9ucy5zaXplKCkgPT0gMSk7CisJCWFubm90YXRpb24gPSAoQW5u
b3RhdGlvbikgYW5ub3RhdGlvbnMuZ2V0KDApOworCQl0eXBlQmluZGluZyA9IGFubm90YXRpb24u
cmVzb2x2ZVR5cGVCaW5kaW5nKCk7CisJCWFzc2VydE5vdE51bGwoIm51bGwgYmluZGluZyIsIHR5
cGVCaW5kaW5nKTsKKwkJYXNzZXJ0RXF1YWxzKCJub3QgYSB2YWxpZCBiaW5kaW5nIiwgInRlc3Q0
MDQ0ODkuYnVnLlguTm9uTnVsbCIsIHR5cGVCaW5kaW5nLmdldFF1YWxpZmllZE5hbWUoKSk7CisJ
CWFubm90YXRpb25CaW5kaW5nID0gYW5ub3RhdGlvbi5yZXNvbHZlQW5ub3RhdGlvbkJpbmRpbmco
KTsKKwkJYXNzZXJ0RXF1YWxzKCJub3QgYSB2YWxpZCBhbm5vdGF0aW9uIGJpbmRpbmciLCAiQE5v
bk51bGwoKSIsIGFubm90YXRpb25CaW5kaW5nLnRvU3RyaW5nKCkpOworCQluYW1lID0gYW5ub3Rh
dGlvbi5nZXRUeXBlTmFtZSgpOworCQlhc3NlcnRUcnVlKG5hbWUuaXNTaW1wbGVOYW1lKCkpOwor
CQlzaW1wbGVOYW1lID0gKFNpbXBsZU5hbWUpIG5hbWU7CisJCXR5cGVCaW5kaW5nID0gc2ltcGxl
TmFtZS5yZXNvbHZlVHlwZUJpbmRpbmcoKTsKKwkJY2hlY2tTb3VyY2VSYW5nZShzaW1wbGVOYW1l
LCAiTm9uTnVsbCIsIHNvdXJjZSk7CisJCWFzc2VydE5vdE51bGwodHlwZUJpbmRpbmcpOworCQkK
KwkJLy8gbmFtZSBvZiB0aGUgcGFja2FnZSBxdWFsaWZpZWQgdHlwZQorCQlzaW1wbGVOYW1lID0g
cGFja2FnZVF1YWxpZmllZFR5cGUuZ2V0TmFtZSgpOworCQljaGVja1NvdXJjZVJhbmdlKHNpbXBs
ZU5hbWUsICJFT0ZFeGNlcHRpb24iLCBzb3VyY2UpOworCQl0eXBlQmluZGluZyA9IHNpbXBsZU5h
bWUucmVzb2x2ZVR5cGVCaW5kaW5nKCk7CisJCWFzc2VydE5vdE51bGwodHlwZUJpbmRpbmcpOwor
CisJCW5vZGUgPSAoQVNUTm9kZSkgdHlwZURlY2xhcmF0aW9uLmJvZHlEZWNsYXJhdGlvbnMoKS5n
ZXQoMyk7CisJCWFzc2VydEVxdWFscygiTm90IGEgZmllbGQgZGVjbGFyYXRpb24iLCBBU1ROb2Rl
LkZJRUxEX0RFQ0xBUkFUSU9OLCBub2RlLmdldE5vZGVUeXBlKCkpOwkJCisJCUZpZWxkRGVjbGFy
YXRpb24gZmllbGQgPSAoRmllbGREZWNsYXJhdGlvbikgbm9kZTsKKwkJdHlwZSA9IGZpZWxkLmdl
dFR5cGUoKTsKKwkJYXNzZXJ0VHJ1ZSh0eXBlLmlzUXVhbGlmaWVkVHlwZSgpKTsKKwkJUXVhbGlm
aWVkVHlwZSBxdWFsaWZpZWRUeXBlID0gKFF1YWxpZmllZFR5cGUpIHR5cGU7CisJCXBhY2thZ2VR
dWFsaWZpZWRUeXBlID0gKFBhY2thZ2VRdWFsaWZpZWRUeXBlKXF1YWxpZmllZFR5cGUuZ2V0UXVh
bGlmaWVyKCk7CisJCWNoZWNrU291cmNlUmFuZ2UocGFja2FnZVF1YWxpZmllZFR5cGUsICJ0ZXN0
NDA0NDg5LmJ1Zy5ATm9uTnVsbCBYIiwgc291cmNlKTsKKwkJdHlwZUJpbmRpbmcgPSBwYWNrYWdl
UXVhbGlmaWVkVHlwZS5yZXNvbHZlQmluZGluZygpOworCQlhc3NlcnROb3ROdWxsKCJudWxsIGJp
bmRpbmciLCB0eXBlQmluZGluZyk7CisJCWFzc2VydEVxdWFscygibm90IGEgdmFsaWQgYmluZGlu
ZyIsICJ0ZXN0NDA0NDg5LmJ1Zy5YLklubmVyIiwgdHlwZUJpbmRpbmcuZ2V0UXVhbGlmaWVkTmFt
ZSgpKTsKKwkJCisJCS8vIHF1YWxpZmllciBvZiB0aGUgcGFja2FnZSBxdWFsaWZpZWQgdHlwZQor
CQluYW1lID0gcGFja2FnZVF1YWxpZmllZFR5cGUuZ2V0UXVhbGlmaWVyKCk7CisJCWFzc2VydFRy
dWUobmFtZS5pc1F1YWxpZmllZE5hbWUoKSk7CisJCXF1YWxpZmllZE5hbWUgPSAoUXVhbGlmaWVk
TmFtZSkgbmFtZTsKKwkJY2hlY2tTb3VyY2VSYW5nZShxdWFsaWZpZWROYW1lLCAidGVzdDQwNDQ4
OS5idWciLCBzb3VyY2UpOworCQl0eXBlQmluZGluZyA9IHF1YWxpZmllZE5hbWUucmVzb2x2ZVR5
cGVCaW5kaW5nKCk7CisJCWFzc2VydE51bGwodHlwZUJpbmRpbmcpOworCQliaW5kaW5nID0gcXVh
bGlmaWVkTmFtZS5yZXNvbHZlQmluZGluZygpOworCQlhc3NlcnRUcnVlKCJub3QgYSBwYWNrYWdl
IGJpbmRpbmciLCBiaW5kaW5nLmdldEtpbmQoKSA9PSBJQmluZGluZy5QQUNLQUdFKTsKKwkJYXNz
ZXJ0RXF1YWxzKCJ3cm9uZyBwYWNrYWdlIGJpbmRpbmciLCAicGFja2FnZSB0ZXN0NDA0NDg5LmJ1
ZyIsIGJpbmRpbmcudG9TdHJpbmcoKSk7CisJCW5hbWUgPSBxdWFsaWZpZWROYW1lLmdldFF1YWxp
ZmllcigpOworCQlhc3NlcnRUcnVlKCJ3cm9uZyBuYW1lIHR5cGUiLCBuYW1lLmlzU2ltcGxlTmFt
ZSgpKTsKKwkJc2ltcGxlTmFtZSA9IChTaW1wbGVOYW1lKSBuYW1lOworCQljaGVja1NvdXJjZVJh
bmdlKHNpbXBsZU5hbWUsICJ0ZXN0NDA0NDg5Iiwgc291cmNlKTsKKwkJdHlwZUJpbmRpbmcgPSBz
aW1wbGVOYW1lLnJlc29sdmVUeXBlQmluZGluZygpOworCQlhc3NlcnROdWxsKHR5cGVCaW5kaW5n
KTsKKwkJYmluZGluZyA9IHNpbXBsZU5hbWUucmVzb2x2ZUJpbmRpbmcoKTsKKwkJYXNzZXJ0VHJ1
ZSgibm90IGEgcGFja2FnZSBiaW5kaW5nIiwgYmluZGluZy5nZXRLaW5kKCkgPT0gSUJpbmRpbmcu
UEFDS0FHRSk7CisJCWFzc2VydEVxdWFscygid3JvbmcgcGFja2FnZSBiaW5kaW5nIiwgInBhY2th
Z2UgdGVzdDQwNDQ4OSIsIGJpbmRpbmcudG9TdHJpbmcoKSk7CisJCXNpbXBsZU5hbWUgPSBxdWFs
aWZpZWROYW1lLmdldE5hbWUoKTsKKwkJY2hlY2tTb3VyY2VSYW5nZShzaW1wbGVOYW1lLCAiYnVn
Iiwgc291cmNlKTsKKwkJdHlwZUJpbmRpbmcgPSBzaW1wbGVOYW1lLnJlc29sdmVUeXBlQmluZGlu
ZygpOworCQlhc3NlcnROdWxsKHR5cGVCaW5kaW5nKTsKKwkJYmluZGluZyA9IHNpbXBsZU5hbWUu
cmVzb2x2ZUJpbmRpbmcoKTsKKwkJYXNzZXJ0VHJ1ZSgibm90IGEgcGFja2FnZSBiaW5kaW5nIiwg
YmluZGluZy5nZXRLaW5kKCkgPT0gSUJpbmRpbmcuUEFDS0FHRSk7CisJCWFzc2VydEVxdWFscygi
d3JvbmcgcGFja2FnZSBiaW5kaW5nIiwgInBhY2thZ2UgdGVzdDQwNDQ4OS5idWciLCBiaW5kaW5n
LnRvU3RyaW5nKCkpOworCQkKKwkJLy8gYW5ub3RhdGlvbnMgb2YgcGFja2FnZSBxdWFsaWZpZWQg
dHlwZQorCQlhbm5vdGF0aW9ucyA9IHBhY2thZ2VRdWFsaWZpZWRUeXBlLmFubm90YXRpb25zKCk7
CisJCWFzc2VydFRydWUoYW5ub3RhdGlvbnMuc2l6ZSgpID09IDEpOworCQlhbm5vdGF0aW9uID0g
KEFubm90YXRpb24pIGFubm90YXRpb25zLmdldCgwKTsKKwkJdHlwZUJpbmRpbmcgPSBhbm5vdGF0
aW9uLnJlc29sdmVUeXBlQmluZGluZygpOworCQlhc3NlcnROb3ROdWxsKCJudWxsIGJpbmRpbmci
LCB0eXBlQmluZGluZyk7CisJCWFzc2VydEVxdWFscygibm90IGEgdmFsaWQgYmluZGluZyIsICJ0
ZXN0NDA0NDg5LmJ1Zy5YLk5vbk51bGwiLCB0eXBlQmluZGluZy5nZXRRdWFsaWZpZWROYW1lKCkp
OworCQlhbm5vdGF0aW9uQmluZGluZyA9IGFubm90YXRpb24ucmVzb2x2ZUFubm90YXRpb25CaW5k
aW5nKCk7CisJCWFzc2VydEVxdWFscygibm90IGEgdmFsaWQgYW5ub3RhdGlvbiBiaW5kaW5nIiwg
IkBOb25OdWxsKCkiLCBhbm5vdGF0aW9uQmluZGluZy50b1N0cmluZygpKTsKKwkJbmFtZSA9IGFu
bm90YXRpb24uZ2V0VHlwZU5hbWUoKTsKKwkJYXNzZXJ0VHJ1ZShuYW1lLmlzU2ltcGxlTmFtZSgp
KTsKKwkJc2ltcGxlTmFtZSA9IChTaW1wbGVOYW1lKSBuYW1lOworCQl0eXBlQmluZGluZyA9IHNp
bXBsZU5hbWUucmVzb2x2ZVR5cGVCaW5kaW5nKCk7CisJCWNoZWNrU291cmNlUmFuZ2Uoc2ltcGxl
TmFtZSwgIk5vbk51bGwiLCBzb3VyY2UpOworCQlhc3NlcnROb3ROdWxsKHR5cGVCaW5kaW5nKTsK
KwkJCisJCS8vIG5hbWUgb2YgdGhlIHBhY2thZ2UgcXVhbGlmaWVkIHR5cGUKKwkJc2ltcGxlTmFt
ZSA9IHBhY2thZ2VRdWFsaWZpZWRUeXBlLmdldE5hbWUoKTsKKwkJY2hlY2tTb3VyY2VSYW5nZShz
aW1wbGVOYW1lLCAiWCIsIHNvdXJjZSk7CisJCXR5cGVCaW5kaW5nID0gc2ltcGxlTmFtZS5yZXNv
bHZlVHlwZUJpbmRpbmcoKTsKKwkJYXNzZXJ0Tm90TnVsbCh0eXBlQmluZGluZyk7CisJCQorCX0K
IAkvLyBodHRwczovL2J1Z3MuZWNsaXBzZS5vcmcvYnVncy9zaG93X2J1Zy5jZ2k/aWQ9Mzk5Nzky
CiAJcHVibGljIHZvaWQgdGVzdEJ1ZzM5OTc5MigpIHRocm93cyBKYXZhTW9kZWxFeGNlcHRpb24g
ewogCQlTdHJpbmcgY29udGVudCA9CmRpZmYgLS1naXQgYS9vcmcuZWNsaXBzZS5qZHQuY29yZS50
ZXN0cy5tb2RlbC9zcmMvb3JnL2VjbGlwc2UvamR0L2NvcmUvdGVzdHMvZG9tL0FTVE1hdGNoZXJU
ZXN0LmphdmEgYi9vcmcuZWNsaXBzZS5qZHQuY29yZS50ZXN0cy5tb2RlbC9zcmMvb3JnL2VjbGlw
c2UvamR0L2NvcmUvdGVzdHMvZG9tL0FTVE1hdGNoZXJUZXN0LmphdmEKaW5kZXggOTcwZWY2ZS4u
NGVjNzc1OSAxMDA2NDQKLS0tIGEvb3JnLmVjbGlwc2UuamR0LmNvcmUudGVzdHMubW9kZWwvc3Jj
L29yZy9lY2xpcHNlL2pkdC9jb3JlL3Rlc3RzL2RvbS9BU1RNYXRjaGVyVGVzdC5qYXZhCisrKyBi
L29yZy5lY2xpcHNlLmpkdC5jb3JlLnRlc3RzLm1vZGVsL3NyYy9vcmcvZWNsaXBzZS9qZHQvY29y
ZS90ZXN0cy9kb20vQVNUTWF0Y2hlclRlc3QuamF2YQpAQCAtNDUzLDYgKzQ1Myw5IEBACiAJCXB1
YmxpYyBib29sZWFuIG1hdGNoKFBhY2thZ2VEZWNsYXJhdGlvbiBub2RlLCBPYmplY3Qgb3RoZXIp
IHsKIAkJCXJldHVybiBzdGFuZGFyZEJvZHkobm9kZSwgb3RoZXIsIHRoaXMuc3VwZXJNYXRjaCA/
IHN1cGVyLm1hdGNoKG5vZGUsIG90aGVyKSA6IGZhbHNlKTsKIAkJfQorCQlwdWJsaWMgYm9vbGVh
biBtYXRjaChQYWNrYWdlUXVhbGlmaWVkVHlwZSBub2RlLCBPYmplY3Qgb3RoZXIpIHsKKwkJCXJl
dHVybiBzdGFuZGFyZEJvZHkobm9kZSwgb3RoZXIsIHRoaXMuc3VwZXJNYXRjaCA/IHN1cGVyLm1h
dGNoKG5vZGUsIG90aGVyKSA6IGZhbHNlKTsKKwkJfQogCQlwdWJsaWMgYm9vbGVhbiBtYXRjaChQ
YXJhbWV0ZXJpemVkVHlwZSBub2RlLCBPYmplY3Qgb3RoZXIpIHsKIAkJCXJldHVybiBzdGFuZGFy
ZEJvZHkobm9kZSwgb3RoZXIsIHRoaXMuc3VwZXJNYXRjaCA/IHN1cGVyLm1hdGNoKG5vZGUsIG90
aGVyKSA6IGZhbHNlKTsKIAkJfQpAQCAtNzA4LDYgKzcxMSwxNSBAQAogCX0KIAogCS8qKiBAZGVw
cmVjYXRlZCB1c2luZyBkZXByZWNhdGVkIGNvZGUgKi8KKwlwdWJsaWMgdm9pZCB0ZXN0UGFja2Fn
ZVF1YWxpZmllZFR5cGUoKSB7CisJCWlmICh0aGlzLmFzdC5hcGlMZXZlbCgpIDwgQVNULkpMUzgp
IHsKKwkJCXJldHVybjsKKwkJfQorCQlUeXBlIHgxID0gdGhpcy5hc3QubmV3UGFja2FnZVF1YWxp
ZmllZFR5cGUodGhpcy5hc3QubmV3UXVhbGlmaWVkTmFtZSh0aGlzLk4yLCB0aGlzLk4zKSwgdGhp
cy5OMSk7CisJCWJhc2ljTWF0Y2goeDEpOworCX0KKworCS8qKiBAZGVwcmVjYXRlZCB1c2luZyBk
ZXByZWNhdGVkIGNvZGUgKi8KIAlwdWJsaWMgdm9pZCB0ZXN0UGFyYW1ldGVyaXplZFR5cGUoKSB7
CiAJCWlmICh0aGlzLmFzdC5hcGlMZXZlbCgpID09IEFTVC5KTFMyKSB7CiAJCQlyZXR1cm47CmRp
ZmYgLS1naXQgYS9vcmcuZWNsaXBzZS5qZHQuY29yZS50ZXN0cy5tb2RlbC9zcmMvb3JnL2VjbGlw
c2UvamR0L2NvcmUvdGVzdHMvZG9tL0FTVFN0cnVjdHVyYWxQcm9wZXJ0eVRlc3QuamF2YSBiL29y
Zy5lY2xpcHNlLmpkdC5jb3JlLnRlc3RzLm1vZGVsL3NyYy9vcmcvZWNsaXBzZS9qZHQvY29yZS90
ZXN0cy9kb20vQVNUU3RydWN0dXJhbFByb3BlcnR5VGVzdC5qYXZhCmluZGV4IGUzYzFjYjEuLjQz
MzM2NDcgMTAwNjQ0Ci0tLSBhL29yZy5lY2xpcHNlLmpkdC5jb3JlLnRlc3RzLm1vZGVsL3NyYy9v
cmcvZWNsaXBzZS9qZHQvY29yZS90ZXN0cy9kb20vQVNUU3RydWN0dXJhbFByb3BlcnR5VGVzdC5q
YXZhCisrKyBiL29yZy5lY2xpcHNlLmpkdC5jb3JlLnRlc3RzLm1vZGVsL3NyYy9vcmcvZWNsaXBz
ZS9qZHQvY29yZS90ZXN0cy9kb20vQVNUU3RydWN0dXJhbFByb3BlcnR5VGVzdC5qYXZhCkBAIC0z
NTAsNyArMzUwLDcgQEAKIAkJCQkvLyBvb3BzIC0gZ3Vlc3MgdGhhdCdzIG5vdCB2YWxpZAogCQkJ
fQogCQl9Ci0JCWFzc2VydEVxdWFscygiV3JvbmcgbGFzdCBrbm93biB0eXBlIiwgODYsIGhpKTsg
Ly8gbGFzdCBrbm93biBvbmUKKwkJYXNzZXJ0RXF1YWxzKCJXcm9uZyBsYXN0IGtub3duIHR5cGUi
LCA4NywgaGkpOyAvLyBsYXN0IGtub3duIG9uZQogCQlhc3NlcnRFcXVhbHMoIldyb25nIG51bWJl
ciBvZiBkaXN0aW5jdCB0eXBlcyIsICBoaSwgY2xhc3Nlcy5zaXplKCkpOyAvLyBhbGwgY2xhc3Nl
cyBhcmUgZGlzdGluY3QKIAl9CiB9CmRpZmYgLS1naXQgYS9vcmcuZWNsaXBzZS5qZHQuY29yZS50
ZXN0cy5tb2RlbC9zcmMvb3JnL2VjbGlwc2UvamR0L2NvcmUvdGVzdHMvZG9tL0FTVFZpc2l0b3JU
ZXN0LmphdmEgYi9vcmcuZWNsaXBzZS5qZHQuY29yZS50ZXN0cy5tb2RlbC9zcmMvb3JnL2VjbGlw
c2UvamR0L2NvcmUvdGVzdHMvZG9tL0FTVFZpc2l0b3JUZXN0LmphdmEKaW5kZXggMDA3MmVkOC4u
ZmYwZGIzYSAxMDA2NDQKLS0tIGEvb3JnLmVjbGlwc2UuamR0LmNvcmUudGVzdHMubW9kZWwvc3Jj
L29yZy9lY2xpcHNlL2pkdC9jb3JlL3Rlc3RzL2RvbS9BU1RWaXNpdG9yVGVzdC5qYXZhCisrKyBi
L29yZy5lY2xpcHNlLmpkdC5jb3JlLnRlc3RzLm1vZGVsL3NyYy9vcmcvZWNsaXBzZS9qZHQvY29y
ZS90ZXN0cy9kb20vQVNUVmlzaXRvclRlc3QuamF2YQpAQCAtMzgzLDYgKzM4MywxMyBAQAogCQkJ
QVNUVmlzaXRvclRlc3QudGhpcy5iLmFwcGVuZChub2RlLmdldFByaW1pdGl2ZVR5cGVDb2RlKCku
dG9TdHJpbmcoKSk7CiAJCQlBU1RWaXNpdG9yVGVzdC50aGlzLmIuYXBwZW5kKCJ0UCkiKTsgLy8k
Tk9OLU5MUy0xJAogCQl9CisJCXB1YmxpYyBib29sZWFuIHZpc2l0KFBhY2thZ2VRdWFsaWZpZWRU
eXBlIG5vZGUpIHsKKwkJCUFTVFZpc2l0b3JUZXN0LnRoaXMuYi5hcHBlbmQoIih0UFEiKTsgLy8k
Tk9OLU5MUy0xJAorCQkJcmV0dXJuIGlzVmlzaXRpbmdDaGlsZHJlbigpOworCQl9CisJCXB1Ymxp
YyB2b2lkIGVuZFZpc2l0KFBhY2thZ2VRdWFsaWZpZWRUeXBlIG5vZGUpIHsKKwkJCUFTVFZpc2l0
b3JUZXN0LnRoaXMuYi5hcHBlbmQoInRQUSkiKTsgLy8kTk9OLU5MUy0xJAorCQl9CiAJCXB1Ymxp
YyBib29sZWFuIHZpc2l0KFBhcmFtZXRlcml6ZWRUeXBlIG5vZGUpIHsKIAkJCUFTVFZpc2l0b3JU
ZXN0LnRoaXMuYi5hcHBlbmQoIih0TSIpOyAvLyROT04tTkxTLTEkCiAJCQlyZXR1cm4gaXNWaXNp
dGluZ0NoaWxkcmVuKCk7CkBAIC0xMTIyLDYgKzExMjksMjAgQEAKIAl9CiAKIAkvKiogQGRlcHJl
Y2F0ZWQgdXNpbmcgZGVwcmVjYXRlZCBjb2RlICovCisJcHVibGljIHZvaWQgdGVzdFBhY2thZ2VR
dWFsaWZpZWRUeXBlKCkgeworCQlpZiAodGhpcy5hc3QuYXBpTGV2ZWwoKSA8IEFTVC5KTFM4KSB7
CisJCQlyZXR1cm47CisJCX0KKwkJUXVhbGlmaWVkTmFtZSBxID0gdGhpcy5hc3QubmV3UXVhbGlm
aWVkTmFtZSh0aGlzLk4yLCB0aGlzLk4zKTsKKwkJUGFja2FnZVF1YWxpZmllZFR5cGUgeDEgPSB0
aGlzLmFzdC5uZXdQYWNrYWdlUXVhbGlmaWVkVHlwZShxLCB0aGlzLk4xKTsKKwkJVGVzdFZpc2l0
b3IgdjEgPSBuZXcgVGVzdFZpc2l0b3IoKTsKKwkJdGhpcy5iLnNldExlbmd0aCgwKTsKKwkJeDEu
YWNjZXB0KHYxKTsKKwkJU3RyaW5nIHJlc3VsdCA9IHRoaXMuYi50b1N0cmluZygpOworCQlhc3Nl
cnRUcnVlKHJlc3VsdC5lcXVhbHMoIlsodFBRIisiWyhuUSIrdGhpcy5OMlMrdGhpcy5OM1MrIm5R
KV0iK3RoaXMuTjFTKyJ0UFEpXSIpKTsgLy8kTk9OLU5MUy0xJCAvLyROT04tTkxTLTIkCisJfQor
CisJLyoqIEBkZXByZWNhdGVkIHVzaW5nIGRlcHJlY2F0ZWQgY29kZSAqLwogCXB1YmxpYyB2b2lk
IHRlc3RQYXJhbWV0ZXJpemVkVHlwZSgpIHsKIAkJaWYgKHRoaXMuYXN0LmFwaUxldmVsKCkgPT0g
QVNULkpMUzIpIHsKIAkJCXJldHVybjsKZGlmZiAtLWdpdCBhL29yZy5lY2xpcHNlLmpkdC5jb3Jl
LnRlc3RzLm1vZGVsL3dvcmtzcGFjZS9Db252ZXJ0ZXIxNS9zcmMvdGVzdDQwNDQ4OS9idWcvWC5q
YXZhIGIvb3JnLmVjbGlwc2UuamR0LmNvcmUudGVzdHMubW9kZWwvd29ya3NwYWNlL0NvbnZlcnRl
cjE1L3NyYy90ZXN0NDA0NDg5L2J1Zy9YLmphdmEKbmV3IGZpbGUgbW9kZSAxMDA2NDQKaW5kZXgg
MDAwMDAwMC4uNGNmNTQyYQotLS0gL2Rldi9udWxsCisrKyBiL29yZy5lY2xpcHNlLmpkdC5jb3Jl
LnRlc3RzLm1vZGVsL3dvcmtzcGFjZS9Db252ZXJ0ZXIxNS9zcmMvdGVzdDQwNDQ4OS9idWcvWC5q
YXZhCkBAIC0wLDAgKzEsMzcgQEAKK3BhY2thZ2UgdGVzdDQwNDQ4OS5idWc7CitpbXBvcnQgamF2
YS5sYW5nLmFubm90YXRpb24uKjsKK3B1YmxpYyBjbGFzcyBYIHsKKwlAVGFyZ2V0KEVsZW1lbnRU
eXBlLlRZUEVfVVNFKQorCUBSZXRlbnRpb24oUmV0ZW50aW9uUG9saWN5LlJVTlRJTUUpCisJQERv
Y3VtZW50ZWQKKwlzdGF0aWMgQGludGVyZmFjZSBOb25OdWxsIHsgfQorCWNsYXNzIElubmVyIHt9
CisJCisJLyoqCisgCSogQHBhcmFtIGFyZyAgCisgCSovCisJdGVzdDQwNDQ4OS5idWcuQE5vbk51
bGwgSU9FeGNlcHRpb24gZm9vKAorCQkJdGVzdDQwNDQ4OS5idWcuQE5vbk51bGwgRmlsZU5vdEZv
dW5kRXhjZXB0aW9uIGFyZykKKwkJdGhyb3dzIHRlc3Q0MDQ0ODkuYnVnLkBOb25OdWxsIEVPRkV4
Y2VwdGlvbiB7CisJCXRyeSB7CisJCQl0ZXN0NDA0NDg5LmJ1Zy5ATm9uTnVsbCBJT0Vycm9yIGUg
PSBuZXcgdGVzdDQwNDQ4OS5idWcuSU9FcnJvcigpOworCQkJdGhyb3cgZTsKKwkJfSBjYXRjaCAo
dGVzdDQwNDQ4OS5idWcuQE5vbk51bGwgSU9FcnJvciBlKSB7CisJCX0KKwkJcmV0dXJuIG51bGw7
CisJfSAKKwl0ZXN0NDA0NDg5LmJ1Zy5ATm9uTnVsbCBYLkBOb25OdWxsIElubmVyIGZJbm5lcjsK
K30gCitAamF2YS5sYW5nLmFubm90YXRpb24uVGFyZ2V0KGphdmEubGFuZy5hbm5vdGF0aW9uLkVs
ZW1lbnRUeXBlLlRZUEVfVVNFKSBAaW50ZXJmYWNlIE1hcmtlciB7fSAKK0BqYXZhLmxhbmcuYW5u
b3RhdGlvbi5UYXJnZXQoamF2YS5sYW5nLmFubm90YXRpb24uRWxlbWVudFR5cGUuVFlQRV9VU0Up
IEBpbnRlcmZhY2UgQSB7fSAKK0BqYXZhLmxhbmcuYW5ub3RhdGlvbi5UYXJnZXQoamF2YS5sYW5n
LmFubm90YXRpb24uRWxlbWVudFR5cGUuVFlQRV9VU0UpIEBpbnRlcmZhY2UgQiB7fSAKKworY2xh
c3MgT3V0ZXIgeworCXB1YmxpYyBjbGFzcyBJbm5lciB7CisJCXB1YmxpYyBjbGFzcyBEZWVwZXIg
e30KKwl9Cit9CitjbGFzcyBJT0V4Y2VwdGlvbiBleHRlbmRzIEV4Y2VwdGlvbiB7cHJpdmF0ZSBz
dGF0aWMgZmluYWwgbG9uZyBzZXJpYWxWZXJzaW9uVUlEPTEwMDAxTDt9CitjbGFzcyBGaWxlTm90
Rm91bmRFeGNlcHRpb24gZXh0ZW5kcyBFeGNlcHRpb257cHJpdmF0ZSBzdGF0aWMgZmluYWwgbG9u
ZyBzZXJpYWxWZXJzaW9uVUlEPTEwMDAyTDt9CitjbGFzcyBFT0ZFeGNlcHRpb24gZXh0ZW5kcyBF
eGNlcHRpb257cHJpdmF0ZSBzdGF0aWMgZmluYWwgbG9uZyBzZXJpYWxWZXJzaW9uVUlEPTEwMDAz
TDt9CitjbGFzcyBJT0Vycm9yIGV4dGVuZHMgRXhjZXB0aW9ue3ByaXZhdGUgc3RhdGljIGZpbmFs
IGxvbmcgc2VyaWFsVmVyc2lvblVJRD0xMDAwNEw7fQpcIE5vIG5ld2xpbmUgYXQgZW5kIG9mIGZp
bGUKZGlmZiAtLWdpdCBhL29yZy5lY2xpcHNlLmpkdC5jb3JlLnRlc3RzLm1vZGVsL3dvcmtzcGFj
ZS9Db252ZXJ0ZXIxOC9zcmMvdGVzdDQwNDQ4OS9idWcvWC5qYXZhIGIvb3JnLmVjbGlwc2UuamR0
LmNvcmUudGVzdHMubW9kZWwvd29ya3NwYWNlL0NvbnZlcnRlcjE4L3NyYy90ZXN0NDA0NDg5L2J1
Zy9YLmphdmEKbmV3IGZpbGUgbW9kZSAxMDA2NDQKaW5kZXggMDAwMDAwMC4uNGNmNTQyYQotLS0g
L2Rldi9udWxsCisrKyBiL29yZy5lY2xpcHNlLmpkdC5jb3JlLnRlc3RzLm1vZGVsL3dvcmtzcGFj
ZS9Db252ZXJ0ZXIxOC9zcmMvdGVzdDQwNDQ4OS9idWcvWC5qYXZhCkBAIC0wLDAgKzEsMzcgQEAK
K3BhY2thZ2UgdGVzdDQwNDQ4OS5idWc7CitpbXBvcnQgamF2YS5sYW5nLmFubm90YXRpb24uKjsK
K3B1YmxpYyBjbGFzcyBYIHsKKwlAVGFyZ2V0KEVsZW1lbnRUeXBlLlRZUEVfVVNFKQorCUBSZXRl
bnRpb24oUmV0ZW50aW9uUG9saWN5LlJVTlRJTUUpCisJQERvY3VtZW50ZWQKKwlzdGF0aWMgQGlu
dGVyZmFjZSBOb25OdWxsIHsgfQorCWNsYXNzIElubmVyIHt9CisJCisJLyoqCisgCSogQHBhcmFt
IGFyZyAgCisgCSovCisJdGVzdDQwNDQ4OS5idWcuQE5vbk51bGwgSU9FeGNlcHRpb24gZm9vKAor
CQkJdGVzdDQwNDQ4OS5idWcuQE5vbk51bGwgRmlsZU5vdEZvdW5kRXhjZXB0aW9uIGFyZykKKwkJ
dGhyb3dzIHRlc3Q0MDQ0ODkuYnVnLkBOb25OdWxsIEVPRkV4Y2VwdGlvbiB7CisJCXRyeSB7CisJ
CQl0ZXN0NDA0NDg5LmJ1Zy5ATm9uTnVsbCBJT0Vycm9yIGUgPSBuZXcgdGVzdDQwNDQ4OS5idWcu
SU9FcnJvcigpOworCQkJdGhyb3cgZTsKKwkJfSBjYXRjaCAodGVzdDQwNDQ4OS5idWcuQE5vbk51
bGwgSU9FcnJvciBlKSB7CisJCX0KKwkJcmV0dXJuIG51bGw7CisJfSAKKwl0ZXN0NDA0NDg5LmJ1
Zy5ATm9uTnVsbCBYLkBOb25OdWxsIElubmVyIGZJbm5lcjsKK30gCitAamF2YS5sYW5nLmFubm90
YXRpb24uVGFyZ2V0KGphdmEubGFuZy5hbm5vdGF0aW9uLkVsZW1lbnRUeXBlLlRZUEVfVVNFKSBA
aW50ZXJmYWNlIE1hcmtlciB7fSAKK0BqYXZhLmxhbmcuYW5ub3RhdGlvbi5UYXJnZXQoamF2YS5s
YW5nLmFubm90YXRpb24uRWxlbWVudFR5cGUuVFlQRV9VU0UpIEBpbnRlcmZhY2UgQSB7fSAKK0Bq
YXZhLmxhbmcuYW5ub3RhdGlvbi5UYXJnZXQoamF2YS5sYW5nLmFubm90YXRpb24uRWxlbWVudFR5
cGUuVFlQRV9VU0UpIEBpbnRlcmZhY2UgQiB7fSAKKworY2xhc3MgT3V0ZXIgeworCXB1YmxpYyBj
bGFzcyBJbm5lciB7CisJCXB1YmxpYyBjbGFzcyBEZWVwZXIge30KKwl9Cit9CitjbGFzcyBJT0V4
Y2VwdGlvbiBleHRlbmRzIEV4Y2VwdGlvbiB7cHJpdmF0ZSBzdGF0aWMgZmluYWwgbG9uZyBzZXJp
YWxWZXJzaW9uVUlEPTEwMDAxTDt9CitjbGFzcyBGaWxlTm90Rm91bmRFeGNlcHRpb24gZXh0ZW5k
cyBFeGNlcHRpb257cHJpdmF0ZSBzdGF0aWMgZmluYWwgbG9uZyBzZXJpYWxWZXJzaW9uVUlEPTEw
MDAyTDt9CitjbGFzcyBFT0ZFeGNlcHRpb24gZXh0ZW5kcyBFeGNlcHRpb257cHJpdmF0ZSBzdGF0
aWMgZmluYWwgbG9uZyBzZXJpYWxWZXJzaW9uVUlEPTEwMDAzTDt9CitjbGFzcyBJT0Vycm9yIGV4
dGVuZHMgRXhjZXB0aW9ue3ByaXZhdGUgc3RhdGljIGZpbmFsIGxvbmcgc2VyaWFsVmVyc2lvblVJ
RD0xMDAwNEw7fQpcIE5vIG5ld2xpbmUgYXQgZW5kIG9mIGZpbGUKZGlmZiAtLWdpdCBhL29yZy5l
Y2xpcHNlLmpkdC5jb3JlL2RvbS9vcmcvZWNsaXBzZS9qZHQvY29yZS9kb20vQVNULmphdmEgYi9v
cmcuZWNsaXBzZS5qZHQuY29yZS9kb20vb3JnL2VjbGlwc2UvamR0L2NvcmUvZG9tL0FTVC5qYXZh
CmluZGV4IDRlODhjMjguLmRlNWZhMDYgMTAwNjQ0Ci0tLSBhL29yZy5lY2xpcHNlLmpkdC5jb3Jl
L2RvbS9vcmcvZWNsaXBzZS9qZHQvY29yZS9kb20vQVNULmphdmEKKysrIGIvb3JnLmVjbGlwc2Uu
amR0LmNvcmUvZG9tL29yZy9lY2xpcHNlL2pkdC9jb3JlL2RvbS9BU1QuamF2YQpAQCAtMTk2Niw2
ICsxOTY2LDI5IEBACiAJfQogCiAJLyoqCisJICogQ3JlYXRlcyBhbmQgcmV0dXJucyBhIG5ldyB1
bnBhcmVudGVkIHBhY2thZ2UgcXVhbGlmaWVkIHR5cGUgbm9kZSB3aXRoCisJICogdGhlIGdpdmVu
IHF1YWxpZmllciBhbmQgbmFtZS4KKwkgKgorCSAqIEBwYXJhbSBxdWFsaWZpZXIgdGhlIHBhY2th
Z2UgcXVhbGlmaWVyIHR5cGUgbm9kZQorCSAqIEBwYXJhbSBuYW1lIHRoZSBzaW1wbGUgbmFtZSBi
ZWluZyBxdWFsaWZpZWQKKwkgKiBAcmV0dXJuIGEgbmV3IHVucGFyZW50ZWQgcXVhbGlmaWVkIHR5
cGUgbm9kZQorCSAqIEBleGNlcHRpb24gSWxsZWdhbEFyZ3VtZW50RXhjZXB0aW9uIGlmOgorCSAq
IDx1bD4KKwkgKiA8bGk+dGhlIG5vZGUgYmVsb25ncyB0byBhIGRpZmZlcmVudCBBU1Q8L2xpPgor
CSAqIDxsaT50aGUgbm9kZSBhbHJlYWR5IGhhcyBhIHBhcmVudDwvbGk+CisJICogPC91bD4KKwkg
KiBAZXhjZXB0aW9uIFVuc3VwcG9ydGVkT3BlcmF0aW9uRXhjZXB0aW9uIGlmIHRoaXMgb3BlcmF0
aW9uIGlzIHVzZWQgaW4KKwkgKiBhIEpMUzIsIEpMUzMgYW5kIEpMUzQgQVNUCisJICogQHNpbmNl
IDMuOSBCRVRBX0pBVkE4CisJICovCisJcHVibGljIFBhY2thZ2VRdWFsaWZpZWRUeXBlIG5ld1Bh
Y2thZ2VRdWFsaWZpZWRUeXBlKE5hbWUgcXVhbGlmaWVyLCBTaW1wbGVOYW1lIG5hbWUpIHsKKwkJ
UGFja2FnZVF1YWxpZmllZFR5cGUgcmVzdWx0ID0gbmV3IFBhY2thZ2VRdWFsaWZpZWRUeXBlKHRo
aXMpOworCQlyZXN1bHQuc2V0UXVhbGlmaWVyKHF1YWxpZmllcik7CisJCXJlc3VsdC5zZXROYW1l
KG5hbWUpOworCQlyZXR1cm4gcmVzdWx0OworCX0KKworCS8qKgogCSAqIENyZWF0ZXMgYW5kIHJl
dHVybnMgYSBuZXcgdW5wYXJlbnRlZCBwYXJhbWV0ZXJpemVkIHR5cGUgbm9kZSB3aXRoIHRoZQog
CSAqIGdpdmVuIHR5cGUgYW5kIGFuIGVtcHR5IGxpc3Qgb2YgdHlwZSBhcmd1bWVudHMuCiAJICoK
ZGlmZiAtLWdpdCBhL29yZy5lY2xpcHNlLmpkdC5jb3JlL2RvbS9vcmcvZWNsaXBzZS9qZHQvY29y
ZS9kb20vQVNUQ29udmVydGVyLmphdmEgYi9vcmcuZWNsaXBzZS5qZHQuY29yZS9kb20vb3JnL2Vj
bGlwc2UvamR0L2NvcmUvZG9tL0FTVENvbnZlcnRlci5qYXZhCmluZGV4IDQzYTZjMzMuLmRiNzcz
YmUgMTAwNjQ0Ci0tLSBhL29yZy5lY2xpcHNlLmpkdC5jb3JlL2RvbS9vcmcvZWNsaXBzZS9qZHQv
Y29yZS9kb20vQVNUQ29udmVydGVyLmphdmEKKysrIGIvb3JnLmVjbGlwc2UuamR0LmNvcmUvZG9t
L29yZy9lY2xpcHNlL2pkdC9jb3JlL2RvbS9BU1RDb252ZXJ0ZXIuamF2YQpAQCAtMTcsNiArMTcs
NyBAQAogCiBwYWNrYWdlIG9yZy5lY2xpcHNlLmpkdC5jb3JlLmRvbTsKIAoraW1wb3J0IGphdmEu
dXRpbC5BcnJheXM7CiBpbXBvcnQgamF2YS51dGlsLkhhc2hTZXQ7CiBpbXBvcnQgamF2YS51dGls
Lkl0ZXJhdG9yOwogaW1wb3J0IGphdmEudXRpbC5MaXN0OwpAQCAtNTcsNiArNTgsOCBAQAogaW1w
b3J0IG9yZy5lY2xpcHNlLmpkdC5pbnRlcm5hbC5jb21waWxlci5pbXBsLkNvbXBpbGVyT3B0aW9u
czsKIGltcG9ydCBvcmcuZWNsaXBzZS5qZHQuaW50ZXJuYWwuY29tcGlsZXIubG9va3VwLkJsb2Nr
U2NvcGU7CiBpbXBvcnQgb3JnLmVjbGlwc2UuamR0LmludGVybmFsLmNvbXBpbGVyLmxvb2t1cC5F
eHRyYUNvbXBpbGVyTW9kaWZpZXJzOworaW1wb3J0IG9yZy5lY2xpcHNlLmpkdC5pbnRlcm5hbC5j
b21waWxlci5sb29rdXAuUGFja2FnZUJpbmRpbmc7CitpbXBvcnQgb3JnLmVjbGlwc2UuamR0Lmlu
dGVybmFsLmNvbXBpbGVyLmxvb2t1cC5SZWZlcmVuY2VCaW5kaW5nOwogaW1wb3J0IG9yZy5lY2xp
cHNlLmpkdC5pbnRlcm5hbC5jb21waWxlci5sb29rdXAuVHlwZUNvbnN0YW50czsKIGltcG9ydCBv
cmcuZWNsaXBzZS5qZHQuaW50ZXJuYWwuY29tcGlsZXIucGFyc2VyLlJlY292ZXJ5U2Nhbm5lcjsK
IGltcG9ydCBvcmcuZWNsaXBzZS5qZHQuaW50ZXJuYWwuY29tcGlsZXIucGFyc2VyLlNjYW5uZXI7
CkBAIC0zMjk2LDkgKzMyOTksNiBAQAogCQkJCQlvcmcuZWNsaXBzZS5qZHQuaW50ZXJuYWwuY29t
cGlsZXIuYXN0LkFubm90YXRpb24gdHlwZUFubm90YXRpb24gPSBhbm5vdGF0aW9uc1tpXTsKIAkJ
CQkJaWYgKHR5cGVBbm5vdGF0aW9uICE9IG51bGwpIHsKIAkJCQkJCUFubm90YXRpb24gYW5ub3Rh
dGlvbiA9IGNvbnZlcnQodHlwZUFubm90YXRpb24pOwotCQkJCQkJaW50IHN0YXJ0ID0gdHlwZUFu
bm90YXRpb24uc291cmNlU3RhcnQ7Ci0JCQkJCQlpbnQgZW5kID0gdHlwZUFubm90YXRpb24uc291
cmNlRW5kOwotCQkJCQkJYW5ub3RhdGlvbi5zZXRTb3VyY2VSYW5nZShzdGFydCwgZW5kIC0gc3Rh
cnQgKyAxKTsKIAkJCQkJCXR5cGUuYW5ub3RhdGlvbnMoKS5hZGQoYW5ub3RhdGlvbik7CiAJCQkJ
CX0KIAkJCQl9CkBAIC0zMzI5LDkgKzMzMjksNiBAQAogCQkJCQlvcmcuZWNsaXBzZS5qZHQuaW50
ZXJuYWwuY29tcGlsZXIuYXN0LkFubm90YXRpb24gdHlwZUFubm90YXRpb24gPSBhbm5vdGF0aW9u
c1tpXTsKIAkJCQkJaWYgKHR5cGVBbm5vdGF0aW9uICE9IG51bGwpIHsKIAkJCQkJCUFubm90YXRp
b24gYW5ub3RhdGlvbiA9IGNvbnZlcnQodHlwZUFubm90YXRpb24pOwotCQkJCQkJaW50IHN0YXJ0
ID0gdHlwZUFubm90YXRpb24uc291cmNlU3RhcnQ7Ci0JCQkJCQlpbnQgZW5kID0gdHlwZUFubm90
YXRpb24uc291cmNlRW5kOwotCQkJCQkJYW5ub3RhdGlvbi5zZXRTb3VyY2VSYW5nZShzdGFydCwg
ZW5kIC0gc3RhcnQgKyAxKTsKIAkJCQkJCXR5cGVQYXJhbWV0ZXIuYW5ub3RhdGlvbnMoKS5hZGQo
YW5ub3RhdGlvbik7CiAJCQkJCX0KIAkJCQl9CkBAIC0zNTQ2LDEzICszNTQzLDcgQEAKIAkJCQkJ
CXNpbXBsZVR5cGUuc2V0TmFtZShuYW1lKTsKIAkJCQkJCWludCBzdGFydCA9IChpbnQpKHBvc2l0
aW9uc1swXSA+Pj4gMzIpOwogCQkJCQkJaW50IGVuZCA9IChpbnQpcG9zaXRpb25zW2ZpcnN0VHlw
ZUluZGV4XTsKLQkJCQkJCXNpbXBsZVR5cGUuc2V0U291cmNlUmFuZ2Uoc3RhcnQsIGVuZCAtIHN0
YXJ0ICsgMSk7Ci0JCQkJCQlpZiAodHlwZUFubm90YXRpb25zICE9IG51bGwgJiYgKGFubm90YXRp
b25zID0gdHlwZUFubm90YXRpb25zW2ZpcnN0VHlwZUluZGV4XSkgIT0gbnVsbCkgewotCQkJCQkJ
CWFubm90YXRlVHlwZShzaW1wbGVUeXBlLCBhbm5vdGF0aW9ucyk7Ci0JCQkJCQl9Ci0JCQkJCQlp
ZiAodGhpcy5yZXNvbHZlQmluZGluZ3MpIHsKLQkJCQkJCQlyZWNvcmROb2RlcyhzaW1wbGVUeXBl
LCB0eXBlUmVmZXJlbmNlKTsKLQkJCQkJCX0KKwkJCQkJCXNldFNvdXJjZUFubm90YXRpb25zQW5k
QmluZGluZ3ModHlwZVJlZmVyZW5jZSwgcG9zaXRpb25zLCB0eXBlQW5ub3RhdGlvbnMsIGZpcnN0
VHlwZUluZGV4LCAwLCBmaXJzdFR5cGVJbmRleCwgc2ltcGxlVHlwZSk7CiAJCQkJCQlUeXBlIGN1
cnJlbnRUeXBlID0gc2ltcGxlVHlwZTsJCQkJCQkKIAkJCQkJCWludCBpbmRleE9mRW5jbG9zaW5n
VHlwZSA9IDE7CiAJCQkJCQlpZiAodHlwZUFyZ3VtZW50cyAhPSBudWxsICYmIChhcmd1bWVudHMg
PSB0eXBlQXJndW1lbnRzW2ZpcnN0VHlwZUluZGV4XSkgIT0gbnVsbCkgewpAQCAtMzYyOCw3ICsz
NjE5LDcgQEAKIAkJCQlvcmcuZWNsaXBzZS5qZHQuaW50ZXJuYWwuY29tcGlsZXIuYXN0LkFubm90
YXRpb24gW11bXSB0eXBlQW5ub3RhdGlvbnMgPSB0eXBlUmVmZXJlbmNlLmFubm90YXRpb25zOwog
CQkJCWNoYXIgW11bXSB0b2tlbnMgPSBxdWFsaWZpZWRUeXBlUmVmZXJlbmNlLnRva2VuczsKIAkJ
CQlpbnQgbGVudGggPSB0b2tlbnMubGVuZ3RoOwotCQkJCWludCBmaXJzdFR5cGVJbmRleCA9IGxl
bnRoIC0gMTsKKwkJCQlpbnQgZmlyc3RUeXBlSW5kZXggPSBsZW50aDsKIAkJCQkKIAkJCQlpZiAo
dHlwZUFubm90YXRpb25zICE9IG51bGwpIHsKIAkJCQkJZm9yIChpbnQgaSA9IDA7IGkgPCBsZW50
aDsgKytpKSB7CkBAIC0zNjQwLDU3ICszNjMxLDQ0IEBACiAJCQkJfSAgCiAJCQkJc291cmNlU3Rh
cnQgPSAoaW50KShwb3NpdGlvbnNbMF0+Pj4zMik7CiAJCQkJTmFtZSBuYW1lID0gbnVsbDsKLQkJ
CQlpZiAoZmlyc3RUeXBlSW5kZXggPT0gMCkgewotCQkJCQlmaW5hbCBTaW1wbGVOYW1lIHNpbXBs
ZU5hbWUgPSBuZXcgU2ltcGxlTmFtZSh0aGlzLmFzdCk7Ci0JCQkJCXNpbXBsZU5hbWUuaW50ZXJu
YWxTZXRJZGVudGlmaWVyKG5ldyBTdHJpbmcodG9rZW5zWzBdKSk7Ci0JCQkJCXJlY29yZFBlbmRp
bmdOYW1lU2NvcGVSZXNvbHV0aW9uKHNpbXBsZU5hbWUpOwotCQkJCQlpbnQgc3RhcnQgPSAoaW50
KSAocG9zaXRpb25zWzBdID4+PiAzMik7Ci0JCQkJCWludCBlbmQgPSAoaW50KSBwb3NpdGlvbnNb
MF07Ci0JCQkJCXNpbXBsZU5hbWUuc2V0U291cmNlUmFuZ2Uoc3RhcnQsIGVuZCk7Ci0JCQkJCXNp
bXBsZU5hbWUuaW5kZXggPSAxOwotCQkJCQluYW1lID0gc2ltcGxlTmFtZTsKLQkJCQkJaWYgKHRo
aXMucmVzb2x2ZUJpbmRpbmdzKSB7Ci0JCQkJCQlyZWNvcmROb2RlcyhzaW1wbGVOYW1lLCB0eXBl
UmVmZXJlbmNlKTsKLQkJCQkJfQkJCQkJCisJCQkJVHlwZSBjdXJyZW50VHlwZSA9IG51bGw7CisJ
CQkJaWYgKGZpcnN0VHlwZUluZGV4ID09IGxlbnRoKSB7Ly9KdXN0IGEgUXVhbGlmaWVkTmFtZQor
CQkJCQluYW1lID0gc2V0UXVhbGlmaWVkTmFtZU5hbWVBbmRTb3VyY2VSYW5nZXModG9rZW5zLCBw
b3NpdGlvbnMsIGxlbnRoIC0gMSwgdHlwZVJlZmVyZW5jZSk7CisJCQkJCWN1cnJlbnRUeXBlID0g
Z2V0U2ltcGxlVHlwZVdpdGhOYW1lQW5kQmluZGluZyhuYW1lLCB0eXBlUmVmZXJlbmNlLCBwb3Np
dGlvbnMsIDAsIGxlbnRoIC0gMSk7CiAJCQkJfSBlbHNlIHsKLQkJCQkJbmFtZSA9IHNldFF1YWxp
ZmllZE5hbWVOYW1lQW5kU291cmNlUmFuZ2VzKHRva2VucywgcG9zaXRpb25zLCBmaXJzdFR5cGVJ
bmRleCwgdHlwZVJlZmVyZW5jZSk7Ci0JCQkJfQotCQkJCVNpbXBsZVR5cGUgc2ltcGxlVHlwZSA9
IG5ldyBTaW1wbGVUeXBlKHRoaXMuYXN0KTsKLQkJCQlzaW1wbGVUeXBlLnNldE5hbWUobmFtZSk7
Ci0JCQkJaW50IHN0YXJ0ID0gKGludCkocG9zaXRpb25zWzBdID4+PiAzMik7Ci0JCQkJaW50IGVu
ZCA9IChpbnQpcG9zaXRpb25zW2ZpcnN0VHlwZUluZGV4XTsKLQkJCQlzaW1wbGVUeXBlLnNldFNv
dXJjZVJhbmdlKHN0YXJ0LCBlbmQgLSBzdGFydCArIDEpOwotCQkJCWlmICh0eXBlQW5ub3RhdGlv
bnMgIT0gbnVsbCAmJiAoYW5ub3RhdGlvbnMgPSB0eXBlQW5ub3RhdGlvbnNbZmlyc3RUeXBlSW5k
ZXhdKSAhPSBudWxsKSB7Ci0JCQkJCWFubm90YXRlVHlwZShzaW1wbGVUeXBlLCBhbm5vdGF0aW9u
cyk7Ci0JCQkJfQotCQkJCWlmICh0aGlzLnJlc29sdmVCaW5kaW5ncykgewotCQkJCQlyZWNvcmRO
b2RlcyhzaW1wbGVUeXBlLCB0eXBlUmVmZXJlbmNlKTsKLQkJCQl9Ci0JCQkJVHlwZSBjdXJyZW50
VHlwZSA9IHNpbXBsZVR5cGU7Ci0JCQkJCi0JCQkJZm9yIChpbnQgaSA9IGZpcnN0VHlwZUluZGV4
ICsgMTsgaSA8IGxlbnRoOyArK2kpIHsKLQkJCQkJU2ltcGxlTmFtZSBzaW1wbGVOYW1lID0gbmV3
IFNpbXBsZU5hbWUodGhpcy5hc3QpOwotCQkJCQlzaW1wbGVOYW1lLmludGVybmFsU2V0SWRlbnRp
ZmllcihuZXcgU3RyaW5nKHRva2Vuc1tpXSkpOwotCQkJCQlzaW1wbGVOYW1lLmluZGV4ID0gaSAr
IDE7Ci0JCQkJCXN0YXJ0ID0gKGludCkgKHBvc2l0aW9uc1tpXSA+Pj4gMzIpOwotCQkJCQllbmQg
PSAoaW50KSBwb3NpdGlvbnNbaV07Ci0JCQkJCXNpbXBsZU5hbWUuc2V0U291cmNlUmFuZ2Uoc3Rh
cnQsIGVuZCAtIHN0YXJ0ICsxKTsKLQkJCQkJcmVjb3JkUGVuZGluZ05hbWVTY29wZVJlc29sdXRp
b24oc2ltcGxlTmFtZSk7Ci0JCQkJCVF1YWxpZmllZFR5cGUgcXVhbGlmaWVkVHlwZSA9IG5ldyBR
dWFsaWZpZWRUeXBlKHRoaXMuYXN0KTsKLQkJCQkJcXVhbGlmaWVkVHlwZS5zZXRRdWFsaWZpZXIo
Y3VycmVudFR5cGUpOwotCQkJCQlxdWFsaWZpZWRUeXBlLnNldE5hbWUoc2ltcGxlTmFtZSk7Ci0J
CQkJCWlmICh0eXBlQW5ub3RhdGlvbnMgIT0gbnVsbCAmJiAoYW5ub3RhdGlvbnMgPSB0eXBlQW5u
b3RhdGlvbnNbaV0pICE9IG51bGwpIHsKLQkJCQkJCWFubm90YXRlVHlwZShxdWFsaWZpZWRUeXBl
LCBhbm5vdGF0aW9ucyk7CisJCQkJCWlmIChmaXJzdFR5cGVJbmRleCA8PSAxKSB7CisJCQkJCQlu
YW1lID0gY3JlYXRlU2ltcGxlTmFtZSh0eXBlUmVmZXJlbmNlLCBwb3NpdGlvbnMsIHRva2Vucywg
MCApOworCQkJCQkJZmlyc3RUeXBlSW5kZXggPSAxOworCQkJCQl9IGVsc2UgeworCQkJCQkJbmFt
ZSA9IHNldFF1YWxpZmllZE5hbWVOYW1lQW5kU291cmNlUmFuZ2VzKHRva2VucywgcG9zaXRpb25z
LCBmaXJzdFR5cGVJbmRleCAtIDEsIHR5cGVSZWZlcmVuY2UpOworCQkJCQl9CQkJCQkJCisKKwkJ
CQkJb3JnLmVjbGlwc2UuamR0LmludGVybmFsLmNvbXBpbGVyLmxvb2t1cC5UeXBlQmluZGluZyB0
eXBlQmluZGluZyA9IHR5cGVSZWZlcmVuY2UucmVzb2x2ZWRUeXBlOworCQkJCQlib29sZWFuIGNy
ZWF0ZVBhY2thZ2VRdWFsaWZpZWRUeXBlID0gZmFsc2U7CisJCQkJCWlmICh0eXBlQmluZGluZyBp
bnN0YW5jZW9mIFJlZmVyZW5jZUJpbmRpbmcpIHsKKwkJCQkJCVJlZmVyZW5jZUJpbmRpbmcgcmVm
ZXJlbmNlQmluZGluZyA9IChSZWZlcmVuY2VCaW5kaW5nKXR5cGVCaW5kaW5nOwkJCQorCQkJCQkJ
UGFja2FnZUJpbmRpbmcgcGFja2FnZUJpbmRpbmcgPSByZWZlcmVuY2VCaW5kaW5nLmdldFBhY2th
Z2UoKTsKKwkJCQkJCWlmIChwYWNrYWdlQmluZGluZyAhPSBudWxsICYmIEFycmF5cy5lcXVhbHMo
bmFtZS50b1N0cmluZygpLnRvQ2hhckFycmF5KCksIHBhY2thZ2VCaW5kaW5nLnJlYWRhYmxlTmFt
ZSgpKSkgeworCQkJCQkJCWNyZWF0ZVBhY2thZ2VRdWFsaWZpZWRUeXBlID0gdHJ1ZTsKKwkJCQkJ
CX0KIAkJCQkJfQotCQkJCQlpZiAodGhpcy5yZXNvbHZlQmluZGluZ3MpIHsKLQkJCQkJCXJlY29y
ZE5vZGVzKHNpbXBsZU5hbWUsIHR5cGVSZWZlcmVuY2UpOwotCQkJCQkJcmVjb3JkTm9kZXMocXVh
bGlmaWVkVHlwZSwgdHlwZVJlZmVyZW5jZSk7CisJCQkJCQorCQkJCQlpZiAoY3JlYXRlUGFja2Fn
ZVF1YWxpZmllZFR5cGUgJiYgdGhpcy5hc3QuYXBpTGV2ZWwgPj0gQVNULkpMUzgpIHsKKwkJCQkJ
CVBhY2thZ2VRdWFsaWZpZWRUeXBlIHBhY2thZ2VRdWFsaWZpZWRUeXBlID0gbmV3IFBhY2thZ2VR
dWFsaWZpZWRUeXBlKHRoaXMuYXN0KTsKKwkJCQkJCXBhY2thZ2VRdWFsaWZpZWRUeXBlLnNldFF1
YWxpZmllcihuYW1lKTsKKwkJCQkJCXBhY2thZ2VRdWFsaWZpZWRUeXBlLnNldE5hbWUoY3JlYXRl
U2ltcGxlTmFtZSh0eXBlUmVmZXJlbmNlLCBwb3NpdGlvbnMsIHRva2VucywgZmlyc3RUeXBlSW5k
ZXgpKTsKKwkJCQkJCXNldFNvdXJjZUFubm90YXRpb25zQW5kQmluZGluZ3ModHlwZVJlZmVyZW5j
ZSwgcG9zaXRpb25zLCB0eXBlQW5ub3RhdGlvbnMsIGZpcnN0VHlwZUluZGV4LCAwLCBmaXJzdFR5
cGVJbmRleCwgcGFja2FnZVF1YWxpZmllZFR5cGUpOworCQkJCQkJY3VycmVudFR5cGUgPSBwYWNr
YWdlUXVhbGlmaWVkVHlwZTsJCQkJCQkJCQkJCQkJCQkJCQorCQkJCQl9IGVsc2UgeworCQkJCQkJ
U2ltcGxlVHlwZSBzaW1wbGVUeXBlID0gdGhpcy5hc3QubmV3U2ltcGxlVHlwZShuYW1lKTsJCisJ
CQkJCQlzZXRTb3VyY2VBbm5vdGF0aW9uc0FuZEJpbmRpbmdzKHR5cGVSZWZlcmVuY2UsIHBvc2l0
aW9ucywgdHlwZUFubm90YXRpb25zLCAwLCAwLCAwLCBzaW1wbGVUeXBlKTsKKwkJCQkJCWN1cnJl
bnRUeXBlID0gZ2V0UXVhbGlmaWVkVHlwZVdpdGhTb3VyY2VBbmRCaW5kaW5nKHR5cGVSZWZlcmVu
Y2UsIHBvc2l0aW9ucywgIHR5cGVBbm5vdGF0aW9ucywgdG9rZW5zLCBmaXJzdFR5cGVJbmRleCwg
c2ltcGxlVHlwZSk7CisJCQkJCQlpZiAoY3JlYXRlUGFja2FnZVF1YWxpZmllZFR5cGUpIAorCQkJ
CQkJCWN1cnJlbnRUeXBlLnNldEZsYWdzKGN1cnJlbnRUeXBlLmdldEZsYWdzKCkgfCBBU1ROb2Rl
Lk1BTEZPUk1FRCk7CiAJCQkJCX0KLQkJCQkJc3RhcnQgPSBjdXJyZW50VHlwZS5nZXRTdGFydFBv
c2l0aW9uKCk7Ci0JCQkJCWVuZCA9IHNpbXBsZU5hbWUuZ2V0U3RhcnRQb3NpdGlvbigpICsgc2lt
cGxlTmFtZS5nZXRMZW5ndGgoKSAtIDE7Ci0JCQkJCXF1YWxpZmllZFR5cGUuc2V0U291cmNlUmFu
Z2Uoc3RhcnQsIGVuZCAtIHN0YXJ0ICsgMSk7Ci0JCQkJCWN1cnJlbnRUeXBlID0gcXVhbGlmaWVk
VHlwZTsKLQkJCQkJcXVhbGlmaWVkVHlwZS5pbmRleCAgPSAxOworCQkJCQlmb3IgKGludCBpID0g
Zmlyc3RUeXBlSW5kZXggKyAxOyBpIDwgbGVudGg7ICsraSkgeworCQkJCQkJY3VycmVudFR5cGUg
PSBnZXRRdWFsaWZpZWRUeXBlV2l0aFNvdXJjZUFuZEJpbmRpbmcodHlwZVJlZmVyZW5jZSwgcG9z
aXRpb25zLCAgdHlwZUFubm90YXRpb25zLCB0b2tlbnMsIGksIGN1cnJlbnRUeXBlKTsKKwkJCQkJ
fQkJCQkJCiAJCQkJfQogCQkJCXR5cGUgPSBjdXJyZW50VHlwZTsKIAkJCX0gZWxzZSBpZiAodHlw
ZVJlZmVyZW5jZSBpbnN0YW5jZW9mIFVuaW9uVHlwZVJlZmVyZW5jZSl7CkBAIC0zODA4LDYgKzM3
ODYsNzMgQEAKIAkJcmV0dXJuIHR5cGU7CiAJfQogCisJcHJpdmF0ZSBRdWFsaWZpZWRUeXBlIGdl
dFF1YWxpZmllZFR5cGVXaXRoU291cmNlQW5kQmluZGluZyhUeXBlUmVmZXJlbmNlIHR5cGVSZWZl
cmVuY2UsIGxvbmdbXSBwb3NpdGlvbnMsCisJCQlvcmcuZWNsaXBzZS5qZHQuaW50ZXJuYWwuY29t
cGlsZXIuYXN0LkFubm90YXRpb25bXVtdIHR5cGVBbm5vdGF0aW9ucywgY2hhcltdW10gdG9rZW5z
LCBpbnQgaW5kZXgsCisJCQlUeXBlIHF1YWxpZmllcikgeworCQlTaW1wbGVOYW1lIHNpbXBsZU5h
bWUgPSBjcmVhdGVTaW1wbGVOYW1lKHR5cGVSZWZlcmVuY2UsIHBvc2l0aW9ucywgdG9rZW5zLCBp
bmRleCk7CisJCVF1YWxpZmllZFR5cGUgcXVhbGlmaWVkVHlwZSA9IG5ldyBRdWFsaWZpZWRUeXBl
KHRoaXMuYXN0KTsKKwkJcXVhbGlmaWVkVHlwZS5zZXRRdWFsaWZpZXIocXVhbGlmaWVyKTsKKwkJ
cXVhbGlmaWVkVHlwZS5zZXROYW1lKHNpbXBsZU5hbWUpOworCQlpbnQgc3RhcnQgPSBxdWFsaWZp
ZXIuZ2V0U3RhcnRQb3NpdGlvbigpOworCQlpbnQgZW5kID0gc2ltcGxlTmFtZS5nZXRTdGFydFBv
c2l0aW9uKCkgKyBzaW1wbGVOYW1lLmdldExlbmd0aCgpIC0gMTsKKwkJc2V0U291cmNlQW5ub3Rh
dGlvbnNBbmRCaW5kaW5ncyh0eXBlUmVmZXJlbmNlLCB0eXBlQW5ub3RhdGlvbnMsIGluZGV4LCBz
dGFydCwgZW5kLCBxdWFsaWZpZWRUeXBlKTsKKwkJcmV0dXJuIHF1YWxpZmllZFR5cGU7CisJfQor
CisJcHJpdmF0ZSBTaW1wbGVUeXBlIGdldFNpbXBsZVR5cGVXaXRoTmFtZUFuZEJpbmRpbmcoTmFt
ZSBuYW1lLCBUeXBlUmVmZXJlbmNlIHR5cGVSZWZlcmVuY2UsIGxvbmdbXSBwb3NpdGlvbnMsCisJ
CQlpbnQgc3RhcnRJbmRleCwgaW50IGVuZEluZGV4KSB7CisJCVNpbXBsZVR5cGUgc2ltcGxlVHlw
ZSA9IG5ldyBTaW1wbGVUeXBlKHRoaXMuYXN0KTsKKwkJc2ltcGxlVHlwZS5zZXROYW1lKG5hbWUp
OworCQlpbnQgc3RhcnQgPSAoaW50KShwb3NpdGlvbnNbc3RhcnRJbmRleF0gPj4+IDMyKTsKKwkJ
aW50IGVuZCA9IChpbnQpcG9zaXRpb25zW2VuZEluZGV4XTsKKwkJc2ltcGxlVHlwZS5zZXRTb3Vy
Y2VSYW5nZShzdGFydCwgZW5kIC0gc3RhcnQgKyAxKTsKKwkJaWYgKHRoaXMucmVzb2x2ZUJpbmRp
bmdzKSB7CisJCQlyZWNvcmROb2RlcyhzaW1wbGVUeXBlLCB0eXBlUmVmZXJlbmNlKTsKKwkJfQor
CQlyZXR1cm4gc2ltcGxlVHlwZTsKKwl9CisKKwlwcml2YXRlIHZvaWQgc2V0U291cmNlQW5ub3Rh
dGlvbnNBbmRCaW5kaW5ncyhUeXBlUmVmZXJlbmNlIHR5cGVSZWZlcmVuY2UsIAorCQkJb3JnLmVj
bGlwc2UuamR0LmludGVybmFsLmNvbXBpbGVyLmFzdC5Bbm5vdGF0aW9uW11bXSB0eXBlQW5ub3Rh
dGlvbnMsIGludCBpbmRleCwgaW50IHN0YXJ0LCBpbnQgZW5kLAorCQkJQW5ub3RhdGFibGVUeXBl
IGFubm90YXRhYmxlVHlwZSkgeworCQlvcmcuZWNsaXBzZS5qZHQuaW50ZXJuYWwuY29tcGlsZXIu
YXN0LkFubm90YXRpb25bXSBhbm5vdGF0aW9uczsKKwkJaW50IGFubm90YXRpb25zU3RhcnQgPSBz
dGFydDsKKwkJaW50IGxlbmd0aCA9IGVuZCAtIHN0YXJ0ICsgMTsKKwkJaWYgKHR5cGVBbm5vdGF0
aW9ucyAhPSBudWxsICYmIChhbm5vdGF0aW9ucyA9IHR5cGVBbm5vdGF0aW9uc1tpbmRleF0pICE9
IG51bGwpIHsKKwkJCWFubm90YXRlVHlwZShhbm5vdGF0YWJsZVR5cGUsIGFubm90YXRpb25zKTsK
KwkJCWlmIChhbm5vdGF0aW9uc1swXSAhPSBudWxsICYmIChhbm5vdGF0aW9uc1N0YXJ0ID0gYW5u
b3RhdGlvbnNbMF0uc291cmNlU3RhcnQpIDwgc3RhcnQpIHsKKwkJCQlsZW5ndGggKz0gYW5ub3Rh
dGlvbnNTdGFydCA+IDAgPyBzdGFydCAtIGFubm90YXRpb25zU3RhcnQgOiAwOworCQkJCXN0YXJ0
ID0gYW5ub3RhdGlvbnNTdGFydDsKKwkJCX0KKwkJfQorCQlhbm5vdGF0YWJsZVR5cGUuc2V0U291
cmNlUmFuZ2Uoc3RhcnQsIGxlbmd0aCk7CisJCWlmICh0aGlzLnJlc29sdmVCaW5kaW5ncykgewor
CQkJcmVjb3JkTm9kZXMoYW5ub3RhdGFibGVUeXBlLCB0eXBlUmVmZXJlbmNlKTsKKwkJfQorCX0K
KworCXByaXZhdGUgdm9pZCBzZXRTb3VyY2VBbm5vdGF0aW9uc0FuZEJpbmRpbmdzKFR5cGVSZWZl
cmVuY2UgdHlwZVJlZmVyZW5jZSwgbG9uZ1tdIHBvc2l0aW9ucywKKwkJCW9yZy5lY2xpcHNlLmpk
dC5pbnRlcm5hbC5jb21waWxlci5hc3QuQW5ub3RhdGlvbltdW10gdHlwZUFubm90YXRpb25zLCBp
bnQgaW5kZXgsIGludCBzdGFydEluZGV4LCBpbnQgZW5kSW5kZXgsCisJCQlBbm5vdGF0YWJsZVR5
cGUgYW5ub3RhdGFibGVUeXBlKSB7CisJCWludCBzdGFydCA9IChpbnQpIChwb3NpdGlvbnNbc3Rh
cnRJbmRleF0gPj4+IDMyKTsKKwkJaW50IGVuZCA9IChpbnQpIHBvc2l0aW9uc1tlbmRJbmRleF07
CisJCXNldFNvdXJjZUFubm90YXRpb25zQW5kQmluZGluZ3ModHlwZVJlZmVyZW5jZSwgdHlwZUFu
bm90YXRpb25zLCBpbmRleCwgc3RhcnQsIGVuZCwgYW5ub3RhdGFibGVUeXBlKTsKKwl9CisKKwlw
cml2YXRlIFNpbXBsZU5hbWUgY3JlYXRlU2ltcGxlTmFtZShUeXBlUmVmZXJlbmNlIHR5cGVSZWZl
cmVuY2UsIGxvbmdbXSBwb3NpdGlvbnMsIGNoYXJbXVtdIHRva2VucywgaW50IGluZGV4KSB7CisJ
CWZpbmFsIFNpbXBsZU5hbWUgc2ltcGxlTmFtZSA9IG5ldyBTaW1wbGVOYW1lKHRoaXMuYXN0KTsK
KwkJc2ltcGxlTmFtZS5pbnRlcm5hbFNldElkZW50aWZpZXIobmV3IFN0cmluZyh0b2tlbnNbaW5k
ZXhdKSk7CisJCXJlY29yZFBlbmRpbmdOYW1lU2NvcGVSZXNvbHV0aW9uKHNpbXBsZU5hbWUpOwor
CQlpbnQgc3RhcnQgPSAoaW50KSAocG9zaXRpb25zW2luZGV4XSA+Pj4gMzIpOworCQlpbnQgZW5k
ID0gKGludCkgcG9zaXRpb25zW2luZGV4XTsKKwkJc2ltcGxlTmFtZS5zZXRTb3VyY2VSYW5nZShz
dGFydCwgZW5kIC0gc3RhcnQgKyAxKTsKKwkJc2ltcGxlTmFtZS5pbmRleCA9IGluZGV4ICsgMTsK
KwkJaWYgKHRoaXMucmVzb2x2ZUJpbmRpbmdzKSB7CisJCQlyZWNvcmROb2RlcyhzaW1wbGVOYW1l
LCB0eXBlUmVmZXJlbmNlKTsKKwkJfQorCQlyZXR1cm4gc2ltcGxlTmFtZTsKKwl9CisKIAlwcm90
ZWN0ZWQgQ29tbWVudCBjcmVhdGVDb21tZW50KGludFtdIHBvc2l0aW9ucykgewogCQkvLyBDcmVh
dGUgY29tbWVudCBub2RlCiAJCUNvbW1lbnQgY29tbWVudCA9IG51bGw7CmRpZmYgLS1naXQgYS9v
cmcuZWNsaXBzZS5qZHQuY29yZS9kb20vb3JnL2VjbGlwc2UvamR0L2NvcmUvZG9tL0FTVE1hdGNo
ZXIuamF2YSBiL29yZy5lY2xpcHNlLmpkdC5jb3JlL2RvbS9vcmcvZWNsaXBzZS9qZHQvY29yZS9k
b20vQVNUTWF0Y2hlci5qYXZhCmluZGV4IDNiYmM5YTkuLmQ2Y2Q3NWIgMTAwNjQ0Ci0tLSBhL29y
Zy5lY2xpcHNlLmpkdC5jb3JlL2RvbS9vcmcvZWNsaXBzZS9qZHQvY29yZS9kb20vQVNUTWF0Y2hl
ci5qYXZhCisrKyBiL29yZy5lY2xpcHNlLmpkdC5jb3JlL2RvbS9vcmcvZWNsaXBzZS9qZHQvY29y
ZS9kb20vQVNUTWF0Y2hlci5qYXZhCkBAIC0xNTY5LDYgKzE1NjksMzEgQEAKIAkgKiBAcmV0dXJu
IDxjb2RlPnRydWU8L2NvZGU+IGlmIHRoZSBzdWJ0cmVlIG1hdGNoZXMsIG9yCiAJICogICA8Y29k
ZT5mYWxzZTwvY29kZT4gaWYgdGhleSBkbyBub3QgbWF0Y2ggb3IgdGhlIG90aGVyIG9iamVjdCBo
YXMgYQogCSAqICAgZGlmZmVyZW50IG5vZGUgdHlwZSBvciBpcyA8Y29kZT5udWxsPC9jb2RlPgor
CSAqIEBzaW5jZSAzLjkgQkVUQV9KQVZBOAorCSAqLworCXB1YmxpYyBib29sZWFuIG1hdGNoKFBh
Y2thZ2VRdWFsaWZpZWRUeXBlIG5vZGUsIE9iamVjdCBvdGhlcikgeworCQlpZiAoIShvdGhlciBp
bnN0YW5jZW9mIFBhY2thZ2VRdWFsaWZpZWRUeXBlKSkgeworCQkJcmV0dXJuIGZhbHNlOworCQl9
CisJCVBhY2thZ2VRdWFsaWZpZWRUeXBlIG8gPSAoUGFja2FnZVF1YWxpZmllZFR5cGUpIG90aGVy
OworCQlyZXR1cm4gc2FmZVN1YnRyZWVNYXRjaChub2RlLmdldFF1YWxpZmllcigpLCBvLmdldFF1
YWxpZmllcigpKQorCQkJCSYmIHNhZmVTdWJ0cmVlTGlzdE1hdGNoKG5vZGUuYW5ub3RhdGlvbnMo
KSwgby5hbm5vdGF0aW9ucygpKQorCQkJCSYmIHNhZmVTdWJ0cmVlTWF0Y2gobm9kZS5nZXROYW1l
KCksIG8uZ2V0TmFtZSgpKTsKKwl9CisKKwkvKioKKwkgKiBSZXR1cm5zIHdoZXRoZXIgdGhlIGdp
dmVuIG5vZGUgYW5kIHRoZSBvdGhlciBvYmplY3QgbWF0Y2guCisJICogPHA+CisJICogVGhlIGRl
ZmF1bHQgaW1wbGVtZW50YXRpb24gcHJvdmlkZWQgYnkgdGhpcyBjbGFzcyB0ZXN0cyB3aGV0aGVy
IHRoZQorCSAqIG90aGVyIG9iamVjdCBpcyBhIG5vZGUgb2YgdGhlIHNhbWUgdHlwZSB3aXRoIHN0
cnVjdHVyYWxseSBpc29tb3JwaGljCisJICogY2hpbGQgc3VidHJlZXMuIFN1YmNsYXNzZXMgbWF5
IG92ZXJyaWRlIHRoaXMgbWV0aG9kIGFzIG5lZWRlZC4KKwkgKiA8L3A+CisJICoKKwkgKiBAcGFy
YW0gbm9kZSB0aGUgbm9kZQorCSAqIEBwYXJhbSBvdGhlciB0aGUgb3RoZXIgb2JqZWN0LCBvciA8
Y29kZT5udWxsPC9jb2RlPgorCSAqIEByZXR1cm4gPGNvZGU+dHJ1ZTwvY29kZT4gaWYgdGhlIHN1
YnRyZWUgbWF0Y2hlcywgb3IKKwkgKiAgIDxjb2RlPmZhbHNlPC9jb2RlPiBpZiB0aGV5IGRvIG5v
dCBtYXRjaCBvciB0aGUgb3RoZXIgb2JqZWN0IGhhcyBhCisJICogICBkaWZmZXJlbnQgbm9kZSB0
eXBlIG9yIGlzIDxjb2RlPm51bGw8L2NvZGU+CiAJICogQHNpbmNlIDMuMQogCSAqLwogCXB1Ymxp
YyBib29sZWFuIG1hdGNoKFBhcmFtZXRlcml6ZWRUeXBlIG5vZGUsIE9iamVjdCBvdGhlcikgewpk
aWZmIC0tZ2l0IGEvb3JnLmVjbGlwc2UuamR0LmNvcmUvZG9tL29yZy9lY2xpcHNlL2pkdC9jb3Jl
L2RvbS9BU1ROb2RlLmphdmEgYi9vcmcuZWNsaXBzZS5qZHQuY29yZS9kb20vb3JnL2VjbGlwc2Uv
amR0L2NvcmUvZG9tL0FTVE5vZGUuamF2YQppbmRleCAxZjdhOTQ2Li5kZDZhMzQ2IDEwMDY0NAot
LS0gYS9vcmcuZWNsaXBzZS5qZHQuY29yZS9kb20vb3JnL2VjbGlwc2UvamR0L2NvcmUvZG9tL0FT
VE5vZGUuamF2YQorKysgYi9vcmcuZWNsaXBzZS5qZHQuY29yZS9kb20vb3JnL2VjbGlwc2UvamR0
L2NvcmUvZG9tL0FTVE5vZGUuamF2YQpAQCAtODYwLDYgKzg2MCwxNCBAQAogCXB1YmxpYyBzdGF0
aWMgZmluYWwgaW50IElOVEVSU0VDVElPTl9UWVBFID0gODc7CiAKIAkvKioKKwkgKiBOb2RlIHR5
cGUgY29uc3RhbnQgaW5kaWNhdGluZyBhIG5vZGUgb2YgdHlwZQorCSAqIDxjb2RlPlF1YWxpZmll
ZFR5cGU8L2NvZGU+LgorCSAqIEBzZWUgUXVhbGlmaWVkVHlwZQorCSAqIEBzaW5jZSAzLjkgQkVU
QV9KQVY4CisJICovCisJcHVibGljIHN0YXRpYyBmaW5hbCBpbnQgUEFDS0FHRV9RVUFMSUZJRURf
VFlQRSA9IDg3OworCisJLyoqCiAJICogUmV0dXJucyB0aGUgbm9kZSBjbGFzcyBmb3IgdGhlIGNv
cnJlc3BvbmRpbmcgbm9kZSB0eXBlLgogCSAqCiAJICogQHBhcmFtIG5vZGVUeXBlIEFTVCBub2Rl
IHR5cGUKQEAgLTk3Nyw2ICs5ODUsOCBAQAogCQkJCXJldHVybiBOdW1iZXJMaXRlcmFsLmNsYXNz
OwogCQkJY2FzZSBQQUNLQUdFX0RFQ0xBUkFUSU9OIDoKIAkJCQlyZXR1cm4gUGFja2FnZURlY2xh
cmF0aW9uLmNsYXNzOworCQkJY2FzZSBQQUNLQUdFX1FVQUxJRklFRF9UWVBFIDoKKwkJCQlyZXR1
cm4gUGFja2FnZVF1YWxpZmllZFR5cGUuY2xhc3M7CiAJCQljYXNlIFBBUkFNRVRFUklaRURfVFlQ
RSA6CiAJCQkJcmV0dXJuIFBhcmFtZXRlcml6ZWRUeXBlLmNsYXNzOwogCQkJY2FzZSBQQVJFTlRI
RVNJWkVEX0VYUFJFU1NJT04gOgpkaWZmIC0tZ2l0IGEvb3JnLmVjbGlwc2UuamR0LmNvcmUvZG9t
L29yZy9lY2xpcHNlL2pkdC9jb3JlL2RvbS9BU1RWaXNpdG9yLmphdmEgYi9vcmcuZWNsaXBzZS5q
ZHQuY29yZS9kb20vb3JnL2VjbGlwc2UvamR0L2NvcmUvZG9tL0FTVFZpc2l0b3IuamF2YQppbmRl
eCAwMGM4MGZjLi41Zjc3Y2U5IDEwMDY0NAotLS0gYS9vcmcuZWNsaXBzZS5qZHQuY29yZS9kb20v
b3JnL2VjbGlwc2UvamR0L2NvcmUvZG9tL0FTVFZpc2l0b3IuamF2YQorKysgYi9vcmcuZWNsaXBz
ZS5qZHQuY29yZS9kb20vb3JnL2VjbGlwc2UvamR0L2NvcmUvZG9tL0FTVFZpc2l0b3IuamF2YQpA
QCAtMTA3Miw2ICsxMDcyLDIzIEBACiAJICogQHJldHVybiA8Y29kZT50cnVlPC9jb2RlPiBpZiB0
aGUgY2hpbGRyZW4gb2YgdGhpcyBub2RlIHNob3VsZCBiZQogCSAqIHZpc2l0ZWQsIGFuZCA8Y29k
ZT5mYWxzZTwvY29kZT4gaWYgdGhlIGNoaWxkcmVuIG9mIHRoaXMgbm9kZSBzaG91bGQKIAkgKiBi
ZSBza2lwcGVkCisJICogQHNpbmNlIDMuOSBCRVRBX0pBVkE4CisJICovCisJcHVibGljIGJvb2xl
YW4gdmlzaXQoUGFja2FnZVF1YWxpZmllZFR5cGUgbm9kZSkgeworCQlyZXR1cm4gdHJ1ZTsKKwl9
CisKKwkvKioKKwkgKiBWaXNpdHMgdGhlIGdpdmVuIHR5cGUtc3BlY2lmaWMgQVNUIG5vZGUuCisJ
ICogPHA+CisJICogVGhlIGRlZmF1bHQgaW1wbGVtZW50YXRpb24gZG9lcyBub3RoaW5nIGFuZCBy
ZXR1cm4gdHJ1ZS4KKwkgKiBTdWJjbGFzc2VzIG1heSByZWltcGxlbWVudC4KKwkgKiA8L3A+CisJ
ICoKKwkgKiBAcGFyYW0gbm9kZSB0aGUgbm9kZSB0byB2aXNpdAorCSAqIEByZXR1cm4gPGNvZGU+
dHJ1ZTwvY29kZT4gaWYgdGhlIGNoaWxkcmVuIG9mIHRoaXMgbm9kZSBzaG91bGQgYmUKKwkgKiB2
aXNpdGVkLCBhbmQgPGNvZGU+ZmFsc2U8L2NvZGU+IGlmIHRoZSBjaGlsZHJlbiBvZiB0aGlzIG5v
ZGUgc2hvdWxkCisJICogYmUgc2tpcHBlZAogCSAqIEBzaW5jZSAzLjEKIAkgKi8KIAlwdWJsaWMg
Ym9vbGVhbiB2aXNpdChQYXJhbWV0ZXJpemVkVHlwZSBub2RlKSB7CkBAIC0yMjkxLDYgKzIzMDgs
MTkgQEAKIAkgKiA8L3A+CiAJICoKIAkgKiBAcGFyYW0gbm9kZSB0aGUgbm9kZSB0byB2aXNpdAor
CSAqIEBzaW5jZSAzLjkgQkVUQV9KQVZBOAorCSAqLworCXB1YmxpYyB2b2lkIGVuZFZpc2l0KFBh
Y2thZ2VRdWFsaWZpZWRUeXBlIG5vZGUpIHsKKwkJLy8gZGVmYXVsdCBpbXBsZW1lbnRhdGlvbjog
ZG8gbm90aGluZworCX0KKworCS8qKgorCSAqIEVuZCBvZiB2aXNpdCB0aGUgZ2l2ZW4gdHlwZS1z
cGVjaWZpYyBBU1Qgbm9kZS4KKwkgKiA8cD4KKwkgKiBUaGUgZGVmYXVsdCBpbXBsZW1lbnRhdGlv
biBkb2VzIG5vdGhpbmcuIFN1YmNsYXNzZXMgbWF5IHJlaW1wbGVtZW50LgorCSAqIDwvcD4KKwkg
KgorCSAqIEBwYXJhbSBub2RlIHRoZSBub2RlIHRvIHZpc2l0CiAJICogQHNpbmNlIDMuMQogCSAq
LwogCXB1YmxpYyB2b2lkIGVuZFZpc2l0KFBhcmFtZXRlcml6ZWRUeXBlIG5vZGUpIHsKZGlmZiAt
LWdpdCBhL29yZy5lY2xpcHNlLmpkdC5jb3JlL2RvbS9vcmcvZWNsaXBzZS9qZHQvY29yZS9kb20v
RGVmYXVsdEFTVFZpc2l0b3IuamF2YSBiL29yZy5lY2xpcHNlLmpkdC5jb3JlL2RvbS9vcmcvZWNs
aXBzZS9qZHQvY29yZS9kb20vRGVmYXVsdEFTVFZpc2l0b3IuamF2YQppbmRleCA4NzA5Yjg2Li40
ODdjYTE4IDEwMDY0NAotLS0gYS9vcmcuZWNsaXBzZS5qZHQuY29yZS9kb20vb3JnL2VjbGlwc2Uv
amR0L2NvcmUvZG9tL0RlZmF1bHRBU1RWaXNpdG9yLmphdmEKKysrIGIvb3JnLmVjbGlwc2UuamR0
LmNvcmUvZG9tL29yZy9lY2xpcHNlL2pkdC9jb3JlL2RvbS9EZWZhdWx0QVNUVmlzaXRvci5qYXZh
CkBAIC0xODIsNiArMTgyLDkgQEAKIAlwdWJsaWMgdm9pZCBlbmRWaXNpdChQYWNrYWdlRGVjbGFy
YXRpb24gbm9kZSkgewogCQllbmRWaXNpdE5vZGUobm9kZSk7CiAJfQorCXB1YmxpYyB2b2lkIGVu
ZFZpc2l0KFBhY2thZ2VRdWFsaWZpZWRUeXBlIG5vZGUpIHsKKwkJZW5kVmlzaXROb2RlKG5vZGUp
OworCX0KIAlwdWJsaWMgdm9pZCBlbmRWaXNpdChQYXJhbWV0ZXJpemVkVHlwZSBub2RlKSB7CiAJ
CWVuZFZpc2l0Tm9kZShub2RlKTsKIAl9CkBAIC00NDgsNiArNDUxLDkgQEAKIAlwdWJsaWMgYm9v
bGVhbiB2aXNpdChQYWNrYWdlRGVjbGFyYXRpb24gbm9kZSkgewogCQlyZXR1cm4gdmlzaXROb2Rl
KG5vZGUpOwogCX0KKwlwdWJsaWMgYm9vbGVhbiB2aXNpdChQYWNrYWdlUXVhbGlmaWVkVHlwZSBu
b2RlKSB7CisJCXJldHVybiB2aXNpdE5vZGUobm9kZSk7CisJfQogCXB1YmxpYyBib29sZWFuIHZp
c2l0KFBhcmFtZXRlcml6ZWRUeXBlIG5vZGUpIHsKIAkJcmV0dXJuIHZpc2l0Tm9kZShub2RlKTsK
IAl9CmRpZmYgLS1naXQgYS9vcmcuZWNsaXBzZS5qZHQuY29yZS9kb20vb3JnL2VjbGlwc2UvamR0
L2NvcmUvZG9tL1BhY2thZ2VRdWFsaWZpZWRUeXBlLmphdmEgYi9vcmcuZWNsaXBzZS5qZHQuY29y
ZS9kb20vb3JnL2VjbGlwc2UvamR0L2NvcmUvZG9tL1BhY2thZ2VRdWFsaWZpZWRUeXBlLmphdmEK
bmV3IGZpbGUgbW9kZSAxMDA2NDQKaW5kZXggMDAwMDAwMC4uMTczMDUzZAotLS0gL2Rldi9udWxs
CisrKyBiL29yZy5lY2xpcHNlLmpkdC5jb3JlL2RvbS9vcmcvZWNsaXBzZS9qZHQvY29yZS9kb20v
UGFja2FnZVF1YWxpZmllZFR5cGUuamF2YQpAQCAtMCwwICsxLDI4NSBAQAorLyoqKioqKioqKioq
KioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioq
KioqKioqKioqKioKKyAqIENvcHlyaWdodCAoYykgMjAwMywgMjAxMyBJQk0gQ29ycG9yYXRpb24g
YW5kIG90aGVycy4KKyAqIEFsbCByaWdodHMgcmVzZXJ2ZWQuIFRoaXMgcHJvZ3JhbSBhbmQgdGhl
IGFjY29tcGFueWluZyBtYXRlcmlhbHMKKyAqIGFyZSBtYWRlIGF2YWlsYWJsZSB1bmRlciB0aGUg
dGVybXMgb2YgdGhlIEVjbGlwc2UgUHVibGljIExpY2Vuc2UgdjEuMAorICogd2hpY2ggYWNjb21w
YW5pZXMgdGhpcyBkaXN0cmlidXRpb24sIGFuZCBpcyBhdmFpbGFibGUgYXQKKyAqIGh0dHA6Ly93
d3cuZWNsaXBzZS5vcmcvbGVnYWwvZXBsLXYxMC5odG1sCisgKgorICogVGhpcyBpcyBhbiBpbXBs
ZW1lbnRhdGlvbiBvZiBhbiBlYXJseS1kcmFmdCBzcGVjaWZpY2F0aW9uIGRldmVsb3BlZCB1bmRl
ciB0aGUgSmF2YQorICogQ29tbXVuaXR5IFByb2Nlc3MgKEpDUCkgYW5kIGlzIG1hZGUgYXZhaWxh
YmxlIGZvciB0ZXN0aW5nIGFuZCBldmFsdWF0aW9uIHB1cnBvc2VzCisgKiBvbmx5LiBUaGUgY29k
ZSBpcyBub3QgY29tcGF0aWJsZSB3aXRoIGFueSBzcGVjaWZpY2F0aW9uIG9mIHRoZSBKQ1AuCisg
KiAKKyAqIENvbnRyaWJ1dG9yczoKKyAqICAgICBJQk0gQ29ycG9yYXRpb24gLSBpbml0aWFsIEFQ
SSBhbmQgaW1wbGVtZW50YXRpb24KKyAqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioq
KioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqLworCitwYWNrYWdl
IG9yZy5lY2xpcHNlLmpkdC5jb3JlLmRvbTsKKworaW1wb3J0IGphdmEudXRpbC5BcnJheUxpc3Q7
CitpbXBvcnQgamF2YS51dGlsLkxpc3Q7CisKKy8qKgorICogTm9kZSBmb3IgYSBwYWNrYWdlIHF1
YWxpZmllZCB0eXBlIChhZGRlZCBpbiBKTFM4IEFQSSkuCisgKiAKKyAqIDxwcmU+CisgKiBQYWNr
YWdlUXVhbGlmaWVkVHlwZToKKyAqICAgIE5hbWUgPGI+LjwvYj4geyBBbm5vdGF0aW9uIH0gU2lt
cGxlTmFtZQorICogPC9wcmU+CisgKgorICogQHNpbmNlIDMuOSBCRVRBX0pBVkE4CisgKiBAbm9p
bnN0YW50aWF0ZSBUaGlzIGNsYXNzIGlzIG5vdCBpbnRlbmRlZCB0byBiZSBpbnN0YW50aWF0ZWQg
YnkgY2xpZW50cy4KKyAqLworcHVibGljIGNsYXNzIFBhY2thZ2VRdWFsaWZpZWRUeXBlIGV4dGVu
ZHMgQW5ub3RhdGFibGVUeXBlIHsKKworCS8qKgorCSAqIFRoZSAicXVhbGlmaWVyIiBzdHJ1Y3R1
cmFsIHByb3BlcnR5IG9mIHRoaXMgbm9kZSB0eXBlIChjaGlsZCB0eXBlOiB7QGxpbmsgTmFtZX0p
LgorCSAqLworCXB1YmxpYyBzdGF0aWMgZmluYWwgQ2hpbGRQcm9wZXJ0eURlc2NyaXB0b3IgUVVB
TElGSUVSX1BST1BFUlRZID0KKwkJbmV3IENoaWxkUHJvcGVydHlEZXNjcmlwdG9yKFBhY2thZ2VR
dWFsaWZpZWRUeXBlLmNsYXNzLCAicXVhbGlmaWVyIiwgTmFtZS5jbGFzcywgTUFOREFUT1JZLCBO
T19DWUNMRV9SSVNLKTsgLy8kTk9OLU5MUy0xJAorCisJLyoqCisJICogVGhlICJhbm5vdGF0aW9u
cyIgc3RydWN0dXJhbCBwcm9wZXJ0eSBvZiB0aGlzIG5vZGUgdHlwZSAoZWxlbWVudCB0eXBlOiB7
QGxpbmsgQW5ub3RhdGlvbn0pLgorCSAqLworCXB1YmxpYyBzdGF0aWMgZmluYWwgQ2hpbGRMaXN0
UHJvcGVydHlEZXNjcmlwdG9yIEFOTk9UQVRJT05TX1BST1BFUlRZID0KKwkJCWludGVybmFsQW5u
b3RhdGlvbnNQcm9wZXJ0eUZhY3RvcnkoUGFja2FnZVF1YWxpZmllZFR5cGUuY2xhc3MpOworCQor
CS8qKgorCSAqIFRoZSAibmFtZSIgc3RydWN0dXJhbCBwcm9wZXJ0eSBvZiB0aGlzIG5vZGUgdHlw
ZSAoY2hpbGQgdHlwZToge0BsaW5rIFNpbXBsZU5hbWV9KS4KKwkgKi8KKwlwdWJsaWMgc3RhdGlj
IGZpbmFsIENoaWxkUHJvcGVydHlEZXNjcmlwdG9yIE5BTUVfUFJPUEVSVFkgPQorCQluZXcgQ2hp
bGRQcm9wZXJ0eURlc2NyaXB0b3IoUGFja2FnZVF1YWxpZmllZFR5cGUuY2xhc3MsICJuYW1lIiwg
U2ltcGxlTmFtZS5jbGFzcywgTUFOREFUT1JZLCBOT19DWUNMRV9SSVNLKTsgLy8kTk9OLU5MUy0x
JAorCQorCS8qKgorCSAqIEEgbGlzdCBvZiBwcm9wZXJ0eSBkZXNjcmlwdG9ycyAoZWxlbWVudCB0
eXBlOgorCSAqIHtAbGluayBTdHJ1Y3R1cmFsUHJvcGVydHlEZXNjcmlwdG9yfSksCisJICogb3Ig
bnVsbCBpZiB1bmluaXRpYWxpemVkLgorCSAqLworCXByaXZhdGUgc3RhdGljIGZpbmFsIExpc3Qg
UFJPUEVSVFlfREVTQ1JJUFRPUlM7CisKKwlzdGF0aWMgeworCQlMaXN0IHByb3BlcnR5TGlzdCA9
IG5ldyBBcnJheUxpc3QoNCk7CisJCWNyZWF0ZVByb3BlcnR5TGlzdChQYWNrYWdlUXVhbGlmaWVk
VHlwZS5jbGFzcywgcHJvcGVydHlMaXN0KTsKKwkJYWRkUHJvcGVydHkoUVVBTElGSUVSX1BST1BF
UlRZLCBwcm9wZXJ0eUxpc3QpOworCQlhZGRQcm9wZXJ0eShBTk5PVEFUSU9OU19QUk9QRVJUWSwg
cHJvcGVydHlMaXN0KTsKKwkJYWRkUHJvcGVydHkoTkFNRV9QUk9QRVJUWSwgcHJvcGVydHlMaXN0
KTsKKwkJUFJPUEVSVFlfREVTQ1JJUFRPUlMgPSByZWFwUHJvcGVydHlMaXN0KHByb3BlcnR5TGlz
dCk7CisJfQorCisJLyoqCisJICogUmV0dXJucyBhIGxpc3Qgb2Ygc3RydWN0dXJhbCBwcm9wZXJ0
eSBkZXNjcmlwdG9ycyBmb3IgdGhpcyBub2RlIHR5cGUuCisJICogQ2xpZW50cyBtdXN0IG5vdCBt
b2RpZnkgdGhlIHJlc3VsdC4KKwkgKgorCSAqIEBwYXJhbSBhcGlMZXZlbCB0aGUgQVBJIGxldmVs
OyBvbmUgb2YgdGhlCisJICogPGNvZGU+QVNULkpMUyo8L2NvZGU+IGNvbnN0YW50cworCSAqIEBy
ZXR1cm4gYSBsaXN0IG9mIHByb3BlcnR5IGRlc2NyaXB0b3JzIChlbGVtZW50IHR5cGU6CisJICog
e0BsaW5rIFN0cnVjdHVyYWxQcm9wZXJ0eURlc2NyaXB0b3J9KQorCSAqLworCXB1YmxpYyBzdGF0
aWMgTGlzdCBwcm9wZXJ0eURlc2NyaXB0b3JzKGludCBhcGlMZXZlbCkgeworCQlyZXR1cm4gUFJP
UEVSVFlfREVTQ1JJUFRPUlM7CisJfQorCisJLyoqCisJICogVGhlIHF1YWxpZmllciBub2RlOyBs
YXppbHkgaW5pdGlhbGl6ZWQ7IGRlZmF1bHRzIHRvIAorCSAqIGFuIHVuc3BlY2lmaWVkLCBidXQg
bGVnYWwsIHNpbXBsZSBuYW1lLgorCSAqLworCXByaXZhdGUgTmFtZSBxdWFsaWZpZXIgPSBudWxs
OworCisJLyoqCisJICogVGhlIG5hbWUgYmVpbmcgcXVhbGlmaWVkOyBsYXppbHkgaW5pdGlhbGl6
ZWQ7IGRlZmF1bHRzIHRvIGEgdW5zcGVjaWZpZWQsCisJICogbGVnYWwgSmF2YSBpZGVudGlmaWVy
LgorCSAqLworCXByaXZhdGUgU2ltcGxlTmFtZSBuYW1lID0gbnVsbDsKKworCS8qKgorCSAqIENy
ZWF0ZXMgYSBuZXcgdW5wYXJlbnRlZCBub2RlIGZvciBhIHBhY2thZ2UgcXVhbGlmaWVkIHR5cGUg
b3duZWQgYnkgdGhlCisJICogZ2l2ZW4gQVNULiBCeSBkZWZhdWx0LCBhbiB1bnNwZWNpZmllZCwg
YnV0IGxlZ2FsLCBxdWFsaWZpZXIgYW5kIG5hbWUuCisJICogPHA+CisJICogTi5CLiBUaGlzIGNv
bnN0cnVjdG9yIGlzIHBhY2thZ2UtcHJpdmF0ZS4KKwkgKiA8L3A+CisJICoKKwkgKiBAcGFyYW0g
YXN0IHRoZSBBU1QgdGhhdCBpcyB0byBvd24gdGhpcyBub2RlCisJICovCisJUGFja2FnZVF1YWxp
ZmllZFR5cGUoQVNUIGFzdCkgeworCQlzdXBlcihhc3QpOworCSAgICB1bnN1cHBvcnRlZEluMl8z
XzQoKTsKKwl9CisKKwkvKiAob21pdCBqYXZhZG9jIGZvciB0aGlzIG1ldGhvZCkKKwkgKiBNZXRo
b2QgZGVjbGFyZWQgb24gQW5ub3RhdGFibGVUeXBlLgorCSAqLworCUNoaWxkTGlzdFByb3BlcnR5
RGVzY3JpcHRvciBpbnRlcm5hbEFubm90YXRpb25zUHJvcGVydHkoKSB7CisJCXJldHVybiBBTk5P
VEFUSU9OU19QUk9QRVJUWTsKKwl9CisKKwkvKiAob21pdCBqYXZhZG9jIGZvciB0aGlzIG1ldGhv
ZCkKKwkgKiBNZXRob2QgZGVjbGFyZWQgb24gQVNUTm9kZS4KKwkgKi8KKwlMaXN0IGludGVybmFs
U3RydWN0dXJhbFByb3BlcnRpZXNGb3JUeXBlKGludCBhcGlMZXZlbCkgeworCQlyZXR1cm4gcHJv
cGVydHlEZXNjcmlwdG9ycyhhcGlMZXZlbCk7CisJfQorCisJLyogKG9taXQgamF2YWRvYyBmb3Ig
dGhpcyBtZXRob2QpCisJICogTWV0aG9kIGRlY2xhcmVkIG9uIEFTVE5vZGUuCisJICovCisJZmlu
YWwgTGlzdCBpbnRlcm5hbEdldENoaWxkTGlzdFByb3BlcnR5KENoaWxkTGlzdFByb3BlcnR5RGVz
Y3JpcHRvciBwcm9wZXJ0eSkgeworCQlpZiAocHJvcGVydHkgPT0gQU5OT1RBVElPTlNfUFJPUEVS
VFkpIHsKKwkJCXJldHVybiBhbm5vdGF0aW9ucygpOworCQl9CisJCS8vIGFsbG93IGRlZmF1bHQg
aW1wbGVtZW50YXRpb24gdG8gZmxhZyB0aGUgZXJyb3IKKwkJcmV0dXJuIHN1cGVyLmludGVybmFs
R2V0Q2hpbGRMaXN0UHJvcGVydHkocHJvcGVydHkpOworCX0KKwkKKwkvKiAob21pdCBqYXZhZG9j
IGZvciB0aGlzIG1ldGhvZCkKKwkgKiBNZXRob2QgZGVjbGFyZWQgb24gQVNUTm9kZS4KKwkgKi8K
KwlmaW5hbCBBU1ROb2RlIGludGVybmFsR2V0U2V0Q2hpbGRQcm9wZXJ0eShDaGlsZFByb3BlcnR5
RGVzY3JpcHRvciBwcm9wZXJ0eSwgYm9vbGVhbiBnZXQsIEFTVE5vZGUgY2hpbGQpIHsKKwkJaWYg
KHByb3BlcnR5ID09IFFVQUxJRklFUl9QUk9QRVJUWSkgeworCQkJaWYgKGdldCkgeworCQkJCXJl
dHVybiBnZXRRdWFsaWZpZXIoKTsKKwkJCX0gZWxzZSB7CisJCQkJc2V0UXVhbGlmaWVyKChOYW1l
KSBjaGlsZCk7CisJCQkJcmV0dXJuIG51bGw7CisJCQl9CisJCX0KKwkJaWYgKHByb3BlcnR5ID09
IE5BTUVfUFJPUEVSVFkpIHsKKwkJCWlmIChnZXQpIHsKKwkJCQlyZXR1cm4gZ2V0TmFtZSgpOwor
CQkJfSBlbHNlIHsKKwkJCQlzZXROYW1lKChTaW1wbGVOYW1lKSBjaGlsZCk7CisJCQkJcmV0dXJu
IG51bGw7CisJCQl9CisJCX0KKwkJLy8gYWxsb3cgZGVmYXVsdCBpbXBsZW1lbnRhdGlvbiB0byBm
bGFnIHRoZSBlcnJvcgorCQlyZXR1cm4gc3VwZXIuaW50ZXJuYWxHZXRTZXRDaGlsZFByb3BlcnR5
KHByb3BlcnR5LCBnZXQsIGNoaWxkKTsKKwl9CisKKwlpbnQgZ2V0Tm9kZVR5cGUwKCkgeworCQly
ZXR1cm4gUEFDS0FHRV9RVUFMSUZJRURfVFlQRTsKKwl9CisKKwlib29sZWFuIHN1YnRyZWVNYXRj
aDAoQVNUTWF0Y2hlciBtYXRjaGVyLCBPYmplY3Qgb3RoZXIpIHsKKwkJLy8gZGlzcGF0Y2ggdG8g
Y29ycmVjdCBvdmVybG9hZGVkIG1hdGNoIG1ldGhvZAorCQlyZXR1cm4gbWF0Y2hlci5tYXRjaCh0
aGlzLCBvdGhlcik7CisJfQorCisJQVNUTm9kZSBjbG9uZTAoQVNUIHRhcmdldCkgeworCQlQYWNr
YWdlUXVhbGlmaWVkVHlwZSByZXN1bHQgPSBuZXcgUGFja2FnZVF1YWxpZmllZFR5cGUodGFyZ2V0
KTsKKwkJcmVzdWx0LnNldFNvdXJjZVJhbmdlKGdldFN0YXJ0UG9zaXRpb24oKSwgZ2V0TGVuZ3Ro
KCkpOworCQlyZXN1bHQuc2V0UXVhbGlmaWVyKChOYW1lKSAoKEFTVE5vZGUpIGdldFF1YWxpZmll
cigpKS5jbG9uZSh0YXJnZXQpKTsKKwkJcmVzdWx0LmFubm90YXRpb25zKCkuYWRkQWxsKEFTVE5v
ZGUuY29weVN1YnRyZWVzKHRhcmdldCwgYW5ub3RhdGlvbnMoKSkpOworCQlyZXN1bHQuc2V0TmFt
ZSgoU2ltcGxlTmFtZSkgKChBU1ROb2RlKSBnZXROYW1lKCkpLmNsb25lKHRhcmdldCkpOworCQly
ZXR1cm4gcmVzdWx0OworCX0KKworCS8qIChvbWl0IGphdmFkb2MgZm9yIHRoaXMgbWV0aG9kKQor
CSAqIE1ldGhvZCBkZWNsYXJlZCBvbiBBU1ROb2RlLgorCSAqLworCXZvaWQgYWNjZXB0MChBU1RW
aXNpdG9yIHZpc2l0b3IpIHsKKwkJYm9vbGVhbiB2aXNpdENoaWxkcmVuID0gdmlzaXRvci52aXNp
dCh0aGlzKTsKKwkJaWYgKHZpc2l0Q2hpbGRyZW4pIHsKKwkJCS8vIHZpc2l0IGNoaWxkcmVuIGlu
IG5vcm1hbCBsZWZ0IHRvIHJpZ2h0IHJlYWRpbmcgb3JkZXIKKwkJCWFjY2VwdENoaWxkKHZpc2l0
b3IsIGdldFF1YWxpZmllcigpKTsKKwkJCWFjY2VwdENoaWxkcmVuKHZpc2l0b3IsIHRoaXMuYW5u
b3RhdGlvbnMpOworCQkJYWNjZXB0Q2hpbGQodmlzaXRvciwgZ2V0TmFtZSgpKTsKKwkJfQorCQl2
aXNpdG9yLmVuZFZpc2l0KHRoaXMpOworCX0KKworCS8qKgorCSAqIFJldHVybnMgdGhlIHF1YWxp
ZmllciBvZiB0aGlzIHBhY2thZ2UgcXVhbGlmaWVkIHR5cGUuCisJICoKKwkgKiBAcmV0dXJuIHRo
ZSBxdWFsaWZpZXIgb2YgdGhpcyBwYWNrYWdlIHF1YWxpZmllZCB0eXBlCisJICovCisJcHVibGlj
IE5hbWUgZ2V0UXVhbGlmaWVyKCkgeworCQlpZiAodGhpcy5xdWFsaWZpZXIgPT0gbnVsbCkgewor
CQkJLy8gbGF6eSBpbml0IG11c3QgYmUgdGhyZWFkLXNhZmUgZm9yIHJlYWRlcnMKKwkJCXN5bmNo
cm9uaXplZCAodGhpcykgeworCQkJCWlmICh0aGlzLnF1YWxpZmllciA9PSBudWxsKSB7CisJCQkJ
CXByZUxhenlJbml0KCk7CisJCQkJCXRoaXMucXVhbGlmaWVyID0gbmV3IFNpbXBsZU5hbWUodGhp
cy5hc3QpOworCQkJCQlwb3N0TGF6eUluaXQodGhpcy5xdWFsaWZpZXIsIFFVQUxJRklFUl9QUk9Q
RVJUWSk7CisJCQkJfQorCQkJfQorCQl9CisJCXJldHVybiB0aGlzLnF1YWxpZmllcjsKKwl9CisK
KwkvKioKKwkgKiBTZXRzIHRoZSBxdWFsaWZpZXIgb2YgdGhpcyBwYWNrYWdlIHF1YWxpZmllZCB0
eXBlIHRvIHRoZSBnaXZlbiBuYW1lLgorCSAqCisJICogQHBhcmFtIG5hbWUgdGhlIG5ldyBxdWFs
aWZpZXIgb2YgdGhpcyBwYWNrYWdlIHF1YWxpZmllZCB0eXBlCisJICogQGV4Y2VwdGlvbiBJbGxl
Z2FsQXJndW1lbnRFeGNlcHRpb24gaWY6CisJICogPHVsPgorCSAqIDxsaT50aGUgbm9kZSBiZWxv
bmdzIHRvIGEgZGlmZmVyZW50IEFTVDwvbGk+CisJICogPGxpPnRoZSBub2RlIGFscmVhZHkgaGFz
IGEgcGFyZW50PC9saT4KKwkgKiA8L3VsPgorCSAqLworCXB1YmxpYyB2b2lkIHNldFF1YWxpZmll
cihOYW1lIG5hbWUpIHsKKwkJaWYgKG5hbWUgPT0gbnVsbCkgeworCQkJdGhyb3cgbmV3IElsbGVn
YWxBcmd1bWVudEV4Y2VwdGlvbigpOworCQl9CisJCUFTVE5vZGUgb2xkQ2hpbGQgPSB0aGlzLnF1
YWxpZmllcjsKKwkJcHJlUmVwbGFjZUNoaWxkKG9sZENoaWxkLCBuYW1lLCBRVUFMSUZJRVJfUFJP
UEVSVFkpOworCQl0aGlzLnF1YWxpZmllciA9IG5hbWU7CisJCXBvc3RSZXBsYWNlQ2hpbGQob2xk
Q2hpbGQsIG5hbWUsIFFVQUxJRklFUl9QUk9QRVJUWSk7CisJfQorCisJLyoqCisJICogUmV0dXJu
cyB0aGUgbmFtZSBwYXJ0IG9mIHRoaXMgcGFja2FnZSBxdWFsaWZpZWQgdHlwZS4KKwkgKgorCSAq
IEByZXR1cm4gdGhlIG5hbWUgYmVpbmcgcXVhbGlmaWVkCisJICovCisJcHVibGljIFNpbXBsZU5h
bWUgZ2V0TmFtZSgpIHsKKwkJaWYgKHRoaXMubmFtZSA9PSBudWxsKSB7CisJCQkvLyBsYXp5IGlu
aXQgbXVzdCBiZSB0aHJlYWQtc2FmZSBmb3IgcmVhZGVycworCQkJc3luY2hyb25pemVkICh0aGlz
KSB7CisJCQkJaWYgKHRoaXMubmFtZSA9PSBudWxsKSB7CisJCQkJCXByZUxhenlJbml0KCk7CisJ
CQkJCXRoaXMubmFtZSA9IG5ldyBTaW1wbGVOYW1lKHRoaXMuYXN0KTsKKwkJCQkJcG9zdExhenlJ
bml0KHRoaXMubmFtZSwgTkFNRV9QUk9QRVJUWSk7CisJCQkJfQorCQkJfQorCQl9CisJCXJldHVy
biB0aGlzLm5hbWU7CisJfQorCisJLyoqCisJICogU2V0cyB0aGUgbmFtZSBwYXJ0IG9mIHRoaXMg
cGFja2FnZSBxdWFsaWZpZWQgdHlwZSB0byB0aGUgZ2l2ZW4gc2ltcGxlIG5hbWUuCisJICoKKwkg
KiBAcGFyYW0gbmFtZSB0aGUgaWRlbnRpZmllciBvZiB0aGlzIHF1YWxpZmllZCBuYW1lCisJICog
QGV4Y2VwdGlvbiBJbGxlZ2FsQXJndW1lbnRFeGNlcHRpb24gaWY6CisJICogPHVsPgorCSAqIDxs
aT50aGUgbm9kZSBiZWxvbmdzIHRvIGEgZGlmZmVyZW50IEFTVDwvbGk+CisJICogPGxpPnRoZSBu
b2RlIGFscmVhZHkgaGFzIGEgcGFyZW50PC9saT4KKwkgKiA8L3VsPgorCSAqLworCXB1YmxpYyB2
b2lkIHNldE5hbWUoU2ltcGxlTmFtZSBuYW1lKSB7CisJCWlmIChuYW1lID09IG51bGwpIHsKKwkJ
CXRocm93IG5ldyBJbGxlZ2FsQXJndW1lbnRFeGNlcHRpb24oKTsKKwkJfQorCQlBU1ROb2RlIG9s
ZENoaWxkID0gdGhpcy5uYW1lOworCQlwcmVSZXBsYWNlQ2hpbGQob2xkQ2hpbGQsIG5hbWUsIE5B
TUVfUFJPUEVSVFkpOworCQl0aGlzLm5hbWUgPSBuYW1lOworCQlwb3N0UmVwbGFjZUNoaWxkKG9s
ZENoaWxkLCBuYW1lLCBOQU1FX1BST1BFUlRZKTsKKwl9CisKKwkvKiAob21pdCBqYXZhZG9jIGZv
ciB0aGlzIG1ldGhvZCkKKwkgKiBNZXRob2QgZGVjbGFyZWQgb24gQVNUTm9kZS4KKwkgKi8KKwlp
bnQgbWVtU2l6ZSgpIHsKKwkJLy8gdHJlYXQgQ29kZSBhcyBmcmVlCisJCXJldHVybiBCQVNFX05P
REVfU0laRSArIDIgKiA0OworCX0KKworCS8qIChvbWl0IGphdmFkb2MgZm9yIHRoaXMgbWV0aG9k
KQorCSAqIE1ldGhvZCBkZWNsYXJlZCBvbiBBU1ROb2RlLgorCSAqLworCWludCB0cmVlU2l6ZSgp
IHsKKwkJcmV0dXJuCisJCQltZW1TaXplKCkKKwkJCSsgKHRoaXMucXVhbGlmaWVyID09IG51bGwg
PyAwIDogZ2V0UXVhbGlmaWVyKCkudHJlZVNpemUoKSkKKwkJCSsgKHRoaXMuYW5ub3RhdGlvbnMg
PT0gbnVsbCA/IDAgOiB0aGlzLmFubm90YXRpb25zLmxpc3RTaXplKCkpCisJCQkrICh0aGlzLm5h
bWUgPT0gbnVsbCA/IDAgOiBnZXROYW1lKCkudHJlZVNpemUoKSk7CisJfQorCit9CmRpZmYgLS1n
aXQgYS9vcmcuZWNsaXBzZS5qZHQuY29yZS9kb20vb3JnL2VjbGlwc2UvamR0L2NvcmUvZG9tL1R5
cGUuamF2YSBiL29yZy5lY2xpcHNlLmpkdC5jb3JlL2RvbS9vcmcvZWNsaXBzZS9qZHQvY29yZS9k
b20vVHlwZS5qYXZhCmluZGV4IDRkN2ZmMGIuLmNjNWM3ZTEgMTAwNjQ0Ci0tLSBhL29yZy5lY2xp
cHNlLmpkdC5jb3JlL2RvbS9vcmcvZWNsaXBzZS9qZHQvY29yZS9kb20vVHlwZS5qYXZhCisrKyBi
L29yZy5lY2xpcHNlLmpkdC5jb3JlL2RvbS9vcmcvZWNsaXBzZS9qZHQvY29yZS9kb20vVHlwZS5q
YXZhCkBAIC0xMTUsNiArMTE1LDE4IEBACiAJfQogCiAJLyoqCisJICogUmV0dXJucyB3aGV0aGVy
IHRoaXMgdHlwZSBpcyBhIHBhY2thZ2UgcXVhbGlmaWVkIHR5cGUKKwkgKiAoe0BsaW5rIFBhY2th
Z2VRdWFsaWZpZWRUeXBlfSkuCisJICoKKwkgKiBAcmV0dXJuIDxjb2RlPnRydWU8L2NvZGU+IGlm
IHRoaXMgaXMgYSBwYWNrYWdlIHF1YWxpZmllZCB0eXBlLCBhbmQKKwkgKiAgICA8Y29kZT5mYWxz
ZTwvY29kZT4gb3RoZXJ3aXNlCisJICogQHNpbmNlIDMuOSBCRVRBX0pBVkE4CisJICovCisJcHVi
bGljIGZpbmFsIGJvb2xlYW4gaXNQYWNrYWdlUXVhbGlmaWVkVHlwZSgpIHsKKwkJcmV0dXJuICh0
aGlzIGluc3RhbmNlb2YgUGFja2FnZVF1YWxpZmllZFR5cGUpOworCX0KKworCS8qKgogCSAqIFJl
dHVybnMgd2hldGhlciB0aGlzIHR5cGUgaXMgYSBwYXJhbWV0ZXJpemVkIHR5cGUKIAkgKiAoe0Bs
aW5rIFBhcmFtZXRlcml6ZWRUeXBlfSkuCiAJICoKZGlmZiAtLWdpdCBhL29yZy5lY2xpcHNlLmpk
dC5jb3JlL2RvbS9vcmcvZWNsaXBzZS9qZHQvaW50ZXJuYWwvY29yZS9kb20vTmFpdmVBU1RGbGF0
dGVuZXIuamF2YSBiL29yZy5lY2xpcHNlLmpkdC5jb3JlL2RvbS9vcmcvZWNsaXBzZS9qZHQvaW50
ZXJuYWwvY29yZS9kb20vTmFpdmVBU1RGbGF0dGVuZXIuamF2YQppbmRleCA3ZjRiM2ExLi5lZTU0
MzIwIDEwMDY0NAotLS0gYS9vcmcuZWNsaXBzZS5qZHQuY29yZS9kb20vb3JnL2VjbGlwc2UvamR0
L2ludGVybmFsL2NvcmUvZG9tL05haXZlQVNURmxhdHRlbmVyLmphdmEKKysrIGIvb3JnLmVjbGlw
c2UuamR0LmNvcmUvZG9tL29yZy9lY2xpcHNlL2pkdC9pbnRlcm5hbC9jb3JlL2RvbS9OYWl2ZUFT
VEZsYXR0ZW5lci5qYXZhCkBAIC0xMTg3LDYgKzExODcsMTggQEAKIAl9CiAKIAkvKgorCSAqIEBz
ZWUgQVNUVmlzaXRvciN2aXNpdChQYWNrYWdlUXVhbGlmaWVkVHlwZSkKKwkgKiBAc2luY2UgMy45
IEJFVEFfSkFWQTgKKwkgKi8KKwlwdWJsaWMgYm9vbGVhbiB2aXNpdChQYWNrYWdlUXVhbGlmaWVk
VHlwZSBub2RlKSB7CisJCW5vZGUuZ2V0UXVhbGlmaWVyKCkuYWNjZXB0KHRoaXMpOworCQl0aGlz
LmJ1ZmZlci5hcHBlbmQoJy4nKTsKKwkJdmlzaXRUeXBlQW5ub3RhdGlvbnMobm9kZSk7CisJCW5v
ZGUuZ2V0TmFtZSgpLmFjY2VwdCh0aGlzKTsKKwkJcmV0dXJuIGZhbHNlOworCX0KKworCS8qCiAJ
ICogQHNlZSBBU1RWaXNpdG9yI3Zpc2l0KFBhcmFtZXRlcml6ZWRUeXBlKQogCSAqIEBzaW5jZSAz
LjEKIAkgKi8=
</data>

          </attachment>
          <attachment
              isobsolete="1"
              ispatch="1"
              isprivate="0"
          >
            <attachid>229934</attachid>
            <date>2013-04-21 01:29:00 -0400</date>
            <delta_ts>2013-04-22 23:04:37 -0400</delta_ts>
            <desc>Proposed Patch</desc>
            <filename>Fix-for-Bug-404489--18dom-ast-Incorrect-conversion-o.patch</filename>
            <type>text/plain</type>
            <size>59662</size>
            <attacher name="Manoj Palat Away Until May 11 2015">manpalat</attacher>
            
              <data encoding="base64">ZGlmZiAtLWdpdCBhL29yZy5lY2xpcHNlLmpkdC5jb3JlLnRlc3RzLm1vZGVsL3NyYy9vcmcvZWNs
aXBzZS9qZHQvY29yZS90ZXN0cy9kb20vQVNUQ29udmVydGVyMTVUZXN0LmphdmEgYi9vcmcuZWNs
aXBzZS5qZHQuY29yZS50ZXN0cy5tb2RlbC9zcmMvb3JnL2VjbGlwc2UvamR0L2NvcmUvdGVzdHMv
ZG9tL0FTVENvbnZlcnRlcjE1VGVzdC5qYXZhCmluZGV4IDljMjhjNTkuLjdlMDIxMzggMTAwNjQ0
Ci0tLSBhL29yZy5lY2xpcHNlLmpkdC5jb3JlLnRlc3RzLm1vZGVsL3NyYy9vcmcvZWNsaXBzZS9q
ZHQvY29yZS90ZXN0cy9kb20vQVNUQ29udmVydGVyMTVUZXN0LmphdmEKKysrIGIvb3JnLmVjbGlw
c2UuamR0LmNvcmUudGVzdHMubW9kZWwvc3JjL29yZy9lY2xpcHNlL2pkdC9jb3JlL3Rlc3RzL2Rv
bS9BU1RDb252ZXJ0ZXIxNVRlc3QuamF2YQpAQCAtMTE1MjcsNCArMTE1MjcsMzYgQEAKIAkJCWRl
bGV0ZVByb2plY3QoanApOwogCQl9CiAJfQorCisJLy8gaHR0cHM6Ly9idWdzLmVjbGlwc2Uub3Jn
L2J1Z3Mvc2hvd19idWcuY2dpP2lkPTQwNDQ4OQorCXB1YmxpYyB2b2lkIHRlc3RCdWc0MDQ0ODko
KSB0aHJvd3MgSmF2YU1vZGVsRXhjZXB0aW9uIHsKKwkJSUNvbXBpbGF0aW9uVW5pdCBzb3VyY2VV
bml0ID0gZ2V0Q29tcGlsYXRpb25Vbml0KCJDb252ZXJ0ZXIxOCIgLCAic3JjIiwgInRlc3Q0MDQ0
ODkuYnVnIiwgIlguamF2YSIpOyAvLyROT04tTkxTLTEkIC8vJE5PTi1OTFMtMiQgLy8kTk9OLU5M
Uy0zJCAvLyROT04tTkxTLTQkCisJCUFTVE5vZGUgcmVzdWx0ID0gcnVuQ29udmVyc2lvbih0aGlz
LmFzdC5hcGlMZXZlbCgpLCBzb3VyY2VVbml0LCB0cnVlKTsKKwkJYXNzZXJ0VHJ1ZSgiTm90IGEg
Y29tcGlsYXRpb24gdW5pdCIsIHJlc3VsdC5nZXROb2RlVHlwZSgpID09IEFTVE5vZGUuQ09NUElM
QVRJT05fVU5JVCk7CisJCUNvbXBpbGF0aW9uVW5pdCBjb21waWxhdGlvblVuaXQgPSAoQ29tcGls
YXRpb25Vbml0KSByZXN1bHQ7CisJCWFzc2VydFByb2JsZW1zU2l6ZShjb21waWxhdGlvblVuaXQs
IDApOworCQlBU1ROb2RlIG5vZGUgPSBnZXRBU1ROb2RlKGNvbXBpbGF0aW9uVW5pdCwgMCwgMCwg
MCk7CisJCVR5cGVEZWNsYXJhdGlvbiB0eXBlRGVjbGFyYXRpb24gPSAgKFR5cGVEZWNsYXJhdGlv
bikgY29tcGlsYXRpb25Vbml0LnR5cGVzKCkuZ2V0KDApOworCisJCW5vZGUgPSAoQVNUTm9kZSkg
dHlwZURlY2xhcmF0aW9uLmJvZHlEZWNsYXJhdGlvbnMoKS5nZXQoMik7CisJCWFzc2VydEVxdWFs
cygiTm90IGEgbWV0aG9kIGRlY2xhcmF0aW9uIiwgQVNUTm9kZS5NRVRIT0RfREVDTEFSQVRJT04s
IG5vZGUuZ2V0Tm9kZVR5cGUoKSk7CQkKKwkJTWV0aG9kRGVjbGFyYXRpb24gbWV0aG9kRGVjbCA9
IChNZXRob2REZWNsYXJhdGlvbikgbm9kZTsKKwkJVHlwZSB0eXBlID0gbWV0aG9kRGVjbC5nZXRS
ZXR1cm5UeXBlMigpOworCQlhc3NlcnRUcnVlKHR5cGUuaXNRdWFsaWZpZWRUeXBlKCkpOworCQlh
c3NlcnRUcnVlKGlzTWFsZm9ybWVkKHR5cGUpKTsKKworCQkvLyBwYXJhbWV0ZXIKKwkJU2luZ2xl
VmFyaWFibGVEZWNsYXJhdGlvbiBwYXJhbSA9IChTaW5nbGVWYXJpYWJsZURlY2xhcmF0aW9uKSBt
ZXRob2REZWNsLnBhcmFtZXRlcnMoKS5nZXQoMCk7CisJCXR5cGUgPSBwYXJhbS5nZXRUeXBlKCk7
CisJCWFzc2VydFRydWUodHlwZS5pc1F1YWxpZmllZFR5cGUoKSk7CisJCWFzc2VydFRydWUoaXNN
YWxmb3JtZWQodHlwZSkpOworCQkKKwkJbm9kZSA9IChBU1ROb2RlKSB0eXBlRGVjbGFyYXRpb24u
Ym9keURlY2xhcmF0aW9ucygpLmdldCgzKTsKKwkJYXNzZXJ0RXF1YWxzKCJOb3QgYSBmaWVsZCBk
ZWNsYXJhdGlvbiIsIEFTVE5vZGUuRklFTERfREVDTEFSQVRJT04sIG5vZGUuZ2V0Tm9kZVR5cGUo
KSk7CQkKKwkJRmllbGREZWNsYXJhdGlvbiBmaWVsZCA9IChGaWVsZERlY2xhcmF0aW9uKSBub2Rl
OworCQl0eXBlID0gZmllbGQuZ2V0VHlwZSgpOworCQlhc3NlcnRUcnVlKHR5cGUuaXNRdWFsaWZp
ZWRUeXBlKCkpOworCQlhc3NlcnRUcnVlKHR5cGUuaXNRdWFsaWZpZWRUeXBlKCkpOworCQlhc3Nl
cnRUcnVlKGlzTWFsZm9ybWVkKHR5cGUpKTsKKwl9CiB9ClwgTm8gbmV3bGluZSBhdCBlbmQgb2Yg
ZmlsZQpkaWZmIC0tZ2l0IGEvb3JnLmVjbGlwc2UuamR0LmNvcmUudGVzdHMubW9kZWwvc3JjL29y
Zy9lY2xpcHNlL2pkdC9jb3JlL3Rlc3RzL2RvbS9BU1RDb252ZXJ0ZXIxOFRlc3QuamF2YSBiL29y
Zy5lY2xpcHNlLmpkdC5jb3JlLnRlc3RzLm1vZGVsL3NyYy9vcmcvZWNsaXBzZS9qZHQvY29yZS90
ZXN0cy9kb20vQVNUQ29udmVydGVyMThUZXN0LmphdmEKaW5kZXggOWMxY2NhOC4uMGUwODEzMyAx
MDA2NDQKLS0tIGEvb3JnLmVjbGlwc2UuamR0LmNvcmUudGVzdHMubW9kZWwvc3JjL29yZy9lY2xp
cHNlL2pkdC9jb3JlL3Rlc3RzL2RvbS9BU1RDb252ZXJ0ZXIxOFRlc3QuamF2YQorKysgYi9vcmcu
ZWNsaXBzZS5qZHQuY29yZS50ZXN0cy5tb2RlbC9zcmMvb3JnL2VjbGlwc2UvamR0L2NvcmUvdGVz
dHMvZG9tL0FTVENvbnZlcnRlcjE4VGVzdC5qYXZhCkBAIC0xNDksMTAgKzE0OSwxMCBAQAogCQlh
c3NlcnROb3ROdWxsKGFzc2lnbm1lbnQpOwogCQlDYXN0RXhwcmVzc2lvbiBjYXN0RXhwcmVzc2lv
biA9IChDYXN0RXhwcmVzc2lvbikgYXNzaWdubWVudC5nZXRSaWdodEhhbmRTaWRlKCk7CiAJCWFz
c2VydE5vdE51bGwoY2FzdEV4cHJlc3Npb24pOwotCQlTaW1wbGVUeXBlIHNpbXBsZVR5cGUgPSAo
U2ltcGxlVHlwZSkgY2FzdEV4cHJlc3Npb24uZ2V0VHlwZSgpOwotCQlhc3NlcnROb3ROdWxsKHNp
bXBsZVR5cGUpOwotCQlhc3NlcnRFcXVhbHMoImphdmEubGFuZy5ATWFya2VyIFN0cmluZyIsIHNp
bXBsZVR5cGUudG9TdHJpbmcoKSk7Ci0JCUxpc3QgYW5ub3RhdGlvbnMgPSBzaW1wbGVUeXBlLmFu
bm90YXRpb25zKCk7CisJCVBhY2thZ2VRdWFsaWZpZWRUeXBlIHBhY2thZ2VRdWFsaWZpZWRUeXBl
ID0gKFBhY2thZ2VRdWFsaWZpZWRUeXBlKSBjYXN0RXhwcmVzc2lvbi5nZXRUeXBlKCk7CisJCWFz
c2VydE5vdE51bGwocGFja2FnZVF1YWxpZmllZFR5cGUpOworCQlhc3NlcnRFcXVhbHMoImphdmEu
bGFuZy5ATWFya2VyIFN0cmluZyIsIHBhY2thZ2VRdWFsaWZpZWRUeXBlLnRvU3RyaW5nKCkpOwor
CQlMaXN0IGFubm90YXRpb25zID0gcGFja2FnZVF1YWxpZmllZFR5cGUuYW5ub3RhdGlvbnMoKTsK
IAkJYXNzZXJ0VHJ1ZShhbm5vdGF0aW9ucy5zaXplKCkgPT0gMSk7CiAJCWFzc2VydEVxdWFscygi
QE1hcmtlciIsIGFubm90YXRpb25zLmdldCgwKS50b1N0cmluZygpKTsKIApAQCAtMTYwLDcgKzE2
MCw3IEBACiAJCVZhcmlhYmxlRGVjbGFyYXRpb25TdGF0ZW1lbnQgdmFyaWFibGVEZWNsYXJhdGlv
blN0YXRlbWVudCA9IChWYXJpYWJsZURlY2xhcmF0aW9uU3RhdGVtZW50KSBzdGF0ZW1lbnRzLmdl
dChzQ291bnQrKyk7CiAJCVR5cGUgdHlwZSA9IHZhcmlhYmxlRGVjbGFyYXRpb25TdGF0ZW1lbnQu
Z2V0VHlwZSgpOwogCQlhc3NlcnRUcnVlKHR5cGUuaXNTaW1wbGVUeXBlKCkpOwotCQlzaW1wbGVU
eXBlID0gKFNpbXBsZVR5cGUpIHR5cGU7CisJCVNpbXBsZVR5cGUgc2ltcGxlVHlwZSA9IChTaW1w
bGVUeXBlKSB0eXBlOwogCQlhc3NlcnRFcXVhbHMoIk91dGVyLklubmVyIiwgc2ltcGxlVHlwZS50
b1N0cmluZygpKTsKIAkJYW5ub3RhdGlvbnMgPSBzaW1wbGVUeXBlLmFubm90YXRpb25zKCk7CiAJ
CWFzc2VydFRydWUoYW5ub3RhdGlvbnMuc2l6ZSgpID09IDApOwpAQCAtMTY5LDIyICsxNjksMjIg
QEAKIAkJLy8gYW5ub3RhdGlvbnMuCiAJCXZhcmlhYmxlRGVjbGFyYXRpb25TdGF0ZW1lbnQgPSAo
VmFyaWFibGVEZWNsYXJhdGlvblN0YXRlbWVudCkgc3RhdGVtZW50cy5nZXQoc0NvdW50KyspOwog
CQl0eXBlID0gdmFyaWFibGVEZWNsYXJhdGlvblN0YXRlbWVudC5nZXRUeXBlKCk7Ci0JCWFzc2Vy
dFRydWUodHlwZS5pc1NpbXBsZVR5cGUoKSk7Ci0JCXNpbXBsZVR5cGUgPSAoU2ltcGxlVHlwZSkg
dHlwZTsKLQkJYXNzZXJ0Tm90TnVsbChzaW1wbGVUeXBlKTsKLQkJYXNzZXJ0RXF1YWxzKCJPdXRl
ci5ATWFya2VyMiBJbm5lciIsIHNpbXBsZVR5cGUudG9TdHJpbmcoKSk7Ci0JCWFubm90YXRpb25z
ID0gc2ltcGxlVHlwZS5hbm5vdGF0aW9ucygpOworCQlhc3NlcnRUcnVlKHR5cGUuaXNRdWFsaWZp
ZWRUeXBlKCkpOworCQlRdWFsaWZpZWRUeXBlIHF1YWxpZmllZFR5cGUgPSAoUXVhbGlmaWVkVHlw
ZSkgdHlwZTsKKwkJYXNzZXJ0Tm90TnVsbChxdWFsaWZpZWRUeXBlKTsKKwkJYXNzZXJ0RXF1YWxz
KCJPdXRlci5ATWFya2VyMiBJbm5lciIsIHF1YWxpZmllZFR5cGUudG9TdHJpbmcoKSk7CisJCWFu
bm90YXRpb25zID0gcXVhbGlmaWVkVHlwZS5hbm5vdGF0aW9ucygpOwogCQlhc3NlcnRUcnVlKGFu
bm90YXRpb25zLnNpemUoKSA9PSAxKTsKIAkJYXNzZXJ0RXF1YWxzKCJATWFya2VyMiIsIGFubm90
YXRpb25zLmdldCgwKS50b1N0cmluZygpKTsKIAogCQkvLyBjYXNlIDQgLSBNdWx0aXBsZSBsZXZl
bHMgd2l0aCBhbm5vdGF0aW9ucyBhdCB0aGUgbGFzdCBvbmx5LgogCQl2YXJpYWJsZURlY2xhcmF0
aW9uU3RhdGVtZW50ID0gKFZhcmlhYmxlRGVjbGFyYXRpb25TdGF0ZW1lbnQpIHN0YXRlbWVudHMu
Z2V0KHNDb3VudCsrKTsKIAkJdHlwZSA9IHZhcmlhYmxlRGVjbGFyYXRpb25TdGF0ZW1lbnQuZ2V0
VHlwZSgpOwotCQlhc3NlcnRUcnVlKHR5cGUuaXNTaW1wbGVUeXBlKCkpOwotCQlzaW1wbGVUeXBl
ID0gKFNpbXBsZVR5cGUpIHR5cGU7Ci0JCWFzc2VydE5vdE51bGwoc2ltcGxlVHlwZSk7Ci0JCWFz
c2VydEVxdWFscygiT3V0ZXIuSW5uZXIuQE1hcmtlcjEgRGVlcGVyIiwgc2ltcGxlVHlwZS50b1N0
cmluZygpKTsKLQkJYW5ub3RhdGlvbnMgPSBzaW1wbGVUeXBlLmFubm90YXRpb25zKCk7CisJCWFz
c2VydFRydWUodHlwZS5pc1F1YWxpZmllZFR5cGUoKSk7CisJCXF1YWxpZmllZFR5cGUgPSAoUXVh
bGlmaWVkVHlwZSkgdHlwZTsKKwkJYXNzZXJ0Tm90TnVsbChxdWFsaWZpZWRUeXBlKTsKKwkJYXNz
ZXJ0RXF1YWxzKCJPdXRlci5Jbm5lci5ATWFya2VyMSBEZWVwZXIiLCBxdWFsaWZpZWRUeXBlLnRv
U3RyaW5nKCkpOworCQlhbm5vdGF0aW9ucyA9IHF1YWxpZmllZFR5cGUuYW5ub3RhdGlvbnMoKTsK
IAkJYXNzZXJ0VHJ1ZShhbm5vdGF0aW9ucy5zaXplKCkgPT0gMSk7CiAJCWFzc2VydEVxdWFscygi
QE1hcmtlcjEiLCBhbm5vdGF0aW9ucy5nZXQoMCkudG9TdHJpbmcoKSk7CiAKQEAgLTE5Miw3ICsx
OTIsNyBAQAogCQl2YXJpYWJsZURlY2xhcmF0aW9uU3RhdGVtZW50ID0gKFZhcmlhYmxlRGVjbGFy
YXRpb25TdGF0ZW1lbnQpIHN0YXRlbWVudHMuZ2V0KHNDb3VudCsrKTsKIAkJdHlwZSA9IHZhcmlh
YmxlRGVjbGFyYXRpb25TdGF0ZW1lbnQuZ2V0VHlwZSgpOwogCQlhc3NlcnRUcnVlKHR5cGUuaXNR
dWFsaWZpZWRUeXBlKCkpOwotCQlRdWFsaWZpZWRUeXBlIHF1YWxpZmllZFR5cGUgPSAoUXVhbGlm
aWVkVHlwZSkgdHlwZTsKKwkJcXVhbGlmaWVkVHlwZSA9IChRdWFsaWZpZWRUeXBlKSB0eXBlOwog
CQlhc3NlcnROb3ROdWxsKHF1YWxpZmllZFR5cGUpOwogCQlhc3NlcnRFcXVhbHMoIk91dGVyLkBN
YXJrZXIxIElubmVyLkBNYXJrZXIyIERlZXBlciIsIHF1YWxpZmllZFR5cGUudG9TdHJpbmcoKSk7
CiAJCWFubm90YXRpb25zID0gcXVhbGlmaWVkVHlwZS5hbm5vdGF0aW9ucygpOwpAQCAtMjAxLDEw
ICsyMDEsMTAgQEAKIAkJU2ltcGxlTmFtZSBzaW1wbGVOYW1lID0gcXVhbGlmaWVkVHlwZS5nZXRO
YW1lKCk7CiAJCWFzc2VydEVxdWFscygiRGVlcGVyIiwgc2ltcGxlTmFtZS50b1N0cmluZygpKTsK
IAkJVHlwZSBxdWFsaWZpZXJUeXBlID0gcXVhbGlmaWVkVHlwZS5nZXRRdWFsaWZpZXIoKTsKLQkJ
YXNzZXJ0VHJ1ZShxdWFsaWZpZXJUeXBlLmlzU2ltcGxlVHlwZSgpKTsKLQkJc2ltcGxlVHlwZSA9
IChTaW1wbGVUeXBlKSBxdWFsaWZpZXJUeXBlOwotCQlhc3NlcnRFcXVhbHMoIk91dGVyLkBNYXJr
ZXIxIElubmVyIiwgc2ltcGxlVHlwZS50b1N0cmluZygpKTsKLQkJYW5ub3RhdGlvbnMgPSBzaW1w
bGVUeXBlLmFubm90YXRpb25zKCk7CisJCWFzc2VydFRydWUocXVhbGlmaWVyVHlwZS5pc1F1YWxp
ZmllZFR5cGUoKSk7CisJCXF1YWxpZmllZFR5cGUgPSAoUXVhbGlmaWVkVHlwZSkgcXVhbGlmaWVy
VHlwZTsKKwkJYXNzZXJ0RXF1YWxzKCJPdXRlci5ATWFya2VyMSBJbm5lciIsIHF1YWxpZmllZFR5
cGUudG9TdHJpbmcoKSk7CisJCWFubm90YXRpb25zID0gcXVhbGlmaWVkVHlwZS5hbm5vdGF0aW9u
cygpOwogCQlhc3NlcnRUcnVlKGFubm90YXRpb25zLnNpemUoKSA9PSAxKTsKIAkJYXNzZXJ0RXF1
YWxzKCJATWFya2VyMSIsIGFubm90YXRpb25zLmdldCgwKS50b1N0cmluZygpKTsKIAl9CkBAIC0z
NDIsMTAgKzM0MiwxMCBAQAogCQl0eXBlQXJndW1lbnRzID0gcGFyYW1ldHJpemVkVHlwZS50eXBl
QXJndW1lbnRzKCk7CiAJCWFzc2VydEVxdWFscygxLCB0eXBlQXJndW1lbnRzLnNpemUoKSk7CiAJ
CXR5cGUgPSAoVHlwZSkgdHlwZUFyZ3VtZW50cy5nZXQoMCk7Ci0JCWFzc2VydFRydWUodHlwZS5p
c1NpbXBsZVR5cGUoKSk7Ci0JCVNpbXBsZVR5cGUgc2ltcGxlVHlwZSA9IChTaW1wbGVUeXBlKSB0
eXBlOwotCQlhc3NlcnRFcXVhbHMoIk91dGVyLkBNYXJrZXIxIElubmVyIiwgc2ltcGxlVHlwZS50
b1N0cmluZygpKTsKLQkJTGlzdCBhbm5vdGF0aW9ucyA9IHNpbXBsZVR5cGUuYW5ub3RhdGlvbnMo
KTsKKwkJYXNzZXJ0VHJ1ZSh0eXBlLmlzUXVhbGlmaWVkVHlwZSgpKTsKKwkJUXVhbGlmaWVkVHlw
ZSBxdWFsaWZpZWRUeXBlID0gKFF1YWxpZmllZFR5cGUpIHR5cGU7CisJCWFzc2VydEVxdWFscygi
T3V0ZXIuQE1hcmtlcjEgSW5uZXIiLCBxdWFsaWZpZWRUeXBlLnRvU3RyaW5nKCkpOworCQlMaXN0
IGFubm90YXRpb25zID0gcXVhbGlmaWVkVHlwZS5hbm5vdGF0aW9ucygpOwogCQlhc3NlcnRUcnVl
KGFubm90YXRpb25zLnNpemUoKSA9PSAxKTsKIAkJQW5ub3RhdGlvbiBhbm5vdGF0aW9uID0gKEFu
bm90YXRpb24pIGFubm90YXRpb25zLmdldCgwKTsKIAkJYXNzZXJ0RXF1YWxzKCJATWFya2VyMSIs
IGFubm90YXRpb24udG9TdHJpbmcoKSk7CkBAIC0zNTksMTMgKzM1OSwxMyBAQAogCQl0eXBlID0g
KFR5cGUpIHR5cGVBcmd1bWVudHMuZ2V0KDApOwogCQlhc3NlcnRUcnVlKHR5cGUuaXNRdWFsaWZp
ZWRUeXBlKCkpOwogCQlhc3NlcnRFcXVhbHMoIkBNYXJrZXIxIE91dGVyLklubmVyIiwgdHlwZS50
b1N0cmluZygpKTsKLQkJUXVhbGlmaWVkVHlwZSBxdWFsaWZpZWRUeXBlID0gKFF1YWxpZmllZFR5
cGUpIHR5cGU7CisJCXF1YWxpZmllZFR5cGUgPSAoUXVhbGlmaWVkVHlwZSkgdHlwZTsKIAkJYXNz
ZXJ0RXF1YWxzKCJJbm5lciIsIHF1YWxpZmllZFR5cGUuZ2V0TmFtZSgpLnRvU3RyaW5nKCkpOwog
CQlhbm5vdGF0aW9ucyA9IHF1YWxpZmllZFR5cGUuYW5ub3RhdGlvbnMoKTsKIAkJYXNzZXJ0VHJ1
ZShhbm5vdGF0aW9ucy5zaXplKCkgPT0gMCk7CiAJCVR5cGUgcXVhbGlmaWVyVHlwZSA9IHF1YWxp
ZmllZFR5cGUuZ2V0UXVhbGlmaWVyKCk7CiAJCWFzc2VydFRydWUocXVhbGlmaWVyVHlwZS5pc1Np
bXBsZVR5cGUoKSk7Ci0JCXNpbXBsZVR5cGUgPSAoU2ltcGxlVHlwZSkgcXVhbGlmaWVyVHlwZTsK
KwkJU2ltcGxlVHlwZSBzaW1wbGVUeXBlID0gKFNpbXBsZVR5cGUpIHF1YWxpZmllclR5cGU7CiAJ
CWFzc2VydEVxdWFscygiQE1hcmtlcjEgT3V0ZXIiLCBzaW1wbGVUeXBlLnRvU3RyaW5nKCkpOwog
CQlhbm5vdGF0aW9ucyA9IHNpbXBsZVR5cGUuYW5ub3RhdGlvbnMoKTsKIAkJYXNzZXJ0VHJ1ZShh
bm5vdGF0aW9ucy5zaXplKCkgPT0gMSk7CkBAIC0xOTM1LDYgKzE5MzUsMzE4IEBACiAJCW1ldGhv
ZCA9IChNZXRob2REZWNsYXJhdGlvbikgdHlwZS5ib2R5RGVjbGFyYXRpb25zKCkuZ2V0KDMpOwog
CQlhc3NlcnRFcXVhbHMoIk1ldGhvZCBzaG91bGQgYmUgbWFsZm9ybWVkIiwgQVNUTm9kZS5NQUxG
T1JNRUQsIChtZXRob2QuZ2V0RmxhZ3MoKSAmIEFTVE5vZGUuTUFMRk9STUVEKSk7CiAJfQorCisJ
Ly8gaHR0cHM6Ly9idWdzLmVjbGlwc2Uub3JnL2J1Z3Mvc2hvd19idWcuY2dpP2lkPTQwNDQ4OQor
CXB1YmxpYyB2b2lkIHRlc3RCdWc0MDQ0ODlhKCkgdGhyb3dzIEphdmFNb2RlbEV4Y2VwdGlvbiB7
CisJCVN0cmluZyBjb250ZW50cyA9CisJCSJwYWNrYWdlIHRlc3Q0MDQ0ODkuYnVnO1xuIiArCisJ
CSJwdWJsaWMgY2xhc3MgWCB7IFxuIiArCisJCSIJY2xhc3MgWSB7IFxuIiArCisJCSIJCWNsYXNz
IFoge1xuIiArCisJCSIJCQlwdWJsaWMgWihAQSBYLkBCIFkgWS50aGlzKXt9XG4iICsKKwkJIgkJ
CX1cbiIgKworCQkiICAJCX1cbiIgKworCQkiICAJCU9iamVjdCBvPShAQSBYLkBCIFkuQE1hcmtl
ciAgWiludWxsO1xuIiArCisJCSIJfVxuIiArCisJCSJAamF2YS5sYW5nLmFubm90YXRpb24uVGFy
Z2V0KGphdmEubGFuZy5hbm5vdGF0aW9uLkVsZW1lbnRUeXBlLlRZUEVfVVNFKSBAaW50ZXJmYWNl
IE1hcmtlciB7fSBcbiIgKworCQkiQGphdmEubGFuZy5hbm5vdGF0aW9uLlRhcmdldChqYXZhLmxh
bmcuYW5ub3RhdGlvbi5FbGVtZW50VHlwZS5UWVBFX1VTRSkgQGludGVyZmFjZSBBIHt9IFxuIiAr
CisJCSJAamF2YS5sYW5nLmFubm90YXRpb24uVGFyZ2V0KGphdmEubGFuZy5hbm5vdGF0aW9uLkVs
ZW1lbnRUeXBlLlRZUEVfVVNFKSBAaW50ZXJmYWNlIEIge30gXG4iOworCQl0aGlzLndvcmtpbmdD
b3B5ID0gZ2V0V29ya2luZ0NvcHkoIi9Db252ZXJ0ZXIxOC9zcmMvdGVzdDQwNDQ4OS9idWcvWC5q
YXZhIiwgdHJ1ZS8qIHJlc29sdmUgKi8pOworCQlBU1ROb2RlIG5vZGUgPSBidWlsZEFTVChjb250
ZW50cywgdGhpcy53b3JraW5nQ29weSk7CisJCWFzc2VydEVxdWFscygiTm90IGEgY29tcGlsYXRp
b24gdW5pdCIsIEFTVE5vZGUuQ09NUElMQVRJT05fVU5JVCwgbm9kZS5nZXROb2RlVHlwZSgpKTsK
KwkJQ29tcGlsYXRpb25Vbml0IHVuaXQgPSAoQ29tcGlsYXRpb25Vbml0KSBub2RlOworCQlUeXBl
RGVjbGFyYXRpb24gdHlwZSA9ICAoVHlwZURlY2xhcmF0aW9uKSB1bml0LnR5cGVzKCkuZ2V0KDAp
OworCQlub2RlID0gKEFTVE5vZGUpIHR5cGUuYm9keURlY2xhcmF0aW9ucygpLmdldCgwKTsKKwkJ
YXNzZXJ0RXF1YWxzKCJOb3QgYSBUeXBlIERlY2xhcmF0aW9uIiwgQVNUTm9kZS5UWVBFX0RFQ0xB
UkFUSU9OLCBub2RlLmdldE5vZGVUeXBlKCkpOworCQlub2RlID0gKEFTVE5vZGUpICgoVHlwZURl
Y2xhcmF0aW9uKW5vZGUpLmJvZHlEZWNsYXJhdGlvbnMoKS5nZXQoMCk7CisJCWFzc2VydEVxdWFs
cygiTm90IGEgVHlwZSBEZWNsYXJhdGlvbiIsIEFTVE5vZGUuVFlQRV9ERUNMQVJBVElPTiwgbm9k
ZS5nZXROb2RlVHlwZSgpKTsKKwkJbm9kZSA9IChBU1ROb2RlKSAoKFR5cGVEZWNsYXJhdGlvbilu
b2RlKS5ib2R5RGVjbGFyYXRpb25zKCkuZ2V0KDApOwkJCisJCWFzc2VydEVxdWFscygiTm90IGEg
bWV0aG9kIERlY2xhcmF0aW9uIiwgQVNUTm9kZS5NRVRIT0RfREVDTEFSQVRJT04sIG5vZGUuZ2V0
Tm9kZVR5cGUoKSk7CisJCU1ldGhvZERlY2xhcmF0aW9uIG1ldGhvZCA9IChNZXRob2REZWNsYXJh
dGlvbikgbm9kZTsKKwkJYXNzZXJ0RXF1YWxzKCJNZXRob2Qgc2hvdWxkIG5vdCBiZSBtYWxmb3Jt
ZWQiLCAwLCAobWV0aG9kLmdldEZsYWdzKCkgJiBBU1ROb2RlLk1BTEZPUk1FRCkpOworCQlBbm5v
dGF0YWJsZVR5cGUgYW5ub3RhdGFibGVUeXBlID0gbWV0aG9kLmdldFJlY2VpdmVyVHlwZSgpOwor
CQlhc3NlcnRUcnVlKGFubm90YXRhYmxlVHlwZS5pc1F1YWxpZmllZFR5cGUoKSk7CisJCVF1YWxp
ZmllZFR5cGUgcXVhbGlmaWVkVHlwZSA9IChRdWFsaWZpZWRUeXBlKSBhbm5vdGF0YWJsZVR5cGU7
CisJCWFzc2VydEVxdWFscygid3JvbmcgcXVhbGlmaWVkIHR5cGUiLCAiQEEgWC5AQiBZIiwgcXVh
bGlmaWVkVHlwZS50b1N0cmluZygpKTsKKwkJSVR5cGVCaW5kaW5nIGJpbmRpbmcgPSBxdWFsaWZp
ZWRUeXBlLnJlc29sdmVCaW5kaW5nKCk7CisJCWFzc2VydE5vdE51bGwoIk5vIGJpbmRpbmciLCBi
aW5kaW5nKTsKKwkJYXNzZXJ0RXF1YWxzKCJXcm9uZyBxdWFsaWZpZWQgbmFtZSIsICJ0ZXN0NDA0
NDg5LmJ1Zy5YLlkiLCBiaW5kaW5nLmdldFF1YWxpZmllZE5hbWUoKSk7CisJCUxpc3QgYW5ub3Rh
dGlvbnMgPSBxdWFsaWZpZWRUeXBlLmFubm90YXRpb25zKCk7CisJCWFzc2VydFRydWUoYW5ub3Rh
dGlvbnMuc2l6ZSgpID09IDEpOworCQlNYXJrZXJBbm5vdGF0aW9uIG1hcmtlcgk9IChNYXJrZXJB
bm5vdGF0aW9uKSBhbm5vdGF0aW9ucy5nZXQoMCk7CisJCWFzc2VydEVxdWFscygid3JvbmcgYW5u
b3RhdGlvbiBuYW1lIiwgIkBCIiwgbWFya2VyLnRvU3RyaW5nKCkpOworCQliaW5kaW5nID0gbWFy
a2VyLnJlc29sdmVUeXBlQmluZGluZygpOworCQlhc3NlcnROb3ROdWxsKCJObyBiaW5kaW5nIiwg
YmluZGluZyk7CisJCWFzc2VydEVxdWFscygiV3JvbmcgcXVhbGlmaWVkIG5hbWUiLCAidGVzdDQw
NDQ4OS5idWcuQiIsIGJpbmRpbmcuZ2V0UXVhbGlmaWVkTmFtZSgpKTsKKwkJSUFubm90YXRpb25C
aW5kaW5nIGFubm90YXRpb25CaW5kaW5nID0gbWFya2VyLnJlc29sdmVBbm5vdGF0aW9uQmluZGlu
ZygpOworCQlhc3NlcnROb3ROdWxsKGFubm90YXRpb25CaW5kaW5nKTsKKwkJYXNzZXJ0RXF1YWxz
KCJ3cm9uZyBhbm5vdGF0aW9uIGJpbmRpbmciLCAiQiIsIGFubm90YXRpb25CaW5kaW5nLmdldE5h
bWUoKSk7CisJCU5hbWUgbmFtZSA9IG1hcmtlci5nZXRUeXBlTmFtZSgpOworCQlhc3NlcnRUcnVl
KG5hbWUuaXNTaW1wbGVOYW1lKCkpOworCQlTaW1wbGVOYW1lIHNpbXBsZU5hbWUgPSAoU2ltcGxl
TmFtZSkgbmFtZTsKKwkJYXNzZXJ0RXF1YWxzKCJ3cm9uZyB0eXBlIG5hbWUiLCAiQiIsIHNpbXBs
ZU5hbWUudG9TdHJpbmcoKSk7CisJCWFzc2VydEVxdWFscygid3Jvbmcgc2ltcGxlIG5hbWUiLCAi
QiIsc2ltcGxlTmFtZS5nZXRJZGVudGlmaWVyKCkpOworCQliaW5kaW5nID0gc2ltcGxlTmFtZS5y
ZXNvbHZlVHlwZUJpbmRpbmcoKTsKKwkJYXNzZXJ0Tm90TnVsbCgiTm8gYmluZGluZyIsIGJpbmRp
bmcpOworCQlhc3NlcnRFcXVhbHMoIldyb25nIHF1YWxpZmllZCBuYW1lIiwgInRlc3Q0MDQ0ODku
YnVnLkIiLCBiaW5kaW5nLmdldFF1YWxpZmllZE5hbWUoKSk7CisJCWFzc2VydFRydWUocXVhbGlm
aWVkVHlwZS5nZXRRdWFsaWZpZXIoKS5pc1NpbXBsZVR5cGUoKSk7CisJCVNpbXBsZVR5cGUgc2lt
cGxlVHlwZSA9IChTaW1wbGVUeXBlKSBxdWFsaWZpZWRUeXBlLmdldFF1YWxpZmllcigpOworCQlh
c3NlcnRFcXVhbHMoImluY29ycmVjdCB0eXBlIiwgIkBBIFgiLCBzaW1wbGVUeXBlLnRvU3RyaW5n
KCkpOworCQliaW5kaW5nID0gc2ltcGxlVHlwZS5yZXNvbHZlQmluZGluZygpOworCQlhc3NlcnRO
b3ROdWxsKCJObyBiaW5kaW5nIiwgYmluZGluZyk7CisJCWFzc2VydEVxdWFscygiV3JvbmcgcXVh
bGlmaWVkIG5hbWUiLCAidGVzdDQwNDQ4OS5idWcuWC5ZIiwgYmluZGluZy5nZXRRdWFsaWZpZWRO
YW1lKCkpOworCX0KKworCS8vIGh0dHBzOi8vYnVncy5lY2xpcHNlLm9yZy9idWdzL3Nob3dfYnVn
LmNnaT9pZD00MDQ0ODkKKwlwdWJsaWMgdm9pZCB0ZXN0QnVnNDA0NDg5YigpIHRocm93cyBKYXZh
TW9kZWxFeGNlcHRpb24geworCQlJQ29tcGlsYXRpb25Vbml0IHNvdXJjZVVuaXQgPSBnZXRDb21w
aWxhdGlvblVuaXQoIkNvbnZlcnRlcjE4IiAsICJzcmMiLCAidGVzdDQwNDQ4OS5idWciLCAiWC5q
YXZhIik7IC8vJE5PTi1OTFMtMSQgLy8kTk9OLU5MUy0yJCAvLyROT04tTkxTLTMkIC8vJE5PTi1O
TFMtNCQKKwkJQVNUTm9kZSByZXN1bHQgPSBydW5Db252ZXJzaW9uKHRoaXMuYXN0LmFwaUxldmVs
KCksIHNvdXJjZVVuaXQsIHRydWUpOworCQljaGFyW10gc291cmNlID0gc291cmNlVW5pdC5nZXRT
b3VyY2UoKS50b0NoYXJBcnJheSgpOworCQlhc3NlcnRUcnVlKCJOb3QgYSBjb21waWxhdGlvbiB1
bml0IiwgcmVzdWx0LmdldE5vZGVUeXBlKCkgPT0gQVNUTm9kZS5DT01QSUxBVElPTl9VTklUKTsK
KwkJQ29tcGlsYXRpb25Vbml0IGNvbXBpbGF0aW9uVW5pdCA9IChDb21waWxhdGlvblVuaXQpIHJl
c3VsdDsKKwkJYXNzZXJ0UHJvYmxlbXNTaXplKGNvbXBpbGF0aW9uVW5pdCwgMCk7CisJCUFTVE5v
ZGUgbm9kZSA9IGdldEFTVE5vZGUoY29tcGlsYXRpb25Vbml0LCAwLCAwLCAwKTsKKwkJVHlwZURl
Y2xhcmF0aW9uIHR5cGVEZWNsYXJhdGlvbiA9ICAoVHlwZURlY2xhcmF0aW9uKSBjb21waWxhdGlv
blVuaXQudHlwZXMoKS5nZXQoMCk7CisKKwkJbm9kZSA9IChBU1ROb2RlKSB0eXBlRGVjbGFyYXRp
b24uYm9keURlY2xhcmF0aW9ucygpLmdldCgyKTsKKwkJYXNzZXJ0RXF1YWxzKCJOb3QgYSBtZXRo
b2QgZGVjbGFyYXRpb24iLCBBU1ROb2RlLk1FVEhPRF9ERUNMQVJBVElPTiwgbm9kZS5nZXROb2Rl
VHlwZSgpKTsJCQorCQlNZXRob2REZWNsYXJhdGlvbiBtZXRob2REZWNsID0gKE1ldGhvZERlY2xh
cmF0aW9uKSBub2RlOworCQlUeXBlIHR5cGUgPSBtZXRob2REZWNsLmdldFJldHVyblR5cGUyKCk7
CisJCWFzc2VydFRydWUodHlwZS5pc1BhY2thZ2VRdWFsaWZpZWRUeXBlKCkpOworCQlQYWNrYWdl
UXVhbGlmaWVkVHlwZSBwYWNrYWdlUXVhbGlmaWVkVHlwZSA9IChQYWNrYWdlUXVhbGlmaWVkVHlw
ZSkgdHlwZTsKKwkJY2hlY2tTb3VyY2VSYW5nZShwYWNrYWdlUXVhbGlmaWVkVHlwZSwgInRlc3Q0
MDQ0ODkuYnVnLkBOb25OdWxsIElPRXhjZXB0aW9uIiwgc291cmNlKTsKKwkJSVR5cGVCaW5kaW5n
IHR5cGVCaW5kaW5nID0gcGFja2FnZVF1YWxpZmllZFR5cGUucmVzb2x2ZUJpbmRpbmcoKTsKKwkJ
YXNzZXJ0Tm90TnVsbCgibnVsbCBiaW5kaW5nIiwgdHlwZUJpbmRpbmcpOworCQlhc3NlcnRFcXVh
bHMoIm5vdCBhIHZhbGlkIGJpbmRpbmciLCAidGVzdDQwNDQ4OS5idWcuSU9FeGNlcHRpb24iLCB0
eXBlQmluZGluZy5nZXRRdWFsaWZpZWROYW1lKCkpOworCQkKKwkJLy8gcXVhbGlmaWVyIG9mIHRo
ZSBwYWNrYWdlIHF1YWxpZmllZCB0eXBlCisJCU5hbWUgbmFtZSA9IHBhY2thZ2VRdWFsaWZpZWRU
eXBlLmdldFF1YWxpZmllcigpOworCQlhc3NlcnRUcnVlKG5hbWUuaXNRdWFsaWZpZWROYW1lKCkp
OworCQlRdWFsaWZpZWROYW1lIHF1YWxpZmllZE5hbWUgPSAoUXVhbGlmaWVkTmFtZSkgbmFtZTsK
KwkJY2hlY2tTb3VyY2VSYW5nZShxdWFsaWZpZWROYW1lLCAidGVzdDQwNDQ4OS5idWciLCBzb3Vy
Y2UpOworCQl0eXBlQmluZGluZyA9IHF1YWxpZmllZE5hbWUucmVzb2x2ZVR5cGVCaW5kaW5nKCk7
CisJCWFzc2VydE51bGwodHlwZUJpbmRpbmcpOworCQlJQmluZGluZyBiaW5kaW5nID0gcXVhbGlm
aWVkTmFtZS5yZXNvbHZlQmluZGluZygpOworCQlhc3NlcnRUcnVlKCJub3QgYSBwYWNrYWdlIGJp
bmRpbmciLCBiaW5kaW5nLmdldEtpbmQoKSA9PSBJQmluZGluZy5QQUNLQUdFKTsKKwkJYXNzZXJ0
RXF1YWxzKCJ3cm9uZyBwYWNrYWdlIGJpbmRpbmciLCAicGFja2FnZSB0ZXN0NDA0NDg5LmJ1ZyIs
IGJpbmRpbmcudG9TdHJpbmcoKSk7CisJCW5hbWUgPSBxdWFsaWZpZWROYW1lLmdldFF1YWxpZmll
cigpOworCQlhc3NlcnRUcnVlKCJ3cm9uZyBuYW1lIHR5cGUiLCBuYW1lLmlzU2ltcGxlTmFtZSgp
KTsKKwkJU2ltcGxlTmFtZSBzaW1wbGVOYW1lID0gKFNpbXBsZU5hbWUpIG5hbWU7CisJCWNoZWNr
U291cmNlUmFuZ2Uoc2ltcGxlTmFtZSwgInRlc3Q0MDQ0ODkiLCBzb3VyY2UpOworCQl0eXBlQmlu
ZGluZyA9IHNpbXBsZU5hbWUucmVzb2x2ZVR5cGVCaW5kaW5nKCk7CisJCWFzc2VydE51bGwodHlw
ZUJpbmRpbmcpOworCQliaW5kaW5nID0gc2ltcGxlTmFtZS5yZXNvbHZlQmluZGluZygpOworCQlh
c3NlcnRUcnVlKCJub3QgYSBwYWNrYWdlIGJpbmRpbmciLCBiaW5kaW5nLmdldEtpbmQoKSA9PSBJ
QmluZGluZy5QQUNLQUdFKTsKKwkJYXNzZXJ0RXF1YWxzKCJ3cm9uZyBwYWNrYWdlIGJpbmRpbmci
LCAicGFja2FnZSB0ZXN0NDA0NDg5IiwgYmluZGluZy50b1N0cmluZygpKTsKKwkJc2ltcGxlTmFt
ZSA9IHF1YWxpZmllZE5hbWUuZ2V0TmFtZSgpOworCQljaGVja1NvdXJjZVJhbmdlKHNpbXBsZU5h
bWUsICJidWciLCBzb3VyY2UpOworCQl0eXBlQmluZGluZyA9IHNpbXBsZU5hbWUucmVzb2x2ZVR5
cGVCaW5kaW5nKCk7CisJCWFzc2VydE51bGwodHlwZUJpbmRpbmcpOworCQliaW5kaW5nID0gc2lt
cGxlTmFtZS5yZXNvbHZlQmluZGluZygpOworCQlhc3NlcnRUcnVlKCJub3QgYSBwYWNrYWdlIGJp
bmRpbmciLCBiaW5kaW5nLmdldEtpbmQoKSA9PSBJQmluZGluZy5QQUNLQUdFKTsKKwkJYXNzZXJ0
RXF1YWxzKCJ3cm9uZyBwYWNrYWdlIGJpbmRpbmciLCAicGFja2FnZSB0ZXN0NDA0NDg5LmJ1ZyIs
IGJpbmRpbmcudG9TdHJpbmcoKSk7CisJCQorCQkvLyBhbm5vdGF0aW9ucyBvZiBwYWNrYWdlIHF1
YWxpZmllZCB0eXBlCisJCUxpc3QgYW5ub3RhdGlvbnMgPSBwYWNrYWdlUXVhbGlmaWVkVHlwZS5h
bm5vdGF0aW9ucygpOworCQlhc3NlcnRUcnVlKGFubm90YXRpb25zLnNpemUoKSA9PSAxKTsKKwkJ
QW5ub3RhdGlvbiBhbm5vdGF0aW9uID0gKEFubm90YXRpb24pIGFubm90YXRpb25zLmdldCgwKTsK
KwkJdHlwZUJpbmRpbmcgPSBhbm5vdGF0aW9uLnJlc29sdmVUeXBlQmluZGluZygpOworCQlhc3Nl
cnROb3ROdWxsKCJudWxsIGJpbmRpbmciLCB0eXBlQmluZGluZyk7CisJCWFzc2VydEVxdWFscygi
bm90IGEgdmFsaWQgYmluZGluZyIsICJ0ZXN0NDA0NDg5LmJ1Zy5YLk5vbk51bGwiLCB0eXBlQmlu
ZGluZy5nZXRRdWFsaWZpZWROYW1lKCkpOworCQlJQW5ub3RhdGlvbkJpbmRpbmcgYW5ub3RhdGlv
bkJpbmRpbmcgPSBhbm5vdGF0aW9uLnJlc29sdmVBbm5vdGF0aW9uQmluZGluZygpOworCQlhc3Nl
cnRFcXVhbHMoIm5vdCBhIHZhbGlkIGFubm90YXRpb24gYmluZGluZyIsICJATm9uTnVsbCgpIiwg
YW5ub3RhdGlvbkJpbmRpbmcudG9TdHJpbmcoKSk7CisJCW5hbWUgPSBhbm5vdGF0aW9uLmdldFR5
cGVOYW1lKCk7CisJCWFzc2VydFRydWUobmFtZS5pc1NpbXBsZU5hbWUoKSk7CisJCXNpbXBsZU5h
bWUgPSAoU2ltcGxlTmFtZSkgbmFtZTsKKwkJdHlwZUJpbmRpbmcgPSBzaW1wbGVOYW1lLnJlc29s
dmVUeXBlQmluZGluZygpOworCQljaGVja1NvdXJjZVJhbmdlKHNpbXBsZU5hbWUsICJOb25OdWxs
Iiwgc291cmNlKTsKKwkJYXNzZXJ0Tm90TnVsbCh0eXBlQmluZGluZyk7CisJCQorCQkvLyBuYW1l
IG9mIHRoZSBwYWNrYWdlIHF1YWxpZmllZCB0eXBlCisJCXNpbXBsZU5hbWUgPSBwYWNrYWdlUXVh
bGlmaWVkVHlwZS5nZXROYW1lKCk7CisJCWNoZWNrU291cmNlUmFuZ2Uoc2ltcGxlTmFtZSwgIklP
RXhjZXB0aW9uIiwgc291cmNlKTsKKwkJdHlwZUJpbmRpbmcgPSBzaW1wbGVOYW1lLnJlc29sdmVU
eXBlQmluZGluZygpOworCQlhc3NlcnROb3ROdWxsKHR5cGVCaW5kaW5nKTsKKwkJCisJCS8vIHBh
cmFtZXRlcgorCQlTaW5nbGVWYXJpYWJsZURlY2xhcmF0aW9uIHBhcmFtID0gKFNpbmdsZVZhcmlh
YmxlRGVjbGFyYXRpb24pIG1ldGhvZERlY2wucGFyYW1ldGVycygpLmdldCgwKTsKKwkJdHlwZSA9
IHBhcmFtLmdldFR5cGUoKTsKKwkJYXNzZXJ0VHJ1ZSh0eXBlLmlzUGFja2FnZVF1YWxpZmllZFR5
cGUoKSk7CisJCXBhY2thZ2VRdWFsaWZpZWRUeXBlID0gKFBhY2thZ2VRdWFsaWZpZWRUeXBlKSB0
eXBlOworCQljaGVja1NvdXJjZVJhbmdlKHBhY2thZ2VRdWFsaWZpZWRUeXBlLCAidGVzdDQwNDQ4
OS5idWcuQE5vbk51bGwgRmlsZU5vdEZvdW5kRXhjZXB0aW9uIiwgc291cmNlKTsKKwkJdHlwZUJp
bmRpbmcgPSBwYWNrYWdlUXVhbGlmaWVkVHlwZS5yZXNvbHZlQmluZGluZygpOworCQlhc3NlcnRO
b3ROdWxsKCJudWxsIGJpbmRpbmciLCB0eXBlQmluZGluZyk7CisJCWFzc2VydEVxdWFscygibm90
IGEgdmFsaWQgYmluZGluZyIsICJ0ZXN0NDA0NDg5LmJ1Zy5GaWxlTm90Rm91bmRFeGNlcHRpb24i
LCB0eXBlQmluZGluZy5nZXRRdWFsaWZpZWROYW1lKCkpOworCQkKKwkJLy8gcXVhbGlmaWVyIG9m
IHRoZSBwYWNrYWdlIHF1YWxpZmllZCB0eXBlCisJCW5hbWUgPSBwYWNrYWdlUXVhbGlmaWVkVHlw
ZS5nZXRRdWFsaWZpZXIoKTsKKwkJYXNzZXJ0VHJ1ZShuYW1lLmlzUXVhbGlmaWVkTmFtZSgpKTsK
KwkJcXVhbGlmaWVkTmFtZSA9IChRdWFsaWZpZWROYW1lKSBuYW1lOworCQljaGVja1NvdXJjZVJh
bmdlKHF1YWxpZmllZE5hbWUsICJ0ZXN0NDA0NDg5LmJ1ZyIsIHNvdXJjZSk7CisJCXR5cGVCaW5k
aW5nID0gcXVhbGlmaWVkTmFtZS5yZXNvbHZlVHlwZUJpbmRpbmcoKTsKKwkJYXNzZXJ0TnVsbCh0
eXBlQmluZGluZyk7CisJCWJpbmRpbmcgPSBxdWFsaWZpZWROYW1lLnJlc29sdmVCaW5kaW5nKCk7
CisJCWFzc2VydFRydWUoIm5vdCBhIHBhY2thZ2UgYmluZGluZyIsIGJpbmRpbmcuZ2V0S2luZCgp
ID09IElCaW5kaW5nLlBBQ0tBR0UpOworCQlhc3NlcnRFcXVhbHMoIndyb25nIHBhY2thZ2UgYmlu
ZGluZyIsICJwYWNrYWdlIHRlc3Q0MDQ0ODkuYnVnIiwgYmluZGluZy50b1N0cmluZygpKTsKKwkJ
bmFtZSA9IHF1YWxpZmllZE5hbWUuZ2V0UXVhbGlmaWVyKCk7CisJCWFzc2VydFRydWUoIndyb25n
IG5hbWUgdHlwZSIsIG5hbWUuaXNTaW1wbGVOYW1lKCkpOworCQlzaW1wbGVOYW1lID0gKFNpbXBs
ZU5hbWUpIG5hbWU7CisJCWNoZWNrU291cmNlUmFuZ2Uoc2ltcGxlTmFtZSwgInRlc3Q0MDQ0ODki
LCBzb3VyY2UpOworCQl0eXBlQmluZGluZyA9IHNpbXBsZU5hbWUucmVzb2x2ZVR5cGVCaW5kaW5n
KCk7CisJCWFzc2VydE51bGwodHlwZUJpbmRpbmcpOworCQliaW5kaW5nID0gc2ltcGxlTmFtZS5y
ZXNvbHZlQmluZGluZygpOworCQlhc3NlcnRUcnVlKCJub3QgYSBwYWNrYWdlIGJpbmRpbmciLCBi
aW5kaW5nLmdldEtpbmQoKSA9PSBJQmluZGluZy5QQUNLQUdFKTsKKwkJYXNzZXJ0RXF1YWxzKCJ3
cm9uZyBwYWNrYWdlIGJpbmRpbmciLCAicGFja2FnZSB0ZXN0NDA0NDg5IiwgYmluZGluZy50b1N0
cmluZygpKTsKKwkJc2ltcGxlTmFtZSA9IHF1YWxpZmllZE5hbWUuZ2V0TmFtZSgpOworCQljaGVj
a1NvdXJjZVJhbmdlKHNpbXBsZU5hbWUsICJidWciLCBzb3VyY2UpOworCQl0eXBlQmluZGluZyA9
IHNpbXBsZU5hbWUucmVzb2x2ZVR5cGVCaW5kaW5nKCk7CisJCWFzc2VydE51bGwodHlwZUJpbmRp
bmcpOworCQliaW5kaW5nID0gc2ltcGxlTmFtZS5yZXNvbHZlQmluZGluZygpOworCQlhc3NlcnRU
cnVlKCJub3QgYSBwYWNrYWdlIGJpbmRpbmciLCBiaW5kaW5nLmdldEtpbmQoKSA9PSBJQmluZGlu
Zy5QQUNLQUdFKTsKKwkJYXNzZXJ0RXF1YWxzKCJ3cm9uZyBwYWNrYWdlIGJpbmRpbmciLCAicGFj
a2FnZSB0ZXN0NDA0NDg5LmJ1ZyIsIGJpbmRpbmcudG9TdHJpbmcoKSk7CisJCQorCQkvLyBhbm5v
dGF0aW9ucyBvZiBwYWNrYWdlIHF1YWxpZmllZCB0eXBlCisJCWFubm90YXRpb25zID0gcGFja2Fn
ZVF1YWxpZmllZFR5cGUuYW5ub3RhdGlvbnMoKTsKKwkJYXNzZXJ0VHJ1ZShhbm5vdGF0aW9ucy5z
aXplKCkgPT0gMSk7CisJCWFubm90YXRpb24gPSAoQW5ub3RhdGlvbikgYW5ub3RhdGlvbnMuZ2V0
KDApOworCQl0eXBlQmluZGluZyA9IGFubm90YXRpb24ucmVzb2x2ZVR5cGVCaW5kaW5nKCk7CisJ
CWFzc2VydE5vdE51bGwoIm51bGwgYmluZGluZyIsIHR5cGVCaW5kaW5nKTsKKwkJYXNzZXJ0RXF1
YWxzKCJub3QgYSB2YWxpZCBiaW5kaW5nIiwgInRlc3Q0MDQ0ODkuYnVnLlguTm9uTnVsbCIsIHR5
cGVCaW5kaW5nLmdldFF1YWxpZmllZE5hbWUoKSk7CisJCWFubm90YXRpb25CaW5kaW5nID0gYW5u
b3RhdGlvbi5yZXNvbHZlQW5ub3RhdGlvbkJpbmRpbmcoKTsKKwkJYXNzZXJ0RXF1YWxzKCJub3Qg
YSB2YWxpZCBhbm5vdGF0aW9uIGJpbmRpbmciLCAiQE5vbk51bGwoKSIsIGFubm90YXRpb25CaW5k
aW5nLnRvU3RyaW5nKCkpOworCQluYW1lID0gYW5ub3RhdGlvbi5nZXRUeXBlTmFtZSgpOworCQlh
c3NlcnRUcnVlKG5hbWUuaXNTaW1wbGVOYW1lKCkpOworCQlzaW1wbGVOYW1lID0gKFNpbXBsZU5h
bWUpIG5hbWU7CisJCXR5cGVCaW5kaW5nID0gc2ltcGxlTmFtZS5yZXNvbHZlVHlwZUJpbmRpbmco
KTsKKwkJY2hlY2tTb3VyY2VSYW5nZShzaW1wbGVOYW1lLCAiTm9uTnVsbCIsIHNvdXJjZSk7CisJ
CWFzc2VydE5vdE51bGwodHlwZUJpbmRpbmcpOworCQkKKwkJLy8gbmFtZSBvZiB0aGUgcGFja2Fn
ZSBxdWFsaWZpZWQgdHlwZQorCQlzaW1wbGVOYW1lID0gcGFja2FnZVF1YWxpZmllZFR5cGUuZ2V0
TmFtZSgpOworCQljaGVja1NvdXJjZVJhbmdlKHNpbXBsZU5hbWUsICJGaWxlTm90Rm91bmRFeGNl
cHRpb24iLCBzb3VyY2UpOworCQl0eXBlQmluZGluZyA9IHNpbXBsZU5hbWUucmVzb2x2ZVR5cGVC
aW5kaW5nKCk7CisJCWFzc2VydE5vdE51bGwodHlwZUJpbmRpbmcpOworCQkKKwkJLy8gdGhyb3dz
CisJCXR5cGUgPSAoVHlwZSkgbWV0aG9kRGVjbC50aHJvd25FeGNlcHRpb25UeXBlcygpLmdldCgw
KTsKKwkJYXNzZXJ0VHJ1ZSh0eXBlLmlzUGFja2FnZVF1YWxpZmllZFR5cGUoKSk7CisJCXBhY2th
Z2VRdWFsaWZpZWRUeXBlID0gKFBhY2thZ2VRdWFsaWZpZWRUeXBlKSB0eXBlOworCQljaGVja1Nv
dXJjZVJhbmdlKHBhY2thZ2VRdWFsaWZpZWRUeXBlLCAidGVzdDQwNDQ4OS5idWcuQE5vbk51bGwg
RU9GRXhjZXB0aW9uIiwgc291cmNlKTsKKwkJdHlwZUJpbmRpbmcgPSBwYWNrYWdlUXVhbGlmaWVk
VHlwZS5yZXNvbHZlQmluZGluZygpOworCQlhc3NlcnROb3ROdWxsKCJudWxsIGJpbmRpbmciLCB0
eXBlQmluZGluZyk7CisJCWFzc2VydEVxdWFscygibm90IGEgdmFsaWQgYmluZGluZyIsICJ0ZXN0
NDA0NDg5LmJ1Zy5FT0ZFeGNlcHRpb24iLCB0eXBlQmluZGluZy5nZXRRdWFsaWZpZWROYW1lKCkp
OworCQkKKwkJLy8gcXVhbGlmaWVyIG9mIHRoZSBwYWNrYWdlIHF1YWxpZmllZCB0eXBlCisJCW5h
bWUgPSBwYWNrYWdlUXVhbGlmaWVkVHlwZS5nZXRRdWFsaWZpZXIoKTsKKwkJYXNzZXJ0VHJ1ZShu
YW1lLmlzUXVhbGlmaWVkTmFtZSgpKTsKKwkJcXVhbGlmaWVkTmFtZSA9IChRdWFsaWZpZWROYW1l
KSBuYW1lOworCQljaGVja1NvdXJjZVJhbmdlKHF1YWxpZmllZE5hbWUsICJ0ZXN0NDA0NDg5LmJ1
ZyIsIHNvdXJjZSk7CisJCXR5cGVCaW5kaW5nID0gcXVhbGlmaWVkTmFtZS5yZXNvbHZlVHlwZUJp
bmRpbmcoKTsKKwkJYXNzZXJ0TnVsbCh0eXBlQmluZGluZyk7CisJCWJpbmRpbmcgPSBxdWFsaWZp
ZWROYW1lLnJlc29sdmVCaW5kaW5nKCk7CisJCWFzc2VydFRydWUoIm5vdCBhIHBhY2thZ2UgYmlu
ZGluZyIsIGJpbmRpbmcuZ2V0S2luZCgpID09IElCaW5kaW5nLlBBQ0tBR0UpOworCQlhc3NlcnRF
cXVhbHMoIndyb25nIHBhY2thZ2UgYmluZGluZyIsICJwYWNrYWdlIHRlc3Q0MDQ0ODkuYnVnIiwg
YmluZGluZy50b1N0cmluZygpKTsKKwkJbmFtZSA9IHF1YWxpZmllZE5hbWUuZ2V0UXVhbGlmaWVy
KCk7CisJCWFzc2VydFRydWUoIndyb25nIG5hbWUgdHlwZSIsIG5hbWUuaXNTaW1wbGVOYW1lKCkp
OworCQlzaW1wbGVOYW1lID0gKFNpbXBsZU5hbWUpIG5hbWU7CisJCWNoZWNrU291cmNlUmFuZ2Uo
c2ltcGxlTmFtZSwgInRlc3Q0MDQ0ODkiLCBzb3VyY2UpOworCQl0eXBlQmluZGluZyA9IHNpbXBs
ZU5hbWUucmVzb2x2ZVR5cGVCaW5kaW5nKCk7CisJCWFzc2VydE51bGwodHlwZUJpbmRpbmcpOwor
CQliaW5kaW5nID0gc2ltcGxlTmFtZS5yZXNvbHZlQmluZGluZygpOworCQlhc3NlcnRUcnVlKCJu
b3QgYSBwYWNrYWdlIGJpbmRpbmciLCBiaW5kaW5nLmdldEtpbmQoKSA9PSBJQmluZGluZy5QQUNL
QUdFKTsKKwkJYXNzZXJ0RXF1YWxzKCJ3cm9uZyBwYWNrYWdlIGJpbmRpbmciLCAicGFja2FnZSB0
ZXN0NDA0NDg5IiwgYmluZGluZy50b1N0cmluZygpKTsKKwkJc2ltcGxlTmFtZSA9IHF1YWxpZmll
ZE5hbWUuZ2V0TmFtZSgpOworCQljaGVja1NvdXJjZVJhbmdlKHNpbXBsZU5hbWUsICJidWciLCBz
b3VyY2UpOworCQl0eXBlQmluZGluZyA9IHNpbXBsZU5hbWUucmVzb2x2ZVR5cGVCaW5kaW5nKCk7
CisJCWFzc2VydE51bGwodHlwZUJpbmRpbmcpOworCQliaW5kaW5nID0gc2ltcGxlTmFtZS5yZXNv
bHZlQmluZGluZygpOworCQlhc3NlcnRUcnVlKCJub3QgYSBwYWNrYWdlIGJpbmRpbmciLCBiaW5k
aW5nLmdldEtpbmQoKSA9PSBJQmluZGluZy5QQUNLQUdFKTsKKwkJYXNzZXJ0RXF1YWxzKCJ3cm9u
ZyBwYWNrYWdlIGJpbmRpbmciLCAicGFja2FnZSB0ZXN0NDA0NDg5LmJ1ZyIsIGJpbmRpbmcudG9T
dHJpbmcoKSk7CisJCQorCQkvLyBhbm5vdGF0aW9ucyBvZiBwYWNrYWdlIHF1YWxpZmllZCB0eXBl
CisJCWFubm90YXRpb25zID0gcGFja2FnZVF1YWxpZmllZFR5cGUuYW5ub3RhdGlvbnMoKTsKKwkJ
YXNzZXJ0VHJ1ZShhbm5vdGF0aW9ucy5zaXplKCkgPT0gMSk7CisJCWFubm90YXRpb24gPSAoQW5u
b3RhdGlvbikgYW5ub3RhdGlvbnMuZ2V0KDApOworCQl0eXBlQmluZGluZyA9IGFubm90YXRpb24u
cmVzb2x2ZVR5cGVCaW5kaW5nKCk7CisJCWFzc2VydE5vdE51bGwoIm51bGwgYmluZGluZyIsIHR5
cGVCaW5kaW5nKTsKKwkJYXNzZXJ0RXF1YWxzKCJub3QgYSB2YWxpZCBiaW5kaW5nIiwgInRlc3Q0
MDQ0ODkuYnVnLlguTm9uTnVsbCIsIHR5cGVCaW5kaW5nLmdldFF1YWxpZmllZE5hbWUoKSk7CisJ
CWFubm90YXRpb25CaW5kaW5nID0gYW5ub3RhdGlvbi5yZXNvbHZlQW5ub3RhdGlvbkJpbmRpbmco
KTsKKwkJYXNzZXJ0RXF1YWxzKCJub3QgYSB2YWxpZCBhbm5vdGF0aW9uIGJpbmRpbmciLCAiQE5v
bk51bGwoKSIsIGFubm90YXRpb25CaW5kaW5nLnRvU3RyaW5nKCkpOworCQluYW1lID0gYW5ub3Rh
dGlvbi5nZXRUeXBlTmFtZSgpOworCQlhc3NlcnRUcnVlKG5hbWUuaXNTaW1wbGVOYW1lKCkpOwor
CQlzaW1wbGVOYW1lID0gKFNpbXBsZU5hbWUpIG5hbWU7CisJCXR5cGVCaW5kaW5nID0gc2ltcGxl
TmFtZS5yZXNvbHZlVHlwZUJpbmRpbmcoKTsKKwkJY2hlY2tTb3VyY2VSYW5nZShzaW1wbGVOYW1l
LCAiTm9uTnVsbCIsIHNvdXJjZSk7CisJCWFzc2VydE5vdE51bGwodHlwZUJpbmRpbmcpOworCQkK
KwkJLy8gbmFtZSBvZiB0aGUgcGFja2FnZSBxdWFsaWZpZWQgdHlwZQorCQlzaW1wbGVOYW1lID0g
cGFja2FnZVF1YWxpZmllZFR5cGUuZ2V0TmFtZSgpOworCQljaGVja1NvdXJjZVJhbmdlKHNpbXBs
ZU5hbWUsICJFT0ZFeGNlcHRpb24iLCBzb3VyY2UpOworCQl0eXBlQmluZGluZyA9IHNpbXBsZU5h
bWUucmVzb2x2ZVR5cGVCaW5kaW5nKCk7CisJCWFzc2VydE5vdE51bGwodHlwZUJpbmRpbmcpOwor
CisJCW5vZGUgPSAoQVNUTm9kZSkgdHlwZURlY2xhcmF0aW9uLmJvZHlEZWNsYXJhdGlvbnMoKS5n
ZXQoMyk7CisJCWFzc2VydEVxdWFscygiTm90IGEgZmllbGQgZGVjbGFyYXRpb24iLCBBU1ROb2Rl
LkZJRUxEX0RFQ0xBUkFUSU9OLCBub2RlLmdldE5vZGVUeXBlKCkpOwkJCisJCUZpZWxkRGVjbGFy
YXRpb24gZmllbGQgPSAoRmllbGREZWNsYXJhdGlvbikgbm9kZTsKKwkJdHlwZSA9IGZpZWxkLmdl
dFR5cGUoKTsKKwkJYXNzZXJ0VHJ1ZSh0eXBlLmlzUXVhbGlmaWVkVHlwZSgpKTsKKwkJUXVhbGlm
aWVkVHlwZSBxdWFsaWZpZWRUeXBlID0gKFF1YWxpZmllZFR5cGUpIHR5cGU7CisJCXBhY2thZ2VR
dWFsaWZpZWRUeXBlID0gKFBhY2thZ2VRdWFsaWZpZWRUeXBlKXF1YWxpZmllZFR5cGUuZ2V0UXVh
bGlmaWVyKCk7CisJCWNoZWNrU291cmNlUmFuZ2UocGFja2FnZVF1YWxpZmllZFR5cGUsICJ0ZXN0
NDA0NDg5LmJ1Zy5ATm9uTnVsbCBYIiwgc291cmNlKTsKKwkJdHlwZUJpbmRpbmcgPSBwYWNrYWdl
UXVhbGlmaWVkVHlwZS5yZXNvbHZlQmluZGluZygpOworCQlhc3NlcnROb3ROdWxsKCJudWxsIGJp
bmRpbmciLCB0eXBlQmluZGluZyk7CisJCWFzc2VydEVxdWFscygibm90IGEgdmFsaWQgYmluZGlu
ZyIsICJ0ZXN0NDA0NDg5LmJ1Zy5YLklubmVyIiwgdHlwZUJpbmRpbmcuZ2V0UXVhbGlmaWVkTmFt
ZSgpKTsKKwkJCisJCS8vIHF1YWxpZmllciBvZiB0aGUgcGFja2FnZSBxdWFsaWZpZWQgdHlwZQor
CQluYW1lID0gcGFja2FnZVF1YWxpZmllZFR5cGUuZ2V0UXVhbGlmaWVyKCk7CisJCWFzc2VydFRy
dWUobmFtZS5pc1F1YWxpZmllZE5hbWUoKSk7CisJCXF1YWxpZmllZE5hbWUgPSAoUXVhbGlmaWVk
TmFtZSkgbmFtZTsKKwkJY2hlY2tTb3VyY2VSYW5nZShxdWFsaWZpZWROYW1lLCAidGVzdDQwNDQ4
OS5idWciLCBzb3VyY2UpOworCQl0eXBlQmluZGluZyA9IHF1YWxpZmllZE5hbWUucmVzb2x2ZVR5
cGVCaW5kaW5nKCk7CisJCWFzc2VydE51bGwodHlwZUJpbmRpbmcpOworCQliaW5kaW5nID0gcXVh
bGlmaWVkTmFtZS5yZXNvbHZlQmluZGluZygpOworCQlhc3NlcnRUcnVlKCJub3QgYSBwYWNrYWdl
IGJpbmRpbmciLCBiaW5kaW5nLmdldEtpbmQoKSA9PSBJQmluZGluZy5QQUNLQUdFKTsKKwkJYXNz
ZXJ0RXF1YWxzKCJ3cm9uZyBwYWNrYWdlIGJpbmRpbmciLCAicGFja2FnZSB0ZXN0NDA0NDg5LmJ1
ZyIsIGJpbmRpbmcudG9TdHJpbmcoKSk7CisJCW5hbWUgPSBxdWFsaWZpZWROYW1lLmdldFF1YWxp
ZmllcigpOworCQlhc3NlcnRUcnVlKCJ3cm9uZyBuYW1lIHR5cGUiLCBuYW1lLmlzU2ltcGxlTmFt
ZSgpKTsKKwkJc2ltcGxlTmFtZSA9IChTaW1wbGVOYW1lKSBuYW1lOworCQljaGVja1NvdXJjZVJh
bmdlKHNpbXBsZU5hbWUsICJ0ZXN0NDA0NDg5Iiwgc291cmNlKTsKKwkJdHlwZUJpbmRpbmcgPSBz
aW1wbGVOYW1lLnJlc29sdmVUeXBlQmluZGluZygpOworCQlhc3NlcnROdWxsKHR5cGVCaW5kaW5n
KTsKKwkJYmluZGluZyA9IHNpbXBsZU5hbWUucmVzb2x2ZUJpbmRpbmcoKTsKKwkJYXNzZXJ0VHJ1
ZSgibm90IGEgcGFja2FnZSBiaW5kaW5nIiwgYmluZGluZy5nZXRLaW5kKCkgPT0gSUJpbmRpbmcu
UEFDS0FHRSk7CisJCWFzc2VydEVxdWFscygid3JvbmcgcGFja2FnZSBiaW5kaW5nIiwgInBhY2th
Z2UgdGVzdDQwNDQ4OSIsIGJpbmRpbmcudG9TdHJpbmcoKSk7CisJCXNpbXBsZU5hbWUgPSBxdWFs
aWZpZWROYW1lLmdldE5hbWUoKTsKKwkJY2hlY2tTb3VyY2VSYW5nZShzaW1wbGVOYW1lLCAiYnVn
Iiwgc291cmNlKTsKKwkJdHlwZUJpbmRpbmcgPSBzaW1wbGVOYW1lLnJlc29sdmVUeXBlQmluZGlu
ZygpOworCQlhc3NlcnROdWxsKHR5cGVCaW5kaW5nKTsKKwkJYmluZGluZyA9IHNpbXBsZU5hbWUu
cmVzb2x2ZUJpbmRpbmcoKTsKKwkJYXNzZXJ0VHJ1ZSgibm90IGEgcGFja2FnZSBiaW5kaW5nIiwg
YmluZGluZy5nZXRLaW5kKCkgPT0gSUJpbmRpbmcuUEFDS0FHRSk7CisJCWFzc2VydEVxdWFscygi
d3JvbmcgcGFja2FnZSBiaW5kaW5nIiwgInBhY2thZ2UgdGVzdDQwNDQ4OS5idWciLCBiaW5kaW5n
LnRvU3RyaW5nKCkpOworCQkKKwkJLy8gYW5ub3RhdGlvbnMgb2YgcGFja2FnZSBxdWFsaWZpZWQg
dHlwZQorCQlhbm5vdGF0aW9ucyA9IHBhY2thZ2VRdWFsaWZpZWRUeXBlLmFubm90YXRpb25zKCk7
CisJCWFzc2VydFRydWUoYW5ub3RhdGlvbnMuc2l6ZSgpID09IDEpOworCQlhbm5vdGF0aW9uID0g
KEFubm90YXRpb24pIGFubm90YXRpb25zLmdldCgwKTsKKwkJdHlwZUJpbmRpbmcgPSBhbm5vdGF0
aW9uLnJlc29sdmVUeXBlQmluZGluZygpOworCQlhc3NlcnROb3ROdWxsKCJudWxsIGJpbmRpbmci
LCB0eXBlQmluZGluZyk7CisJCWFzc2VydEVxdWFscygibm90IGEgdmFsaWQgYmluZGluZyIsICJ0
ZXN0NDA0NDg5LmJ1Zy5YLk5vbk51bGwiLCB0eXBlQmluZGluZy5nZXRRdWFsaWZpZWROYW1lKCkp
OworCQlhbm5vdGF0aW9uQmluZGluZyA9IGFubm90YXRpb24ucmVzb2x2ZUFubm90YXRpb25CaW5k
aW5nKCk7CisJCWFzc2VydEVxdWFscygibm90IGEgdmFsaWQgYW5ub3RhdGlvbiBiaW5kaW5nIiwg
IkBOb25OdWxsKCkiLCBhbm5vdGF0aW9uQmluZGluZy50b1N0cmluZygpKTsKKwkJbmFtZSA9IGFu
bm90YXRpb24uZ2V0VHlwZU5hbWUoKTsKKwkJYXNzZXJ0VHJ1ZShuYW1lLmlzU2ltcGxlTmFtZSgp
KTsKKwkJc2ltcGxlTmFtZSA9IChTaW1wbGVOYW1lKSBuYW1lOworCQl0eXBlQmluZGluZyA9IHNp
bXBsZU5hbWUucmVzb2x2ZVR5cGVCaW5kaW5nKCk7CisJCWNoZWNrU291cmNlUmFuZ2Uoc2ltcGxl
TmFtZSwgIk5vbk51bGwiLCBzb3VyY2UpOworCQlhc3NlcnROb3ROdWxsKHR5cGVCaW5kaW5nKTsK
KwkJCisJCS8vIG5hbWUgb2YgdGhlIHBhY2thZ2UgcXVhbGlmaWVkIHR5cGUKKwkJc2ltcGxlTmFt
ZSA9IHBhY2thZ2VRdWFsaWZpZWRUeXBlLmdldE5hbWUoKTsKKwkJY2hlY2tTb3VyY2VSYW5nZShz
aW1wbGVOYW1lLCAiWCIsIHNvdXJjZSk7CisJCXR5cGVCaW5kaW5nID0gc2ltcGxlTmFtZS5yZXNv
bHZlVHlwZUJpbmRpbmcoKTsKKwkJYXNzZXJ0Tm90TnVsbCh0eXBlQmluZGluZyk7CisJCQorCX0K
IAkvLyBodHRwczovL2J1Z3MuZWNsaXBzZS5vcmcvYnVncy9zaG93X2J1Zy5jZ2k/aWQ9Mzk5Nzky
CiAJcHVibGljIHZvaWQgdGVzdEJ1ZzM5OTc5MigpIHRocm93cyBKYXZhTW9kZWxFeGNlcHRpb24g
ewogCQlTdHJpbmcgY29udGVudCA9CmRpZmYgLS1naXQgYS9vcmcuZWNsaXBzZS5qZHQuY29yZS50
ZXN0cy5tb2RlbC9zcmMvb3JnL2VjbGlwc2UvamR0L2NvcmUvdGVzdHMvZG9tL0FTVE1hdGNoZXJU
ZXN0LmphdmEgYi9vcmcuZWNsaXBzZS5qZHQuY29yZS50ZXN0cy5tb2RlbC9zcmMvb3JnL2VjbGlw
c2UvamR0L2NvcmUvdGVzdHMvZG9tL0FTVE1hdGNoZXJUZXN0LmphdmEKaW5kZXggOTcwZWY2ZS4u
NGVjNzc1OSAxMDA2NDQKLS0tIGEvb3JnLmVjbGlwc2UuamR0LmNvcmUudGVzdHMubW9kZWwvc3Jj
L29yZy9lY2xpcHNlL2pkdC9jb3JlL3Rlc3RzL2RvbS9BU1RNYXRjaGVyVGVzdC5qYXZhCisrKyBi
L29yZy5lY2xpcHNlLmpkdC5jb3JlLnRlc3RzLm1vZGVsL3NyYy9vcmcvZWNsaXBzZS9qZHQvY29y
ZS90ZXN0cy9kb20vQVNUTWF0Y2hlclRlc3QuamF2YQpAQCAtNDUzLDYgKzQ1Myw5IEBACiAJCXB1
YmxpYyBib29sZWFuIG1hdGNoKFBhY2thZ2VEZWNsYXJhdGlvbiBub2RlLCBPYmplY3Qgb3RoZXIp
IHsKIAkJCXJldHVybiBzdGFuZGFyZEJvZHkobm9kZSwgb3RoZXIsIHRoaXMuc3VwZXJNYXRjaCA/
IHN1cGVyLm1hdGNoKG5vZGUsIG90aGVyKSA6IGZhbHNlKTsKIAkJfQorCQlwdWJsaWMgYm9vbGVh
biBtYXRjaChQYWNrYWdlUXVhbGlmaWVkVHlwZSBub2RlLCBPYmplY3Qgb3RoZXIpIHsKKwkJCXJl
dHVybiBzdGFuZGFyZEJvZHkobm9kZSwgb3RoZXIsIHRoaXMuc3VwZXJNYXRjaCA/IHN1cGVyLm1h
dGNoKG5vZGUsIG90aGVyKSA6IGZhbHNlKTsKKwkJfQogCQlwdWJsaWMgYm9vbGVhbiBtYXRjaChQ
YXJhbWV0ZXJpemVkVHlwZSBub2RlLCBPYmplY3Qgb3RoZXIpIHsKIAkJCXJldHVybiBzdGFuZGFy
ZEJvZHkobm9kZSwgb3RoZXIsIHRoaXMuc3VwZXJNYXRjaCA/IHN1cGVyLm1hdGNoKG5vZGUsIG90
aGVyKSA6IGZhbHNlKTsKIAkJfQpAQCAtNzA4LDYgKzcxMSwxNSBAQAogCX0KIAogCS8qKiBAZGVw
cmVjYXRlZCB1c2luZyBkZXByZWNhdGVkIGNvZGUgKi8KKwlwdWJsaWMgdm9pZCB0ZXN0UGFja2Fn
ZVF1YWxpZmllZFR5cGUoKSB7CisJCWlmICh0aGlzLmFzdC5hcGlMZXZlbCgpIDwgQVNULkpMUzgp
IHsKKwkJCXJldHVybjsKKwkJfQorCQlUeXBlIHgxID0gdGhpcy5hc3QubmV3UGFja2FnZVF1YWxp
ZmllZFR5cGUodGhpcy5hc3QubmV3UXVhbGlmaWVkTmFtZSh0aGlzLk4yLCB0aGlzLk4zKSwgdGhp
cy5OMSk7CisJCWJhc2ljTWF0Y2goeDEpOworCX0KKworCS8qKiBAZGVwcmVjYXRlZCB1c2luZyBk
ZXByZWNhdGVkIGNvZGUgKi8KIAlwdWJsaWMgdm9pZCB0ZXN0UGFyYW1ldGVyaXplZFR5cGUoKSB7
CiAJCWlmICh0aGlzLmFzdC5hcGlMZXZlbCgpID09IEFTVC5KTFMyKSB7CiAJCQlyZXR1cm47CmRp
ZmYgLS1naXQgYS9vcmcuZWNsaXBzZS5qZHQuY29yZS50ZXN0cy5tb2RlbC9zcmMvb3JnL2VjbGlw
c2UvamR0L2NvcmUvdGVzdHMvZG9tL0FTVFN0cnVjdHVyYWxQcm9wZXJ0eVRlc3QuamF2YSBiL29y
Zy5lY2xpcHNlLmpkdC5jb3JlLnRlc3RzLm1vZGVsL3NyYy9vcmcvZWNsaXBzZS9qZHQvY29yZS90
ZXN0cy9kb20vQVNUU3RydWN0dXJhbFByb3BlcnR5VGVzdC5qYXZhCmluZGV4IDQzMzM2NDcuLjk0
YTk4NzkgMTAwNjQ0Ci0tLSBhL29yZy5lY2xpcHNlLmpkdC5jb3JlLnRlc3RzLm1vZGVsL3NyYy9v
cmcvZWNsaXBzZS9qZHQvY29yZS90ZXN0cy9kb20vQVNUU3RydWN0dXJhbFByb3BlcnR5VGVzdC5q
YXZhCisrKyBiL29yZy5lY2xpcHNlLmpkdC5jb3JlLnRlc3RzLm1vZGVsL3NyYy9vcmcvZWNsaXBz
ZS9qZHQvY29yZS90ZXN0cy9kb20vQVNUU3RydWN0dXJhbFByb3BlcnR5VGVzdC5qYXZhCkBAIC0z
NTAsNyArMzUwLDcgQEAKIAkJCQkvLyBvb3BzIC0gZ3Vlc3MgdGhhdCdzIG5vdCB2YWxpZAogCQkJ
fQogCQl9Ci0JCWFzc2VydEVxdWFscygiV3JvbmcgbGFzdCBrbm93biB0eXBlIiwgODcsIGhpKTsg
Ly8gbGFzdCBrbm93biBvbmUKKwkJYXNzZXJ0RXF1YWxzKCJXcm9uZyBsYXN0IGtub3duIHR5cGUi
LCA4OCwgaGkpOyAvLyBsYXN0IGtub3duIG9uZQogCQlhc3NlcnRFcXVhbHMoIldyb25nIG51bWJl
ciBvZiBkaXN0aW5jdCB0eXBlcyIsICBoaSwgY2xhc3Nlcy5zaXplKCkpOyAvLyBhbGwgY2xhc3Nl
cyBhcmUgZGlzdGluY3QKIAl9CiB9CmRpZmYgLS1naXQgYS9vcmcuZWNsaXBzZS5qZHQuY29yZS50
ZXN0cy5tb2RlbC9zcmMvb3JnL2VjbGlwc2UvamR0L2NvcmUvdGVzdHMvZG9tL0FTVFZpc2l0b3JU
ZXN0LmphdmEgYi9vcmcuZWNsaXBzZS5qZHQuY29yZS50ZXN0cy5tb2RlbC9zcmMvb3JnL2VjbGlw
c2UvamR0L2NvcmUvdGVzdHMvZG9tL0FTVFZpc2l0b3JUZXN0LmphdmEKaW5kZXggMDA3MmVkOC4u
ZmYwZGIzYSAxMDA2NDQKLS0tIGEvb3JnLmVjbGlwc2UuamR0LmNvcmUudGVzdHMubW9kZWwvc3Jj
L29yZy9lY2xpcHNlL2pkdC9jb3JlL3Rlc3RzL2RvbS9BU1RWaXNpdG9yVGVzdC5qYXZhCisrKyBi
L29yZy5lY2xpcHNlLmpkdC5jb3JlLnRlc3RzLm1vZGVsL3NyYy9vcmcvZWNsaXBzZS9qZHQvY29y
ZS90ZXN0cy9kb20vQVNUVmlzaXRvclRlc3QuamF2YQpAQCAtMzgzLDYgKzM4MywxMyBAQAogCQkJ
QVNUVmlzaXRvclRlc3QudGhpcy5iLmFwcGVuZChub2RlLmdldFByaW1pdGl2ZVR5cGVDb2RlKCku
dG9TdHJpbmcoKSk7CiAJCQlBU1RWaXNpdG9yVGVzdC50aGlzLmIuYXBwZW5kKCJ0UCkiKTsgLy8k
Tk9OLU5MUy0xJAogCQl9CisJCXB1YmxpYyBib29sZWFuIHZpc2l0KFBhY2thZ2VRdWFsaWZpZWRU
eXBlIG5vZGUpIHsKKwkJCUFTVFZpc2l0b3JUZXN0LnRoaXMuYi5hcHBlbmQoIih0UFEiKTsgLy8k
Tk9OLU5MUy0xJAorCQkJcmV0dXJuIGlzVmlzaXRpbmdDaGlsZHJlbigpOworCQl9CisJCXB1Ymxp
YyB2b2lkIGVuZFZpc2l0KFBhY2thZ2VRdWFsaWZpZWRUeXBlIG5vZGUpIHsKKwkJCUFTVFZpc2l0
b3JUZXN0LnRoaXMuYi5hcHBlbmQoInRQUSkiKTsgLy8kTk9OLU5MUy0xJAorCQl9CiAJCXB1Ymxp
YyBib29sZWFuIHZpc2l0KFBhcmFtZXRlcml6ZWRUeXBlIG5vZGUpIHsKIAkJCUFTVFZpc2l0b3JU
ZXN0LnRoaXMuYi5hcHBlbmQoIih0TSIpOyAvLyROT04tTkxTLTEkCiAJCQlyZXR1cm4gaXNWaXNp
dGluZ0NoaWxkcmVuKCk7CkBAIC0xMTIyLDYgKzExMjksMjAgQEAKIAl9CiAKIAkvKiogQGRlcHJl
Y2F0ZWQgdXNpbmcgZGVwcmVjYXRlZCBjb2RlICovCisJcHVibGljIHZvaWQgdGVzdFBhY2thZ2VR
dWFsaWZpZWRUeXBlKCkgeworCQlpZiAodGhpcy5hc3QuYXBpTGV2ZWwoKSA8IEFTVC5KTFM4KSB7
CisJCQlyZXR1cm47CisJCX0KKwkJUXVhbGlmaWVkTmFtZSBxID0gdGhpcy5hc3QubmV3UXVhbGlm
aWVkTmFtZSh0aGlzLk4yLCB0aGlzLk4zKTsKKwkJUGFja2FnZVF1YWxpZmllZFR5cGUgeDEgPSB0
aGlzLmFzdC5uZXdQYWNrYWdlUXVhbGlmaWVkVHlwZShxLCB0aGlzLk4xKTsKKwkJVGVzdFZpc2l0
b3IgdjEgPSBuZXcgVGVzdFZpc2l0b3IoKTsKKwkJdGhpcy5iLnNldExlbmd0aCgwKTsKKwkJeDEu
YWNjZXB0KHYxKTsKKwkJU3RyaW5nIHJlc3VsdCA9IHRoaXMuYi50b1N0cmluZygpOworCQlhc3Nl
cnRUcnVlKHJlc3VsdC5lcXVhbHMoIlsodFBRIisiWyhuUSIrdGhpcy5OMlMrdGhpcy5OM1MrIm5R
KV0iK3RoaXMuTjFTKyJ0UFEpXSIpKTsgLy8kTk9OLU5MUy0xJCAvLyROT04tTkxTLTIkCisJfQor
CisJLyoqIEBkZXByZWNhdGVkIHVzaW5nIGRlcHJlY2F0ZWQgY29kZSAqLwogCXB1YmxpYyB2b2lk
IHRlc3RQYXJhbWV0ZXJpemVkVHlwZSgpIHsKIAkJaWYgKHRoaXMuYXN0LmFwaUxldmVsKCkgPT0g
QVNULkpMUzIpIHsKIAkJCXJldHVybjsKZGlmZiAtLWdpdCBhL29yZy5lY2xpcHNlLmpkdC5jb3Jl
LnRlc3RzLm1vZGVsL3dvcmtzcGFjZS9Db252ZXJ0ZXIxNS9zcmMvdGVzdDQwNDQ4OS9idWcvWC5q
YXZhIGIvb3JnLmVjbGlwc2UuamR0LmNvcmUudGVzdHMubW9kZWwvd29ya3NwYWNlL0NvbnZlcnRl
cjE1L3NyYy90ZXN0NDA0NDg5L2J1Zy9YLmphdmEKbmV3IGZpbGUgbW9kZSAxMDA2NDQKaW5kZXgg
MDAwMDAwMC4uNGNmNTQyYQotLS0gL2Rldi9udWxsCisrKyBiL29yZy5lY2xpcHNlLmpkdC5jb3Jl
LnRlc3RzLm1vZGVsL3dvcmtzcGFjZS9Db252ZXJ0ZXIxNS9zcmMvdGVzdDQwNDQ4OS9idWcvWC5q
YXZhCkBAIC0wLDAgKzEsMzcgQEAKK3BhY2thZ2UgdGVzdDQwNDQ4OS5idWc7CitpbXBvcnQgamF2
YS5sYW5nLmFubm90YXRpb24uKjsKK3B1YmxpYyBjbGFzcyBYIHsKKwlAVGFyZ2V0KEVsZW1lbnRU
eXBlLlRZUEVfVVNFKQorCUBSZXRlbnRpb24oUmV0ZW50aW9uUG9saWN5LlJVTlRJTUUpCisJQERv
Y3VtZW50ZWQKKwlzdGF0aWMgQGludGVyZmFjZSBOb25OdWxsIHsgfQorCWNsYXNzIElubmVyIHt9
CisJCisJLyoqCisgCSogQHBhcmFtIGFyZyAgCisgCSovCisJdGVzdDQwNDQ4OS5idWcuQE5vbk51
bGwgSU9FeGNlcHRpb24gZm9vKAorCQkJdGVzdDQwNDQ4OS5idWcuQE5vbk51bGwgRmlsZU5vdEZv
dW5kRXhjZXB0aW9uIGFyZykKKwkJdGhyb3dzIHRlc3Q0MDQ0ODkuYnVnLkBOb25OdWxsIEVPRkV4
Y2VwdGlvbiB7CisJCXRyeSB7CisJCQl0ZXN0NDA0NDg5LmJ1Zy5ATm9uTnVsbCBJT0Vycm9yIGUg
PSBuZXcgdGVzdDQwNDQ4OS5idWcuSU9FcnJvcigpOworCQkJdGhyb3cgZTsKKwkJfSBjYXRjaCAo
dGVzdDQwNDQ4OS5idWcuQE5vbk51bGwgSU9FcnJvciBlKSB7CisJCX0KKwkJcmV0dXJuIG51bGw7
CisJfSAKKwl0ZXN0NDA0NDg5LmJ1Zy5ATm9uTnVsbCBYLkBOb25OdWxsIElubmVyIGZJbm5lcjsK
K30gCitAamF2YS5sYW5nLmFubm90YXRpb24uVGFyZ2V0KGphdmEubGFuZy5hbm5vdGF0aW9uLkVs
ZW1lbnRUeXBlLlRZUEVfVVNFKSBAaW50ZXJmYWNlIE1hcmtlciB7fSAKK0BqYXZhLmxhbmcuYW5u
b3RhdGlvbi5UYXJnZXQoamF2YS5sYW5nLmFubm90YXRpb24uRWxlbWVudFR5cGUuVFlQRV9VU0Up
IEBpbnRlcmZhY2UgQSB7fSAKK0BqYXZhLmxhbmcuYW5ub3RhdGlvbi5UYXJnZXQoamF2YS5sYW5n
LmFubm90YXRpb24uRWxlbWVudFR5cGUuVFlQRV9VU0UpIEBpbnRlcmZhY2UgQiB7fSAKKworY2xh
c3MgT3V0ZXIgeworCXB1YmxpYyBjbGFzcyBJbm5lciB7CisJCXB1YmxpYyBjbGFzcyBEZWVwZXIg
e30KKwl9Cit9CitjbGFzcyBJT0V4Y2VwdGlvbiBleHRlbmRzIEV4Y2VwdGlvbiB7cHJpdmF0ZSBz
dGF0aWMgZmluYWwgbG9uZyBzZXJpYWxWZXJzaW9uVUlEPTEwMDAxTDt9CitjbGFzcyBGaWxlTm90
Rm91bmRFeGNlcHRpb24gZXh0ZW5kcyBFeGNlcHRpb257cHJpdmF0ZSBzdGF0aWMgZmluYWwgbG9u
ZyBzZXJpYWxWZXJzaW9uVUlEPTEwMDAyTDt9CitjbGFzcyBFT0ZFeGNlcHRpb24gZXh0ZW5kcyBF
eGNlcHRpb257cHJpdmF0ZSBzdGF0aWMgZmluYWwgbG9uZyBzZXJpYWxWZXJzaW9uVUlEPTEwMDAz
TDt9CitjbGFzcyBJT0Vycm9yIGV4dGVuZHMgRXhjZXB0aW9ue3ByaXZhdGUgc3RhdGljIGZpbmFs
IGxvbmcgc2VyaWFsVmVyc2lvblVJRD0xMDAwNEw7fQpcIE5vIG5ld2xpbmUgYXQgZW5kIG9mIGZp
bGUKZGlmZiAtLWdpdCBhL29yZy5lY2xpcHNlLmpkdC5jb3JlLnRlc3RzLm1vZGVsL3dvcmtzcGFj
ZS9Db252ZXJ0ZXIxOC9zcmMvdGVzdDQwNDQ4OS9idWcvWC5qYXZhIGIvb3JnLmVjbGlwc2UuamR0
LmNvcmUudGVzdHMubW9kZWwvd29ya3NwYWNlL0NvbnZlcnRlcjE4L3NyYy90ZXN0NDA0NDg5L2J1
Zy9YLmphdmEKbmV3IGZpbGUgbW9kZSAxMDA2NDQKaW5kZXggMDAwMDAwMC4uNGNmNTQyYQotLS0g
L2Rldi9udWxsCisrKyBiL29yZy5lY2xpcHNlLmpkdC5jb3JlLnRlc3RzLm1vZGVsL3dvcmtzcGFj
ZS9Db252ZXJ0ZXIxOC9zcmMvdGVzdDQwNDQ4OS9idWcvWC5qYXZhCkBAIC0wLDAgKzEsMzcgQEAK
K3BhY2thZ2UgdGVzdDQwNDQ4OS5idWc7CitpbXBvcnQgamF2YS5sYW5nLmFubm90YXRpb24uKjsK
K3B1YmxpYyBjbGFzcyBYIHsKKwlAVGFyZ2V0KEVsZW1lbnRUeXBlLlRZUEVfVVNFKQorCUBSZXRl
bnRpb24oUmV0ZW50aW9uUG9saWN5LlJVTlRJTUUpCisJQERvY3VtZW50ZWQKKwlzdGF0aWMgQGlu
dGVyZmFjZSBOb25OdWxsIHsgfQorCWNsYXNzIElubmVyIHt9CisJCisJLyoqCisgCSogQHBhcmFt
IGFyZyAgCisgCSovCisJdGVzdDQwNDQ4OS5idWcuQE5vbk51bGwgSU9FeGNlcHRpb24gZm9vKAor
CQkJdGVzdDQwNDQ4OS5idWcuQE5vbk51bGwgRmlsZU5vdEZvdW5kRXhjZXB0aW9uIGFyZykKKwkJ
dGhyb3dzIHRlc3Q0MDQ0ODkuYnVnLkBOb25OdWxsIEVPRkV4Y2VwdGlvbiB7CisJCXRyeSB7CisJ
CQl0ZXN0NDA0NDg5LmJ1Zy5ATm9uTnVsbCBJT0Vycm9yIGUgPSBuZXcgdGVzdDQwNDQ4OS5idWcu
SU9FcnJvcigpOworCQkJdGhyb3cgZTsKKwkJfSBjYXRjaCAodGVzdDQwNDQ4OS5idWcuQE5vbk51
bGwgSU9FcnJvciBlKSB7CisJCX0KKwkJcmV0dXJuIG51bGw7CisJfSAKKwl0ZXN0NDA0NDg5LmJ1
Zy5ATm9uTnVsbCBYLkBOb25OdWxsIElubmVyIGZJbm5lcjsKK30gCitAamF2YS5sYW5nLmFubm90
YXRpb24uVGFyZ2V0KGphdmEubGFuZy5hbm5vdGF0aW9uLkVsZW1lbnRUeXBlLlRZUEVfVVNFKSBA
aW50ZXJmYWNlIE1hcmtlciB7fSAKK0BqYXZhLmxhbmcuYW5ub3RhdGlvbi5UYXJnZXQoamF2YS5s
YW5nLmFubm90YXRpb24uRWxlbWVudFR5cGUuVFlQRV9VU0UpIEBpbnRlcmZhY2UgQSB7fSAKK0Bq
YXZhLmxhbmcuYW5ub3RhdGlvbi5UYXJnZXQoamF2YS5sYW5nLmFubm90YXRpb24uRWxlbWVudFR5
cGUuVFlQRV9VU0UpIEBpbnRlcmZhY2UgQiB7fSAKKworY2xhc3MgT3V0ZXIgeworCXB1YmxpYyBj
bGFzcyBJbm5lciB7CisJCXB1YmxpYyBjbGFzcyBEZWVwZXIge30KKwl9Cit9CitjbGFzcyBJT0V4
Y2VwdGlvbiBleHRlbmRzIEV4Y2VwdGlvbiB7cHJpdmF0ZSBzdGF0aWMgZmluYWwgbG9uZyBzZXJp
YWxWZXJzaW9uVUlEPTEwMDAxTDt9CitjbGFzcyBGaWxlTm90Rm91bmRFeGNlcHRpb24gZXh0ZW5k
cyBFeGNlcHRpb257cHJpdmF0ZSBzdGF0aWMgZmluYWwgbG9uZyBzZXJpYWxWZXJzaW9uVUlEPTEw
MDAyTDt9CitjbGFzcyBFT0ZFeGNlcHRpb24gZXh0ZW5kcyBFeGNlcHRpb257cHJpdmF0ZSBzdGF0
aWMgZmluYWwgbG9uZyBzZXJpYWxWZXJzaW9uVUlEPTEwMDAzTDt9CitjbGFzcyBJT0Vycm9yIGV4
dGVuZHMgRXhjZXB0aW9ue3ByaXZhdGUgc3RhdGljIGZpbmFsIGxvbmcgc2VyaWFsVmVyc2lvblVJ
RD0xMDAwNEw7fQpcIE5vIG5ld2xpbmUgYXQgZW5kIG9mIGZpbGUKZGlmZiAtLWdpdCBhL29yZy5l
Y2xpcHNlLmpkdC5jb3JlL2RvbS9vcmcvZWNsaXBzZS9qZHQvY29yZS9kb20vQVNULmphdmEgYi9v
cmcuZWNsaXBzZS5qZHQuY29yZS9kb20vb3JnL2VjbGlwc2UvamR0L2NvcmUvZG9tL0FTVC5qYXZh
CmluZGV4IDRlODhjMjguLmRlNWZhMDYgMTAwNjQ0Ci0tLSBhL29yZy5lY2xpcHNlLmpkdC5jb3Jl
L2RvbS9vcmcvZWNsaXBzZS9qZHQvY29yZS9kb20vQVNULmphdmEKKysrIGIvb3JnLmVjbGlwc2Uu
amR0LmNvcmUvZG9tL29yZy9lY2xpcHNlL2pkdC9jb3JlL2RvbS9BU1QuamF2YQpAQCAtMTk2Niw2
ICsxOTY2LDI5IEBACiAJfQogCiAJLyoqCisJICogQ3JlYXRlcyBhbmQgcmV0dXJucyBhIG5ldyB1
bnBhcmVudGVkIHBhY2thZ2UgcXVhbGlmaWVkIHR5cGUgbm9kZSB3aXRoCisJICogdGhlIGdpdmVu
IHF1YWxpZmllciBhbmQgbmFtZS4KKwkgKgorCSAqIEBwYXJhbSBxdWFsaWZpZXIgdGhlIHBhY2th
Z2UgcXVhbGlmaWVyIHR5cGUgbm9kZQorCSAqIEBwYXJhbSBuYW1lIHRoZSBzaW1wbGUgbmFtZSBi
ZWluZyBxdWFsaWZpZWQKKwkgKiBAcmV0dXJuIGEgbmV3IHVucGFyZW50ZWQgcXVhbGlmaWVkIHR5
cGUgbm9kZQorCSAqIEBleGNlcHRpb24gSWxsZWdhbEFyZ3VtZW50RXhjZXB0aW9uIGlmOgorCSAq
IDx1bD4KKwkgKiA8bGk+dGhlIG5vZGUgYmVsb25ncyB0byBhIGRpZmZlcmVudCBBU1Q8L2xpPgor
CSAqIDxsaT50aGUgbm9kZSBhbHJlYWR5IGhhcyBhIHBhcmVudDwvbGk+CisJICogPC91bD4KKwkg
KiBAZXhjZXB0aW9uIFVuc3VwcG9ydGVkT3BlcmF0aW9uRXhjZXB0aW9uIGlmIHRoaXMgb3BlcmF0
aW9uIGlzIHVzZWQgaW4KKwkgKiBhIEpMUzIsIEpMUzMgYW5kIEpMUzQgQVNUCisJICogQHNpbmNl
IDMuOSBCRVRBX0pBVkE4CisJICovCisJcHVibGljIFBhY2thZ2VRdWFsaWZpZWRUeXBlIG5ld1Bh
Y2thZ2VRdWFsaWZpZWRUeXBlKE5hbWUgcXVhbGlmaWVyLCBTaW1wbGVOYW1lIG5hbWUpIHsKKwkJ
UGFja2FnZVF1YWxpZmllZFR5cGUgcmVzdWx0ID0gbmV3IFBhY2thZ2VRdWFsaWZpZWRUeXBlKHRo
aXMpOworCQlyZXN1bHQuc2V0UXVhbGlmaWVyKHF1YWxpZmllcik7CisJCXJlc3VsdC5zZXROYW1l
KG5hbWUpOworCQlyZXR1cm4gcmVzdWx0OworCX0KKworCS8qKgogCSAqIENyZWF0ZXMgYW5kIHJl
dHVybnMgYSBuZXcgdW5wYXJlbnRlZCBwYXJhbWV0ZXJpemVkIHR5cGUgbm9kZSB3aXRoIHRoZQog
CSAqIGdpdmVuIHR5cGUgYW5kIGFuIGVtcHR5IGxpc3Qgb2YgdHlwZSBhcmd1bWVudHMuCiAJICoK
ZGlmZiAtLWdpdCBhL29yZy5lY2xpcHNlLmpkdC5jb3JlL2RvbS9vcmcvZWNsaXBzZS9qZHQvY29y
ZS9kb20vQVNUQ29udmVydGVyLmphdmEgYi9vcmcuZWNsaXBzZS5qZHQuY29yZS9kb20vb3JnL2Vj
bGlwc2UvamR0L2NvcmUvZG9tL0FTVENvbnZlcnRlci5qYXZhCmluZGV4IDQzYTZjMzMuLjIyNmY3
Y2EgMTAwNjQ0Ci0tLSBhL29yZy5lY2xpcHNlLmpkdC5jb3JlL2RvbS9vcmcvZWNsaXBzZS9qZHQv
Y29yZS9kb20vQVNUQ29udmVydGVyLmphdmEKKysrIGIvb3JnLmVjbGlwc2UuamR0LmNvcmUvZG9t
L29yZy9lY2xpcHNlL2pkdC9jb3JlL2RvbS9BU1RDb252ZXJ0ZXIuamF2YQpAQCAtMTcsNiArMTcs
NyBAQAogCiBwYWNrYWdlIG9yZy5lY2xpcHNlLmpkdC5jb3JlLmRvbTsKIAoraW1wb3J0IGphdmEu
dXRpbC5BcnJheXM7CiBpbXBvcnQgamF2YS51dGlsLkhhc2hTZXQ7CiBpbXBvcnQgamF2YS51dGls
Lkl0ZXJhdG9yOwogaW1wb3J0IGphdmEudXRpbC5MaXN0OwpAQCAtNTcsNiArNTgsOCBAQAogaW1w
b3J0IG9yZy5lY2xpcHNlLmpkdC5pbnRlcm5hbC5jb21waWxlci5pbXBsLkNvbXBpbGVyT3B0aW9u
czsKIGltcG9ydCBvcmcuZWNsaXBzZS5qZHQuaW50ZXJuYWwuY29tcGlsZXIubG9va3VwLkJsb2Nr
U2NvcGU7CiBpbXBvcnQgb3JnLmVjbGlwc2UuamR0LmludGVybmFsLmNvbXBpbGVyLmxvb2t1cC5F
eHRyYUNvbXBpbGVyTW9kaWZpZXJzOworaW1wb3J0IG9yZy5lY2xpcHNlLmpkdC5pbnRlcm5hbC5j
b21waWxlci5sb29rdXAuUGFja2FnZUJpbmRpbmc7CitpbXBvcnQgb3JnLmVjbGlwc2UuamR0Lmlu
dGVybmFsLmNvbXBpbGVyLmxvb2t1cC5SZWZlcmVuY2VCaW5kaW5nOwogaW1wb3J0IG9yZy5lY2xp
cHNlLmpkdC5pbnRlcm5hbC5jb21waWxlci5sb29rdXAuVHlwZUNvbnN0YW50czsKIGltcG9ydCBv
cmcuZWNsaXBzZS5qZHQuaW50ZXJuYWwuY29tcGlsZXIucGFyc2VyLlJlY292ZXJ5U2Nhbm5lcjsK
IGltcG9ydCBvcmcuZWNsaXBzZS5qZHQuaW50ZXJuYWwuY29tcGlsZXIucGFyc2VyLlNjYW5uZXI7
CkBAIC0zMjk2LDkgKzMyOTksNiBAQAogCQkJCQlvcmcuZWNsaXBzZS5qZHQuaW50ZXJuYWwuY29t
cGlsZXIuYXN0LkFubm90YXRpb24gdHlwZUFubm90YXRpb24gPSBhbm5vdGF0aW9uc1tpXTsKIAkJ
CQkJaWYgKHR5cGVBbm5vdGF0aW9uICE9IG51bGwpIHsKIAkJCQkJCUFubm90YXRpb24gYW5ub3Rh
dGlvbiA9IGNvbnZlcnQodHlwZUFubm90YXRpb24pOwotCQkJCQkJaW50IHN0YXJ0ID0gdHlwZUFu
bm90YXRpb24uc291cmNlU3RhcnQ7Ci0JCQkJCQlpbnQgZW5kID0gdHlwZUFubm90YXRpb24uc291
cmNlRW5kOwotCQkJCQkJYW5ub3RhdGlvbi5zZXRTb3VyY2VSYW5nZShzdGFydCwgZW5kIC0gc3Rh
cnQgKyAxKTsKIAkJCQkJCXR5cGUuYW5ub3RhdGlvbnMoKS5hZGQoYW5ub3RhdGlvbik7CiAJCQkJ
CX0KIAkJCQl9CkBAIC0zMzI5LDkgKzMzMjksNiBAQAogCQkJCQlvcmcuZWNsaXBzZS5qZHQuaW50
ZXJuYWwuY29tcGlsZXIuYXN0LkFubm90YXRpb24gdHlwZUFubm90YXRpb24gPSBhbm5vdGF0aW9u
c1tpXTsKIAkJCQkJaWYgKHR5cGVBbm5vdGF0aW9uICE9IG51bGwpIHsKIAkJCQkJCUFubm90YXRp
b24gYW5ub3RhdGlvbiA9IGNvbnZlcnQodHlwZUFubm90YXRpb24pOwotCQkJCQkJaW50IHN0YXJ0
ID0gdHlwZUFubm90YXRpb24uc291cmNlU3RhcnQ7Ci0JCQkJCQlpbnQgZW5kID0gdHlwZUFubm90
YXRpb24uc291cmNlRW5kOwotCQkJCQkJYW5ub3RhdGlvbi5zZXRTb3VyY2VSYW5nZShzdGFydCwg
ZW5kIC0gc3RhcnQgKyAxKTsKIAkJCQkJCXR5cGVQYXJhbWV0ZXIuYW5ub3RhdGlvbnMoKS5hZGQo
YW5ub3RhdGlvbik7CiAJCQkJCX0KIAkJCQl9CkBAIC0zNTQ2LDEzICszNTQzLDcgQEAKIAkJCQkJ
CXNpbXBsZVR5cGUuc2V0TmFtZShuYW1lKTsKIAkJCQkJCWludCBzdGFydCA9IChpbnQpKHBvc2l0
aW9uc1swXSA+Pj4gMzIpOwogCQkJCQkJaW50IGVuZCA9IChpbnQpcG9zaXRpb25zW2ZpcnN0VHlw
ZUluZGV4XTsKLQkJCQkJCXNpbXBsZVR5cGUuc2V0U291cmNlUmFuZ2Uoc3RhcnQsIGVuZCAtIHN0
YXJ0ICsgMSk7Ci0JCQkJCQlpZiAodHlwZUFubm90YXRpb25zICE9IG51bGwgJiYgKGFubm90YXRp
b25zID0gdHlwZUFubm90YXRpb25zW2ZpcnN0VHlwZUluZGV4XSkgIT0gbnVsbCkgewotCQkJCQkJ
CWFubm90YXRlVHlwZShzaW1wbGVUeXBlLCBhbm5vdGF0aW9ucyk7Ci0JCQkJCQl9Ci0JCQkJCQlp
ZiAodGhpcy5yZXNvbHZlQmluZGluZ3MpIHsKLQkJCQkJCQlyZWNvcmROb2RlcyhzaW1wbGVUeXBl
LCB0eXBlUmVmZXJlbmNlKTsKLQkJCQkJCX0KKwkJCQkJCXNldFNvdXJjZUFubm90YXRpb25zQW5k
QmluZGluZ3ModHlwZVJlZmVyZW5jZSwgcG9zaXRpb25zLCB0eXBlQW5ub3RhdGlvbnMsIGZpcnN0
VHlwZUluZGV4LCAwLCBmaXJzdFR5cGVJbmRleCwgc2ltcGxlVHlwZSk7CiAJCQkJCQlUeXBlIGN1
cnJlbnRUeXBlID0gc2ltcGxlVHlwZTsJCQkJCQkKIAkJCQkJCWludCBpbmRleE9mRW5jbG9zaW5n
VHlwZSA9IDE7CiAJCQkJCQlpZiAodHlwZUFyZ3VtZW50cyAhPSBudWxsICYmIChhcmd1bWVudHMg
PSB0eXBlQXJndW1lbnRzW2ZpcnN0VHlwZUluZGV4XSkgIT0gbnVsbCkgewpAQCAtMzYyOCw3ICsz
NjE5LDcgQEAKIAkJCQlvcmcuZWNsaXBzZS5qZHQuaW50ZXJuYWwuY29tcGlsZXIuYXN0LkFubm90
YXRpb24gW11bXSB0eXBlQW5ub3RhdGlvbnMgPSB0eXBlUmVmZXJlbmNlLmFubm90YXRpb25zOwog
CQkJCWNoYXIgW11bXSB0b2tlbnMgPSBxdWFsaWZpZWRUeXBlUmVmZXJlbmNlLnRva2VuczsKIAkJ
CQlpbnQgbGVudGggPSB0b2tlbnMubGVuZ3RoOwotCQkJCWludCBmaXJzdFR5cGVJbmRleCA9IGxl
bnRoIC0gMTsKKwkJCQlpbnQgZmlyc3RUeXBlSW5kZXggPSBsZW50aDsKIAkJCQkKIAkJCQlpZiAo
dHlwZUFubm90YXRpb25zICE9IG51bGwpIHsKIAkJCQkJZm9yIChpbnQgaSA9IDA7IGkgPCBsZW50
aDsgKytpKSB7CkBAIC0zNjQwLDU3ICszNjMxLDQ0IEBACiAJCQkJfSAgCiAJCQkJc291cmNlU3Rh
cnQgPSAoaW50KShwb3NpdGlvbnNbMF0+Pj4zMik7CiAJCQkJTmFtZSBuYW1lID0gbnVsbDsKLQkJ
CQlpZiAoZmlyc3RUeXBlSW5kZXggPT0gMCkgewotCQkJCQlmaW5hbCBTaW1wbGVOYW1lIHNpbXBs
ZU5hbWUgPSBuZXcgU2ltcGxlTmFtZSh0aGlzLmFzdCk7Ci0JCQkJCXNpbXBsZU5hbWUuaW50ZXJu
YWxTZXRJZGVudGlmaWVyKG5ldyBTdHJpbmcodG9rZW5zWzBdKSk7Ci0JCQkJCXJlY29yZFBlbmRp
bmdOYW1lU2NvcGVSZXNvbHV0aW9uKHNpbXBsZU5hbWUpOwotCQkJCQlpbnQgc3RhcnQgPSAoaW50
KSAocG9zaXRpb25zWzBdID4+PiAzMik7Ci0JCQkJCWludCBlbmQgPSAoaW50KSBwb3NpdGlvbnNb
MF07Ci0JCQkJCXNpbXBsZU5hbWUuc2V0U291cmNlUmFuZ2Uoc3RhcnQsIGVuZCk7Ci0JCQkJCXNp
bXBsZU5hbWUuaW5kZXggPSAxOwotCQkJCQluYW1lID0gc2ltcGxlTmFtZTsKLQkJCQkJaWYgKHRo
aXMucmVzb2x2ZUJpbmRpbmdzKSB7Ci0JCQkJCQlyZWNvcmROb2RlcyhzaW1wbGVOYW1lLCB0eXBl
UmVmZXJlbmNlKTsKLQkJCQkJfQkJCQkJCisJCQkJVHlwZSBjdXJyZW50VHlwZSA9IG51bGw7CisJ
CQkJaWYgKGZpcnN0VHlwZUluZGV4ID09IGxlbnRoKSB7Ly9KdXN0IGEgUXVhbGlmaWVkTmFtZQor
CQkJCQluYW1lID0gc2V0UXVhbGlmaWVkTmFtZU5hbWVBbmRTb3VyY2VSYW5nZXModG9rZW5zLCBw
b3NpdGlvbnMsIGxlbnRoIC0gMSwgdHlwZVJlZmVyZW5jZSk7CisJCQkJCWN1cnJlbnRUeXBlID0g
Z2V0U2ltcGxlVHlwZVdpdGhOYW1lQW5kQmluZGluZyhuYW1lLCB0eXBlUmVmZXJlbmNlLCBwb3Np
dGlvbnMsIDAsIGxlbnRoIC0gMSk7CiAJCQkJfSBlbHNlIHsKLQkJCQkJbmFtZSA9IHNldFF1YWxp
ZmllZE5hbWVOYW1lQW5kU291cmNlUmFuZ2VzKHRva2VucywgcG9zaXRpb25zLCBmaXJzdFR5cGVJ
bmRleCwgdHlwZVJlZmVyZW5jZSk7Ci0JCQkJfQotCQkJCVNpbXBsZVR5cGUgc2ltcGxlVHlwZSA9
IG5ldyBTaW1wbGVUeXBlKHRoaXMuYXN0KTsKLQkJCQlzaW1wbGVUeXBlLnNldE5hbWUobmFtZSk7
Ci0JCQkJaW50IHN0YXJ0ID0gKGludCkocG9zaXRpb25zWzBdID4+PiAzMik7Ci0JCQkJaW50IGVu
ZCA9IChpbnQpcG9zaXRpb25zW2ZpcnN0VHlwZUluZGV4XTsKLQkJCQlzaW1wbGVUeXBlLnNldFNv
dXJjZVJhbmdlKHN0YXJ0LCBlbmQgLSBzdGFydCArIDEpOwotCQkJCWlmICh0eXBlQW5ub3RhdGlv
bnMgIT0gbnVsbCAmJiAoYW5ub3RhdGlvbnMgPSB0eXBlQW5ub3RhdGlvbnNbZmlyc3RUeXBlSW5k
ZXhdKSAhPSBudWxsKSB7Ci0JCQkJCWFubm90YXRlVHlwZShzaW1wbGVUeXBlLCBhbm5vdGF0aW9u
cyk7Ci0JCQkJfQotCQkJCWlmICh0aGlzLnJlc29sdmVCaW5kaW5ncykgewotCQkJCQlyZWNvcmRO
b2RlcyhzaW1wbGVUeXBlLCB0eXBlUmVmZXJlbmNlKTsKLQkJCQl9Ci0JCQkJVHlwZSBjdXJyZW50
VHlwZSA9IHNpbXBsZVR5cGU7Ci0JCQkJCi0JCQkJZm9yIChpbnQgaSA9IGZpcnN0VHlwZUluZGV4
ICsgMTsgaSA8IGxlbnRoOyArK2kpIHsKLQkJCQkJU2ltcGxlTmFtZSBzaW1wbGVOYW1lID0gbmV3
IFNpbXBsZU5hbWUodGhpcy5hc3QpOwotCQkJCQlzaW1wbGVOYW1lLmludGVybmFsU2V0SWRlbnRp
ZmllcihuZXcgU3RyaW5nKHRva2Vuc1tpXSkpOwotCQkJCQlzaW1wbGVOYW1lLmluZGV4ID0gaSAr
IDE7Ci0JCQkJCXN0YXJ0ID0gKGludCkgKHBvc2l0aW9uc1tpXSA+Pj4gMzIpOwotCQkJCQllbmQg
PSAoaW50KSBwb3NpdGlvbnNbaV07Ci0JCQkJCXNpbXBsZU5hbWUuc2V0U291cmNlUmFuZ2Uoc3Rh
cnQsIGVuZCAtIHN0YXJ0ICsxKTsKLQkJCQkJcmVjb3JkUGVuZGluZ05hbWVTY29wZVJlc29sdXRp
b24oc2ltcGxlTmFtZSk7Ci0JCQkJCVF1YWxpZmllZFR5cGUgcXVhbGlmaWVkVHlwZSA9IG5ldyBR
dWFsaWZpZWRUeXBlKHRoaXMuYXN0KTsKLQkJCQkJcXVhbGlmaWVkVHlwZS5zZXRRdWFsaWZpZXIo
Y3VycmVudFR5cGUpOwotCQkJCQlxdWFsaWZpZWRUeXBlLnNldE5hbWUoc2ltcGxlTmFtZSk7Ci0J
CQkJCWlmICh0eXBlQW5ub3RhdGlvbnMgIT0gbnVsbCAmJiAoYW5ub3RhdGlvbnMgPSB0eXBlQW5u
b3RhdGlvbnNbaV0pICE9IG51bGwpIHsKLQkJCQkJCWFubm90YXRlVHlwZShxdWFsaWZpZWRUeXBl
LCBhbm5vdGF0aW9ucyk7CisJCQkJCWlmIChmaXJzdFR5cGVJbmRleCA8PSAxKSB7CisJCQkJCQlu
YW1lID0gY3JlYXRlU2ltcGxlTmFtZSh0eXBlUmVmZXJlbmNlLCBwb3NpdGlvbnMsIHRva2Vucywg
MCApOworCQkJCQkJZmlyc3RUeXBlSW5kZXggPSAxOworCQkJCQl9IGVsc2UgeworCQkJCQkJbmFt
ZSA9IHNldFF1YWxpZmllZE5hbWVOYW1lQW5kU291cmNlUmFuZ2VzKHRva2VucywgcG9zaXRpb25z
LCBmaXJzdFR5cGVJbmRleCAtIDEsIHR5cGVSZWZlcmVuY2UpOworCQkJCQl9CQkJCQkJCisKKwkJ
CQkJb3JnLmVjbGlwc2UuamR0LmludGVybmFsLmNvbXBpbGVyLmxvb2t1cC5UeXBlQmluZGluZyB0
eXBlQmluZGluZyA9IHR5cGVSZWZlcmVuY2UucmVzb2x2ZWRUeXBlOworCQkJCQlib29sZWFuIGNy
ZWF0ZVBhY2thZ2VRdWFsaWZpZWRUeXBlID0gZmFsc2U7CisJCQkJCWlmICh0eXBlQmluZGluZyBp
bnN0YW5jZW9mIFJlZmVyZW5jZUJpbmRpbmcpIHsKKwkJCQkJCVJlZmVyZW5jZUJpbmRpbmcgcmVm
ZXJlbmNlQmluZGluZyA9IChSZWZlcmVuY2VCaW5kaW5nKXR5cGVCaW5kaW5nOwkJCQorCQkJCQkJ
UGFja2FnZUJpbmRpbmcgcGFja2FnZUJpbmRpbmcgPSByZWZlcmVuY2VCaW5kaW5nLmdldFBhY2th
Z2UoKTsKKwkJCQkJCWlmIChwYWNrYWdlQmluZGluZyAhPSBudWxsICYmIEFycmF5cy5lcXVhbHMo
bmFtZS50b1N0cmluZygpLnRvQ2hhckFycmF5KCksIHBhY2thZ2VCaW5kaW5nLnJlYWRhYmxlTmFt
ZSgpKSkgeworCQkJCQkJCWNyZWF0ZVBhY2thZ2VRdWFsaWZpZWRUeXBlID0gdHJ1ZTsKKwkJCQkJ
CX0KIAkJCQkJfQotCQkJCQlpZiAodGhpcy5yZXNvbHZlQmluZGluZ3MpIHsKLQkJCQkJCXJlY29y
ZE5vZGVzKHNpbXBsZU5hbWUsIHR5cGVSZWZlcmVuY2UpOwotCQkJCQkJcmVjb3JkTm9kZXMocXVh
bGlmaWVkVHlwZSwgdHlwZVJlZmVyZW5jZSk7CisJCQkJCQorCQkJCQlpZiAoY3JlYXRlUGFja2Fn
ZVF1YWxpZmllZFR5cGUgJiYgdGhpcy5hc3QuYXBpTGV2ZWwgPj0gQVNULkpMUzgpIHsKKwkJCQkJ
CVBhY2thZ2VRdWFsaWZpZWRUeXBlIHBhY2thZ2VRdWFsaWZpZWRUeXBlID0gbmV3IFBhY2thZ2VR
dWFsaWZpZWRUeXBlKHRoaXMuYXN0KTsKKwkJCQkJCXBhY2thZ2VRdWFsaWZpZWRUeXBlLnNldFF1
YWxpZmllcihuYW1lKTsKKwkJCQkJCXBhY2thZ2VRdWFsaWZpZWRUeXBlLnNldE5hbWUoY3JlYXRl
U2ltcGxlTmFtZSh0eXBlUmVmZXJlbmNlLCBwb3NpdGlvbnMsIHRva2VucywgZmlyc3RUeXBlSW5k
ZXgpKTsKKwkJCQkJCXNldFNvdXJjZUFubm90YXRpb25zQW5kQmluZGluZ3ModHlwZVJlZmVyZW5j
ZSwgcG9zaXRpb25zLCB0eXBlQW5ub3RhdGlvbnMsIGZpcnN0VHlwZUluZGV4LCAwLCBmaXJzdFR5
cGVJbmRleCwgcGFja2FnZVF1YWxpZmllZFR5cGUpOworCQkJCQkJY3VycmVudFR5cGUgPSBwYWNr
YWdlUXVhbGlmaWVkVHlwZTsJCQkJCQkJCQkJCQkJCQkJCQorCQkJCQl9IGVsc2UgeworCQkJCQkJ
U2ltcGxlVHlwZSBzaW1wbGVUeXBlID0gdGhpcy5hc3QubmV3U2ltcGxlVHlwZShuYW1lKTsJCisJ
CQkJCQlzZXRTb3VyY2VBbm5vdGF0aW9uc0FuZEJpbmRpbmdzKHR5cGVSZWZlcmVuY2UsIHBvc2l0
aW9ucywgdHlwZUFubm90YXRpb25zLCAwLCAwLCBuYW1lLmluZGV4ID4gMCA/IG5hbWUuaW5kZXgg
LSAxIDogMCwgc2ltcGxlVHlwZSk7CisJCQkJCQljdXJyZW50VHlwZSA9IGdldFF1YWxpZmllZFR5
cGVXaXRoU291cmNlQW5kQmluZGluZyh0eXBlUmVmZXJlbmNlLCBwb3NpdGlvbnMsICB0eXBlQW5u
b3RhdGlvbnMsIHRva2VucywgZmlyc3RUeXBlSW5kZXgsIHNpbXBsZVR5cGUpOworCQkJCQkJaWYg
KGNyZWF0ZVBhY2thZ2VRdWFsaWZpZWRUeXBlKSAKKwkJCQkJCQljdXJyZW50VHlwZS5zZXRGbGFn
cyhjdXJyZW50VHlwZS5nZXRGbGFncygpIHwgQVNUTm9kZS5NQUxGT1JNRUQpOwogCQkJCQl9Ci0J
CQkJCXN0YXJ0ID0gY3VycmVudFR5cGUuZ2V0U3RhcnRQb3NpdGlvbigpOwotCQkJCQllbmQgPSBz
aW1wbGVOYW1lLmdldFN0YXJ0UG9zaXRpb24oKSArIHNpbXBsZU5hbWUuZ2V0TGVuZ3RoKCkgLSAx
OwotCQkJCQlxdWFsaWZpZWRUeXBlLnNldFNvdXJjZVJhbmdlKHN0YXJ0LCBlbmQgLSBzdGFydCAr
IDEpOwotCQkJCQljdXJyZW50VHlwZSA9IHF1YWxpZmllZFR5cGU7Ci0JCQkJCXF1YWxpZmllZFR5
cGUuaW5kZXggID0gMTsKKwkJCQkJZm9yIChpbnQgaSA9IGZpcnN0VHlwZUluZGV4ICsgMTsgaSA8
IGxlbnRoOyArK2kpIHsKKwkJCQkJCWN1cnJlbnRUeXBlID0gZ2V0UXVhbGlmaWVkVHlwZVdpdGhT
b3VyY2VBbmRCaW5kaW5nKHR5cGVSZWZlcmVuY2UsIHBvc2l0aW9ucywgIHR5cGVBbm5vdGF0aW9u
cywgdG9rZW5zLCBpLCBjdXJyZW50VHlwZSk7CisJCQkJCX0JCQkJCQogCQkJCX0KIAkJCQl0eXBl
ID0gY3VycmVudFR5cGU7CiAJCQl9IGVsc2UgaWYgKHR5cGVSZWZlcmVuY2UgaW5zdGFuY2VvZiBV
bmlvblR5cGVSZWZlcmVuY2UpewpAQCAtMzgwOCw2ICszNzg2LDczIEBACiAJCXJldHVybiB0eXBl
OwogCX0KIAorCXByaXZhdGUgUXVhbGlmaWVkVHlwZSBnZXRRdWFsaWZpZWRUeXBlV2l0aFNvdXJj
ZUFuZEJpbmRpbmcoVHlwZVJlZmVyZW5jZSB0eXBlUmVmZXJlbmNlLCBsb25nW10gcG9zaXRpb25z
LAorCQkJb3JnLmVjbGlwc2UuamR0LmludGVybmFsLmNvbXBpbGVyLmFzdC5Bbm5vdGF0aW9uW11b
XSB0eXBlQW5ub3RhdGlvbnMsIGNoYXJbXVtdIHRva2VucywgaW50IGluZGV4LAorCQkJVHlwZSBx
dWFsaWZpZXIpIHsKKwkJU2ltcGxlTmFtZSBzaW1wbGVOYW1lID0gY3JlYXRlU2ltcGxlTmFtZSh0
eXBlUmVmZXJlbmNlLCBwb3NpdGlvbnMsIHRva2VucywgaW5kZXgpOworCQlRdWFsaWZpZWRUeXBl
IHF1YWxpZmllZFR5cGUgPSBuZXcgUXVhbGlmaWVkVHlwZSh0aGlzLmFzdCk7CisJCXF1YWxpZmll
ZFR5cGUuc2V0UXVhbGlmaWVyKHF1YWxpZmllcik7CisJCXF1YWxpZmllZFR5cGUuc2V0TmFtZShz
aW1wbGVOYW1lKTsKKwkJaW50IHN0YXJ0ID0gcXVhbGlmaWVyLmdldFN0YXJ0UG9zaXRpb24oKTsK
KwkJaW50IGVuZCA9IHNpbXBsZU5hbWUuZ2V0U3RhcnRQb3NpdGlvbigpICsgc2ltcGxlTmFtZS5n
ZXRMZW5ndGgoKSAtIDE7CisJCXNldFNvdXJjZUFubm90YXRpb25zQW5kQmluZGluZ3ModHlwZVJl
ZmVyZW5jZSwgdHlwZUFubm90YXRpb25zLCBpbmRleCwgc3RhcnQsIGVuZCwgcXVhbGlmaWVkVHlw
ZSk7CisJCXJldHVybiBxdWFsaWZpZWRUeXBlOworCX0KKworCXByaXZhdGUgU2ltcGxlVHlwZSBn
ZXRTaW1wbGVUeXBlV2l0aE5hbWVBbmRCaW5kaW5nKE5hbWUgbmFtZSwgVHlwZVJlZmVyZW5jZSB0
eXBlUmVmZXJlbmNlLCBsb25nW10gcG9zaXRpb25zLAorCQkJaW50IHN0YXJ0SW5kZXgsIGludCBl
bmRJbmRleCkgeworCQlTaW1wbGVUeXBlIHNpbXBsZVR5cGUgPSBuZXcgU2ltcGxlVHlwZSh0aGlz
LmFzdCk7CisJCXNpbXBsZVR5cGUuc2V0TmFtZShuYW1lKTsKKwkJaW50IHN0YXJ0ID0gKGludCko
cG9zaXRpb25zW3N0YXJ0SW5kZXhdID4+PiAzMik7CisJCWludCBlbmQgPSAoaW50KXBvc2l0aW9u
c1tlbmRJbmRleF07CisJCXNpbXBsZVR5cGUuc2V0U291cmNlUmFuZ2Uoc3RhcnQsIGVuZCAtIHN0
YXJ0ICsgMSk7CisJCWlmICh0aGlzLnJlc29sdmVCaW5kaW5ncykgeworCQkJcmVjb3JkTm9kZXMo
c2ltcGxlVHlwZSwgdHlwZVJlZmVyZW5jZSk7CisJCX0KKwkJcmV0dXJuIHNpbXBsZVR5cGU7CisJ
fQorCisJcHJpdmF0ZSB2b2lkIHNldFNvdXJjZUFubm90YXRpb25zQW5kQmluZGluZ3MoVHlwZVJl
ZmVyZW5jZSB0eXBlUmVmZXJlbmNlLCAKKwkJCW9yZy5lY2xpcHNlLmpkdC5pbnRlcm5hbC5jb21w
aWxlci5hc3QuQW5ub3RhdGlvbltdW10gdHlwZUFubm90YXRpb25zLCBpbnQgaW5kZXgsIGludCBz
dGFydCwgaW50IGVuZCwKKwkJCUFubm90YXRhYmxlVHlwZSBhbm5vdGF0YWJsZVR5cGUpIHsKKwkJ
b3JnLmVjbGlwc2UuamR0LmludGVybmFsLmNvbXBpbGVyLmFzdC5Bbm5vdGF0aW9uW10gYW5ub3Rh
dGlvbnM7CisJCWludCBhbm5vdGF0aW9uc1N0YXJ0ID0gc3RhcnQ7CisJCWludCBsZW5ndGggPSBl
bmQgLSBzdGFydCArIDE7CisJCWlmICh0eXBlQW5ub3RhdGlvbnMgIT0gbnVsbCAmJiAoYW5ub3Rh
dGlvbnMgPSB0eXBlQW5ub3RhdGlvbnNbaW5kZXhdKSAhPSBudWxsKSB7CisJCQlhbm5vdGF0ZVR5
cGUoYW5ub3RhdGFibGVUeXBlLCBhbm5vdGF0aW9ucyk7CisJCQlpZiAoYW5ub3RhdGlvbnNbMF0g
IT0gbnVsbCAmJiAoYW5ub3RhdGlvbnNTdGFydCA9IGFubm90YXRpb25zWzBdLnNvdXJjZVN0YXJ0
KSA8IHN0YXJ0KSB7CisJCQkJbGVuZ3RoICs9IGFubm90YXRpb25zU3RhcnQgPiAwID8gc3RhcnQg
LSBhbm5vdGF0aW9uc1N0YXJ0IDogMDsKKwkJCQlzdGFydCA9IGFubm90YXRpb25zU3RhcnQ7CisJ
CQl9CisJCX0KKwkJYW5ub3RhdGFibGVUeXBlLnNldFNvdXJjZVJhbmdlKHN0YXJ0LCBsZW5ndGgp
OworCQlpZiAodGhpcy5yZXNvbHZlQmluZGluZ3MpIHsKKwkJCXJlY29yZE5vZGVzKGFubm90YXRh
YmxlVHlwZSwgdHlwZVJlZmVyZW5jZSk7CisJCX0KKwl9CisKKwlwcml2YXRlIHZvaWQgc2V0U291
cmNlQW5ub3RhdGlvbnNBbmRCaW5kaW5ncyhUeXBlUmVmZXJlbmNlIHR5cGVSZWZlcmVuY2UsIGxv
bmdbXSBwb3NpdGlvbnMsCisJCQlvcmcuZWNsaXBzZS5qZHQuaW50ZXJuYWwuY29tcGlsZXIuYXN0
LkFubm90YXRpb25bXVtdIHR5cGVBbm5vdGF0aW9ucywgaW50IGluZGV4LCBpbnQgc3RhcnRJbmRl
eCwgaW50IGVuZEluZGV4LAorCQkJQW5ub3RhdGFibGVUeXBlIGFubm90YXRhYmxlVHlwZSkgewor
CQlpbnQgc3RhcnQgPSAoaW50KSAocG9zaXRpb25zW3N0YXJ0SW5kZXhdID4+PiAzMik7CisJCWlu
dCBlbmQgPSAoaW50KSBwb3NpdGlvbnNbZW5kSW5kZXhdOworCQlzZXRTb3VyY2VBbm5vdGF0aW9u
c0FuZEJpbmRpbmdzKHR5cGVSZWZlcmVuY2UsIHR5cGVBbm5vdGF0aW9ucywgaW5kZXgsIHN0YXJ0
LCBlbmQsIGFubm90YXRhYmxlVHlwZSk7CisJfQorCisJcHJpdmF0ZSBTaW1wbGVOYW1lIGNyZWF0
ZVNpbXBsZU5hbWUoVHlwZVJlZmVyZW5jZSB0eXBlUmVmZXJlbmNlLCBsb25nW10gcG9zaXRpb25z
LCBjaGFyW11bXSB0b2tlbnMsIGludCBpbmRleCkgeworCQlmaW5hbCBTaW1wbGVOYW1lIHNpbXBs
ZU5hbWUgPSBuZXcgU2ltcGxlTmFtZSh0aGlzLmFzdCk7CisJCXNpbXBsZU5hbWUuaW50ZXJuYWxT
ZXRJZGVudGlmaWVyKG5ldyBTdHJpbmcodG9rZW5zW2luZGV4XSkpOworCQlyZWNvcmRQZW5kaW5n
TmFtZVNjb3BlUmVzb2x1dGlvbihzaW1wbGVOYW1lKTsKKwkJaW50IHN0YXJ0ID0gKGludCkgKHBv
c2l0aW9uc1tpbmRleF0gPj4+IDMyKTsKKwkJaW50IGVuZCA9IChpbnQpIHBvc2l0aW9uc1tpbmRl
eF07CisJCXNpbXBsZU5hbWUuc2V0U291cmNlUmFuZ2Uoc3RhcnQsIGVuZCAtIHN0YXJ0ICsgMSk7
CisJCXNpbXBsZU5hbWUuaW5kZXggPSBpbmRleCArIDE7CisJCWlmICh0aGlzLnJlc29sdmVCaW5k
aW5ncykgeworCQkJcmVjb3JkTm9kZXMoc2ltcGxlTmFtZSwgdHlwZVJlZmVyZW5jZSk7CisJCX0K
KwkJcmV0dXJuIHNpbXBsZU5hbWU7CisJfQorCiAJcHJvdGVjdGVkIENvbW1lbnQgY3JlYXRlQ29t
bWVudChpbnRbXSBwb3NpdGlvbnMpIHsKIAkJLy8gQ3JlYXRlIGNvbW1lbnQgbm9kZQogCQlDb21t
ZW50IGNvbW1lbnQgPSBudWxsOwpkaWZmIC0tZ2l0IGEvb3JnLmVjbGlwc2UuamR0LmNvcmUvZG9t
L29yZy9lY2xpcHNlL2pkdC9jb3JlL2RvbS9BU1RNYXRjaGVyLmphdmEgYi9vcmcuZWNsaXBzZS5q
ZHQuY29yZS9kb20vb3JnL2VjbGlwc2UvamR0L2NvcmUvZG9tL0FTVE1hdGNoZXIuamF2YQppbmRl
eCAzYmJjOWE5Li5kNmNkNzViIDEwMDY0NAotLS0gYS9vcmcuZWNsaXBzZS5qZHQuY29yZS9kb20v
b3JnL2VjbGlwc2UvamR0L2NvcmUvZG9tL0FTVE1hdGNoZXIuamF2YQorKysgYi9vcmcuZWNsaXBz
ZS5qZHQuY29yZS9kb20vb3JnL2VjbGlwc2UvamR0L2NvcmUvZG9tL0FTVE1hdGNoZXIuamF2YQpA
QCAtMTU2OSw2ICsxNTY5LDMxIEBACiAJICogQHJldHVybiA8Y29kZT50cnVlPC9jb2RlPiBpZiB0
aGUgc3VidHJlZSBtYXRjaGVzLCBvcgogCSAqICAgPGNvZGU+ZmFsc2U8L2NvZGU+IGlmIHRoZXkg
ZG8gbm90IG1hdGNoIG9yIHRoZSBvdGhlciBvYmplY3QgaGFzIGEKIAkgKiAgIGRpZmZlcmVudCBu
b2RlIHR5cGUgb3IgaXMgPGNvZGU+bnVsbDwvY29kZT4KKwkgKiBAc2luY2UgMy45IEJFVEFfSkFW
QTgKKwkgKi8KKwlwdWJsaWMgYm9vbGVhbiBtYXRjaChQYWNrYWdlUXVhbGlmaWVkVHlwZSBub2Rl
LCBPYmplY3Qgb3RoZXIpIHsKKwkJaWYgKCEob3RoZXIgaW5zdGFuY2VvZiBQYWNrYWdlUXVhbGlm
aWVkVHlwZSkpIHsKKwkJCXJldHVybiBmYWxzZTsKKwkJfQorCQlQYWNrYWdlUXVhbGlmaWVkVHlw
ZSBvID0gKFBhY2thZ2VRdWFsaWZpZWRUeXBlKSBvdGhlcjsKKwkJcmV0dXJuIHNhZmVTdWJ0cmVl
TWF0Y2gobm9kZS5nZXRRdWFsaWZpZXIoKSwgby5nZXRRdWFsaWZpZXIoKSkKKwkJCQkmJiBzYWZl
U3VidHJlZUxpc3RNYXRjaChub2RlLmFubm90YXRpb25zKCksIG8uYW5ub3RhdGlvbnMoKSkKKwkJ
CQkmJiBzYWZlU3VidHJlZU1hdGNoKG5vZGUuZ2V0TmFtZSgpLCBvLmdldE5hbWUoKSk7CisJfQor
CisJLyoqCisJICogUmV0dXJucyB3aGV0aGVyIHRoZSBnaXZlbiBub2RlIGFuZCB0aGUgb3RoZXIg
b2JqZWN0IG1hdGNoLgorCSAqIDxwPgorCSAqIFRoZSBkZWZhdWx0IGltcGxlbWVudGF0aW9uIHBy
b3ZpZGVkIGJ5IHRoaXMgY2xhc3MgdGVzdHMgd2hldGhlciB0aGUKKwkgKiBvdGhlciBvYmplY3Qg
aXMgYSBub2RlIG9mIHRoZSBzYW1lIHR5cGUgd2l0aCBzdHJ1Y3R1cmFsbHkgaXNvbW9ycGhpYwor
CSAqIGNoaWxkIHN1YnRyZWVzLiBTdWJjbGFzc2VzIG1heSBvdmVycmlkZSB0aGlzIG1ldGhvZCBh
cyBuZWVkZWQuCisJICogPC9wPgorCSAqCisJICogQHBhcmFtIG5vZGUgdGhlIG5vZGUKKwkgKiBA
cGFyYW0gb3RoZXIgdGhlIG90aGVyIG9iamVjdCwgb3IgPGNvZGU+bnVsbDwvY29kZT4KKwkgKiBA
cmV0dXJuIDxjb2RlPnRydWU8L2NvZGU+IGlmIHRoZSBzdWJ0cmVlIG1hdGNoZXMsIG9yCisJICog
ICA8Y29kZT5mYWxzZTwvY29kZT4gaWYgdGhleSBkbyBub3QgbWF0Y2ggb3IgdGhlIG90aGVyIG9i
amVjdCBoYXMgYQorCSAqICAgZGlmZmVyZW50IG5vZGUgdHlwZSBvciBpcyA8Y29kZT5udWxsPC9j
b2RlPgogCSAqIEBzaW5jZSAzLjEKIAkgKi8KIAlwdWJsaWMgYm9vbGVhbiBtYXRjaChQYXJhbWV0
ZXJpemVkVHlwZSBub2RlLCBPYmplY3Qgb3RoZXIpIHsKZGlmZiAtLWdpdCBhL29yZy5lY2xpcHNl
LmpkdC5jb3JlL2RvbS9vcmcvZWNsaXBzZS9qZHQvY29yZS9kb20vQVNUTm9kZS5qYXZhIGIvb3Jn
LmVjbGlwc2UuamR0LmNvcmUvZG9tL29yZy9lY2xpcHNlL2pkdC9jb3JlL2RvbS9BU1ROb2RlLmph
dmEKaW5kZXggNTQ4ZmUxMi4uZDFlNmVhOSAxMDA2NDQKLS0tIGEvb3JnLmVjbGlwc2UuamR0LmNv
cmUvZG9tL29yZy9lY2xpcHNlL2pkdC9jb3JlL2RvbS9BU1ROb2RlLmphdmEKKysrIGIvb3JnLmVj
bGlwc2UuamR0LmNvcmUvZG9tL29yZy9lY2xpcHNlL2pkdC9jb3JlL2RvbS9BU1ROb2RlLmphdmEK
QEAgLTg2MCw2ICs4NjAsMTQgQEAKIAlwdWJsaWMgc3RhdGljIGZpbmFsIGludCBJTlRFUlNFQ1RJ
T05fVFlQRSA9IDg3OwogCiAJLyoqCisJICogTm9kZSB0eXBlIGNvbnN0YW50IGluZGljYXRpbmcg
YSBub2RlIG9mIHR5cGUKKwkgKiA8Y29kZT5RdWFsaWZpZWRUeXBlPC9jb2RlPi4KKwkgKiBAc2Vl
IFF1YWxpZmllZFR5cGUKKwkgKiBAc2luY2UgMy45IEJFVEFfSkFWOAorCSAqLworCXB1YmxpYyBz
dGF0aWMgZmluYWwgaW50IFBBQ0tBR0VfUVVBTElGSUVEX1RZUEUgPSA4ODsKKworCS8qKgogCSAq
IFJldHVybnMgdGhlIG5vZGUgY2xhc3MgZm9yIHRoZSBjb3JyZXNwb25kaW5nIG5vZGUgdHlwZS4K
IAkgKgogCSAqIEBwYXJhbSBub2RlVHlwZSBBU1Qgbm9kZSB0eXBlCkBAIC05NzksNiArOTg3LDgg
QEAKIAkJCQlyZXR1cm4gTnVtYmVyTGl0ZXJhbC5jbGFzczsKIAkJCWNhc2UgUEFDS0FHRV9ERUNM
QVJBVElPTiA6CiAJCQkJcmV0dXJuIFBhY2thZ2VEZWNsYXJhdGlvbi5jbGFzczsKKwkJCWNhc2Ug
UEFDS0FHRV9RVUFMSUZJRURfVFlQRSA6CisJCQkJcmV0dXJuIFBhY2thZ2VRdWFsaWZpZWRUeXBl
LmNsYXNzOwogCQkJY2FzZSBQQVJBTUVURVJJWkVEX1RZUEUgOgogCQkJCXJldHVybiBQYXJhbWV0
ZXJpemVkVHlwZS5jbGFzczsKIAkJCWNhc2UgUEFSRU5USEVTSVpFRF9FWFBSRVNTSU9OIDoKZGlm
ZiAtLWdpdCBhL29yZy5lY2xpcHNlLmpkdC5jb3JlL2RvbS9vcmcvZWNsaXBzZS9qZHQvY29yZS9k
b20vQVNUVmlzaXRvci5qYXZhIGIvb3JnLmVjbGlwc2UuamR0LmNvcmUvZG9tL29yZy9lY2xpcHNl
L2pkdC9jb3JlL2RvbS9BU1RWaXNpdG9yLmphdmEKaW5kZXggMDBjODBmYy4uNWY3N2NlOSAxMDA2
NDQKLS0tIGEvb3JnLmVjbGlwc2UuamR0LmNvcmUvZG9tL29yZy9lY2xpcHNlL2pkdC9jb3JlL2Rv
bS9BU1RWaXNpdG9yLmphdmEKKysrIGIvb3JnLmVjbGlwc2UuamR0LmNvcmUvZG9tL29yZy9lY2xp
cHNlL2pkdC9jb3JlL2RvbS9BU1RWaXNpdG9yLmphdmEKQEAgLTEwNzIsNiArMTA3MiwyMyBAQAog
CSAqIEByZXR1cm4gPGNvZGU+dHJ1ZTwvY29kZT4gaWYgdGhlIGNoaWxkcmVuIG9mIHRoaXMgbm9k
ZSBzaG91bGQgYmUKIAkgKiB2aXNpdGVkLCBhbmQgPGNvZGU+ZmFsc2U8L2NvZGU+IGlmIHRoZSBj
aGlsZHJlbiBvZiB0aGlzIG5vZGUgc2hvdWxkCiAJICogYmUgc2tpcHBlZAorCSAqIEBzaW5jZSAz
LjkgQkVUQV9KQVZBOAorCSAqLworCXB1YmxpYyBib29sZWFuIHZpc2l0KFBhY2thZ2VRdWFsaWZp
ZWRUeXBlIG5vZGUpIHsKKwkJcmV0dXJuIHRydWU7CisJfQorCisJLyoqCisJICogVmlzaXRzIHRo
ZSBnaXZlbiB0eXBlLXNwZWNpZmljIEFTVCBub2RlLgorCSAqIDxwPgorCSAqIFRoZSBkZWZhdWx0
IGltcGxlbWVudGF0aW9uIGRvZXMgbm90aGluZyBhbmQgcmV0dXJuIHRydWUuCisJICogU3ViY2xh
c3NlcyBtYXkgcmVpbXBsZW1lbnQuCisJICogPC9wPgorCSAqCisJICogQHBhcmFtIG5vZGUgdGhl
IG5vZGUgdG8gdmlzaXQKKwkgKiBAcmV0dXJuIDxjb2RlPnRydWU8L2NvZGU+IGlmIHRoZSBjaGls
ZHJlbiBvZiB0aGlzIG5vZGUgc2hvdWxkIGJlCisJICogdmlzaXRlZCwgYW5kIDxjb2RlPmZhbHNl
PC9jb2RlPiBpZiB0aGUgY2hpbGRyZW4gb2YgdGhpcyBub2RlIHNob3VsZAorCSAqIGJlIHNraXBw
ZWQKIAkgKiBAc2luY2UgMy4xCiAJICovCiAJcHVibGljIGJvb2xlYW4gdmlzaXQoUGFyYW1ldGVy
aXplZFR5cGUgbm9kZSkgewpAQCAtMjI5MSw2ICsyMzA4LDE5IEBACiAJICogPC9wPgogCSAqCiAJ
ICogQHBhcmFtIG5vZGUgdGhlIG5vZGUgdG8gdmlzaXQKKwkgKiBAc2luY2UgMy45IEJFVEFfSkFW
QTgKKwkgKi8KKwlwdWJsaWMgdm9pZCBlbmRWaXNpdChQYWNrYWdlUXVhbGlmaWVkVHlwZSBub2Rl
KSB7CisJCS8vIGRlZmF1bHQgaW1wbGVtZW50YXRpb246IGRvIG5vdGhpbmcKKwl9CisKKwkvKioK
KwkgKiBFbmQgb2YgdmlzaXQgdGhlIGdpdmVuIHR5cGUtc3BlY2lmaWMgQVNUIG5vZGUuCisJICog
PHA+CisJICogVGhlIGRlZmF1bHQgaW1wbGVtZW50YXRpb24gZG9lcyBub3RoaW5nLiBTdWJjbGFz
c2VzIG1heSByZWltcGxlbWVudC4KKwkgKiA8L3A+CisJICoKKwkgKiBAcGFyYW0gbm9kZSB0aGUg
bm9kZSB0byB2aXNpdAogCSAqIEBzaW5jZSAzLjEKIAkgKi8KIAlwdWJsaWMgdm9pZCBlbmRWaXNp
dChQYXJhbWV0ZXJpemVkVHlwZSBub2RlKSB7CmRpZmYgLS1naXQgYS9vcmcuZWNsaXBzZS5qZHQu
Y29yZS9kb20vb3JnL2VjbGlwc2UvamR0L2NvcmUvZG9tL0RlZmF1bHRBU1RWaXNpdG9yLmphdmEg
Yi9vcmcuZWNsaXBzZS5qZHQuY29yZS9kb20vb3JnL2VjbGlwc2UvamR0L2NvcmUvZG9tL0RlZmF1
bHRBU1RWaXNpdG9yLmphdmEKaW5kZXggOGRkZmYzYS4uZmViYTY5MyAxMDA2NDQKLS0tIGEvb3Jn
LmVjbGlwc2UuamR0LmNvcmUvZG9tL29yZy9lY2xpcHNlL2pkdC9jb3JlL2RvbS9EZWZhdWx0QVNU
VmlzaXRvci5qYXZhCisrKyBiL29yZy5lY2xpcHNlLmpkdC5jb3JlL2RvbS9vcmcvZWNsaXBzZS9q
ZHQvY29yZS9kb20vRGVmYXVsdEFTVFZpc2l0b3IuamF2YQpAQCAtMTg4LDYgKzE4OCw5IEBACiAJ
cHVibGljIHZvaWQgZW5kVmlzaXQoUGFja2FnZURlY2xhcmF0aW9uIG5vZGUpIHsKIAkJZW5kVmlz
aXROb2RlKG5vZGUpOwogCX0KKwlwdWJsaWMgdm9pZCBlbmRWaXNpdChQYWNrYWdlUXVhbGlmaWVk
VHlwZSBub2RlKSB7CisJCWVuZFZpc2l0Tm9kZShub2RlKTsKKwl9CiAJcHVibGljIHZvaWQgZW5k
VmlzaXQoUGFyYW1ldGVyaXplZFR5cGUgbm9kZSkgewogCQllbmRWaXNpdE5vZGUobm9kZSk7CiAJ
fQpAQCAtNDYwLDYgKzQ2Myw5IEBACiAJcHVibGljIGJvb2xlYW4gdmlzaXQoUGFja2FnZURlY2xh
cmF0aW9uIG5vZGUpIHsKIAkJcmV0dXJuIHZpc2l0Tm9kZShub2RlKTsKIAl9CisJcHVibGljIGJv
b2xlYW4gdmlzaXQoUGFja2FnZVF1YWxpZmllZFR5cGUgbm9kZSkgeworCQlyZXR1cm4gdmlzaXRO
b2RlKG5vZGUpOworCX0KIAlwdWJsaWMgYm9vbGVhbiB2aXNpdChQYXJhbWV0ZXJpemVkVHlwZSBu
b2RlKSB7CiAJCXJldHVybiB2aXNpdE5vZGUobm9kZSk7CiAJfQpkaWZmIC0tZ2l0IGEvb3JnLmVj
bGlwc2UuamR0LmNvcmUvZG9tL29yZy9lY2xpcHNlL2pkdC9jb3JlL2RvbS9QYWNrYWdlUXVhbGlm
aWVkVHlwZS5qYXZhIGIvb3JnLmVjbGlwc2UuamR0LmNvcmUvZG9tL29yZy9lY2xpcHNlL2pkdC9j
b3JlL2RvbS9QYWNrYWdlUXVhbGlmaWVkVHlwZS5qYXZhCm5ldyBmaWxlIG1vZGUgMTAwNjQ0Cmlu
ZGV4IDAwMDAwMDAuLjE3MzA1M2QKLS0tIC9kZXYvbnVsbAorKysgYi9vcmcuZWNsaXBzZS5qZHQu
Y29yZS9kb20vb3JnL2VjbGlwc2UvamR0L2NvcmUvZG9tL1BhY2thZ2VRdWFsaWZpZWRUeXBlLmph
dmEKQEAgLTAsMCArMSwyODUgQEAKKy8qKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioq
KioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqCisgKiBDb3B5cmln
aHQgKGMpIDIwMDMsIDIwMTMgSUJNIENvcnBvcmF0aW9uIGFuZCBvdGhlcnMuCisgKiBBbGwgcmln
aHRzIHJlc2VydmVkLiBUaGlzIHByb2dyYW0gYW5kIHRoZSBhY2NvbXBhbnlpbmcgbWF0ZXJpYWxz
CisgKiBhcmUgbWFkZSBhdmFpbGFibGUgdW5kZXIgdGhlIHRlcm1zIG9mIHRoZSBFY2xpcHNlIFB1
YmxpYyBMaWNlbnNlIHYxLjAKKyAqIHdoaWNoIGFjY29tcGFuaWVzIHRoaXMgZGlzdHJpYnV0aW9u
LCBhbmQgaXMgYXZhaWxhYmxlIGF0CisgKiBodHRwOi8vd3d3LmVjbGlwc2Uub3JnL2xlZ2FsL2Vw
bC12MTAuaHRtbAorICoKKyAqIFRoaXMgaXMgYW4gaW1wbGVtZW50YXRpb24gb2YgYW4gZWFybHkt
ZHJhZnQgc3BlY2lmaWNhdGlvbiBkZXZlbG9wZWQgdW5kZXIgdGhlIEphdmEKKyAqIENvbW11bml0
eSBQcm9jZXNzIChKQ1ApIGFuZCBpcyBtYWRlIGF2YWlsYWJsZSBmb3IgdGVzdGluZyBhbmQgZXZh
bHVhdGlvbiBwdXJwb3NlcworICogb25seS4gVGhlIGNvZGUgaXMgbm90IGNvbXBhdGlibGUgd2l0
aCBhbnkgc3BlY2lmaWNhdGlvbiBvZiB0aGUgSkNQLgorICogCisgKiBDb250cmlidXRvcnM6Cisg
KiAgICAgSUJNIENvcnBvcmF0aW9uIC0gaW5pdGlhbCBBUEkgYW5kIGltcGxlbWVudGF0aW9uCisg
KioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioq
KioqKioqKioqKioqKioqKioqKioqKi8KKworcGFja2FnZSBvcmcuZWNsaXBzZS5qZHQuY29yZS5k
b207CisKK2ltcG9ydCBqYXZhLnV0aWwuQXJyYXlMaXN0OworaW1wb3J0IGphdmEudXRpbC5MaXN0
OworCisvKioKKyAqIE5vZGUgZm9yIGEgcGFja2FnZSBxdWFsaWZpZWQgdHlwZSAoYWRkZWQgaW4g
SkxTOCBBUEkpLgorICogCisgKiA8cHJlPgorICogUGFja2FnZVF1YWxpZmllZFR5cGU6CisgKiAg
ICBOYW1lIDxiPi48L2I+IHsgQW5ub3RhdGlvbiB9IFNpbXBsZU5hbWUKKyAqIDwvcHJlPgorICoK
KyAqIEBzaW5jZSAzLjkgQkVUQV9KQVZBOAorICogQG5vaW5zdGFudGlhdGUgVGhpcyBjbGFzcyBp
cyBub3QgaW50ZW5kZWQgdG8gYmUgaW5zdGFudGlhdGVkIGJ5IGNsaWVudHMuCisgKi8KK3B1Ymxp
YyBjbGFzcyBQYWNrYWdlUXVhbGlmaWVkVHlwZSBleHRlbmRzIEFubm90YXRhYmxlVHlwZSB7CisK
KwkvKioKKwkgKiBUaGUgInF1YWxpZmllciIgc3RydWN0dXJhbCBwcm9wZXJ0eSBvZiB0aGlzIG5v
ZGUgdHlwZSAoY2hpbGQgdHlwZToge0BsaW5rIE5hbWV9KS4KKwkgKi8KKwlwdWJsaWMgc3RhdGlj
IGZpbmFsIENoaWxkUHJvcGVydHlEZXNjcmlwdG9yIFFVQUxJRklFUl9QUk9QRVJUWSA9CisJCW5l
dyBDaGlsZFByb3BlcnR5RGVzY3JpcHRvcihQYWNrYWdlUXVhbGlmaWVkVHlwZS5jbGFzcywgInF1
YWxpZmllciIsIE5hbWUuY2xhc3MsIE1BTkRBVE9SWSwgTk9fQ1lDTEVfUklTSyk7IC8vJE5PTi1O
TFMtMSQKKworCS8qKgorCSAqIFRoZSAiYW5ub3RhdGlvbnMiIHN0cnVjdHVyYWwgcHJvcGVydHkg
b2YgdGhpcyBub2RlIHR5cGUgKGVsZW1lbnQgdHlwZToge0BsaW5rIEFubm90YXRpb259KS4KKwkg
Ki8KKwlwdWJsaWMgc3RhdGljIGZpbmFsIENoaWxkTGlzdFByb3BlcnR5RGVzY3JpcHRvciBBTk5P
VEFUSU9OU19QUk9QRVJUWSA9CisJCQlpbnRlcm5hbEFubm90YXRpb25zUHJvcGVydHlGYWN0b3J5
KFBhY2thZ2VRdWFsaWZpZWRUeXBlLmNsYXNzKTsKKwkKKwkvKioKKwkgKiBUaGUgIm5hbWUiIHN0
cnVjdHVyYWwgcHJvcGVydHkgb2YgdGhpcyBub2RlIHR5cGUgKGNoaWxkIHR5cGU6IHtAbGluayBT
aW1wbGVOYW1lfSkuCisJICovCisJcHVibGljIHN0YXRpYyBmaW5hbCBDaGlsZFByb3BlcnR5RGVz
Y3JpcHRvciBOQU1FX1BST1BFUlRZID0KKwkJbmV3IENoaWxkUHJvcGVydHlEZXNjcmlwdG9yKFBh
Y2thZ2VRdWFsaWZpZWRUeXBlLmNsYXNzLCAibmFtZSIsIFNpbXBsZU5hbWUuY2xhc3MsIE1BTkRB
VE9SWSwgTk9fQ1lDTEVfUklTSyk7IC8vJE5PTi1OTFMtMSQKKwkKKwkvKioKKwkgKiBBIGxpc3Qg
b2YgcHJvcGVydHkgZGVzY3JpcHRvcnMgKGVsZW1lbnQgdHlwZToKKwkgKiB7QGxpbmsgU3RydWN0
dXJhbFByb3BlcnR5RGVzY3JpcHRvcn0pLAorCSAqIG9yIG51bGwgaWYgdW5pbml0aWFsaXplZC4K
KwkgKi8KKwlwcml2YXRlIHN0YXRpYyBmaW5hbCBMaXN0IFBST1BFUlRZX0RFU0NSSVBUT1JTOwor
CisJc3RhdGljIHsKKwkJTGlzdCBwcm9wZXJ0eUxpc3QgPSBuZXcgQXJyYXlMaXN0KDQpOworCQlj
cmVhdGVQcm9wZXJ0eUxpc3QoUGFja2FnZVF1YWxpZmllZFR5cGUuY2xhc3MsIHByb3BlcnR5TGlz
dCk7CisJCWFkZFByb3BlcnR5KFFVQUxJRklFUl9QUk9QRVJUWSwgcHJvcGVydHlMaXN0KTsKKwkJ
YWRkUHJvcGVydHkoQU5OT1RBVElPTlNfUFJPUEVSVFksIHByb3BlcnR5TGlzdCk7CisJCWFkZFBy
b3BlcnR5KE5BTUVfUFJPUEVSVFksIHByb3BlcnR5TGlzdCk7CisJCVBST1BFUlRZX0RFU0NSSVBU
T1JTID0gcmVhcFByb3BlcnR5TGlzdChwcm9wZXJ0eUxpc3QpOworCX0KKworCS8qKgorCSAqIFJl
dHVybnMgYSBsaXN0IG9mIHN0cnVjdHVyYWwgcHJvcGVydHkgZGVzY3JpcHRvcnMgZm9yIHRoaXMg
bm9kZSB0eXBlLgorCSAqIENsaWVudHMgbXVzdCBub3QgbW9kaWZ5IHRoZSByZXN1bHQuCisJICoK
KwkgKiBAcGFyYW0gYXBpTGV2ZWwgdGhlIEFQSSBsZXZlbDsgb25lIG9mIHRoZQorCSAqIDxjb2Rl
PkFTVC5KTFMqPC9jb2RlPiBjb25zdGFudHMKKwkgKiBAcmV0dXJuIGEgbGlzdCBvZiBwcm9wZXJ0
eSBkZXNjcmlwdG9ycyAoZWxlbWVudCB0eXBlOgorCSAqIHtAbGluayBTdHJ1Y3R1cmFsUHJvcGVy
dHlEZXNjcmlwdG9yfSkKKwkgKi8KKwlwdWJsaWMgc3RhdGljIExpc3QgcHJvcGVydHlEZXNjcmlw
dG9ycyhpbnQgYXBpTGV2ZWwpIHsKKwkJcmV0dXJuIFBST1BFUlRZX0RFU0NSSVBUT1JTOworCX0K
KworCS8qKgorCSAqIFRoZSBxdWFsaWZpZXIgbm9kZTsgbGF6aWx5IGluaXRpYWxpemVkOyBkZWZh
dWx0cyB0byAKKwkgKiBhbiB1bnNwZWNpZmllZCwgYnV0IGxlZ2FsLCBzaW1wbGUgbmFtZS4KKwkg
Ki8KKwlwcml2YXRlIE5hbWUgcXVhbGlmaWVyID0gbnVsbDsKKworCS8qKgorCSAqIFRoZSBuYW1l
IGJlaW5nIHF1YWxpZmllZDsgbGF6aWx5IGluaXRpYWxpemVkOyBkZWZhdWx0cyB0byBhIHVuc3Bl
Y2lmaWVkLAorCSAqIGxlZ2FsIEphdmEgaWRlbnRpZmllci4KKwkgKi8KKwlwcml2YXRlIFNpbXBs
ZU5hbWUgbmFtZSA9IG51bGw7CisKKwkvKioKKwkgKiBDcmVhdGVzIGEgbmV3IHVucGFyZW50ZWQg
bm9kZSBmb3IgYSBwYWNrYWdlIHF1YWxpZmllZCB0eXBlIG93bmVkIGJ5IHRoZQorCSAqIGdpdmVu
IEFTVC4gQnkgZGVmYXVsdCwgYW4gdW5zcGVjaWZpZWQsIGJ1dCBsZWdhbCwgcXVhbGlmaWVyIGFu
ZCBuYW1lLgorCSAqIDxwPgorCSAqIE4uQi4gVGhpcyBjb25zdHJ1Y3RvciBpcyBwYWNrYWdlLXBy
aXZhdGUuCisJICogPC9wPgorCSAqCisJICogQHBhcmFtIGFzdCB0aGUgQVNUIHRoYXQgaXMgdG8g
b3duIHRoaXMgbm9kZQorCSAqLworCVBhY2thZ2VRdWFsaWZpZWRUeXBlKEFTVCBhc3QpIHsKKwkJ
c3VwZXIoYXN0KTsKKwkgICAgdW5zdXBwb3J0ZWRJbjJfM180KCk7CisJfQorCisJLyogKG9taXQg
amF2YWRvYyBmb3IgdGhpcyBtZXRob2QpCisJICogTWV0aG9kIGRlY2xhcmVkIG9uIEFubm90YXRh
YmxlVHlwZS4KKwkgKi8KKwlDaGlsZExpc3RQcm9wZXJ0eURlc2NyaXB0b3IgaW50ZXJuYWxBbm5v
dGF0aW9uc1Byb3BlcnR5KCkgeworCQlyZXR1cm4gQU5OT1RBVElPTlNfUFJPUEVSVFk7CisJfQor
CisJLyogKG9taXQgamF2YWRvYyBmb3IgdGhpcyBtZXRob2QpCisJICogTWV0aG9kIGRlY2xhcmVk
IG9uIEFTVE5vZGUuCisJICovCisJTGlzdCBpbnRlcm5hbFN0cnVjdHVyYWxQcm9wZXJ0aWVzRm9y
VHlwZShpbnQgYXBpTGV2ZWwpIHsKKwkJcmV0dXJuIHByb3BlcnR5RGVzY3JpcHRvcnMoYXBpTGV2
ZWwpOworCX0KKworCS8qIChvbWl0IGphdmFkb2MgZm9yIHRoaXMgbWV0aG9kKQorCSAqIE1ldGhv
ZCBkZWNsYXJlZCBvbiBBU1ROb2RlLgorCSAqLworCWZpbmFsIExpc3QgaW50ZXJuYWxHZXRDaGls
ZExpc3RQcm9wZXJ0eShDaGlsZExpc3RQcm9wZXJ0eURlc2NyaXB0b3IgcHJvcGVydHkpIHsKKwkJ
aWYgKHByb3BlcnR5ID09IEFOTk9UQVRJT05TX1BST1BFUlRZKSB7CisJCQlyZXR1cm4gYW5ub3Rh
dGlvbnMoKTsKKwkJfQorCQkvLyBhbGxvdyBkZWZhdWx0IGltcGxlbWVudGF0aW9uIHRvIGZsYWcg
dGhlIGVycm9yCisJCXJldHVybiBzdXBlci5pbnRlcm5hbEdldENoaWxkTGlzdFByb3BlcnR5KHBy
b3BlcnR5KTsKKwl9CisJCisJLyogKG9taXQgamF2YWRvYyBmb3IgdGhpcyBtZXRob2QpCisJICog
TWV0aG9kIGRlY2xhcmVkIG9uIEFTVE5vZGUuCisJICovCisJZmluYWwgQVNUTm9kZSBpbnRlcm5h
bEdldFNldENoaWxkUHJvcGVydHkoQ2hpbGRQcm9wZXJ0eURlc2NyaXB0b3IgcHJvcGVydHksIGJv
b2xlYW4gZ2V0LCBBU1ROb2RlIGNoaWxkKSB7CisJCWlmIChwcm9wZXJ0eSA9PSBRVUFMSUZJRVJf
UFJPUEVSVFkpIHsKKwkJCWlmIChnZXQpIHsKKwkJCQlyZXR1cm4gZ2V0UXVhbGlmaWVyKCk7CisJ
CQl9IGVsc2UgeworCQkJCXNldFF1YWxpZmllcigoTmFtZSkgY2hpbGQpOworCQkJCXJldHVybiBu
dWxsOworCQkJfQorCQl9CisJCWlmIChwcm9wZXJ0eSA9PSBOQU1FX1BST1BFUlRZKSB7CisJCQlp
ZiAoZ2V0KSB7CisJCQkJcmV0dXJuIGdldE5hbWUoKTsKKwkJCX0gZWxzZSB7CisJCQkJc2V0TmFt
ZSgoU2ltcGxlTmFtZSkgY2hpbGQpOworCQkJCXJldHVybiBudWxsOworCQkJfQorCQl9CisJCS8v
IGFsbG93IGRlZmF1bHQgaW1wbGVtZW50YXRpb24gdG8gZmxhZyB0aGUgZXJyb3IKKwkJcmV0dXJu
IHN1cGVyLmludGVybmFsR2V0U2V0Q2hpbGRQcm9wZXJ0eShwcm9wZXJ0eSwgZ2V0LCBjaGlsZCk7
CisJfQorCisJaW50IGdldE5vZGVUeXBlMCgpIHsKKwkJcmV0dXJuIFBBQ0tBR0VfUVVBTElGSUVE
X1RZUEU7CisJfQorCisJYm9vbGVhbiBzdWJ0cmVlTWF0Y2gwKEFTVE1hdGNoZXIgbWF0Y2hlciwg
T2JqZWN0IG90aGVyKSB7CisJCS8vIGRpc3BhdGNoIHRvIGNvcnJlY3Qgb3ZlcmxvYWRlZCBtYXRj
aCBtZXRob2QKKwkJcmV0dXJuIG1hdGNoZXIubWF0Y2godGhpcywgb3RoZXIpOworCX0KKworCUFT
VE5vZGUgY2xvbmUwKEFTVCB0YXJnZXQpIHsKKwkJUGFja2FnZVF1YWxpZmllZFR5cGUgcmVzdWx0
ID0gbmV3IFBhY2thZ2VRdWFsaWZpZWRUeXBlKHRhcmdldCk7CisJCXJlc3VsdC5zZXRTb3VyY2VS
YW5nZShnZXRTdGFydFBvc2l0aW9uKCksIGdldExlbmd0aCgpKTsKKwkJcmVzdWx0LnNldFF1YWxp
ZmllcigoTmFtZSkgKChBU1ROb2RlKSBnZXRRdWFsaWZpZXIoKSkuY2xvbmUodGFyZ2V0KSk7CisJ
CXJlc3VsdC5hbm5vdGF0aW9ucygpLmFkZEFsbChBU1ROb2RlLmNvcHlTdWJ0cmVlcyh0YXJnZXQs
IGFubm90YXRpb25zKCkpKTsKKwkJcmVzdWx0LnNldE5hbWUoKFNpbXBsZU5hbWUpICgoQVNUTm9k
ZSkgZ2V0TmFtZSgpKS5jbG9uZSh0YXJnZXQpKTsKKwkJcmV0dXJuIHJlc3VsdDsKKwl9CisKKwkv
KiAob21pdCBqYXZhZG9jIGZvciB0aGlzIG1ldGhvZCkKKwkgKiBNZXRob2QgZGVjbGFyZWQgb24g
QVNUTm9kZS4KKwkgKi8KKwl2b2lkIGFjY2VwdDAoQVNUVmlzaXRvciB2aXNpdG9yKSB7CisJCWJv
b2xlYW4gdmlzaXRDaGlsZHJlbiA9IHZpc2l0b3IudmlzaXQodGhpcyk7CisJCWlmICh2aXNpdENo
aWxkcmVuKSB7CisJCQkvLyB2aXNpdCBjaGlsZHJlbiBpbiBub3JtYWwgbGVmdCB0byByaWdodCBy
ZWFkaW5nIG9yZGVyCisJCQlhY2NlcHRDaGlsZCh2aXNpdG9yLCBnZXRRdWFsaWZpZXIoKSk7CisJ
CQlhY2NlcHRDaGlsZHJlbih2aXNpdG9yLCB0aGlzLmFubm90YXRpb25zKTsKKwkJCWFjY2VwdENo
aWxkKHZpc2l0b3IsIGdldE5hbWUoKSk7CisJCX0KKwkJdmlzaXRvci5lbmRWaXNpdCh0aGlzKTsK
Kwl9CisKKwkvKioKKwkgKiBSZXR1cm5zIHRoZSBxdWFsaWZpZXIgb2YgdGhpcyBwYWNrYWdlIHF1
YWxpZmllZCB0eXBlLgorCSAqCisJICogQHJldHVybiB0aGUgcXVhbGlmaWVyIG9mIHRoaXMgcGFj
a2FnZSBxdWFsaWZpZWQgdHlwZQorCSAqLworCXB1YmxpYyBOYW1lIGdldFF1YWxpZmllcigpIHsK
KwkJaWYgKHRoaXMucXVhbGlmaWVyID09IG51bGwpIHsKKwkJCS8vIGxhenkgaW5pdCBtdXN0IGJl
IHRocmVhZC1zYWZlIGZvciByZWFkZXJzCisJCQlzeW5jaHJvbml6ZWQgKHRoaXMpIHsKKwkJCQlp
ZiAodGhpcy5xdWFsaWZpZXIgPT0gbnVsbCkgeworCQkJCQlwcmVMYXp5SW5pdCgpOworCQkJCQl0
aGlzLnF1YWxpZmllciA9IG5ldyBTaW1wbGVOYW1lKHRoaXMuYXN0KTsKKwkJCQkJcG9zdExhenlJ
bml0KHRoaXMucXVhbGlmaWVyLCBRVUFMSUZJRVJfUFJPUEVSVFkpOworCQkJCX0KKwkJCX0KKwkJ
fQorCQlyZXR1cm4gdGhpcy5xdWFsaWZpZXI7CisJfQorCisJLyoqCisJICogU2V0cyB0aGUgcXVh
bGlmaWVyIG9mIHRoaXMgcGFja2FnZSBxdWFsaWZpZWQgdHlwZSB0byB0aGUgZ2l2ZW4gbmFtZS4K
KwkgKgorCSAqIEBwYXJhbSBuYW1lIHRoZSBuZXcgcXVhbGlmaWVyIG9mIHRoaXMgcGFja2FnZSBx
dWFsaWZpZWQgdHlwZQorCSAqIEBleGNlcHRpb24gSWxsZWdhbEFyZ3VtZW50RXhjZXB0aW9uIGlm
OgorCSAqIDx1bD4KKwkgKiA8bGk+dGhlIG5vZGUgYmVsb25ncyB0byBhIGRpZmZlcmVudCBBU1Q8
L2xpPgorCSAqIDxsaT50aGUgbm9kZSBhbHJlYWR5IGhhcyBhIHBhcmVudDwvbGk+CisJICogPC91
bD4KKwkgKi8KKwlwdWJsaWMgdm9pZCBzZXRRdWFsaWZpZXIoTmFtZSBuYW1lKSB7CisJCWlmIChu
YW1lID09IG51bGwpIHsKKwkJCXRocm93IG5ldyBJbGxlZ2FsQXJndW1lbnRFeGNlcHRpb24oKTsK
KwkJfQorCQlBU1ROb2RlIG9sZENoaWxkID0gdGhpcy5xdWFsaWZpZXI7CisJCXByZVJlcGxhY2VD
aGlsZChvbGRDaGlsZCwgbmFtZSwgUVVBTElGSUVSX1BST1BFUlRZKTsKKwkJdGhpcy5xdWFsaWZp
ZXIgPSBuYW1lOworCQlwb3N0UmVwbGFjZUNoaWxkKG9sZENoaWxkLCBuYW1lLCBRVUFMSUZJRVJf
UFJPUEVSVFkpOworCX0KKworCS8qKgorCSAqIFJldHVybnMgdGhlIG5hbWUgcGFydCBvZiB0aGlz
IHBhY2thZ2UgcXVhbGlmaWVkIHR5cGUuCisJICoKKwkgKiBAcmV0dXJuIHRoZSBuYW1lIGJlaW5n
IHF1YWxpZmllZAorCSAqLworCXB1YmxpYyBTaW1wbGVOYW1lIGdldE5hbWUoKSB7CisJCWlmICh0
aGlzLm5hbWUgPT0gbnVsbCkgeworCQkJLy8gbGF6eSBpbml0IG11c3QgYmUgdGhyZWFkLXNhZmUg
Zm9yIHJlYWRlcnMKKwkJCXN5bmNocm9uaXplZCAodGhpcykgeworCQkJCWlmICh0aGlzLm5hbWUg
PT0gbnVsbCkgeworCQkJCQlwcmVMYXp5SW5pdCgpOworCQkJCQl0aGlzLm5hbWUgPSBuZXcgU2lt
cGxlTmFtZSh0aGlzLmFzdCk7CisJCQkJCXBvc3RMYXp5SW5pdCh0aGlzLm5hbWUsIE5BTUVfUFJP
UEVSVFkpOworCQkJCX0KKwkJCX0KKwkJfQorCQlyZXR1cm4gdGhpcy5uYW1lOworCX0KKworCS8q
KgorCSAqIFNldHMgdGhlIG5hbWUgcGFydCBvZiB0aGlzIHBhY2thZ2UgcXVhbGlmaWVkIHR5cGUg
dG8gdGhlIGdpdmVuIHNpbXBsZSBuYW1lLgorCSAqCisJICogQHBhcmFtIG5hbWUgdGhlIGlkZW50
aWZpZXIgb2YgdGhpcyBxdWFsaWZpZWQgbmFtZQorCSAqIEBleGNlcHRpb24gSWxsZWdhbEFyZ3Vt
ZW50RXhjZXB0aW9uIGlmOgorCSAqIDx1bD4KKwkgKiA8bGk+dGhlIG5vZGUgYmVsb25ncyB0byBh
IGRpZmZlcmVudCBBU1Q8L2xpPgorCSAqIDxsaT50aGUgbm9kZSBhbHJlYWR5IGhhcyBhIHBhcmVu
dDwvbGk+CisJICogPC91bD4KKwkgKi8KKwlwdWJsaWMgdm9pZCBzZXROYW1lKFNpbXBsZU5hbWUg
bmFtZSkgeworCQlpZiAobmFtZSA9PSBudWxsKSB7CisJCQl0aHJvdyBuZXcgSWxsZWdhbEFyZ3Vt
ZW50RXhjZXB0aW9uKCk7CisJCX0KKwkJQVNUTm9kZSBvbGRDaGlsZCA9IHRoaXMubmFtZTsKKwkJ
cHJlUmVwbGFjZUNoaWxkKG9sZENoaWxkLCBuYW1lLCBOQU1FX1BST1BFUlRZKTsKKwkJdGhpcy5u
YW1lID0gbmFtZTsKKwkJcG9zdFJlcGxhY2VDaGlsZChvbGRDaGlsZCwgbmFtZSwgTkFNRV9QUk9Q
RVJUWSk7CisJfQorCisJLyogKG9taXQgamF2YWRvYyBmb3IgdGhpcyBtZXRob2QpCisJICogTWV0
aG9kIGRlY2xhcmVkIG9uIEFTVE5vZGUuCisJICovCisJaW50IG1lbVNpemUoKSB7CisJCS8vIHRy
ZWF0IENvZGUgYXMgZnJlZQorCQlyZXR1cm4gQkFTRV9OT0RFX1NJWkUgKyAyICogNDsKKwl9CisK
KwkvKiAob21pdCBqYXZhZG9jIGZvciB0aGlzIG1ldGhvZCkKKwkgKiBNZXRob2QgZGVjbGFyZWQg
b24gQVNUTm9kZS4KKwkgKi8KKwlpbnQgdHJlZVNpemUoKSB7CisJCXJldHVybgorCQkJbWVtU2l6
ZSgpCisJCQkrICh0aGlzLnF1YWxpZmllciA9PSBudWxsID8gMCA6IGdldFF1YWxpZmllcigpLnRy
ZWVTaXplKCkpCisJCQkrICh0aGlzLmFubm90YXRpb25zID09IG51bGwgPyAwIDogdGhpcy5hbm5v
dGF0aW9ucy5saXN0U2l6ZSgpKQorCQkJKyAodGhpcy5uYW1lID09IG51bGwgPyAwIDogZ2V0TmFt
ZSgpLnRyZWVTaXplKCkpOworCX0KKworfQpkaWZmIC0tZ2l0IGEvb3JnLmVjbGlwc2UuamR0LmNv
cmUvZG9tL29yZy9lY2xpcHNlL2pkdC9jb3JlL2RvbS9UeXBlLmphdmEgYi9vcmcuZWNsaXBzZS5q
ZHQuY29yZS9kb20vb3JnL2VjbGlwc2UvamR0L2NvcmUvZG9tL1R5cGUuamF2YQppbmRleCA0ZDdm
ZjBiLi44YjRlOWJjIDEwMDY0NAotLS0gYS9vcmcuZWNsaXBzZS5qZHQuY29yZS9kb20vb3JnL2Vj
bGlwc2UvamR0L2NvcmUvZG9tL1R5cGUuamF2YQorKysgYi9vcmcuZWNsaXBzZS5qZHQuY29yZS9k
b20vb3JnL2VjbGlwc2UvamR0L2NvcmUvZG9tL1R5cGUuamF2YQpAQCAtMzMsNiArMzMsNyBAQAog
ICogICAgICAgQXJyYXlUeXBlCiAgKiAgICAgICBTaW1wbGVUeXBlCiAgKiAgICAgICBRdWFsaWZp
ZWRUeXBlCisgKiAgICAgICBQYWNrYWdlUXVhbGlmaWVkVHlwZQogICogICAgICAgV2lsZGNhcmRU
eXBlCiAgKiAgICBQYXJhbWV0ZXJpemVkVHlwZQogICogICAgVW5pb25UeXBlCkBAIC01NCw2ICs1
NSw4IEBACiAgKiAgICB7IEFubm90YXRpb24gfSBUeXBlTmFtZQogICoge0BsaW5rIFF1YWxpZmll
ZFR5cGV9OgogICogICAgVHlwZSA8Yj4uPC9iPiB7QW5ub3RhdGlvbn0gU2ltcGxlTmFtZQorICog
e0BsaW5rIFBhY2thZ2VRdWFsaWZpZWRUeXBlfToKKyAqICAgIE5hbWUgPGI+LjwvYj4geyBBbm5v
dGF0aW9uIH0gU2ltcGxlTmFtZQogICoge0BsaW5rIFdpbGRjYXJkVHlwZX06CiAgKiAgICB7IEFu
bm90YXRpb24gfSA8Yj4/PC9iPiBbICggPGI+ZXh0ZW5kczwvYj4gfCA8Yj5zdXBlcjwvYj4pIFR5
cGUgXQogICoge0BsaW5rIFBhcmFtZXRlcml6ZWRUeXBlfToKQEAgLTExNSw2ICsxMTgsMTggQEAK
IAl9CiAKIAkvKioKKwkgKiBSZXR1cm5zIHdoZXRoZXIgdGhpcyB0eXBlIGlzIGEgcGFja2FnZSBx
dWFsaWZpZWQgdHlwZQorCSAqICh7QGxpbmsgUGFja2FnZVF1YWxpZmllZFR5cGV9KS4KKwkgKgor
CSAqIEByZXR1cm4gPGNvZGU+dHJ1ZTwvY29kZT4gaWYgdGhpcyBpcyBhIHBhY2thZ2UgcXVhbGlm
aWVkIHR5cGUsIGFuZAorCSAqICAgIDxjb2RlPmZhbHNlPC9jb2RlPiBvdGhlcndpc2UKKwkgKiBA
c2luY2UgMy45IEJFVEFfSkFWQTgKKwkgKi8KKwlwdWJsaWMgZmluYWwgYm9vbGVhbiBpc1BhY2th
Z2VRdWFsaWZpZWRUeXBlKCkgeworCQlyZXR1cm4gKHRoaXMgaW5zdGFuY2VvZiBQYWNrYWdlUXVh
bGlmaWVkVHlwZSk7CisJfQorCisJLyoqCiAJICogUmV0dXJucyB3aGV0aGVyIHRoaXMgdHlwZSBp
cyBhIHBhcmFtZXRlcml6ZWQgdHlwZQogCSAqICh7QGxpbmsgUGFyYW1ldGVyaXplZFR5cGV9KS4K
IAkgKgpkaWZmIC0tZ2l0IGEvb3JnLmVjbGlwc2UuamR0LmNvcmUvZG9tL29yZy9lY2xpcHNlL2pk
dC9pbnRlcm5hbC9jb3JlL2RvbS9OYWl2ZUFTVEZsYXR0ZW5lci5qYXZhIGIvb3JnLmVjbGlwc2Uu
amR0LmNvcmUvZG9tL29yZy9lY2xpcHNlL2pkdC9pbnRlcm5hbC9jb3JlL2RvbS9OYWl2ZUFTVEZs
YXR0ZW5lci5qYXZhCmluZGV4IDdmNGIzYTEuLmVlNTQzMjAgMTAwNjQ0Ci0tLSBhL29yZy5lY2xp
cHNlLmpkdC5jb3JlL2RvbS9vcmcvZWNsaXBzZS9qZHQvaW50ZXJuYWwvY29yZS9kb20vTmFpdmVB
U1RGbGF0dGVuZXIuamF2YQorKysgYi9vcmcuZWNsaXBzZS5qZHQuY29yZS9kb20vb3JnL2VjbGlw
c2UvamR0L2ludGVybmFsL2NvcmUvZG9tL05haXZlQVNURmxhdHRlbmVyLmphdmEKQEAgLTExODcs
NiArMTE4NywxOCBAQAogCX0KIAogCS8qCisJICogQHNlZSBBU1RWaXNpdG9yI3Zpc2l0KFBhY2th
Z2VRdWFsaWZpZWRUeXBlKQorCSAqIEBzaW5jZSAzLjkgQkVUQV9KQVZBOAorCSAqLworCXB1Ymxp
YyBib29sZWFuIHZpc2l0KFBhY2thZ2VRdWFsaWZpZWRUeXBlIG5vZGUpIHsKKwkJbm9kZS5nZXRR
dWFsaWZpZXIoKS5hY2NlcHQodGhpcyk7CisJCXRoaXMuYnVmZmVyLmFwcGVuZCgnLicpOworCQl2
aXNpdFR5cGVBbm5vdGF0aW9ucyhub2RlKTsKKwkJbm9kZS5nZXROYW1lKCkuYWNjZXB0KHRoaXMp
OworCQlyZXR1cm4gZmFsc2U7CisJfQorCisJLyoKIAkgKiBAc2VlIEFTVFZpc2l0b3IjdmlzaXQo
UGFyYW1ldGVyaXplZFR5cGUpCiAJICogQHNpbmNlIDMuMQogCSAqLw==
</data>

          </attachment>
          <attachment
              isobsolete="0"
              ispatch="1"
              isprivate="0"
          >
            <attachid>230000</attachid>
            <date>2013-04-22 23:04:00 -0400</date>
            <delta_ts>2013-04-22 23:04:37 -0400</delta_ts>
            <desc>Proposed Patch</desc>
            <filename>Fix-for-Bug-404489--18dom-ast-Incorrect-conversion-o.patch</filename>
            <type>text/plain</type>
            <size>62495</size>
            <attacher name="Manoj Palat Away Until May 11 2015">manpalat</attacher>
            
              <data encoding="base64">ZGlmZiAtLWdpdCBhL29yZy5lY2xpcHNlLmpkdC5jb3JlLnRlc3RzLm1vZGVsL3NyYy9vcmcvZWNs
aXBzZS9qZHQvY29yZS90ZXN0cy9kb20vQVNUQ29udmVydGVyMTVUZXN0LmphdmEgYi9vcmcuZWNs
aXBzZS5qZHQuY29yZS50ZXN0cy5tb2RlbC9zcmMvb3JnL2VjbGlwc2UvamR0L2NvcmUvdGVzdHMv
ZG9tL0FTVENvbnZlcnRlcjE1VGVzdC5qYXZhCmluZGV4IDljMjhjNTkuLmFlYzFhM2MgMTAwNjQ0
Ci0tLSBhL29yZy5lY2xpcHNlLmpkdC5jb3JlLnRlc3RzLm1vZGVsL3NyYy9vcmcvZWNsaXBzZS9q
ZHQvY29yZS90ZXN0cy9kb20vQVNUQ29udmVydGVyMTVUZXN0LmphdmEKKysrIGIvb3JnLmVjbGlw
c2UuamR0LmNvcmUudGVzdHMubW9kZWwvc3JjL29yZy9lY2xpcHNlL2pkdC9jb3JlL3Rlc3RzL2Rv
bS9BU1RDb252ZXJ0ZXIxNVRlc3QuamF2YQpAQCAtNSw2ICs1LDEwIEBACiAgKiB3aGljaCBhY2Nv
bXBhbmllcyB0aGlzIGRpc3RyaWJ1dGlvbiwgYW5kIGlzIGF2YWlsYWJsZSBhdAogICogaHR0cDov
L3d3dy5lY2xpcHNlLm9yZy9sZWdhbC9lcGwtdjEwLmh0bWwKICAqCisgKiBUaGlzIGlzIGFuIGlt
cGxlbWVudGF0aW9uIG9mIGFuIGVhcmx5LWRyYWZ0IHNwZWNpZmljYXRpb24gZGV2ZWxvcGVkIHVu
ZGVyIHRoZSBKYXZhCisgKiBDb21tdW5pdHkgUHJvY2VzcyAoSkNQKSBhbmQgaXMgbWFkZSBhdmFp
bGFibGUgZm9yIHRlc3RpbmcgYW5kIGV2YWx1YXRpb24gcHVycG9zZXMKKyAqIG9ubHkuIFRoZSBj
b2RlIGlzIG5vdCBjb21wYXRpYmxlIHdpdGggYW55IHNwZWNpZmljYXRpb24gb2YgdGhlIEpDUC4K
KyAqIAogICogQ29udHJpYnV0b3JzOgogICogICAgIElCTSBDb3Jwb3JhdGlvbiAtIGluaXRpYWwg
QVBJIGFuZCBpbXBsZW1lbnRhdGlvbgogICogICAgIFN0ZXBoYW4gSGVycm1hbm4gLSBDb250cmli
dXRpb25zIGZvciAKQEAgLTExNTI3LDQgKzExNTMxLDM2IEBACiAJCQlkZWxldGVQcm9qZWN0KGpw
KTsKIAkJfQogCX0KKworCS8vIGh0dHBzOi8vYnVncy5lY2xpcHNlLm9yZy9idWdzL3Nob3dfYnVn
LmNnaT9pZD00MDQ0ODkKKwlwdWJsaWMgdm9pZCB0ZXN0QnVnNDA0NDg5KCkgdGhyb3dzIEphdmFN
b2RlbEV4Y2VwdGlvbiB7CisJCUlDb21waWxhdGlvblVuaXQgc291cmNlVW5pdCA9IGdldENvbXBp
bGF0aW9uVW5pdCgiQ29udmVydGVyMTgiICwgInNyYyIsICJ0ZXN0NDA0NDg5LmJ1ZyIsICJYLmph
dmEiKTsgLy8kTk9OLU5MUy0xJCAvLyROT04tTkxTLTIkIC8vJE5PTi1OTFMtMyQgLy8kTk9OLU5M
Uy00JAorCQlBU1ROb2RlIHJlc3VsdCA9IHJ1bkNvbnZlcnNpb24odGhpcy5hc3QuYXBpTGV2ZWwo
KSwgc291cmNlVW5pdCwgdHJ1ZSk7CisJCWFzc2VydFRydWUoIk5vdCBhIGNvbXBpbGF0aW9uIHVu
aXQiLCByZXN1bHQuZ2V0Tm9kZVR5cGUoKSA9PSBBU1ROb2RlLkNPTVBJTEFUSU9OX1VOSVQpOwor
CQlDb21waWxhdGlvblVuaXQgY29tcGlsYXRpb25Vbml0ID0gKENvbXBpbGF0aW9uVW5pdCkgcmVz
dWx0OworCQlhc3NlcnRQcm9ibGVtc1NpemUoY29tcGlsYXRpb25Vbml0LCAwKTsKKwkJQVNUTm9k
ZSBub2RlID0gZ2V0QVNUTm9kZShjb21waWxhdGlvblVuaXQsIDAsIDAsIDApOworCQlUeXBlRGVj
bGFyYXRpb24gdHlwZURlY2xhcmF0aW9uID0gIChUeXBlRGVjbGFyYXRpb24pIGNvbXBpbGF0aW9u
VW5pdC50eXBlcygpLmdldCgwKTsKKworCQlub2RlID0gKEFTVE5vZGUpIHR5cGVEZWNsYXJhdGlv
bi5ib2R5RGVjbGFyYXRpb25zKCkuZ2V0KDIpOworCQlhc3NlcnRFcXVhbHMoIk5vdCBhIG1ldGhv
ZCBkZWNsYXJhdGlvbiIsIEFTVE5vZGUuTUVUSE9EX0RFQ0xBUkFUSU9OLCBub2RlLmdldE5vZGVU
eXBlKCkpOwkJCisJCU1ldGhvZERlY2xhcmF0aW9uIG1ldGhvZERlY2wgPSAoTWV0aG9kRGVjbGFy
YXRpb24pIG5vZGU7CisJCVR5cGUgdHlwZSA9IG1ldGhvZERlY2wuZ2V0UmV0dXJuVHlwZTIoKTsK
KwkJYXNzZXJ0VHJ1ZSh0eXBlLmlzUXVhbGlmaWVkVHlwZSgpKTsKKwkJYXNzZXJ0VHJ1ZShpc01h
bGZvcm1lZCh0eXBlKSk7CisKKwkJLy8gcGFyYW1ldGVyCisJCVNpbmdsZVZhcmlhYmxlRGVjbGFy
YXRpb24gcGFyYW0gPSAoU2luZ2xlVmFyaWFibGVEZWNsYXJhdGlvbikgbWV0aG9kRGVjbC5wYXJh
bWV0ZXJzKCkuZ2V0KDApOworCQl0eXBlID0gcGFyYW0uZ2V0VHlwZSgpOworCQlhc3NlcnRUcnVl
KHR5cGUuaXNRdWFsaWZpZWRUeXBlKCkpOworCQlhc3NlcnRUcnVlKGlzTWFsZm9ybWVkKHR5cGUp
KTsKKwkJCisJCW5vZGUgPSAoQVNUTm9kZSkgdHlwZURlY2xhcmF0aW9uLmJvZHlEZWNsYXJhdGlv
bnMoKS5nZXQoMyk7CisJCWFzc2VydEVxdWFscygiTm90IGEgZmllbGQgZGVjbGFyYXRpb24iLCBB
U1ROb2RlLkZJRUxEX0RFQ0xBUkFUSU9OLCBub2RlLmdldE5vZGVUeXBlKCkpOwkJCisJCUZpZWxk
RGVjbGFyYXRpb24gZmllbGQgPSAoRmllbGREZWNsYXJhdGlvbikgbm9kZTsKKwkJdHlwZSA9IGZp
ZWxkLmdldFR5cGUoKTsKKwkJYXNzZXJ0VHJ1ZSh0eXBlLmlzUXVhbGlmaWVkVHlwZSgpKTsKKwkJ
YXNzZXJ0VHJ1ZSh0eXBlLmlzUXVhbGlmaWVkVHlwZSgpKTsKKwkJYXNzZXJ0VHJ1ZShpc01hbGZv
cm1lZCh0eXBlKSk7CisJfQogfQpcIE5vIG5ld2xpbmUgYXQgZW5kIG9mIGZpbGUKZGlmZiAtLWdp
dCBhL29yZy5lY2xpcHNlLmpkdC5jb3JlLnRlc3RzLm1vZGVsL3NyYy9vcmcvZWNsaXBzZS9qZHQv
Y29yZS90ZXN0cy9kb20vQVNUQ29udmVydGVyMThUZXN0LmphdmEgYi9vcmcuZWNsaXBzZS5qZHQu
Y29yZS50ZXN0cy5tb2RlbC9zcmMvb3JnL2VjbGlwc2UvamR0L2NvcmUvdGVzdHMvZG9tL0FTVENv
bnZlcnRlcjE4VGVzdC5qYXZhCmluZGV4IDA2MDg2N2IuLjBkZTU2ZmYgMTAwNjQ0Ci0tLSBhL29y
Zy5lY2xpcHNlLmpkdC5jb3JlLnRlc3RzLm1vZGVsL3NyYy9vcmcvZWNsaXBzZS9qZHQvY29yZS90
ZXN0cy9kb20vQVNUQ29udmVydGVyMThUZXN0LmphdmEKKysrIGIvb3JnLmVjbGlwc2UuamR0LmNv
cmUudGVzdHMubW9kZWwvc3JjL29yZy9lY2xpcHNlL2pkdC9jb3JlL3Rlc3RzL2RvbS9BU1RDb252
ZXJ0ZXIxOFRlc3QuamF2YQpAQCAtMTQ5LDEwICsxNDksMTAgQEAKIAkJYXNzZXJ0Tm90TnVsbChh
c3NpZ25tZW50KTsKIAkJQ2FzdEV4cHJlc3Npb24gY2FzdEV4cHJlc3Npb24gPSAoQ2FzdEV4cHJl
c3Npb24pIGFzc2lnbm1lbnQuZ2V0UmlnaHRIYW5kU2lkZSgpOwogCQlhc3NlcnROb3ROdWxsKGNh
c3RFeHByZXNzaW9uKTsKLQkJU2ltcGxlVHlwZSBzaW1wbGVUeXBlID0gKFNpbXBsZVR5cGUpIGNh
c3RFeHByZXNzaW9uLmdldFR5cGUoKTsKLQkJYXNzZXJ0Tm90TnVsbChzaW1wbGVUeXBlKTsKLQkJ
YXNzZXJ0RXF1YWxzKCJqYXZhLmxhbmcuQE1hcmtlciBTdHJpbmciLCBzaW1wbGVUeXBlLnRvU3Ry
aW5nKCkpOwotCQlMaXN0IGFubm90YXRpb25zID0gc2ltcGxlVHlwZS5hbm5vdGF0aW9ucygpOwor
CQlQYWNrYWdlUXVhbGlmaWVkVHlwZSBwYWNrYWdlUXVhbGlmaWVkVHlwZSA9IChQYWNrYWdlUXVh
bGlmaWVkVHlwZSkgY2FzdEV4cHJlc3Npb24uZ2V0VHlwZSgpOworCQlhc3NlcnROb3ROdWxsKHBh
Y2thZ2VRdWFsaWZpZWRUeXBlKTsKKwkJYXNzZXJ0RXF1YWxzKCJqYXZhLmxhbmcuQE1hcmtlciBT
dHJpbmciLCBwYWNrYWdlUXVhbGlmaWVkVHlwZS50b1N0cmluZygpKTsKKwkJTGlzdCBhbm5vdGF0
aW9ucyA9IHBhY2thZ2VRdWFsaWZpZWRUeXBlLmFubm90YXRpb25zKCk7CiAJCWFzc2VydFRydWUo
YW5ub3RhdGlvbnMuc2l6ZSgpID09IDEpOwogCQlhc3NlcnRFcXVhbHMoIkBNYXJrZXIiLCBhbm5v
dGF0aW9ucy5nZXQoMCkudG9TdHJpbmcoKSk7CiAKQEAgLTE2MCw3ICsxNjAsNyBAQAogCQlWYXJp
YWJsZURlY2xhcmF0aW9uU3RhdGVtZW50IHZhcmlhYmxlRGVjbGFyYXRpb25TdGF0ZW1lbnQgPSAo
VmFyaWFibGVEZWNsYXJhdGlvblN0YXRlbWVudCkgc3RhdGVtZW50cy5nZXQoc0NvdW50KyspOwog
CQlUeXBlIHR5cGUgPSB2YXJpYWJsZURlY2xhcmF0aW9uU3RhdGVtZW50LmdldFR5cGUoKTsKIAkJ
YXNzZXJ0VHJ1ZSh0eXBlLmlzU2ltcGxlVHlwZSgpKTsKLQkJc2ltcGxlVHlwZSA9IChTaW1wbGVU
eXBlKSB0eXBlOworCQlTaW1wbGVUeXBlIHNpbXBsZVR5cGUgPSAoU2ltcGxlVHlwZSkgdHlwZTsK
IAkJYXNzZXJ0RXF1YWxzKCJPdXRlci5Jbm5lciIsIHNpbXBsZVR5cGUudG9TdHJpbmcoKSk7CiAJ
CWFubm90YXRpb25zID0gc2ltcGxlVHlwZS5hbm5vdGF0aW9ucygpOwogCQlhc3NlcnRUcnVlKGFu
bm90YXRpb25zLnNpemUoKSA9PSAwKTsKQEAgLTE2OSwyMiArMTY5LDIyIEBACiAJCS8vIGFubm90
YXRpb25zLgogCQl2YXJpYWJsZURlY2xhcmF0aW9uU3RhdGVtZW50ID0gKFZhcmlhYmxlRGVjbGFy
YXRpb25TdGF0ZW1lbnQpIHN0YXRlbWVudHMuZ2V0KHNDb3VudCsrKTsKIAkJdHlwZSA9IHZhcmlh
YmxlRGVjbGFyYXRpb25TdGF0ZW1lbnQuZ2V0VHlwZSgpOwotCQlhc3NlcnRUcnVlKHR5cGUuaXNT
aW1wbGVUeXBlKCkpOwotCQlzaW1wbGVUeXBlID0gKFNpbXBsZVR5cGUpIHR5cGU7Ci0JCWFzc2Vy
dE5vdE51bGwoc2ltcGxlVHlwZSk7Ci0JCWFzc2VydEVxdWFscygiT3V0ZXIuQE1hcmtlcjIgSW5u
ZXIiLCBzaW1wbGVUeXBlLnRvU3RyaW5nKCkpOwotCQlhbm5vdGF0aW9ucyA9IHNpbXBsZVR5cGUu
YW5ub3RhdGlvbnMoKTsKKwkJYXNzZXJ0VHJ1ZSh0eXBlLmlzUXVhbGlmaWVkVHlwZSgpKTsKKwkJ
UXVhbGlmaWVkVHlwZSBxdWFsaWZpZWRUeXBlID0gKFF1YWxpZmllZFR5cGUpIHR5cGU7CisJCWFz
c2VydE5vdE51bGwocXVhbGlmaWVkVHlwZSk7CisJCWFzc2VydEVxdWFscygiT3V0ZXIuQE1hcmtl
cjIgSW5uZXIiLCBxdWFsaWZpZWRUeXBlLnRvU3RyaW5nKCkpOworCQlhbm5vdGF0aW9ucyA9IHF1
YWxpZmllZFR5cGUuYW5ub3RhdGlvbnMoKTsKIAkJYXNzZXJ0VHJ1ZShhbm5vdGF0aW9ucy5zaXpl
KCkgPT0gMSk7CiAJCWFzc2VydEVxdWFscygiQE1hcmtlcjIiLCBhbm5vdGF0aW9ucy5nZXQoMCku
dG9TdHJpbmcoKSk7CiAKIAkJLy8gY2FzZSA0IC0gTXVsdGlwbGUgbGV2ZWxzIHdpdGggYW5ub3Rh
dGlvbnMgYXQgdGhlIGxhc3Qgb25seS4KIAkJdmFyaWFibGVEZWNsYXJhdGlvblN0YXRlbWVudCA9
IChWYXJpYWJsZURlY2xhcmF0aW9uU3RhdGVtZW50KSBzdGF0ZW1lbnRzLmdldChzQ291bnQrKyk7
CiAJCXR5cGUgPSB2YXJpYWJsZURlY2xhcmF0aW9uU3RhdGVtZW50LmdldFR5cGUoKTsKLQkJYXNz
ZXJ0VHJ1ZSh0eXBlLmlzU2ltcGxlVHlwZSgpKTsKLQkJc2ltcGxlVHlwZSA9IChTaW1wbGVUeXBl
KSB0eXBlOwotCQlhc3NlcnROb3ROdWxsKHNpbXBsZVR5cGUpOwotCQlhc3NlcnRFcXVhbHMoIk91
dGVyLklubmVyLkBNYXJrZXIxIERlZXBlciIsIHNpbXBsZVR5cGUudG9TdHJpbmcoKSk7Ci0JCWFu
bm90YXRpb25zID0gc2ltcGxlVHlwZS5hbm5vdGF0aW9ucygpOworCQlhc3NlcnRUcnVlKHR5cGUu
aXNRdWFsaWZpZWRUeXBlKCkpOworCQlxdWFsaWZpZWRUeXBlID0gKFF1YWxpZmllZFR5cGUpIHR5
cGU7CisJCWFzc2VydE5vdE51bGwocXVhbGlmaWVkVHlwZSk7CisJCWFzc2VydEVxdWFscygiT3V0
ZXIuSW5uZXIuQE1hcmtlcjEgRGVlcGVyIiwgcXVhbGlmaWVkVHlwZS50b1N0cmluZygpKTsKKwkJ
YW5ub3RhdGlvbnMgPSBxdWFsaWZpZWRUeXBlLmFubm90YXRpb25zKCk7CiAJCWFzc2VydFRydWUo
YW5ub3RhdGlvbnMuc2l6ZSgpID09IDEpOwogCQlhc3NlcnRFcXVhbHMoIkBNYXJrZXIxIiwgYW5u
b3RhdGlvbnMuZ2V0KDApLnRvU3RyaW5nKCkpOwogCkBAIC0xOTIsNyArMTkyLDcgQEAKIAkJdmFy
aWFibGVEZWNsYXJhdGlvblN0YXRlbWVudCA9IChWYXJpYWJsZURlY2xhcmF0aW9uU3RhdGVtZW50
KSBzdGF0ZW1lbnRzLmdldChzQ291bnQrKyk7CiAJCXR5cGUgPSB2YXJpYWJsZURlY2xhcmF0aW9u
U3RhdGVtZW50LmdldFR5cGUoKTsKIAkJYXNzZXJ0VHJ1ZSh0eXBlLmlzUXVhbGlmaWVkVHlwZSgp
KTsKLQkJUXVhbGlmaWVkVHlwZSBxdWFsaWZpZWRUeXBlID0gKFF1YWxpZmllZFR5cGUpIHR5cGU7
CisJCXF1YWxpZmllZFR5cGUgPSAoUXVhbGlmaWVkVHlwZSkgdHlwZTsKIAkJYXNzZXJ0Tm90TnVs
bChxdWFsaWZpZWRUeXBlKTsKIAkJYXNzZXJ0RXF1YWxzKCJPdXRlci5ATWFya2VyMSBJbm5lci5A
TWFya2VyMiBEZWVwZXIiLCBxdWFsaWZpZWRUeXBlLnRvU3RyaW5nKCkpOwogCQlhbm5vdGF0aW9u
cyA9IHF1YWxpZmllZFR5cGUuYW5ub3RhdGlvbnMoKTsKQEAgLTIwMSwxMCArMjAxLDEwIEBACiAJ
CVNpbXBsZU5hbWUgc2ltcGxlTmFtZSA9IHF1YWxpZmllZFR5cGUuZ2V0TmFtZSgpOwogCQlhc3Nl
cnRFcXVhbHMoIkRlZXBlciIsIHNpbXBsZU5hbWUudG9TdHJpbmcoKSk7CiAJCVR5cGUgcXVhbGlm
aWVyVHlwZSA9IHF1YWxpZmllZFR5cGUuZ2V0UXVhbGlmaWVyKCk7Ci0JCWFzc2VydFRydWUocXVh
bGlmaWVyVHlwZS5pc1NpbXBsZVR5cGUoKSk7Ci0JCXNpbXBsZVR5cGUgPSAoU2ltcGxlVHlwZSkg
cXVhbGlmaWVyVHlwZTsKLQkJYXNzZXJ0RXF1YWxzKCJPdXRlci5ATWFya2VyMSBJbm5lciIsIHNp
bXBsZVR5cGUudG9TdHJpbmcoKSk7Ci0JCWFubm90YXRpb25zID0gc2ltcGxlVHlwZS5hbm5vdGF0
aW9ucygpOworCQlhc3NlcnRUcnVlKHF1YWxpZmllclR5cGUuaXNRdWFsaWZpZWRUeXBlKCkpOwor
CQlxdWFsaWZpZWRUeXBlID0gKFF1YWxpZmllZFR5cGUpIHF1YWxpZmllclR5cGU7CisJCWFzc2Vy
dEVxdWFscygiT3V0ZXIuQE1hcmtlcjEgSW5uZXIiLCBxdWFsaWZpZWRUeXBlLnRvU3RyaW5nKCkp
OworCQlhbm5vdGF0aW9ucyA9IHF1YWxpZmllZFR5cGUuYW5ub3RhdGlvbnMoKTsKIAkJYXNzZXJ0
VHJ1ZShhbm5vdGF0aW9ucy5zaXplKCkgPT0gMSk7CiAJCWFzc2VydEVxdWFscygiQE1hcmtlcjEi
LCBhbm5vdGF0aW9ucy5nZXQoMCkudG9TdHJpbmcoKSk7CiAJfQpAQCAtMzQyLDEwICszNDIsMTAg
QEAKIAkJdHlwZUFyZ3VtZW50cyA9IHBhcmFtZXRyaXplZFR5cGUudHlwZUFyZ3VtZW50cygpOwog
CQlhc3NlcnRFcXVhbHMoMSwgdHlwZUFyZ3VtZW50cy5zaXplKCkpOwogCQl0eXBlID0gKFR5cGUp
IHR5cGVBcmd1bWVudHMuZ2V0KDApOwotCQlhc3NlcnRUcnVlKHR5cGUuaXNTaW1wbGVUeXBlKCkp
OwotCQlTaW1wbGVUeXBlIHNpbXBsZVR5cGUgPSAoU2ltcGxlVHlwZSkgdHlwZTsKLQkJYXNzZXJ0
RXF1YWxzKCJPdXRlci5ATWFya2VyMSBJbm5lciIsIHNpbXBsZVR5cGUudG9TdHJpbmcoKSk7Ci0J
CUxpc3QgYW5ub3RhdGlvbnMgPSBzaW1wbGVUeXBlLmFubm90YXRpb25zKCk7CisJCWFzc2VydFRy
dWUodHlwZS5pc1F1YWxpZmllZFR5cGUoKSk7CisJCVF1YWxpZmllZFR5cGUgcXVhbGlmaWVkVHlw
ZSA9IChRdWFsaWZpZWRUeXBlKSB0eXBlOworCQlhc3NlcnRFcXVhbHMoIk91dGVyLkBNYXJrZXIx
IElubmVyIiwgcXVhbGlmaWVkVHlwZS50b1N0cmluZygpKTsKKwkJTGlzdCBhbm5vdGF0aW9ucyA9
IHF1YWxpZmllZFR5cGUuYW5ub3RhdGlvbnMoKTsKIAkJYXNzZXJ0VHJ1ZShhbm5vdGF0aW9ucy5z
aXplKCkgPT0gMSk7CiAJCUFubm90YXRpb24gYW5ub3RhdGlvbiA9IChBbm5vdGF0aW9uKSBhbm5v
dGF0aW9ucy5nZXQoMCk7CiAJCWFzc2VydEVxdWFscygiQE1hcmtlcjEiLCBhbm5vdGF0aW9uLnRv
U3RyaW5nKCkpOwpAQCAtMzU5LDEzICszNTksMTMgQEAKIAkJdHlwZSA9IChUeXBlKSB0eXBlQXJn
dW1lbnRzLmdldCgwKTsKIAkJYXNzZXJ0VHJ1ZSh0eXBlLmlzUXVhbGlmaWVkVHlwZSgpKTsKIAkJ
YXNzZXJ0RXF1YWxzKCJATWFya2VyMSBPdXRlci5Jbm5lciIsIHR5cGUudG9TdHJpbmcoKSk7Ci0J
CVF1YWxpZmllZFR5cGUgcXVhbGlmaWVkVHlwZSA9IChRdWFsaWZpZWRUeXBlKSB0eXBlOworCQlx
dWFsaWZpZWRUeXBlID0gKFF1YWxpZmllZFR5cGUpIHR5cGU7CiAJCWFzc2VydEVxdWFscygiSW5u
ZXIiLCBxdWFsaWZpZWRUeXBlLmdldE5hbWUoKS50b1N0cmluZygpKTsKIAkJYW5ub3RhdGlvbnMg
PSBxdWFsaWZpZWRUeXBlLmFubm90YXRpb25zKCk7CiAJCWFzc2VydFRydWUoYW5ub3RhdGlvbnMu
c2l6ZSgpID09IDApOwogCQlUeXBlIHF1YWxpZmllclR5cGUgPSBxdWFsaWZpZWRUeXBlLmdldFF1
YWxpZmllcigpOwogCQlhc3NlcnRUcnVlKHF1YWxpZmllclR5cGUuaXNTaW1wbGVUeXBlKCkpOwot
CQlzaW1wbGVUeXBlID0gKFNpbXBsZVR5cGUpIHF1YWxpZmllclR5cGU7CisJCVNpbXBsZVR5cGUg
c2ltcGxlVHlwZSA9IChTaW1wbGVUeXBlKSBxdWFsaWZpZXJUeXBlOwogCQlhc3NlcnRFcXVhbHMo
IkBNYXJrZXIxIE91dGVyIiwgc2ltcGxlVHlwZS50b1N0cmluZygpKTsKIAkJYW5ub3RhdGlvbnMg
PSBzaW1wbGVUeXBlLmFubm90YXRpb25zKCk7CiAJCWFzc2VydFRydWUoYW5ub3RhdGlvbnMuc2l6
ZSgpID09IDEpOwpAQCAtMTkzNSw2ICsxOTM1LDMxOCBAQAogCQltZXRob2QgPSAoTWV0aG9kRGVj
bGFyYXRpb24pIHR5cGUuYm9keURlY2xhcmF0aW9ucygpLmdldCgzKTsKIAkJYXNzZXJ0RXF1YWxz
KCJNZXRob2Qgc2hvdWxkIGJlIG1hbGZvcm1lZCIsIEFTVE5vZGUuTUFMRk9STUVELCAobWV0aG9k
LmdldEZsYWdzKCkgJiBBU1ROb2RlLk1BTEZPUk1FRCkpOwogCX0KKworCS8vIGh0dHBzOi8vYnVn
cy5lY2xpcHNlLm9yZy9idWdzL3Nob3dfYnVnLmNnaT9pZD00MDQ0ODkKKwlwdWJsaWMgdm9pZCB0
ZXN0QnVnNDA0NDg5YSgpIHRocm93cyBKYXZhTW9kZWxFeGNlcHRpb24geworCQlTdHJpbmcgY29u
dGVudHMgPQorCQkicGFja2FnZSB0ZXN0NDA0NDg5LmJ1ZztcbiIgKworCQkicHVibGljIGNsYXNz
IFggeyBcbiIgKworCQkiCWNsYXNzIFkgeyBcbiIgKworCQkiCQljbGFzcyBaIHtcbiIgKworCQki
CQkJcHVibGljIFooQEEgWC5AQiBZIFkudGhpcyl7fVxuIiArCisJCSIJCQl9XG4iICsKKwkJIiAg
CQl9XG4iICsKKwkJIiAgCQlPYmplY3Qgbz0oQEEgWC5AQiBZLkBNYXJrZXIgIFopbnVsbDtcbiIg
KworCQkiCX1cbiIgKworCQkiQGphdmEubGFuZy5hbm5vdGF0aW9uLlRhcmdldChqYXZhLmxhbmcu
YW5ub3RhdGlvbi5FbGVtZW50VHlwZS5UWVBFX1VTRSkgQGludGVyZmFjZSBNYXJrZXIge30gXG4i
ICsKKwkJIkBqYXZhLmxhbmcuYW5ub3RhdGlvbi5UYXJnZXQoamF2YS5sYW5nLmFubm90YXRpb24u
RWxlbWVudFR5cGUuVFlQRV9VU0UpIEBpbnRlcmZhY2UgQSB7fSBcbiIgKworCQkiQGphdmEubGFu
Zy5hbm5vdGF0aW9uLlRhcmdldChqYXZhLmxhbmcuYW5ub3RhdGlvbi5FbGVtZW50VHlwZS5UWVBF
X1VTRSkgQGludGVyZmFjZSBCIHt9IFxuIjsKKwkJdGhpcy53b3JraW5nQ29weSA9IGdldFdvcmtp
bmdDb3B5KCIvQ29udmVydGVyMTgvc3JjL3Rlc3Q0MDQ0ODkvYnVnL1guamF2YSIsIHRydWUvKiBy
ZXNvbHZlICovKTsKKwkJQVNUTm9kZSBub2RlID0gYnVpbGRBU1QoY29udGVudHMsIHRoaXMud29y
a2luZ0NvcHkpOworCQlhc3NlcnRFcXVhbHMoIk5vdCBhIGNvbXBpbGF0aW9uIHVuaXQiLCBBU1RO
b2RlLkNPTVBJTEFUSU9OX1VOSVQsIG5vZGUuZ2V0Tm9kZVR5cGUoKSk7CisJCUNvbXBpbGF0aW9u
VW5pdCB1bml0ID0gKENvbXBpbGF0aW9uVW5pdCkgbm9kZTsKKwkJVHlwZURlY2xhcmF0aW9uIHR5
cGUgPSAgKFR5cGVEZWNsYXJhdGlvbikgdW5pdC50eXBlcygpLmdldCgwKTsKKwkJbm9kZSA9IChB
U1ROb2RlKSB0eXBlLmJvZHlEZWNsYXJhdGlvbnMoKS5nZXQoMCk7CisJCWFzc2VydEVxdWFscygi
Tm90IGEgVHlwZSBEZWNsYXJhdGlvbiIsIEFTVE5vZGUuVFlQRV9ERUNMQVJBVElPTiwgbm9kZS5n
ZXROb2RlVHlwZSgpKTsKKwkJbm9kZSA9IChBU1ROb2RlKSAoKFR5cGVEZWNsYXJhdGlvbilub2Rl
KS5ib2R5RGVjbGFyYXRpb25zKCkuZ2V0KDApOworCQlhc3NlcnRFcXVhbHMoIk5vdCBhIFR5cGUg
RGVjbGFyYXRpb24iLCBBU1ROb2RlLlRZUEVfREVDTEFSQVRJT04sIG5vZGUuZ2V0Tm9kZVR5cGUo
KSk7CisJCW5vZGUgPSAoQVNUTm9kZSkgKChUeXBlRGVjbGFyYXRpb24pbm9kZSkuYm9keURlY2xh
cmF0aW9ucygpLmdldCgwKTsJCQorCQlhc3NlcnRFcXVhbHMoIk5vdCBhIG1ldGhvZCBEZWNsYXJh
dGlvbiIsIEFTVE5vZGUuTUVUSE9EX0RFQ0xBUkFUSU9OLCBub2RlLmdldE5vZGVUeXBlKCkpOwor
CQlNZXRob2REZWNsYXJhdGlvbiBtZXRob2QgPSAoTWV0aG9kRGVjbGFyYXRpb24pIG5vZGU7CisJ
CWFzc2VydEVxdWFscygiTWV0aG9kIHNob3VsZCBub3QgYmUgbWFsZm9ybWVkIiwgMCwgKG1ldGhv
ZC5nZXRGbGFncygpICYgQVNUTm9kZS5NQUxGT1JNRUQpKTsKKwkJQW5ub3RhdGFibGVUeXBlIGFu
bm90YXRhYmxlVHlwZSA9IG1ldGhvZC5nZXRSZWNlaXZlclR5cGUoKTsKKwkJYXNzZXJ0VHJ1ZShh
bm5vdGF0YWJsZVR5cGUuaXNRdWFsaWZpZWRUeXBlKCkpOworCQlRdWFsaWZpZWRUeXBlIHF1YWxp
ZmllZFR5cGUgPSAoUXVhbGlmaWVkVHlwZSkgYW5ub3RhdGFibGVUeXBlOworCQlhc3NlcnRFcXVh
bHMoIndyb25nIHF1YWxpZmllZCB0eXBlIiwgIkBBIFguQEIgWSIsIHF1YWxpZmllZFR5cGUudG9T
dHJpbmcoKSk7CisJCUlUeXBlQmluZGluZyBiaW5kaW5nID0gcXVhbGlmaWVkVHlwZS5yZXNvbHZl
QmluZGluZygpOworCQlhc3NlcnROb3ROdWxsKCJObyBiaW5kaW5nIiwgYmluZGluZyk7CisJCWFz
c2VydEVxdWFscygiV3JvbmcgcXVhbGlmaWVkIG5hbWUiLCAidGVzdDQwNDQ4OS5idWcuWC5ZIiwg
YmluZGluZy5nZXRRdWFsaWZpZWROYW1lKCkpOworCQlMaXN0IGFubm90YXRpb25zID0gcXVhbGlm
aWVkVHlwZS5hbm5vdGF0aW9ucygpOworCQlhc3NlcnRUcnVlKGFubm90YXRpb25zLnNpemUoKSA9
PSAxKTsKKwkJTWFya2VyQW5ub3RhdGlvbiBtYXJrZXIJPSAoTWFya2VyQW5ub3RhdGlvbikgYW5u
b3RhdGlvbnMuZ2V0KDApOworCQlhc3NlcnRFcXVhbHMoIndyb25nIGFubm90YXRpb24gbmFtZSIs
ICJAQiIsIG1hcmtlci50b1N0cmluZygpKTsKKwkJYmluZGluZyA9IG1hcmtlci5yZXNvbHZlVHlw
ZUJpbmRpbmcoKTsKKwkJYXNzZXJ0Tm90TnVsbCgiTm8gYmluZGluZyIsIGJpbmRpbmcpOworCQlh
c3NlcnRFcXVhbHMoIldyb25nIHF1YWxpZmllZCBuYW1lIiwgInRlc3Q0MDQ0ODkuYnVnLkIiLCBi
aW5kaW5nLmdldFF1YWxpZmllZE5hbWUoKSk7CisJCUlBbm5vdGF0aW9uQmluZGluZyBhbm5vdGF0
aW9uQmluZGluZyA9IG1hcmtlci5yZXNvbHZlQW5ub3RhdGlvbkJpbmRpbmcoKTsKKwkJYXNzZXJ0
Tm90TnVsbChhbm5vdGF0aW9uQmluZGluZyk7CisJCWFzc2VydEVxdWFscygid3JvbmcgYW5ub3Rh
dGlvbiBiaW5kaW5nIiwgIkIiLCBhbm5vdGF0aW9uQmluZGluZy5nZXROYW1lKCkpOworCQlOYW1l
IG5hbWUgPSBtYXJrZXIuZ2V0VHlwZU5hbWUoKTsKKwkJYXNzZXJ0VHJ1ZShuYW1lLmlzU2ltcGxl
TmFtZSgpKTsKKwkJU2ltcGxlTmFtZSBzaW1wbGVOYW1lID0gKFNpbXBsZU5hbWUpIG5hbWU7CisJ
CWFzc2VydEVxdWFscygid3JvbmcgdHlwZSBuYW1lIiwgIkIiLCBzaW1wbGVOYW1lLnRvU3RyaW5n
KCkpOworCQlhc3NlcnRFcXVhbHMoIndyb25nIHNpbXBsZSBuYW1lIiwgIkIiLHNpbXBsZU5hbWUu
Z2V0SWRlbnRpZmllcigpKTsKKwkJYmluZGluZyA9IHNpbXBsZU5hbWUucmVzb2x2ZVR5cGVCaW5k
aW5nKCk7CisJCWFzc2VydE5vdE51bGwoIk5vIGJpbmRpbmciLCBiaW5kaW5nKTsKKwkJYXNzZXJ0
RXF1YWxzKCJXcm9uZyBxdWFsaWZpZWQgbmFtZSIsICJ0ZXN0NDA0NDg5LmJ1Zy5CIiwgYmluZGlu
Zy5nZXRRdWFsaWZpZWROYW1lKCkpOworCQlhc3NlcnRUcnVlKHF1YWxpZmllZFR5cGUuZ2V0UXVh
bGlmaWVyKCkuaXNTaW1wbGVUeXBlKCkpOworCQlTaW1wbGVUeXBlIHNpbXBsZVR5cGUgPSAoU2lt
cGxlVHlwZSkgcXVhbGlmaWVkVHlwZS5nZXRRdWFsaWZpZXIoKTsKKwkJYXNzZXJ0RXF1YWxzKCJp
bmNvcnJlY3QgdHlwZSIsICJAQSBYIiwgc2ltcGxlVHlwZS50b1N0cmluZygpKTsKKwkJYmluZGlu
ZyA9IHNpbXBsZVR5cGUucmVzb2x2ZUJpbmRpbmcoKTsKKwkJYXNzZXJ0Tm90TnVsbCgiTm8gYmlu
ZGluZyIsIGJpbmRpbmcpOworCQlhc3NlcnRFcXVhbHMoIldyb25nIHF1YWxpZmllZCBuYW1lIiwg
InRlc3Q0MDQ0ODkuYnVnLlguWSIsIGJpbmRpbmcuZ2V0UXVhbGlmaWVkTmFtZSgpKTsKKwl9CisK
KwkvLyBodHRwczovL2J1Z3MuZWNsaXBzZS5vcmcvYnVncy9zaG93X2J1Zy5jZ2k/aWQ9NDA0NDg5
CisJcHVibGljIHZvaWQgdGVzdEJ1ZzQwNDQ4OWIoKSB0aHJvd3MgSmF2YU1vZGVsRXhjZXB0aW9u
IHsKKwkJSUNvbXBpbGF0aW9uVW5pdCBzb3VyY2VVbml0ID0gZ2V0Q29tcGlsYXRpb25Vbml0KCJD
b252ZXJ0ZXIxOCIgLCAic3JjIiwgInRlc3Q0MDQ0ODkuYnVnIiwgIlguamF2YSIpOyAvLyROT04t
TkxTLTEkIC8vJE5PTi1OTFMtMiQgLy8kTk9OLU5MUy0zJCAvLyROT04tTkxTLTQkCisJCUFTVE5v
ZGUgcmVzdWx0ID0gcnVuQ29udmVyc2lvbih0aGlzLmFzdC5hcGlMZXZlbCgpLCBzb3VyY2VVbml0
LCB0cnVlKTsKKwkJY2hhcltdIHNvdXJjZSA9IHNvdXJjZVVuaXQuZ2V0U291cmNlKCkudG9DaGFy
QXJyYXkoKTsKKwkJYXNzZXJ0VHJ1ZSgiTm90IGEgY29tcGlsYXRpb24gdW5pdCIsIHJlc3VsdC5n
ZXROb2RlVHlwZSgpID09IEFTVE5vZGUuQ09NUElMQVRJT05fVU5JVCk7CisJCUNvbXBpbGF0aW9u
VW5pdCBjb21waWxhdGlvblVuaXQgPSAoQ29tcGlsYXRpb25Vbml0KSByZXN1bHQ7CisJCWFzc2Vy
dFByb2JsZW1zU2l6ZShjb21waWxhdGlvblVuaXQsIDApOworCQlBU1ROb2RlIG5vZGUgPSBnZXRB
U1ROb2RlKGNvbXBpbGF0aW9uVW5pdCwgMCwgMCwgMCk7CisJCVR5cGVEZWNsYXJhdGlvbiB0eXBl
RGVjbGFyYXRpb24gPSAgKFR5cGVEZWNsYXJhdGlvbikgY29tcGlsYXRpb25Vbml0LnR5cGVzKCku
Z2V0KDApOworCisJCW5vZGUgPSAoQVNUTm9kZSkgdHlwZURlY2xhcmF0aW9uLmJvZHlEZWNsYXJh
dGlvbnMoKS5nZXQoMik7CisJCWFzc2VydEVxdWFscygiTm90IGEgbWV0aG9kIGRlY2xhcmF0aW9u
IiwgQVNUTm9kZS5NRVRIT0RfREVDTEFSQVRJT04sIG5vZGUuZ2V0Tm9kZVR5cGUoKSk7CQkKKwkJ
TWV0aG9kRGVjbGFyYXRpb24gbWV0aG9kRGVjbCA9IChNZXRob2REZWNsYXJhdGlvbikgbm9kZTsK
KwkJVHlwZSB0eXBlID0gbWV0aG9kRGVjbC5nZXRSZXR1cm5UeXBlMigpOworCQlhc3NlcnRUcnVl
KHR5cGUuaXNQYWNrYWdlUXVhbGlmaWVkVHlwZSgpKTsKKwkJUGFja2FnZVF1YWxpZmllZFR5cGUg
cGFja2FnZVF1YWxpZmllZFR5cGUgPSAoUGFja2FnZVF1YWxpZmllZFR5cGUpIHR5cGU7CisJCWNo
ZWNrU291cmNlUmFuZ2UocGFja2FnZVF1YWxpZmllZFR5cGUsICJ0ZXN0NDA0NDg5LmJ1Zy5ATm9u
TnVsbCBJT0V4Y2VwdGlvbiIsIHNvdXJjZSk7CisJCUlUeXBlQmluZGluZyB0eXBlQmluZGluZyA9
IHBhY2thZ2VRdWFsaWZpZWRUeXBlLnJlc29sdmVCaW5kaW5nKCk7CisJCWFzc2VydE5vdE51bGwo
Im51bGwgYmluZGluZyIsIHR5cGVCaW5kaW5nKTsKKwkJYXNzZXJ0RXF1YWxzKCJub3QgYSB2YWxp
ZCBiaW5kaW5nIiwgInRlc3Q0MDQ0ODkuYnVnLklPRXhjZXB0aW9uIiwgdHlwZUJpbmRpbmcuZ2V0
UXVhbGlmaWVkTmFtZSgpKTsKKwkJCisJCS8vIHF1YWxpZmllciBvZiB0aGUgcGFja2FnZSBxdWFs
aWZpZWQgdHlwZQorCQlOYW1lIG5hbWUgPSBwYWNrYWdlUXVhbGlmaWVkVHlwZS5nZXRRdWFsaWZp
ZXIoKTsKKwkJYXNzZXJ0VHJ1ZShuYW1lLmlzUXVhbGlmaWVkTmFtZSgpKTsKKwkJUXVhbGlmaWVk
TmFtZSBxdWFsaWZpZWROYW1lID0gKFF1YWxpZmllZE5hbWUpIG5hbWU7CisJCWNoZWNrU291cmNl
UmFuZ2UocXVhbGlmaWVkTmFtZSwgInRlc3Q0MDQ0ODkuYnVnIiwgc291cmNlKTsKKwkJdHlwZUJp
bmRpbmcgPSBxdWFsaWZpZWROYW1lLnJlc29sdmVUeXBlQmluZGluZygpOworCQlhc3NlcnROdWxs
KHR5cGVCaW5kaW5nKTsKKwkJSUJpbmRpbmcgYmluZGluZyA9IHF1YWxpZmllZE5hbWUucmVzb2x2
ZUJpbmRpbmcoKTsKKwkJYXNzZXJ0VHJ1ZSgibm90IGEgcGFja2FnZSBiaW5kaW5nIiwgYmluZGlu
Zy5nZXRLaW5kKCkgPT0gSUJpbmRpbmcuUEFDS0FHRSk7CisJCWFzc2VydEVxdWFscygid3Jvbmcg
cGFja2FnZSBiaW5kaW5nIiwgInBhY2thZ2UgdGVzdDQwNDQ4OS5idWciLCBiaW5kaW5nLnRvU3Ry
aW5nKCkpOworCQluYW1lID0gcXVhbGlmaWVkTmFtZS5nZXRRdWFsaWZpZXIoKTsKKwkJYXNzZXJ0
VHJ1ZSgid3JvbmcgbmFtZSB0eXBlIiwgbmFtZS5pc1NpbXBsZU5hbWUoKSk7CisJCVNpbXBsZU5h
bWUgc2ltcGxlTmFtZSA9IChTaW1wbGVOYW1lKSBuYW1lOworCQljaGVja1NvdXJjZVJhbmdlKHNp
bXBsZU5hbWUsICJ0ZXN0NDA0NDg5Iiwgc291cmNlKTsKKwkJdHlwZUJpbmRpbmcgPSBzaW1wbGVO
YW1lLnJlc29sdmVUeXBlQmluZGluZygpOworCQlhc3NlcnROdWxsKHR5cGVCaW5kaW5nKTsKKwkJ
YmluZGluZyA9IHNpbXBsZU5hbWUucmVzb2x2ZUJpbmRpbmcoKTsKKwkJYXNzZXJ0VHJ1ZSgibm90
IGEgcGFja2FnZSBiaW5kaW5nIiwgYmluZGluZy5nZXRLaW5kKCkgPT0gSUJpbmRpbmcuUEFDS0FH
RSk7CisJCWFzc2VydEVxdWFscygid3JvbmcgcGFja2FnZSBiaW5kaW5nIiwgInBhY2thZ2UgdGVz
dDQwNDQ4OSIsIGJpbmRpbmcudG9TdHJpbmcoKSk7CisJCXNpbXBsZU5hbWUgPSBxdWFsaWZpZWRO
YW1lLmdldE5hbWUoKTsKKwkJY2hlY2tTb3VyY2VSYW5nZShzaW1wbGVOYW1lLCAiYnVnIiwgc291
cmNlKTsKKwkJdHlwZUJpbmRpbmcgPSBzaW1wbGVOYW1lLnJlc29sdmVUeXBlQmluZGluZygpOwor
CQlhc3NlcnROdWxsKHR5cGVCaW5kaW5nKTsKKwkJYmluZGluZyA9IHNpbXBsZU5hbWUucmVzb2x2
ZUJpbmRpbmcoKTsKKwkJYXNzZXJ0VHJ1ZSgibm90IGEgcGFja2FnZSBiaW5kaW5nIiwgYmluZGlu
Zy5nZXRLaW5kKCkgPT0gSUJpbmRpbmcuUEFDS0FHRSk7CisJCWFzc2VydEVxdWFscygid3Jvbmcg
cGFja2FnZSBiaW5kaW5nIiwgInBhY2thZ2UgdGVzdDQwNDQ4OS5idWciLCBiaW5kaW5nLnRvU3Ry
aW5nKCkpOworCQkKKwkJLy8gYW5ub3RhdGlvbnMgb2YgcGFja2FnZSBxdWFsaWZpZWQgdHlwZQor
CQlMaXN0IGFubm90YXRpb25zID0gcGFja2FnZVF1YWxpZmllZFR5cGUuYW5ub3RhdGlvbnMoKTsK
KwkJYXNzZXJ0VHJ1ZShhbm5vdGF0aW9ucy5zaXplKCkgPT0gMSk7CisJCUFubm90YXRpb24gYW5u
b3RhdGlvbiA9IChBbm5vdGF0aW9uKSBhbm5vdGF0aW9ucy5nZXQoMCk7CisJCXR5cGVCaW5kaW5n
ID0gYW5ub3RhdGlvbi5yZXNvbHZlVHlwZUJpbmRpbmcoKTsKKwkJYXNzZXJ0Tm90TnVsbCgibnVs
bCBiaW5kaW5nIiwgdHlwZUJpbmRpbmcpOworCQlhc3NlcnRFcXVhbHMoIm5vdCBhIHZhbGlkIGJp
bmRpbmciLCAidGVzdDQwNDQ4OS5idWcuWC5Ob25OdWxsIiwgdHlwZUJpbmRpbmcuZ2V0UXVhbGlm
aWVkTmFtZSgpKTsKKwkJSUFubm90YXRpb25CaW5kaW5nIGFubm90YXRpb25CaW5kaW5nID0gYW5u
b3RhdGlvbi5yZXNvbHZlQW5ub3RhdGlvbkJpbmRpbmcoKTsKKwkJYXNzZXJ0RXF1YWxzKCJub3Qg
YSB2YWxpZCBhbm5vdGF0aW9uIGJpbmRpbmciLCAiQE5vbk51bGwoKSIsIGFubm90YXRpb25CaW5k
aW5nLnRvU3RyaW5nKCkpOworCQluYW1lID0gYW5ub3RhdGlvbi5nZXRUeXBlTmFtZSgpOworCQlh
c3NlcnRUcnVlKG5hbWUuaXNTaW1wbGVOYW1lKCkpOworCQlzaW1wbGVOYW1lID0gKFNpbXBsZU5h
bWUpIG5hbWU7CisJCXR5cGVCaW5kaW5nID0gc2ltcGxlTmFtZS5yZXNvbHZlVHlwZUJpbmRpbmco
KTsKKwkJY2hlY2tTb3VyY2VSYW5nZShzaW1wbGVOYW1lLCAiTm9uTnVsbCIsIHNvdXJjZSk7CisJ
CWFzc2VydE5vdE51bGwodHlwZUJpbmRpbmcpOworCQkKKwkJLy8gbmFtZSBvZiB0aGUgcGFja2Fn
ZSBxdWFsaWZpZWQgdHlwZQorCQlzaW1wbGVOYW1lID0gcGFja2FnZVF1YWxpZmllZFR5cGUuZ2V0
TmFtZSgpOworCQljaGVja1NvdXJjZVJhbmdlKHNpbXBsZU5hbWUsICJJT0V4Y2VwdGlvbiIsIHNv
dXJjZSk7CisJCXR5cGVCaW5kaW5nID0gc2ltcGxlTmFtZS5yZXNvbHZlVHlwZUJpbmRpbmcoKTsK
KwkJYXNzZXJ0Tm90TnVsbCh0eXBlQmluZGluZyk7CisJCQorCQkvLyBwYXJhbWV0ZXIKKwkJU2lu
Z2xlVmFyaWFibGVEZWNsYXJhdGlvbiBwYXJhbSA9IChTaW5nbGVWYXJpYWJsZURlY2xhcmF0aW9u
KSBtZXRob2REZWNsLnBhcmFtZXRlcnMoKS5nZXQoMCk7CisJCXR5cGUgPSBwYXJhbS5nZXRUeXBl
KCk7CisJCWFzc2VydFRydWUodHlwZS5pc1BhY2thZ2VRdWFsaWZpZWRUeXBlKCkpOworCQlwYWNr
YWdlUXVhbGlmaWVkVHlwZSA9IChQYWNrYWdlUXVhbGlmaWVkVHlwZSkgdHlwZTsKKwkJY2hlY2tT
b3VyY2VSYW5nZShwYWNrYWdlUXVhbGlmaWVkVHlwZSwgInRlc3Q0MDQ0ODkuYnVnLkBOb25OdWxs
IEZpbGVOb3RGb3VuZEV4Y2VwdGlvbiIsIHNvdXJjZSk7CisJCXR5cGVCaW5kaW5nID0gcGFja2Fn
ZVF1YWxpZmllZFR5cGUucmVzb2x2ZUJpbmRpbmcoKTsKKwkJYXNzZXJ0Tm90TnVsbCgibnVsbCBi
aW5kaW5nIiwgdHlwZUJpbmRpbmcpOworCQlhc3NlcnRFcXVhbHMoIm5vdCBhIHZhbGlkIGJpbmRp
bmciLCAidGVzdDQwNDQ4OS5idWcuRmlsZU5vdEZvdW5kRXhjZXB0aW9uIiwgdHlwZUJpbmRpbmcu
Z2V0UXVhbGlmaWVkTmFtZSgpKTsKKwkJCisJCS8vIHF1YWxpZmllciBvZiB0aGUgcGFja2FnZSBx
dWFsaWZpZWQgdHlwZQorCQluYW1lID0gcGFja2FnZVF1YWxpZmllZFR5cGUuZ2V0UXVhbGlmaWVy
KCk7CisJCWFzc2VydFRydWUobmFtZS5pc1F1YWxpZmllZE5hbWUoKSk7CisJCXF1YWxpZmllZE5h
bWUgPSAoUXVhbGlmaWVkTmFtZSkgbmFtZTsKKwkJY2hlY2tTb3VyY2VSYW5nZShxdWFsaWZpZWRO
YW1lLCAidGVzdDQwNDQ4OS5idWciLCBzb3VyY2UpOworCQl0eXBlQmluZGluZyA9IHF1YWxpZmll
ZE5hbWUucmVzb2x2ZVR5cGVCaW5kaW5nKCk7CisJCWFzc2VydE51bGwodHlwZUJpbmRpbmcpOwor
CQliaW5kaW5nID0gcXVhbGlmaWVkTmFtZS5yZXNvbHZlQmluZGluZygpOworCQlhc3NlcnRUcnVl
KCJub3QgYSBwYWNrYWdlIGJpbmRpbmciLCBiaW5kaW5nLmdldEtpbmQoKSA9PSBJQmluZGluZy5Q
QUNLQUdFKTsKKwkJYXNzZXJ0RXF1YWxzKCJ3cm9uZyBwYWNrYWdlIGJpbmRpbmciLCAicGFja2Fn
ZSB0ZXN0NDA0NDg5LmJ1ZyIsIGJpbmRpbmcudG9TdHJpbmcoKSk7CisJCW5hbWUgPSBxdWFsaWZp
ZWROYW1lLmdldFF1YWxpZmllcigpOworCQlhc3NlcnRUcnVlKCJ3cm9uZyBuYW1lIHR5cGUiLCBu
YW1lLmlzU2ltcGxlTmFtZSgpKTsKKwkJc2ltcGxlTmFtZSA9IChTaW1wbGVOYW1lKSBuYW1lOwor
CQljaGVja1NvdXJjZVJhbmdlKHNpbXBsZU5hbWUsICJ0ZXN0NDA0NDg5Iiwgc291cmNlKTsKKwkJ
dHlwZUJpbmRpbmcgPSBzaW1wbGVOYW1lLnJlc29sdmVUeXBlQmluZGluZygpOworCQlhc3NlcnRO
dWxsKHR5cGVCaW5kaW5nKTsKKwkJYmluZGluZyA9IHNpbXBsZU5hbWUucmVzb2x2ZUJpbmRpbmco
KTsKKwkJYXNzZXJ0VHJ1ZSgibm90IGEgcGFja2FnZSBiaW5kaW5nIiwgYmluZGluZy5nZXRLaW5k
KCkgPT0gSUJpbmRpbmcuUEFDS0FHRSk7CisJCWFzc2VydEVxdWFscygid3JvbmcgcGFja2FnZSBi
aW5kaW5nIiwgInBhY2thZ2UgdGVzdDQwNDQ4OSIsIGJpbmRpbmcudG9TdHJpbmcoKSk7CisJCXNp
bXBsZU5hbWUgPSBxdWFsaWZpZWROYW1lLmdldE5hbWUoKTsKKwkJY2hlY2tTb3VyY2VSYW5nZShz
aW1wbGVOYW1lLCAiYnVnIiwgc291cmNlKTsKKwkJdHlwZUJpbmRpbmcgPSBzaW1wbGVOYW1lLnJl
c29sdmVUeXBlQmluZGluZygpOworCQlhc3NlcnROdWxsKHR5cGVCaW5kaW5nKTsKKwkJYmluZGlu
ZyA9IHNpbXBsZU5hbWUucmVzb2x2ZUJpbmRpbmcoKTsKKwkJYXNzZXJ0VHJ1ZSgibm90IGEgcGFj
a2FnZSBiaW5kaW5nIiwgYmluZGluZy5nZXRLaW5kKCkgPT0gSUJpbmRpbmcuUEFDS0FHRSk7CisJ
CWFzc2VydEVxdWFscygid3JvbmcgcGFja2FnZSBiaW5kaW5nIiwgInBhY2thZ2UgdGVzdDQwNDQ4
OS5idWciLCBiaW5kaW5nLnRvU3RyaW5nKCkpOworCQkKKwkJLy8gYW5ub3RhdGlvbnMgb2YgcGFj
a2FnZSBxdWFsaWZpZWQgdHlwZQorCQlhbm5vdGF0aW9ucyA9IHBhY2thZ2VRdWFsaWZpZWRUeXBl
LmFubm90YXRpb25zKCk7CisJCWFzc2VydFRydWUoYW5ub3RhdGlvbnMuc2l6ZSgpID09IDEpOwor
CQlhbm5vdGF0aW9uID0gKEFubm90YXRpb24pIGFubm90YXRpb25zLmdldCgwKTsKKwkJdHlwZUJp
bmRpbmcgPSBhbm5vdGF0aW9uLnJlc29sdmVUeXBlQmluZGluZygpOworCQlhc3NlcnROb3ROdWxs
KCJudWxsIGJpbmRpbmciLCB0eXBlQmluZGluZyk7CisJCWFzc2VydEVxdWFscygibm90IGEgdmFs
aWQgYmluZGluZyIsICJ0ZXN0NDA0NDg5LmJ1Zy5YLk5vbk51bGwiLCB0eXBlQmluZGluZy5nZXRR
dWFsaWZpZWROYW1lKCkpOworCQlhbm5vdGF0aW9uQmluZGluZyA9IGFubm90YXRpb24ucmVzb2x2
ZUFubm90YXRpb25CaW5kaW5nKCk7CisJCWFzc2VydEVxdWFscygibm90IGEgdmFsaWQgYW5ub3Rh
dGlvbiBiaW5kaW5nIiwgIkBOb25OdWxsKCkiLCBhbm5vdGF0aW9uQmluZGluZy50b1N0cmluZygp
KTsKKwkJbmFtZSA9IGFubm90YXRpb24uZ2V0VHlwZU5hbWUoKTsKKwkJYXNzZXJ0VHJ1ZShuYW1l
LmlzU2ltcGxlTmFtZSgpKTsKKwkJc2ltcGxlTmFtZSA9IChTaW1wbGVOYW1lKSBuYW1lOworCQl0
eXBlQmluZGluZyA9IHNpbXBsZU5hbWUucmVzb2x2ZVR5cGVCaW5kaW5nKCk7CisJCWNoZWNrU291
cmNlUmFuZ2Uoc2ltcGxlTmFtZSwgIk5vbk51bGwiLCBzb3VyY2UpOworCQlhc3NlcnROb3ROdWxs
KHR5cGVCaW5kaW5nKTsKKwkJCisJCS8vIG5hbWUgb2YgdGhlIHBhY2thZ2UgcXVhbGlmaWVkIHR5
cGUKKwkJc2ltcGxlTmFtZSA9IHBhY2thZ2VRdWFsaWZpZWRUeXBlLmdldE5hbWUoKTsKKwkJY2hl
Y2tTb3VyY2VSYW5nZShzaW1wbGVOYW1lLCAiRmlsZU5vdEZvdW5kRXhjZXB0aW9uIiwgc291cmNl
KTsKKwkJdHlwZUJpbmRpbmcgPSBzaW1wbGVOYW1lLnJlc29sdmVUeXBlQmluZGluZygpOworCQlh
c3NlcnROb3ROdWxsKHR5cGVCaW5kaW5nKTsKKwkJCisJCS8vIHRocm93cworCQl0eXBlID0gKFR5
cGUpIG1ldGhvZERlY2wudGhyb3duRXhjZXB0aW9uVHlwZXMoKS5nZXQoMCk7CisJCWFzc2VydFRy
dWUodHlwZS5pc1BhY2thZ2VRdWFsaWZpZWRUeXBlKCkpOworCQlwYWNrYWdlUXVhbGlmaWVkVHlw
ZSA9IChQYWNrYWdlUXVhbGlmaWVkVHlwZSkgdHlwZTsKKwkJY2hlY2tTb3VyY2VSYW5nZShwYWNr
YWdlUXVhbGlmaWVkVHlwZSwgInRlc3Q0MDQ0ODkuYnVnLkBOb25OdWxsIEVPRkV4Y2VwdGlvbiIs
IHNvdXJjZSk7CisJCXR5cGVCaW5kaW5nID0gcGFja2FnZVF1YWxpZmllZFR5cGUucmVzb2x2ZUJp
bmRpbmcoKTsKKwkJYXNzZXJ0Tm90TnVsbCgibnVsbCBiaW5kaW5nIiwgdHlwZUJpbmRpbmcpOwor
CQlhc3NlcnRFcXVhbHMoIm5vdCBhIHZhbGlkIGJpbmRpbmciLCAidGVzdDQwNDQ4OS5idWcuRU9G
RXhjZXB0aW9uIiwgdHlwZUJpbmRpbmcuZ2V0UXVhbGlmaWVkTmFtZSgpKTsKKwkJCisJCS8vIHF1
YWxpZmllciBvZiB0aGUgcGFja2FnZSBxdWFsaWZpZWQgdHlwZQorCQluYW1lID0gcGFja2FnZVF1
YWxpZmllZFR5cGUuZ2V0UXVhbGlmaWVyKCk7CisJCWFzc2VydFRydWUobmFtZS5pc1F1YWxpZmll
ZE5hbWUoKSk7CisJCXF1YWxpZmllZE5hbWUgPSAoUXVhbGlmaWVkTmFtZSkgbmFtZTsKKwkJY2hl
Y2tTb3VyY2VSYW5nZShxdWFsaWZpZWROYW1lLCAidGVzdDQwNDQ4OS5idWciLCBzb3VyY2UpOwor
CQl0eXBlQmluZGluZyA9IHF1YWxpZmllZE5hbWUucmVzb2x2ZVR5cGVCaW5kaW5nKCk7CisJCWFz
c2VydE51bGwodHlwZUJpbmRpbmcpOworCQliaW5kaW5nID0gcXVhbGlmaWVkTmFtZS5yZXNvbHZl
QmluZGluZygpOworCQlhc3NlcnRUcnVlKCJub3QgYSBwYWNrYWdlIGJpbmRpbmciLCBiaW5kaW5n
LmdldEtpbmQoKSA9PSBJQmluZGluZy5QQUNLQUdFKTsKKwkJYXNzZXJ0RXF1YWxzKCJ3cm9uZyBw
YWNrYWdlIGJpbmRpbmciLCAicGFja2FnZSB0ZXN0NDA0NDg5LmJ1ZyIsIGJpbmRpbmcudG9TdHJp
bmcoKSk7CisJCW5hbWUgPSBxdWFsaWZpZWROYW1lLmdldFF1YWxpZmllcigpOworCQlhc3NlcnRU
cnVlKCJ3cm9uZyBuYW1lIHR5cGUiLCBuYW1lLmlzU2ltcGxlTmFtZSgpKTsKKwkJc2ltcGxlTmFt
ZSA9IChTaW1wbGVOYW1lKSBuYW1lOworCQljaGVja1NvdXJjZVJhbmdlKHNpbXBsZU5hbWUsICJ0
ZXN0NDA0NDg5Iiwgc291cmNlKTsKKwkJdHlwZUJpbmRpbmcgPSBzaW1wbGVOYW1lLnJlc29sdmVU
eXBlQmluZGluZygpOworCQlhc3NlcnROdWxsKHR5cGVCaW5kaW5nKTsKKwkJYmluZGluZyA9IHNp
bXBsZU5hbWUucmVzb2x2ZUJpbmRpbmcoKTsKKwkJYXNzZXJ0VHJ1ZSgibm90IGEgcGFja2FnZSBi
aW5kaW5nIiwgYmluZGluZy5nZXRLaW5kKCkgPT0gSUJpbmRpbmcuUEFDS0FHRSk7CisJCWFzc2Vy
dEVxdWFscygid3JvbmcgcGFja2FnZSBiaW5kaW5nIiwgInBhY2thZ2UgdGVzdDQwNDQ4OSIsIGJp
bmRpbmcudG9TdHJpbmcoKSk7CisJCXNpbXBsZU5hbWUgPSBxdWFsaWZpZWROYW1lLmdldE5hbWUo
KTsKKwkJY2hlY2tTb3VyY2VSYW5nZShzaW1wbGVOYW1lLCAiYnVnIiwgc291cmNlKTsKKwkJdHlw
ZUJpbmRpbmcgPSBzaW1wbGVOYW1lLnJlc29sdmVUeXBlQmluZGluZygpOworCQlhc3NlcnROdWxs
KHR5cGVCaW5kaW5nKTsKKwkJYmluZGluZyA9IHNpbXBsZU5hbWUucmVzb2x2ZUJpbmRpbmcoKTsK
KwkJYXNzZXJ0VHJ1ZSgibm90IGEgcGFja2FnZSBiaW5kaW5nIiwgYmluZGluZy5nZXRLaW5kKCkg
PT0gSUJpbmRpbmcuUEFDS0FHRSk7CisJCWFzc2VydEVxdWFscygid3JvbmcgcGFja2FnZSBiaW5k
aW5nIiwgInBhY2thZ2UgdGVzdDQwNDQ4OS5idWciLCBiaW5kaW5nLnRvU3RyaW5nKCkpOworCQkK
KwkJLy8gYW5ub3RhdGlvbnMgb2YgcGFja2FnZSBxdWFsaWZpZWQgdHlwZQorCQlhbm5vdGF0aW9u
cyA9IHBhY2thZ2VRdWFsaWZpZWRUeXBlLmFubm90YXRpb25zKCk7CisJCWFzc2VydFRydWUoYW5u
b3RhdGlvbnMuc2l6ZSgpID09IDEpOworCQlhbm5vdGF0aW9uID0gKEFubm90YXRpb24pIGFubm90
YXRpb25zLmdldCgwKTsKKwkJdHlwZUJpbmRpbmcgPSBhbm5vdGF0aW9uLnJlc29sdmVUeXBlQmlu
ZGluZygpOworCQlhc3NlcnROb3ROdWxsKCJudWxsIGJpbmRpbmciLCB0eXBlQmluZGluZyk7CisJ
CWFzc2VydEVxdWFscygibm90IGEgdmFsaWQgYmluZGluZyIsICJ0ZXN0NDA0NDg5LmJ1Zy5YLk5v
bk51bGwiLCB0eXBlQmluZGluZy5nZXRRdWFsaWZpZWROYW1lKCkpOworCQlhbm5vdGF0aW9uQmlu
ZGluZyA9IGFubm90YXRpb24ucmVzb2x2ZUFubm90YXRpb25CaW5kaW5nKCk7CisJCWFzc2VydEVx
dWFscygibm90IGEgdmFsaWQgYW5ub3RhdGlvbiBiaW5kaW5nIiwgIkBOb25OdWxsKCkiLCBhbm5v
dGF0aW9uQmluZGluZy50b1N0cmluZygpKTsKKwkJbmFtZSA9IGFubm90YXRpb24uZ2V0VHlwZU5h
bWUoKTsKKwkJYXNzZXJ0VHJ1ZShuYW1lLmlzU2ltcGxlTmFtZSgpKTsKKwkJc2ltcGxlTmFtZSA9
IChTaW1wbGVOYW1lKSBuYW1lOworCQl0eXBlQmluZGluZyA9IHNpbXBsZU5hbWUucmVzb2x2ZVR5
cGVCaW5kaW5nKCk7CisJCWNoZWNrU291cmNlUmFuZ2Uoc2ltcGxlTmFtZSwgIk5vbk51bGwiLCBz
b3VyY2UpOworCQlhc3NlcnROb3ROdWxsKHR5cGVCaW5kaW5nKTsKKwkJCisJCS8vIG5hbWUgb2Yg
dGhlIHBhY2thZ2UgcXVhbGlmaWVkIHR5cGUKKwkJc2ltcGxlTmFtZSA9IHBhY2thZ2VRdWFsaWZp
ZWRUeXBlLmdldE5hbWUoKTsKKwkJY2hlY2tTb3VyY2VSYW5nZShzaW1wbGVOYW1lLCAiRU9GRXhj
ZXB0aW9uIiwgc291cmNlKTsKKwkJdHlwZUJpbmRpbmcgPSBzaW1wbGVOYW1lLnJlc29sdmVUeXBl
QmluZGluZygpOworCQlhc3NlcnROb3ROdWxsKHR5cGVCaW5kaW5nKTsKKworCQlub2RlID0gKEFT
VE5vZGUpIHR5cGVEZWNsYXJhdGlvbi5ib2R5RGVjbGFyYXRpb25zKCkuZ2V0KDMpOworCQlhc3Nl
cnRFcXVhbHMoIk5vdCBhIGZpZWxkIGRlY2xhcmF0aW9uIiwgQVNUTm9kZS5GSUVMRF9ERUNMQVJB
VElPTiwgbm9kZS5nZXROb2RlVHlwZSgpKTsJCQorCQlGaWVsZERlY2xhcmF0aW9uIGZpZWxkID0g
KEZpZWxkRGVjbGFyYXRpb24pIG5vZGU7CisJCXR5cGUgPSBmaWVsZC5nZXRUeXBlKCk7CisJCWFz
c2VydFRydWUodHlwZS5pc1F1YWxpZmllZFR5cGUoKSk7CisJCVF1YWxpZmllZFR5cGUgcXVhbGlm
aWVkVHlwZSA9IChRdWFsaWZpZWRUeXBlKSB0eXBlOworCQlwYWNrYWdlUXVhbGlmaWVkVHlwZSA9
IChQYWNrYWdlUXVhbGlmaWVkVHlwZSlxdWFsaWZpZWRUeXBlLmdldFF1YWxpZmllcigpOworCQlj
aGVja1NvdXJjZVJhbmdlKHBhY2thZ2VRdWFsaWZpZWRUeXBlLCAidGVzdDQwNDQ4OS5idWcuQE5v
bk51bGwgWCIsIHNvdXJjZSk7CisJCXR5cGVCaW5kaW5nID0gcGFja2FnZVF1YWxpZmllZFR5cGUu
cmVzb2x2ZUJpbmRpbmcoKTsKKwkJYXNzZXJ0Tm90TnVsbCgibnVsbCBiaW5kaW5nIiwgdHlwZUJp
bmRpbmcpOworCQlhc3NlcnRFcXVhbHMoIm5vdCBhIHZhbGlkIGJpbmRpbmciLCAidGVzdDQwNDQ4
OS5idWcuWC5Jbm5lciIsIHR5cGVCaW5kaW5nLmdldFF1YWxpZmllZE5hbWUoKSk7CisJCQorCQkv
LyBxdWFsaWZpZXIgb2YgdGhlIHBhY2thZ2UgcXVhbGlmaWVkIHR5cGUKKwkJbmFtZSA9IHBhY2th
Z2VRdWFsaWZpZWRUeXBlLmdldFF1YWxpZmllcigpOworCQlhc3NlcnRUcnVlKG5hbWUuaXNRdWFs
aWZpZWROYW1lKCkpOworCQlxdWFsaWZpZWROYW1lID0gKFF1YWxpZmllZE5hbWUpIG5hbWU7CisJ
CWNoZWNrU291cmNlUmFuZ2UocXVhbGlmaWVkTmFtZSwgInRlc3Q0MDQ0ODkuYnVnIiwgc291cmNl
KTsKKwkJdHlwZUJpbmRpbmcgPSBxdWFsaWZpZWROYW1lLnJlc29sdmVUeXBlQmluZGluZygpOwor
CQlhc3NlcnROdWxsKHR5cGVCaW5kaW5nKTsKKwkJYmluZGluZyA9IHF1YWxpZmllZE5hbWUucmVz
b2x2ZUJpbmRpbmcoKTsKKwkJYXNzZXJ0VHJ1ZSgibm90IGEgcGFja2FnZSBiaW5kaW5nIiwgYmlu
ZGluZy5nZXRLaW5kKCkgPT0gSUJpbmRpbmcuUEFDS0FHRSk7CisJCWFzc2VydEVxdWFscygid3Jv
bmcgcGFja2FnZSBiaW5kaW5nIiwgInBhY2thZ2UgdGVzdDQwNDQ4OS5idWciLCBiaW5kaW5nLnRv
U3RyaW5nKCkpOworCQluYW1lID0gcXVhbGlmaWVkTmFtZS5nZXRRdWFsaWZpZXIoKTsKKwkJYXNz
ZXJ0VHJ1ZSgid3JvbmcgbmFtZSB0eXBlIiwgbmFtZS5pc1NpbXBsZU5hbWUoKSk7CisJCXNpbXBs
ZU5hbWUgPSAoU2ltcGxlTmFtZSkgbmFtZTsKKwkJY2hlY2tTb3VyY2VSYW5nZShzaW1wbGVOYW1l
LCAidGVzdDQwNDQ4OSIsIHNvdXJjZSk7CisJCXR5cGVCaW5kaW5nID0gc2ltcGxlTmFtZS5yZXNv
bHZlVHlwZUJpbmRpbmcoKTsKKwkJYXNzZXJ0TnVsbCh0eXBlQmluZGluZyk7CisJCWJpbmRpbmcg
PSBzaW1wbGVOYW1lLnJlc29sdmVCaW5kaW5nKCk7CisJCWFzc2VydFRydWUoIm5vdCBhIHBhY2th
Z2UgYmluZGluZyIsIGJpbmRpbmcuZ2V0S2luZCgpID09IElCaW5kaW5nLlBBQ0tBR0UpOworCQlh
c3NlcnRFcXVhbHMoIndyb25nIHBhY2thZ2UgYmluZGluZyIsICJwYWNrYWdlIHRlc3Q0MDQ0ODki
LCBiaW5kaW5nLnRvU3RyaW5nKCkpOworCQlzaW1wbGVOYW1lID0gcXVhbGlmaWVkTmFtZS5nZXRO
YW1lKCk7CisJCWNoZWNrU291cmNlUmFuZ2Uoc2ltcGxlTmFtZSwgImJ1ZyIsIHNvdXJjZSk7CisJ
CXR5cGVCaW5kaW5nID0gc2ltcGxlTmFtZS5yZXNvbHZlVHlwZUJpbmRpbmcoKTsKKwkJYXNzZXJ0
TnVsbCh0eXBlQmluZGluZyk7CisJCWJpbmRpbmcgPSBzaW1wbGVOYW1lLnJlc29sdmVCaW5kaW5n
KCk7CisJCWFzc2VydFRydWUoIm5vdCBhIHBhY2thZ2UgYmluZGluZyIsIGJpbmRpbmcuZ2V0S2lu
ZCgpID09IElCaW5kaW5nLlBBQ0tBR0UpOworCQlhc3NlcnRFcXVhbHMoIndyb25nIHBhY2thZ2Ug
YmluZGluZyIsICJwYWNrYWdlIHRlc3Q0MDQ0ODkuYnVnIiwgYmluZGluZy50b1N0cmluZygpKTsK
KwkJCisJCS8vIGFubm90YXRpb25zIG9mIHBhY2thZ2UgcXVhbGlmaWVkIHR5cGUKKwkJYW5ub3Rh
dGlvbnMgPSBwYWNrYWdlUXVhbGlmaWVkVHlwZS5hbm5vdGF0aW9ucygpOworCQlhc3NlcnRUcnVl
KGFubm90YXRpb25zLnNpemUoKSA9PSAxKTsKKwkJYW5ub3RhdGlvbiA9IChBbm5vdGF0aW9uKSBh
bm5vdGF0aW9ucy5nZXQoMCk7CisJCXR5cGVCaW5kaW5nID0gYW5ub3RhdGlvbi5yZXNvbHZlVHlw
ZUJpbmRpbmcoKTsKKwkJYXNzZXJ0Tm90TnVsbCgibnVsbCBiaW5kaW5nIiwgdHlwZUJpbmRpbmcp
OworCQlhc3NlcnRFcXVhbHMoIm5vdCBhIHZhbGlkIGJpbmRpbmciLCAidGVzdDQwNDQ4OS5idWcu
WC5Ob25OdWxsIiwgdHlwZUJpbmRpbmcuZ2V0UXVhbGlmaWVkTmFtZSgpKTsKKwkJYW5ub3RhdGlv
bkJpbmRpbmcgPSBhbm5vdGF0aW9uLnJlc29sdmVBbm5vdGF0aW9uQmluZGluZygpOworCQlhc3Nl
cnRFcXVhbHMoIm5vdCBhIHZhbGlkIGFubm90YXRpb24gYmluZGluZyIsICJATm9uTnVsbCgpIiwg
YW5ub3RhdGlvbkJpbmRpbmcudG9TdHJpbmcoKSk7CisJCW5hbWUgPSBhbm5vdGF0aW9uLmdldFR5
cGVOYW1lKCk7CisJCWFzc2VydFRydWUobmFtZS5pc1NpbXBsZU5hbWUoKSk7CisJCXNpbXBsZU5h
bWUgPSAoU2ltcGxlTmFtZSkgbmFtZTsKKwkJdHlwZUJpbmRpbmcgPSBzaW1wbGVOYW1lLnJlc29s
dmVUeXBlQmluZGluZygpOworCQljaGVja1NvdXJjZVJhbmdlKHNpbXBsZU5hbWUsICJOb25OdWxs
Iiwgc291cmNlKTsKKwkJYXNzZXJ0Tm90TnVsbCh0eXBlQmluZGluZyk7CisJCQorCQkvLyBuYW1l
IG9mIHRoZSBwYWNrYWdlIHF1YWxpZmllZCB0eXBlCisJCXNpbXBsZU5hbWUgPSBwYWNrYWdlUXVh
bGlmaWVkVHlwZS5nZXROYW1lKCk7CisJCWNoZWNrU291cmNlUmFuZ2Uoc2ltcGxlTmFtZSwgIlgi
LCBzb3VyY2UpOworCQl0eXBlQmluZGluZyA9IHNpbXBsZU5hbWUucmVzb2x2ZVR5cGVCaW5kaW5n
KCk7CisJCWFzc2VydE5vdE51bGwodHlwZUJpbmRpbmcpOworCQkKKwl9CiAJLy8gaHR0cHM6Ly9i
dWdzLmVjbGlwc2Uub3JnL2J1Z3Mvc2hvd19idWcuY2dpP2lkPTM5OTc5MgogCXB1YmxpYyB2b2lk
IHRlc3RCdWczOTk3OTIoKSB0aHJvd3MgSmF2YU1vZGVsRXhjZXB0aW9uIHsKIAkJU3RyaW5nIGNv
bnRlbnQgPQpkaWZmIC0tZ2l0IGEvb3JnLmVjbGlwc2UuamR0LmNvcmUudGVzdHMubW9kZWwvc3Jj
L29yZy9lY2xpcHNlL2pkdC9jb3JlL3Rlc3RzL2RvbS9BU1RNYXRjaGVyVGVzdC5qYXZhIGIvb3Jn
LmVjbGlwc2UuamR0LmNvcmUudGVzdHMubW9kZWwvc3JjL29yZy9lY2xpcHNlL2pkdC9jb3JlL3Rl
c3RzL2RvbS9BU1RNYXRjaGVyVGVzdC5qYXZhCmluZGV4IDk3MGVmNmUuLjRlYzc3NTkgMTAwNjQ0
Ci0tLSBhL29yZy5lY2xpcHNlLmpkdC5jb3JlLnRlc3RzLm1vZGVsL3NyYy9vcmcvZWNsaXBzZS9q
ZHQvY29yZS90ZXN0cy9kb20vQVNUTWF0Y2hlclRlc3QuamF2YQorKysgYi9vcmcuZWNsaXBzZS5q
ZHQuY29yZS50ZXN0cy5tb2RlbC9zcmMvb3JnL2VjbGlwc2UvamR0L2NvcmUvdGVzdHMvZG9tL0FT
VE1hdGNoZXJUZXN0LmphdmEKQEAgLTQ1Myw2ICs0NTMsOSBAQAogCQlwdWJsaWMgYm9vbGVhbiBt
YXRjaChQYWNrYWdlRGVjbGFyYXRpb24gbm9kZSwgT2JqZWN0IG90aGVyKSB7CiAJCQlyZXR1cm4g
c3RhbmRhcmRCb2R5KG5vZGUsIG90aGVyLCB0aGlzLnN1cGVyTWF0Y2ggPyBzdXBlci5tYXRjaChu
b2RlLCBvdGhlcikgOiBmYWxzZSk7CiAJCX0KKwkJcHVibGljIGJvb2xlYW4gbWF0Y2goUGFja2Fn
ZVF1YWxpZmllZFR5cGUgbm9kZSwgT2JqZWN0IG90aGVyKSB7CisJCQlyZXR1cm4gc3RhbmRhcmRC
b2R5KG5vZGUsIG90aGVyLCB0aGlzLnN1cGVyTWF0Y2ggPyBzdXBlci5tYXRjaChub2RlLCBvdGhl
cikgOiBmYWxzZSk7CisJCX0KIAkJcHVibGljIGJvb2xlYW4gbWF0Y2goUGFyYW1ldGVyaXplZFR5
cGUgbm9kZSwgT2JqZWN0IG90aGVyKSB7CiAJCQlyZXR1cm4gc3RhbmRhcmRCb2R5KG5vZGUsIG90
aGVyLCB0aGlzLnN1cGVyTWF0Y2ggPyBzdXBlci5tYXRjaChub2RlLCBvdGhlcikgOiBmYWxzZSk7
CiAJCX0KQEAgLTcwOCw2ICs3MTEsMTUgQEAKIAl9CiAKIAkvKiogQGRlcHJlY2F0ZWQgdXNpbmcg
ZGVwcmVjYXRlZCBjb2RlICovCisJcHVibGljIHZvaWQgdGVzdFBhY2thZ2VRdWFsaWZpZWRUeXBl
KCkgeworCQlpZiAodGhpcy5hc3QuYXBpTGV2ZWwoKSA8IEFTVC5KTFM4KSB7CisJCQlyZXR1cm47
CisJCX0KKwkJVHlwZSB4MSA9IHRoaXMuYXN0Lm5ld1BhY2thZ2VRdWFsaWZpZWRUeXBlKHRoaXMu
YXN0Lm5ld1F1YWxpZmllZE5hbWUodGhpcy5OMiwgdGhpcy5OMyksIHRoaXMuTjEpOworCQliYXNp
Y01hdGNoKHgxKTsKKwl9CisKKwkvKiogQGRlcHJlY2F0ZWQgdXNpbmcgZGVwcmVjYXRlZCBjb2Rl
ICovCiAJcHVibGljIHZvaWQgdGVzdFBhcmFtZXRlcml6ZWRUeXBlKCkgewogCQlpZiAodGhpcy5h
c3QuYXBpTGV2ZWwoKSA9PSBBU1QuSkxTMikgewogCQkJcmV0dXJuOwpkaWZmIC0tZ2l0IGEvb3Jn
LmVjbGlwc2UuamR0LmNvcmUudGVzdHMubW9kZWwvc3JjL29yZy9lY2xpcHNlL2pkdC9jb3JlL3Rl
c3RzL2RvbS9BU1RTdHJ1Y3R1cmFsUHJvcGVydHlUZXN0LmphdmEgYi9vcmcuZWNsaXBzZS5qZHQu
Y29yZS50ZXN0cy5tb2RlbC9zcmMvb3JnL2VjbGlwc2UvamR0L2NvcmUvdGVzdHMvZG9tL0FTVFN0
cnVjdHVyYWxQcm9wZXJ0eVRlc3QuamF2YQppbmRleCBiMDAwY2I3Li5jMjM2YTBiIDEwMDY0NAot
LS0gYS9vcmcuZWNsaXBzZS5qZHQuY29yZS50ZXN0cy5tb2RlbC9zcmMvb3JnL2VjbGlwc2UvamR0
L2NvcmUvdGVzdHMvZG9tL0FTVFN0cnVjdHVyYWxQcm9wZXJ0eVRlc3QuamF2YQorKysgYi9vcmcu
ZWNsaXBzZS5qZHQuY29yZS50ZXN0cy5tb2RlbC9zcmMvb3JnL2VjbGlwc2UvamR0L2NvcmUvdGVz
dHMvZG9tL0FTVFN0cnVjdHVyYWxQcm9wZXJ0eVRlc3QuamF2YQpAQCAtMzI4LDcgKzMyOCw3IEBA
CiAJCQkJbWF4Tm9kZVR5cGUgPSA4NDsKIAkJCQlicmVhazsKIAkJCWNhc2UgQVNULkpMUzg6Ci0J
CQkJbWF4Tm9kZVR5cGUgPSA4NzsKKwkJCQltYXhOb2RlVHlwZSA9IDg4OwogCQkJCWJyZWFrOwog
CQkJZGVmYXVsdDoKIAkJCQlmYWlsKCk7CkBAIC0zNzIsNyArMzcyLDcgQEAKIAkJCQkvLyBvb3Bz
IC0gZ3Vlc3MgdGhhdCdzIG5vdCB2YWxpZAogCQkJfQogCQl9Ci0JCWFzc2VydEVxdWFscygiV3Jv
bmcgbGFzdCBrbm93biB0eXBlIiwgODcsIGhpKTsgLy8gbGFzdCBrbm93biBvbmUKKwkJYXNzZXJ0
RXF1YWxzKCJXcm9uZyBsYXN0IGtub3duIHR5cGUiLCA4OCwgaGkpOyAvLyBsYXN0IGtub3duIG9u
ZQogCQlhc3NlcnRFcXVhbHMoIldyb25nIG51bWJlciBvZiBkaXN0aW5jdCB0eXBlcyIsICBoaSwg
Y2xhc3Nlcy5zaXplKCkpOyAvLyBhbGwgY2xhc3NlcyBhcmUgZGlzdGluY3QKIAl9CiB9CmRpZmYg
LS1naXQgYS9vcmcuZWNsaXBzZS5qZHQuY29yZS50ZXN0cy5tb2RlbC9zcmMvb3JnL2VjbGlwc2Uv
amR0L2NvcmUvdGVzdHMvZG9tL0FTVFRlc3QuamF2YSBiL29yZy5lY2xpcHNlLmpkdC5jb3JlLnRl
c3RzLm1vZGVsL3NyYy9vcmcvZWNsaXBzZS9qZHQvY29yZS90ZXN0cy9kb20vQVNUVGVzdC5qYXZh
CmluZGV4IDQzMzNhOGYuLjUyYzhkZDIgMTAwNjQ0Ci0tLSBhL29yZy5lY2xpcHNlLmpkdC5jb3Jl
LnRlc3RzLm1vZGVsL3NyYy9vcmcvZWNsaXBzZS9qZHQvY29yZS90ZXN0cy9kb20vQVNUVGVzdC5q
YXZhCisrKyBiL29yZy5lY2xpcHNlLmpkdC5jb3JlLnRlc3RzLm1vZGVsL3NyYy9vcmcvZWNsaXBz
ZS9qZHQvY29yZS90ZXN0cy9kb20vQVNUVGVzdC5qYXZhCkBAIC04Nzg0LDYgKzg3ODQsNyBAQAog
CQkJQVNUTm9kZS5FWFRSQV9ESU1FTlNJT04sCiAJCQlBU1ROb2RlLkxBTUJEQV9FWFBSRVNTSU9O
LAogCQkJQVNUTm9kZS5JTlRFUlNFQ1RJT05fVFlQRSwKKwkJCUFTVE5vZGUuUEFDS0FHRV9RVUFM
SUZJRURfVFlQRSwKIAkJfTsKIAkJCiAJCS8vIGFzc2VydCB0aGF0IG5vZGVUeXBlIHZhbHVlcyBh
cmUgY29ycmVjdDoKZGlmZiAtLWdpdCBhL29yZy5lY2xpcHNlLmpkdC5jb3JlLnRlc3RzLm1vZGVs
L3NyYy9vcmcvZWNsaXBzZS9qZHQvY29yZS90ZXN0cy9kb20vQVNUVmlzaXRvclRlc3QuamF2YSBi
L29yZy5lY2xpcHNlLmpkdC5jb3JlLnRlc3RzLm1vZGVsL3NyYy9vcmcvZWNsaXBzZS9qZHQvY29y
ZS90ZXN0cy9kb20vQVNUVmlzaXRvclRlc3QuamF2YQppbmRleCAwMDcyZWQ4Li5mZjBkYjNhIDEw
MDY0NAotLS0gYS9vcmcuZWNsaXBzZS5qZHQuY29yZS50ZXN0cy5tb2RlbC9zcmMvb3JnL2VjbGlw
c2UvamR0L2NvcmUvdGVzdHMvZG9tL0FTVFZpc2l0b3JUZXN0LmphdmEKKysrIGIvb3JnLmVjbGlw
c2UuamR0LmNvcmUudGVzdHMubW9kZWwvc3JjL29yZy9lY2xpcHNlL2pkdC9jb3JlL3Rlc3RzL2Rv
bS9BU1RWaXNpdG9yVGVzdC5qYXZhCkBAIC0zODMsNiArMzgzLDEzIEBACiAJCQlBU1RWaXNpdG9y
VGVzdC50aGlzLmIuYXBwZW5kKG5vZGUuZ2V0UHJpbWl0aXZlVHlwZUNvZGUoKS50b1N0cmluZygp
KTsKIAkJCUFTVFZpc2l0b3JUZXN0LnRoaXMuYi5hcHBlbmQoInRQKSIpOyAvLyROT04tTkxTLTEk
CiAJCX0KKwkJcHVibGljIGJvb2xlYW4gdmlzaXQoUGFja2FnZVF1YWxpZmllZFR5cGUgbm9kZSkg
eworCQkJQVNUVmlzaXRvclRlc3QudGhpcy5iLmFwcGVuZCgiKHRQUSIpOyAvLyROT04tTkxTLTEk
CisJCQlyZXR1cm4gaXNWaXNpdGluZ0NoaWxkcmVuKCk7CisJCX0KKwkJcHVibGljIHZvaWQgZW5k
VmlzaXQoUGFja2FnZVF1YWxpZmllZFR5cGUgbm9kZSkgeworCQkJQVNUVmlzaXRvclRlc3QudGhp
cy5iLmFwcGVuZCgidFBRKSIpOyAvLyROT04tTkxTLTEkCisJCX0KIAkJcHVibGljIGJvb2xlYW4g
dmlzaXQoUGFyYW1ldGVyaXplZFR5cGUgbm9kZSkgewogCQkJQVNUVmlzaXRvclRlc3QudGhpcy5i
LmFwcGVuZCgiKHRNIik7IC8vJE5PTi1OTFMtMSQKIAkJCXJldHVybiBpc1Zpc2l0aW5nQ2hpbGRy
ZW4oKTsKQEAgLTExMjIsNiArMTEyOSwyMCBAQAogCX0KIAogCS8qKiBAZGVwcmVjYXRlZCB1c2lu
ZyBkZXByZWNhdGVkIGNvZGUgKi8KKwlwdWJsaWMgdm9pZCB0ZXN0UGFja2FnZVF1YWxpZmllZFR5
cGUoKSB7CisJCWlmICh0aGlzLmFzdC5hcGlMZXZlbCgpIDwgQVNULkpMUzgpIHsKKwkJCXJldHVy
bjsKKwkJfQorCQlRdWFsaWZpZWROYW1lIHEgPSB0aGlzLmFzdC5uZXdRdWFsaWZpZWROYW1lKHRo
aXMuTjIsIHRoaXMuTjMpOworCQlQYWNrYWdlUXVhbGlmaWVkVHlwZSB4MSA9IHRoaXMuYXN0Lm5l
d1BhY2thZ2VRdWFsaWZpZWRUeXBlKHEsIHRoaXMuTjEpOworCQlUZXN0VmlzaXRvciB2MSA9IG5l
dyBUZXN0VmlzaXRvcigpOworCQl0aGlzLmIuc2V0TGVuZ3RoKDApOworCQl4MS5hY2NlcHQodjEp
OworCQlTdHJpbmcgcmVzdWx0ID0gdGhpcy5iLnRvU3RyaW5nKCk7CisJCWFzc2VydFRydWUocmVz
dWx0LmVxdWFscygiWyh0UFEiKyJbKG5RIit0aGlzLk4yUyt0aGlzLk4zUysiblEpXSIrdGhpcy5O
MVMrInRQUSldIikpOyAvLyROT04tTkxTLTEkIC8vJE5PTi1OTFMtMiQKKwl9CisKKwkvKiogQGRl
cHJlY2F0ZWQgdXNpbmcgZGVwcmVjYXRlZCBjb2RlICovCiAJcHVibGljIHZvaWQgdGVzdFBhcmFt
ZXRlcml6ZWRUeXBlKCkgewogCQlpZiAodGhpcy5hc3QuYXBpTGV2ZWwoKSA9PSBBU1QuSkxTMikg
ewogCQkJcmV0dXJuOwpkaWZmIC0tZ2l0IGEvb3JnLmVjbGlwc2UuamR0LmNvcmUudGVzdHMubW9k
ZWwvd29ya3NwYWNlL0NvbnZlcnRlcjE1L3NyYy90ZXN0NDA0NDg5L2J1Zy9YLmphdmEgYi9vcmcu
ZWNsaXBzZS5qZHQuY29yZS50ZXN0cy5tb2RlbC93b3Jrc3BhY2UvQ29udmVydGVyMTUvc3JjL3Rl
c3Q0MDQ0ODkvYnVnL1guamF2YQpuZXcgZmlsZSBtb2RlIDEwMDY0NAppbmRleCAwMDAwMDAwLi40
Y2Y1NDJhCi0tLSAvZGV2L251bGwKKysrIGIvb3JnLmVjbGlwc2UuamR0LmNvcmUudGVzdHMubW9k
ZWwvd29ya3NwYWNlL0NvbnZlcnRlcjE1L3NyYy90ZXN0NDA0NDg5L2J1Zy9YLmphdmEKQEAgLTAs
MCArMSwzNyBAQAorcGFja2FnZSB0ZXN0NDA0NDg5LmJ1ZzsKK2ltcG9ydCBqYXZhLmxhbmcuYW5u
b3RhdGlvbi4qOworcHVibGljIGNsYXNzIFggeworCUBUYXJnZXQoRWxlbWVudFR5cGUuVFlQRV9V
U0UpCisJQFJldGVudGlvbihSZXRlbnRpb25Qb2xpY3kuUlVOVElNRSkKKwlARG9jdW1lbnRlZAor
CXN0YXRpYyBAaW50ZXJmYWNlIE5vbk51bGwgeyB9CisJY2xhc3MgSW5uZXIge30KKwkKKwkvKioK
KyAJKiBAcGFyYW0gYXJnICAKKyAJKi8KKwl0ZXN0NDA0NDg5LmJ1Zy5ATm9uTnVsbCBJT0V4Y2Vw
dGlvbiBmb28oCisJCQl0ZXN0NDA0NDg5LmJ1Zy5ATm9uTnVsbCBGaWxlTm90Rm91bmRFeGNlcHRp
b24gYXJnKQorCQl0aHJvd3MgdGVzdDQwNDQ4OS5idWcuQE5vbk51bGwgRU9GRXhjZXB0aW9uIHsK
KwkJdHJ5IHsKKwkJCXRlc3Q0MDQ0ODkuYnVnLkBOb25OdWxsIElPRXJyb3IgZSA9IG5ldyB0ZXN0
NDA0NDg5LmJ1Zy5JT0Vycm9yKCk7CisJCQl0aHJvdyBlOworCQl9IGNhdGNoICh0ZXN0NDA0NDg5
LmJ1Zy5ATm9uTnVsbCBJT0Vycm9yIGUpIHsKKwkJfQorCQlyZXR1cm4gbnVsbDsKKwl9IAorCXRl
c3Q0MDQ0ODkuYnVnLkBOb25OdWxsIFguQE5vbk51bGwgSW5uZXIgZklubmVyOworfSAKK0BqYXZh
LmxhbmcuYW5ub3RhdGlvbi5UYXJnZXQoamF2YS5sYW5nLmFubm90YXRpb24uRWxlbWVudFR5cGUu
VFlQRV9VU0UpIEBpbnRlcmZhY2UgTWFya2VyIHt9IAorQGphdmEubGFuZy5hbm5vdGF0aW9uLlRh
cmdldChqYXZhLmxhbmcuYW5ub3RhdGlvbi5FbGVtZW50VHlwZS5UWVBFX1VTRSkgQGludGVyZmFj
ZSBBIHt9IAorQGphdmEubGFuZy5hbm5vdGF0aW9uLlRhcmdldChqYXZhLmxhbmcuYW5ub3RhdGlv
bi5FbGVtZW50VHlwZS5UWVBFX1VTRSkgQGludGVyZmFjZSBCIHt9IAorCitjbGFzcyBPdXRlciB7
CisJcHVibGljIGNsYXNzIElubmVyIHsKKwkJcHVibGljIGNsYXNzIERlZXBlciB7fQorCX0KK30K
K2NsYXNzIElPRXhjZXB0aW9uIGV4dGVuZHMgRXhjZXB0aW9uIHtwcml2YXRlIHN0YXRpYyBmaW5h
bCBsb25nIHNlcmlhbFZlcnNpb25VSUQ9MTAwMDFMO30KK2NsYXNzIEZpbGVOb3RGb3VuZEV4Y2Vw
dGlvbiBleHRlbmRzIEV4Y2VwdGlvbntwcml2YXRlIHN0YXRpYyBmaW5hbCBsb25nIHNlcmlhbFZl
cnNpb25VSUQ9MTAwMDJMO30KK2NsYXNzIEVPRkV4Y2VwdGlvbiBleHRlbmRzIEV4Y2VwdGlvbntw
cml2YXRlIHN0YXRpYyBmaW5hbCBsb25nIHNlcmlhbFZlcnNpb25VSUQ9MTAwMDNMO30KK2NsYXNz
IElPRXJyb3IgZXh0ZW5kcyBFeGNlcHRpb257cHJpdmF0ZSBzdGF0aWMgZmluYWwgbG9uZyBzZXJp
YWxWZXJzaW9uVUlEPTEwMDA0TDt9ClwgTm8gbmV3bGluZSBhdCBlbmQgb2YgZmlsZQpkaWZmIC0t
Z2l0IGEvb3JnLmVjbGlwc2UuamR0LmNvcmUudGVzdHMubW9kZWwvd29ya3NwYWNlL0NvbnZlcnRl
cjE4L3NyYy90ZXN0NDA0NDg5L2J1Zy9YLmphdmEgYi9vcmcuZWNsaXBzZS5qZHQuY29yZS50ZXN0
cy5tb2RlbC93b3Jrc3BhY2UvQ29udmVydGVyMTgvc3JjL3Rlc3Q0MDQ0ODkvYnVnL1guamF2YQpu
ZXcgZmlsZSBtb2RlIDEwMDY0NAppbmRleCAwMDAwMDAwLi40Y2Y1NDJhCi0tLSAvZGV2L251bGwK
KysrIGIvb3JnLmVjbGlwc2UuamR0LmNvcmUudGVzdHMubW9kZWwvd29ya3NwYWNlL0NvbnZlcnRl
cjE4L3NyYy90ZXN0NDA0NDg5L2J1Zy9YLmphdmEKQEAgLTAsMCArMSwzNyBAQAorcGFja2FnZSB0
ZXN0NDA0NDg5LmJ1ZzsKK2ltcG9ydCBqYXZhLmxhbmcuYW5ub3RhdGlvbi4qOworcHVibGljIGNs
YXNzIFggeworCUBUYXJnZXQoRWxlbWVudFR5cGUuVFlQRV9VU0UpCisJQFJldGVudGlvbihSZXRl
bnRpb25Qb2xpY3kuUlVOVElNRSkKKwlARG9jdW1lbnRlZAorCXN0YXRpYyBAaW50ZXJmYWNlIE5v
bk51bGwgeyB9CisJY2xhc3MgSW5uZXIge30KKwkKKwkvKioKKyAJKiBAcGFyYW0gYXJnICAKKyAJ
Ki8KKwl0ZXN0NDA0NDg5LmJ1Zy5ATm9uTnVsbCBJT0V4Y2VwdGlvbiBmb28oCisJCQl0ZXN0NDA0
NDg5LmJ1Zy5ATm9uTnVsbCBGaWxlTm90Rm91bmRFeGNlcHRpb24gYXJnKQorCQl0aHJvd3MgdGVz
dDQwNDQ4OS5idWcuQE5vbk51bGwgRU9GRXhjZXB0aW9uIHsKKwkJdHJ5IHsKKwkJCXRlc3Q0MDQ0
ODkuYnVnLkBOb25OdWxsIElPRXJyb3IgZSA9IG5ldyB0ZXN0NDA0NDg5LmJ1Zy5JT0Vycm9yKCk7
CisJCQl0aHJvdyBlOworCQl9IGNhdGNoICh0ZXN0NDA0NDg5LmJ1Zy5ATm9uTnVsbCBJT0Vycm9y
IGUpIHsKKwkJfQorCQlyZXR1cm4gbnVsbDsKKwl9IAorCXRlc3Q0MDQ0ODkuYnVnLkBOb25OdWxs
IFguQE5vbk51bGwgSW5uZXIgZklubmVyOworfSAKK0BqYXZhLmxhbmcuYW5ub3RhdGlvbi5UYXJn
ZXQoamF2YS5sYW5nLmFubm90YXRpb24uRWxlbWVudFR5cGUuVFlQRV9VU0UpIEBpbnRlcmZhY2Ug
TWFya2VyIHt9IAorQGphdmEubGFuZy5hbm5vdGF0aW9uLlRhcmdldChqYXZhLmxhbmcuYW5ub3Rh
dGlvbi5FbGVtZW50VHlwZS5UWVBFX1VTRSkgQGludGVyZmFjZSBBIHt9IAorQGphdmEubGFuZy5h
bm5vdGF0aW9uLlRhcmdldChqYXZhLmxhbmcuYW5ub3RhdGlvbi5FbGVtZW50VHlwZS5UWVBFX1VT
RSkgQGludGVyZmFjZSBCIHt9IAorCitjbGFzcyBPdXRlciB7CisJcHVibGljIGNsYXNzIElubmVy
IHsKKwkJcHVibGljIGNsYXNzIERlZXBlciB7fQorCX0KK30KK2NsYXNzIElPRXhjZXB0aW9uIGV4
dGVuZHMgRXhjZXB0aW9uIHtwcml2YXRlIHN0YXRpYyBmaW5hbCBsb25nIHNlcmlhbFZlcnNpb25V
SUQ9MTAwMDFMO30KK2NsYXNzIEZpbGVOb3RGb3VuZEV4Y2VwdGlvbiBleHRlbmRzIEV4Y2VwdGlv
bntwcml2YXRlIHN0YXRpYyBmaW5hbCBsb25nIHNlcmlhbFZlcnNpb25VSUQ9MTAwMDJMO30KK2Ns
YXNzIEVPRkV4Y2VwdGlvbiBleHRlbmRzIEV4Y2VwdGlvbntwcml2YXRlIHN0YXRpYyBmaW5hbCBs
b25nIHNlcmlhbFZlcnNpb25VSUQ9MTAwMDNMO30KK2NsYXNzIElPRXJyb3IgZXh0ZW5kcyBFeGNl
cHRpb257cHJpdmF0ZSBzdGF0aWMgZmluYWwgbG9uZyBzZXJpYWxWZXJzaW9uVUlEPTEwMDA0TDt9
ClwgTm8gbmV3bGluZSBhdCBlbmQgb2YgZmlsZQpkaWZmIC0tZ2l0IGEvb3JnLmVjbGlwc2UuamR0
LmNvcmUvZG9tL29yZy9lY2xpcHNlL2pkdC9jb3JlL2RvbS9BU1QuamF2YSBiL29yZy5lY2xpcHNl
LmpkdC5jb3JlL2RvbS9vcmcvZWNsaXBzZS9qZHQvY29yZS9kb20vQVNULmphdmEKaW5kZXggNGVj
NzZjYS4uMjA3ODFjMyAxMDA2NDQKLS0tIGEvb3JnLmVjbGlwc2UuamR0LmNvcmUvZG9tL29yZy9l
Y2xpcHNlL2pkdC9jb3JlL2RvbS9BU1QuamF2YQorKysgYi9vcmcuZWNsaXBzZS5qZHQuY29yZS9k
b20vb3JnL2VjbGlwc2UvamR0L2NvcmUvZG9tL0FTVC5qYXZhCkBAIC0xOTcxLDYgKzE5NzEsMjkg
QEAKIAl9CiAKIAkvKioKKwkgKiBDcmVhdGVzIGFuZCByZXR1cm5zIGEgbmV3IHVucGFyZW50ZWQg
cGFja2FnZSBxdWFsaWZpZWQgdHlwZSBub2RlIHdpdGgKKwkgKiB0aGUgZ2l2ZW4gcXVhbGlmaWVy
IGFuZCBuYW1lLgorCSAqCisJICogQHBhcmFtIHF1YWxpZmllciB0aGUgcGFja2FnZSBxdWFsaWZp
ZXIgdHlwZSBub2RlCisJICogQHBhcmFtIG5hbWUgdGhlIHNpbXBsZSBuYW1lIGJlaW5nIHF1YWxp
ZmllZAorCSAqIEByZXR1cm4gYSBuZXcgdW5wYXJlbnRlZCBxdWFsaWZpZWQgdHlwZSBub2RlCisJ
ICogQGV4Y2VwdGlvbiBJbGxlZ2FsQXJndW1lbnRFeGNlcHRpb24gaWY6CisJICogPHVsPgorCSAq
IDxsaT50aGUgbm9kZSBiZWxvbmdzIHRvIGEgZGlmZmVyZW50IEFTVDwvbGk+CisJICogPGxpPnRo
ZSBub2RlIGFscmVhZHkgaGFzIGEgcGFyZW50PC9saT4KKwkgKiA8L3VsPgorCSAqIEBleGNlcHRp
b24gVW5zdXBwb3J0ZWRPcGVyYXRpb25FeGNlcHRpb24gaWYgdGhpcyBvcGVyYXRpb24gaXMgdXNl
ZCBpbgorCSAqIGEgSkxTMiwgSkxTMyBhbmQgSkxTNCBBU1QKKwkgKiBAc2luY2UgMy45IEJFVEFf
SkFWQTgKKwkgKi8KKwlwdWJsaWMgUGFja2FnZVF1YWxpZmllZFR5cGUgbmV3UGFja2FnZVF1YWxp
ZmllZFR5cGUoTmFtZSBxdWFsaWZpZXIsIFNpbXBsZU5hbWUgbmFtZSkgeworCQlQYWNrYWdlUXVh
bGlmaWVkVHlwZSByZXN1bHQgPSBuZXcgUGFja2FnZVF1YWxpZmllZFR5cGUodGhpcyk7CisJCXJl
c3VsdC5zZXRRdWFsaWZpZXIocXVhbGlmaWVyKTsKKwkJcmVzdWx0LnNldE5hbWUobmFtZSk7CisJ
CXJldHVybiByZXN1bHQ7CisJfQorCisJLyoqCiAJICogQ3JlYXRlcyBhbmQgcmV0dXJucyBhIG5l
dyB1bnBhcmVudGVkIHBhcmFtZXRlcml6ZWQgdHlwZSBub2RlIHdpdGggdGhlCiAJICogZ2l2ZW4g
dHlwZSBhbmQgYW4gZW1wdHkgbGlzdCBvZiB0eXBlIGFyZ3VtZW50cy4KIAkgKgpkaWZmIC0tZ2l0
IGEvb3JnLmVjbGlwc2UuamR0LmNvcmUvZG9tL29yZy9lY2xpcHNlL2pkdC9jb3JlL2RvbS9BU1RD
b252ZXJ0ZXIuamF2YSBiL29yZy5lY2xpcHNlLmpkdC5jb3JlL2RvbS9vcmcvZWNsaXBzZS9qZHQv
Y29yZS9kb20vQVNUQ29udmVydGVyLmphdmEKaW5kZXggNDNhNmMzMy4uMTc1NzI1MyAxMDA2NDQK
LS0tIGEvb3JnLmVjbGlwc2UuamR0LmNvcmUvZG9tL29yZy9lY2xpcHNlL2pkdC9jb3JlL2RvbS9B
U1RDb252ZXJ0ZXIuamF2YQorKysgYi9vcmcuZWNsaXBzZS5qZHQuY29yZS9kb20vb3JnL2VjbGlw
c2UvamR0L2NvcmUvZG9tL0FTVENvbnZlcnRlci5qYXZhCkBAIC0xNyw2ICsxNyw3IEBACiAKIHBh
Y2thZ2Ugb3JnLmVjbGlwc2UuamR0LmNvcmUuZG9tOwogCitpbXBvcnQgamF2YS51dGlsLkFycmF5
czsKIGltcG9ydCBqYXZhLnV0aWwuSGFzaFNldDsKIGltcG9ydCBqYXZhLnV0aWwuSXRlcmF0b3I7
CiBpbXBvcnQgamF2YS51dGlsLkxpc3Q7CkBAIC01Nyw2ICs1OCw4IEBACiBpbXBvcnQgb3JnLmVj
bGlwc2UuamR0LmludGVybmFsLmNvbXBpbGVyLmltcGwuQ29tcGlsZXJPcHRpb25zOwogaW1wb3J0
IG9yZy5lY2xpcHNlLmpkdC5pbnRlcm5hbC5jb21waWxlci5sb29rdXAuQmxvY2tTY29wZTsKIGlt
cG9ydCBvcmcuZWNsaXBzZS5qZHQuaW50ZXJuYWwuY29tcGlsZXIubG9va3VwLkV4dHJhQ29tcGls
ZXJNb2RpZmllcnM7CitpbXBvcnQgb3JnLmVjbGlwc2UuamR0LmludGVybmFsLmNvbXBpbGVyLmxv
b2t1cC5QYWNrYWdlQmluZGluZzsKK2ltcG9ydCBvcmcuZWNsaXBzZS5qZHQuaW50ZXJuYWwuY29t
cGlsZXIubG9va3VwLlJlZmVyZW5jZUJpbmRpbmc7CiBpbXBvcnQgb3JnLmVjbGlwc2UuamR0Lmlu
dGVybmFsLmNvbXBpbGVyLmxvb2t1cC5UeXBlQ29uc3RhbnRzOwogaW1wb3J0IG9yZy5lY2xpcHNl
LmpkdC5pbnRlcm5hbC5jb21waWxlci5wYXJzZXIuUmVjb3ZlcnlTY2FubmVyOwogaW1wb3J0IG9y
Zy5lY2xpcHNlLmpkdC5pbnRlcm5hbC5jb21waWxlci5wYXJzZXIuU2Nhbm5lcjsKQEAgLTMyOTYs
OSArMzI5OSw2IEBACiAJCQkJCW9yZy5lY2xpcHNlLmpkdC5pbnRlcm5hbC5jb21waWxlci5hc3Qu
QW5ub3RhdGlvbiB0eXBlQW5ub3RhdGlvbiA9IGFubm90YXRpb25zW2ldOwogCQkJCQlpZiAodHlw
ZUFubm90YXRpb24gIT0gbnVsbCkgewogCQkJCQkJQW5ub3RhdGlvbiBhbm5vdGF0aW9uID0gY29u
dmVydCh0eXBlQW5ub3RhdGlvbik7Ci0JCQkJCQlpbnQgc3RhcnQgPSB0eXBlQW5ub3RhdGlvbi5z
b3VyY2VTdGFydDsKLQkJCQkJCWludCBlbmQgPSB0eXBlQW5ub3RhdGlvbi5zb3VyY2VFbmQ7Ci0J
CQkJCQlhbm5vdGF0aW9uLnNldFNvdXJjZVJhbmdlKHN0YXJ0LCBlbmQgLSBzdGFydCArIDEpOwog
CQkJCQkJdHlwZS5hbm5vdGF0aW9ucygpLmFkZChhbm5vdGF0aW9uKTsKIAkJCQkJfQogCQkJCX0K
QEAgLTMzMjksOSArMzMyOSw2IEBACiAJCQkJCW9yZy5lY2xpcHNlLmpkdC5pbnRlcm5hbC5jb21w
aWxlci5hc3QuQW5ub3RhdGlvbiB0eXBlQW5ub3RhdGlvbiA9IGFubm90YXRpb25zW2ldOwogCQkJ
CQlpZiAodHlwZUFubm90YXRpb24gIT0gbnVsbCkgewogCQkJCQkJQW5ub3RhdGlvbiBhbm5vdGF0
aW9uID0gY29udmVydCh0eXBlQW5ub3RhdGlvbik7Ci0JCQkJCQlpbnQgc3RhcnQgPSB0eXBlQW5u
b3RhdGlvbi5zb3VyY2VTdGFydDsKLQkJCQkJCWludCBlbmQgPSB0eXBlQW5ub3RhdGlvbi5zb3Vy
Y2VFbmQ7Ci0JCQkJCQlhbm5vdGF0aW9uLnNldFNvdXJjZVJhbmdlKHN0YXJ0LCBlbmQgLSBzdGFy
dCArIDEpOwogCQkJCQkJdHlwZVBhcmFtZXRlci5hbm5vdGF0aW9ucygpLmFkZChhbm5vdGF0aW9u
KTsKIAkJCQkJfQogCQkJCX0KQEAgLTM1NDYsMTMgKzM1NDMsNyBAQAogCQkJCQkJc2ltcGxlVHlw
ZS5zZXROYW1lKG5hbWUpOwogCQkJCQkJaW50IHN0YXJ0ID0gKGludCkocG9zaXRpb25zWzBdID4+
PiAzMik7CiAJCQkJCQlpbnQgZW5kID0gKGludClwb3NpdGlvbnNbZmlyc3RUeXBlSW5kZXhdOwot
CQkJCQkJc2ltcGxlVHlwZS5zZXRTb3VyY2VSYW5nZShzdGFydCwgZW5kIC0gc3RhcnQgKyAxKTsK
LQkJCQkJCWlmICh0eXBlQW5ub3RhdGlvbnMgIT0gbnVsbCAmJiAoYW5ub3RhdGlvbnMgPSB0eXBl
QW5ub3RhdGlvbnNbZmlyc3RUeXBlSW5kZXhdKSAhPSBudWxsKSB7Ci0JCQkJCQkJYW5ub3RhdGVU
eXBlKHNpbXBsZVR5cGUsIGFubm90YXRpb25zKTsKLQkJCQkJCX0KLQkJCQkJCWlmICh0aGlzLnJl
c29sdmVCaW5kaW5ncykgewotCQkJCQkJCXJlY29yZE5vZGVzKHNpbXBsZVR5cGUsIHR5cGVSZWZl
cmVuY2UpOwotCQkJCQkJfQorCQkJCQkJc2V0U291cmNlUmFuZ2VBbm5vdGF0aW9uc0FuZFJlY29y
ZE5vZGVzKHR5cGVSZWZlcmVuY2UsIHBvc2l0aW9ucywgdHlwZUFubm90YXRpb25zLCBmaXJzdFR5
cGVJbmRleCwgMCwgZmlyc3RUeXBlSW5kZXgsIHNpbXBsZVR5cGUpOwogCQkJCQkJVHlwZSBjdXJy
ZW50VHlwZSA9IHNpbXBsZVR5cGU7CQkJCQkJCiAJCQkJCQlpbnQgaW5kZXhPZkVuY2xvc2luZ1R5
cGUgPSAxOwogCQkJCQkJaWYgKHR5cGVBcmd1bWVudHMgIT0gbnVsbCAmJiAoYXJndW1lbnRzID0g
dHlwZUFyZ3VtZW50c1tmaXJzdFR5cGVJbmRleF0pICE9IG51bGwpIHsKQEAgLTM2MjgsNyArMzYx
OSw3IEBACiAJCQkJb3JnLmVjbGlwc2UuamR0LmludGVybmFsLmNvbXBpbGVyLmFzdC5Bbm5vdGF0
aW9uIFtdW10gdHlwZUFubm90YXRpb25zID0gdHlwZVJlZmVyZW5jZS5hbm5vdGF0aW9uczsKIAkJ
CQljaGFyIFtdW10gdG9rZW5zID0gcXVhbGlmaWVkVHlwZVJlZmVyZW5jZS50b2tlbnM7CiAJCQkJ
aW50IGxlbnRoID0gdG9rZW5zLmxlbmd0aDsKLQkJCQlpbnQgZmlyc3RUeXBlSW5kZXggPSBsZW50
aCAtIDE7CisJCQkJaW50IGZpcnN0VHlwZUluZGV4ID0gbGVudGg7CiAJCQkJCiAJCQkJaWYgKHR5
cGVBbm5vdGF0aW9ucyAhPSBudWxsKSB7CiAJCQkJCWZvciAoaW50IGkgPSAwOyBpIDwgbGVudGg7
ICsraSkgewpAQCAtMzY0MCw1NyArMzYzMSw0NCBAQAogCQkJCX0gIAogCQkJCXNvdXJjZVN0YXJ0
ID0gKGludCkocG9zaXRpb25zWzBdPj4+MzIpOwogCQkJCU5hbWUgbmFtZSA9IG51bGw7Ci0JCQkJ
aWYgKGZpcnN0VHlwZUluZGV4ID09IDApIHsKLQkJCQkJZmluYWwgU2ltcGxlTmFtZSBzaW1wbGVO
YW1lID0gbmV3IFNpbXBsZU5hbWUodGhpcy5hc3QpOwotCQkJCQlzaW1wbGVOYW1lLmludGVybmFs
U2V0SWRlbnRpZmllcihuZXcgU3RyaW5nKHRva2Vuc1swXSkpOwotCQkJCQlyZWNvcmRQZW5kaW5n
TmFtZVNjb3BlUmVzb2x1dGlvbihzaW1wbGVOYW1lKTsKLQkJCQkJaW50IHN0YXJ0ID0gKGludCkg
KHBvc2l0aW9uc1swXSA+Pj4gMzIpOwotCQkJCQlpbnQgZW5kID0gKGludCkgcG9zaXRpb25zWzBd
OwotCQkJCQlzaW1wbGVOYW1lLnNldFNvdXJjZVJhbmdlKHN0YXJ0LCBlbmQpOwotCQkJCQlzaW1w
bGVOYW1lLmluZGV4ID0gMTsKLQkJCQkJbmFtZSA9IHNpbXBsZU5hbWU7Ci0JCQkJCWlmICh0aGlz
LnJlc29sdmVCaW5kaW5ncykgewotCQkJCQkJcmVjb3JkTm9kZXMoc2ltcGxlTmFtZSwgdHlwZVJl
ZmVyZW5jZSk7Ci0JCQkJCX0JCQkJCQorCQkJCVR5cGUgY3VycmVudFR5cGUgPSBudWxsOworCQkJ
CWlmIChmaXJzdFR5cGVJbmRleCA9PSBsZW50aCkgey8vSnVzdCBhIFF1YWxpZmllZE5hbWUKKwkJ
CQkJbmFtZSA9IHNldFF1YWxpZmllZE5hbWVOYW1lQW5kU291cmNlUmFuZ2VzKHRva2VucywgcG9z
aXRpb25zLCBsZW50aCAtIDEsIHR5cGVSZWZlcmVuY2UpOworCQkJCQljdXJyZW50VHlwZSA9IGNy
ZWF0ZVNpbXBsZVR5cGUobmFtZSwgdHlwZVJlZmVyZW5jZSwgcG9zaXRpb25zLCAwLCBsZW50aCAt
IDEpOwogCQkJCX0gZWxzZSB7Ci0JCQkJCW5hbWUgPSBzZXRRdWFsaWZpZWROYW1lTmFtZUFuZFNv
dXJjZVJhbmdlcyh0b2tlbnMsIHBvc2l0aW9ucywgZmlyc3RUeXBlSW5kZXgsIHR5cGVSZWZlcmVu
Y2UpOwotCQkJCX0KLQkJCQlTaW1wbGVUeXBlIHNpbXBsZVR5cGUgPSBuZXcgU2ltcGxlVHlwZSh0
aGlzLmFzdCk7Ci0JCQkJc2ltcGxlVHlwZS5zZXROYW1lKG5hbWUpOwotCQkJCWludCBzdGFydCA9
IChpbnQpKHBvc2l0aW9uc1swXSA+Pj4gMzIpOwotCQkJCWludCBlbmQgPSAoaW50KXBvc2l0aW9u
c1tmaXJzdFR5cGVJbmRleF07Ci0JCQkJc2ltcGxlVHlwZS5zZXRTb3VyY2VSYW5nZShzdGFydCwg
ZW5kIC0gc3RhcnQgKyAxKTsKLQkJCQlpZiAodHlwZUFubm90YXRpb25zICE9IG51bGwgJiYgKGFu
bm90YXRpb25zID0gdHlwZUFubm90YXRpb25zW2ZpcnN0VHlwZUluZGV4XSkgIT0gbnVsbCkgewot
CQkJCQlhbm5vdGF0ZVR5cGUoc2ltcGxlVHlwZSwgYW5ub3RhdGlvbnMpOwotCQkJCX0KLQkJCQlp
ZiAodGhpcy5yZXNvbHZlQmluZGluZ3MpIHsKLQkJCQkJcmVjb3JkTm9kZXMoc2ltcGxlVHlwZSwg
dHlwZVJlZmVyZW5jZSk7Ci0JCQkJfQotCQkJCVR5cGUgY3VycmVudFR5cGUgPSBzaW1wbGVUeXBl
OwotCQkJCQotCQkJCWZvciAoaW50IGkgPSBmaXJzdFR5cGVJbmRleCArIDE7IGkgPCBsZW50aDsg
KytpKSB7Ci0JCQkJCVNpbXBsZU5hbWUgc2ltcGxlTmFtZSA9IG5ldyBTaW1wbGVOYW1lKHRoaXMu
YXN0KTsKLQkJCQkJc2ltcGxlTmFtZS5pbnRlcm5hbFNldElkZW50aWZpZXIobmV3IFN0cmluZyh0
b2tlbnNbaV0pKTsKLQkJCQkJc2ltcGxlTmFtZS5pbmRleCA9IGkgKyAxOwotCQkJCQlzdGFydCA9
IChpbnQpIChwb3NpdGlvbnNbaV0gPj4+IDMyKTsKLQkJCQkJZW5kID0gKGludCkgcG9zaXRpb25z
W2ldOwotCQkJCQlzaW1wbGVOYW1lLnNldFNvdXJjZVJhbmdlKHN0YXJ0LCBlbmQgLSBzdGFydCAr
MSk7Ci0JCQkJCXJlY29yZFBlbmRpbmdOYW1lU2NvcGVSZXNvbHV0aW9uKHNpbXBsZU5hbWUpOwot
CQkJCQlRdWFsaWZpZWRUeXBlIHF1YWxpZmllZFR5cGUgPSBuZXcgUXVhbGlmaWVkVHlwZSh0aGlz
LmFzdCk7Ci0JCQkJCXF1YWxpZmllZFR5cGUuc2V0UXVhbGlmaWVyKGN1cnJlbnRUeXBlKTsKLQkJ
CQkJcXVhbGlmaWVkVHlwZS5zZXROYW1lKHNpbXBsZU5hbWUpOwotCQkJCQlpZiAodHlwZUFubm90
YXRpb25zICE9IG51bGwgJiYgKGFubm90YXRpb25zID0gdHlwZUFubm90YXRpb25zW2ldKSAhPSBu
dWxsKSB7Ci0JCQkJCQlhbm5vdGF0ZVR5cGUocXVhbGlmaWVkVHlwZSwgYW5ub3RhdGlvbnMpOwor
CQkJCQlpZiAoZmlyc3RUeXBlSW5kZXggPD0gMSkgeworCQkJCQkJbmFtZSA9IGNyZWF0ZVNpbXBs
ZU5hbWUodHlwZVJlZmVyZW5jZSwgcG9zaXRpb25zLCB0b2tlbnMsIDAgKTsKKwkJCQkJCWZpcnN0
VHlwZUluZGV4ID0gMTsKKwkJCQkJfSBlbHNlIHsKKwkJCQkJCW5hbWUgPSBzZXRRdWFsaWZpZWRO
YW1lTmFtZUFuZFNvdXJjZVJhbmdlcyh0b2tlbnMsIHBvc2l0aW9ucywgZmlyc3RUeXBlSW5kZXgg
LSAxLCB0eXBlUmVmZXJlbmNlKTsKKwkJCQkJfQkJCQkJCQorCisJCQkJCW9yZy5lY2xpcHNlLmpk
dC5pbnRlcm5hbC5jb21waWxlci5sb29rdXAuVHlwZUJpbmRpbmcgdHlwZUJpbmRpbmcgPSB0eXBl
UmVmZXJlbmNlLnJlc29sdmVkVHlwZTsKKwkJCQkJYm9vbGVhbiBjcmVhdGVQYWNrYWdlUXVhbGlm
aWVkVHlwZSA9IGZhbHNlOworCQkJCQlpZiAodHlwZUJpbmRpbmcgaW5zdGFuY2VvZiBSZWZlcmVu
Y2VCaW5kaW5nKSB7CisJCQkJCQlSZWZlcmVuY2VCaW5kaW5nIHJlZmVyZW5jZUJpbmRpbmcgPSAo
UmVmZXJlbmNlQmluZGluZyl0eXBlQmluZGluZzsJCQkKKwkJCQkJCVBhY2thZ2VCaW5kaW5nIHBh
Y2thZ2VCaW5kaW5nID0gcmVmZXJlbmNlQmluZGluZy5nZXRQYWNrYWdlKCk7CisJCQkJCQlpZiAo
cGFja2FnZUJpbmRpbmcgIT0gbnVsbCAmJiBBcnJheXMuZXF1YWxzKG5hbWUudG9TdHJpbmcoKS50
b0NoYXJBcnJheSgpLCBwYWNrYWdlQmluZGluZy5yZWFkYWJsZU5hbWUoKSkpIHsKKwkJCQkJCQlj
cmVhdGVQYWNrYWdlUXVhbGlmaWVkVHlwZSA9IHRydWU7CisJCQkJCQl9CiAJCQkJCX0KLQkJCQkJ
aWYgKHRoaXMucmVzb2x2ZUJpbmRpbmdzKSB7Ci0JCQkJCQlyZWNvcmROb2RlcyhzaW1wbGVOYW1l
LCB0eXBlUmVmZXJlbmNlKTsKLQkJCQkJCXJlY29yZE5vZGVzKHF1YWxpZmllZFR5cGUsIHR5cGVS
ZWZlcmVuY2UpOworCQkJCQkKKwkJCQkJaWYgKGNyZWF0ZVBhY2thZ2VRdWFsaWZpZWRUeXBlICYm
IHRoaXMuYXN0LmFwaUxldmVsID49IEFTVC5KTFM4KSB7CisJCQkJCQlQYWNrYWdlUXVhbGlmaWVk
VHlwZSBwYWNrYWdlUXVhbGlmaWVkVHlwZSA9IG5ldyBQYWNrYWdlUXVhbGlmaWVkVHlwZSh0aGlz
LmFzdCk7CisJCQkJCQlwYWNrYWdlUXVhbGlmaWVkVHlwZS5zZXRRdWFsaWZpZXIobmFtZSk7CisJ
CQkJCQlwYWNrYWdlUXVhbGlmaWVkVHlwZS5zZXROYW1lKGNyZWF0ZVNpbXBsZU5hbWUodHlwZVJl
ZmVyZW5jZSwgcG9zaXRpb25zLCB0b2tlbnMsIGZpcnN0VHlwZUluZGV4KSk7CisJCQkJCQlzZXRT
b3VyY2VSYW5nZUFubm90YXRpb25zQW5kUmVjb3JkTm9kZXModHlwZVJlZmVyZW5jZSwgcG9zaXRp
b25zLCB0eXBlQW5ub3RhdGlvbnMsIGZpcnN0VHlwZUluZGV4LCAwLCBmaXJzdFR5cGVJbmRleCwg
cGFja2FnZVF1YWxpZmllZFR5cGUpOworCQkJCQkJY3VycmVudFR5cGUgPSBwYWNrYWdlUXVhbGlm
aWVkVHlwZTsJCQkJCQkJCQkJCQkJCQkJCQorCQkJCQl9IGVsc2UgeworCQkJCQkJU2ltcGxlVHlw
ZSBzaW1wbGVUeXBlID0gdGhpcy5hc3QubmV3U2ltcGxlVHlwZShuYW1lKTsJCisJCQkJCQlzZXRT
b3VyY2VSYW5nZUFubm90YXRpb25zQW5kUmVjb3JkTm9kZXModHlwZVJlZmVyZW5jZSwgcG9zaXRp
b25zLCB0eXBlQW5ub3RhdGlvbnMsIDAsIDAsIG5hbWUuaW5kZXggPiAwID8gbmFtZS5pbmRleCAt
IDEgOiAwLCBzaW1wbGVUeXBlKTsKKwkJCQkJCWN1cnJlbnRUeXBlID0gY3JlYXRlUXVhbGlmaWVk
VHlwZSh0eXBlUmVmZXJlbmNlLCBwb3NpdGlvbnMsICB0eXBlQW5ub3RhdGlvbnMsIHRva2Vucywg
Zmlyc3RUeXBlSW5kZXgsIHNpbXBsZVR5cGUpOworCQkJCQkJaWYgKGNyZWF0ZVBhY2thZ2VRdWFs
aWZpZWRUeXBlKSAKKwkJCQkJCQljdXJyZW50VHlwZS5zZXRGbGFncyhjdXJyZW50VHlwZS5nZXRG
bGFncygpIHwgQVNUTm9kZS5NQUxGT1JNRUQpOwogCQkJCQl9Ci0JCQkJCXN0YXJ0ID0gY3VycmVu
dFR5cGUuZ2V0U3RhcnRQb3NpdGlvbigpOwotCQkJCQllbmQgPSBzaW1wbGVOYW1lLmdldFN0YXJ0
UG9zaXRpb24oKSArIHNpbXBsZU5hbWUuZ2V0TGVuZ3RoKCkgLSAxOwotCQkJCQlxdWFsaWZpZWRU
eXBlLnNldFNvdXJjZVJhbmdlKHN0YXJ0LCBlbmQgLSBzdGFydCArIDEpOwotCQkJCQljdXJyZW50
VHlwZSA9IHF1YWxpZmllZFR5cGU7Ci0JCQkJCXF1YWxpZmllZFR5cGUuaW5kZXggID0gMTsKKwkJ
CQkJZm9yIChpbnQgaSA9IGZpcnN0VHlwZUluZGV4ICsgMTsgaSA8IGxlbnRoOyArK2kpIHsKKwkJ
CQkJCWN1cnJlbnRUeXBlID0gY3JlYXRlUXVhbGlmaWVkVHlwZSh0eXBlUmVmZXJlbmNlLCBwb3Np
dGlvbnMsICB0eXBlQW5ub3RhdGlvbnMsIHRva2VucywgaSwgY3VycmVudFR5cGUpOworCQkJCQl9
CQkJCQkKIAkJCQl9CiAJCQkJdHlwZSA9IGN1cnJlbnRUeXBlOwogCQkJfSBlbHNlIGlmICh0eXBl
UmVmZXJlbmNlIGluc3RhbmNlb2YgVW5pb25UeXBlUmVmZXJlbmNlKXsKQEAgLTM4MDgsNiArMzc4
Niw3MyBAQAogCQlyZXR1cm4gdHlwZTsKIAl9CiAKKwlwcml2YXRlIFF1YWxpZmllZFR5cGUgY3Jl
YXRlUXVhbGlmaWVkVHlwZShUeXBlUmVmZXJlbmNlIHR5cGVSZWZlcmVuY2UsIGxvbmdbXSBwb3Np
dGlvbnMsCisJCQlvcmcuZWNsaXBzZS5qZHQuaW50ZXJuYWwuY29tcGlsZXIuYXN0LkFubm90YXRp
b25bXVtdIHR5cGVBbm5vdGF0aW9ucywgY2hhcltdW10gdG9rZW5zLCBpbnQgaW5kZXgsCisJCQlU
eXBlIHF1YWxpZmllcikgeworCQlTaW1wbGVOYW1lIHNpbXBsZU5hbWUgPSBjcmVhdGVTaW1wbGVO
YW1lKHR5cGVSZWZlcmVuY2UsIHBvc2l0aW9ucywgdG9rZW5zLCBpbmRleCk7CisJCVF1YWxpZmll
ZFR5cGUgcXVhbGlmaWVkVHlwZSA9IG5ldyBRdWFsaWZpZWRUeXBlKHRoaXMuYXN0KTsKKwkJcXVh
bGlmaWVkVHlwZS5zZXRRdWFsaWZpZXIocXVhbGlmaWVyKTsKKwkJcXVhbGlmaWVkVHlwZS5zZXRO
YW1lKHNpbXBsZU5hbWUpOworCQlpbnQgc3RhcnQgPSBxdWFsaWZpZXIuZ2V0U3RhcnRQb3NpdGlv
bigpOworCQlpbnQgZW5kID0gc2ltcGxlTmFtZS5nZXRTdGFydFBvc2l0aW9uKCkgKyBzaW1wbGVO
YW1lLmdldExlbmd0aCgpIC0gMTsKKwkJc2V0U291cmNlUmFuZ2VBbm5vdGF0aW9uc0FuZFJlY29y
ZE5vZGVzKHR5cGVSZWZlcmVuY2UsIHR5cGVBbm5vdGF0aW9ucywgaW5kZXgsIHN0YXJ0LCBlbmQs
IHF1YWxpZmllZFR5cGUpOworCQlyZXR1cm4gcXVhbGlmaWVkVHlwZTsKKwl9CisKKwlwcml2YXRl
IFNpbXBsZVR5cGUgY3JlYXRlU2ltcGxlVHlwZShOYW1lIG5hbWUsIFR5cGVSZWZlcmVuY2UgdHlw
ZVJlZmVyZW5jZSwgbG9uZ1tdIHBvc2l0aW9ucywKKwkJCWludCBzdGFydEluZGV4LCBpbnQgZW5k
SW5kZXgpIHsKKwkJU2ltcGxlVHlwZSBzaW1wbGVUeXBlID0gbmV3IFNpbXBsZVR5cGUodGhpcy5h
c3QpOworCQlzaW1wbGVUeXBlLnNldE5hbWUobmFtZSk7CisJCWludCBzdGFydCA9IChpbnQpKHBv
c2l0aW9uc1tzdGFydEluZGV4XSA+Pj4gMzIpOworCQlpbnQgZW5kID0gKGludClwb3NpdGlvbnNb
ZW5kSW5kZXhdOworCQlzaW1wbGVUeXBlLnNldFNvdXJjZVJhbmdlKHN0YXJ0LCBlbmQgLSBzdGFy
dCArIDEpOworCQlpZiAodGhpcy5yZXNvbHZlQmluZGluZ3MpIHsKKwkJCXJlY29yZE5vZGVzKHNp
bXBsZVR5cGUsIHR5cGVSZWZlcmVuY2UpOworCQl9CisJCXJldHVybiBzaW1wbGVUeXBlOworCX0K
KworCXByaXZhdGUgdm9pZCBzZXRTb3VyY2VSYW5nZUFubm90YXRpb25zQW5kUmVjb3JkTm9kZXMo
VHlwZVJlZmVyZW5jZSB0eXBlUmVmZXJlbmNlLCAKKwkJCW9yZy5lY2xpcHNlLmpkdC5pbnRlcm5h
bC5jb21waWxlci5hc3QuQW5ub3RhdGlvbltdW10gdHlwZUFubm90YXRpb25zLCBpbnQgaW5kZXgs
IGludCBzdGFydCwgaW50IGVuZCwKKwkJCUFubm90YXRhYmxlVHlwZSBhbm5vdGF0YWJsZVR5cGUp
IHsKKwkJb3JnLmVjbGlwc2UuamR0LmludGVybmFsLmNvbXBpbGVyLmFzdC5Bbm5vdGF0aW9uW10g
YW5ub3RhdGlvbnM7CisJCWludCBhbm5vdGF0aW9uc1N0YXJ0ID0gc3RhcnQ7CisJCWludCBsZW5n
dGggPSBlbmQgLSBzdGFydCArIDE7CisJCWlmICh0eXBlQW5ub3RhdGlvbnMgIT0gbnVsbCAmJiAo
YW5ub3RhdGlvbnMgPSB0eXBlQW5ub3RhdGlvbnNbaW5kZXhdKSAhPSBudWxsKSB7CisJCQlhbm5v
dGF0ZVR5cGUoYW5ub3RhdGFibGVUeXBlLCBhbm5vdGF0aW9ucyk7CisJCQlpZiAoYW5ub3RhdGlv
bnNbMF0gIT0gbnVsbCAmJiAoYW5ub3RhdGlvbnNTdGFydCA9IGFubm90YXRpb25zWzBdLnNvdXJj
ZVN0YXJ0KSA8IHN0YXJ0KSB7CisJCQkJbGVuZ3RoICs9IGFubm90YXRpb25zU3RhcnQgPiAwID8g
c3RhcnQgLSBhbm5vdGF0aW9uc1N0YXJ0IDogMDsKKwkJCQlzdGFydCA9IGFubm90YXRpb25zU3Rh
cnQ7CisJCQl9CisJCX0KKwkJYW5ub3RhdGFibGVUeXBlLnNldFNvdXJjZVJhbmdlKHN0YXJ0LCBs
ZW5ndGgpOworCQlpZiAodGhpcy5yZXNvbHZlQmluZGluZ3MpIHsKKwkJCXJlY29yZE5vZGVzKGFu
bm90YXRhYmxlVHlwZSwgdHlwZVJlZmVyZW5jZSk7CisJCX0KKwl9CisKKwlwcml2YXRlIHZvaWQg
c2V0U291cmNlUmFuZ2VBbm5vdGF0aW9uc0FuZFJlY29yZE5vZGVzKFR5cGVSZWZlcmVuY2UgdHlw
ZVJlZmVyZW5jZSwgbG9uZ1tdIHBvc2l0aW9ucywKKwkJCW9yZy5lY2xpcHNlLmpkdC5pbnRlcm5h
bC5jb21waWxlci5hc3QuQW5ub3RhdGlvbltdW10gdHlwZUFubm90YXRpb25zLCBpbnQgaW5kZXgs
IGludCBzdGFydEluZGV4LCBpbnQgZW5kSW5kZXgsCisJCQlBbm5vdGF0YWJsZVR5cGUgYW5ub3Rh
dGFibGVUeXBlKSB7CisJCWludCBzdGFydCA9IChpbnQpIChwb3NpdGlvbnNbc3RhcnRJbmRleF0g
Pj4+IDMyKTsKKwkJaW50IGVuZCA9IChpbnQpIHBvc2l0aW9uc1tlbmRJbmRleF07CisJCXNldFNv
dXJjZVJhbmdlQW5ub3RhdGlvbnNBbmRSZWNvcmROb2Rlcyh0eXBlUmVmZXJlbmNlLCB0eXBlQW5u
b3RhdGlvbnMsIGluZGV4LCBzdGFydCwgZW5kLCBhbm5vdGF0YWJsZVR5cGUpOworCX0KKworCXBy
aXZhdGUgU2ltcGxlTmFtZSBjcmVhdGVTaW1wbGVOYW1lKFR5cGVSZWZlcmVuY2UgdHlwZVJlZmVy
ZW5jZSwgbG9uZ1tdIHBvc2l0aW9ucywgY2hhcltdW10gdG9rZW5zLCBpbnQgaW5kZXgpIHsKKwkJ
ZmluYWwgU2ltcGxlTmFtZSBzaW1wbGVOYW1lID0gbmV3IFNpbXBsZU5hbWUodGhpcy5hc3QpOwor
CQlzaW1wbGVOYW1lLmludGVybmFsU2V0SWRlbnRpZmllcihuZXcgU3RyaW5nKHRva2Vuc1tpbmRl
eF0pKTsKKwkJcmVjb3JkUGVuZGluZ05hbWVTY29wZVJlc29sdXRpb24oc2ltcGxlTmFtZSk7CisJ
CWludCBzdGFydCA9IChpbnQpIChwb3NpdGlvbnNbaW5kZXhdID4+PiAzMik7CisJCWludCBlbmQg
PSAoaW50KSBwb3NpdGlvbnNbaW5kZXhdOworCQlzaW1wbGVOYW1lLnNldFNvdXJjZVJhbmdlKHN0
YXJ0LCBlbmQgLSBzdGFydCArIDEpOworCQlzaW1wbGVOYW1lLmluZGV4ID0gaW5kZXggKyAxOwor
CQlpZiAodGhpcy5yZXNvbHZlQmluZGluZ3MpIHsKKwkJCXJlY29yZE5vZGVzKHNpbXBsZU5hbWUs
IHR5cGVSZWZlcmVuY2UpOworCQl9CisJCXJldHVybiBzaW1wbGVOYW1lOworCX0KKwogCXByb3Rl
Y3RlZCBDb21tZW50IGNyZWF0ZUNvbW1lbnQoaW50W10gcG9zaXRpb25zKSB7CiAJCS8vIENyZWF0
ZSBjb21tZW50IG5vZGUKIAkJQ29tbWVudCBjb21tZW50ID0gbnVsbDsKZGlmZiAtLWdpdCBhL29y
Zy5lY2xpcHNlLmpkdC5jb3JlL2RvbS9vcmcvZWNsaXBzZS9qZHQvY29yZS9kb20vQVNUTWF0Y2hl
ci5qYXZhIGIvb3JnLmVjbGlwc2UuamR0LmNvcmUvZG9tL29yZy9lY2xpcHNlL2pkdC9jb3JlL2Rv
bS9BU1RNYXRjaGVyLmphdmEKaW5kZXggNGU4MTY2MC4uZDYzMTM3MiAxMDA2NDQKLS0tIGEvb3Jn
LmVjbGlwc2UuamR0LmNvcmUvZG9tL29yZy9lY2xpcHNlL2pkdC9jb3JlL2RvbS9BU1RNYXRjaGVy
LmphdmEKKysrIGIvb3JnLmVjbGlwc2UuamR0LmNvcmUvZG9tL29yZy9lY2xpcHNlL2pkdC9jb3Jl
L2RvbS9BU1RNYXRjaGVyLmphdmEKQEAgLTE1OTIsNiArMTU5MiwzMSBAQAogCSAqIEByZXR1cm4g
PGNvZGU+dHJ1ZTwvY29kZT4gaWYgdGhlIHN1YnRyZWUgbWF0Y2hlcywgb3IKIAkgKiAgIDxjb2Rl
PmZhbHNlPC9jb2RlPiBpZiB0aGV5IGRvIG5vdCBtYXRjaCBvciB0aGUgb3RoZXIgb2JqZWN0IGhh
cyBhCiAJICogICBkaWZmZXJlbnQgbm9kZSB0eXBlIG9yIGlzIDxjb2RlPm51bGw8L2NvZGU+CisJ
ICogQHNpbmNlIDMuOSBCRVRBX0pBVkE4CisJICovCisJcHVibGljIGJvb2xlYW4gbWF0Y2goUGFj
a2FnZVF1YWxpZmllZFR5cGUgbm9kZSwgT2JqZWN0IG90aGVyKSB7CisJCWlmICghKG90aGVyIGlu
c3RhbmNlb2YgUGFja2FnZVF1YWxpZmllZFR5cGUpKSB7CisJCQlyZXR1cm4gZmFsc2U7CisJCX0K
KwkJUGFja2FnZVF1YWxpZmllZFR5cGUgbyA9IChQYWNrYWdlUXVhbGlmaWVkVHlwZSkgb3RoZXI7
CisJCXJldHVybiBzYWZlU3VidHJlZU1hdGNoKG5vZGUuZ2V0UXVhbGlmaWVyKCksIG8uZ2V0UXVh
bGlmaWVyKCkpCisJCQkJJiYgc2FmZVN1YnRyZWVMaXN0TWF0Y2gobm9kZS5hbm5vdGF0aW9ucygp
LCBvLmFubm90YXRpb25zKCkpCisJCQkJJiYgc2FmZVN1YnRyZWVNYXRjaChub2RlLmdldE5hbWUo
KSwgby5nZXROYW1lKCkpOworCX0KKworCS8qKgorCSAqIFJldHVybnMgd2hldGhlciB0aGUgZ2l2
ZW4gbm9kZSBhbmQgdGhlIG90aGVyIG9iamVjdCBtYXRjaC4KKwkgKiA8cD4KKwkgKiBUaGUgZGVm
YXVsdCBpbXBsZW1lbnRhdGlvbiBwcm92aWRlZCBieSB0aGlzIGNsYXNzIHRlc3RzIHdoZXRoZXIg
dGhlCisJICogb3RoZXIgb2JqZWN0IGlzIGEgbm9kZSBvZiB0aGUgc2FtZSB0eXBlIHdpdGggc3Ry
dWN0dXJhbGx5IGlzb21vcnBoaWMKKwkgKiBjaGlsZCBzdWJ0cmVlcy4gU3ViY2xhc3NlcyBtYXkg
b3ZlcnJpZGUgdGhpcyBtZXRob2QgYXMgbmVlZGVkLgorCSAqIDwvcD4KKwkgKgorCSAqIEBwYXJh
bSBub2RlIHRoZSBub2RlCisJICogQHBhcmFtIG90aGVyIHRoZSBvdGhlciBvYmplY3QsIG9yIDxj
b2RlPm51bGw8L2NvZGU+CisJICogQHJldHVybiA8Y29kZT50cnVlPC9jb2RlPiBpZiB0aGUgc3Vi
dHJlZSBtYXRjaGVzLCBvcgorCSAqICAgPGNvZGU+ZmFsc2U8L2NvZGU+IGlmIHRoZXkgZG8gbm90
IG1hdGNoIG9yIHRoZSBvdGhlciBvYmplY3QgaGFzIGEKKwkgKiAgIGRpZmZlcmVudCBub2RlIHR5
cGUgb3IgaXMgPGNvZGU+bnVsbDwvY29kZT4KIAkgKiBAc2luY2UgMy4xCiAJICovCiAJcHVibGlj
IGJvb2xlYW4gbWF0Y2goUGFyYW1ldGVyaXplZFR5cGUgbm9kZSwgT2JqZWN0IG90aGVyKSB7CmRp
ZmYgLS1naXQgYS9vcmcuZWNsaXBzZS5qZHQuY29yZS9kb20vb3JnL2VjbGlwc2UvamR0L2NvcmUv
ZG9tL0FTVE5vZGUuamF2YSBiL29yZy5lY2xpcHNlLmpkdC5jb3JlL2RvbS9vcmcvZWNsaXBzZS9q
ZHQvY29yZS9kb20vQVNUTm9kZS5qYXZhCmluZGV4IDNlYmQ2ZmYuLjJhODc1NjEgMTAwNjQ0Ci0t
LSBhL29yZy5lY2xpcHNlLmpkdC5jb3JlL2RvbS9vcmcvZWNsaXBzZS9qZHQvY29yZS9kb20vQVNU
Tm9kZS5qYXZhCisrKyBiL29yZy5lY2xpcHNlLmpkdC5jb3JlL2RvbS9vcmcvZWNsaXBzZS9qZHQv
Y29yZS9kb20vQVNUTm9kZS5qYXZhCkBAIC04NjAsNiArODYwLDE0IEBACiAJcHVibGljIHN0YXRp
YyBmaW5hbCBpbnQgSU5URVJTRUNUSU9OX1RZUEUgPSA4NzsKIAogCS8qKgorCSAqIE5vZGUgdHlw
ZSBjb25zdGFudCBpbmRpY2F0aW5nIGEgbm9kZSBvZiB0eXBlCisJICogPGNvZGU+UXVhbGlmaWVk
VHlwZTwvY29kZT4uCisJICogQHNlZSBRdWFsaWZpZWRUeXBlCisJICogQHNpbmNlIDMuOSBCRVRB
X0pBVjgKKwkgKi8KKwlwdWJsaWMgc3RhdGljIGZpbmFsIGludCBQQUNLQUdFX1FVQUxJRklFRF9U
WVBFID0gODg7CisKKwkvKioKIAkgKiBSZXR1cm5zIHRoZSBub2RlIGNsYXNzIGZvciB0aGUgY29y
cmVzcG9uZGluZyBub2RlIHR5cGUuCiAJICoKIAkgKiBAcGFyYW0gbm9kZVR5cGUgQVNUIG5vZGUg
dHlwZQpAQCAtOTc5LDYgKzk4Nyw4IEBACiAJCQkJcmV0dXJuIE51bWJlckxpdGVyYWwuY2xhc3M7
CiAJCQljYXNlIFBBQ0tBR0VfREVDTEFSQVRJT04gOgogCQkJCXJldHVybiBQYWNrYWdlRGVjbGFy
YXRpb24uY2xhc3M7CisJCQljYXNlIFBBQ0tBR0VfUVVBTElGSUVEX1RZUEUgOgorCQkJCXJldHVy
biBQYWNrYWdlUXVhbGlmaWVkVHlwZS5jbGFzczsKIAkJCWNhc2UgUEFSQU1FVEVSSVpFRF9UWVBF
IDoKIAkJCQlyZXR1cm4gUGFyYW1ldGVyaXplZFR5cGUuY2xhc3M7CiAJCQljYXNlIFBBUkVOVEhF
U0laRURfRVhQUkVTU0lPTiA6CmRpZmYgLS1naXQgYS9vcmcuZWNsaXBzZS5qZHQuY29yZS9kb20v
b3JnL2VjbGlwc2UvamR0L2NvcmUvZG9tL0FTVFZpc2l0b3IuamF2YSBiL29yZy5lY2xpcHNlLmpk
dC5jb3JlL2RvbS9vcmcvZWNsaXBzZS9qZHQvY29yZS9kb20vQVNUVmlzaXRvci5qYXZhCmluZGV4
IGZlMDg1ODEuLmQ1MTlmMmEgMTAwNjQ0Ci0tLSBhL29yZy5lY2xpcHNlLmpkdC5jb3JlL2RvbS9v
cmcvZWNsaXBzZS9qZHQvY29yZS9kb20vQVNUVmlzaXRvci5qYXZhCisrKyBiL29yZy5lY2xpcHNl
LmpkdC5jb3JlL2RvbS9vcmcvZWNsaXBzZS9qZHQvY29yZS9kb20vQVNUVmlzaXRvci5qYXZhCkBA
IC0xMDg5LDYgKzEwODksMjMgQEAKIAkgKiBAcmV0dXJuIDxjb2RlPnRydWU8L2NvZGU+IGlmIHRo
ZSBjaGlsZHJlbiBvZiB0aGlzIG5vZGUgc2hvdWxkIGJlCiAJICogdmlzaXRlZCwgYW5kIDxjb2Rl
PmZhbHNlPC9jb2RlPiBpZiB0aGUgY2hpbGRyZW4gb2YgdGhpcyBub2RlIHNob3VsZAogCSAqIGJl
IHNraXBwZWQKKwkgKiBAc2luY2UgMy45IEJFVEFfSkFWQTgKKwkgKi8KKwlwdWJsaWMgYm9vbGVh
biB2aXNpdChQYWNrYWdlUXVhbGlmaWVkVHlwZSBub2RlKSB7CisJCXJldHVybiB0cnVlOworCX0K
KworCS8qKgorCSAqIFZpc2l0cyB0aGUgZ2l2ZW4gdHlwZS1zcGVjaWZpYyBBU1Qgbm9kZS4KKwkg
KiA8cD4KKwkgKiBUaGUgZGVmYXVsdCBpbXBsZW1lbnRhdGlvbiBkb2VzIG5vdGhpbmcgYW5kIHJl
dHVybiB0cnVlLgorCSAqIFN1YmNsYXNzZXMgbWF5IHJlaW1wbGVtZW50LgorCSAqIDwvcD4KKwkg
KgorCSAqIEBwYXJhbSBub2RlIHRoZSBub2RlIHRvIHZpc2l0CisJICogQHJldHVybiA8Y29kZT50
cnVlPC9jb2RlPiBpZiB0aGUgY2hpbGRyZW4gb2YgdGhpcyBub2RlIHNob3VsZCBiZQorCSAqIHZp
c2l0ZWQsIGFuZCA8Y29kZT5mYWxzZTwvY29kZT4gaWYgdGhlIGNoaWxkcmVuIG9mIHRoaXMgbm9k
ZSBzaG91bGQKKwkgKiBiZSBza2lwcGVkCiAJICogQHNpbmNlIDMuMQogCSAqLwogCXB1YmxpYyBi
b29sZWFuIHZpc2l0KFBhcmFtZXRlcml6ZWRUeXBlIG5vZGUpIHsKQEAgLTIyOTEsNiArMjMwOCwx
OSBAQAogCSAqIDwvcD4KIAkgKgogCSAqIEBwYXJhbSBub2RlIHRoZSBub2RlIHRvIHZpc2l0CisJ
ICogQHNpbmNlIDMuOSBCRVRBX0pBVkE4CisJICovCisJcHVibGljIHZvaWQgZW5kVmlzaXQoUGFj
a2FnZVF1YWxpZmllZFR5cGUgbm9kZSkgeworCQkvLyBkZWZhdWx0IGltcGxlbWVudGF0aW9uOiBk
byBub3RoaW5nCisJfQorCisJLyoqCisJICogRW5kIG9mIHZpc2l0IHRoZSBnaXZlbiB0eXBlLXNw
ZWNpZmljIEFTVCBub2RlLgorCSAqIDxwPgorCSAqIFRoZSBkZWZhdWx0IGltcGxlbWVudGF0aW9u
IGRvZXMgbm90aGluZy4gU3ViY2xhc3NlcyBtYXkgcmVpbXBsZW1lbnQuCisJICogPC9wPgorCSAq
CisJICogQHBhcmFtIG5vZGUgdGhlIG5vZGUgdG8gdmlzaXQKIAkgKiBAc2luY2UgMy4xCiAJICov
CiAJcHVibGljIHZvaWQgZW5kVmlzaXQoUGFyYW1ldGVyaXplZFR5cGUgbm9kZSkgewpkaWZmIC0t
Z2l0IGEvb3JnLmVjbGlwc2UuamR0LmNvcmUvZG9tL29yZy9lY2xpcHNlL2pkdC9jb3JlL2RvbS9E
ZWZhdWx0QVNUVmlzaXRvci5qYXZhIGIvb3JnLmVjbGlwc2UuamR0LmNvcmUvZG9tL29yZy9lY2xp
cHNlL2pkdC9jb3JlL2RvbS9EZWZhdWx0QVNUVmlzaXRvci5qYXZhCmluZGV4IGE2ZWY0NDEuLjUx
ZjJiZjQgMTAwNjQ0Ci0tLSBhL29yZy5lY2xpcHNlLmpkdC5jb3JlL2RvbS9vcmcvZWNsaXBzZS9q
ZHQvY29yZS9kb20vRGVmYXVsdEFTVFZpc2l0b3IuamF2YQorKysgYi9vcmcuZWNsaXBzZS5qZHQu
Y29yZS9kb20vb3JnL2VjbGlwc2UvamR0L2NvcmUvZG9tL0RlZmF1bHRBU1RWaXNpdG9yLmphdmEK
QEAgLTE4OCw2ICsxODgsOSBAQAogCXB1YmxpYyB2b2lkIGVuZFZpc2l0KFBhY2thZ2VEZWNsYXJh
dGlvbiBub2RlKSB7CiAJCWVuZFZpc2l0Tm9kZShub2RlKTsKIAl9CisJcHVibGljIHZvaWQgZW5k
VmlzaXQoUGFja2FnZVF1YWxpZmllZFR5cGUgbm9kZSkgeworCQllbmRWaXNpdE5vZGUobm9kZSk7
CisJfQogCXB1YmxpYyB2b2lkIGVuZFZpc2l0KFBhcmFtZXRlcml6ZWRUeXBlIG5vZGUpIHsKIAkJ
ZW5kVmlzaXROb2RlKG5vZGUpOwogCX0KQEAgLTQ2MCw2ICs0NjMsOSBAQAogCXB1YmxpYyBib29s
ZWFuIHZpc2l0KFBhY2thZ2VEZWNsYXJhdGlvbiBub2RlKSB7CiAJCXJldHVybiB2aXNpdE5vZGUo
bm9kZSk7CiAJfQorCXB1YmxpYyBib29sZWFuIHZpc2l0KFBhY2thZ2VRdWFsaWZpZWRUeXBlIG5v
ZGUpIHsKKwkJcmV0dXJuIHZpc2l0Tm9kZShub2RlKTsKKwl9CiAJcHVibGljIGJvb2xlYW4gdmlz
aXQoUGFyYW1ldGVyaXplZFR5cGUgbm9kZSkgewogCQlyZXR1cm4gdmlzaXROb2RlKG5vZGUpOwog
CX0KZGlmZiAtLWdpdCBhL29yZy5lY2xpcHNlLmpkdC5jb3JlL2RvbS9vcmcvZWNsaXBzZS9qZHQv
Y29yZS9kb20vUGFja2FnZVF1YWxpZmllZFR5cGUuamF2YSBiL29yZy5lY2xpcHNlLmpkdC5jb3Jl
L2RvbS9vcmcvZWNsaXBzZS9qZHQvY29yZS9kb20vUGFja2FnZVF1YWxpZmllZFR5cGUuamF2YQpu
ZXcgZmlsZSBtb2RlIDEwMDY0NAppbmRleCAwMDAwMDAwLi4xNzMwNTNkCi0tLSAvZGV2L251bGwK
KysrIGIvb3JnLmVjbGlwc2UuamR0LmNvcmUvZG9tL29yZy9lY2xpcHNlL2pkdC9jb3JlL2RvbS9Q
YWNrYWdlUXVhbGlmaWVkVHlwZS5qYXZhCkBAIC0wLDAgKzEsMjg1IEBACisvKioqKioqKioqKioq
KioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioq
KioqKioqKioqKgorICogQ29weXJpZ2h0IChjKSAyMDAzLCAyMDEzIElCTSBDb3Jwb3JhdGlvbiBh
bmQgb3RoZXJzLgorICogQWxsIHJpZ2h0cyByZXNlcnZlZC4gVGhpcyBwcm9ncmFtIGFuZCB0aGUg
YWNjb21wYW55aW5nIG1hdGVyaWFscworICogYXJlIG1hZGUgYXZhaWxhYmxlIHVuZGVyIHRoZSB0
ZXJtcyBvZiB0aGUgRWNsaXBzZSBQdWJsaWMgTGljZW5zZSB2MS4wCisgKiB3aGljaCBhY2NvbXBh
bmllcyB0aGlzIGRpc3RyaWJ1dGlvbiwgYW5kIGlzIGF2YWlsYWJsZSBhdAorICogaHR0cDovL3d3
dy5lY2xpcHNlLm9yZy9sZWdhbC9lcGwtdjEwLmh0bWwKKyAqCisgKiBUaGlzIGlzIGFuIGltcGxl
bWVudGF0aW9uIG9mIGFuIGVhcmx5LWRyYWZ0IHNwZWNpZmljYXRpb24gZGV2ZWxvcGVkIHVuZGVy
IHRoZSBKYXZhCisgKiBDb21tdW5pdHkgUHJvY2VzcyAoSkNQKSBhbmQgaXMgbWFkZSBhdmFpbGFi
bGUgZm9yIHRlc3RpbmcgYW5kIGV2YWx1YXRpb24gcHVycG9zZXMKKyAqIG9ubHkuIFRoZSBjb2Rl
IGlzIG5vdCBjb21wYXRpYmxlIHdpdGggYW55IHNwZWNpZmljYXRpb24gb2YgdGhlIEpDUC4KKyAq
IAorICogQ29udHJpYnV0b3JzOgorICogICAgIElCTSBDb3Jwb3JhdGlvbiAtIGluaXRpYWwgQVBJ
IGFuZCBpbXBsZW1lbnRhdGlvbgorICoqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioq
KioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKiovCisKK3BhY2thZ2Ug
b3JnLmVjbGlwc2UuamR0LmNvcmUuZG9tOworCitpbXBvcnQgamF2YS51dGlsLkFycmF5TGlzdDsK
K2ltcG9ydCBqYXZhLnV0aWwuTGlzdDsKKworLyoqCisgKiBOb2RlIGZvciBhIHBhY2thZ2UgcXVh
bGlmaWVkIHR5cGUgKGFkZGVkIGluIEpMUzggQVBJKS4KKyAqIAorICogPHByZT4KKyAqIFBhY2th
Z2VRdWFsaWZpZWRUeXBlOgorICogICAgTmFtZSA8Yj4uPC9iPiB7IEFubm90YXRpb24gfSBTaW1w
bGVOYW1lCisgKiA8L3ByZT4KKyAqCisgKiBAc2luY2UgMy45IEJFVEFfSkFWQTgKKyAqIEBub2lu
c3RhbnRpYXRlIFRoaXMgY2xhc3MgaXMgbm90IGludGVuZGVkIHRvIGJlIGluc3RhbnRpYXRlZCBi
eSBjbGllbnRzLgorICovCitwdWJsaWMgY2xhc3MgUGFja2FnZVF1YWxpZmllZFR5cGUgZXh0ZW5k
cyBBbm5vdGF0YWJsZVR5cGUgeworCisJLyoqCisJICogVGhlICJxdWFsaWZpZXIiIHN0cnVjdHVy
YWwgcHJvcGVydHkgb2YgdGhpcyBub2RlIHR5cGUgKGNoaWxkIHR5cGU6IHtAbGluayBOYW1lfSku
CisJICovCisJcHVibGljIHN0YXRpYyBmaW5hbCBDaGlsZFByb3BlcnR5RGVzY3JpcHRvciBRVUFM
SUZJRVJfUFJPUEVSVFkgPQorCQluZXcgQ2hpbGRQcm9wZXJ0eURlc2NyaXB0b3IoUGFja2FnZVF1
YWxpZmllZFR5cGUuY2xhc3MsICJxdWFsaWZpZXIiLCBOYW1lLmNsYXNzLCBNQU5EQVRPUlksIE5P
X0NZQ0xFX1JJU0spOyAvLyROT04tTkxTLTEkCisKKwkvKioKKwkgKiBUaGUgImFubm90YXRpb25z
IiBzdHJ1Y3R1cmFsIHByb3BlcnR5IG9mIHRoaXMgbm9kZSB0eXBlIChlbGVtZW50IHR5cGU6IHtA
bGluayBBbm5vdGF0aW9ufSkuCisJICovCisJcHVibGljIHN0YXRpYyBmaW5hbCBDaGlsZExpc3RQ
cm9wZXJ0eURlc2NyaXB0b3IgQU5OT1RBVElPTlNfUFJPUEVSVFkgPQorCQkJaW50ZXJuYWxBbm5v
dGF0aW9uc1Byb3BlcnR5RmFjdG9yeShQYWNrYWdlUXVhbGlmaWVkVHlwZS5jbGFzcyk7CisJCisJ
LyoqCisJICogVGhlICJuYW1lIiBzdHJ1Y3R1cmFsIHByb3BlcnR5IG9mIHRoaXMgbm9kZSB0eXBl
IChjaGlsZCB0eXBlOiB7QGxpbmsgU2ltcGxlTmFtZX0pLgorCSAqLworCXB1YmxpYyBzdGF0aWMg
ZmluYWwgQ2hpbGRQcm9wZXJ0eURlc2NyaXB0b3IgTkFNRV9QUk9QRVJUWSA9CisJCW5ldyBDaGls
ZFByb3BlcnR5RGVzY3JpcHRvcihQYWNrYWdlUXVhbGlmaWVkVHlwZS5jbGFzcywgIm5hbWUiLCBT
aW1wbGVOYW1lLmNsYXNzLCBNQU5EQVRPUlksIE5PX0NZQ0xFX1JJU0spOyAvLyROT04tTkxTLTEk
CisJCisJLyoqCisJICogQSBsaXN0IG9mIHByb3BlcnR5IGRlc2NyaXB0b3JzIChlbGVtZW50IHR5
cGU6CisJICoge0BsaW5rIFN0cnVjdHVyYWxQcm9wZXJ0eURlc2NyaXB0b3J9KSwKKwkgKiBvciBu
dWxsIGlmIHVuaW5pdGlhbGl6ZWQuCisJICovCisJcHJpdmF0ZSBzdGF0aWMgZmluYWwgTGlzdCBQ
Uk9QRVJUWV9ERVNDUklQVE9SUzsKKworCXN0YXRpYyB7CisJCUxpc3QgcHJvcGVydHlMaXN0ID0g
bmV3IEFycmF5TGlzdCg0KTsKKwkJY3JlYXRlUHJvcGVydHlMaXN0KFBhY2thZ2VRdWFsaWZpZWRU
eXBlLmNsYXNzLCBwcm9wZXJ0eUxpc3QpOworCQlhZGRQcm9wZXJ0eShRVUFMSUZJRVJfUFJPUEVS
VFksIHByb3BlcnR5TGlzdCk7CisJCWFkZFByb3BlcnR5KEFOTk9UQVRJT05TX1BST1BFUlRZLCBw
cm9wZXJ0eUxpc3QpOworCQlhZGRQcm9wZXJ0eShOQU1FX1BST1BFUlRZLCBwcm9wZXJ0eUxpc3Qp
OworCQlQUk9QRVJUWV9ERVNDUklQVE9SUyA9IHJlYXBQcm9wZXJ0eUxpc3QocHJvcGVydHlMaXN0
KTsKKwl9CisKKwkvKioKKwkgKiBSZXR1cm5zIGEgbGlzdCBvZiBzdHJ1Y3R1cmFsIHByb3BlcnR5
IGRlc2NyaXB0b3JzIGZvciB0aGlzIG5vZGUgdHlwZS4KKwkgKiBDbGllbnRzIG11c3Qgbm90IG1v
ZGlmeSB0aGUgcmVzdWx0LgorCSAqCisJICogQHBhcmFtIGFwaUxldmVsIHRoZSBBUEkgbGV2ZWw7
IG9uZSBvZiB0aGUKKwkgKiA8Y29kZT5BU1QuSkxTKjwvY29kZT4gY29uc3RhbnRzCisJICogQHJl
dHVybiBhIGxpc3Qgb2YgcHJvcGVydHkgZGVzY3JpcHRvcnMgKGVsZW1lbnQgdHlwZToKKwkgKiB7
QGxpbmsgU3RydWN0dXJhbFByb3BlcnR5RGVzY3JpcHRvcn0pCisJICovCisJcHVibGljIHN0YXRp
YyBMaXN0IHByb3BlcnR5RGVzY3JpcHRvcnMoaW50IGFwaUxldmVsKSB7CisJCXJldHVybiBQUk9Q
RVJUWV9ERVNDUklQVE9SUzsKKwl9CisKKwkvKioKKwkgKiBUaGUgcXVhbGlmaWVyIG5vZGU7IGxh
emlseSBpbml0aWFsaXplZDsgZGVmYXVsdHMgdG8gCisJICogYW4gdW5zcGVjaWZpZWQsIGJ1dCBs
ZWdhbCwgc2ltcGxlIG5hbWUuCisJICovCisJcHJpdmF0ZSBOYW1lIHF1YWxpZmllciA9IG51bGw7
CisKKwkvKioKKwkgKiBUaGUgbmFtZSBiZWluZyBxdWFsaWZpZWQ7IGxhemlseSBpbml0aWFsaXpl
ZDsgZGVmYXVsdHMgdG8gYSB1bnNwZWNpZmllZCwKKwkgKiBsZWdhbCBKYXZhIGlkZW50aWZpZXIu
CisJICovCisJcHJpdmF0ZSBTaW1wbGVOYW1lIG5hbWUgPSBudWxsOworCisJLyoqCisJICogQ3Jl
YXRlcyBhIG5ldyB1bnBhcmVudGVkIG5vZGUgZm9yIGEgcGFja2FnZSBxdWFsaWZpZWQgdHlwZSBv
d25lZCBieSB0aGUKKwkgKiBnaXZlbiBBU1QuIEJ5IGRlZmF1bHQsIGFuIHVuc3BlY2lmaWVkLCBi
dXQgbGVnYWwsIHF1YWxpZmllciBhbmQgbmFtZS4KKwkgKiA8cD4KKwkgKiBOLkIuIFRoaXMgY29u
c3RydWN0b3IgaXMgcGFja2FnZS1wcml2YXRlLgorCSAqIDwvcD4KKwkgKgorCSAqIEBwYXJhbSBh
c3QgdGhlIEFTVCB0aGF0IGlzIHRvIG93biB0aGlzIG5vZGUKKwkgKi8KKwlQYWNrYWdlUXVhbGlm
aWVkVHlwZShBU1QgYXN0KSB7CisJCXN1cGVyKGFzdCk7CisJICAgIHVuc3VwcG9ydGVkSW4yXzNf
NCgpOworCX0KKworCS8qIChvbWl0IGphdmFkb2MgZm9yIHRoaXMgbWV0aG9kKQorCSAqIE1ldGhv
ZCBkZWNsYXJlZCBvbiBBbm5vdGF0YWJsZVR5cGUuCisJICovCisJQ2hpbGRMaXN0UHJvcGVydHlE
ZXNjcmlwdG9yIGludGVybmFsQW5ub3RhdGlvbnNQcm9wZXJ0eSgpIHsKKwkJcmV0dXJuIEFOTk9U
QVRJT05TX1BST1BFUlRZOworCX0KKworCS8qIChvbWl0IGphdmFkb2MgZm9yIHRoaXMgbWV0aG9k
KQorCSAqIE1ldGhvZCBkZWNsYXJlZCBvbiBBU1ROb2RlLgorCSAqLworCUxpc3QgaW50ZXJuYWxT
dHJ1Y3R1cmFsUHJvcGVydGllc0ZvclR5cGUoaW50IGFwaUxldmVsKSB7CisJCXJldHVybiBwcm9w
ZXJ0eURlc2NyaXB0b3JzKGFwaUxldmVsKTsKKwl9CisKKwkvKiAob21pdCBqYXZhZG9jIGZvciB0
aGlzIG1ldGhvZCkKKwkgKiBNZXRob2QgZGVjbGFyZWQgb24gQVNUTm9kZS4KKwkgKi8KKwlmaW5h
bCBMaXN0IGludGVybmFsR2V0Q2hpbGRMaXN0UHJvcGVydHkoQ2hpbGRMaXN0UHJvcGVydHlEZXNj
cmlwdG9yIHByb3BlcnR5KSB7CisJCWlmIChwcm9wZXJ0eSA9PSBBTk5PVEFUSU9OU19QUk9QRVJU
WSkgeworCQkJcmV0dXJuIGFubm90YXRpb25zKCk7CisJCX0KKwkJLy8gYWxsb3cgZGVmYXVsdCBp
bXBsZW1lbnRhdGlvbiB0byBmbGFnIHRoZSBlcnJvcgorCQlyZXR1cm4gc3VwZXIuaW50ZXJuYWxH
ZXRDaGlsZExpc3RQcm9wZXJ0eShwcm9wZXJ0eSk7CisJfQorCQorCS8qIChvbWl0IGphdmFkb2Mg
Zm9yIHRoaXMgbWV0aG9kKQorCSAqIE1ldGhvZCBkZWNsYXJlZCBvbiBBU1ROb2RlLgorCSAqLwor
CWZpbmFsIEFTVE5vZGUgaW50ZXJuYWxHZXRTZXRDaGlsZFByb3BlcnR5KENoaWxkUHJvcGVydHlE
ZXNjcmlwdG9yIHByb3BlcnR5LCBib29sZWFuIGdldCwgQVNUTm9kZSBjaGlsZCkgeworCQlpZiAo
cHJvcGVydHkgPT0gUVVBTElGSUVSX1BST1BFUlRZKSB7CisJCQlpZiAoZ2V0KSB7CisJCQkJcmV0
dXJuIGdldFF1YWxpZmllcigpOworCQkJfSBlbHNlIHsKKwkJCQlzZXRRdWFsaWZpZXIoKE5hbWUp
IGNoaWxkKTsKKwkJCQlyZXR1cm4gbnVsbDsKKwkJCX0KKwkJfQorCQlpZiAocHJvcGVydHkgPT0g
TkFNRV9QUk9QRVJUWSkgeworCQkJaWYgKGdldCkgeworCQkJCXJldHVybiBnZXROYW1lKCk7CisJ
CQl9IGVsc2UgeworCQkJCXNldE5hbWUoKFNpbXBsZU5hbWUpIGNoaWxkKTsKKwkJCQlyZXR1cm4g
bnVsbDsKKwkJCX0KKwkJfQorCQkvLyBhbGxvdyBkZWZhdWx0IGltcGxlbWVudGF0aW9uIHRvIGZs
YWcgdGhlIGVycm9yCisJCXJldHVybiBzdXBlci5pbnRlcm5hbEdldFNldENoaWxkUHJvcGVydHko
cHJvcGVydHksIGdldCwgY2hpbGQpOworCX0KKworCWludCBnZXROb2RlVHlwZTAoKSB7CisJCXJl
dHVybiBQQUNLQUdFX1FVQUxJRklFRF9UWVBFOworCX0KKworCWJvb2xlYW4gc3VidHJlZU1hdGNo
MChBU1RNYXRjaGVyIG1hdGNoZXIsIE9iamVjdCBvdGhlcikgeworCQkvLyBkaXNwYXRjaCB0byBj
b3JyZWN0IG92ZXJsb2FkZWQgbWF0Y2ggbWV0aG9kCisJCXJldHVybiBtYXRjaGVyLm1hdGNoKHRo
aXMsIG90aGVyKTsKKwl9CisKKwlBU1ROb2RlIGNsb25lMChBU1QgdGFyZ2V0KSB7CisJCVBhY2th
Z2VRdWFsaWZpZWRUeXBlIHJlc3VsdCA9IG5ldyBQYWNrYWdlUXVhbGlmaWVkVHlwZSh0YXJnZXQp
OworCQlyZXN1bHQuc2V0U291cmNlUmFuZ2UoZ2V0U3RhcnRQb3NpdGlvbigpLCBnZXRMZW5ndGgo
KSk7CisJCXJlc3VsdC5zZXRRdWFsaWZpZXIoKE5hbWUpICgoQVNUTm9kZSkgZ2V0UXVhbGlmaWVy
KCkpLmNsb25lKHRhcmdldCkpOworCQlyZXN1bHQuYW5ub3RhdGlvbnMoKS5hZGRBbGwoQVNUTm9k
ZS5jb3B5U3VidHJlZXModGFyZ2V0LCBhbm5vdGF0aW9ucygpKSk7CisJCXJlc3VsdC5zZXROYW1l
KChTaW1wbGVOYW1lKSAoKEFTVE5vZGUpIGdldE5hbWUoKSkuY2xvbmUodGFyZ2V0KSk7CisJCXJl
dHVybiByZXN1bHQ7CisJfQorCisJLyogKG9taXQgamF2YWRvYyBmb3IgdGhpcyBtZXRob2QpCisJ
ICogTWV0aG9kIGRlY2xhcmVkIG9uIEFTVE5vZGUuCisJICovCisJdm9pZCBhY2NlcHQwKEFTVFZp
c2l0b3IgdmlzaXRvcikgeworCQlib29sZWFuIHZpc2l0Q2hpbGRyZW4gPSB2aXNpdG9yLnZpc2l0
KHRoaXMpOworCQlpZiAodmlzaXRDaGlsZHJlbikgeworCQkJLy8gdmlzaXQgY2hpbGRyZW4gaW4g
bm9ybWFsIGxlZnQgdG8gcmlnaHQgcmVhZGluZyBvcmRlcgorCQkJYWNjZXB0Q2hpbGQodmlzaXRv
ciwgZ2V0UXVhbGlmaWVyKCkpOworCQkJYWNjZXB0Q2hpbGRyZW4odmlzaXRvciwgdGhpcy5hbm5v
dGF0aW9ucyk7CisJCQlhY2NlcHRDaGlsZCh2aXNpdG9yLCBnZXROYW1lKCkpOworCQl9CisJCXZp
c2l0b3IuZW5kVmlzaXQodGhpcyk7CisJfQorCisJLyoqCisJICogUmV0dXJucyB0aGUgcXVhbGlm
aWVyIG9mIHRoaXMgcGFja2FnZSBxdWFsaWZpZWQgdHlwZS4KKwkgKgorCSAqIEByZXR1cm4gdGhl
IHF1YWxpZmllciBvZiB0aGlzIHBhY2thZ2UgcXVhbGlmaWVkIHR5cGUKKwkgKi8KKwlwdWJsaWMg
TmFtZSBnZXRRdWFsaWZpZXIoKSB7CisJCWlmICh0aGlzLnF1YWxpZmllciA9PSBudWxsKSB7CisJ
CQkvLyBsYXp5IGluaXQgbXVzdCBiZSB0aHJlYWQtc2FmZSBmb3IgcmVhZGVycworCQkJc3luY2hy
b25pemVkICh0aGlzKSB7CisJCQkJaWYgKHRoaXMucXVhbGlmaWVyID09IG51bGwpIHsKKwkJCQkJ
cHJlTGF6eUluaXQoKTsKKwkJCQkJdGhpcy5xdWFsaWZpZXIgPSBuZXcgU2ltcGxlTmFtZSh0aGlz
LmFzdCk7CisJCQkJCXBvc3RMYXp5SW5pdCh0aGlzLnF1YWxpZmllciwgUVVBTElGSUVSX1BST1BF
UlRZKTsKKwkJCQl9CisJCQl9CisJCX0KKwkJcmV0dXJuIHRoaXMucXVhbGlmaWVyOworCX0KKwor
CS8qKgorCSAqIFNldHMgdGhlIHF1YWxpZmllciBvZiB0aGlzIHBhY2thZ2UgcXVhbGlmaWVkIHR5
cGUgdG8gdGhlIGdpdmVuIG5hbWUuCisJICoKKwkgKiBAcGFyYW0gbmFtZSB0aGUgbmV3IHF1YWxp
ZmllciBvZiB0aGlzIHBhY2thZ2UgcXVhbGlmaWVkIHR5cGUKKwkgKiBAZXhjZXB0aW9uIElsbGVn
YWxBcmd1bWVudEV4Y2VwdGlvbiBpZjoKKwkgKiA8dWw+CisJICogPGxpPnRoZSBub2RlIGJlbG9u
Z3MgdG8gYSBkaWZmZXJlbnQgQVNUPC9saT4KKwkgKiA8bGk+dGhlIG5vZGUgYWxyZWFkeSBoYXMg
YSBwYXJlbnQ8L2xpPgorCSAqIDwvdWw+CisJICovCisJcHVibGljIHZvaWQgc2V0UXVhbGlmaWVy
KE5hbWUgbmFtZSkgeworCQlpZiAobmFtZSA9PSBudWxsKSB7CisJCQl0aHJvdyBuZXcgSWxsZWdh
bEFyZ3VtZW50RXhjZXB0aW9uKCk7CisJCX0KKwkJQVNUTm9kZSBvbGRDaGlsZCA9IHRoaXMucXVh
bGlmaWVyOworCQlwcmVSZXBsYWNlQ2hpbGQob2xkQ2hpbGQsIG5hbWUsIFFVQUxJRklFUl9QUk9Q
RVJUWSk7CisJCXRoaXMucXVhbGlmaWVyID0gbmFtZTsKKwkJcG9zdFJlcGxhY2VDaGlsZChvbGRD
aGlsZCwgbmFtZSwgUVVBTElGSUVSX1BST1BFUlRZKTsKKwl9CisKKwkvKioKKwkgKiBSZXR1cm5z
IHRoZSBuYW1lIHBhcnQgb2YgdGhpcyBwYWNrYWdlIHF1YWxpZmllZCB0eXBlLgorCSAqCisJICog
QHJldHVybiB0aGUgbmFtZSBiZWluZyBxdWFsaWZpZWQKKwkgKi8KKwlwdWJsaWMgU2ltcGxlTmFt
ZSBnZXROYW1lKCkgeworCQlpZiAodGhpcy5uYW1lID09IG51bGwpIHsKKwkJCS8vIGxhenkgaW5p
dCBtdXN0IGJlIHRocmVhZC1zYWZlIGZvciByZWFkZXJzCisJCQlzeW5jaHJvbml6ZWQgKHRoaXMp
IHsKKwkJCQlpZiAodGhpcy5uYW1lID09IG51bGwpIHsKKwkJCQkJcHJlTGF6eUluaXQoKTsKKwkJ
CQkJdGhpcy5uYW1lID0gbmV3IFNpbXBsZU5hbWUodGhpcy5hc3QpOworCQkJCQlwb3N0TGF6eUlu
aXQodGhpcy5uYW1lLCBOQU1FX1BST1BFUlRZKTsKKwkJCQl9CisJCQl9CisJCX0KKwkJcmV0dXJu
IHRoaXMubmFtZTsKKwl9CisKKwkvKioKKwkgKiBTZXRzIHRoZSBuYW1lIHBhcnQgb2YgdGhpcyBw
YWNrYWdlIHF1YWxpZmllZCB0eXBlIHRvIHRoZSBnaXZlbiBzaW1wbGUgbmFtZS4KKwkgKgorCSAq
IEBwYXJhbSBuYW1lIHRoZSBpZGVudGlmaWVyIG9mIHRoaXMgcXVhbGlmaWVkIG5hbWUKKwkgKiBA
ZXhjZXB0aW9uIElsbGVnYWxBcmd1bWVudEV4Y2VwdGlvbiBpZjoKKwkgKiA8dWw+CisJICogPGxp
PnRoZSBub2RlIGJlbG9uZ3MgdG8gYSBkaWZmZXJlbnQgQVNUPC9saT4KKwkgKiA8bGk+dGhlIG5v
ZGUgYWxyZWFkeSBoYXMgYSBwYXJlbnQ8L2xpPgorCSAqIDwvdWw+CisJICovCisJcHVibGljIHZv
aWQgc2V0TmFtZShTaW1wbGVOYW1lIG5hbWUpIHsKKwkJaWYgKG5hbWUgPT0gbnVsbCkgeworCQkJ
dGhyb3cgbmV3IElsbGVnYWxBcmd1bWVudEV4Y2VwdGlvbigpOworCQl9CisJCUFTVE5vZGUgb2xk
Q2hpbGQgPSB0aGlzLm5hbWU7CisJCXByZVJlcGxhY2VDaGlsZChvbGRDaGlsZCwgbmFtZSwgTkFN
RV9QUk9QRVJUWSk7CisJCXRoaXMubmFtZSA9IG5hbWU7CisJCXBvc3RSZXBsYWNlQ2hpbGQob2xk
Q2hpbGQsIG5hbWUsIE5BTUVfUFJPUEVSVFkpOworCX0KKworCS8qIChvbWl0IGphdmFkb2MgZm9y
IHRoaXMgbWV0aG9kKQorCSAqIE1ldGhvZCBkZWNsYXJlZCBvbiBBU1ROb2RlLgorCSAqLworCWlu
dCBtZW1TaXplKCkgeworCQkvLyB0cmVhdCBDb2RlIGFzIGZyZWUKKwkJcmV0dXJuIEJBU0VfTk9E
RV9TSVpFICsgMiAqIDQ7CisJfQorCisJLyogKG9taXQgamF2YWRvYyBmb3IgdGhpcyBtZXRob2Qp
CisJICogTWV0aG9kIGRlY2xhcmVkIG9uIEFTVE5vZGUuCisJICovCisJaW50IHRyZWVTaXplKCkg
eworCQlyZXR1cm4KKwkJCW1lbVNpemUoKQorCQkJKyAodGhpcy5xdWFsaWZpZXIgPT0gbnVsbCA/
IDAgOiBnZXRRdWFsaWZpZXIoKS50cmVlU2l6ZSgpKQorCQkJKyAodGhpcy5hbm5vdGF0aW9ucyA9
PSBudWxsID8gMCA6IHRoaXMuYW5ub3RhdGlvbnMubGlzdFNpemUoKSkKKwkJCSsgKHRoaXMubmFt
ZSA9PSBudWxsID8gMCA6IGdldE5hbWUoKS50cmVlU2l6ZSgpKTsKKwl9CisKK30KZGlmZiAtLWdp
dCBhL29yZy5lY2xpcHNlLmpkdC5jb3JlL2RvbS9vcmcvZWNsaXBzZS9qZHQvY29yZS9kb20vUmVj
b3ZlcmVkVHlwZUJpbmRpbmcuamF2YSBiL29yZy5lY2xpcHNlLmpkdC5jb3JlL2RvbS9vcmcvZWNs
aXBzZS9qZHQvY29yZS9kb20vUmVjb3ZlcmVkVHlwZUJpbmRpbmcuamF2YQppbmRleCBmMGU4YjQw
Li5iNzJkMTI4IDEwMDY0NAotLS0gYS9vcmcuZWNsaXBzZS5qZHQuY29yZS9kb20vb3JnL2VjbGlw
c2UvamR0L2NvcmUvZG9tL1JlY292ZXJlZFR5cGVCaW5kaW5nLmphdmEKKysrIGIvb3JnLmVjbGlw
c2UuamR0LmNvcmUvZG9tL29yZy9lY2xpcHNlL2pkdC9jb3JlL2RvbS9SZWNvdmVyZWRUeXBlQmlu
ZGluZy5qYXZhCkBAIC0xLDkgKzEsMTMgQEAKIC8qKioqKioqKioqKioqKioqKioqKioqKioqKioq
KioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqCi0gKiBD
b3B5cmlnaHQgKGMpIDIwMDcsIDIwMTEgSUJNIENvcnBvcmF0aW9uIGFuZCBvdGhlcnMuCisgKiBD
b3B5cmlnaHQgKGMpIDIwMDcsIDIwMTMgSUJNIENvcnBvcmF0aW9uIGFuZCBvdGhlcnMuCiAgKiBB
bGwgcmlnaHRzIHJlc2VydmVkLiBUaGlzIHByb2dyYW0gYW5kIHRoZSBhY2NvbXBhbnlpbmcgbWF0
ZXJpYWxzCiAgKiBhcmUgbWFkZSBhdmFpbGFibGUgdW5kZXIgdGhlIHRlcm1zIG9mIHRoZSBFY2xp
cHNlIFB1YmxpYyBMaWNlbnNlIHYxLjAKICAqIHdoaWNoIGFjY29tcGFuaWVzIHRoaXMgZGlzdHJp
YnV0aW9uLCBhbmQgaXMgYXZhaWxhYmxlIGF0CiAgKiBodHRwOi8vd3d3LmVjbGlwc2Uub3JnL2xl
Z2FsL2VwbC12MTAuaHRtbAorICoKKyAqIFRoaXMgaXMgYW4gaW1wbGVtZW50YXRpb24gb2YgYW4g
ZWFybHktZHJhZnQgc3BlY2lmaWNhdGlvbiBkZXZlbG9wZWQgdW5kZXIgdGhlIEphdmEKKyAqIENv
bW11bml0eSBQcm9jZXNzIChKQ1ApIGFuZCBpcyBtYWRlIGF2YWlsYWJsZSBmb3IgdGVzdGluZyBh
bmQgZXZhbHVhdGlvbiBwdXJwb3NlcworICogb25seS4gVGhlIGNvZGUgaXMgbm90IGNvbXBhdGli
bGUgd2l0aCBhbnkgc3BlY2lmaWNhdGlvbiBvZiB0aGUgSkNQLgogICoKICAqIENvbnRyaWJ1dG9y
czoKICAqICAgICBJQk0gQ29ycG9yYXRpb24gLSBpbml0aWFsIEFQSSBhbmQgaW1wbGVtZW50YXRp
b24KQEAgLTY2Myw2ICs2NjcsOSBAQAogCQkJY2FzZSBBU1ROb2RlLlFVQUxJRklFRF9UWVBFIDoK
IAkJCQlRdWFsaWZpZWRUeXBlIHF1YWxpZmllZFR5cGUgPSAoUXVhbGlmaWVkVHlwZSkgdHlwZTsK
IAkJCQlyZXR1cm4gcXVhbGlmaWVkVHlwZS5nZXROYW1lKCkuZ2V0SWRlbnRpZmllcigpOworCQkJ
Y2FzZSBBU1ROb2RlLlBBQ0tBR0VfUVVBTElGSUVEX1RZUEUgOgorCQkJCVBhY2thZ2VRdWFsaWZp
ZWRUeXBlIHBhY2thZ2VRdWFsaWZpZWRUeXBlID0gKFBhY2thZ2VRdWFsaWZpZWRUeXBlKSB0eXBl
OworCQkJCXJldHVybiBwYWNrYWdlUXVhbGlmaWVkVHlwZS5nZXROYW1lKCkuZ2V0SWRlbnRpZmll
cigpOwogCQkJY2FzZSBBU1ROb2RlLlNJTVBMRV9UWVBFIDoKIAkJCQlTaW1wbGVUeXBlIHNpbXBs
ZVR5cGUgPSAoU2ltcGxlVHlwZSkgdHlwZTsKIAkJCQlOYW1lIG5hbWUgPSBzaW1wbGVUeXBlLmdl
dE5hbWUoKTsKZGlmZiAtLWdpdCBhL29yZy5lY2xpcHNlLmpkdC5jb3JlL2RvbS9vcmcvZWNsaXBz
ZS9qZHQvY29yZS9kb20vVHlwZS5qYXZhIGIvb3JnLmVjbGlwc2UuamR0LmNvcmUvZG9tL29yZy9l
Y2xpcHNlL2pkdC9jb3JlL2RvbS9UeXBlLmphdmEKaW5kZXggNGQ3ZmYwYi4uOGI0ZTliYyAxMDA2
NDQKLS0tIGEvb3JnLmVjbGlwc2UuamR0LmNvcmUvZG9tL29yZy9lY2xpcHNlL2pkdC9jb3JlL2Rv
bS9UeXBlLmphdmEKKysrIGIvb3JnLmVjbGlwc2UuamR0LmNvcmUvZG9tL29yZy9lY2xpcHNlL2pk
dC9jb3JlL2RvbS9UeXBlLmphdmEKQEAgLTMzLDYgKzMzLDcgQEAKICAqICAgICAgIEFycmF5VHlw
ZQogICogICAgICAgU2ltcGxlVHlwZQogICogICAgICAgUXVhbGlmaWVkVHlwZQorICogICAgICAg
UGFja2FnZVF1YWxpZmllZFR5cGUKICAqICAgICAgIFdpbGRjYXJkVHlwZQogICogICAgUGFyYW1l
dGVyaXplZFR5cGUKICAqICAgIFVuaW9uVHlwZQpAQCAtNTQsNiArNTUsOCBAQAogICogICAgeyBB
bm5vdGF0aW9uIH0gVHlwZU5hbWUKICAqIHtAbGluayBRdWFsaWZpZWRUeXBlfToKICAqICAgIFR5
cGUgPGI+LjwvYj4ge0Fubm90YXRpb259IFNpbXBsZU5hbWUKKyAqIHtAbGluayBQYWNrYWdlUXVh
bGlmaWVkVHlwZX06CisgKiAgICBOYW1lIDxiPi48L2I+IHsgQW5ub3RhdGlvbiB9IFNpbXBsZU5h
bWUKICAqIHtAbGluayBXaWxkY2FyZFR5cGV9OgogICogICAgeyBBbm5vdGF0aW9uIH0gPGI+Pzwv
Yj4gWyAoIDxiPmV4dGVuZHM8L2I+IHwgPGI+c3VwZXI8L2I+KSBUeXBlIF0KICAqIHtAbGluayBQ
YXJhbWV0ZXJpemVkVHlwZX06CkBAIC0xMTUsNiArMTE4LDE4IEBACiAJfQogCiAJLyoqCisJICog
UmV0dXJucyB3aGV0aGVyIHRoaXMgdHlwZSBpcyBhIHBhY2thZ2UgcXVhbGlmaWVkIHR5cGUKKwkg
KiAoe0BsaW5rIFBhY2thZ2VRdWFsaWZpZWRUeXBlfSkuCisJICoKKwkgKiBAcmV0dXJuIDxjb2Rl
PnRydWU8L2NvZGU+IGlmIHRoaXMgaXMgYSBwYWNrYWdlIHF1YWxpZmllZCB0eXBlLCBhbmQKKwkg
KiAgICA8Y29kZT5mYWxzZTwvY29kZT4gb3RoZXJ3aXNlCisJICogQHNpbmNlIDMuOSBCRVRBX0pB
VkE4CisJICovCisJcHVibGljIGZpbmFsIGJvb2xlYW4gaXNQYWNrYWdlUXVhbGlmaWVkVHlwZSgp
IHsKKwkJcmV0dXJuICh0aGlzIGluc3RhbmNlb2YgUGFja2FnZVF1YWxpZmllZFR5cGUpOworCX0K
KworCS8qKgogCSAqIFJldHVybnMgd2hldGhlciB0aGlzIHR5cGUgaXMgYSBwYXJhbWV0ZXJpemVk
IHR5cGUKIAkgKiAoe0BsaW5rIFBhcmFtZXRlcml6ZWRUeXBlfSkuCiAJICoKZGlmZiAtLWdpdCBh
L29yZy5lY2xpcHNlLmpkdC5jb3JlL2RvbS9vcmcvZWNsaXBzZS9qZHQvaW50ZXJuYWwvY29yZS9k
b20vTmFpdmVBU1RGbGF0dGVuZXIuamF2YSBiL29yZy5lY2xpcHNlLmpkdC5jb3JlL2RvbS9vcmcv
ZWNsaXBzZS9qZHQvaW50ZXJuYWwvY29yZS9kb20vTmFpdmVBU1RGbGF0dGVuZXIuamF2YQppbmRl
eCBhOWMxZDYwLi4yN2ZkYWI3IDEwMDY0NAotLS0gYS9vcmcuZWNsaXBzZS5qZHQuY29yZS9kb20v
b3JnL2VjbGlwc2UvamR0L2ludGVybmFsL2NvcmUvZG9tL05haXZlQVNURmxhdHRlbmVyLmphdmEK
KysrIGIvb3JnLmVjbGlwc2UuamR0LmNvcmUvZG9tL29yZy9lY2xpcHNlL2pkdC9pbnRlcm5hbC9j
b3JlL2RvbS9OYWl2ZUFTVEZsYXR0ZW5lci5qYXZhCkBAIC0xMjAyLDYgKzEyMDIsMTggQEAKIAl9
CiAKIAkvKgorCSAqIEBzZWUgQVNUVmlzaXRvciN2aXNpdChQYWNrYWdlUXVhbGlmaWVkVHlwZSkK
KwkgKiBAc2luY2UgMy45IEJFVEFfSkFWQTgKKwkgKi8KKwlwdWJsaWMgYm9vbGVhbiB2aXNpdChQ
YWNrYWdlUXVhbGlmaWVkVHlwZSBub2RlKSB7CisJCW5vZGUuZ2V0UXVhbGlmaWVyKCkuYWNjZXB0
KHRoaXMpOworCQl0aGlzLmJ1ZmZlci5hcHBlbmQoJy4nKTsKKwkJdmlzaXRUeXBlQW5ub3RhdGlv
bnMobm9kZSk7CisJCW5vZGUuZ2V0TmFtZSgpLmFjY2VwdCh0aGlzKTsKKwkJcmV0dXJuIGZhbHNl
OworCX0KKworCS8qCiAJICogQHNlZSBBU1RWaXNpdG9yI3Zpc2l0KFBhcmFtZXRlcml6ZWRUeXBl
KQogCSAqIEBzaW5jZSAzLjEKIAkgKi8=
</data>

          </attachment>
      

    </bug>

</bugzilla>