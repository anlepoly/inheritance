<?xml version="1.0" encoding="UTF-8" standalone="yes" ?>
<!DOCTYPE bugzilla SYSTEM "https://bugs.eclipse.org/bugs/page.cgi?id=bugzilla.dtd">

<bugzilla version="4.4.7"
          urlbase="https://bugs.eclipse.org/bugs/"
          
          maintainer="webmaster@eclipse.org"
>

    <bug>
          <bug_id>445708</bug_id>
          
          <creation_ts>2014-10-01 14:30:00 -0400</creation_ts>
          <short_desc>Switching on nullable values has regressed since bug #403674</short_desc>
          <delta_ts>2014-12-09 05:06:48 -0500</delta_ts>
          <reporter_accessible>1</reporter_accessible>
          <cclist_accessible>1</cclist_accessible>
          <classification_id>2</classification_id>
          <classification>Eclipse</classification>
          <product>JDT</product>
          <component>Core</component>
          <version>4.4.1</version>
          <rep_platform>PC</rep_platform>
          <op_sys>Linux</op_sys>
          <bug_status>VERIFIED</bug_status>
          <resolution>DUPLICATE</resolution>
          <dup_id>435805</dup_id>
          
          <bug_file_loc></bug_file_loc>
          <status_whiteboard></status_whiteboard>
          <keywords></keywords>
          <priority>P3</priority>
          <bug_severity>normal</bug_severity>
          <target_milestone>4.5 M4</target_milestone>
          
          
          <everconfirmed>1</everconfirmed>
          <reporter name="Colin Bartolome">cbartolo</reporter>
          <assigned_to name="Stephan Herrmann">stephan.herrmann</assigned_to>
          <cc>jarthana</cc>
    
    <cc>shankhba</cc>
    
    <cc>srikanth_sankaran</cc>
          
          <votes>0</votes>

      

      

      

          <comment_sort_order>oldest_to_newest</comment_sort_order>  
          <long_desc isprivate="0" >
    <commentid>2458811</commentid>
    <comment_count>0</comment_count>
      <attachid>247546</attachid>
    <who name="Colin Bartolome">cbartolo</who>
    <bug_when>2014-10-01 14:30:29 -0400</bug_when>
    <thetext>Created attachment 247546
Code showing the incorrect behavior

Bug #403674 fixed one aspect of switching on nullable values, but the situation seems to have gotten worse in Eclipse 4.4.1. Please see the attached code and note the lines that should be flagged, but aren&apos;t.</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>2461233</commentid>
    <comment_count>1</comment_count>
    <who name="Colin Bartolome">cbartolo</who>
    <bug_when>2014-10-07 17:26:21 -0400</bug_when>
    <thetext>This appears to have been caused by my project carrying over an old version of the org.eclipse.jdt.annotation JAR. When I deleted that JAR from my project and allowed Ecplise Luna to re-add it, the problematic behavior went away.

I&apos;m guessing that the &quot;Use default annotations for null specifications&quot; option was looking in version 2.x of the annotation JAR while the project was looking in version 1.x of the JAR.

I don&apos;t know a good way to guard against that happening when the compliance level of a project changes.</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>2486614</commentid>
    <comment_count>2</comment_count>
    <who name="Stephan Herrmann">stephan.herrmann</who>
    <bug_when>2014-11-20 12:13:33 -0500</bug_when>
    <thetext>Here&apos;s what I see at HEAD of master:

-1.8 -classpath org.eclipse.jdt.annotation_2.0.*.jar
=&gt; 5 null problems reported

-1.7 -classpath org.eclipse.jdt.annotation_1.1.*.jar
=&gt; 5 null problems reported

-1.8 -classpath org.eclipse.jdt.annotation_1.1.*.jar
=&gt; 5 null problems reported

-1.7 -classpath org.eclipse.jdt.annotation_2.0.*.jar
=&gt; 4 errors:
Syntax error, type annotations are available only when source level is at least 1.8

The case of 1.8 + annotation_1.1 has been fixed via bug 435805.


All looks just alright to me =&gt; nothing to be back ported.

*** This bug has been marked as a duplicate of bug 435805 ***</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>2486621</commentid>
    <comment_count>3</comment_count>
    <who name="Stephan Herrmann">stephan.herrmann</who>
    <bug_when>2014-11-20 12:27:41 -0500</bug_when>
    <thetext>Regression test for all cases except for the syntax errors added via http://git.eclipse.org/c/jdt/eclipse.jdt.core.git/commit/?id=aa088c9613730dd52d574cb2a976066072a03896</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>2494388</commentid>
    <comment_count>4</comment_count>
    <who name="shankha banerjee">shankhba</who>
    <bug_when>2014-12-09 05:06:48 -0500</bug_when>
    <thetext>Verified for 4.5M4 using I20141208-2000 build.</thetext>
  </long_desc>
      
          <attachment
              isobsolete="0"
              ispatch="0"
              isprivate="0"
          >
            <attachid>247546</attachid>
            <date>2014-10-01 14:30:00 -0400</date>
            <delta_ts>2014-10-01 14:30:29 -0400</delta_ts>
            <desc>Code showing the incorrect behavior</desc>
            <filename>SwitchTest.java</filename>
            <type>text/x-java-source</type>
            <size>1029</size>
            <attacher name="Colin Bartolome">cbartolo</attacher>
            
              <data encoding="base64">aW1wb3J0IG9yZy5lY2xpcHNlLmpkdC5hbm5vdGF0aW9uLk51bGxhYmxlOwoKcHVibGljIGNsYXNz
IFN3aXRjaFRlc3QKewogICBwcml2YXRlIGVudW0gRW51bVZhbHVlCiAgIHsKICAgfQogICAKICAg
cHVibGljIHN0YXRpYyB2b2lkIG1haW4oU3RyaW5nW10gYXJncykKICAgewogICAgICAvLyBTaG91
bGQgYmUgZmxhZ2dlZCBhcyAiUG90ZW50aWFsIG51bGwgcG9pbnRlciBhY2Nlc3MsIiBidXQgaXMg
bm90LgogICAgICBzd2l0Y2ggKGNvbXB1dGVTdHJpbmdWYWx1ZSgpKQogICAgICB7CiAgICAgIH0K
ICAgICAgCiAgICAgIEBOdWxsYWJsZSBTdHJpbmcgc3RyaW5nVmFsdWUgPSBudWxsOwogICAgICAK
ICAgICAgLy8gUHJvcGVybHkgZmxhZ2dlZCBhcyAiTnVsbCBwb2ludGVyIGFjY2Vzcy4iCiAgICAg
IHN3aXRjaCAoc3RyaW5nVmFsdWUpCiAgICAgIHsKICAgICAgfQogICAgICAKICAgICAgc3RyaW5n
VmFsdWUgPSBjb21wdXRlU3RyaW5nVmFsdWUoKTsKICAgICAgCiAgICAgIC8vIFNob3VsZCBiZSBm
bGFnZ2VkIGFzICJQb3RlbnRpYWwgbnVsbCBwb2ludGVyIGFjY2VzcywiIGJ1dCBpcyBub3QuCiAg
ICAgIHN3aXRjaCAoc3RyaW5nVmFsdWUpCiAgICAgIHsKICAgICAgfQogICAgICAKICAgICAgLy8g
U2hvdWxkIGFsc28gYmUgZmxhZ2dlZCwgYnV0IGlzIG5vdC4KICAgICAgc3dpdGNoIChjb21wdXRl
RW51bVZhbHVlKCkpCiAgICAgIHsKICAgICAgfQogICAgICAKICAgICAgQE51bGxhYmxlIEVudW1W
YWx1ZSBlbnVtVmFsdWUgPSBudWxsOwogICAgICAKICAgICAgLy8gRml4ZWQgaW4gYnVnICM0MDM2
NzQuCiAgICAgIHN3aXRjaCAoZW51bVZhbHVlKQogICAgICB7CiAgICAgIH0KICAgfQogICAKICAg
cHJpdmF0ZSBzdGF0aWMgQE51bGxhYmxlIFN0cmluZyBjb21wdXRlU3RyaW5nVmFsdWUoKQogICB7
CiAgICAgIHJldHVybiBudWxsOwogICB9CiAgIAogICBwcml2YXRlIHN0YXRpYyBATnVsbGFibGUg
RW51bVZhbHVlIGNvbXB1dGVFbnVtVmFsdWUoKQogICB7CiAgICAgIHJldHVybiBudWxsOwogICB9
Cn0K
</data>

          </attachment>
      

    </bug>

</bugzilla>