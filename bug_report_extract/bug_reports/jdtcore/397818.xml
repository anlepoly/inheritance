<?xml version="1.0" encoding="UTF-8" standalone="yes" ?>
<!DOCTYPE bugzilla SYSTEM "https://bugs.eclipse.org/bugs/page.cgi?id=bugzilla.dtd">

<bugzilla version="4.4.7"
          urlbase="https://bugs.eclipse.org/bugs/"
          
          maintainer="webmaster@eclipse.org"
>

    <bug>
          <bug_id>397818</bug_id>
          
          <creation_ts>2013-01-09 22:05:00 -0500</creation_ts>
          <short_desc>An IndexLocation is not created properly if the pre-build indexes are located in a directory with a space</short_desc>
          <delta_ts>2013-02-07 22:59:33 -0500</delta_ts>
          <reporter_accessible>1</reporter_accessible>
          <cclist_accessible>1</cclist_accessible>
          <classification_id>2</classification_id>
          <classification>Eclipse</classification>
          <product>JDT</product>
          <component>Core</component>
          <version>4.2.1</version>
          <rep_platform>PC</rep_platform>
          <op_sys>Windows 7</op_sys>
          <bug_status>VERIFIED</bug_status>
          <resolution>FIXED</resolution>
          
          
          <bug_file_loc></bug_file_loc>
          <status_whiteboard></status_whiteboard>
          <keywords></keywords>
          <priority>P3</priority>
          <bug_severity>normal</bug_severity>
          <target_milestone>3.8.2</target_milestone>
          
          
          <everconfirmed>1</everconfirmed>
          <reporter name="Troy Bishop">tjbishop</reporter>
          <assigned_to name="Jay Arthanareeswaran">jarthana</assigned_to>
          <cc>daniel_megert</cc>
    
    <cc>jarthana</cc>
          
          <votes>0</votes>

      

      

      <flag name="pmc_approved"
          id="55089"
          type_id="2"
          status="+"
          setter="daniel_megert"
    />

          <comment_sort_order>oldest_to_newest</comment_sort_order>  
          <long_desc isprivate="0" >
    <commentid>2200958</commentid>
    <comment_count>0</comment_count>
      <attachid>225409</attachid>
    <who name="Troy Bishop">tjbishop</who>
    <bug_when>2013-01-09 22:05:53 -0500</bug_when>
    <thetext>Created attachment 225409
potential patch.

The implementation for IndexLocation.createIndexLocation(URL) is faulty in that it does not account for spaces that may exist in the local file URL.  As a result, the internal File object that is constructed from the URL will not exist (i.e. any call to File#exists() will return false because the directory will be something like C:\tmp\my%20directory\ rather than C:\tmp\my drectory\).  For more information on this problem, see:

http://weblogs.java.net/blog/kohsuke/archive/2007/04/how_to_convert.html

Attached is a patch which fixes this problem, but for a J2SE-1.4 EE target since that appears to be what org.eclipse.jdt.core is targeting.

Please commit this fix for the 4.2.2 stream, if possible.  Thank you!</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>2201606</commentid>
    <comment_count>1</comment_count>
      <attachid>225492</attachid>
    <who name="Jay Arthanareeswaran">jarthana</who>
    <bug_when>2013-01-11 01:52:45 -0500</bug_when>
    <thetext>Created attachment 225492
Regression test

I have reviewed the proposed fix and looks good. This is the regression test for the fix.

Dani, without this fix, indexes don&apos;t work when index locations have spaces in them. This will be a good candidate for 3.8.2. What do you think?</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>2203721</commentid>
    <comment_count>2</comment_count>
    <who name="Dani Megert">daniel_megert</who>
    <bug_when>2013-01-16 11:23:13 -0500</bug_when>
    <thetext>(In reply to comment #1)
&gt; Created attachment 225492 [details] [diff]
&gt; Regression test
&gt; 
&gt; I have reviewed the proposed fix and looks good. This is the regression test
&gt; for the fix.
&gt; 
&gt; Dani, without this fix, indexes don&apos;t work when index locations have spaces
&gt; in them. This will be a good candidate for 3.8.2. What do you think?

+1 for RC3.</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>2205762</commentid>
    <comment_count>3</comment_count>
    <who name="Jay Arthanareeswaran">jarthana</who>
    <bug_when>2013-01-21 23:08:35 -0500</bug_when>
    <thetext>Patch and test released in R3_8_maintenance via separate commits and the HEAD is at:

http://git.eclipse.org/c/jdt/eclipse.jdt.core.git/commit/?h=R3_8_maintenance&amp;id=a26aba2e7e85e676db505fc02a028d4706993df5</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>2205768</commentid>
    <comment_count>4</comment_count>
    <who name="Jay Arthanareeswaran">jarthana</who>
    <bug_when>2013-01-22 00:12:00 -0500</bug_when>
    <thetext>Forgot to mention that I also released the fix in master for 4.3 M5.</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>2213911</commentid>
    <comment_count>5</comment_count>
    <who name="Jay Arthanareeswaran">jarthana</who>
    <bug_when>2013-02-07 22:59:33 -0500</bug_when>
    <thetext>This fix has been verified by Troy (Thanks!) in the following builds:

http://download.eclipse.org/eclipse/downloads/drops4/S-4.3M5a-201302041400/
http://download.eclipse.org/eclipse/downloads/drops4/M20130204-1200/</thetext>
  </long_desc>
      
          <attachment
              isobsolete="0"
              ispatch="1"
              isprivate="0"
          >
            <attachid>225409</attachid>
            <date>2013-01-09 22:05:00 -0500</date>
            <delta_ts>2013-01-09 23:44:54 -0500</delta_ts>
            <desc>potential patch.</desc>
            <filename>eclipse.jdt.core_indexlocation.patch</filename>
            <type>text/plain</type>
            <size>1176</size>
            <attacher name="Troy Bishop">tjbishop</attacher>
            
              <data encoding="base64">ZGlmZiAtLWdpdCBhL29yZy5lY2xpcHNlLmpkdC5jb3JlL3NlYXJjaC9vcmcvZWNsaXBzZS9qZHQv
aW50ZXJuYWwvY29yZS9pbmRleC9JbmRleExvY2F0aW9uLmphdmEgYi9vcmcuZWNsaXBzZS5qZHQu
Y29yZS9zZWFyY2gvb3JnL2VjbGlwc2UvamR0L2ludGVybmFsL2NvcmUvaW5kZXgvSW5kZXhMb2Nh
dGlvbi5qYXZhCmluZGV4IGQ0MTBmNzIuLmFlYzcwMzQgMTAwNjQ0Ci0tLSBhL29yZy5lY2xpcHNl
LmpkdC5jb3JlL3NlYXJjaC9vcmcvZWNsaXBzZS9qZHQvaW50ZXJuYWwvY29yZS9pbmRleC9JbmRl
eExvY2F0aW9uLmphdmEKKysrIGIvb3JnLmVjbGlwc2UuamR0LmNvcmUvc2VhcmNoL29yZy9lY2xp
cHNlL2pkdC9pbnRlcm5hbC9jb3JlL2luZGV4L0luZGV4TG9jYXRpb24uamF2YQpAQCAtMTMsOCAr
MTMsOSBAQAogaW1wb3J0IGphdmEuaW8uRmlsZTsKIGltcG9ydCBqYXZhLmlvLklPRXhjZXB0aW9u
OwogaW1wb3J0IGphdmEuaW8uSW5wdXRTdHJlYW07Ci0KIGltcG9ydCBqYXZhLm5ldC5NYWxmb3Jt
ZWRVUkxFeGNlcHRpb247CitpbXBvcnQgamF2YS5uZXQuVVJJOworaW1wb3J0IGphdmEubmV0LlVS
SVN5bnRheEV4Y2VwdGlvbjsKIGltcG9ydCBqYXZhLm5ldC5VUkw7CiAKIGltcG9ydCBvcmcuZWNs
aXBzZS5jb3JlLnJ1bnRpbWUuRmlsZUxvY2F0b3I7CkBAIC0zNyw3ICszOCwxNSBAQAogCQkJcmV0
dXJuIG51bGw7CiAJCX0KIAkJaWYgKGxvY2FsVXJsLmdldFByb3RvY29sKCkuZXF1YWxzKCJmaWxl
IikpIHsgLy8kTk9OLU5MUy0xJAotCQkJcmV0dXJuIG5ldyBGaWxlSW5kZXhMb2NhdGlvbih1cmws
IG5ldyBGaWxlKGxvY2FsVXJsLmdldFBhdGgoKSkpOworCQkJRmlsZSBsb2NhbEZpbGUgPSBudWxs
OworCQkJdHJ5IHsKKwkJCQlVUkkgbG9jYWxGaWxlVVJJID0gbmV3IFVSSShsb2NhbFVybC50b0V4
dGVybmFsRm9ybSgpKTsKKwkJCQlsb2NhbEZpbGUgPSBuZXcgRmlsZShsb2NhbEZpbGVVUkkpOwor
CQkJfQorCQkJY2F0Y2goVVJJU3ludGF4RXhjZXB0aW9uIHVyaVN5bnRheEV4KSB7CisJCQkJbG9j
YWxGaWxlID0gbmV3IEZpbGUobG9jYWxVcmwuZ2V0UGF0aCgpKTsKKwkJCX0KKwkJCXJldHVybiBu
ZXcgRmlsZUluZGV4TG9jYXRpb24odXJsLCBsb2NhbEZpbGUpOwogCQl9CiAJCXJldHVybiBuZXcg
SmFySW5kZXhMb2NhdGlvbih1cmwsIGxvY2FsVXJsKTsKIAl9
</data>

          </attachment>
          <attachment
              isobsolete="0"
              ispatch="1"
              isprivate="0"
          >
            <attachid>225492</attachid>
            <date>2013-01-11 01:52:00 -0500</date>
            <delta_ts>2013-01-11 01:52:45 -0500</delta_ts>
            <desc>Regression test</desc>
            <filename>Fix-for-bug-397818.patch</filename>
            <type>text/plain</type>
            <size>1747</size>
            <attacher name="Jay Arthanareeswaran">jarthana</attacher>
            
              <data encoding="base64">ZGlmZiAtLWdpdCBhL29yZy5lY2xpcHNlLmpkdC5jb3JlLnRlc3RzLm1vZGVsL3NyYy9vcmcvZWNs
aXBzZS9qZHQvY29yZS90ZXN0cy9tb2RlbC9KYXZhU2VhcmNoU2NvcGVUZXN0cy5qYXZhIGIvb3Jn
LmVjbGlwc2UuamR0LmNvcmUudGVzdHMubW9kZWwvc3JjL29yZy9lY2xpcHNlL2pkdC9jb3JlL3Rl
c3RzL21vZGVsL0phdmFTZWFyY2hTY29wZVRlc3RzLmphdmEKaW5kZXggNTJhZjMxNS4uMjNjZjJm
MiAxMDA2NDQKLS0tIGEvb3JnLmVjbGlwc2UuamR0LmNvcmUudGVzdHMubW9kZWwvc3JjL29yZy9l
Y2xpcHNlL2pkdC9jb3JlL3Rlc3RzL21vZGVsL0phdmFTZWFyY2hTY29wZVRlc3RzLmphdmEKKysr
IGIvb3JnLmVjbGlwc2UuamR0LmNvcmUudGVzdHMubW9kZWwvc3JjL29yZy9lY2xpcHNlL2pkdC9j
b3JlL3Rlc3RzL21vZGVsL0phdmFTZWFyY2hTY29wZVRlc3RzLmphdmEKQEAgLTExLDggKzExLDEx
IEBACiBwYWNrYWdlIG9yZy5lY2xpcHNlLmpkdC5jb3JlLnRlc3RzLm1vZGVsOwogCitpbXBvcnQg
amF2YS5uZXQuTWFsZm9ybWVkVVJMRXhjZXB0aW9uOworaW1wb3J0IGphdmEubmV0LlVSTDsKIGlt
cG9ydCBqYXZhLnV0aWwuSGFzaE1hcDsKIAogaW1wb3J0IGp1bml0LmZyYW1ld29yay5UZXN0Owog
CitpbXBvcnQgb3JnLmVjbGlwc2UuY29yZS5yZXNvdXJjZXMuSUZpbGU7CiBpbXBvcnQgb3JnLmVj
bGlwc2UuY29yZS5yZXNvdXJjZXMuSVdvcmtzcGFjZVJ1bm5hYmxlOwogaW1wb3J0IG9yZy5lY2xp
cHNlLmNvcmUucmVzb3VyY2VzLkluY3JlbWVudGFsUHJvamVjdEJ1aWxkZXI7CkBAIC0yNSw0ICsy
OCw1IEBACiBpbXBvcnQgb3JnLmVjbGlwc2UuamR0LmNvcmUudGVzdHMubW9kZWwuQWJzdHJhY3RK
YXZhU2VhcmNoVGVzdHMuVHlwZU5hbWVNYXRjaENvbGxlY3RvcjsKIGltcG9ydCBvcmcuZWNsaXBz
ZS5qZHQuaW50ZXJuYWwuY29yZS5KYXZhTW9kZWxNYW5hZ2VyOworaW1wb3J0IG9yZy5lY2xpcHNl
LmpkdC5pbnRlcm5hbC5jb3JlLmluZGV4LkluZGV4TG9jYXRpb247CiBpbXBvcnQgb3JnLmVjbGlw
c2UuamR0LmludGVybmFsLmNvcmUuc2VhcmNoLmluZGV4aW5nLkluZGV4TWFuYWdlcjsKIApAQCAt
MTA5NywzICsxMTAxLDIxIEBACiAJfQogfQorLy8gaHR0cHM6Ly9idWdzLmVjbGlwc2Uub3JnL2J1
Z3Mvc2hvd19idWcuY2dpP2lkPTM5NzgxOAorcHVibGljIHZvaWQgdGVzdEJ1ZzM5NzgxOCgpIHRo
cm93cyBDb3JlRXhjZXB0aW9uIHsKKwl0cnkgeworCQljcmVhdGVKYXZhUHJvamVjdCgiUDEiLCBu
ZXcgU3RyaW5nW10geyJzcmMifSwgbmV3IFN0cmluZ1tdIHt9LCAiYmluIik7CisJCQorCQljcmVh
dGVGb2xkZXIoIi9QMS9uZXcgZm9sZGVyIik7CisJCUlGaWxlIG5ld0ZpbGUgPSBjcmVhdGVGaWxl
KCIvUDEvbmV3IGZvbGRlci90ZXN0aW5kZXguaW5kZXgiLCAiIik7CisJCXRyeSB7CisJCQlVUkwg
bmV3VVJMID0gbmV3RmlsZS5nZXRMb2NhdGlvblVSSSgpLnRvVVJMKCk7CisJCQlJbmRleExvY2F0
aW9uIGluZGV4TG9jID0gSW5kZXhMb2NhdGlvbi5jcmVhdGVJbmRleExvY2F0aW9uKG5ld1VSTCk7
CisJCQlhc3NlcnRUcnVlKCJNYWxmb3JtZWQgaW5kZXggbG9jYXRpb24iLCBpbmRleExvYy5nZXRJ
bmRleEZpbGUoKS5leGlzdHMoKSk7CisJCX0gY2F0Y2ggKE1hbGZvcm1lZFVSTEV4Y2VwdGlvbiBl
KSB7CisJCQlmYWlsKCJNYWxmb3JtZWQgaW5kZXggbG9jYXRpb24iKTsKKwkJfQorCX0gZmluYWxs
eSB7CisJCWRlbGV0ZVByb2plY3QoIlAxIik7CisJfQorfQogfQ==
</data>

          </attachment>
      

    </bug>

</bugzilla>