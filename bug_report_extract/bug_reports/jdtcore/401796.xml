<?xml version="1.0" encoding="UTF-8" standalone="yes" ?>
<!DOCTYPE bugzilla SYSTEM "https://bugs.eclipse.org/bugs/page.cgi?id=bugzilla.dtd">

<bugzilla version="4.4.7"
          urlbase="https://bugs.eclipse.org/bugs/"
          
          maintainer="webmaster@eclipse.org"
>

    <bug>
          <bug_id>401796</bug_id>
          
          <creation_ts>2013-02-26 09:45:00 -0500</creation_ts>
          <short_desc>[1.8][compiler] don&apos;t treat default methods as overriding an independent inherited abstract method</short_desc>
          <delta_ts>2013-03-03 11:38:47 -0500</delta_ts>
          <reporter_accessible>1</reporter_accessible>
          <cclist_accessible>1</cclist_accessible>
          <classification_id>2</classification_id>
          <classification>Eclipse</classification>
          <product>JDT</product>
          <component>Core</component>
          <version>3.8</version>
          <rep_platform>All</rep_platform>
          <op_sys>All</op_sys>
          <bug_status>RESOLVED</bug_status>
          <resolution>FIXED</resolution>
          
          
          <bug_file_loc></bug_file_loc>
          <status_whiteboard></status_whiteboard>
          <keywords></keywords>
          <priority>P3</priority>
          <bug_severity>enhancement</bug_severity>
          <target_milestone>BETA J8</target_milestone>
          
          <blocked>383966</blocked>
          <everconfirmed>1</everconfirmed>
          <reporter name="Stephan Herrmann">stephan.herrmann</reporter>
          <assigned_to name="Stephan Herrmann">stephan.herrmann</assigned_to>
          
          
          <votes>0</votes>

      

      

      

          <comment_sort_order>oldest_to_newest</comment_sort_order>  
          <long_desc isprivate="0" >
    <commentid>2222051</commentid>
    <comment_count>0</comment_count>
    <who name="Stephan Herrmann">stephan.herrmann</who>
    <bug_when>2013-02-26 09:45:22 -0500</bug_when>
    <thetext>Consider this example:

public interface I1 {
	default void m() { }
}
public abstract class C1 {
	public abstract void m();
}
public class C2 extends C1 implements I1 { }

I read the spec 0.6.1 part H, 8.4.8 as saying:
- I1.m is inherited because C1.m does not override it from C1
- C1.m is inherited because I1.m does not override it from I1

In 8.4.8.4 none of the sentences starting with &quot;It is a compile-time error&quot; apply.

This puts the following sentence to action:
&quot;Otherwise, the set of override-equivalent methods consists of at least one abstract method and zero or more default methods; then the class is necessarily an abstract class and is considered to inherit all the methods.&quot;

Thus we should issue an error because C2 is not abstract. This error is not reported currently.</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>2225101</commentid>
    <comment_count>1</comment_count>
    <who name="Stephan Herrmann">stephan.herrmann</who>
    <bug_when>2013-03-03 11:33:37 -0500</bug_when>
    <thetext>Observations from re-checking all of DefaultMethodTest against the current spec and against javac b74:

- in cases like our testAbstract02() javac first complains
  &quot;C is not abstract and does not override abstract method test() in I1&quot;
  Only after this is fixed by marking C as abstract the conflict between I1.test() and I2.test() is reported.
  By contrast, ECJ starts with reporting that conflict, thus avoiding to suggest a bogus fix.
  BTW, MethodVerifyTest.test043() reports a similar difference between compilers, which, however, seems obsolete as of b74 (see also bug 402237).

- testAnnotation1 triggered request for clarification bug 402236
  -&gt; handled by marking the test with JavacTestOptions.JavacHasABug.Javac8AcceptsDefaultMethodInAnnotationType

- conflict between two independent default methods could be signaled more explicitly, done by new IProblem.DuplicateInheritedDefaultMethods


After my initial implementation in bug 383966 tree, both the spec and my understanding thereof have changed.
My patch-in-preparation will bring some changes that reflect these changes:

- solution from bug 401246 now applies in more situations, notably where only one non-abstract method exists, still an abstract class method resolves a conflict

- as a special case for the trumping behaviour of bug 401246 a check for abstractness has been added, which is needed because the regular analysis considers the inherited default method as sufficient to cover all override-equivalent inherit methods.

- conflict between an inherited default method and another method was not detected against abstract interface methods, whereas the current spec makes no difference between abstract or default interface method.
This particular change is realized by calling checkInheritedDefaultMethods() from a more central location (MethodVerifier15.checkInheritedMethods(MethodBinding[], int, boolean[])).
The change required updates of the tests testAbstract02(), testAbstract02a()  -&gt; change override to conflict</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>2225102</commentid>
    <comment_count>2</comment_count>
    <who name="Stephan Herrmann">stephan.herrmann</who>
    <bug_when>2013-03-03 11:38:47 -0500</bug_when>
    <thetext>Released via commit ddff16f6a6b8fee88d497b4653d14d58ccda81b4 including some fixes for Bug 402237.</thetext>
  </long_desc>
      
      

    </bug>

</bugzilla>