<?xml version="1.0" encoding="UTF-8" standalone="yes" ?>
<!DOCTYPE bugzilla SYSTEM "https://bugs.eclipse.org/bugs/page.cgi?id=bugzilla.dtd">

<bugzilla version="4.4.7"
          urlbase="https://bugs.eclipse.org/bugs/"
          
          maintainer="webmaster@eclipse.org"
>

    <bug>
          <bug_id>404251</bug_id>
          
          <creation_ts>2013-03-25 05:02:00 -0400</creation_ts>
          <short_desc>ASTRewriteFlattener#visit(InfixExpression) has error (missing critical whitespace)</short_desc>
          <delta_ts>2013-04-30 18:18:45 -0400</delta_ts>
          <reporter_accessible>1</reporter_accessible>
          <cclist_accessible>1</cclist_accessible>
          <classification_id>2</classification_id>
          <classification>Eclipse</classification>
          <product>JDT</product>
          <component>Core</component>
          <version>3.7.2</version>
          <rep_platform>PC</rep_platform>
          <op_sys>Linux</op_sys>
          <bug_status>VERIFIED</bug_status>
          <resolution>FIXED</resolution>
          
          
          <bug_file_loc></bug_file_loc>
          <status_whiteboard></status_whiteboard>
          <keywords></keywords>
          <priority>P3</priority>
          <bug_severity>normal</bug_severity>
          <target_milestone>4.3 M7</target_milestone>
          
          
          <everconfirmed>1</everconfirmed>
          <reporter name="Dongqing Hu">dawnstar</reporter>
          <assigned_to name="Jay Arthanareeswaran">jarthana</assigned_to>
          <cc>daniel_megert</cc>
    
    <cc>jarthana</cc>
    
    <cc>markus_keller</cc>
    
    <cc>shankhba</cc>
    
    <cc>timo.kinnunen</cc>
          
          <votes>0</votes>

      

      

      <flag name="review"
          id="56327"
          type_id="1"
          status="+"
          setter="markus_keller"
    />

          <comment_sort_order>oldest_to_newest</comment_sort_order>  
          <long_desc isprivate="0" >
    <commentid>2236058</commentid>
    <comment_count>0</comment_count>
      <attachid>228982</attachid>
    <who name="Dongqing Hu">dawnstar</who>
    <bug_when>2013-03-25 05:02:08 -0400</bug_when>
    <thetext>Created attachment 228982
Fix this bug by appending interval whitespaces

Please look at an expression like this:

threadMessagePrefix + &quot;Processing &quot; + ++i + &quot; of &quot; + total + &quot;...&quot;

ASTRewriteFlattener prints it as: 

threadMessagePrefix + &quot;Processing &quot;+++i+&quot; of &quot;+total+&quot;...&quot;

Code is broken because &apos;+++&apos; is an invalid operator.</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>2236060</commentid>
    <comment_count>1</comment_count>
    <who name="Dongqing Hu">dawnstar</who>
    <bug_when>2013-03-25 05:05:13 -0400</bug_when>
    <thetext>LEFT_OPERAND, OPERATOR and RIGHT_OPERAND have interval whitespaces, but EXTENDED_OPERANDS not.</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>2236063</commentid>
    <comment_count>2</comment_count>
    <who name="Jay Arthanareeswaran">jarthana</who>
    <bug_when>2013-03-25 05:12:38 -0400</bug_when>
    <thetext>AST Rewrite shouldn&apos;t be breaking the working code. Since the fix is provided and is simple enough, will consider this for 4.3.</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>2236102</commentid>
    <comment_count>3</comment_count>
      <attachid>228990</attachid>
    <who name="Jay Arthanareeswaran">jarthana</who>
    <bug_when>2013-03-25 06:26:53 -0400</bug_when>
    <thetext>Created attachment 228990
Testcase

Can you tell me which test case your code is trying to fix? There may be other use cases that need to be addressed as well - the patch I have attached contains one such case.</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>2236197</commentid>
    <comment_count>4</comment_count>
    <who name="Dongqing Hu">dawnstar</who>
    <bug_when>2013-03-25 09:13:02 -0400</bug_when>
    <thetext>(In reply to comment #3)
&gt; Created attachment 228990 [details]
&gt; Testcase
&gt; 
&gt; Can you tell me which test case your code is trying to fix? There may be
&gt; other use cases that need to be addressed as well - the patch I have
&gt; attached contains one such case.

This happens on these two cases which are InfixExpression containing extended operands instanceof PrefixExpression:

a + b + ++c

a - b - --c

It becomes a + b+++c and is explained as a+(b++)+c by compiler.</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>2236252</commentid>
    <comment_count>5</comment_count>
    <who name="Jay Arthanareeswaran">jarthana</who>
    <bug_when>2013-03-25 11:09:47 -0400</bug_when>
    <thetext>(In reply to comment #4)
&gt; This happens on these two cases which are InfixExpression containing
&gt; extended operands instanceof PrefixExpression:
&gt; 
&gt; a + b + ++c
&gt; 
&gt; a - b - --c
&gt; 
&gt; It becomes a + b+++c and is explained as a+(b++)+c by compiler.

Some additional information would help. I don&apos;t see any problem with simple refactoring or formatting. Are you seeing this when you do some AST rewrite operation and if so what operation? Thanks!</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>2236291</commentid>
    <comment_count>6</comment_count>
    <who name="Dongqing Hu">dawnstar</who>
    <bug_when>2013-03-25 12:01:35 -0400</bug_when>
    <thetext>(In reply to comment #5)
I encounter it on using #asString(...) method</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>2236561</commentid>
    <comment_count>7</comment_count>
      <attachid>229029</attachid>
    <who name="Jay Arthanareeswaran">jarthana</who>
    <bug_when>2013-03-26 05:44:23 -0400</bug_when>
    <thetext>Created attachment 229029
Alternate fix

Here is an alternate fix - just to make the code consistent with the ASTRewriteAnalyzer#visit(InfixExpression). Patch also include new test. The other scenario I mentioned in my earlier patch requires a more involved fix and concerns a very corner case. I will raise a separate bug for that.</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>2237496</commentid>
    <comment_count>8</comment_count>
    <who name="Timo Kinnunen">timo.kinnunen</who>
    <bug_when>2013-03-27 19:16:56 -0400</bug_when>
    <thetext>I found a similar bug. When Remove unnecessary parentheses Save Action is active, code like this:

int[] array = new int[-(-128)];

is changed to this invalid code:

int[] array = new int[--128];

Is this the same bug or different?</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>2237558</commentid>
    <comment_count>9</comment_count>
    <who name="Jay Arthanareeswaran">jarthana</who>
    <bug_when>2013-03-28 02:45:24 -0400</bug_when>
    <thetext>(In reply to comment #8)
&gt; Is this the same bug or different?

Different. Raised bug 404523 for this.</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>2238452</commentid>
    <comment_count>10</comment_count>
    <who name="Jay Arthanareeswaran">jarthana</who>
    <bug_when>2013-04-02 01:42:37 -0400</bug_when>
    <thetext>Markus, the fix is trivial. Do you have some time to review this? Thanks!</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>2240384</commentid>
    <comment_count>11</comment_count>
    <who name="Markus Keller">markus_keller</who>
    <bug_when>2013-04-05 16:06:56 -0400</bug_when>
    <thetext>(In reply to comment #7)
&gt; Created attachment 229029 [details] [diff]
&gt; Alternate fix

The fix looks good, except for the variable name &quot;prefixString&quot;, which would better be &quot;separator&quot;.

The test doesn&apos;t fit into the ASTRewritingExpressionsTest, since it doesn&apos;t test ASTRewrite. To just test ASTRewriteFlattener, it could be even shorter, but I prefer to test the whole infrastructure. I&apos;ve expanded it a bit and also added a variant with different formatting options (disabled due to bug 405038).

Fixed with http://git.eclipse.org/c/jdt/eclipse.jdt.core.git/commit/?id=6226e48eadf5e71057f66a6dee31727311dc8e25</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>2250742</commentid>
    <comment_count>12</comment_count>
    <who name="shankha banerjee">shankhba</who>
    <bug_when>2013-04-30 14:42:32 -0400</bug_when>
    <thetext>Test case testBug404251 succeeded.

Verified for 3.7 M7 using  build I20130428-2000.</thetext>
  </long_desc>
      
          <attachment
              isobsolete="1"
              ispatch="1"
              isprivate="0"
          >
            <attachid>228982</attachid>
            <date>2013-03-25 05:02:00 -0400</date>
            <delta_ts>2013-03-26 05:44:23 -0400</delta_ts>
            <desc>Fix this bug by appending interval whitespaces</desc>
            <filename>arf.patch</filename>
            <type>text/plain</type>
            <size>777</size>
            <attacher name="Dongqing Hu">dawnstar</attacher>
            
              <data encoding="base64">ZGlmZiAtLWdpdCBhL29yZy5lY2xpcHNlLmpkdC5jb3JlL2RvbS9vcmcvZWNsaXBzZS9qZHQvaW50
ZXJuYWwvY29yZS9kb20vcmV3cml0ZS9BU1RSZXdyaXRlRmxhdHRlbmVyLmphdmEgYi9vcmcuZWNs
aXBzZS5qZHQuY29yZS9kb20vb3JnL2VjbGlwc2UvamR0L2ludGVybmFsL2NvcmUvZG9tL3Jld3Jp
dGUvQVNUUmV3cml0ZUZsYXR0ZW5lci5qYXZhCmluZGV4IDE5NThlNGYuLjM2YjBiMjYgMTAwNjQ0
Ci0tLSBhL29yZy5lY2xpcHNlLmpkdC5jb3JlL2RvbS9vcmcvZWNsaXBzZS9qZHQvaW50ZXJuYWwv
Y29yZS9kb20vcmV3cml0ZS9BU1RSZXdyaXRlRmxhdHRlbmVyLmphdmEKKysrIGIvb3JnLmVjbGlw
c2UuamR0LmNvcmUvZG9tL29yZy9lY2xpcHNlL2pkdC9pbnRlcm5hbC9jb3JlL2RvbS9yZXdyaXRl
L0FTVFJld3JpdGVGbGF0dGVuZXIuamF2YQpAQCAtNTI1LDcgKzUyNSw5IEBAIHB1YmxpYyBjbGFz
cyBBU1RSZXdyaXRlRmxhdHRlbmVyIGV4dGVuZHMgQVNUVmlzaXRvciB7CiAKIAkJTGlzdCBsaXN0
PSBnZXRDaGlsZExpc3Qobm9kZSwgSW5maXhFeHByZXNzaW9uLkVYVEVOREVEX09QRVJBTkRTX1BS
T1BFUlRZKTsKIAkJZm9yIChpbnQgaT0gMDsgaSA8IGxpc3Quc2l6ZSgpOyBpKyspIHsKKwkJCXRo
aXMucmVzdWx0LmFwcGVuZCgnICcpOwogCQkJdGhpcy5yZXN1bHQuYXBwZW5kKG9wZXJhdG9yKTsK
KwkJCXRoaXMucmVzdWx0LmFwcGVuZCgnICcpOwogCQkJKChBU1ROb2RlKSBsaXN0LmdldChpKSku
YWNjZXB0KHRoaXMpOwogCQl9CiAJCXJldHVybiBmYWxzZTsK
</data>

          </attachment>
          <attachment
              isobsolete="1"
              ispatch="1"
              isprivate="0"
          >
            <attachid>228990</attachid>
            <date>2013-03-25 06:26:00 -0400</date>
            <delta_ts>2013-03-26 05:44:23 -0400</delta_ts>
            <desc>Testcase</desc>
            <filename>Testcase-for-404251.patch</filename>
            <type>text/plain</type>
            <size>3227</size>
            <attacher name="Jay Arthanareeswaran">jarthana</attacher>
            
              <data encoding="base64">ZGlmZiAtLWdpdCBhL29yZy5lY2xpcHNlLmpkdC5jb3JlLnRlc3RzLm1vZGVsL3NyYy9vcmcvZWNs
aXBzZS9qZHQvY29yZS90ZXN0cy9yZXdyaXRlL2Rlc2NyaWJpbmcvQVNUUmV3cml0aW5nRXhwcmVz
c2lvbnNUZXN0LmphdmEgYi9vcmcuZWNsaXBzZS5qZHQuY29yZS50ZXN0cy5tb2RlbC9zcmMvb3Jn
L2VjbGlwc2UvamR0L2NvcmUvdGVzdHMvcmV3cml0ZS9kZXNjcmliaW5nL0FTVFJld3JpdGluZ0V4
cHJlc3Npb25zVGVzdC5qYXZhCmluZGV4IGNhODY3OWIuLjA3MWFmZjMgMTAwNjQ0Ci0tLSBhL29y
Zy5lY2xpcHNlLmpkdC5jb3JlLnRlc3RzLm1vZGVsL3NyYy9vcmcvZWNsaXBzZS9qZHQvY29yZS90
ZXN0cy9yZXdyaXRlL2Rlc2NyaWJpbmcvQVNUUmV3cml0aW5nRXhwcmVzc2lvbnNUZXN0LmphdmEK
KysrIGIvb3JnLmVjbGlwc2UuamR0LmNvcmUudGVzdHMubW9kZWwvc3JjL29yZy9lY2xpcHNlL2pk
dC9jb3JlL3Rlc3RzL3Jld3JpdGUvZGVzY3JpYmluZy9BU1RSZXdyaXRpbmdFeHByZXNzaW9uc1Rl
c3QuamF2YQpAQCAtMTcsNSArMTcsNCBAQAogaW1wb3J0IG9yZy5lY2xpcHNlLmpkdC5jb3JlLklD
b21waWxhdGlvblVuaXQ7CiBpbXBvcnQgb3JnLmVjbGlwc2UuamR0LmNvcmUuSVBhY2thZ2VGcmFn
bWVudDsKLQogaW1wb3J0IG9yZy5lY2xpcHNlLmpkdC5jb3JlLmRvbS4qOwogaW1wb3J0IG9yZy5l
Y2xpcHNlLmpkdC5jb3JlLmRvbS5yZXdyaXRlLkFTVFJld3JpdGU7CkBAIC0xNDE5LDQgKzE0MTgs
NjIgQEAKIAogCX0KKwkKKwkvKiogQGRlcHJlY2F0ZWQgdXNpbmcgZGVwcmVjYXRlZCBjb2RlICov
CisJcHVibGljIHZvaWQgdGVzdFByZWZpeEV4cHJlc3Npb25fYSgpIHRocm93cyBFeGNlcHRpb24g
eworCQlJUGFja2FnZUZyYWdtZW50IHBhY2sxPSB0aGlzLnNvdXJjZUZvbGRlci5jcmVhdGVQYWNr
YWdlRnJhZ21lbnQoInRlc3QxIiwgZmFsc2UsIG51bGwpOworCQlTdHJpbmdCdWZmZXIgYnVmPSBu
ZXcgU3RyaW5nQnVmZmVyKCk7CisJCWJ1Zi5hcHBlbmQoInBhY2thZ2UgdGVzdDE7XG4iKTsKKwkJ
YnVmLmFwcGVuZCgicHVibGljIGNsYXNzIEUge1xuIik7CisJCWJ1Zi5hcHBlbmQoIiAgICBwdWJs
aWMgdm9pZCBmb28oKSB7XG4iKTsKKwkJYnVmLmFwcGVuZCgiICAgICAgIGludCBpID0gMCwgdG90
YWwgPSAxMDtcbiIpOworCQlidWYuYXBwZW5kKCIgICAgICAgU3RyaW5nIGEgPSBcIlwiLCBiO1xu
Iik7CisJCWJ1Zi5hcHBlbmQoIiAgICAgICBiID0gYSArIFwiUHJvY2Vzc2luZyAuLi5cIitcIiBv
ZiBcIiArIFwiLi4uXCI7XG4iKTsKKwkJYnVmLmFwcGVuZCgiICAgIH1cbiIpOworCQlidWYuYXBw
ZW5kKCJ9XG4iKTsKKwkJSUNvbXBpbGF0aW9uVW5pdCBjdT0gcGFjazEuY3JlYXRlQ29tcGlsYXRp
b25Vbml0KCJFLmphdmEiLCBidWYudG9TdHJpbmcoKSwgZmFsc2UsIG51bGwpOworCisJCUNvbXBp
bGF0aW9uVW5pdCBhc3RSb290PSBjcmVhdGVBU1QoY3UpOworCQlBU1RSZXdyaXRlIHJld3JpdGU9
IEFTVFJld3JpdGUuY3JlYXRlKGFzdFJvb3QuZ2V0QVNUKCkpOworCisJCUFTVCBhc3Q9IGFzdFJv
b3QuZ2V0QVNUKCk7CisKKwkJYXNzZXJ0VHJ1ZSgiUGFyc2UgZXJyb3JzIiwgKGFzdFJvb3QuZ2V0
RmxhZ3MoKSAmIEFTVE5vZGUuTUFMRk9STUVEKSA9PSAwKTsKKwkJVHlwZURlY2xhcmF0aW9uIHR5
cGU9IGZpbmRUeXBlRGVjbGFyYXRpb24oYXN0Um9vdCwgIkUiKTsKKwkJTWV0aG9kRGVjbGFyYXRp
b24gbWV0aG9kRGVjbD0gZmluZE1ldGhvZERlY2xhcmF0aW9uKHR5cGUsICJmb28iKTsKKwkJQmxv
Y2sgYmxvY2s9IG1ldGhvZERlY2wuZ2V0Qm9keSgpOworCQlMaXN0IHN0YXRlbWVudHM9IGJsb2Nr
LnN0YXRlbWVudHMoKTsKKwkJYXNzZXJ0VHJ1ZSgiTnVtYmVyIG9mIHN0YXRlbWVudHMgbm90IDMi
LCBzdGF0ZW1lbnRzLnNpemUoKSA9PSAzKTsKKwkJeyAvLyBtb2RpZnkgb3BlcmFuZCBhbmQgb3Bl
cmF0aW9uCisJCQlFeHByZXNzaW9uU3RhdGVtZW50IHN0bXQ9IChFeHByZXNzaW9uU3RhdGVtZW50
KSBzdGF0ZW1lbnRzLmdldCgyKTsKKwkJCUFzc2lnbm1lbnQgYXNzaWdubWVudD0gKEFzc2lnbm1l
bnQpIHN0bXQuZ2V0RXhwcmVzc2lvbigpOworCisJCQlJbmZpeEV4cHJlc3Npb24gaW5maXggPSAo
SW5maXhFeHByZXNzaW9uKSBhc3NpZ25tZW50LmdldFJpZ2h0SGFuZFNpZGUoKTsKKwkJCVN0cmlu
Z0xpdGVyYWwgbGl0ZXJhbCA9IChTdHJpbmdMaXRlcmFsKSBpbmZpeC5nZXRSaWdodE9wZXJhbmQo
KTsKKwkJCQorCQkJU3RyaW5nTGl0ZXJhbCBuZXdMaXRlcmFsID0gYXN0Lm5ld1N0cmluZ0xpdGVy
YWwoKTsKKwkJCW5ld0xpdGVyYWwuc2V0TGl0ZXJhbFZhbHVlKCJQcm9jZXNzaW5nIC4uLiIpOwor
CQkJcmV3cml0ZS5yZXBsYWNlKGxpdGVyYWwsIG5ld0xpdGVyYWwsIG51bGwpOworCQkJCisJCQlM
aXN0UmV3cml0ZSBsaXN0UmV3cml0ZSA9IHJld3JpdGUuZ2V0TGlzdFJld3JpdGUoaW5maXgsIElu
Zml4RXhwcmVzc2lvbi5FWFRFTkRFRF9PUEVSQU5EU19QUk9QRVJUWSk7CisJCQlQcmVmaXhFeHBy
ZXNzaW9uIHByZWZpeCA9IGFzdC5uZXdQcmVmaXhFeHByZXNzaW9uKCk7CisJCQlwcmVmaXguc2V0
T3BlcmFuZChhc3QubmV3U2ltcGxlTmFtZSgiaSIpKTsKKwkJCXByZWZpeC5zZXRPcGVyYXRvcihQ
cmVmaXhFeHByZXNzaW9uLk9wZXJhdG9yLklOQ1JFTUVOVCk7CisJCQlsaXN0UmV3cml0ZS5pbnNl
cnRGaXJzdChwcmVmaXgsIG51bGwpOworCQl9CisKKwkJU3RyaW5nIHByZXZpZXc9IGV2YWx1YXRl
UmV3cml0ZShjdSwgcmV3cml0ZSk7CisKKwkJYnVmPSBuZXcgU3RyaW5nQnVmZmVyKCk7CisJCWJ1
Zi5hcHBlbmQoInBhY2thZ2UgdGVzdDE7XG4iKTsKKwkJYnVmLmFwcGVuZCgicHVibGljIGNsYXNz
IEUge1xuIik7CisJCWJ1Zi5hcHBlbmQoIiAgICBwdWJsaWMgdm9pZCBmb28oKSB7XG4iKTsKKwkJ
YnVmLmFwcGVuZCgiICAgICAgIGludCBpID0gMCwgdG90YWwgPSAxMDtcbiIpOworCQlidWYuYXBw
ZW5kKCIgICAgICAgU3RyaW5nIGEgPSBcIlwiLCBiO1xuIik7CisJCWJ1Zi5hcHBlbmQoIiAgICAg
ICBiID0gYSArIFwiUHJvY2Vzc2luZyAuLi5cIisgKytpICsgXCIgb2YgXCIgKyBcIi4uLlwiO1xu
Iik7CisJCWJ1Zi5hcHBlbmQoIiAgICB9XG4iKTsKKwkJYnVmLmFwcGVuZCgifVxuIik7CisJCWFz
c2VydEVxdWFsU3RyaW5nKHByZXZpZXcsIGJ1Zi50b1N0cmluZygpKTsKKworCX0KIAogCS8qKiBA
ZGVwcmVjYXRlZCB1c2luZyBkZXByZWNhdGVkIGNvZGUgKi8=
</data>

          </attachment>
          <attachment
              isobsolete="0"
              ispatch="1"
              isprivate="0"
          >
            <attachid>229029</attachid>
            <date>2013-03-26 05:44:00 -0400</date>
            <delta_ts>2013-03-26 05:44:23 -0400</delta_ts>
            <desc>Alternate fix</desc>
            <filename>Fix-for-bug-404251.patch</filename>
            <type>text/plain</type>
            <size>4534</size>
            <attacher name="Jay Arthanareeswaran">jarthana</attacher>
            
              <data encoding="base64">ZGlmZiAtLWdpdCBhL29yZy5lY2xpcHNlLmpkdC5jb3JlLnRlc3RzLm1vZGVsL3NyYy9vcmcvZWNs
aXBzZS9qZHQvY29yZS90ZXN0cy9yZXdyaXRlL2Rlc2NyaWJpbmcvQVNUUmV3cml0aW5nRXhwcmVz
c2lvbnNUZXN0LmphdmEgYi9vcmcuZWNsaXBzZS5qZHQuY29yZS50ZXN0cy5tb2RlbC9zcmMvb3Jn
L2VjbGlwc2UvamR0L2NvcmUvdGVzdHMvcmV3cml0ZS9kZXNjcmliaW5nL0FTVFJld3JpdGluZ0V4
cHJlc3Npb25zVGVzdC5qYXZhCmluZGV4IGNhODY3OWIuLjAzM2FmNjggMTAwNjQ0Ci0tLSBhL29y
Zy5lY2xpcHNlLmpkdC5jb3JlLnRlc3RzLm1vZGVsL3NyYy9vcmcvZWNsaXBzZS9qZHQvY29yZS90
ZXN0cy9yZXdyaXRlL2Rlc2NyaWJpbmcvQVNUUmV3cml0aW5nRXhwcmVzc2lvbnNUZXN0LmphdmEK
KysrIGIvb3JnLmVjbGlwc2UuamR0LmNvcmUudGVzdHMubW9kZWwvc3JjL29yZy9lY2xpcHNlL2pk
dC9jb3JlL3Rlc3RzL3Jld3JpdGUvZGVzY3JpYmluZy9BU1RSZXdyaXRpbmdFeHByZXNzaW9uc1Rl
c3QuamF2YQpAQCAtMSw0ICsxLDQgQEAKIC8qKioqKioqKioqKioqKioqKioqKioqKioqKioqKioq
KioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqCi0gKiBDb3B5
cmlnaHQgKGMpIDIwMDAsIDIwMTEgSUJNIENvcnBvcmF0aW9uIGFuZCBvdGhlcnMuCisgKiBDb3B5
cmlnaHQgKGMpIDIwMDAsIDIwMTMgSUJNIENvcnBvcmF0aW9uIGFuZCBvdGhlcnMuCiAgKiBBbGwg
cmlnaHRzIHJlc2VydmVkLiBUaGlzIHByb2dyYW0gYW5kIHRoZSBhY2NvbXBhbnlpbmcgbWF0ZXJp
YWxzCiAgKiBhcmUgbWFkZSBhdmFpbGFibGUgdW5kZXIgdGhlIHRlcm1zIG9mIHRoZSBFY2xpcHNl
IFB1YmxpYyBMaWNlbnNlIHYxLjAKQEAgLTE3LDggKzE3LDkgQEAKIGltcG9ydCBvcmcuZWNsaXBz
ZS5qZHQuY29yZS5JQ29tcGlsYXRpb25Vbml0OwogaW1wb3J0IG9yZy5lY2xpcHNlLmpkdC5jb3Jl
LklQYWNrYWdlRnJhZ21lbnQ7Ci0KIGltcG9ydCBvcmcuZWNsaXBzZS5qZHQuY29yZS5kb20uKjsK
IGltcG9ydCBvcmcuZWNsaXBzZS5qZHQuY29yZS5kb20ucmV3cml0ZS5BU1RSZXdyaXRlOwogaW1w
b3J0IG9yZy5lY2xpcHNlLmpkdC5jb3JlLmRvbS5yZXdyaXRlLkxpc3RSZXdyaXRlOworaW1wb3J0
IG9yZy5lY2xpcHNlLmpkdC5pbnRlcm5hbC5jb3JlLmRvbS5yZXdyaXRlLkFTVFJld3JpdGVGbGF0
dGVuZXI7CitpbXBvcnQgb3JnLmVjbGlwc2UuamR0LmludGVybmFsLmNvcmUuZG9tLnJld3JpdGUu
UmV3cml0ZUV2ZW50U3RvcmU7CiAKIHB1YmxpYyBjbGFzcyBBU1RSZXdyaXRpbmdFeHByZXNzaW9u
c1Rlc3QgZXh0ZW5kcyBBU1RSZXdyaXRpbmdUZXN0IHsKQEAgLTIxNDYsNCArMjE0Nyw0NyBAQAog
CiAJfQorCS8vIGh0dHBzOi8vYnVncy5lY2xpcHNlLm9yZy9idWdzL3Nob3dfYnVnLmNnaT9pZD00
MDQyNTEKKwlwdWJsaWMgdm9pZCB0ZXN0QnVnNDA0MjUxKCkgdGhyb3dzIEV4Y2VwdGlvbiB7CisJ
CUlQYWNrYWdlRnJhZ21lbnQgcGFjazE9IHRoaXMuc291cmNlRm9sZGVyLmNyZWF0ZVBhY2thZ2VG
cmFnbWVudCgidGVzdDEiLCBmYWxzZSwgbnVsbCk7CisJCVN0cmluZ0J1ZmZlciBidWY9IG5ldyBT
dHJpbmdCdWZmZXIoKTsKKwkJYnVmLmFwcGVuZCgicGFja2FnZSB0ZXN0MTtcbiIpOworCQlidWYu
YXBwZW5kKCJwdWJsaWMgY2xhc3MgRSB7XG4iKTsKKwkJYnVmLmFwcGVuZCgiICAgIHB1YmxpYyB2
b2lkIGZvbygpIHtcbiIpOworCQlidWYuYXBwZW5kKCIgICAgICAgaW50IHRvdGFsO1xuIik7CisJ
CWJ1Zi5hcHBlbmQoIiAgICAgICBpbnQgYSA9IDAsIGIgPSA1LCBjID0gMTA7XG4iKTsKKwkJYnVm
LmFwcGVuZCgiICAgICAgIHRvdGFsID0gYSArIGIgKyArK2M7XG4iKTsKKwkJYnVmLmFwcGVuZCgi
ICAgIH1cbiIpOworCQlidWYuYXBwZW5kKCJ9XG4iKTsKKwkJSUNvbXBpbGF0aW9uVW5pdCBjdT0g
cGFjazEuY3JlYXRlQ29tcGlsYXRpb25Vbml0KCJFLmphdmEiLCBidWYudG9TdHJpbmcoKSwgZmFs
c2UsIG51bGwpOworCisJCUNvbXBpbGF0aW9uVW5pdCBhc3RSb290PSBjcmVhdGVBU1QoY3UpOwor
CQlBU1RSZXdyaXRlIHJld3JpdGU9IEFTVFJld3JpdGUuY3JlYXRlKGFzdFJvb3QuZ2V0QVNUKCkp
OworCisJCWFzc2VydFRydWUoIlBhcnNlIGVycm9ycyIsIChhc3RSb290LmdldEZsYWdzKCkgJiBB
U1ROb2RlLk1BTEZPUk1FRCkgPT0gMCk7CisJCVR5cGVEZWNsYXJhdGlvbiB0eXBlPSBmaW5kVHlw
ZURlY2xhcmF0aW9uKGFzdFJvb3QsICJFIik7CisJCU1ldGhvZERlY2xhcmF0aW9uIG1ldGhvZERl
Y2w9IGZpbmRNZXRob2REZWNsYXJhdGlvbih0eXBlLCAiZm9vIik7CisJCUJsb2NrIGJsb2NrPSBt
ZXRob2REZWNsLmdldEJvZHkoKTsKKwkJTGlzdCBzdGF0ZW1lbnRzPSBibG9jay5zdGF0ZW1lbnRz
KCk7CisJCWFzc2VydFRydWUoIk51bWJlciBvZiBzdGF0ZW1lbnRzIG5vdCAzIiwgc3RhdGVtZW50
cy5zaXplKCkgPT0gMyk7CisJCXsgLy8gbW9kaWZ5IG9wZXJhbmQgYW5kIG9wZXJhdGlvbgorCQkJ
RXhwcmVzc2lvblN0YXRlbWVudCBzdG10PSAoRXhwcmVzc2lvblN0YXRlbWVudCkgc3RhdGVtZW50
cy5nZXQoMik7CisJCQlBc3NpZ25tZW50IGFzc2lnbm1lbnQ9IChBc3NpZ25tZW50KSBzdG10Lmdl
dEV4cHJlc3Npb24oKTsKKwkJCUluZml4RXhwcmVzc2lvbiBpbmZpeCA9IChJbmZpeEV4cHJlc3Np
b24pIGFzc2lnbm1lbnQuZ2V0UmlnaHRIYW5kU2lkZSgpOworCQkJYXNzZXJ0RXF1YWxzKCJJbmNv
cnJlY3QgZXhwcmVzc2lvbiIsICJhICsgYiArICsrYyIsIEFTVFJld3JpdGVGbGF0dGVuZXIuYXNT
dHJpbmcoaW5maXgsIG5ldyBSZXdyaXRlRXZlbnRTdG9yZSgpKSk7CisJCX0KKworCQlTdHJpbmcg
cHJldmlldz0gZXZhbHVhdGVSZXdyaXRlKGN1LCByZXdyaXRlKTsKKworCQlidWY9IG5ldyBTdHJp
bmdCdWZmZXIoKTsKKwkJYnVmLmFwcGVuZCgicGFja2FnZSB0ZXN0MTtcbiIpOworCQlidWYuYXBw
ZW5kKCJwdWJsaWMgY2xhc3MgRSB7XG4iKTsKKwkJYnVmLmFwcGVuZCgiICAgIHB1YmxpYyB2b2lk
IGZvbygpIHtcbiIpOworCQlidWYuYXBwZW5kKCIgICAgICAgaW50IHRvdGFsO1xuIik7CisJCWJ1
Zi5hcHBlbmQoIiAgICAgICBpbnQgYSA9IDAsIGIgPSA1LCBjID0gMTA7XG4iKTsKKwkJYnVmLmFw
cGVuZCgiICAgICAgIHRvdGFsID0gYSArIGIgKyArK2M7XG4iKTsKKwkJYnVmLmFwcGVuZCgiICAg
IH1cbiIpOworCQlidWYuYXBwZW5kKCJ9XG4iKTsKKwkJYXNzZXJ0RXF1YWxTdHJpbmcocHJldmll
dywgYnVmLnRvU3RyaW5nKCkpOworCX0KIAogfQpkaWZmIC0tZ2l0IGEvb3JnLmVjbGlwc2UuamR0
LmNvcmUvZG9tL29yZy9lY2xpcHNlL2pkdC9pbnRlcm5hbC9jb3JlL2RvbS9yZXdyaXRlL0FTVFJl
d3JpdGVGbGF0dGVuZXIuamF2YSBiL29yZy5lY2xpcHNlLmpkdC5jb3JlL2RvbS9vcmcvZWNsaXBz
ZS9qZHQvaW50ZXJuYWwvY29yZS9kb20vcmV3cml0ZS9BU1RSZXdyaXRlRmxhdHRlbmVyLmphdmEK
aW5kZXggMTk1OGU0Zi4uOWVjNWIyZCAxMDA2NDQKLS0tIGEvb3JnLmVjbGlwc2UuamR0LmNvcmUv
ZG9tL29yZy9lY2xpcHNlL2pkdC9pbnRlcm5hbC9jb3JlL2RvbS9yZXdyaXRlL0FTVFJld3JpdGVG
bGF0dGVuZXIuamF2YQorKysgYi9vcmcuZWNsaXBzZS5qZHQuY29yZS9kb20vb3JnL2VjbGlwc2Uv
amR0L2ludGVybmFsL2NvcmUvZG9tL3Jld3JpdGUvQVNUUmV3cml0ZUZsYXR0ZW5lci5qYXZhCkBA
IC0xLDQgKzEsNCBAQAogLyoqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioq
KioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioKLSAqIENvcHlyaWdodCAoYykg
MjAwMCwgMjAxMiBJQk0gQ29ycG9yYXRpb24gYW5kIG90aGVycy4KKyAqIENvcHlyaWdodCAoYykg
MjAwMCwgMjAxMyBJQk0gQ29ycG9yYXRpb24gYW5kIG90aGVycy4KICAqIEFsbCByaWdodHMgcmVz
ZXJ2ZWQuIFRoaXMgcHJvZ3JhbSBhbmQgdGhlIGFjY29tcGFueWluZyBtYXRlcmlhbHMKICAqIGFy
ZSBtYWRlIGF2YWlsYWJsZSB1bmRlciB0aGUgdGVybXMgb2YgdGhlIEVjbGlwc2UgUHVibGljIExp
Y2Vuc2UgdjEuMApAQCAtNTI0LDkgKzUyNCw2IEBACiAJCWdldENoaWxkTm9kZShub2RlLCBJbmZp
eEV4cHJlc3Npb24uUklHSFRfT1BFUkFORF9QUk9QRVJUWSkuYWNjZXB0KHRoaXMpOwogCi0JCUxp
c3QgbGlzdD0gZ2V0Q2hpbGRMaXN0KG5vZGUsIEluZml4RXhwcmVzc2lvbi5FWFRFTkRFRF9PUEVS
QU5EU19QUk9QRVJUWSk7Ci0JCWZvciAoaW50IGk9IDA7IGkgPCBsaXN0LnNpemUoKTsgaSsrKSB7
Ci0JCQl0aGlzLnJlc3VsdC5hcHBlbmQob3BlcmF0b3IpOwotCQkJKChBU1ROb2RlKSBsaXN0Lmdl
dChpKSkuYWNjZXB0KHRoaXMpOwotCQl9CisJCVN0cmluZyBwcmVmaXhTdHJpbmc9ICcgJyArIG9w
ZXJhdG9yICsgJyAnOworCQl2aXNpdExpc3Qobm9kZSwgSW5maXhFeHByZXNzaW9uLkVYVEVOREVE
X09QRVJBTkRTX1BST1BFUlRZLCBwcmVmaXhTdHJpbmcsIHByZWZpeFN0cmluZywgVXRpbC5FTVBU
WV9TVFJJTkcpOwogCQlyZXR1cm4gZmFsc2U7CiAJfQ==
</data>

          </attachment>
      

    </bug>

</bugzilla>