<?xml version="1.0" encoding="UTF-8" standalone="yes" ?>
<!DOCTYPE bugzilla SYSTEM "https://bugs.eclipse.org/bugs/page.cgi?id=bugzilla.dtd">

<bugzilla version="4.4.7"
          urlbase="https://bugs.eclipse.org/bugs/"
          
          maintainer="webmaster@eclipse.org"
>

    <bug>
          <bug_id>384600</bug_id>
          
          <creation_ts>2012-07-09 08:48:00 -0400</creation_ts>
          <short_desc>[1.8] &apos;this&apos; should not be allowed in lambda/Reference expressions in contexts that don&apos;t allow it</short_desc>
          <delta_ts>2013-02-05 10:56:55 -0500</delta_ts>
          <reporter_accessible>1</reporter_accessible>
          <cclist_accessible>1</cclist_accessible>
          <classification_id>2</classification_id>
          <classification>Eclipse</classification>
          <product>JDT</product>
          <component>Core</component>
          <version>3.8</version>
          <rep_platform>All</rep_platform>
          <op_sys>All</op_sys>
          <bug_status>RESOLVED</bug_status>
          <resolution>FIXED</resolution>
          
          
          <bug_file_loc></bug_file_loc>
          <status_whiteboard></status_whiteboard>
          <keywords></keywords>
          <priority>P3</priority>
          <bug_severity>normal</bug_severity>
          <target_milestone>BETA J8</target_milestone>
          
          <blocked>382701</blocked>
          <everconfirmed>1</everconfirmed>
          <reporter name="Ayushman Jain">amj87.iitr</reporter>
          <assigned_to name="Jesper Moller">jesper</assigned_to>
          <cc>anchakrk</cc>
    
    <cc>jarthana</cc>
    
    <cc>jesper</cc>
    
    <cc>srikanth_sankaran</cc>
          
          <votes>0</votes>

      

      

      

          <comment_sort_order>oldest_to_newest</comment_sort_order>  
          <long_desc isprivate="0" >
    <commentid>2134442</commentid>
    <comment_count>0</comment_count>
    <who name="Ayushman Jain">amj87.iitr</who>
    <bug_when>2012-07-09 08:48:37 -0400</bug_when>
    <thetext>BETA_JAVA8

&apos;this&apos; keyword should not be allowed inside a lambda expression when the enclosing context does not allow &apos;this&apos; to be used. Example:
public class Action&lt;T&gt; {
	
    public void f1(Object o) {}
    public void foo() {

    	f1( (t) -&gt; { if (t == 1) return t; else return this;} ) ; 
}
}

This is in accordance with JLS 15.8.3</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>2201682</commentid>
    <comment_count>1</comment_count>
    <who name="Jesper Moller">jesper</who>
    <bug_when>2013-01-11 05:36:40 -0500</bug_when>
    <thetext>(In reply to comment #0)

Shouldn&apos;t that be &apos;public static void foo()&apos;, otherwise I don&apos;t see the problem?</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>2202244</commentid>
    <comment_count>2</comment_count>
    <who name="Srikanth Sankaran">srikanth_sankaran</who>
    <bug_when>2013-01-14 00:33:04 -0500</bug_when>
    <thetext>(In reply to comment #1)
&gt; (In reply to comment #0)
&gt; 
&gt; Shouldn&apos;t that be &apos;public static void foo()&apos;, otherwise I don&apos;t see the
&gt; problem?

Yes, I think so.</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>2202357</commentid>
    <comment_count>3</comment_count>
    <who name="Jesper Moller">jesper</who>
    <bug_when>2013-01-14 07:17:57 -0500</bug_when>
    <thetext>I&apos;ve worked on this, and also bug 382727 and got that fixed, by introducing a class LambdaScope which inherits from MethodScope. And that&apos;s when I found out how much Lambda stuff is missing (resolution, target (poly)types, effectively finals, code generation).

Are you interested in patches as I go along, or has you or somebody been working on this since July? Aren&apos;t you targetting Kepler SR1?</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>2202777</commentid>
    <comment_count>4</comment_count>
    <who name="Srikanth Sankaran">srikanth_sankaran</who>
    <bug_when>2013-01-15 00:28:48 -0500</bug_when>
    <thetext>(In reply to comment #3)
&gt; I&apos;ve worked on this, and also bug 382727 and got that fixed, by introducing
&gt; a class LambdaScope which inherits from MethodScope. And that&apos;s when I found
&gt; out how much Lambda stuff is missing (resolution, target (poly)types,
&gt; effectively finals, code generation).

We lost several people in the project and were a long period down to just
down to 2 engineers which was just enough to keep the Kepler release going.
We will be back at full strength end of this month, though the new engineers
will be in training mode for some time to come.

&gt; Are you interested in patches as I go along, or has you or somebody been
&gt; working on this since July? Aren&apos;t you targetting Kepler SR1?

Anirbhan is working on implementing sematic analysis support for lambda
bug 382701. Once he hooks up the new AST nodes in the resolution code
path properly, the semantic analysis project itself can broken down into
several smaller bugs with patches from you being welcome on them.

At any rate, I invite you to attach a patch with your solution already.</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>2202903</commentid>
    <comment_count>5</comment_count>
    <who name="Jesper Moller">jesper</who>
    <bug_when>2013-01-15 05:54:27 -0500</bug_when>
    <thetext>(In reply to comment #4)
&gt; Anirbhan is working on implementing sematic analysis support for lambda
&gt; bug 382701. Once he hooks up the new AST nodes in the resolution code
&gt; path properly, the semantic analysis project itself can broken down into
&gt; several smaller bugs with patches from you being welcome on them.

Great. I guess I could also help by writing some tests for the corner cases.

&gt; At any rate, I invite you to attach a patch with your solution already.

I will do.</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>2210994</commentid>
    <comment_count>6</comment_count>
    <who name="Srikanth Sankaran">srikanth_sankaran</who>
    <bug_when>2013-02-01 04:57:35 -0500</bug_when>
    <thetext>Tests released via commit: 414cc8525a87bc9f40f1eed7291fabbec694c674.

Fix was part of commit: 30ba2db951e79b89a330e1209e461b1c083d6de3 authored
by Jesper.</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>2210995</commentid>
    <comment_count>7</comment_count>
    <who name="Srikanth Sankaran">srikanth_sankaran</who>
    <bug_when>2013-02-01 05:02:10 -0500</bug_when>
    <thetext>Actually, this bugs talks about only about lambda and that part is handled.
I am reopening and broadening it to include reference expressions.

The following code should not compile, but does:

// ---
interface I {
	void doit();
}
public class X {
	static void foo() {
		I i = this::foo;
	}
}</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>2212396</commentid>
    <comment_count>8</comment_count>
    <who name="Srikanth Sankaran">srikanth_sankaran</who>
    <bug_when>2013-02-05 10:56:55 -0500</bug_when>
    <thetext>Fix and tests released via http://git.eclipse.org/c/jdt/eclipse.jdt.core.git/commit/?h=BETA_JAVA8&amp;id=a6e44391963b63fa0c27651827313192cc7a80a0</thetext>
  </long_desc>
      
      

    </bug>

</bugzilla>