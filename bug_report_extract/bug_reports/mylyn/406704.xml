<?xml version="1.0" encoding="UTF-8" standalone="yes" ?>
<!DOCTYPE bugzilla SYSTEM "https://bugs.eclipse.org/bugs/page.cgi?id=bugzilla.dtd">

<bugzilla version="4.4.7"
          urlbase="https://bugs.eclipse.org/bugs/"
          
          maintainer="webmaster@eclipse.org"
>

    <bug>
          <bug_id>406704</bug_id>
          
          <creation_ts>2013-04-26 17:05:00 -0400</creation_ts>
          <short_desc>[regression] NPE when opening review</short_desc>
          <delta_ts>2013-05-21 23:47:49 -0400</delta_ts>
          <reporter_accessible>1</reporter_accessible>
          <cclist_accessible>1</cclist_accessible>
          <classification_id>14</classification_id>
          <classification>Mylyn</classification>
          <product>Mylyn Reviews</product>
          <component>Gerrit Connector</component>
          <version>unspecified</version>
          <rep_platform>PC</rep_platform>
          <op_sys>All</op_sys>
          <bug_status>RESOLVED</bug_status>
          <resolution>FIXED</resolution>
          
          
          <bug_file_loc></bug_file_loc>
          <status_whiteboard></status_whiteboard>
          <keywords></keywords>
          <priority>P3</priority>
          <bug_severity>normal</bug_severity>
          <target_milestone>2.0</target_milestone>
          
          
          <everconfirmed>1</everconfirmed>
          <reporter name="Steffen Pingel">steffen.pingel</reporter>
          <assigned_to name="Miles Parker">milesparker</assigned_to>
          <cc>sam.davis</cc>
    
    <cc>tomasz.zarna</cc>
          
          <votes>0</votes>

      

      

      

          <comment_sort_order>oldest_to_newest</comment_sort_order>  
          <long_desc isprivate="0" >
    <commentid>2249224</commentid>
    <comment_count>0</comment_count>
    <who name="Steffen Pingel">steffen.pingel</who>
    <bug_when>2013-04-26 17:05:35 -0400</bug_when>
    <thetext>What steps will reproduce the problem?
1. Open a review with an incoming
 
Not sure what triggered problem but the review didn&apos;t open as expected. It worked fine after that.

-- Error Details --
Date: Fri Apr 26 23:02:46 CEST 2013
Message: An internal error occurred during: &quot;Retrieving Review xxxx&quot;.
Severity: Error
Product: Eclipse SDK 3.8.2.v201301310800 (org.eclipse.sdk.ide)
Plugin: org.eclipse.core.jobs
Session Data:
eclipse.buildId=unknown
java.version=1.7.0_10
java.vendor=Oracle Corporation
BootLoader constants: OS=linux, ARCH=x86_64, WS=gtk, NL=en_CA

Exception Stack Trace:
java.lang.NullPointerException
	at org.eclipse.mylyn.tasks.core.RepositoryStatus.createStatus(RepositoryStatus.java:160)
	at org.eclipse.mylyn.internal.gerrit.core.GerritConnector.createErrorStatus(GerritConnector.java:412)
	at org.eclipse.mylyn.internal.gerrit.core.GerritConnector.toStatus(GerritConnector.java:394)
	at org.eclipse.mylyn.internal.gerrit.core.GerritConnector.toCoreException(GerritConnector.java:379)
	at org.eclipse.mylyn.internal.gerrit.core.remote.GerritReviewRemoteFactory.pull(GerritReviewRemoteFactory.java:124)
	at org.eclipse.mylyn.internal.gerrit.core.remote.GerritReviewRemoteFactory.pull(GerritReviewRemoteFactory.java:1)
	at org.eclipse.mylyn.reviews.core.spi.remote.emf.RemoteEmfConsumer.pull(RemoteEmfConsumer.java:154)
	at org.eclipse.mylyn.reviews.core.spi.remote.JobRemoteService$1$1.run(JobRemoteService.java:63)
	at org.eclipse.core.internal.jobs.Worker.run(Worker.java:54)</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>2249231</commentid>
    <comment_count>1</comment_count>
    <who name="Miles Parker">milesparker</who>
    <bug_when>2013-04-26 17:11:11 -0400</bug_when>
    <thetext>Yep, I know exactly what the issue is here. I&apos;ve got it fixed in the persistence stuff, but I&apos;ll break the fix out of that.</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>2249281</commentid>
    <comment_count>2</comment_count>
    <who name="Miles Parker">milesparker</who>
    <bug_when>2013-04-26 20:05:11 -0400</bug_when>
    <thetext>Steffen, at least this should get you a  proper diagnostic. I&apos;m not sure if you can reproduce the issue that caused this or not, but simply disconnecting the network should probably do it, since we don&apos;t actually have repositories associated with reviews yet. I&apos;m also going to put in a change to the Repository API -- seems like there should be a null check there as well..anyway, please verify if you can.

https://git.eclipse.org/r/#/c/12263/</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>2249283</commentid>
    <comment_count>3</comment_count>
    <who name="Miles Parker">milesparker</who>
    <bug_when>2013-04-26 20:09:12 -0400</bug_when>
    <thetext>For Tasks null check, please see https://git.eclipse.org/r/#/c/12264/</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>2250040</commentid>
    <comment_count>4</comment_count>
    <who name="Miles Parker">milesparker</who>
    <bug_when>2013-04-29 14:40:29 -0400</bug_when>
    <thetext>*** Bug 406834 has been marked as a duplicate of this bug. ***</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>2250695</commentid>
    <comment_count>5</comment_count>
    <who name="Sam Davis">sam.davis</who>
    <bug_when>2013-04-30 13:18:31 -0400</bug_when>
    <thetext>I think this may be the exception that was getting hidden by the NPE. I think I often (but not necessarily exclusively) get this when I first open a review after restarting.

org.eclipse.core.runtime.CoreException: Problem while retrieving Gerrit review.: Gerrit connection issue: Invalid xsrfKey in request (Repository Unknown)
	at org.eclipse.mylyn.internal.gerrit.core.GerritConnector.toCoreException(GerritConnector.java:379)
	at org.eclipse.mylyn.internal.gerrit.core.remote.GerritReviewRemoteFactory.pull(GerritReviewRemoteFactory.java:123)
	at org.eclipse.mylyn.internal.gerrit.core.remote.GerritReviewRemoteFactory.pull(GerritReviewRemoteFactory.java:1)
	at org.eclipse.mylyn.reviews.core.spi.remote.emf.RemoteEmfConsumer.pull(RemoteEmfConsumer.java:154)
	at org.eclipse.mylyn.reviews.core.spi.remote.JobRemoteService$1$1.run(JobRemoteService.java:63)
	at org.eclipse.core.internal.jobs.Worker.run(Worker.java:54)</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>2250702</commentid>
    <comment_count>6</comment_count>
    <who name="Miles Parker">milesparker</who>
    <bug_when>2013-04-30 13:34:05 -0400</bug_when>
    <thetext>Ok, I think I may have a handle on why this one is happened as well. See also bug 376788. bug 406256.</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>2252313</commentid>
    <comment_count>7</comment_count>
    <who name="Sam Davis">sam.davis</who>
    <bug_when>2013-05-03 17:08:03 -0400</bug_when>
    <thetext>Looks like there&apos;s at least one more case where a status is created with a null repo. They should probably all be checked to ensure this can&apos;t happen.


java.lang.NullPointerException
	at org.eclipse.mylyn.internal.gerrit.core.GerritConnector.toStatus(GerritConnector.java:396)
	at org.eclipse.mylyn.internal.gerrit.core.GerritConnector.toCoreException(GerritConnector.java:379)
	at org.eclipse.mylyn.internal.gerrit.core.remote.GerritReviewRemoteFactory.pull(GerritReviewRemoteFactory.java:121)
	at org.eclipse.mylyn.internal.gerrit.core.remote.GerritReviewRemoteFactory.pull(GerritReviewRemoteFactory.java:1)
	at org.eclipse.mylyn.reviews.core.spi.remote.emf.RemoteEmfConsumer.pull(RemoteEmfConsumer.java:154)
	at org.eclipse.mylyn.reviews.core.spi.remote.JobRemoteService$1$1.run(JobRemoteService.java:63)
	at org.eclipse.core.internal.jobs.Worker.run(Worker.java:54)</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>2253729</commentid>
    <comment_count>8</comment_count>
    <who name="Miles Parker">milesparker</who>
    <bug_when>2013-05-07 18:10:26 -0400</bug_when>
    <thetext>https://git.eclipse.org/r/#/c/12602/

I&apos;d hoped to just rely on upcoming fix in persistence work, but I&apos;m not sure that will be merged so we should at least get this one in for M7.</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>2260616</commentid>
    <comment_count>9</comment_count>
    <who name="Miles Parker">milesparker</who>
    <bug_when>2013-05-21 23:47:49 -0400</bug_when>
    <thetext>(Fixed in M7.)</thetext>
  </long_desc>
      
      

    </bug>

</bugzilla>