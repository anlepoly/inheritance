<?xml version="1.0" encoding="UTF-8" standalone="yes" ?>
<!DOCTYPE bugzilla SYSTEM "https://bugs.eclipse.org/bugs/page.cgi?id=bugzilla.dtd">

<bugzilla version="4.4.7"
          urlbase="https://bugs.eclipse.org/bugs/"
          
          maintainer="webmaster@eclipse.org"
>

    <bug>
          <bug_id>350679</bug_id>
          
          <creation_ts>2011-06-29 06:45:00 -0400</creation_ts>
          <short_desc>support searching for reviews by abbreviated and full hash</short_desc>
          <delta_ts>2011-08-19 09:48:07 -0400</delta_ts>
          <reporter_accessible>1</reporter_accessible>
          <cclist_accessible>1</cclist_accessible>
          <classification_id>14</classification_id>
          <classification>Mylyn</classification>
          <product>Mylyn Reviews</product>
          <component>Gerrit Connector</component>
          <version>0.8</version>
          <rep_platform>PC</rep_platform>
          <op_sys>All</op_sys>
          <bug_status>RESOLVED</bug_status>
          <resolution>FIXED</resolution>
          
          
          <bug_file_loc></bug_file_loc>
          <status_whiteboard></status_whiteboard>
          <keywords></keywords>
          <priority>P3</priority>
          <bug_severity>enhancement</bug_severity>
          <target_milestone>0.9</target_milestone>
          
          
          <everconfirmed>1</everconfirmed>
          <reporter name="Alex Blewitt">alex.blewitt</reporter>
          <assigned_to name="Steffen Pingel">steffen.pingel</assigned_to>
          <cc>kevin</cc>
    
    <cc>matthias.sohn</cc>
    
    <cc>sascha.scholz</cc>
          
          <votes>0</votes>

      

      

      

          <comment_sort_order>oldest_to_newest</comment_sort_order>  
          <long_desc isprivate="0" >
    <commentid>1957592</commentid>
    <comment_count>0</comment_count>
    <who name="Alex Blewitt">alex.blewitt</who>
    <bug_when>2011-06-29 06:45:30 -0400</bug_when>
    <thetext>When using the &apos;Find by ID&apos; for Gerrit, the IDs seem to be limited to the 8+1-digit key such as I5fdc948c. In fact, the full ID is I5fdc948c8e64f6d530b75e70bf8d7cc09ad3a7f7 and can be selected (via the Gerrit user interface) with any unique shortening of this, including I5fdc948c8e64f6d530b75e70b and I5fdc.

Whilst the ID shown in the title might conventionally be truncated for viewing purposes, being able to only find them by this shortened ID means you can&apos;t copy and paste the Change-Id from a commit into Mylyn reviews, nor a shorter abbreviation.

The Gerrit review connector should probably use the full ID (I5fdc948c8e64f6d530b75e70bf8d7cc09ad3a7f7) and then truncate for view purposes, as well as allowing the search to be implicitly wildcarded e.g. I5fdc*</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>1957598</commentid>
    <comment_count>1</comment_count>
    <who name="Alex Blewitt">alex.blewitt</who>
    <bug_when>2011-06-29 06:51:07 -0400</bug_when>
    <thetext>In fact, it seems that it only finds it if you have previously got the task loaded. I found that if I looked for Ia659100f then it wouldn&apos;t show up, despite being in the remote repository but not previously loaded.</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>1957599</commentid>
    <comment_count>2</comment_count>
    <who name="Alex Blewitt">alex.blewitt</who>
    <bug_when>2011-06-29 06:52:17 -0400</bug_when>
    <thetext>(The error message is Invalid {{ID}}, running against Gerrit 2.1.7)</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>1958436</commentid>
    <comment_count>3</comment_count>
    <who name="Matthias Sohn">matthias.sohn</who>
    <bug_when>2011-06-30 10:44:16 -0400</bug_when>
    <thetext>Mylyn Reviews is another product</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>1958464</commentid>
    <comment_count>4</comment_count>
    <who name="Steffen Pingel">steffen.pingel</who>
    <bug_when>2011-06-30 11:19:14 -0400</bug_when>
    <thetext>Thanks for the bug report Alex. The connector only supports searching by numeric ID. I agree that it should also allow searching by shortened and full hash.</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>1958533</commentid>
    <comment_count>5</comment_count>
    <who name="Alex Blewitt">alex.blewitt</who>
    <bug_when>2011-06-30 13:22:16 -0400</bug_when>
    <thetext>Ah, so the concept of numeric ID in Gerrit doesn&apos;t really make sense. The command lines deal with a numeric value, but that&apos;s a sequence number which is related to the changes as they were appended rather than an identifer per se. It exposes itself in the &apos;git fetch&apos; e.g. &quot;git fetch http://localhost:8080/p/test refs/changes/19/19/1 &amp;&amp; git checkout FETCH_HEAD&quot; but otherwise isn&apos;t really known about.

So this should be an enhancement for finding by other means, including the (abbreviated) hash. Note that if the string was passed as is to Gerrit, then Gerrit could figure it out, rather than having a task ID finder in Mylyn which uses the (internal) reference.

It may make sense to key the change by its full Change-Id, rather than numeric id, for its references in Mylyn. As we move from a post-SQL world, I&apos;m not even sure that unique numeric ID will stay around - but you could probably find out from Shawn if there are any plans in that direction.</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>1970488</commentid>
    <comment_count>6</comment_count>
    <who name="Steffen Pingel">steffen.pingel</who>
    <bug_when>2011-07-26 13:53:04 -0400</bug_when>
    <thetext>Yes, we may end up having to abandon the numeric ID altogether since it has been deprecated and may go away entirely at some point. In Gerrit 2.1.x, the API still uses it to identify changes but that is bound to change. Sascha, do you happen to know in which Gerrit release hashes will entirely replace numeric IDs?</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>1970838</commentid>
    <comment_count>7</comment_count>
    <who name="Sascha Scholz">sascha.scholz</who>
    <bug_when>2011-07-27 05:55:55 -0400</bug_when>
    <thetext>I don&apos;t know when (and if at all) the deprecated numeric id in Gerrit will be removed. I think we should support both numeric id and the I-key in the search.</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>1981559</commentid>
    <comment_count>8</comment_count>
    <who name="Steffen Pingel">steffen.pingel</who>
    <bug_when>2011-08-19 08:38:01 -0400</bug_when>
    <thetext>I have added support for looking up the id from the hash in GerritClient.getChange() in ba465ea4caca4f5479eb8d8085af0319d4394f20. It is now possible to open reviews by full change-id. 

Unfortunately Gerrit does not support searching by abbreviated change-id so we are not able to support this on the client until that&apos;s fixed: http://code.google.com/p/gerrit/issues/detail?id=1101</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>1981563</commentid>
    <comment_count>9</comment_count>
    <who name="Alex Blewitt">alex.blewitt</who>
    <bug_when>2011-08-19 08:48:49 -0400</bug_when>
    <thetext>(In reply to comment #8)
&gt; Unfortunately Gerrit does not support searching by abbreviated change-id so we
&gt; are not able to support this on the client until that&apos;s fixed:
&gt; http://code.google.com/p/gerrit/issues/detail?id=1101

This is not true.

Go into Eclipse EGit (http://egit.eclipse.org) and put 32d6035 in the search field. You will be taken to commit 32d6035f091040c1f0b96ccba369eb755eb8c7c5

Alex</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>1981565</commentid>
    <comment_count>10</comment_count>
    <who name="Alex Blewitt">alex.blewitt</who>
    <bug_when>2011-08-19 08:51:18 -0400</bug_when>
    <thetext>(In reply to comment #9)
&gt; (In reply to comment #8)
&gt; &gt; Unfortunately Gerrit does not support searching by abbreviated change-id so we

My mistake, I thought this was for abbreviated commit, not just the change ID. I agree that for the change ID it does not support partial strings.</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>1981570</commentid>
    <comment_count>11</comment_count>
    <who name="Matthias Sohn">matthias.sohn</who>
    <bug_when>2011-08-19 09:03:27 -0400</bug_when>
    <thetext>(In reply to comment #8)
...
&gt; Unfortunately Gerrit does not support searching by abbreviated change-id so we
&gt; are not able to support this on the client until that&apos;s fixed:
&gt; http://code.google.com/p/gerrit/issues/detail?id=1101

AFAIK this depends on the underlying database platform, I just tried and found it works on postgres and doesn&apos;t work on MySQL</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>1981629</commentid>
    <comment_count>12</comment_count>
    <who name="Steffen Pingel">steffen.pingel</who>
    <bug_when>2011-08-19 09:48:07 -0400</bug_when>
    <thetext>Interesting. I have added a note to the Gerrit issue.

Alex, as a side effect of the change you should be able to open Gerrit reviews by commit ids now as well (it works for any query string that returns a single result).</thetext>
  </long_desc>
      
      

    </bug>

</bugzilla>