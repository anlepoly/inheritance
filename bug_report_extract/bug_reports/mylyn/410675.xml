<?xml version="1.0" encoding="UTF-8" standalone="yes" ?>
<!DOCTYPE bugzilla SYSTEM "https://bugs.eclipse.org/bugs/page.cgi?id=bugzilla.dtd">

<bugzilla version="4.4.7"
          urlbase="https://bugs.eclipse.org/bugs/"
          
          maintainer="webmaster@eclipse.org"
>

    <bug>
          <bug_id>410675</bug_id>
          
          <creation_ts>2013-06-12 20:29:00 -0400</creation_ts>
          <short_desc>[regression] patch set section shows duplicate files when restarting with review editor open</short_desc>
          <delta_ts>2013-06-19 20:25:17 -0400</delta_ts>
          <reporter_accessible>1</reporter_accessible>
          <cclist_accessible>1</cclist_accessible>
          <classification_id>14</classification_id>
          <classification>Mylyn</classification>
          <product>Mylyn Reviews</product>
          <component>Gerrit Connector</component>
          <version>unspecified</version>
          <rep_platform>PC</rep_platform>
          <op_sys>Windows 7</op_sys>
          <bug_status>RESOLVED</bug_status>
          <resolution>FIXED</resolution>
          
          
          <bug_file_loc></bug_file_loc>
          <status_whiteboard></status_whiteboard>
          <keywords></keywords>
          <priority>P2</priority>
          <bug_severity>major</bug_severity>
          <target_milestone>2.0.1</target_milestone>
          
          
          <everconfirmed>1</everconfirmed>
          <reporter name="Sam Davis">sam.davis</reporter>
          <assigned_to name="Miles Parker">milesparker</assigned_to>
          <cc>david.green</cc>
    
    <cc>milesparker</cc>
    
    <cc>steffen.pingel</cc>
          
          <votes>0</votes>

      

      

      

          <comment_sort_order>oldest_to_newest</comment_sort_order>  
          <long_desc isprivate="0" >
    <commentid>2272208</commentid>
    <comment_count>0</comment_count>
    <who name="Sam Davis">sam.davis</who>
    <bug_when>2013-06-12 20:29:22 -0400</bug_when>
    <thetext>* with a review editor open, restart eclipse
* close and reopen the editor
* duplicate files are shown in the patch set section
* repeat the process and get another set of duplicates</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>2272210</commentid>
    <comment_count>1</comment_count>
    <who name="Sam Davis">sam.davis</who>
    <bug_when>2013-06-12 20:33:39 -0400</bug_when>
    <thetext>A workaround is to delete the &lt;workspace&gt;\.metadata\.mylyn\reviews_xml\org.eclipse.mylyn.gerrit-&lt;repository_url&gt;-\Review\&lt;review_id&gt;.reviews file to remove the duplciates for the affected review.</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>2272223</commentid>
    <comment_count>2</comment_count>
    <who name="Miles Parker">milesparker</who>
    <bug_when>2013-06-12 20:53:49 -0400</bug_when>
    <thetext>https://git.eclipse.org/r/#/c/13784/

This is in some sense a quick fix, because I while it isn&apos;t really specified by API we probably shouldn&apos;t be calling createModel after the model exists, and we are in this instance.</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>2272526</commentid>
    <comment_count>3</comment_count>
    <who name="Sam Davis">sam.davis</who>
    <bug_when>2013-06-13 13:29:09 -0400</bug_when>
    <thetext>I have also been able to reproduce this without restarting, by deletin gthe .reviews file while the review is open and then refreshing the editor.</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>2272533</commentid>
    <comment_count>4</comment_count>
    <who name="Miles Parker">milesparker</who>
    <bug_when>2013-06-13 13:45:35 -0400</bug_when>
    <thetext>(In reply to comment #3)
&gt; I have also been able to reproduce this without restarting, by deletin gthe
&gt; .reviews file while the review is open and then refreshing the editor.

Yeah, that makes sense. What&apos;s happening there is that the file is still in memory, but then it gets rebuilt, causing create model to be called. After thinking it through, the overall framework is working correctly -- you need to force a creation pass at this point, and the fix that I&apos;ve made is correct -- you shouldn&apos;t assume that at create time you wouldn&apos;t already have the model. (This is an issue only with EMF lists; with regular objects you&apos;re just recreating the model object so it doesn&apos;t matter.)

Anyway, the fix above should take care of it. Can you confirm that, Sam?</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>2272643</commentid>
    <comment_count>5</comment_count>
    <who name="Sam Davis">sam.davis</who>
    <bug_when>2013-06-13 19:34:07 -0400</bug_when>
    <thetext>This seems to be fixed now.</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>2272646</commentid>
    <comment_count>6</comment_count>
    <who name="Miles Parker">milesparker</who>
    <bug_when>2013-06-13 19:45:47 -0400</bug_when>
    <thetext>Great. I think we&apos;re starting to win this game of Whack-A-Mole.</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>2274496</commentid>
    <comment_count>7</comment_count>
    <who name="Steffen Pingel">steffen.pingel</who>
    <bug_when>2013-06-19 12:09:09 -0400</bug_when>
    <thetext>Miles, please assign tasks to the person who completed the majority of the work when resolving them.</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>2274706</commentid>
    <comment_count>8</comment_count>
    <who name="Miles Parker">milesparker</who>
    <bug_when>2013-06-19 20:25:17 -0400</bug_when>
    <thetext>*** Bug 411180 has been marked as a duplicate of this bug. ***</thetext>
  </long_desc>
      
      

    </bug>

</bugzilla>