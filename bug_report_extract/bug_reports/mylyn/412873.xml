<?xml version="1.0" encoding="UTF-8" standalone="yes" ?>
<!DOCTYPE bugzilla SYSTEM "https://bugs.eclipse.org/bugs/page.cgi?id=bugzilla.dtd">

<bugzilla version="4.4.7"
          urlbase="https://bugs.eclipse.org/bugs/"
          
          maintainer="webmaster@eclipse.org"
>

    <bug>
          <bug_id>412873</bug_id>
          
          <creation_ts>2013-07-12 12:13:00 -0400</creation_ts>
          <short_desc>[regression] ArrayIndexOutOfBoundsException when starting Eclipse with a review open</short_desc>
          <delta_ts>2013-08-13 13:15:42 -0400</delta_ts>
          <reporter_accessible>1</reporter_accessible>
          <cclist_accessible>1</cclist_accessible>
          <classification_id>14</classification_id>
          <classification>Mylyn</classification>
          <product>Mylyn Reviews</product>
          <component>Gerrit Connector</component>
          <version>2.0</version>
          <rep_platform>PC</rep_platform>
          <op_sys>Windows 7</op_sys>
          <bug_status>RESOLVED</bug_status>
          <resolution>FIXED</resolution>
          
          
          <bug_file_loc></bug_file_loc>
          <status_whiteboard></status_whiteboard>
          <keywords></keywords>
          <priority>P2</priority>
          <bug_severity>normal</bug_severity>
          <target_milestone>2.0.1</target_milestone>
          
          
          <everconfirmed>1</everconfirmed>
          <reporter name="Tomasz Zarna">tomasz.zarna</reporter>
          <assigned_to name="Miles Parker">milesparker</assigned_to>
          <cc>milesparker</cc>
    
    <cc>sam.davis</cc>
    
    <cc>steffen.pingel</cc>
          
          <votes>0</votes>

      

      

      

          <comment_sort_order>oldest_to_newest</comment_sort_order>  
          <long_desc isprivate="0" >
    <commentid>2283980</commentid>
    <comment_count>0</comment_count>
    <who name="Tomasz Zarna">tomasz.zarna</who>
    <bug_when>2013-07-12 12:13:35 -0400</bug_when>
    <thetext>It&apos;s a reincarnation of bug 408761, still occurring in 2.0. Running of master [1], starting Eclipse with a review already open:

java.lang.ArrayIndexOutOfBoundsException: 2
	at org.eclipse.emf.common.util.BasicEList.assign(BasicEList.java:118)
	at org.eclipse.emf.common.util.BasicEList.addUnique(BasicEList.java:418)
	at org.eclipse.emf.common.util.AbstractEList.add(AbstractEList.java:301)
	at org.eclipse.emf.common.notify.impl.BasicNotifierImpl$EAdapterList.add(BasicNotifierImpl.java:193)
	at org.eclipse.mylyn.reviews.core.spi.remote.emf.RemoteEmfConsumer.&lt;init&gt;(RemoteEmfConsumer.java:124)
	at org.eclipse.mylyn.reviews.core.spi.remote.emf.AbstractRemoteEmfFactory.getConsumerForLocalKey(AbstractRemoteEmfFactory.java:183)
	at org.eclipse.mylyn.internal.gerrit.core.remote.PatchSetContentIdRemoteFactory.pull(PatchSetContentIdRemoteFactory.java:40)
	at org.eclipse.mylyn.internal.gerrit.core.remote.PatchSetContentIdRemoteFactory.pull(PatchSetContentIdRemoteFactory.java:1)
	at org.eclipse.mylyn.reviews.core.spi.remote.emf.RemoteEmfConsumer.pull(RemoteEmfConsumer.java:164)
	at org.eclipse.mylyn.reviews.core.spi.remote.JobRemoteService$1.run(JobRemoteService.java:60)
	at org.eclipse.core.internal.jobs.Worker.run(Worker.java:54)

[1] https://git.eclipse.org/c/mylyn/org.eclipse.mylyn.reviews.git/commit/?id=c603cfc349a6deed355ea6388166665d71c8fb96</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>2283997</commentid>
    <comment_count>1</comment_count>
    <who name="Steffen Pingel">steffen.pingel</who>
    <bug_when>2013-07-12 13:06:06 -0400</bug_when>
    <thetext>This doesn&apos;t surprise me considering that the model is accessed from a job. Miles, how was this &quot;fixed&quot; last time?</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>2284554</commentid>
    <comment_count>2</comment_count>
    <who name="Miles Parker">milesparker</who>
    <bug_when>2013-07-15 12:57:50 -0400</bug_when>
    <thetext>Its not the same issue if you look at the stack trace. The other one was driven by a call to pull user. Really, we shouldn&apos;t need true remote acess at all. I&apos;ll take a look today.</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>2284590</commentid>
    <comment_count>3</comment_count>
    <who name="Miles Parker">milesparker</who>
    <bug_when>2013-07-15 14:14:28 -0400</bug_when>
    <thetext>https://git.eclipse.org/r/#/c/14571/

Unfortunatly, I can&apos;t reproduce issue so I can&apos;t effectivly test, but this should do it. Tomek, can you verify that this addresses your issue?</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>2285264</commentid>
    <comment_count>4</comment_count>
    <who name="Miles Parker">milesparker</who>
    <bug_when>2013-07-16 18:53:41 -0400</bug_when>
    <thetext>Ok, *that* wasn&apos;t the right way to solve it. See bug 413124. Back to the drawing board...</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>2285269</commentid>
    <comment_count>5</comment_count>
    <who name="Miles Parker">milesparker</who>
    <bug_when>2013-07-16 19:19:36 -0400</bug_when>
    <thetext>https://git.eclipse.org/r/#/c/14605/

Everyone: Given prior issue (which wasn&apos;t easy to reproduce) we&apos;ll want to verify this one carefully. While it shouldn&apos;t carry any risk deadlock, because we&apos;re no longer adding the adapters synchronously, it&apos;s *possible* that we might introduce subtle updating issues with this change. I haven&apos;t seen anything, so just a note to be on the lookout for that.</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>2286430</commentid>
    <comment_count>6</comment_count>
    <who name="Miles Parker">milesparker</who>
    <bug_when>2013-07-19 13:16:14 -0400</bug_when>
    <thetext>I&apos;ve gone ahead and submitted this change. That will give us a chance to evaluate behaviour prior to 2.0.1 release. We can back this one out as well is we see issues, but I don&apos;t anticipate any problems.</thetext>
  </long_desc>
      
      

    </bug>

</bugzilla>