<?xml version="1.0" encoding="UTF-8" standalone="yes" ?>
<!DOCTYPE bugzilla SYSTEM "https://bugs.eclipse.org/bugs/page.cgi?id=bugzilla.dtd">

<bugzilla version="4.4.7"
          urlbase="https://bugs.eclipse.org/bugs/"
          
          maintainer="webmaster@eclipse.org"
>

    <bug>
          <bug_id>414219</bug_id>
          
          <creation_ts>2013-08-01 11:35:00 -0400</creation_ts>
          <short_desc>Add support for gerrit changes query options</short_desc>
          <delta_ts>2013-12-10 09:45:40 -0500</delta_ts>
          <reporter_accessible>1</reporter_accessible>
          <cclist_accessible>1</cclist_accessible>
          <classification_id>14</classification_id>
          <classification>Mylyn</classification>
          <product>Mylyn Reviews</product>
          <component>Gerrit Connector</component>
          <version>unspecified</version>
          <rep_platform>PC</rep_platform>
          <op_sys>Linux</op_sys>
          <bug_status>RESOLVED</bug_status>
          <resolution>FIXED</resolution>
          
          
          <bug_file_loc></bug_file_loc>
          <status_whiteboard></status_whiteboard>
          <keywords>contributed</keywords>
          <priority>P3</priority>
          <bug_severity>enhancement</bug_severity>
          <target_milestone>2.2</target_milestone>
          
          <blocked>414253</blocked>
          <everconfirmed>1</everconfirmed>
          <reporter name="Francois Chouinard">fchouinard</reporter>
          <assigned_to name="Francois Chouinard">fchouinard</assigned_to>
          <cc>fchouinard</cc>
          
          <votes>0</votes>

      

      

      

          <comment_sort_order>oldest_to_newest</comment_sort_order>  
          <long_desc isprivate="0" >
    <commentid>2290653</commentid>
    <comment_count>0</comment_count>
    <who name="Francois Chouinard">fchouinard</who>
    <bug_when>2013-08-01 11:35:14 -0400</bug_when>
    <thetext>The Gerrit Connector currently desn&apos;t have support for optional parameters in the gerrit changes query.

For example, to implement the Gerrit Dashboard efficiently, it would be useful to pass the &quot;LABELS&quot; option to the changes query in order to obtain the information needed to populate the &quot;Code-Review&quot; and &quot;Verified&quot; fields. The alternative is to perform requests for review change details and extract the relevant information - a time consumming operation that requires a trip to the back-end for each review.

A simple solution would be to augment the GerritClient API to optionally support query options.

Although the &quot;LABELS&quot; option is of immediate use, the full set of options is quite interesting (hence this bug for some kind of generic support).</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>2290657</commentid>
    <comment_count>1</comment_count>
    <who name="Francois Chouinard">fchouinard</who>
    <bug_when>2013-08-01 11:35:39 -0400</bug_when>
    <thetext>From the gerrit REST API documentation, the general form of the changes query request is roughly:

GET /changes/?q=&lt;some query&gt;&amp;o=&lt;options&gt;&amp;n=&lt;limit&gt;

where the parameters &apos;o&apos; and &apos;n&apos; are optional.

For example (from http://gerrit-documentation.googlecode.com/svn/Documentation/2.6/rest-api-changes.html#change-endpoints):

GET /changes/?q=is:open+owner:self&amp;q=is:open+reviewer:self+-owner:self&amp;q=is:closed+owner:self+limit:5&amp;o=LABELS HTTP/1.0

HTTP/1.1 200 OK
  Content-Disposition: attachment
  Content-Type: application/json;charset=UTF-8

  )]}&apos;
  [
    [
      {
        &quot;kind&quot;: &quot;gerritcodereview#change&quot;,
        &quot;id&quot;: &quot;demo~master~Idaf5e098d70898b7119f6f4af5a6c13343d64b57&quot;,
        &quot;project&quot;: &quot;demo&quot;,
        &quot;branch&quot;: &quot;master&quot;,
        &quot;change_id&quot;: &quot;Idaf5e098d70898b7119f6f4af5a6c13343d64b57&quot;,
        &quot;subject&quot;: &quot;One change&quot;,
        &quot;status&quot;: &quot;NEW&quot;,
        &quot;created&quot;: &quot;2012-07-17 07:18:30.854000000&quot;,
        &quot;updated&quot;: &quot;2012-07-17 07:19:27.766000000&quot;,
        &quot;reviewed&quot;: true,
        &quot;mergeable&quot;: true,
        &quot;_sortkey&quot;: &quot;001e7057000006dc&quot;,
        &quot;_number&quot;: 1756,
        &quot;owner&quot;: {
          &quot;name&quot;: &quot;John Doe&quot;
        },
        &quot;labels&quot;: {
          &quot;Verified&quot;: {},
          &quot;Code-Review&quot;: {}
        }
      }
    ],
    [],
    []
  ]</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>2290662</commentid>
    <comment_count>2</comment_count>
    <who name="Francois Chouinard">fchouinard</who>
    <bug_when>2013-08-01 11:46:57 -0400</bug_when>
    <thetext>Proposed fix pushed to gerrit (9ab99bc)

GerritClient.executeQueryRest() is responsible for formatting the query string (uri). The proposed solution is to augment its API with an optional optionString. It is fairly simple to ensure backward compatibility for the existing code by overloading a couple of methods.

Note that this solution only applies to the REST API (gerrit 2.5+).</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>2292822</commentid>
    <comment_count>3</comment_count>
    <who name="Tomasz Zarna">tomasz.zarna</who>
    <bug_when>2013-08-08 12:08:55 -0400</bug_when>
    <thetext>(In reply to comment #0)
&gt; For example, to implement the Gerrit Dashboard efficiently, it would be useful
&gt; to pass the &quot;LABELS&quot; option to the changes query 

Does it mean this bug blocks bug 414253 ?</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>2292934</commentid>
    <comment_count>4</comment_count>
    <who name="Francois Chouinard">fchouinard</who>
    <bug_when>2013-08-08 15:58:42 -0400</bug_when>
    <thetext>&gt; 
&gt; Does it mean this bug blocks bug 414253 ?

Yes. I added the dependency.</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>2293115</commentid>
    <comment_count>5</comment_count>
    <who name="Tomasz Zarna">tomasz.zarna</who>
    <bug_when>2013-08-09 05:21:52 -0400</bug_when>
    <thetext>(In reply to comment #2)
&gt; Proposed fix pushed to gerrit (9ab99bc)

It&apos; https://git.eclipse.org/r/#/c/15044/

&gt; Note that this solution only applies to the REST API (gerrit 2.5+).

That&apos;s too bad. Any chance to produce the same output for 2.4 (it&apos;s still supported)?

Also, see my comments on the review.</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>2339934</commentid>
    <comment_count>6</comment_count>
    <who name="Steffen Pingel">steffen.pingel</who>
    <bug_when>2013-12-10 09:45:40 -0500</bug_when>
    <thetext>I think all reviews related to this bug have been merged. Thanks!</thetext>
  </long_desc>
      
      

    </bug>

</bugzilla>