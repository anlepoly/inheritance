<?xml version="1.0" encoding="UTF-8" standalone="yes" ?>
<!DOCTYPE bugzilla SYSTEM "https://bugs.eclipse.org/bugs/page.cgi?id=bugzilla.dtd">

<bugzilla version="4.4.7"
          urlbase="https://bugs.eclipse.org/bugs/"
          
          maintainer="webmaster@eclipse.org"
>

    <bug>
          <bug_id>356914</bug_id>
          
          <creation_ts>2011-09-07 07:12:00 -0400</creation_ts>
          <short_desc>NPE when activating a task having another task open with same invisible context elements</short_desc>
          <delta_ts>2012-02-17 05:56:19 -0500</delta_ts>
          <reporter_accessible>1</reporter_accessible>
          <cclist_accessible>1</cclist_accessible>
          <classification_id>14</classification_id>
          <classification>Mylyn</classification>
          <product>Mylyn Context</product>
          <component>Framework</component>
          <version>unspecified</version>
          <rep_platform>PC</rep_platform>
          <op_sys>Windows XP</op_sys>
          <bug_status>RESOLVED</bug_status>
          <resolution>FIXED</resolution>
          
          
          <bug_file_loc></bug_file_loc>
          <status_whiteboard></status_whiteboard>
          <keywords></keywords>
          <priority>P3</priority>
          <bug_severity>major</bug_severity>
          <target_milestone>3.7</target_milestone>
          
          
          <everconfirmed>1</everconfirmed>
          <reporter name="Jan Mauersberger">mauersberger</reporter>
          <assigned_to name="Steffen Pingel">steffen.pingel</assigned_to>
          
          
          <votes>0</votes>

      

      

      

          <comment_sort_order>oldest_to_newest</comment_sort_order>  
          <long_desc isprivate="0" >
    <commentid>1989905</commentid>
    <comment_count>0</comment_count>
    <who name="Jan Mauersberger">mauersberger</who>
    <bug_when>2011-09-07 07:12:12 -0400</bug_when>
    <thetext>Build Identifier: M20100909-0800

Well, I have no reproduction scenario yet but I can outline the code parts of MyLyn that are affected. The NPW stack:

java.lang.NullPointerException
	at org.eclipse.mylyn.internal.context.ui.editors.ContextWrapper.isForSameTaskAs(ContextWrapper.java:23)
	at org.eclipse.mylyn.internal.context.ui.editors.InvisibleContextElementsPart.isActiveTask(InvisibleContextElementsPart.java:320)
	at org.eclipse.mylyn.internal.context.ui.editors.InvisibleContextElementsPart.access$0(InvisibleContextElementsPart.java:317)
	at org.eclipse.mylyn.internal.context.ui.editors.InvisibleContextElementsPart$1.contextChanged(InvisibleContextElementsPart.java:124)

The code executed is

public boolean isForSameTaskAs(IInteractionContext context) {
	return context != null &amp;&amp; context.getHandleIdentifier().equals(task.getHandleIdentifier());
}

where as the call to &quot;context.getHandleIdentifier()&quot; returns null. The context implementation class is a CompositeInteractionContext, thus the code is:

public String getHandleIdentifier() {
	if (contexts.values().size() == 1) {
		return contexts.keySet().iterator().next();
	} else {
		return null;
	}
}

In my case the contexts hashmap contains several keys, thus null is returned.

Reproducible: Always</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>2067366</commentid>
    <comment_count>1</comment_count>
    <who name="Steffen Pingel">steffen.pingel</who>
    <bug_when>2012-02-17 05:56:16 -0500</bug_when>
    <thetext>Thanks for the bug report! I have committed a simple fix: http://review.mylyn.org/300. Shawn, please reopen if we need to make adjustments.</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>2067367</commentid>
    <comment_count>2</comment_count>
      <attachid>211167</attachid>
    <who name="Steffen Pingel">steffen.pingel</who>
    <bug_when>2012-02-17 05:56:19 -0500</bug_when>
    <thetext>Created attachment 211167
mylyn/context/zip</thetext>
  </long_desc>
      
          <attachment
              isobsolete="0"
              ispatch="0"
              isprivate="0"
          >
            <attachid>211167</attachid>
            <date>2012-02-17 05:56:00 -0500</date>
            <delta_ts>2012-02-17 05:56:19 -0500</delta_ts>
            <desc>mylyn/context/zip</desc>
            <filename>mylyn-context.zip</filename>
            <type>application/octet-stream</type>
            <size>3538</size>
            <attacher name="Steffen Pingel">steffen.pingel</attacher>
            
              <data encoding="base64">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
AAAAAA==
</data>

          </attachment>
      

    </bug>

</bugzilla>