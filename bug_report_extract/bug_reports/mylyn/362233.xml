<?xml version="1.0" encoding="UTF-8" standalone="yes" ?>
<!DOCTYPE bugzilla SYSTEM "https://bugs.eclipse.org/bugs/page.cgi?id=bugzilla.dtd">

<bugzilla version="4.4.7"
          urlbase="https://bugs.eclipse.org/bugs/"
          
          maintainer="webmaster@eclipse.org"
>

    <bug>
          <bug_id>362233</bug_id>
          
          <creation_ts>2011-10-27 14:42:00 -0400</creation_ts>
          <short_desc>[api] support editor inputs that are not restored when a context is activated</short_desc>
          <delta_ts>2012-02-17 18:48:28 -0500</delta_ts>
          <reporter_accessible>1</reporter_accessible>
          <cclist_accessible>1</cclist_accessible>
          <classification_id>14</classification_id>
          <classification>Mylyn</classification>
          <product>Mylyn Context</product>
          <component>Framework</component>
          <version>unspecified</version>
          <rep_platform>PC</rep_platform>
          <op_sys>Windows 7</op_sys>
          <bug_status>RESOLVED</bug_status>
          <resolution>FIXED</resolution>
          
          
          <bug_file_loc></bug_file_loc>
          <status_whiteboard></status_whiteboard>
          <keywords></keywords>
          <priority>P2</priority>
          <bug_severity>enhancement</bug_severity>
          <target_milestone>3.7</target_milestone>
          
          
          <everconfirmed>1</everconfirmed>
          <reporter name="Sam Davis">sam.davis</reporter>
          <assigned_to name="Steffen Pingel">steffen.pingel</assigned_to>
          <cc>shawn.minto</cc>
    
    <cc>steffen.pingel</cc>
          
          <votes>0</votes>

      

      

      

          <comment_sort_order>oldest_to_newest</comment_sort_order>  
          <long_desc isprivate="0" >
    <commentid>2017837</commentid>
    <comment_count>0</comment_count>
    <who name="Sam Davis">sam.davis</who>
    <bug_when>2011-10-27 14:42:46 -0400</bug_when>
    <thetext>Recently, when I activate a task, only one editor is restored.</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>2017858</commentid>
    <comment_count>1</comment_count>
    <who name="Steffen Pingel">steffen.pingel</who>
    <bug_when>2011-10-27 15:10:36 -0400</bug_when>
    <thetext>Thanks for the bug report. Shawn investigated this and found a regression that was caused by bug 359312. I&apos;ll fix it and add a test cases for the editor restore.</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>2018393</commentid>
    <comment_count>2</comment_count>
    <who name="Steffen Pingel">steffen.pingel</who>
    <bug_when>2011-10-28 12:02:38 -0400</bug_when>
    <thetext>The fix was more involved than expected. I ended up introducing a new class ContextAwareEditorInput that allows contributions to control closing behavior on context deactivation. Task editors that do not show the active task are now flagged to be force closed to avoid tracking them in the context.</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>2018430</commentid>
    <comment_count>3</comment_count>
    <who name="Sam Davis">sam.davis</who>
    <bug_when>2011-10-28 13:18:51 -0400</bug_when>
    <thetext>Interesting. Does this mean that one could define a kind of editor that would not be restored when activating tasks? For example, could I implement an XML editor that would never be restored?</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>2018449</commentid>
    <comment_count>4</comment_count>
    <who name="Steffen Pingel">steffen.pingel</who>
    <bug_when>2011-10-28 13:53:30 -0400</bug_when>
    <thetext>(In reply to comment #3)
&gt; Interesting. Does this mean that one could define a kind of editor that would
&gt; not be restored when activating tasks? For example, could I implement an XML
&gt; editor that would never be restored?

Yes, that is exactly the intended purpose of the new API.</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>2018460</commentid>
    <comment_count>5</comment_count>
    <who name="Sam Davis">sam.davis</who>
    <bug_when>2011-10-28 14:31:21 -0400</bug_when>
    <thetext>It seems wrong to me that this is done by forcing the editor to close. I would like to have an editor that stays open all the time, but I don&apos;t want it to be restored when activating a task as this creates problems (e.g. mulitple copies of the editor can be opened if its input&apos;s name has changed).</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>2018486</commentid>
    <comment_count>6</comment_count>
    <who name="Steffen Pingel">steffen.pingel</who>
    <bug_when>2011-10-28 15:08:01 -0400</bug_when>
    <thetext>The commit for this bug does not change the behavior, it merely restores the state that we had in 3.6. Your request should already be covered by IContextAwareEditor which is used to prevent editors from closing. 

We can discuss a more extensible implementation of the editor management for e4 but it&apos;s very unlikely that we will make any enhancements for 3.x due to the way the workbench integration works.</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>2018490</commentid>
    <comment_count>7</comment_count>
    <who name="Sam Davis">sam.davis</who>
    <bug_when>2011-10-28 15:13:10 -0400</bug_when>
    <thetext>I think it&apos;s good to provide an api that prevents adding editors to context, but not so good that it is not compatiable with the IContextAwareEditor&apos;s support for preventing editors from closing. I would like to be able to use both.</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>2019464</commentid>
    <comment_count>8</comment_count>
    <who name="Steffen Pingel">steffen.pingel</who>
    <bug_when>2011-11-01 07:00:25 -0400</bug_when>
    <thetext>Reopening to add test case.

(In reply to comment #7)
&gt; I think it&apos;s good to provide an api that prevents adding editors to context, but
&gt; not so good that it is not compatiable with the IContextAwareEditor&apos;s support
&gt; for preventing editors from closing. I would like to be able to use both.

I am not quite understanding the point that you are trying to make? You can use both. What is the nature of the incompatibility? What are you proposing instead?</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>2019634</commentid>
    <comment_count>9</comment_count>
    <who name="Sam Davis">sam.davis</who>
    <bug_when>2011-11-01 12:01:58 -0400</bug_when>
    <thetext>Correct me if I&apos;m wrong, but I think that if I specify that an editor should not close and also that it should not be added to the context, only one of those things will happen (either it will close, or it will stay open and be added to the context). What I would like, and I realize this may not be possible, is to have a way of preventing editors from being added to the context without having to close them.</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>2019676</commentid>
    <comment_count>10</comment_count>
    <who name="Steffen Pingel">steffen.pingel</who>
    <bug_when>2011-11-01 12:59:57 -0400</bug_when>
    <thetext>(In reply to comment #9)
&gt; Correct me if I&apos;m wrong, but I think that if I specify that an editor should not
&gt; close and also that it should not be added to the context, only one of those
&gt; things will happen (either it will close, or it will stay open and be added to
&gt; the context). What I would like, and I realize this may not be possible, is to
&gt; have a way of preventing editors from being added to the context without having
&gt; to close them.

Yes, as far as I know we can not support this with the workbench integration that we use on 3.x. This is one of the things that we could try on 4.x which has different APIs for persisting workbench state.</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>2067826</commentid>
    <comment_count>11</comment_count>
    <who name="Steffen Pingel">steffen.pingel</who>
    <bug_when>2012-02-17 18:20:00 -0500</bug_when>
    <thetext>I have committed a test case.</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>2067831</commentid>
    <comment_count>12</comment_count>
    <who name="Sam Davis">sam.davis</who>
    <bug_when>2012-02-17 18:31:08 -0500</bug_when>
    <thetext>Steffen, you changed this to be an API request which is not fixed. You might want to either reopen it or change the summary back.</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>2067833</commentid>
    <comment_count>13</comment_count>
    <who name="Steffen Pingel">steffen.pingel</who>
    <bug_when>2012-02-17 18:45:25 -0500</bug_when>
    <thetext>org.eclipse.mylyn.context.ui.ContextAwareEditorInput was introduced to resolve this bug and hence I tagged it as [api]. 

As I said in comment 10, we don&apos;t have plans to support further enhancements for the editor restore API at this point.</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>2067834</commentid>
    <comment_count>14</comment_count>
    <who name="Sam Davis">sam.davis</who>
    <bug_when>2012-02-17 18:48:28 -0500</bug_when>
    <thetext>Sorry, my mistake.</thetext>
  </long_desc>
      
      

    </bug>

</bugzilla>