<?xml version="1.0" encoding="UTF-8" standalone="yes" ?>
<!DOCTYPE bugzilla SYSTEM "https://bugs.eclipse.org/bugs/page.cgi?id=bugzilla.dtd">

<bugzilla version="4.4.7"
          urlbase="https://bugs.eclipse.org/bugs/"
          
          maintainer="webmaster@eclipse.org"
>

    <bug>
          <bug_id>383766</bug_id>
          
          <creation_ts>2012-06-28 06:39:00 -0400</creation_ts>
          <short_desc>jdt.ui.tests.refactoring trigger NPE in ActivityContextManager</short_desc>
          <delta_ts>2012-07-18 07:26:23 -0400</delta_ts>
          <reporter_accessible>1</reporter_accessible>
          <cclist_accessible>1</cclist_accessible>
          <classification_id>14</classification_id>
          <classification>Mylyn</classification>
          <product>Mylyn Context</product>
          <component>Framework</component>
          <version>3.8</version>
          <rep_platform>PC</rep_platform>
          <op_sys>Linux</op_sys>
          <bug_status>RESOLVED</bug_status>
          <resolution>FIXED</resolution>
          
          
          <bug_file_loc></bug_file_loc>
          <status_whiteboard></status_whiteboard>
          <keywords></keywords>
          <priority>P3</priority>
          <bug_severity>minor</bug_severity>
          <target_milestone>3.8.1</target_milestone>
          
          
          <everconfirmed>1</everconfirmed>
          <reporter name="Stephan Herrmann">stephan.herrmann</reporter>
          <assigned_to name="Steffen Pingel">steffen.pingel</assigned_to>
          <cc>sam.davis</cc>
          
          <votes>0</votes>

      

      

      

          <comment_sort_order>oldest_to_newest</comment_sort_order>  
          <long_desc isprivate="0" >
    <commentid>2130287</commentid>
    <comment_count>0</comment_count>
    <who name="Stephan Herrmann">stephan.herrmann</who>
    <bug_when>2012-06-28 06:39:30 -0400</bug_when>
    <thetext>I was running the jdt refactoring test suite with Mylyn in the loop. 
During a tearDown the following NPE was thrown, not sure if this could happen
in normal operation, too:

org.eclipse.swt.SWTException: Failed to execute runnable (java.lang.NullPointerException)
	at org.eclipse.swt.SWT.error(SWT.java:4361)
	at org.eclipse.swt.SWT.error(SWT.java:4276)
	at org.eclipse.swt.widgets.Synchronizer.runAsyncMessages(Synchronizer.java:138)
	at org.eclipse.swt.widgets.Display.runAsyncMessages(Display.java:3529)
	at org.eclipse.swt.widgets.Display.readAndDispatch(Display.java:3182)
	at org.eclipse.jdt.testplugin.JavaProjectHelper.emptyDisplayLoop(JavaProjectHelper.java:829)
	at org.eclipse.jdt.testplugin.JavaProjectHelper.delete(JavaProjectHelper.java:288)
	at org.eclipse.jdt.ui.tests.refactoring.RefactoringTestSetup.tearDown(RefactoringTestSetup.java:82)
	at junit.extensions.TestSetup$1.protect(TestSetup.java:24)
	at junit.framework.TestResult.runProtected(TestResult.java:128)
	at junit.extensions.TestSetup.run(TestSetup.java:27)
	at junit.framework.TestSuite.runTest(TestSuite.java:243)
	at junit.framework.TestSuite.run(TestSuite.java:238)
	at junit.framework.TestSuite.runTest(TestSuite.java:243)
	at junit.framework.TestSuite.run(TestSuite.java:238)
	at org.eclipse.jdt.internal.junit.runner.junit3.JUnit3TestReference.run(JUnit3TestReference.java:130)
	at org.eclipse.jdt.internal.junit.runner.TestExecution.run(TestExecution.java:38)
	at org.eclipse.jdt.internal.junit.runner.RemoteTestRunner.runTests(RemoteTestRunner.java:467)
	at org.eclipse.jdt.internal.junit.runner.RemoteTestRunner.runTests(RemoteTestRunner.java:683)
	at org.eclipse.jdt.internal.junit.runner.RemoteTestRunner.run(RemoteTestRunner.java:390)
	at org.eclipse.pde.internal.junit.runtime.RemotePluginTestRunner.main(RemotePluginTestRunner.java:62)
	at org.eclipse.pde.internal.junit.runtime.PlatformUITestHarness$1.run(PlatformUITestHarness.java:47)
	at org.eclipse.swt.widgets.RunnableLock.run(RunnableLock.java:35)
	at org.eclipse.swt.widgets.Synchronizer.runAsyncMessages(Synchronizer.java:135)
	at org.eclipse.swt.widgets.Display.runAsyncMessages(Display.java:3529)
	at org.eclipse.swt.widgets.Display.readAndDispatch(Display.java:3182)
	at org.eclipse.e4.ui.internal.workbench.swt.PartRenderingEngine$9.run(PartRenderingEngine.java:1022)
	at org.eclipse.core.databinding.observable.Realm.runWithDefault(Realm.java:332)
	at org.eclipse.e4.ui.internal.workbench.swt.PartRenderingEngine.run(PartRenderingEngine.java:916)
	at org.eclipse.e4.ui.internal.workbench.E4Workbench.createAndRunUI(E4Workbench.java:86)
	at org.eclipse.ui.internal.Workbench$5.run(Workbench.java:585)
	at org.eclipse.core.databinding.observable.Realm.runWithDefault(Realm.java:332)
	at org.eclipse.ui.internal.Workbench.createAndRunWorkbench(Workbench.java:540)
	at org.eclipse.ui.PlatformUI.createAndRunWorkbench(PlatformUI.java:149)
	at org.eclipse.ui.internal.ide.application.IDEApplication.start(IDEApplication.java:124)
	at org.eclipse.pde.internal.junit.runtime.NonUIThreadTestApplication.runApp(NonUIThreadTestApplication.java:54)
	at org.eclipse.pde.internal.junit.runtime.UITestApplication.runApp(UITestApplication.java:41)
	at org.eclipse.pde.internal.junit.runtime.NonUIThreadTestApplication.start(NonUIThreadTestApplication.java:48)
	at org.eclipse.equinox.internal.app.EclipseAppHandle.run(EclipseAppHandle.java:196)
	at org.eclipse.core.runtime.internal.adaptor.EclipseAppLauncher.runApplication(EclipseAppLauncher.java:110)
	at org.eclipse.core.runtime.internal.adaptor.EclipseAppLauncher.start(EclipseAppLauncher.java:79)
	at org.eclipse.core.runtime.adaptor.EclipseStarter.run(EclipseStarter.java:353)
	at org.eclipse.core.runtime.adaptor.EclipseStarter.run(EclipseStarter.java:180)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:57)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:601)
	at org.eclipse.equinox.launcher.Main.invokeFramework(Main.java:629)
	at org.eclipse.equinox.launcher.Main.basicRun(Main.java:584)
	at org.eclipse.equinox.launcher.Main.run(Main.java:1438)
	at org.eclipse.equinox.launcher.Main.main(Main.java:1414)
Caused by: java.lang.NullPointerException
	at org.eclipse.mylyn.internal.monitor.ui.ActivityContextManager$3.run(ActivityContextManager.java:109)
	at org.eclipse.swt.widgets.RunnableLock.run(RunnableLock.java:35)
	at org.eclipse.swt.widgets.Synchronizer.runAsyncMessages(Synchronizer.java:135)
	... 48 more



FYI these are the test classes involved:

http://git.eclipse.org/c/jdt/eclipse.jdt.ui.git/tree/org.eclipse.jdt.ui.tests/test%20plugin/org/eclipse/jdt/testplugin/JavaProjectHelper.java

http://git.eclipse.org/c/jdt/eclipse.jdt.ui.git/tree/org.eclipse.jdt.ui.tests.refactoring/test%20cases/org/eclipse/jdt/ui/tests/refactoring/RefactoringTestSetup.java</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>2130463</commentid>
    <comment_count>1</comment_count>
    <who name="Steffen Pingel">steffen.pingel</who>
    <bug_when>2012-06-28 10:17:07 -0400</bug_when>
    <thetext>Thanks. Looks like a null check is missing.</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>2138447</commentid>
    <comment_count>2</comment_count>
    <who name="Steffen Pingel">steffen.pingel</who>
    <bug_when>2012-07-18 07:26:20 -0400</bug_when>
    <thetext>Fixed in e_3_8_m_3_8_x branch and master.</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>2138448</commentid>
    <comment_count>3</comment_count>
      <attachid>218862</attachid>
    <who name="Steffen Pingel">steffen.pingel</who>
    <bug_when>2012-07-18 07:26:23 -0400</bug_when>
    <thetext>Created attachment 218862
mylyn/context/zip</thetext>
  </long_desc>
      
          <attachment
              isobsolete="0"
              ispatch="0"
              isprivate="0"
          >
            <attachid>218862</attachid>
            <date>2012-07-18 07:26:00 -0400</date>
            <delta_ts>2012-07-18 07:26:23 -0400</delta_ts>
            <desc>mylyn/context/zip</desc>
            <filename>mylyn-context.zip</filename>
            <type>application/octet-stream</type>
            <size>1977</size>
            <attacher name="Steffen Pingel">steffen.pingel</attacher>
            
              <data encoding="base64">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
</data>

          </attachment>
      

    </bug>

</bugzilla>