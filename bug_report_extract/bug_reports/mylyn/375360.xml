<?xml version="1.0" encoding="UTF-8" standalone="yes" ?>
<!DOCTYPE bugzilla SYSTEM "https://bugs.eclipse.org/bugs/page.cgi?id=bugzilla.dtd">

<bugzilla version="4.4.7"
          urlbase="https://bugs.eclipse.org/bugs/"
          
          maintainer="webmaster@eclipse.org"
>

    <bug>
          <bug_id>375360</bug_id>
          
          <creation_ts>2012-03-26 16:02:00 -0400</creation_ts>
          <short_desc>Notifying of notifications isn&apos;t thread safe, and should be doc&apos;ed as such</short_desc>
          <delta_ts>2012-04-13 09:42:28 -0400</delta_ts>
          <reporter_accessible>1</reporter_accessible>
          <cclist_accessible>1</cclist_accessible>
          <classification_id>14</classification_id>
          <classification>Mylyn</classification>
          <product>Mylyn Commons</product>
          <component>Notifications</component>
          <version>unspecified</version>
          <rep_platform>All</rep_platform>
          <op_sys>All</op_sys>
          <bug_status>RESOLVED</bug_status>
          <resolution>FIXED</resolution>
          
          
          <bug_file_loc>http://dev.eclipse.org/mhonarc/lists/mylyn-dev/msg01583.html</bug_file_loc>
          <status_whiteboard></status_whiteboard>
          <keywords></keywords>
          <priority>P3</priority>
          <bug_severity>normal</bug_severity>
          <target_milestone>3.7.1</target_milestone>
          
          
          <everconfirmed>1</everconfirmed>
          <reporter name="Torkild Resheim">torkildr</reporter>
          <assigned_to name="Steffen Pingel">steffen.pingel</assigned_to>
          <cc>eddie</cc>
          <qa_contact name="Steffen Pingel">steffen.pingel</qa_contact>
          <votes>0</votes>

      

      

      

          <comment_sort_order>oldest_to_newest</comment_sort_order>  
          <long_desc isprivate="0" >
    <commentid>2085961</commentid>
    <comment_count>0</comment_count>
    <who name="Torkild Resheim">torkildr</who>
    <bug_when>2012-03-26 16:02:22 -0400</bug_when>
    <thetext>From Eddie Galvez:

(or fix it in the framework)
 
Just wanted to share my experience using Notifications.getService.notify(List&lt;AbstractNotification&gt;). We found that if you call that from multiple threads concurrently, theres a loss of notification due to an exception that occurs (in a pretty silly way frankly) in PopupNotificationSink:
 
notify always calls setSystem on the Job. Eclipse throws an exception when that method is called while a Job is in any state other than NONE (so if the job is running)
 
Now, you could avoid this exception by simply not calling setSystem each time  call it at Job construction time (the runSystem is a final boolean)
 
Or, if you dont want to promise thread-safety, doc it. But I think a notification thing like this should definitely, in its framework, be thread safe.</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>2093041</commentid>
    <comment_count>1</comment_count>
    <who name="Steffen Pingel">steffen.pingel</who>
    <bug_when>2012-04-13 00:04:15 -0400</bug_when>
    <thetext>I have changed the code in 8dd97e512e7ee071e9889decda0f2ae2c93637f1 to only set the flag once.</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>2093042</commentid>
    <comment_count>2</comment_count>
      <attachid>213951</attachid>
    <who name="Steffen Pingel">steffen.pingel</who>
    <bug_when>2012-04-13 00:04:17 -0400</bug_when>
    <thetext>Created attachment 213951
mylyn/context/zip</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>2093250</commentid>
    <comment_count>3</comment_count>
    <who name="Eddie Galvez">eddie</who>
    <bug_when>2012-04-13 09:42:28 -0400</bug_when>
    <thetext>Thanks for fixing this. It might be interesting still for you guys to take a stance as to whether you believe notifications may be called from any thread, or not, and state that in the docs. For now I&apos;m going to retain my own single-threaded-queue to Notifications until I see that it becomes an issue (it does of course introduce a small delay on top of your own delay, but humans don&apos;t mind).</thetext>
  </long_desc>
      
          <attachment
              isobsolete="0"
              ispatch="0"
              isprivate="0"
          >
            <attachid>213951</attachid>
            <date>2012-04-13 00:04:00 -0400</date>
            <delta_ts>2012-04-13 00:04:17 -0400</delta_ts>
            <desc>mylyn/context/zip</desc>
            <filename>mylyn-context.zip</filename>
            <type>application/octet-stream</type>
            <size>3590</size>
            <attacher name="Steffen Pingel">steffen.pingel</attacher>
            
              <data encoding="base64">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
</data>

          </attachment>
      

    </bug>

</bugzilla>