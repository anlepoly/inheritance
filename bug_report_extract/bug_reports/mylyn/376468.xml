<?xml version="1.0" encoding="UTF-8" standalone="yes" ?>
<!DOCTYPE bugzilla SYSTEM "https://bugs.eclipse.org/bugs/page.cgi?id=bugzilla.dtd">

<bugzilla version="4.4.7"
          urlbase="https://bugs.eclipse.org/bugs/"
          
          maintainer="webmaster@eclipse.org"
>

    <bug>
          <bug_id>376468</bug_id>
          
          <creation_ts>2012-04-11 05:15:00 -0400</creation_ts>
          <short_desc>[upstream] support Jenkins 1.466 (was Server validation failed: Unexpected error: null since Jenkins 1.459)</short_desc>
          <delta_ts>2013-11-10 22:31:44 -0500</delta_ts>
          <reporter_accessible>1</reporter_accessible>
          <cclist_accessible>1</cclist_accessible>
          <classification_id>14</classification_id>
          <classification>Mylyn</classification>
          <product>Mylyn Builds</product>
          <component>Hudson Connector</component>
          <version>1.0</version>
          <rep_platform>PC</rep_platform>
          <op_sys>Windows XP</op_sys>
          <bug_status>CLOSED</bug_status>
          <resolution>FIXED</resolution>
          
          
          <bug_file_loc></bug_file_loc>
          <status_whiteboard></status_whiteboard>
          <keywords>plan</keywords>
          <priority>P2</priority>
          <bug_severity>major</bug_severity>
          <target_milestone>1.0.2</target_milestone>
          
          
          <everconfirmed>1</everconfirmed>
          <reporter name="Andre Bossert">anb0s</reporter>
          <assigned_to name="Steffen Pingel">steffen.pingel</assigned_to>
          <cc>dhunter</cc>
    
    <cc>dscurrah</cc>
    
    <cc>erik.vonderheid</cc>
    
    <cc>jeffrey.kilgore</cc>
    
    <cc>joe</cc>
    
    <cc>kane.mx</cc>
    
    <cc>kane.zhu</cc>
    
    <cc>kilgorjn</cc>
    
    <cc>konrad_w</cc>
    
    <cc>larry</cc>
    
    <cc>rknall</cc>
    
    <cc>roger</cc>
    
    <cc>schauer</cc>
          
          <votes>7</votes>

      

      

      

          <comment_sort_order>oldest_to_newest</comment_sort_order>  
          <long_desc isprivate="0" >
    <commentid>2091880</commentid>
    <comment_count>0</comment_count>
    <who name="Andre Bossert">anb0s</who>
    <bug_when>2012-04-11 05:15:12 -0400</bug_when>
    <thetext>Build Identifier: Build id: M20120208-0800

org.eclipse.core.runtime.CoreException: Unexpected error: null
	at org.eclipse.mylyn.internal.hudson.core.HudsonCorePlugin.toCoreException(HudsonCorePlugin.java:61)
	at org.eclipse.mylyn.internal.hudson.core.HudsonServerBehaviour.refreshConfiguration(HudsonServerBehaviour.java:789)
	at org.eclipse.mylyn.builds.internal.core.operations.RefreshConfigurationOperation$1.run(RefreshConfigurationOperation.java:75)
	at org.eclipse.mylyn.builds.internal.core.operations.RefreshConfigurationOperation$1.run(RefreshConfigurationOperation.java:1)
	at org.eclipse.mylyn.builds.internal.core.util.BuildRunner.run(BuildRunner.java:72)
	at org.eclipse.mylyn.builds.internal.core.operations.RefreshConfigurationOperation.doRefresh(RefreshConfigurationOperation.java:72)
	at org.eclipse.mylyn.builds.ui.spi.BuildServerPart$Validator.run(BuildServerPart.java:118)
	at org.eclipse.mylyn.commons.repositories.ui.RepositoryLocationPart$2.run(RepositoryLocationPart.java:558)
	at org.eclipse.jface.operation.ModalContext$ModalContextThread.run(ModalContext.java:121)
Caused by: org.eclipse.mylyn.internal.hudson.core.client.HudsonException
	at org.eclipse.mylyn.internal.hudson.core.client.HudsonOperation.run(HudsonOperation.java:145)
	at org.eclipse.mylyn.internal.hudson.core.client.RestfulHudsonClient.getJobs(RestfulHudsonClient.java:293)
	at org.eclipse.mylyn.internal.hudson.core.HudsonServerBehaviour.refreshConfiguration(HudsonServerBehaviour.java:787)
	... 7 more
Caused by: org.apache.http.client.ClientProtocolException
	at org.apache.http.impl.client.AbstractHttpClient.execute(AbstractHttpClient.java:822)
	at org.eclipse.mylyn.commons.repositories.http.core.HttpUtil$1.execute(HttpUtil.java:178)
	at org.eclipse.mylyn.commons.repositories.http.core.HttpUtil$1.execute(HttpUtil.java:1)
	at org.eclipse.mylyn.commons.core.operations.MonitoredOperation.call(MonitoredOperation.java:82)
	at java.util.concurrent.FutureTask$Sync.innerRun(Unknown Source)
	at java.util.concurrent.FutureTask.run(Unknown Source)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(Unknown Source)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(Unknown Source)
	at java.lang.Thread.run(Unknown Source)
Caused by: org.apache.http.ProtocolException: The server failed to respond with a valid HTTP response
	at org.apache.http.impl.conn.DefaultResponseParser.parseHead(DefaultResponseParser.java:109)
	at org.apache.http.impl.io.AbstractMessageParser.parse(AbstractMessageParser.java:252)
	at org.apache.http.impl.AbstractHttpClientConnection.receiveResponseHeader(AbstractHttpClientConnection.java:282)
	at org.apache.http.impl.conn.DefaultClientConnection.receiveResponseHeader(DefaultClientConnection.java:247)
	at org.apache.http.impl.conn.AbstractClientConnAdapter.receiveResponseHeader(AbstractClientConnAdapter.java:219)
	at org.apache.http.protocol.HttpRequestExecutor.doReceiveResponse(HttpRequestExecutor.java:298)
	at org.apache.http.protocol.HttpRequestExecutor.execute(HttpRequestExecutor.java:125)
	at org.apache.http.impl.client.DefaultRequestDirector.tryExecute(DefaultRequestDirector.java:645)
	at org.apache.http.impl.client.DefaultRequestDirector.execute(DefaultRequestDirector.java:464)
	at org.apache.http.impl.client.AbstractHttpClient.execute(AbstractHttpClient.java:820)
	... 8 more

Reproducible: Always

Steps to Reproduce:
1. Mylyn 3.7.0: create a build server
2. add server (Jenkins ver. 1.459) http://jenkins:8080/
3. Validate</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>2091954</commentid>
    <comment_count>1</comment_count>
    <who name="Andre Bossert">anb0s</who>
    <bug_when>2012-04-11 08:23:09 -0400</bug_when>
    <thetext>It works with Jenkins LTS release 1.447.1
Something was changed in Jenkins until 1.459...</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>2093007</commentid>
    <comment_count>2</comment_count>
    <who name="Steffen Pingel">steffen.pingel</who>
    <bug_when>2012-04-12 21:06:52 -0400</bug_when>
    <thetext>We only support the latest LTS release of Jenkins.</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>2118317</commentid>
    <comment_count>3</comment_count>
    <who name="Steffen Pingel">steffen.pingel</who>
    <bug_when>2012-06-03 20:01:22 -0400</bug_when>
    <thetext>I have setup a jenkins 1.466 instance at http://mylyn.org/jenkins-latest/. From a quick debug session this appears to be related to  gzip encoding. The responses get mangled somehow and aren&apos;t parsed properly.

I pushed a review here to validate a possible fix: https://git.eclipse.org/r/#/c/6230/</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>2136838</commentid>
    <comment_count>4</comment_count>
    <who name="Andre Bossert">anb0s</who>
    <bug_when>2012-07-13 15:30:11 -0400</bug_when>
    <thetext>Is this fix included in Mylyn 3.8 builds connector? Tank You!</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>2136917</commentid>
    <comment_count>5</comment_count>
    <who name="Steffen Pingel">steffen.pingel</who>
    <bug_when>2012-07-14 08:31:06 -0400</bug_when>
    <thetext>No, this is not fixed in Mylyn 3.8. It is still unclear whether the problem is client side or caused by a change on the server side.</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>2140677</commentid>
    <comment_count>6</comment_count>
    <who name="David Hunter">dhunter</who>
    <bug_when>2012-07-24 06:32:13 -0400</bug_when>
    <thetext>I confirmed this bug using juno on centOS 6 with the Mylyn 3.8 and Jenkins 1.475 .
I shutdown jenkins, replaced my jenkins.war with http://mirrors.jenkins-ci.org/war/1.447/jenkins.war and restarted jenkins and the problem was gone.
swapping back to the latest jenkins.war (1.475) reinstated the issue.</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>2151341</commentid>
    <comment_count>7</comment_count>
    <who name="David Scurrah">dscurrah</who>
    <bug_when>2012-08-23 01:47:15 -0400</bug_when>
    <thetext>Unfortunately the problem continues for me with juno on Fedora 17 with the Mylyn 3.8 and Jenkins 1.478 (current version)</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>2154852</commentid>
    <comment_count>8</comment_count>
    <who name="Andre Bossert">anb0s</who>
    <bug_when>2012-08-31 11:17:38 -0400</bug_when>
    <thetext>With new LTS release 1.466.1 and Mylyn 3.8.1 validate/refresh does not work:
 Server validation failed: Unexpected error: Read timed out

How can i help to analyse deeper?</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>2155000</commentid>
    <comment_count>9</comment_count>
    <who name="Larry Gilbert">larry</who>
    <bug_when>2012-08-31 14:29:27 -0400</bug_when>
    <thetext>Also using Jenkins 1.475 here.

Also seeing this symptom (Unexpected error: null) when validating the connection.

Also anxious to see this fixed. :-)

(While I can&apos;t find any formal definitions of the &quot;Importance&quot; levels, I think &quot;enhancement&quot; seems too mild for a bug that breaks basic functionality.)</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>2155004</commentid>
    <comment_count>10</comment_count>
    <who name="Larry Gilbert">larry</who>
    <bug_when>2012-08-31 14:31:44 -0400</bug_when>
    <thetext>Sorry, I should have mentioned that I have 1.0.1.v20120725-0100 of org.eclipse.mylyn.hudson here.</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>2155205</commentid>
    <comment_count>11</comment_count>
    <who name="Steffen Pingel">steffen.pingel</who>
    <bug_when>2012-09-01 21:02:10 -0400</bug_when>
    <thetext>*** Bug 388000 has been marked as a duplicate of this bug. ***</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>2157892</commentid>
    <comment_count>12</comment_count>
    <who name="Erik Vonderheid">erik.vonderheid</who>
    <bug_when>2012-09-10 06:16:26 -0400</bug_when>
    <thetext>Same problem here:
Jenkins ver. 1.467
Eclipse Platform 4.2.0.v201206081400 
Mylyn Hudson Connector 1.0.1.v20120725-100

!SUBENTRY 1 org.eclipse.mylyn.hudson.core 4 0 2012-09-10 12:06:43.749
!MESSAGE Unexpected error: null
!STACK 0
org.eclipse.mylyn.internal.hudson.core.client.HudsonException
	at org.eclipse.mylyn.internal.hudson.core.client.HudsonOperation.run(HudsonOperation.java:161)
	at org.eclipse.mylyn.internal.hudson.core.client.RestfulHudsonClient.getJobs(RestfulHudsonClient.java:293)
	at org.eclipse.mylyn.internal.hudson.core.HudsonServerBehaviour.refreshConfiguration(HudsonServerBehaviour.java:780)
	at org.eclipse.mylyn.builds.internal.core.operations.RefreshConfigurationOperation$1.run(RefreshConfigurationOperation.java:75)
	at org.eclipse.mylyn.builds.internal.core.operations.RefreshConfigurationOperation$1.run(RefreshConfigurationOperation.java:1)
	at org.eclipse.mylyn.builds.internal.core.util.BuildRunner.run(BuildRunner.java:72)
	at org.eclipse.mylyn.builds.internal.core.operations.RefreshConfigurationOperation.doRefresh(RefreshConfigurationOperation.java:72)
	at org.eclipse.mylyn.builds.ui.spi.BuildServerPart$Validator.run(BuildServerPart.java:118)
	at org.eclipse.mylyn.commons.repositories.ui.RepositoryLocationPart$2.run(RepositoryLocationPart.java:558)
	at org.eclipse.jface.operation.ModalContext$ModalContextThread.run(ModalContext.java:121)
Caused by: org.apache.http.client.ClientProtocolException
	at org.apache.http.impl.client.AbstractHttpClient.execute(AbstractHttpClient.java:822)
	at org.eclipse.mylyn.commons.repositories.http.core.HttpUtil$1.execute(HttpUtil.java:178)
	at org.eclipse.mylyn.commons.repositories.http.core.HttpUtil$1.execute(HttpUtil.java:1)
	at org.eclipse.mylyn.commons.core.operations.MonitoredOperation.call(MonitoredOperation.java:82)
	at java.util.concurrent.FutureTask$Sync.innerRun(FutureTask.java:303)
	at java.util.concurrent.FutureTask.run(FutureTask.java:138)
	at java.util.concurrent.ThreadPoolExecutor$Worker.runTask(ThreadPoolExecutor.java:886)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:908)
	at java.lang.Thread.run(Thread.java:619)
Caused by: org.apache.http.ProtocolException: The server failed to respond with a valid HTTP response
	at org.apache.http.impl.conn.DefaultResponseParser.parseHead(DefaultResponseParser.java:109)
	at org.apache.http.impl.io.AbstractMessageParser.parse(AbstractMessageParser.java:252)
	at org.apache.http.impl.AbstractHttpClientConnection.receiveResponseHeader(AbstractHttpClientConnection.java:282)
	at org.apache.http.impl.conn.DefaultClientConnection.receiveResponseHeader(DefaultClientConnection.java:247)
	at org.apache.http.impl.conn.AbstractClientConnAdapter.receiveResponseHeader(AbstractClientConnAdapter.java:219)
	at org.apache.http.protocol.HttpRequestExecutor.doReceiveResponse(HttpRequestExecutor.java:298)
	at org.apache.http.protocol.HttpRequestExecutor.execute(HttpRequestExecutor.java:125)
	at org.apache.http.impl.client.DefaultRequestDirector.tryExecute(DefaultRequestDirector.java:645)
	at org.apache.http.impl.client.DefaultRequestDirector.execute(DefaultRequestDirector.java:464)
	at org.apache.http.impl.client.AbstractHttpClient.execute(AbstractHttpClient.java:820)
	... 8 more</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>2159406</commentid>
    <comment_count>13</comment_count>
    <who name="Steffen Pingel">steffen.pingel</who>
    <bug_when>2012-09-13 00:06:41 -0400</bug_when>
    <thetext>I investigated further and it looks like Jenkins 1.459 and later do not return valid HTTP responses to HEAD requests when gzip compression is enabled. I have filed an upstream bug here: https://issues.jenkins-ci.org/browse/JENKINS-15150. 

I&apos;ll commit a work-around that replaces the HEAD request with a GET request. The impact on performance is minor since the request is only sent once per login and this change can be reverted once the bug is fixed upstream.  

The proposed change for the Mylyn connector is here: https://git.eclipse.org/r/#/c/6230/</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>2159408</commentid>
    <comment_count>14</comment_count>
    <who name="Steffen Pingel">steffen.pingel</who>
    <bug_when>2012-09-13 00:09:16 -0400</bug_when>
    <thetext>Reopening until the change is merged.</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>2159419</commentid>
    <comment_count>15</comment_count>
    <who name="Andre Bossert">anb0s</who>
    <bug_when>2012-09-13 01:59:03 -0400</bug_when>
    <thetext>Thank You for investigating this! Jenkins issue voted.</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>2159898</commentid>
    <comment_count>16</comment_count>
    <who name="Steffen Pingel">steffen.pingel</who>
    <bug_when>2012-09-13 18:23:26 -0400</bug_when>
    <thetext>The work-around has been included in the latest 3.8.x snapshot build that is available from this p2 repository: http://download.eclipse.org/mylyn/snapshots/3.8  (URL only works in p2, not in a browser). Please let us know in case you are still experiencing problems with the latest build.</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>2159998</commentid>
    <comment_count>17</comment_count>
    <who name="Andre Bossert">anb0s</who>
    <bug_when>2012-09-14 04:48:41 -0400</bug_when>
    <thetext>Last Mylyn Builds snapshot 1.0.2.I20120913-2136 works with Jenkins 1.466.1 LTS. 

Thank You!</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>2160001</commentid>
    <comment_count>18</comment_count>
    <who name="Andre Bossert">anb0s</who>
    <bug_when>2012-09-14 04:55:08 -0400</bug_when>
    <thetext>verified with Mylyn Builds snapshot 1.0.2.I20120913-2136</thetext>
  </long_desc>
      
      

    </bug>

</bugzilla>