<?xml version="1.0" encoding="UTF-8" standalone="yes" ?>
<!DOCTYPE bugzilla SYSTEM "https://bugs.eclipse.org/bugs/page.cgi?id=bugzilla.dtd">

<bugzilla version="4.4.7"
          urlbase="https://bugs.eclipse.org/bugs/"
          
          maintainer="webmaster@eclipse.org"
>

    <bug>
          <bug_id>358600</bug_id>
          
          <creation_ts>2011-09-22 10:26:00 -0400</creation_ts>
          <short_desc>R4E Git connector search on LINUX generated exceptions</short_desc>
          <delta_ts>2011-10-24 16:22:19 -0400</delta_ts>
          <reporter_accessible>1</reporter_accessible>
          <cclist_accessible>1</cclist_accessible>
          <classification_id>14</classification_id>
          <classification>Mylyn</classification>
          <product>Mylyn Versions</product>
          <component>Git Connector</component>
          <version>0.8</version>
          <rep_platform>All</rep_platform>
          <op_sys>All</op_sys>
          <bug_status>RESOLVED</bug_status>
          <resolution>FIXED</resolution>
          
          
          <bug_file_loc></bug_file_loc>
          <status_whiteboard></status_whiteboard>
          <keywords></keywords>
          <priority>P1</priority>
          <bug_severity>normal</bug_severity>
          <target_milestone>0.9</target_milestone>
          
          
          <everconfirmed>1</everconfirmed>
          <reporter name="Jacques Bouthillier">lmcbout</reporter>
          <assigned_to name="Alvaro Sanchez-Leon">alvsan09</assigned_to>
          <cc>marco.masse</cc>
    
    <cc>sebastien.dubois</cc>
          
          <votes>0</votes>

      

      

      

          <comment_sort_order>oldest_to_newest</comment_sort_order>  
          <long_desc isprivate="0" >
    <commentid>1998179</commentid>
    <comment_count>0</comment_count>
    <who name="Jacques Bouthillier">lmcbout</who>
    <bug_when>2011-09-22 10:26:22 -0400</bug_when>
    <thetext>On LINUX environment:
I installed a few GIT project , then I tried to use the &quot;Find Review Item&quot; on the GIT project (Used com.ericsson.r4e.prefstore).
The respond was extremely slow and I got the following two exceptions at the same time, they must be related:

[10:14:27:935] D T=main FindReviewItemsHandler:141 (execute): Resolved Scm Ui connector: org.eclipse.mylyn.internal.git.ui.connector.GitConnectorUi@bf7c56
java.lang.ArrayIndexOutOfBoundsException: 1
!ENTRY org.eclipse.mylyn.git.ui 4 0 
	at org.eclipse.jgit.treewalk.TreeWalk.getObjectId(TreeWalk.java:673)
	at org.eclipse.jgit.diff.DiffEntry.scan(DiffEntry.java:119)
	at org.eclipse.mylyn.internal.git.core.GitConnector.getChangeSet(GitConnector.java:122)
	at org.eclipse.mylyn.internal.git.ui.GetChangeSetDialog.updateChangeSet(GetChangeSetDialog.java:461)
	at org.eclipse.mylyn.internal.git.ui.GetChangeSetDialog.populateNextChangeSets(GetChangeSetDialog.java:292)
	at org.eclipse.mylyn.internal.git.ui.GetChangeSetDialog.createFormContent(GetChangeSetDialog.java:244)
	at org.eclipse.ui.forms.FormDialog.createDialogArea(FormDialog.java:92)
	at org.eclipse.jface.dialogs.Dialog.createContents(Dialog.java:760)
	at org.eclipse.jface.window.Window.create(Window.java:431)
	at org.eclipse.jface.dialogs.Dialog.create(Dialog.java:1089)
	at org.eclipse.jface.window.Window.open(Window.java:790)
	at org.eclipse.mylyn.internal.git.ui.connector.GitConnectorUi.getChangeSet(GitConnectorUi.java:52)
	at org.eclipse.mylyn.reviews.r4e.ui.internal.commands.FindReviewItemsHandler.execute(FindReviewItemsHandler.java:143)
	at org.eclipse.ui.internal.handlers.HandlerProxy.execute(HandlerProxy.java:293)
	......
	
	2011-09-22 10:14:46.774
!MESSAGE org.eclipse.core.runtime.CoreException: 1
!STACK 1
org.eclipse.core.runtime.CoreException: 1
	at org.eclipse.mylyn.internal.git.core.GitConnector.getChangeSet(GitConnector.java:147)
	at org.eclipse.mylyn.internal.git.ui.GetChangeSetDialog.updateChangeSet(GetChangeSetDialog.java:461)
	at org.eclipse.mylyn.internal.git.ui.GetChangeSetDialog.populateNextChangeSets(GetChangeSetDialog.java:292)
	at org.eclipse.mylyn.internal.git.ui.GetChangeSetDialog.createFormContent(GetChangeSetDialog.java:244)
	at org.eclipse.ui.forms.FormDialog.createDialogArea(FormDialog.java:92)
	at org.eclipse.jface.dialogs.Dialog.createContents(Dialog.java:760)
	at org.eclipse.jface.window.Window.create(Window.java:431)
	at org.eclipse.jface.dialogs.Dialog.create(Dialog.java:1089)
	at org.eclipse.jface.window.Window.open(Window.java:790)
	at org.eclipse.mylyn.internal.git.ui.connector.GitConnectorUi.getChangeSet(GitConnectorUi.java:52)
	at org.eclipse.mylyn.reviews.r4e.ui.internal.commands.FindReviewItemsHandler.execute(FindReviewItemsHandler.java:143)
	at org.eclipse.ui.internal.handlers.HandlerProxy.execute(HandlerProxy.java:293)
	at org.eclipse.core.commands.Command.executeWithChecks(Command.java:476)
	at org.eclipse.core.commands.ParameterizedCommand.executeWithChecks(ParameterizedCommand.java:508)
	at org.eclipse.ui.internal.handlers.HandlerService.executeCommand(HandlerService.java:169)
	............
	at org.eclipse.equinox.launcher.Main.main(Main.java:1386)
!SUBENTRY 1 org.eclipse.mylyn.git.core 4 0 2011-09-22 10:14:46.775
!MESSAGE 1</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>1998194</commentid>
    <comment_count>1</comment_count>
    <who name="Jacques Bouthillier">lmcbout</who>
    <bug_when>2011-09-22 10:38:58 -0400</bug_when>
    <thetext> After more investigation, the exceptions occurs also on other GIT project, but not right away. 
 I tried with &quot;com.ericsson.reviews.r4e.mail&quot; and the exceptions occured when I hit the line saying &quot;more items&quot; at the end.  
 May be the list does not contain enough entry to complet a new set of 10 commits to put in the list.</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>2013475</commentid>
    <comment_count>2</comment_count>
    <who name="Alvaro Sanchez-Leon">alvsan09</who>
    <bug_when>2011-10-19 18:44:29 -0400</bug_when>
    <thetext>This product was moved to Mylyn versions, 
The git connector was adding all the parents to the tree walk before comparison, however the version of egit/jgit from Juno validates the trees to contain exactly two commits.

The fix, is to make sure only one parent is added to the three walk.
For merge commits the presented changeset will be with the first parent.  This is not perfect but a good compromise as all the changes including the resolution of merge conflicts shall be visible in the merged commit.</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>2013476</commentid>
    <comment_count>3</comment_count>
    <who name="Alvaro Sanchez-Leon">alvsan09</who>
    <bug_when>2011-10-19 18:45:00 -0400</bug_when>
    <thetext>see above fix description</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>2013478</commentid>
    <comment_count>4</comment_count>
    <who name="Alvaro Sanchez-Leon">alvsan09</who>
    <bug_when>2011-10-19 18:49:09 -0400</bug_when>
    <thetext>*** Bug 359474 has been marked as a duplicate of this bug. ***</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>2015735</commentid>
    <comment_count>5</comment_count>
    <who name="Alvaro Sanchez-Leon">alvsan09</who>
    <bug_when>2011-10-24 16:21:24 -0400</bug_when>
    <thetext>changing Assigned to</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>2015736</commentid>
    <comment_count>6</comment_count>
    <who name="Alvaro Sanchez-Leon">alvsan09</who>
    <bug_when>2011-10-24 16:22:19 -0400</bug_when>
    <thetext>done with Assigned to</thetext>
  </long_desc>
      
      

    </bug>

</bugzilla>