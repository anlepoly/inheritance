<?xml version="1.0" encoding="UTF-8" standalone="yes" ?>
<!DOCTYPE bugzilla SYSTEM "https://bugs.eclipse.org/bugs/page.cgi?id=bugzilla.dtd">

<bugzilla version="4.4.7"
          urlbase="https://bugs.eclipse.org/bugs/"
          
          maintainer="webmaster@eclipse.org"
>

    <bug>
          <bug_id>411038</bug_id>
          
          <creation_ts>2013-06-18 11:42:00 -0400</creation_ts>
          <short_desc>Gerrit reviews editor fails with NPE when new comment is submitted</short_desc>
          <delta_ts>2013-06-19 18:01:01 -0400</delta_ts>
          <reporter_accessible>1</reporter_accessible>
          <cclist_accessible>1</cclist_accessible>
          <classification_id>14</classification_id>
          <classification>Mylyn</classification>
          <product>Mylyn Reviews</product>
          <component>Gerrit Connector</component>
          <version>unspecified</version>
          <rep_platform>Macintosh</rep_platform>
          <op_sys>Mac OS X</op_sys>
          <bug_status>RESOLVED</bug_status>
          <resolution>FIXED</resolution>
          
          
          <bug_file_loc></bug_file_loc>
          <status_whiteboard></status_whiteboard>
          <keywords></keywords>
          <priority>P3</priority>
          <bug_severity>major</bug_severity>
          <target_milestone>2.0.1</target_milestone>
          
          
          <everconfirmed>1</everconfirmed>
          <reporter name="David Green">david.green</reporter>
          <assigned_to name="Miles Parker">milesparker</assigned_to>
          <cc>milesparker</cc>
          
          <votes>0</votes>

      

      

      

          <comment_sort_order>oldest_to_newest</comment_sort_order>  
          <long_desc isprivate="0" >
    <commentid>2273988</commentid>
    <comment_count>0</comment_count>
    <who name="David Green">david.green</who>
    <bug_when>2013-06-18 11:42:54 -0400</bug_when>
    <thetext>To reproduce:
# open a Gerrit review in the review editor
# fill in a new comment in the &quot;New Comment&quot; area
# press Alt+Shift+S to submit
# observe &quot;Submit failed: unexpected error: null&quot;

Using Mylyn Reviews Connector: Gerrit	2.0.0.v20130612-0100

the following exception shows in the error log:

java.lang.UnsupportedOperationException
	at org.eclipse.mylyn.internal.gerrit.core.GerritTaskDataHandler.postTaskData(GerritTaskDataHandler.java:214)
	at org.eclipse.mylyn.internal.tasks.core.sync.SubmitTaskJob.run(SubmitTaskJob.java:100)
	at org.eclipse.core.internal.jobs.Worker.run(Worker.java:54)</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>2274087</commentid>
    <comment_count>1</comment_count>
    <who name="Miles Parker">milesparker</who>
    <bug_when>2013-06-18 14:39:48 -0400</bug_when>
    <thetext>Wow, good one. This only fails when one uses the keyboard combination, not when clicking the submit button.

I believe usage wasn&apos;t actually anticipated, because until we have support for a more Mylyn like workflow (see bug 370645, bug 384770), you can&apos;t actually &quot;Submit&quot; the task in the usual way -- you have to use &quot;Publish Comments&quot; from within a patch set. (Note that there isn&apos;t actually a Submit button in the header.) So it seems that what we need to do is disable the keyboard action or something like that.

(I&apos;m not sure if we should tackle this one for 2.0.1 or hold for 2.1.)</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>2274163</commentid>
    <comment_count>2</comment_count>
    <who name="Steffen Pingel">steffen.pingel</who>
    <bug_when>2013-06-18 17:26:07 -0400</bug_when>
    <thetext>This looks like a bug in the task editor to me. It should do nothing if the submit button is not enabled.</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>2274177</commentid>
    <comment_count>3</comment_count>
    <who name="Miles Parker">milesparker</who>
    <bug_when>2013-06-18 18:04:16 -0400</bug_when>
    <thetext>Actually the framework was working just fine. We just needed to set needsSubmit as well as needsSubmit button. It seems to me that we&apos;ve discussed this one before so rather than have it come up again, I fixed it.

https://git.eclipse.org/r/#/c/13894/</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>2274585</commentid>
    <comment_count>4</comment_count>
    <who name="Miles Parker">milesparker</who>
    <bug_when>2013-06-19 14:47:35 -0400</bug_when>
    <thetext>Merged: https://git.eclipse.org/r/#/c/13894/</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>2274670</commentid>
    <comment_count>5</comment_count>
    <who name="Steffen Pingel">steffen.pingel</who>
    <bug_when>2013-06-19 17:26:49 -0400</bug_when>
    <thetext>Assignee?</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>2274681</commentid>
    <comment_count>6</comment_count>
    <who name="Miles Parker">milesparker</who>
    <bug_when>2013-06-19 18:01:01 -0400</bug_when>
    <thetext>.</thetext>
  </long_desc>
      
      

    </bug>

</bugzilla>